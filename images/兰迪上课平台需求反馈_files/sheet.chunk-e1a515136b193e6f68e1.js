webpackJsonp([1],Array(20).concat([function(e,t,n){var r,o;!function(){"use strict";function n(){for(var e=[],t=0;t<arguments.length;t++){var r=arguments[t];if(r){var o=typeof r;if("string"===o||"number"===o)e.push(r);else if(Array.isArray(r))e.push(n.apply(null,r));else if("object"===o)for(var a in r)i.call(r,a)&&r[a]&&e.push(a)}}return e.join(" ")}var i={}.hasOwnProperty;void 0!==e&&e.exports?e.exports=n:(r=[],void 0!==(o=function(){return n}.apply(t,r))&&(e.exports=o))}()},,,,,,,,,,,,,,,,,function(e,t,n){e.exports=n(459)()},,,,,,,,,,,,,,function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=r(u),f=n(54),d=n(20),p=r(d),h=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={open:e.open||!1},n.bodyTpl=n.bodyTpl.bind(n),n}return s(t,e),l(t,[{key:"componentWillReceiveProps",value:function(e){void 0!==e.open&&e.open!==this.state.open&&this.setState({open:e.open})}},{key:"_headTpl",value:function(e){return this.props.hasCloseButton?c.default.createElement("div",null,c.default.createElement("span",{className:"dialog-title"},e),c.default.createElement("span",{className:"hicon icon-close dialog-close",onTouchTap:this._close.bind(this)})):c.default.createElement("span",{className:"dialog-title"},e)}},{key:"_close",value:function(){this.setState({open:!1});var e=this.props.onClose;"function"==typeof e&&e()}},{key:"bodyTpl",value:function(){if("function"==typeof this.props.bodyTpl)return this.props.bodyTpl;if(this.props.children){var e=c.default.Children.map(this.props.children,function(e){return c.default.cloneElement(e)});return function(){return e}}}},{key:"render",value:function(){var e,t=this.props,n=t.customClass,r=t.title,i=t.onClose,a=t.actions,s=t.enableCloseClickMask,l=t.hasCloseButton,u=this.state.open,d=this.props.buttonLayout,h=!1;a&&a.length>0&&(h=!0,d=d||"vertical",a.map(function(e){e.customClass+=" flat-footer-button "+d}));var m=(0,p.default)((e={"flat-dialog":!0},o(e,""+n,!!n),o(e,"no-title",!r&&!l),o(e,"no-action",!a||!a.length),e));return c.default.createElement(f.Dialog,{ref:"dialog",customClass:m,title:r,headTpl:this._headTpl.bind(this),bodyTpl:this.bodyTpl.bind(this)(),onClose:i||function(){},actions:a||[],open:"boolean"==typeof u&&u,enableCloseClickMask:s,hasActions:h})}}]),t}(u.Component);t.default=h,h.propTypes={customClass:u.PropTypes.string,title:u.PropTypes.string,bodyTpl:u.PropTypes.func,onClose:u.PropTypes.func,actions:u.PropTypes.array,open:u.PropTypes.bool,hasCloseButton:u.PropTypes.bool,enableCloseClickMask:u.PropTypes.bool,buttonLayout:u.PropTypes.oneOf(["vertical","horizontal"])},e.exports=t.default},,,function(e,t,n){!function(e,t){for(var n in t)e[n]=t[n]}(t,function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){n(1),e.exports=n(5)},function(e,t){},,,,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var o=n(6),i=r(o),a=n(10),s=r(a),l=n(9),u=r(l),c=n(17),f=r(c),d=n(18),p=r(d),h=n(19),m=r(h),g=n(20),_=r(g),v=n(21),y=r(v),b=n(22),w=r(b),C=n(25),S=r(C),x=n(26),T=r(x),E=n(28),M=r(E),A=n(29),k=r(A),R=n(12),I=r(R),O=n(27),D=r(O),P=n(30),N=r(P),F=n(31),L=r(F),H=n(32),V=r(H),j=n(16),B=r(j),U=n(13),W=r(U);e.exports={DropdownMenu:i.default,MenuItem:s.default,Menu:u.default,IconButton:f.default,SimpleButton:p.default,LinkButton:m.default,Checkbox:_.default,CheckboxGroup:y.default,Tab:w.default,TabItem:S.default,Dialog:T.default,Draggable:M.default,DraggableDialog:k.default,Tooltip:I.default,Mask:D.default,Toast:N.default,SearchInput:L.default,ImageIcon:V.default,WindowListener:B.default,DelegateClick:W.default}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var o=n(7),i=r(o),a=n(8),s=r(a),l=n(9),u=r(l),c=n(12),f=r(c),d=n(13),p=r(d),h=n(16),m=r(h);e.exports=i.default.createClass({displayName:"exports",mixins:[p.default,m.default],propTypes:{menuItems:i.default.PropTypes.array.isRequired,className:i.default.PropTypes.string,wrapClassName:i.default.PropTypes.string,itemTpl:i.default.PropTypes.func,selectedTpl:i.default.PropTypes.func,selectedIndex:i.default.PropTypes.number,onTap:i.default.PropTypes.func,onMenuChange:i.default.PropTypes.func,forceTap:i.default.PropTypes.bool,tooltip:i.default.PropTypes.string,tipClass:i.default.PropTypes.string,isScroll:i.default.PropTypes.bool,autoWidth:i.default.PropTypes.bool,autoHeight:i.default.PropTypes.bool},windowListeners:{resize:"handlerResize"},getDefaultProps:function(){return{className:"d-menu-wrap",hasMask:!1,autoWidth:!1,autoHeight:!1,tooltip:"",tipClass:"",displayKey:"text",valKey:"value",itemTpl:function(e,t,n,r,o){var a=t[r],s=t[o];return i.default.createElement("div",{"data-val":s},a)},selectedTpl:function(e,t,n,r){var o=t[n];return i.default.createElement("div",null,t[o])}}},getInitialState:function(){return{open:!1,selectedIndex:this.props.selectedIndex||0,isShowTip:!1,hovered:!1}},componentDidMount:function(){this.menuWrap=this.refs.menuWrap,this.menuWrapDom=s.default.findDOMNode(this.menuWrap),this.props.autoWidth&&this._setWidth(),this.props.hasOwnProperty("selectedIndex")&&this._setSelectedIndex(this.props.selectedIndex)},componentDidUpdate:function(e,t){t.open&&!this.state.open&&this.props.onClose&&this.props.onClose()},componentWillReceiveProps:function(e){this.props.autoWidth&&this._setWidth(),e.hasOwnProperty("selectedIndex")&&this._setSelectedIndex(e.selectedIndex)},render:function(){var e=this.props,t=this.state.open?"":"unactive",n=(e.wrapClassName||"")+" "+e.className+" "+t,r=void 0;return e.tooltip&&(r=i.default.createElement(f.default,{ref:"tooltip",tip:e.tooltip,isShow:this.state.isShowTip,customClass:e.tipClass})),i.default.createElement("div",{className:n,onMouseEnter:this._handleMouseEnter,onMouseLeave:this._handleMouseLeave},i.default.createElement("div",{className:"d-menu-display-wrap",onTouchTap:this._onToggleMenu},e.selectedTpl(this.state.selectedIndex,e.menuItems[this.state.selectedIndex],e.displayKey,e.valKey),r),i.default.createElement("div",{className:"menu-wrap"},i.default.createElement(u.default,{ref:"menuWrap",menuItems:e.menuItems,displayKey:e.displayKey,valKey:e.valKey,selectedIndex:this.state.selectedIndex,itemTpl:e.itemTpl,onItemTap:this._onItemTap})),this.state.open&&e.hasMask&&i.default.createElement("div",{className:"d-menu-mask",onTouchTap:this._onMenuMaskTap}))},handlerResize:function(){this._setSubmenuHeight()},componentClick:function(){this.close()},close:function(){this.state.open&&(this.setState({open:!1}),this._removeSubmenuStyle())},_onToggleMenu:function(){this.setState({open:!this.state.open,isShowTip:this.state.open},function(){var e=this;this.state.open?setTimeout(function(){e._getSubmenuViewport(),e._setSubmenuHeight()}):this._removeSubmenuStyle()}),this.props.onTap&&this.props.onTap()},_onItemTap:function(e,t,n){var r=this.props;r.onMenuChange&&(this.state.selectedIndex!==t||r.forceTap)&&r.onMenuChange(e,t,n),this.setState({selectedIndex:t,open:!!r.keepOpen})},_onMenuMaskTap:function(){this.setState({open:!1}),this._removeSubmenuStyle()},_setWidth:function(){s.default.findDOMNode(this).style.width=this.menuWrapDom.offsetWidth+"px"},timer:null,_setSubmenuHeight:function(){var e=this;this.props.autoHeight&&(this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){var t=window.innerHeight,n=e.submenuViewport||{},r=n.height,o=n.bottom,i=o>t?r+t-o-20:"auto";e.menuWrap.setHeight(i)},200))},_getSubmenuViewport:function(){this.submenuViewport||(this.submenuViewport=this.menuWrapDom.getBoundingClientRect())},_removeSubmenuStyle:function(){this.menuWrap.removeStyle()},_setSelectedIndex:function(e){this.setState({selectedIndex:e})},_handleMouseEnter:function(){this.setState({isShowTip:!this.state.open,hovered:!0})},_handleMouseLeave:function(){this.setState({isShowTip:!1,hovered:!1})}})},function(e,t){e.exports=n(0)},function(e,t){e.exports=n(13)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var o=n(7),i=r(o),a=n(8),s=(r(a),n(10)),l=r(s),u=n(11),c=r(u);e.exports=i.default.createClass({displayName:"exports",propTypes:{menuItems:i.default.PropTypes.array.isRequired,selectedIndex:i.default.PropTypes.number,selectedVal:i.default.PropTypes.string,onItemTap:i.default.PropTypes.func,itemTpl:i.default.PropTypes.func,isScroll:i.default.PropTypes.bool},getDefaultProps:function(){},getInitialState:function(){return{selectedIndex:this.props.selectedIndex||this._getSelectedIndexByVal(),style:null}},componentDidMount:function(){this.props.hasOwnProperty("selectedIndex")&&this._setSelectedIndex(this.props.selectedIndex)},componentWillReceiveProps:function(e){e.hasOwnProperty("selectedIndex")&&this._setSelectedIndex(e.selectedIndex)},render:function(){return i.default.createElement("div",{className:"menu-wrap-inner",style:this.state.style},this._renderChilden())},_renderChilden:function(){for(var e,t,n=[],r=this.props,o=0,a=r.menuItems.length;o<a;o++)e=r.menuItems[o],t=i.default.createElement(l.default,{selected:this.state.selectedIndex===o,key:o,index:o,data:e,itemTpl:r.itemTpl,displayKey:r.displayKey,valKey:r.valKey,onTap:this._onItemTap}),n.push(t),"divider"===e.type&&n.push(i.default.createElement(c.default,{key:"divider"+o}));return n},_onItemTap:function(e,t,n){this.setState({selectedIndex:t}),this.props.onItemTap&&this.props.onItemTap(e,t,n)},_getSelectedIndexByVal:function(){var e=this.props;if(e.selectedVal)for(var t=0,n=e.menuItems.length;t<n;t++)if(e.menuItems[t][e.valKey]==e.selectedVal)return t;return 0},_setSelectedIndex:function(e){this.setState({selectedIndex:e})},setHeight:function(e){var t=null;"auto"!==e&&(e=Math.max(e,30),t={overflowY:"auto",overflowX:"hidden",height:e}),this.setState({style:t})},removeStyle:function(){this.setState({style:null})}})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var o=n(7),i=r(o);e.exports=i.default.createClass({displayName:"exports",propTypes:{index:i.default.PropTypes.number.isRequired,selected:i.default.PropTypes.bool,data:i.default.PropTypes.object,onTap:i.default.PropTypes.func,itemTpl:i.default.PropTypes.func},getDefaultProps:function(){return{itemTpl:function(e,t,n,r,o){var a=t[r],s=t[o];return i.default.createElement("div",{"data-val":s},a)}}},getInitialState:function(){return{hovered:!1}},render:function(){var e=this.props,t="menu-item",n=this.state.hovered?"hovered":"";return n&&(t+=" "+n),e.selected&&(t+=" menu-item-selected"),e.data.class&&(t+=" "+e.data.class),i.default.createElement("div",{className:t,onMouseEnter:this._handleMouseEnter,onMouseLeave:this._handleMouseLeave,onTouchTap:this._onTap},e.itemTpl(e.index,e.data,e.selected,e.displayKey,e.valKey))},_onTap:function(e){var t=this.props;t.onTap&&t.onTap(e,t.index,t.data)},_handleMouseEnter:function(e){this.setState({hovered:!0})},_handleMouseLeave:function(e){this.setState({hovered:!1})}})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(){return a.default.createElement("div",{className:"menu-divider"})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var i=n(7),a=r(i)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var o=n(7),i=r(o);e.exports=i.default.createClass({displayName:"exports",propTypes:{tip:i.default.PropTypes.string.isRequired,isShow:i.default.PropTypes.bool,customClass:i.default.PropTypes.string},render:function(){var e=this.props,t=e.isShow?"":"hide",n=e.customClass||"";return i.default.createElement("span",{className:"tooltip "+t+" "+n},e.tip)}})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var o=n(7),i=(r(o),n(8)),a=r(i),s=n(14),l=r(s),u=n(15),c=r(u);e.exports={componentDidMount:function(){this._bindClick()},componentWillUnmount:function(){this._unbindClick()},_checkClick:function(e){var t=a.default.findDOMNode(this),n=e.target;n!=t&&!c.default.isDescendant(t,n)&&document.documentElement.contains(n)&&this.componentClick&&this.componentClick(e,t)},_bindClick:function(){l.default.on(document,"mouseup",this._checkClick),l.default.on(document,"touchend",this._checkClick)},_unbindClick:function(){l.default.off(document,"mouseup",this._checkClick),l.default.off(document,"touchend",this._checkClick)}}},function(e,t){"use strict";e.exports={on:function(e,t,n){window.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n)},off:function(e,t,n){window.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent("on"+t,n)}}},function(e,t){"use strict";e.exports={isDescendant:function(e,t){for(var n=t.parentNode;null!=n;){if(n===e)return!0;n=n.parentNode}return!1}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var o=n(14),i=r(o);e.exports={componentDidMount:function(){var e,t=this.windowListeners;for(var n in t)e=t[n],i.default.on(window,n,this[e])},componentWillUnmount:function(){var e,t=this.windowListeners;for(var n in t)e=t[n],i.default.off(window,n,this[e])}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var o=n(7),i=r(o),a=n(12),s=r(a);e.exports=i.default.createClass({displayName:"exports",propTypes:{customClass:i.default.PropTypes.string,tooltip:i.default.PropTypes.string,disabled:i.default.PropTypes.bool,onBtnTap:i.default.PropTypes.func,onDoubleClick:i.default.PropTypes.func,isShowTip:i.default.PropTypes.bool,tipClass:i.default.PropTypes.string,iconBtnClass:i.default.PropTypes.string,iconBtnTpl:i.default.PropTypes.func},getDefaultProps:function(){return{customClass:""}},getInitialState:function(){return{isShowTip:!1,hovered:!1,tipClass:""}},render:function(){var e,t=this.props,n=this.state.hovered?"hovered":"";return t.tooltip&&(e=i.default.createElement(s.default,{ref:"tooltip",tip:t.tooltip,isShow:this.state.isShowTip,customClass:t.tipClass})),i.default.createElement("span",{className:"icon-btn-wrap "+n+" "+t.customClass,onMouseEnter:this._handleMouseEnter,onMouseLeave:this._handleMouseLeave,onClick:this._handlerClick},i.default.createElement("span",{className:"icon-btn "+t.iconBtnClass},t.iconBtnTpl?t.iconBtnTpl():""),e)},_handleMouseEnter:function(e){this.setState({isShowTip:!0,hovered:!0})},_handleMouseLeave:function(e){this.setState({isShowTip:!1,hovered:!1})},_timer:null,_handlerClick:function(e){var t=this,n=this.props,r=n.onDoubleClick,o=n.onBtnTap;if(this._timer)return clearTimeout(this._timer),this._timer=null,void(r&&r(e));this._timer=setTimeout(function(){clearTimeout(t._timer),t._timer=null,o&&o(e)},300)}})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var o=n(7),i=r(o);e.exports=i.default.createClass({displayName:"exports",propTypes:{customClass:i.default.PropTypes.string,disabled:i.default.PropTypes.bool,label:i.default.PropTypes.string,btnTpl:i.default.PropTypes.func,onTap:i.default.PropTypes.func},getDefaultProps:function(){return{customClass:""}},render:function(){var e,t=this.props;return e=t.btnTpl?t.btnTpl(t.label):i.default.createElement("div",{className:"btn-inner"},t.label&&i.default.createElement("span",{ref:"btnLabel",className:"btn-label"},t.label),t.children),i.default.createElement("button",{className:"btn "+t.customClass,disabled:t.disabled,onTouchTap:this._onTap},e)},_onTap:function(e){var t=this.props;!t.disabled&&t.onTap&&t.onTap(e)}})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var o=n(7),i=r(o),a=n(18),s=r(a);e.exports=i.default.createClass({displayName:"exports",propTypes:{customClass:i.default.PropTypes.string,disabled:i.default.PropTypes.bool,newTab:i.default.PropTypes.bool,label:i.default.PropTypes.string,btnTpl:i.default.PropTypes.func,href:i.default.PropTypes.string.isRequired,onTap:i.default.PropTypes.func},getDefaultProps:function(){return{customClass:"",newTab:!1}},render:function(){var e,t=this.props;return e=t.btnTpl?t.btnTpl(t.label):i.default.createElement("div",{className:"btn-inner"},t.label&&i.default.createElement("span",{ref:"btnLabel",className:"btn-label"},t.label),t.children),i.default.createElement(s.default,{customClass:t.customClass,disabled:t.disabled,onTap:t.onTap},i.default.createElement("a",{className:"link-btn",href:t.href,target:t.newTab?"_blank":"_self"},e))}})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(7),u=r(l),c=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={checked:e.checked},n}return a(t,e),s(t,[{key:"componentWillReceiveProps",value:function(e){e.checked!==this.state.checked&&this.setState({checked:e.checked})}},{key:"render",value:function(){var e=this,t=this.props,n=t.className?"checkbox-item "+t.className:"checkbox-item";return n+=this.state.checked?" checked":"",u.default.createElement("div",{className:n,onTouchTap:function(){return e._onChange()}},this.props.tpl(this.state.checked,t.item))}},{key:"_onChange",value:function(){var e=this.props,t=!this.state.checked;this.setState({checked:t}),e.onCheck&&e.onCheck(e.item,t)}}]),t}(l.Component);t.default=c,c.propTypes={className:l.PropTypes.string,item:l.PropTypes.object,tpl:l.PropTypes.func,checked:l.PropTypes.bool,onCheck:l.PropTypes.func},c.defaultProps={checked:!1,tpl:function(e,t){var n=t?t.name:"全选";return u.default.createElement("span",null,n)}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(7),u=r(l),c=n(20),f=r(c),d=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={items:e.items,checkedItems:e.checkedItems,isSelectAll:n._isSelectAll(e.checkedItems,e.items)},n}return a(t,e),s(t,[{key:"componentWillReceiveProps",value:function(e){var t={};e.items!==this.state.items&&(t.items=e.items),e.checkedItems!==this.state.checkedItems&&(t.checkedItems=e.checkedItems),Object.keys(t).length>0&&this.setState(t)}},{key:"shouldComponentUpdate",value:function(e,t){return this.state!==t}},{key:"render",value:function(){var e=this,t=this.props,n=t.className?"checkbox-group-wrap "+t.className:"checkbox-group-wrap";return u.default.createElement("div",{className:n},!t.disableSelectAll&&u.default.createElement(f.default,{checked:this.state.isSelectAll,onCheck:this._onSelectAll.bind(this),tpl:t.selectAllTpl}),this.state.items.map(function(n,r){return u.default.createElement(f.default,{key:r,item:n,checked:e.state.checkedItems.indexOf(n.name)>-1,onCheck:e._onCheck.bind(e),tpl:t.itemTpl})}))}},{key:"_isSelectAll",value:function(e,t){return e.length===t.length||!1}},{key:"_onSelectAll",value:function(e,t){var n=t?this._getAllItems(this.state.items):[];this._onChange(n)}},{key:"_onCheck",value:function(e,t){var n=(this.props,this.state.checkedItems),r=e.name;t?n.push(r):n.splice(n.indexOf(r),1),this._onChange(n)}},{key:"_onChange",value:function(e){var t=this.props;this.setState({checkedItems:e,isSelectAll:this._isSelectAll(e,this.state.items)}),t.onChange&&t.onChange(e)}},{key:"_getAllItems",value:function(e){var t=[];return e.forEach(function(e){t.push(e.name)}),t}}]),t}(l.Component);t.default=d,d.propTypes={className:l.PropTypes.string,items:l.PropTypes.array.isRequired,checkedItems:l.PropTypes.array,itemTpl:l.PropTypes.func,onChange:l.PropTypes.func,disableSelectAll:l.PropTypes.bool,selectAllTpl:l.PropTypes.func},d.defaultProps={defaultChecked:[],disableSelectAll:!1,selectAllTpl:function(e){return u.default.createElement("div",{className:"checkbox-select-all"},"全选")}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var o=n(7),i=r(o),a=n(23),s=r(a),l=n(24),u=r(l);e.exports=i.default.createClass({displayName:"exports",propTypes:{customClass:i.default.PropTypes.string,selectedIndex:i.default.PropTypes.number,tabWillChange:i.default.PropTypes.func,tabDidChange:i.default.PropTypes.func,onTapContent:i.default.PropTypes.func,disableSetWidth:i.default.PropTypes.bool},getInitialState:function(){return{selectedIndex:this.props.selectedIndex||0}},componentWillReceiveProps:function(e){void 0!==e.selectedIndex&&e.selectedIndex!==this.props.selectedIndex&&this.setState({selectedIndex:e.selectedIndex})},render:function(){var e,t,n,r=this.props,o=[],a=[];return i.default.Children.forEach(r.children,function(l,c){"TabItem"==l.type.displayName?(r.disableSetWidth?e=i.default.createElement(s.default,{key:c,index:c,title:l.props.title,selected:this.state.selectedIndex===c,headTpl:r.headTpl,onTap:this._onHeadTap}):(n=100/this.getTabCount()+"%",e=i.default.createElement(s.default,{key:c,index:c,title:l.props.title,selected:this.state.selectedIndex===c,width:n,headTpl:r.headTpl,onTap:this._onHeadTap})),t=i.default.createElement(u.default,{key:c,index:c,selected:this.state.selectedIndex===c,onTapContent:this._onTapContent,className:l.props.className},l.props.children),o.push(e),a.push(t)):console.error("The tab item tag name must be TagItem")}.bind(this)),i.default.createElement("div",{className:"tab-wrap "+(r.customClass||"")+" selected-"+this.state.selectedIndex},i.default.createElement("div",{className:"tab-head-wrap"},o),i.default.createElement("div",{className:"tab-content-wrap"},a))},getTabCount:function(){return i.default.Children.count(this.props.children)},_onHeadTap:function(e,t,n){var r=this.props;r.tabWillChange&&r.tabWillChange(this.state.selectedIndex,e,n),this.setState({selectedIndex:e},function(){r.tabDidChange&&r.tabDidChange(e,t,n)})},_onTapContent:function(e,t,n){this.props.onTapContent&&this.props.onTapContent(e,t,n)}})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var o=n(7),i=r(o);e.exports=i.default.createClass({displayName:"exports",propTypes:{index:i.default.PropTypes.number,title:i.default.PropTypes.string,selected:i.default.PropTypes.bool,headTpl:i.default.PropTypes.func,onTap:i.default.PropTypes.func},getDefaultProps:function(){return{index:0,selected:!1}},render:function(){var e,t=this.props,n={width:t.width};return e=t.headTpl?t.headTpl(t.title,t.selected):t.title,i.default.createElement("div",{className:"tab-head-item "+(t.selected?"selected":""),style:n,onTouchTap:this._onTap},e)},_onTap:function(e){this.props.onTap&&this.props.onTap(this.props.index,this.props.title,e)}})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var o=n(7),i=r(o);e.exports=i.default.createClass({displayName:"exports",propTypes:{index:i.default.PropTypes.number,selected:i.default.PropTypes.bool,onTapContent:i.default.PropTypes.func,className:i.default.PropTypes.string},getDefaultProps:function(){return{index:0,selected:!1}},render:function(){var e=this.props,t="tab-content-item";return e.className&&(t+=" "+e.className),i.default.createElement("div",{className:t+(e.selected?" selected":" hide"),onTouchTap:this._onTap},e.children)},_onTap:function(e){var t=this.props;t.onTapContent&&t.onTapContent(t.index,this,e)}})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var o=n(7),i=r(o);e.exports=i.default.createClass({render:function(){return i.default.createElement("div",{className:"tab-item"})},displayName:"TabItem"})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(7),a=r(i),s=n(8),l=n(18),u=r(l),c=n(27),f=r(c);t.default=a.default.createClass({displayName:"Dialog",propTypes:{title:a.default.PropTypes.string,body:a.default.PropTypes.string,headTpl:a.default.PropTypes.func,bodyTpl:a.default.PropTypes.func,footTpl:a.default.PropTypes.func,hasMask:a.default.PropTypes.bool,hasActions:a.default.PropTypes.bool,actions:a.default.PropTypes.array,onShow:a.default.PropTypes.func,onClose:a.default.PropTypes.func,open:a.default.PropTypes.bool,keepCenter:a.default.PropTypes.bool,enableCloseClickMask:a.default.PropTypes.bool},getDefaultProps:function(){return{hasMask:!0,hasActions:!0,customClass:"",actions:[{customClass:"dialog-submit",onTap:this._onSubmit,label:"submit"},{customClass:"dialog-cancel",onTap:this.close,label:"cancel"}]}},getInitialState:function(){return{open:this.props.open||!1}},componentDidMount:function(){this.props.open&&(this._asCenter(),this._onShow())},componentWillReceiveProps:function(e){void 0!==e.open&&e.open!==this.state.open&&this.setState({open:e.open})},componentDidUpdate:function(e,t){var n=t.open;!this.state.open||!e.keepCenter&&n||this._asCenter()},render:function(){var e,t,n=this.props,r=n.actions,i=[],s={style:n.style,onMouseDown:n.onMouseDown,onMouseUp:n.onMouseUp};if(n.hasActions)for(var l=0,c=r.length;l<c;l++)t=r[l],e=t.tpl?t.tpl(t):a.default.createElement(u.default,{key:l,customClass:t.customClass||"",disabled:t.disabled||!1,onTap:t.onTap||this.close,label:t.label}),i.push(e);return a.default.createElement("div",o({ref:"dialogWrap",className:"dialog-wrap "+n.customClass},s),this.state.open&&a.default.createElement("div",{ref:"dialog",className:"dialog"},a.default.createElement("div",{className:"dialog-head"},n.headTpl?n.headTpl(n.title):n.title),a.default.createElement("div",{className:"dialog-body"},n.bodyTpl?n.bodyTpl(n.body):n.body),a.default.createElement("div",{className:"dialog-foot"},n.footTpl?n.footTpl():null,i)),this.state.open&&this.props.hasMask&&a.default.createElement(f.default,{autoLockScroll:!0,isShow:!0,onTap:this._handleMaskTap}))},show:function(){this.setState({open:!0},this._onShow)},close:function(){this.setState({open:!1},this._onClose)},_asCenter:function(){var e=(0,s.findDOMNode)(this.refs.dialogWrap);e.style.marginLeft=-e.clientWidth/2+"px",e.style.marginTop=-e.clientHeight/2+"px"},_onShow:function(){this.props.onShow&&this.props.onShow()},_onClose:function(){this.props.onClose&&this.props.onClose()},_onSubmit:function(){this.setState({open:!1}),this.props.onClose(!0)},_handleMaskTap:function(){var e=this.props.enableCloseClickMask;(void 0===e||e)&&this.close()}})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var o=n(7),i=r(o);e.exports=i.default.createClass({displayName:"exports",propTypes:{autoLockScroll:i.default.PropTypes.bool,isShow:i.default.PropTypes.bool,onTap:i.default.PropTypes.func},_originalBodyOverflow:"",componentDidMount:function(){this._originalBodyOverflow=document.getElementsByTagName("body")[0].style.oveflow,this.props.autoLockScroll&&this._disableScroll()},componentWillUnmount:function(){this._enableScroll()},componentDidUpdate:function(){this.props.autoLockScroll&&(this.props.isShow?this._disableScroll():this._enableScroll())},render:function(){return i.default.createElement("div",{className:"mask",onTouchTap:this._onTap})},_disableScroll:function(){document.getElementsByTagName("body")[0].style.oveflow="hidden"},_enableScroll:function(){document.getElementsByTagName("body")[0].style.oveflow=this._originalBodyOverflow},_onTap:function(e){this.props.onTap&&this.props.onTap(e)}})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e&&e.call.apply(e,[null].concat(n))}function u(e,t,n){return Math.max(t,Math.min(n,e))}function c(e,t){return e.indexOf(t)>-1}function f(e,t){var n={};return Object.keys(t).forEach(function(r){return!c(e,r)&&(n[r]=t[r])}),n}Object.defineProperty(t,"__esModule",{value:!0});var d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},p=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),h=n(7),m=r(h),g=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;s(this,e),this.set(t,n)}return p(e,[{key:"set",value:function(e,t){this.x=e,this.y=t}}]),e}(),_=function(e){function t(e){s(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._start=function(e){return!n.state.dragging&&(!1!==l(n.props.onStart,e)&&(document.body.addEventListener("mousemove",n._drag),document.body.style.webkitUserSelect="none",n._setStartingCoord(e),void n.setState({dragging:!0})))},n._drag=function(e){if(n.state.dragging){var t=n._makeDeltaInViewport(n.deltaPoint.x+e.clientX-n.startingPoint.x,n.deltaPoint.y+e.clientY-n.startingPoint.y),r=t.dx,o=t.dy;if(!1===l(n.props.onDrag,e,r,o))return!1;n.setState({dx:r,dy:o})}},n._stop=function(e){if(!1===l(n.props.onStop,e))return!1;document.body.removeEventListener("mousemove",n._drag),document.body.style.webkitUserSelect=n.presetWebkitUserSelect,n.setState({dragging:!1})},n.presetWebkitUserSelect=document.body.style.webkitUserSelect,n.rect=null,n.deltaPoint=new g,n.startingPoint=new g,n.state={dx:0,dy:0,dragging:!1},n}return a(t,e),p(t,[{key:"componentWillReceiveProps",value:function(e){e.reset&&(this.rect=null,this.deltaPoint=new g,this.setState({dx:0,dy:0}))}},{key:"_setStartingCoord",value:function(e){var t=e.currentTarget,n=e.clientX,r=e.clientY;this.startingPoint.set(n,r),this.rect=t.getBoundingClientRect(),this.deltaPoint.set(this.state.dx,this.state.dy)}},{key:"_makeDeltaInViewport",value:function(e,t){var n=this.deltaPoint,r=n.x,o=n.y,i=this.rect,a=i.left,s=i.top,l=i.right,c=i.bottom,f=document.body,d=f.clientWidth,p=f.clientHeight;return e=u(e,-(a-r),d-(l-r)),t=u(t,-(s-o),p-(c-o)),{dx:e,dy:t}}},{key:"render",value:function(){var e=this.props,n=e.children,r=e.wrapper,i=o(e,["children","wrapper"]),a=this.state,s=a.dx,l=a.dy,u=h.Children.only(n),c=d({style:{transform:"translate("+s+"px,"+l+"px)"},onMouseDown:this._start,onMouseUp:this._stop},f(Object.keys(t.propTypes),i));return r?m.default.createElement("div",c,u):m.default.cloneElement(u,c)}}]),t}(h.Component);_.propTypes={wrapper:h.PropTypes.bool,onStart:h.PropTypes.func,onDrag:h.PropTypes.func,onStop:h.PropTypes.func,reset:h.PropTypes.bool,children:h.PropTypes.element.isRequired},t.default=_},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(7),c=r(u),f=n(28),d=r(f),p=n(26),h=r(p),m=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._onStop=function(){n.setState({reset:!1})},n.state={reset:!1},n}return a(t,e),l(t,[{key:"show",value:function(){var e;this.setState({reset:!0}),(e=this.refs.dialog).show.apply(e,arguments)}},{key:"close",value:function(){var e;(e=this.refs.dialog).close.apply(e,arguments)}},{key:"render",value:function(){var e=this.state.reset;return c.default.createElement(d.default,{onStop:this._onStop,reset:e},c.default.createElement(h.default,s({ref:"dialog",hasMask:!1},this.props)))}}]),t}(u.Component);t.default=m},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var o=n(7),i=r(o),a=n(8),s=r(a);e.exports=i.default.createClass({displayName:"exports",propTypes:{msg:i.default.PropTypes.string,timeout:i.default.PropTypes.number,type:i.default.PropTypes.string},getDefaultProps:function(){return{msg:"",timeout:3e3,type:"info"}},render:function(){return i.default.createElement("div",{id:"toast-wrap",className:"toast fadein "+this.props.type},this.props.msg)},componentDidMount:function(){this._setTimeout()},componentDidUpdate:function(){this._setTimeout()},_timeoutId:null,_setTimeout:function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=setTimeout(function(){s.default.unmountComponentAtNode(s.default.findDOMNode(this).parentNode)}.bind(this),this.props.timeout)}})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var o=n(7),i=r(o),a=n(8),s=r(a);e.exports=i.default.createClass({displayName:"exports",propTypes:{customClass:i.default.PropTypes.string,placeholder:i.default.PropTypes.string,onSearch:i.default.PropTypes.func,throttle:i.default.PropTypes.number,isFocus:i.default.PropTypes.bool,text:i.default.PropTypes.string},getDefaultProps:function(){return{customClass:"",placeholder:"search...",throttle:200,isFocus:!0}},getInitialState:function(){return{text:this.props.text||""}},componentDidMount:function(){this.props.isFocus&&this._setFocus()},componentWillReceiveProps:function(e){void 0!==e.text&&e.text!==this.state.text&&this.setState({text:e.text})},render:function(){var e=this.props;return i.default.createElement("div",{className:"search-wrap "+e.customClass},i.default.createElement("form",{className:"search-form",onSubmit:this._onSubmit},i.default.createElement("input",{ref:"searchInput",type:"text",autoComplete:"off",value:this.state.text,className:"search-input",placeholder:e.placeholder,onChange:this._onInputChange,onKeyDown:this._onKeyDown,onFocus:this._onFocus,onBlur:this._onBlur})))},_timeoutId:null,_onKeyDown:function(e){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=setTimeout(function(){this._goSearch(e)}.bind(this),this.props.throttle)},_onSubmit:function(e){return this._goSearch(e),e.preventDefault(),!1},_goSearch:function(e){var t,n;t=s.default.findDOMNode(this.refs.searchInput),n=t.value,this.props.onSearch&&this.props.onSearch(n,e)},_setFocus:function(){var e;e=s.default.findDOMNode(this.refs.searchInput),e.focus()},_onInputChange:function(e){var t;t=s.default.findDOMNode(this.refs.searchInput),this.setState({text:t.value})},_onFocus:function(){this.props.onFocus&&this.props.onFocus()},_onBlur:function(){this.props.onBlur&&this.props.onBlur()}})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var o=n(7),i=r(o),a=n(14),s=r(a);e.exports=i.default.createClass({displayName:"exports",propTypes:{customClass:i.default.PropTypes.string,defaultImg:i.default.PropTypes.string,realImg:i.default.PropTypes.string},getDefaultProps:function(){return{customClass:"",defaultImg:"",realImg:""}},getInitialState:function(){return{loaded:null}},componentDidMount:function(){var e,t=this,n=this.props.realImg;n&&(e=document.createElement("img"),s.default.on(e,"load",function(){t.isMounted()&&t.setState({loaded:"success"})}),s.default.on(e,"error",function(){t.isMounted()&&t.setState({loaded:"failed"})}),e.setAttribute("src",n))},render:function(){var e=this.props,t={},n={};return"success"==this.state.loaded?(t={backgroundImage:"url("+e.realImg+")"},n={visibility:"hidden"}):"failed"==this.state.loaded&&(n={visibility:"visible"}),i.default.createElement("div",{className:"img-wrap "+e.customClass,style:t},i.default.createElement("img",{ref:"image","data-real":e.realImg,src:e.defaultImg,style:n}))}})}]))},,,,,,,,,,,,,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var o=n(451),i=r(o);t.default=i.default||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},,,,,,,,,,function(e,t){var n=e.exports={version:"2.4.0"};"number"==typeof __e&&(__e=n)},function(e,t,n){var r=n(135),o=n(303),i=n(202),a=Object.defineProperty;t.f=n(80)?Object.defineProperty:function(e,t,n){if(r(e),t=i(t,!0),r(n),o)try{return a(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){e.exports=!n(137)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){var r=n(306),o=n(203);e.exports=function(e){return r(o(e))}},,function(e,t,n){var r=n(68),o=n(78),i=n(302),a=n(85),s="prototype",l=function(e,t,n){var u,c,f,d=e&l.F,p=e&l.G,h=e&l.S,m=e&l.P,g=e&l.B,_=e&l.W,v=p?o:o[t]||(o[t]={}),y=v[s],b=p?r:h?r[t]:(r[t]||{})[s];p&&(n=t);for(u in n)(c=!d&&b&&void 0!==b[u])&&u in v||(f=c?b[u]:n[u],v[u]=p&&"function"!=typeof b[u]?n[u]:g&&c?i(f,r):_&&b[u]==f?function(e){var t=function(t,n,r){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,r)}return e.apply(this,arguments)};return t[s]=e[s],t}(f):m&&"function"==typeof f?i(Function.call,f):f,m&&((v.virtual||(v.virtual={}))[u]=f,e&l.R&&y&&!y[u]&&a(y,u,f)))};l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,e.exports=l},function(e,t,n){var r=n(79),o=n(153);e.exports=n(80)?function(e,t,n){return r.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var r=n(206)("wks"),o=n(154),i=n(68).Symbol,a="function"==typeof i;(e.exports=function(e){return r[e]||(r[e]=a&&i[e]||(a?i:o)("Symbol."+e))}).store=r},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){var r=n(136);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,n){var r=n(305),o=n(207);e.exports=Object.keys||function(e){return r(e,o)}},function(e,t,n){"use strict";t.__esModule=!0,t.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var o=n(309),i=r(o);t.default=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),(0,i.default)(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}()},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var o=n(184),i=r(o);t.default=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":(0,i.default)(t))&&"function"!=typeof t?e:t}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var o=n(490),i=r(o),a=n(494),s=r(a),l=n(184),u=r(l);t.default=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":(0,u.default)(t)));e.prototype=(0,s.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(i.default?(0,i.default)(e,t):e.__proto__=t)}},function(e,t,n){"use strict";function r(e,t){return e+t}function o(e,t,n){var r=n;{if("object"!==(void 0===t?"undefined":T(t)))return void 0!==r?("number"==typeof r&&(r+="px"),void(e.style[t]=r)):A(e,t);for(var i in t)t.hasOwnProperty(i)&&o(e,i,t[i])}}function i(e){var t=void 0,n=void 0,r=void 0,o=e.ownerDocument,i=o.body,a=o&&o.documentElement;return t=e.getBoundingClientRect(),n=t.left,r=t.top,n-=a.clientLeft||i.clientLeft||0,r-=a.clientTop||i.clientTop||0,{left:n,top:r}}function a(e,t){var n=e["page"+(t?"Y":"X")+"Offset"],r="scroll"+(t?"Top":"Left");if("number"!=typeof n){var o=e.document;n=o.documentElement[r],"number"!=typeof n&&(n=o.body[r])}return n}function s(e){return a(e)}function l(e){return a(e,!0)}function u(e){var t=i(e),n=e.ownerDocument,r=n.defaultView||n.parentWindow;return t.left+=s(r),t.top+=l(r),t}function c(e,t,n){var r=n,o="",i=e.ownerDocument;return r=r||i.defaultView.getComputedStyle(e,null),r&&(o=r.getPropertyValue(t)||r[t]),o}function f(e,t){var n=e[I]&&e[I][t];if(k.test(n)&&!R.test(t)){var r=e.style,o=r[D],i=e[O][D];e[O][D]=e[I][D],r[D]="fontSize"===t?"1em":n||0,n=r.pixelLeft+P,r[D]=o,e[O][D]=i}return""===n?"auto":n}function d(e,t){return"left"===e?t.useCssRight?"right":e:t.useCssBottom?"bottom":e}function p(e){return"left"===e?"right":"right"===e?"left":"top"===e?"bottom":"bottom"===e?"top":void 0}function h(e,t,n){"static"===o(e,"position")&&(e.style.position="relative");var i=-999,a=-999,s=d("left",n),l=d("top",n),c=p(s),f=p(l);"left"!==s&&(i=999),"top"!==l&&(a=999);var h="",m=u(e);("left"in t||"top"in t)&&(h=(0,E.getTransitionProperty)(e)||"",(0,E.setTransitionProperty)(e,"none")),"left"in t&&(e.style[c]="",e.style[s]=i+"px"),"top"in t&&(e.style[f]="",e.style[l]=a+"px");var g=u(e),_={};for(var v in t)if(t.hasOwnProperty(v)){var y=d(v,n),b="left"===v?i:a,w=m[v]-g[v];_[y]=y===v?b+w:b-w}o(e,_),r(e.offsetTop,e.offsetLeft),("left"in t||"top"in t)&&(0,E.setTransitionProperty)(e,h);var C={};for(var S in t)if(t.hasOwnProperty(S)){var x=d(S,n),T=t[S]-m[S];C[x]=S===x?_[x]+T:_[x]-T}o(e,C)}function m(e,t){var n=u(e),r=(0,E.getTransformXY)(e),o={x:r.x,y:r.y};"left"in t&&(o.x=r.x+t.left-n.left),"top"in t&&(o.y=r.y+t.top-n.top),(0,E.setTransformXY)(e,o)}function g(e,t,n){n.useCssRight||n.useCssBottom?h(e,t,n):n.useCssTransform&&(0,E.getTransformName)()in document.body.style?m(e,t,n):h(e,t,n)}function _(e,t){for(var n=0;n<e.length;n++)t(e[n])}function v(e){return"border-box"===A(e,"boxSizing")}function y(e,t,n){var r={},o=e.style,i=void 0;for(i in t)t.hasOwnProperty(i)&&(r[i]=o[i],o[i]=t[i]);n.call(e);for(i in t)t.hasOwnProperty(i)&&(o[i]=r[i])}function b(e,t,n){var r=0,o=void 0,i=void 0,a=void 0;for(i=0;i<t.length;i++)if(o=t[i])for(a=0;a<n.length;a++){var s=void 0;s="border"===o?""+o+n[a]+"Width":o+n[a],r+=parseFloat(A(e,s))||0}return r}function w(e){return null!==e&&void 0!==e&&e==e.window}function C(e,t,n){var r=n;if(w(e))return"width"===t?j.viewportWidth(e):j.viewportHeight(e);if(9===e.nodeType)return"width"===t?j.docWidth(e):j.docHeight(e);var o="width"===t?["Left","Right"]:["Top","Bottom"],i="width"===t?e.offsetWidth:e.offsetHeight,a=A(e),s=v(e,a),l=0;(null===i||void 0===i||i<=0)&&(i=void 0,l=A(e,t),(null===l||void 0===l||Number(l)<0)&&(l=e.style[t]||0),l=parseFloat(l)||0),void 0===r&&(r=s?H:F);var u=void 0!==i||s,c=i||l;return r===F?u?c-b(e,["border","padding"],o,a):l:u?r===H?c:c+(r===L?-b(e,["border"],o,a):b(e,["margin"],o,a)):l+b(e,N.slice(r),o,a)}function S(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=void 0,o=t[0];return 0!==o.offsetWidth?r=C.apply(void 0,t):y(o,B,function(){r=C.apply(void 0,t)}),r}function x(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}Object.defineProperty(t,"__esModule",{value:!0});var T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E=n(500),M=/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,A=void 0,k=new RegExp("^("+M+")(?!px)[a-z%]+$","i"),R=/^(top|right|bottom|left)$/,I="currentStyle",O="runtimeStyle",D="left",P="px";"undefined"!=typeof window&&(A=window.getComputedStyle?c:f);var N=["margin","border","padding"],F=-1,L=2,H=1,V=0,j={};_(["Width","Height"],function(e){j["doc"+e]=function(t){var n=t.document;return Math.max(n.documentElement["scroll"+e],n.body["scroll"+e],j["viewport"+e](n))},j["viewport"+e]=function(t){var n="client"+e,r=t.document,o=r.body,i=r.documentElement,a=i[n];return"CSS1Compat"===r.compatMode&&a||o&&o[n]||a}});var B={position:"absolute",visibility:"hidden",display:"block"};_(["width","height"],function(e){var t=e.charAt(0).toUpperCase()+e.slice(1);j["outer"+t]=function(t,n){return t&&S(t,e,n?V:H)};var n="width"===e?["Left","Right"]:["Top","Bottom"];j[e]=function(t,r){var i=r;if(void 0===i)return t&&S(t,e,F);if(t){var a=A(t);return v(t)&&(i+=b(t,["padding","border"],n,a)),o(t,e,i)}}});var U={getWindow:function(e){if(e&&e.document&&e.setTimeout)return e;var t=e.ownerDocument||e;return t.defaultView||t.parentWindow},offset:function(e,t,n){if(void 0===t)return u(e);g(e,t,n||{})},isWindow:w,each:_,css:o,clone:function(e){var t=void 0,n={};for(t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);if(e.overflow)for(t in e)e.hasOwnProperty(t)&&(n.overflow[t]=e.overflow[t]);return n},mix:x,getWindowScrollLeft:function(e){return s(e)},getWindowScrollTop:function(e){return l(e)},merge:function(){for(var e={},t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var o=0;o<n.length;o++)U.mix(e,n[o]);return e},viewportWidth:0,viewportHeight:0};x(U,j),t.default=U,e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(22);t.default={ajaxGet:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.ajaxGet.apply(null,t).then(function(e){if(e.code>0)throw new Error(e.message);return e}).catch(function(e){throw new Error(e)})},ajaxPost:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.ajaxPost.apply(null,t).then(function(e){if(e.code>0)throw new Error(e.message);return e}).catch(function(e){throw new Error(e)})}},e.exports=t.default},function(e,t,n){"use strict";var r=n(0),o=n(461);if(void 0===r)throw Error("create-react-class could not find the React object. If you are using script tags, make sure that React is being loaded before create-react-class.");var i=(new r.Component).updater;e.exports=o(r.Component,r.isValidElement,i)},,,,,function(e,t,n){var r=n(417),o="object"==typeof self&&self&&self.Object===Object&&self,i=r||o||Function("return this")();e.exports=i},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var o=n(412),i=r(o),a=n(583),s=r(a),l=n(585),u=r(l),c=n(586),f=r(c),d=n(415),p=r(d);t.createStore=i.default,t.combineReducers=s.default,t.bindActionCreators=u.default,t.applyMiddleware=f.default,t.compose=p.default},,function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},function(e,t){t.f={}.propertyIsEnumerable},,,,,,,,,,,,,,,,,,,,function(e,t){function n(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}e.exports=n},,,,function(e,t,n){(function(r){function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(201),a=o(i),s=n(148),l=o(s),u=function(){var e=navigator.userAgent,t=void 0,n=void 0;return t=e.match(/mobile.*dingtalk/i)?a.default.toast:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e3,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";e=(0,l.default)(e,{whiteList:{span:["class"],br:[]}});var i=r("#toast-wrap");if(n&&clearTimeout(n),i.length>0)i.html(e),i[0].className="toast fadein "+o;else{var a=document.createElement("div");a.id="toast-wrap",a.className="toast fadein "+o,a.innerHTML=e,r("body").append(a)}n=setTimeout(function(){r("#toast-wrap").addClass("hide")},t)},window.toast=t,t}();t.default=u,e.exports=t.default}).call(t,n(2))},,,,,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var o=n(467),i=r(o),a=n(479),s=r(a),l="function"==typeof s.default&&"symbol"==typeof i.default?function(e){return typeof e}:function(e){return e&&"function"==typeof s.default&&e.constructor===s.default&&e!==s.default.prototype?"symbol":typeof e};t.default="function"==typeof s.default&&"symbol"===l(i.default)?function(e){return void 0===e?"undefined":l(e)}:function(e){return e&&"function"==typeof s.default&&e.constructor===s.default&&e!==s.default.prototype?"symbol":void 0===e?"undefined":l(e)}},,,,,function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=[],n=null,r=function(){for(var r=0;r<t.length;r++){var o=t[r];if(o.condition===e)return"function"==typeof o.result?o.result():o.result}return"function"==typeof n?n():n||null},o=function(e){return n=e,{done:r}};return{when:function e(n,i){return t.push({condition:n,result:i}),{when:e,others:o,done:r}},others:o,done:r}},e.exports=t.default},function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.getAmount=function(e){return Number((e/100).toFixed(2)).toString()},t.allowNumber=function(e){return Number(e.replace(/[^0-9]/g,""))}},,,,,,,,function(e,t,n){function r(e){return null==e?void 0===e?l:s:u&&u in Object(e)?i(e):a(e)}var o=n(324),i=n(588),a=n(589),s="[object Null]",l="[object Undefined]",u=o?o.toStringTag:void 0;e.exports=r},function(e,t){function n(e){return null!=e&&"object"==typeof e}e.exports=n},,,function(e,t,n){var r=n(136);e.exports=function(e,t){if(!r(e))return e;var n,o;if(t&&"function"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;if("function"==typeof(n=e.valueOf)&&!r(o=n.call(e)))return o;if(!t&&"function"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;throw TypeError("Can't convert object to primitive value")}},function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},function(e,t,n){var r=n(206)("keys"),o=n(154);e.exports=function(e){return r[e]||(r[e]=o(e))}},function(e,t,n){var r=n(68),o="__core-js_shared__",i=r[o]||(r[o]={});e.exports=function(e){return i[e]||(i[e]={})}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t){e.exports=!0},function(e,t){e.exports={}},function(e,t,n){var r=n(135),o=n(472),i=n(207),a=n(205)("IE_PROTO"),s=function(){},l="prototype",u=function(){var e,t=n(304)("iframe"),r=i.length,o="<",a=">";for(t.style.display="none",n(473).appendChild(t),t.src="javascript:",e=t.contentWindow.document,e.open(),e.write(o+"script"+a+"document.F=Object"+o+"/script"+a),e.close(),u=e.F;r--;)delete u[l][i[r]];return u()};e.exports=Object.create||function(e,t){var n;return null!==e?(s[l]=r(e),n=new s,s[l]=null,n[a]=e):n=u(),void 0===t?n:o(n,t)}},function(e,t,n){var r=n(79).f,o=n(81),i=n(86)("toStringTag");e.exports=function(e,t,n){e&&!o(e=n?e:e.prototype,i)&&r(e,i,{configurable:!0,value:t})}},function(e,t,n){t.f=n(86)},function(e,t,n){var r=n(68),o=n(78),i=n(209),a=n(213),s=n(79).f;e.exports=function(e){var t=o.Symbol||(o.Symbol=i?{}:r.Symbol||{});"_"==e.charAt(0)||e in t||s(t,e,{value:a.f(e)})}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.register=t.reducer=t.actions=t.ModalRoot=t.Modal=void 0;var i=n(678),a=o(i),s=n(679),l=o(s),u=n(650),c=r(u),f=n(680),d=o(f);t.Modal=l.default,t.ModalRoot=a.default,t.actions=c,t.reducer=d.default,t.register=i.register},,,,function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=r(u),f=n(13),d=r(f);t.default=function(e){return function(t){function n(){o(this,n);var e=i(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.checkClick=e.checkClick.bind(e),e.checkResize=e.checkResize.bind(e),e}return a(n,t),l(n,[{key:"componentDidMount",value:function(){this.bindClick(),this.bindResize()}},{key:"componentWillUnmount",value:function(){this.unbindClick(),this.unbindResize()}},{key:"isDescendant",value:function(e,t){for(var n=t.parentNode;null!==n;){if(n===e)return!0;n=n.parentNode}return!1}},{key:"checkClick",value:function(e){var t=d.default.findDOMNode(this),n=e.target,r=this.refs.composedComponent.componentClick;n!==t&&!this.isDescendant(t,n)&&document.documentElement.contains(n)&&"function"==typeof r&&r(e,t)}},{key:"checkResize",value:function(e){var t=this.refs.composedComponent.componentResize;"function"==typeof t&&t(e)}},{key:"bindClick",value:function(){document.addEventListener("mouseup",this.checkClick),document.addEventListener("touchend",this.checkClick)}},{key:"unbindClick",value:function(){document.removeEventListener("mouseup",this.checkClick),document.removeEventListener("touchend",this.checkClick)}},{key:"bindResize",value:function(){window.addEventListener("resize",this.checkResize)}},{key:"unbindResize",value:function(){window.removeEventListener("resize",this.checkResize)}},{key:"render",value:function(){return c.default.createElement(e,s({ref:"composedComponent"},this.props))}}]),n}(u.Component)},e.exports=t.default},,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n){var r=l.default.unstable_batchedUpdates?function(e){l.default.unstable_batchedUpdates(n,e)}:n;return(0,a.default)(e,t,r)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var i=n(462),a=r(i),s=n(13),l=r(s);e.exports=t.default},,,function(e,t){var n=Array.isArray;e.exports=n},function(e,t,n){var r,o;!function(i){r=[n(2)],void 0!==(o=function(e){return i(e)}.apply(t,r))&&(e.exports=o)}(function(e){"use strict";function t(e){void 0===e&&(e=window.navigator.userAgent),e=e.toLowerCase();var t=/(edge)\/([\w.]+)/.exec(e)||/(opr)[\/]([\w.]+)/.exec(e)||/(chrome)[ \/]([\w.]+)/.exec(e)||/(version)(applewebkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+).*(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[],n=/(ipad)/.exec(e)||/(ipod)/.exec(e)||/(iphone)/.exec(e)||/(kindle)/.exec(e)||/(silk)/.exec(e)||/(android)/.exec(e)||/(windows phone)/.exec(e)||/(win)/.exec(e)||/(mac)/.exec(e)||/(linux)/.exec(e)||/(cros)/.exec(e)||/(playbook)/.exec(e)||/(bb)/.exec(e)||/(blackberry)/.exec(e)||[],r={},o={browser:t[5]||t[3]||t[1]||"",version:t[2]||t[4]||"0",versionNumber:t[4]||t[2]||"0",platform:n[0]||""};if(o.browser&&(r[o.browser]=!0,r.version=o.version,r.versionNumber=parseInt(o.versionNumber,10)),o.platform&&(r[o.platform]=!0),(r.android||r.bb||r.blackberry||r.ipad||r.iphone||r.ipod||r.kindle||r.playbook||r.silk||r["windows phone"])&&(r.mobile=!0),(r.cros||r.mac||r.linux||r.win)&&(r.desktop=!0),(r.chrome||r.opr||r.safari)&&(r.webkit=!0),r.rv||r.edge){var i="msie";o.browser=i,r[i]=!0}if(r.safari&&r.blackberry){var a="blackberry";o.browser=a,r[a]=!0}if(r.safari&&r.playbook){var s="playbook";o.browser=s,r[s]=!0}if(r.bb){var l="blackberry";o.browser=l,r[l]=!0}if(r.opr){var u="opera";o.browser=u,r[u]=!0}if(r.safari&&r.android){var c="android";o.browser=c,r[c]=!0}if(r.safari&&r.kindle){var f="kindle";o.browser=f,r[f]=!0}if(r.safari&&r.silk){var d="silk";o.browser=d,r[d]=!0}return r.name=o.browser,r.platform=o.platform,r}return window.jQBrowser=t(window.navigator.userAgent),window.jQBrowser.uaMatch=t,e&&(e.browser=window.jQBrowser),window.jQBrowser})},,,function(e,t,n){function r(e){return null!=e&&i(e.length)&&!o(e)}var o=n(416),i=n(336);e.exports=r},,function(e,t,n){"use strict";var r=function(e,t,n,r,o,i,a,s){if(!e){var l;if(void 0===t)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[n,r,o,i,a,s],c=0;l=new Error(t.replace(/%s/g,function(){return u[c++]})),l.name="Invariant Violation"}throw l.framesToPop=1,l}};e.exports=r},function(e,t,n){"use strict";t.__esModule=!0;var r=n(664);Object.defineProperty(t,"Provider",{enumerable:!0,get:function(){return r.default}});var o=n(665);Object.defineProperty(t,"connect",{enumerable:!0,get:function(){return o.default}})},function(e,t,n){function r(e,t){var n=i(e,t);return o(n)?n:void 0}var o=n(587),i=n(592);e.exports=r},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(608),i=r(o),a=n(774),s=r(a);i.default.Timeago=s.default,t.default=i.default,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(448),i=r(o);t.default=i.default,e.exports=t.default},,,,function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(447),i=r(o);t.default=i.default,e.exports=t.default},,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var o=n(309),i=r(o);t.default=function(e,t,n){return t in e?(0,i.default)(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={adjustX:1,adjustY:1},o=[0,0],i=t.placements={left:{points:["cr","cl"],overflow:r,offset:[-4,0],targetOffset:o},right:{points:["cl","cr"],overflow:r,offset:[4,0],targetOffset:o},top:{points:["bc","tc"],overflow:r,offset:[0,-4],targetOffset:o},bottom:{points:["tc","bc"],overflow:r,offset:[0,4],targetOffset:o},topLeft:{points:["bl","tl"],overflow:r,offset:[0,-4],targetOffset:o},leftTop:{points:["tr","tl"],overflow:r,offset:[-4,0],targetOffset:o},topRight:{points:["br","tr"],overflow:r,offset:[0,-4],targetOffset:o},rightTop:{points:["tl","tr"],overflow:r,offset:[4,0],targetOffset:o},bottomRight:{points:["tr","br"],overflow:r,offset:[0,4],targetOffset:o},rightBottom:{points:["bl","br"],overflow:r,offset:[4,0],targetOffset:o},bottomLeft:{points:["tl","bl"],overflow:r,offset:[0,4],targetOffset:o},leftBottom:{points:["br","bl"],overflow:r,offset:[-4,0],targetOffset:o}};t.default=i},function(e,t,n){var r=n(454);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,o){return e.call(t,n,r,o)}}return function(){return e.apply(t,arguments)}}},function(e,t,n){e.exports=!n(80)&&!n(137)(function(){return 7!=Object.defineProperty(n(304)("div"),"a",{get:function(){return 7}}).a})},function(e,t,n){var r=n(136),o=n(68).document,i=r(o)&&r(o.createElement);e.exports=function(e){return i?o.createElement(e):{}}},function(e,t,n){var r=n(81),o=n(82),i=n(456)(!1),a=n(205)("IE_PROTO");e.exports=function(e,t){var n,s=o(e),l=0,u=[];for(n in s)n!=a&&r(s,n)&&u.push(n);for(;t.length>l;)r(s,n=t[l++])&&(~i(u,n)||u.push(n));return u}},function(e,t,n){var r=n(307);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t,n){var r=n(203);e.exports=function(e){return Object(r(e))}},function(e,t,n){e.exports={default:n(465),__esModule:!0}},function(e,t,n){"use strict";var r=n(209),o=n(84),i=n(311),a=n(85),s=n(81),l=n(210),u=n(471),c=n(212),f=n(474),d=n(86)("iterator"),p=!([].keys&&"next"in[].keys()),h="keys",m="values",g=function(){return this};e.exports=function(e,t,n,_,v,y,b){u(n,t,_);var w,C,S,x=function(e){if(!p&&e in A)return A[e];switch(e){case h:case m:return function(){return new n(this,e)}}return function(){return new n(this,e)}},T=t+" Iterator",E=v==m,M=!1,A=e.prototype,k=A[d]||A["@@iterator"]||v&&A[v],R=k||x(v),I=v?E?x("entries"):R:void 0,O="Array"==t?A.entries||k:k;if(O&&(S=f(O.call(new e)))!==Object.prototype&&(c(S,T,!0),r||s(S,d)||a(S,d,g)),E&&k&&k.name!==m&&(M=!0,R=function(){return k.call(this)}),r&&!b||!p&&!M&&A[d]||a(A,d,R),l[t]=R,l[T]=g,v)if(w={values:E?R:x(m),keys:y?R:x(h),entries:I},b)for(C in w)C in A||i(A,C,w[C]);else o(o.P+o.F*(p||M),t,w);return w}},function(e,t,n){e.exports=n(85)},function(e,t,n){var r=n(305),o=n(207).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,o)}},function(e,t,n){var r=n(155),o=n(153),i=n(82),a=n(202),s=n(81),l=n(303),u=Object.getOwnPropertyDescriptor;t.f=n(80)?u:function(e,t){if(e=i(e),t=a(t,!0),l)try{return u(e,t)}catch(e){}if(s(e,t))return o(!r.f.call(e,t),e[t])}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=e.ownerDocument,n=t.body,r=void 0,o=a.default.css(e,"position");if("fixed"!==o&&"absolute"!==o)return"html"===e.nodeName.toLowerCase()?null:e.parentNode;for(r=e.parentNode;r&&r!==n;r=r.parentNode)if("static"!==(o=a.default.css(r,"position")))return r;return null}Object.defineProperty(t,"__esModule",{value:!0});var i=n(143),a=r(i);t.default=o,e.exports=t.default},function(e,t){e.exports=function(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}},,,,,,,,function(e,t,n){(function(r){function o(e){return c(cow.currentUser,e)}function i(e){if(l(e)||u(e)){if(e.team_role&&"creator"===e.team_role)return!0}else if(e.isOwner)return!0;return!1}function a(e){if(l(e)||u(e)){if(e.team_role&&"member"===e.team_role)return!0}else if(!i(e))return!0;return!1}function s(e){return!(!l(e)&&!u(e)||!e.team_role||"admin"!==e.team_role)}function l(e){return e.accountType&&("enterprise_standard"===e.accountType||"enterprise_expired"===e.accountType)}function u(e){return e.accountType&&"enterprise_dingding"===e.accountType}function c(e,t){return e.id&&t.id&&e.id===t.id||e.email&&t.email&&e.email===t.email}function f(e,t){return!!i(e)||!(!s(e)||i(t)||s(t))}function d(e,t){var n=[];if(!e||!/^[\w-@\.\u4E00-\u9FFF]+$/.test(e))return n;if(e=e.toLowerCase(),t)if(e.match(/^([\w-_]+(?:\.[\w-_]+)*)@((?:[a-z0-9]+(?:-[a-zA-Z0-9]+)*\.)+[a-z]{2,6})$/i)){var o=new RegExp("^"+e);r.each(t,function(e){o.test(e.email||"")&&n.push(e)})}else r.each(t,function(t){if(t.name_pinyin&&!(t.id<0)){if(!w[t.id]){if(!t.name_pinyin||t.id<0)return;var o=t.name_pinyin.split("|");w[t.id]={name:t.name,firstLetters:o[0],fullPinyin:o[1],fullPinyinS:o[1].replace(/\'/g,""),emailPrefix:(null!==t.email?t.email.split("@")[0]:void 0)||"",emailFull:t.email||""}}var i=w[t.id],a=i.name.toLowerCase().indexOf(e)+1,s=i.firstLetters.toLowerCase().indexOf(e)+1,l=i.fullPinyin.toLowerCase().indexOf("'"+e)+1,u=i.emailPrefix.toLowerCase().indexOf(e)+1,c=i.emailFull.toLowerCase().indexOf(e)+1,f=i.fullPinyinS.toLowerCase().indexOf(e)+1,d=r.min([a,20*s,20*l,20*u,1e4*c,1e3*f].filter(function(e){return e>0}));void 0!==d&&t.status>-1&&n.push({weight:d,user:t})}}),n=n.sort(function(e,t){return e.weight-t.weight}).map(function(e){return e.user});return n}function p(e){var t="/api/getUserInfo?email="+e;return(0,b.ajaxGet)(t)}function h(e,t){return new Promise(function(n,r){if(0===e.length)return void n();var o={file_id:t,users:[]};e.forEach(function(e){var t="number"==typeof e.id?e.id:e.email;o.users.push(t)}),(0,b.ajaxPost)("/api/invite",o).then(function(e){if(0===e.code&&e.data.success){var t=[];e.data.detail.forEach(function(e){void 0!==e.user&&t.push(e.user)}),n(t)}else r()},function(){r()})})}function m(){return(0,b.ajaxGet)("/api/share/recent_contact")}function g(e){return new Promise(function(t,n){(0,b.ajaxGet)("/smapi/teams/mine/members",e).then(function(e){0===e.code?t(e.data||[]):n(e)},function(e){n(e)})})}function _(e,t){var n={guid:e,user_id:t};return new Promise(function(e,t){(0,b.ajaxPost)("/api/share/delete",n).then(function(n){0===n.code?e(n):t()},function(e){t(e)})})}function v(){return new Promise(function(e,t){(0,b.ajaxGet)("/smapi/teams/mine/permissions").then(function(n){if(0===n.code){var r=cow.currentUser.team_role;e({share:(n.data.share||[]).indexOf(r)>-1,invite:(n.data.invite||[]).indexOf(r)>-1,setAdmin:(n.data.setAdmin||[]).indexOf(r)>-1})}else t(new Error(n.message))},function(e){t(e)})})}function y(e){return new Promise(function(t,n){(0,b.ajaxGet)("/smapi/users/email?email="+e).then(function(e){0===e.code?t(e.data):n(new Error(e.message))},function(e){n(e)})})}Object.defineProperty(t,"__esModule",{value:!0});var b=n(22),w={};t.default={isSelf:o,isSameUser:c,isCreator:i,isMember:a,isAdmin:s,isEnterpriseStandard:l,isEnterpriseDingding:u,hasPermissionRemoveUserFromTeam:f,searchByKeyword:d,getUserInfoByEmail:p,addNewShareUsers:h,getRecentMember:m,getTeamMembers:g,deleteShareUser:_,getMyPermission:v,searchByEmail:y},e.exports=t.default}).call(t,n(1))},function(e,t,n){var r=n(150),o=r.Symbol;e.exports=o},function(e,t){function n(e,t){return e===t||e!==e&&t!==t}e.exports=n},,function(e,t,n){var r,o,i;!function(a,s){o=[e,n(421),n(423),n(424)],r=s,void 0!==(i="function"==typeof r?r.apply(t,o):r)&&(e.exports=i)}(0,function(e,t,n,r){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function l(e,t){var n="data-clipboard-"+e;if(t.hasAttribute(n))return t.getAttribute(n)}var u=o(t),c=o(n),f=o(r),d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),h=function(e){function t(e,n){i(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.resolveOptions(n),r.listenClick(e),r}return s(t,e),p(t,[{key:"resolveOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action="function"==typeof e.action?e.action:this.defaultAction,this.target="function"==typeof e.target?e.target:this.defaultTarget,this.text="function"==typeof e.text?e.text:this.defaultText,this.container="object"===d(e.container)?e.container:document.body}},{key:"listenClick",value:function(e){var t=this;this.listener=(0,f.default)(e,"click",function(e){return t.onClick(e)})}},{key:"onClick",value:function(e){var t=e.delegateTarget||e.currentTarget;this.clipboardAction&&(this.clipboardAction=null),this.clipboardAction=new u.default({action:this.action(t),target:this.target(t),text:this.text(t),container:this.container,trigger:t,emitter:this})}},{key:"defaultAction",value:function(e){return l("action",e)}},{key:"defaultTarget",value:function(e){var t=l("target",e);if(t)return document.querySelector(t)}},{key:"defaultText",value:function(e){return l("text",e)}},{key:"destroy",value:function(){this.listener.destroy(),this.clipboardAction&&(this.clipboardAction.destroy(),this.clipboardAction=null)}}],[{key:"isSupported",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["copy","cut"],t="string"==typeof e?[e]:e,n=!!document.queryCommandSupported;return t.forEach(function(e){n=n&&!!document.queryCommandSupported(e)}),n}}]),t}(c.default);e.exports=h})},,function(e,t){function n(e,t){return!!(t=null==t?r:t)&&("number"==typeof e||o.test(e))&&e>-1&&e%1==0&&e<t}var r=9007199254740991,o=/^(?:0|[1-9]\d*)$/;e.exports=n},function(e,t,n){(function(r){function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=o(u),f=n(514),d=o(f),p=n(515),h=o(p),m=n(275),g=o(m),_=n(256),v=o(_),y=n(5),b=o(y),w=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={visible:!1},n.componentClick=n.componentClick.bind(n),n.closeMenuPopover=n.closeMenuPopover.bind(n),n.handleVisibleChange=n.handleVisibleChange.bind(n),n}return s(t,e),l(t,null,[{key:"propTypes",get:function(){return{currentUser:u.PropTypes.object}}}]),l(t,[{key:"handleVisibleChange",value:function(e){this.setState({visible:e})}},{key:"closeMenuPopover",value:function(){this.state.visible&&this.setState({visible:!1})}},{key:"componentClick",value:function(e){if(!(this.props.currentUser.id<0||b.default.isMobile())){var t=this.refs.popover.getPopupDomNode();this.state.visible&&!t.contains(e.target)&&this.closeMenuPopover()}}},{key:"renderContent",value:function(){var e=this.props.currentUser;return c.default.createElement(h.default,{currentUser:e,closeMenuPopover:this.closeMenuPopover})}},{key:"toProfile",value:function(){r("/profile")}},{key:"render",value:function(){var e=this.props.currentUser,t=e.avatar,n=this.state.visible;return b.default.isMobile()?c.default.createElement("div",{className:"config-avatar-wrap",onClick:this.toProfile},c.default.createElement(d.default,{customClass:"config-avatar",avatarSrc:t})):e.id<0?c.default.createElement("div",{className:"config-avatar-wrap"},c.default.createElement(d.default,{customClass:"config-avatar anonymous",avatarSrc:t})):c.default.createElement(g.default,{ref:"popover",overlayClassName:"header-menu-popover",visible:n,onVisibleChange:this.handleVisibleChange,align:{offset:[13,3]},content:this.renderContent()},c.default.createElement("div",{className:"config-avatar-wrap"},c.default.createElement(d.default,{customClass:"config-avatar",avatarSrc:t})))}}]),t}(u.Component);t.default=(0,v.default)(w),e.exports=t.default}).call(t,n(23))},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(5),f=r(c),d=n(72),p=n(20),h=r(p),m=n(179),g=r(m),_=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={starred:e.currentFile.starred},n.notLoggedStar=n.notLoggedStar.bind(n),n.loggedStar=n.loggedStar.bind(n),n}return a(t,e),s(t,null,[{key:"propTypes",get:function(){return{currentFile:l.PropTypes.object,currentUser:l.PropTypes.object}}}]),s(t,[{key:"notLoggedStar",value:function(){var e=this.props.currentFile.id,t=this.props.currentFile.guid;f.default.isMobile()?window.location.href="/register?redirect_url="+encodeURIComponent("/desktop?fileid="+e+"&guid="+t):window.location.href="/register?redirect_url="+encodeURIComponent("/favorites?fileid="+e+"&guid="+t)}},{key:"loggedStar",value:function(){var e=this,t=this.props.currentFile.id,n=this.props.currentFile,r=(n.shareMode,n.type,this.props.currentUser.id>0);this.state.starred?(0,d.unstarFile)(t).then(function(){e.setState({starred:!1})},function(e){f.default.alert({title:e.message,type:"error"})}):(0,d.starFile)(t).then(function(){r&&(f.default.isMobile()?(0,g.default)("文档已标星"):f.default.alert({title:"文档已标星"})),e.setState({starred:!0})},function(e){f.default.alert({title:e.message,type:"error"})})}},{key:"isReadonly",value:function(e){return!!e.match(/readonly/)}},{key:"isEditable",value:function(e){return!!e.match(/editable/)}},{key:"render",value:function(){var e=this.props.currentFile,t=e.shareMode,n=e.type,r=e.teamId,o=this.props.currentUser.id>0,i=this.isReadonly,a=this.isEditable;if(!f.default.isMobile()&&i(t)&&0===n&&!o)return u.default.createElement("span",null,u.default.createElement("a",{className:"readonly-operation mark-star",onClick:this.notLoggedStar},"标星收藏"),u.default.createElement("a",{href:"/register",className:"readonly-operation register-or-login"},"注册 / 登录"));if(!f.default.isMobile()&&i(t)&&0===n&&o){var s=(0,h.default)({"readonly-operation":!0,"mark-star":!0,active:this.state.starred});return u.default.createElement("span",null,u.default.createElement("a",{className:s,onClick:this.loggedStar},this.state.starred?"取消标星":"标星收藏"))}if(!f.default.isMobile()&&a(t)&&0===n&&!o)return u.default.createElement("div",{className:"right-btn-group"},u.default.createElement("a",{className:"right-btn mark-star",onClick:this.notLoggedStar},"标星收藏"),u.default.createElement("a",{href:"/register",className:"right-btn register-or-login"},"注册 / 登录"));if(!f.default.isMobile()&&i(t)&&(-1===n||-3===n)&&!o)return u.default.createElement("div",{className:"readonly-btn-group"},u.default.createElement("a",{className:"readonly-operation mark-star",onClick:this.notLoggedStar},"标星收藏"),u.default.createElement("a",{href:"/register",className:"readonly-operation register-or-login"},"注册 / 登录"));if(!f.default.isMobile()&&i(t)&&(-1===n||-3===n)&&o){var l=(0,h.default)({"readonly-loggin-star":!0,"header-star-btn":!0,"s-header-star-btn":!0,active:this.state.starred});return u.default.createElement("a",{className:l,onClick:this.loggedStar},u.default.createElement("span",{className:"team-sprite team-icon-star mark-star-icon"}),u.default.createElement("span",{className:"s-tooltip"},this.state.starred?"取消标星":"标星"))}if(!f.default.isMobile()&&a(t)&&(-1===n||-3===n)&&!o)return u.default.createElement("div",{className:"right-btn-group"},u.default.createElement("a",{className:"right-btn mark-star",onClick:this.notLoggedStar},"标星收藏"),u.default.createElement("a",{href:"/register",className:"right-btn register-or-login"},"注册 / 登录"));if(f.default.isMobile()&&i(t)&&0===n&&!o)return r?u.default.createElement("span",null,u.default.createElement("a",{className:"favorite-btn",onClick:this.notLoggedStar},"收藏")):u.default.createElement("span",null,u.default.createElement("a",{href:"/register",className:"mobile-register-or-login"},"注册 / 登录"));if(f.default.isMobile()&&i(t)&&0===n&&o){var c=(0,h.default)({"readonly-operation":!0,"mark-star":!0,active:this.state.starred});return u.default.createElement("span",null,u.default.createElement("a",{className:c,onClick:this.loggedStar},this.state.starred?"取消标星":"标星收藏"))}if(f.default.isMobile()&&a(t)&&0===n&&!o)return r?u.default.createElement("span",null,u.default.createElement("a",{className:"favorite-btn",onClick:this.notLoggedStar},"收藏")):u.default.createElement("span",null,u.default.createElement("a",{href:"/register",className:"mobile-register-or-login"},"注册 / 登录"));if(f.default.isMobile()&&a(t)&&0===n&&o){var d=(0,h.default)({"mark-star":!0,active:this.state.starred});return u.default.createElement("span",null,u.default.createElement("a",{className:d,onClick:this.loggedStar},this.state.starred?"取消标星":"标星收藏"))}if(f.default.isMobile()&&i(t)&&(-1===n||-3===n)&&!o)return r?u.default.createElement("div",{className:"readonly-btn-group"},u.default.createElement("a",{className:"readonly-operation mobile-readonly-anonymous-star",onClick:this.notLoggedStar},"标星收藏")):u.default.createElement("div",{className:"readonly-btn-group"},u.default.createElement("a",{href:"/register",className:"readonly-operation register-or-login"},"注册 / 登录"));if(f.default.isMobile()&&i(t)&&(-1===n||-3===n)&&o){var p=(0,h.default)({"readonly-operation":!0,"mark-star":!0,active:this.state.starred});return u.default.createElement("span",null,u.default.createElement("a",{className:p,onClick:this.loggedStar},this.state.starred?"取消标星":"标星收藏"))}if(f.default.isMobile()&&a(t)&&(-1===n||-3===n)&&!o)return r?u.default.createElement("span",null,u.default.createElement("a",{className:"mobile-editable-anonymous-star",onClick:this.notLoggedStar},"标星收藏")):u.default.createElement("span",null,u.default.createElement("a",{href:"/register",className:"mobile-register-or-login"},"注册 / 登录"));if(f.default.isMobile()&&a(t)&&(-1===n||-3===n)&&o){var m=(0,h.default)({"mark-star":!0,active:this.state.starred});return u.default.createElement("span",null,u.default.createElement("a",{className:m,onClick:this.loggedStar},this.state.starred?"取消标星":"标星收藏"))}return null}}]),t}(l.Component);t.default=_,e.exports=t.default},,,,,function(e,t){function n(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=r}var r=9007199254740991;e.exports=n},function(e,t,n){(function(r){function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(0),f=o(c),d=n(13),p=o(d),h=n(271),m=o(h),g=n(746),_=o(g),v=n(20),y=o(v),b=n(256),w=o(b);n(785);var C=function(e){function t(e){a(this,t);var n=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={position:n.calcPosition()},n.getTooltipContainer=n.getTooltipContainer.bind(n),n.componentResize=n.componentResize.bind(n),n.componentClick=n.componentClick.bind(n),n.handleTriggerEvent=n.handleTriggerEvent.bind(n),n.handleTriggerEvents=r.zipObject(e.triggerEvents,e.triggerEvents.map(function(){return n.handleTriggerEvent})),e.isDebounced&&(n.handleTriggerEvents=r.zipObject(e.triggerEvents,e.triggerEvents.map(function(t){return e.debounceConfig&&r.isNumber(e.debounceConfig[t])?r.debounce(n.handleTriggerEvent,e.debounceConfig[t]):r.debounce(n.handleTriggerEvent,e.maxWait)}))),n}return l(t,e),u(t,null,[{key:"propTypes",get:function(){return{text:c.PropTypes.string,colorName:c.PropTypes.string,customClass:c.PropTypes.string,positionNodeElement:c.PropTypes.instanceOf(Element),triggerNodeElement:c.PropTypes.instanceOf(Element),triggerEvents:c.PropTypes.array,autoUpdate:c.PropTypes.bool,isDebounced:c.PropTypes.bool,debounceConfig:c.PropTypes.object,maxWait:c.PropTypes.number,offsetLeft:c.PropTypes.number,offsetTop:c.PropTypes.number,color:c.PropTypes.string,hasBubble:c.PropTypes.bool,viewRect:c.PropTypes.shape({minLeft:c.PropTypes.number,minTop:c.PropTypes.number,maxLeft:c.PropTypes.numner,maxTop:c.PropTypes.number}),visible:c.PropTypes.bool,placement:c.PropTypes.oneOf(["top","right","bottom","left","topLeft","topRight","bottomLeft","bottomRight","leftTop","leftBottom","rightTop","rightBottom"]),autoHide:c.PropTypes.bool,onNeedHide:c.PropTypes.func}}},{key:"defaultProps",get:function(){return{offsetLeft:0,offSetTop:0,color:"#41464b",hasBubble:!0,placement:"left",colorName:"yellow",autoUpdate:!0,isDebounced:!1,maxWait:300,triggerEvents:[]}}}]),u(t,[{key:"componentDidMount",value:function(){this.bindTriggerEvents()}},{key:"componentWillReceiveProps",value:function(e){e&&(e.visible&&!this.props.visible?(this.updatePosition(e),this.bindTriggerEvents(e)):!e.visible&&this.props.visible?this.unbindTriggerEvents(this.props):e.autoUpdate&&!this.props.autoUpdate?this.bindTriggerEvents(e):!e.autoUpdate&&this.props.autoUpdate?this.unbindTriggerEvents(this.props):e.triggerNodeElement&&!this.props.triggerNodeElement?this.bindTriggerEvents(e):!e.triggerNodeElement&&this.props.triggerNodeElement?this.unbindTriggerEvents(this.props):e.triggerEvents.length!==this.props.triggerEvents.length&&(this.unbindTriggerEvents(this.props),this.bindTriggerEvents(e)))}},{key:"componentWillUnmount",value:function(){this.intervalId>-1&&(clearInterval(this.intervalId),this.intervalId=-1),this.unbindTriggerEvents()}},{key:"bindTriggerEvents",value:function(e){var t=this,n=e||this.props,r=n.autoUpdate,o=n.triggerNodeElement,i=n.triggerEvents;r&&o&&i.length&&i.forEach(function(e){o.addEventListener(e,t.handleTriggerEvents[e])})}},{key:"unbindTriggerEvents",value:function(e){var t=this,n=e||this.props,r=n.autoUpdate,o=n.triggerNodeElement,i=n.triggerEvents;r&&o&&i.length&&i.forEach(function(e){o.removeEventListener(e,t.handleTriggerEvents[e])})}},{key:"handleTriggerEvent",value:function(){this.props.visible&&this.updatePosition()}},{key:"calcPosition",value:function(e){var t=e||this.props,n=t.positionNodeElement,r=t.offsetLeft,o=t.offsetTop;if(!n)return{left:0,top:0};var i=n.getBoundingClientRect(),a=i.top+window.pageYOffset-n.clientTop;return{left:i.left+window.pageXOffset-n.clientLeft+(isNaN(r)?0:r),top:a+(isNaN(o)?0:o)}}},{key:"getTooltipContainer",value:function(){return p.default.findDOMNode(this)}},{key:"renderBubble",value:function(){var e=this.props,t=e.hasBubble,n=e.visible;return t&&n?f.default.createElement(_.default,null):f.default.createElement("div",{className:"guide-no-bubble"})}},{key:"componentResize",value:function(){this.updatePosition()}},{key:"componentClick",value:function(){this.props.autoHide&&"function"==typeof this.props.onNeedHide&&this.props.onNeedHide()}},{key:"updatePosition",value:function(e,t){var n=this.state.position,r=this.calcPosition(e);["top","left"].some(function(e){return r[e]!==n[e]})&&this.setState({position:r},function(){"function"==typeof t&&t(r)})}},{key:"render",value:function(){var e;if(!this.props.positionNodeElement)return null;var t=this.state.position,n=this.props,o=n.customClass,a=n.colorName,s=n.viewRect;if(s&&(r.isNumber(s.minLeft)&&t.left<s.minLeft||r.isNumber(s.minTop)&&t.top<s.minTop||r.isNumber(s.maxLeft)&&t.left>s.maxLeft||r.isNumber(s.maxTop)&&t.top>s.maxTop))return null;var l=r.assign({position:"fixed",pointerEvents:"none"},t),u=(0,y.default)((e={"guide-tip-wrap":!0},i(e,""+o,!!o),i(e,""+a,!!a),e));return f.default.createElement("div",{className:u,style:l},f.default.createElement(m.default,{title:this.props.text,arrowPointAtCenter:!0,placement:this.props.placement,visible:this.props.visible,getTooltipContainer:this.getTooltipContainer},this.renderBubble()))}}]),t}(c.Component);t.default=(0,w.default)(C),e.exports=t.default}).call(t,n(1))},function(e,t){function n(e){return e}e.exports=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,WIN_IME:229};r.isTextModifyingKeyEvent=function(e){var t=e.keyCode;if(e.altKey&&!e.ctrlKey||e.metaKey||t>=r.F1&&t<=r.F12)return!1;switch(t){case r.ALT:case r.CAPS_LOCK:case r.CONTEXT_MENU:case r.CTRL:case r.DOWN:case r.END:case r.ESC:case r.HOME:case r.INSERT:case r.LEFT:case r.MAC_FF_META:case r.META:case r.NUMLOCK:case r.NUM_CENTER:case r.PAGE_DOWN:case r.PAGE_UP:case r.PAUSE:case r.PRINT_SCREEN:case r.RIGHT:case r.SHIFT:case r.UP:case r.WIN_KEY:case r.WIN_KEY_RIGHT:return!1;default:return!0}},r.isCharacterKey=function(e){if(e>=r.ZERO&&e<=r.NINE)return!0;if(e>=r.NUM_ZERO&&e<=r.NUM_MULTIPLY)return!0;if(e>=r.A&&e<=r.Z)return!0;if(-1!==window.navigation.userAgent.indexOf("WebKit")&&0===e)return!0;switch(e){case r.SPACE:case r.QUESTION_MARK:case r.NUM_PLUS:case r.NUM_MINUS:case r.NUM_PERIOD:case r.NUM_DIVISION:case r.SEMICOLON:case r.DASH:case r.EQUALS:case r.COMMA:case r.PERIOD:case r.SLASH:case r.APOSTROPHE:case r.SINGLE_QUOTE:case r.OPEN_SQUARE_BRACKET:case r.BACKSLASH:case r.CLOSE_SQUARE_BRACKET:return!0;default:return!1}},t.default=r,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(){}function i(e,t,n){var r=t||"";return e.key||r+"item_"+n}function a(e,t){var n=-1;u.default.Children.forEach(e,function(e){n++,e&&e.type&&e.type.isMenuItemGroup?u.default.Children.forEach(e.props.children,function(e){n++,t(e,n)}):t(e,n)})}function s(e,t,n){e&&!n.find&&u.default.Children.forEach(e,function(e){if(!n.find&&e){var r=e.type;if(!r||!(r.isSubMenu||r.isMenuItem||r.isMenuItemGroup))return;-1!==t.indexOf(e.key)?n.find=!0:e.props.children&&s(e.props.children,t,n)}})}Object.defineProperty(t,"__esModule",{value:!0}),t.noop=o,t.getKeyFromChildrenIndex=i,t.loopMenuItem=a,t.loopMenuItemRecusively=s;var l=n(0),u=r(l)},function(e,t,n){"use strict";function r(e,t){for(var n=t;n;){if(n===e)return!0;n=n.parentNode}return!1}function o(e,t){return e[0]===t[0]&&e[1]===t[1]}function i(e,t,n){var r=e[t]||{};return le.a({},r,n)}function a(e,t,n){var r=n.points;for(var i in e)if(e.hasOwnProperty(i)&&o(e[i].points,r))return t+"-placement-"+i;return""}function s(){}function l(){return""}function u(){return window.document}Object.defineProperty(t,"__esModule",{value:!0});var c=n(510),f=n.n(c),d=n(139),p=n.n(d),h=n(140),m=n.n(h),g=n(141),_=n.n(g),v=n(142),y=n.n(v),b=n(0),w=n.n(b),C=n(37),S=n.n(C),x=function(e){function t(){return p.a(this,t),_.a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return y.a(t,e),m.a(t,[{key:"shouldComponentUpdate",value:function(e){return e.hiddenClassName||e.visible}},{key:"render",value:function(){var e=this.props,t=e.hiddenClassName,n=e.visible,r=f.a(e,["hiddenClassName","visible"]);return t||w.a.Children.count(r.children)>1?(!n&&t&&(r.className+=" "+t),w.a.createElement("div",r)):w.a.Children.only(r.children)}}]),t}(b.Component);x.propTypes={children:S.a.any,className:S.a.string,visible:S.a.bool,hiddenClassName:S.a.string};var T=x,E=n(139),M=n.n(E),A=n(140),k=n.n(A),R=n(141),I=n.n(R),O=n(142),D=n.n(O),P=n(0),N=n.n(P),F=n(37),L=n.n(F),H=function(e){function t(){return M.a(this,t),I.a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return D.a(t,e),k.a(t,[{key:"render",value:function(){var e=this.props,t=e.className;return e.visible||(t+=" "+e.hiddenClassName),N.a.createElement("div",{className:t,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,style:e.style},N.a.createElement(T,{className:e.prefixCls+"-content",visible:e.visible},e.children))}}]),t}(P.Component);H.propTypes={hiddenClassName:L.a.string,className:L.a.string,prefixCls:L.a.string,onMouseEnter:L.a.func,onMouseLeave:L.a.func,children:L.a.any};var V=H,j=n(67),B=n.n(j),U=n(139),W=n.n(U),z=n(140),Y=n.n(z),G=n(141),K=n.n(G),X=n(142),q=n.n(X),J=n(0),Z=n.n(J),Q=n(37),$=n.n(Q),ee=n(13),te=n.n(ee),ne=n(497),re=n.n(ne),oe=n(342),ie=function(e){function t(){var e,n,r,o;W.a(this,t);for(var i=arguments.length,a=Array(i),s=0;s<i;s++)a[s]=arguments[s];return n=r=K.a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),r.onAlign=function(e,t){var n=r.props,o=n.getClassNameFromAlign(t);r.currentAlignClassName!==o&&(r.currentAlignClassName=o,e.className=r.getClassName(o)),n.onAlign(e,t)},r.getTarget=function(){return r.props.getRootDomNode()},r.saveAlign=function(e){r.alignInstance=e},o=n,K.a(r,o)}return q.a(t,e),Y.a(t,[{key:"componentDidMount",value:function(){this.rootNode=this.getPopupDomNode()}},{key:"getPopupDomNode",value:function(){return te.a.findDOMNode(this.refs.popup)}},{key:"getMaskTransitionName",value:function(){var e=this.props,t=e.maskTransitionName,n=e.maskAnimation;return!t&&n&&(t=e.prefixCls+"-"+n),t}},{key:"getTransitionName",value:function(){var e=this.props,t=e.transitionName;return!t&&e.animation&&(t=e.prefixCls+"-"+e.animation),t}},{key:"getClassName",value:function(e){return this.props.prefixCls+" "+this.props.className+" "+e}},{key:"getPopupElement",value:function(){var e=this.props,t=e.align,n=e.style,r=e.visible,o=e.prefixCls,i=e.destroyPopupOnHide,a=this.getClassName(this.currentAlignClassName||e.getClassNameFromAlign(t)),s=o+"-hidden";r||(this.currentAlignClassName=null);var l=B.a({},n,this.getZIndexStyle()),u={className:a,prefixCls:o,ref:"popup",onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,style:l};return i?Z.a.createElement(oe.default,{component:"",exclusive:!0,transitionAppear:!0,transitionName:this.getTransitionName()},r?Z.a.createElement(re.a,{target:this.getTarget,key:"popup",ref:this.saveAlign,monitorWindowResize:!0,align:t,onAlign:this.onAlign},Z.a.createElement(V,B.a({visible:!0},u),e.children)):null):Z.a.createElement(oe.default,{component:"",exclusive:!0,transitionAppear:!0,transitionName:this.getTransitionName(),showProp:"xVisible"},Z.a.createElement(re.a,{target:this.getTarget,key:"popup",ref:this.saveAlign,monitorWindowResize:!0,xVisible:r,childrenProps:{visible:"xVisible"},disabled:!r,align:t,onAlign:this.onAlign},Z.a.createElement(V,B.a({hiddenClassName:s},u),e.children)))}},{key:"getZIndexStyle",value:function(){var e={},t=this.props;return void 0!==t.zIndex&&(e.zIndex=t.zIndex),e}},{key:"getMaskElement",value:function(){var e=this.props,t=void 0;if(e.mask){var n=this.getMaskTransitionName();t=Z.a.createElement(T,{style:this.getZIndexStyle(),key:"mask",className:e.prefixCls+"-mask",hiddenClassName:e.prefixCls+"-mask-hidden",visible:e.visible}),n&&(t=Z.a.createElement(oe.default,{key:"mask",showProp:"visible",transitionAppear:!0,component:"",transitionName:n},t))}return t}},{key:"render",value:function(){return Z.a.createElement("div",null,this.getMaskElement(),this.getPopupElement())}}]),t}(J.Component);ie.propTypes={visible:$.a.bool,style:$.a.object,getClassNameFromAlign:$.a.func,onAlign:$.a.func,getRootDomNode:$.a.func,onMouseEnter:$.a.func,align:$.a.any,destroyPopupOnHide:$.a.bool,className:$.a.string,prefixCls:$.a.string,onMouseLeave:$.a.func};var ae=ie,se=n(67),le=n.n(se),ue=n(67),ce=n.n(ue),fe=n(0),de=n.n(fe),pe=n(37),he=n.n(pe),me=n(13),ge=(n.n(me),n(145)),_e=n.n(ge),ve=n(258),ye=n.n(ve),be=n(511),we=n.n(be),Ce=["onClick","onMouseDown","onTouchStart","onMouseEnter","onMouseLeave","onFocus","onBlur"],Se=_e.a({displayName:"Trigger",propTypes:{children:he.a.any,action:he.a.oneOfType([he.a.string,he.a.arrayOf(he.a.string)]),showAction:he.a.any,hideAction:he.a.any,getPopupClassNameFromAlign:he.a.any,onPopupVisibleChange:he.a.func,afterPopupVisibleChange:he.a.func,popup:he.a.oneOfType([he.a.node,he.a.func]).isRequired,popupStyle:he.a.object,prefixCls:he.a.string,popupClassName:he.a.string,popupPlacement:he.a.string,builtinPlacements:he.a.object,popupTransitionName:he.a.oneOfType([he.a.string,he.a.object]),popupAnimation:he.a.any,mouseEnterDelay:he.a.number,mouseLeaveDelay:he.a.number,zIndex:he.a.number,focusDelay:he.a.number,blurDelay:he.a.number,getPopupContainer:he.a.func,getDocument:he.a.func,destroyPopupOnHide:he.a.bool,mask:he.a.bool,maskClosable:he.a.bool,onPopupAlign:he.a.func,popupAlign:he.a.object,popupVisible:he.a.bool,maskTransitionName:he.a.oneOfType([he.a.string,he.a.object]),maskAnimation:he.a.string},mixins:[we.a({autoMount:!1,isVisible:function(e){return e.state.popupVisible},getContainer:function(e){var t=e.props,n=document.createElement("div");return n.style.position="absolute",n.style.top="0",n.style.left="0",n.style.width="100%",(t.getPopupContainer?t.getPopupContainer(me.findDOMNode(e)):t.getDocument().body).appendChild(n),n}})],getDefaultProps:function(){return{prefixCls:"rc-trigger-popup",getPopupClassNameFromAlign:l,getDocument:u,onPopupVisibleChange:s,afterPopupVisibleChange:s,onPopupAlign:s,popupClassName:"",mouseEnterDelay:0,mouseLeaveDelay:.1,focusDelay:0,blurDelay:.15,popupStyle:{},destroyPopupOnHide:!1,popupAlign:{},defaultPopupVisible:!1,mask:!1,maskClosable:!0,action:[],showAction:[],hideAction:[]}},getInitialState:function(){var e=this.props,t=void 0;return t="popupVisible"in e?!!e.popupVisible:!!e.defaultPopupVisible,{popupVisible:t}},componentWillMount:function(){var e=this;Ce.forEach(function(t){e["fire"+t]=function(n){e.fireEvents(t,n)}})},componentDidMount:function(){this.componentDidUpdate({},{popupVisible:this.state.popupVisible})},componentWillReceiveProps:function(e){var t=e.popupVisible;void 0!==t&&this.setState({popupVisible:t})},componentDidUpdate:function(e,t){var n=this.props,r=this.state;if(this.renderComponent(null,function(){t.popupVisible!==r.popupVisible&&n.afterPopupVisibleChange(r.popupVisible)}),r.popupVisible){var o=void 0;return!this.clickOutsideHandler&&this.isClickToHide()&&(o=n.getDocument(),this.clickOutsideHandler=ye.a(o,"mousedown",this.onDocumentClick)),void(this.touchOutsideHandler||(o=o||n.getDocument(),this.touchOutsideHandler=ye.a(o,"touchstart",this.onDocumentClick)))}this.clearOutsideHandler()},componentWillUnmount:function(){this.clearDelayTimer(),this.clearOutsideHandler()},onMouseEnter:function(e){this.fireEvents("onMouseEnter",e),this.delaySetPopupVisible(!0,this.props.mouseEnterDelay)},onMouseLeave:function(e){this.fireEvents("onMouseLeave",e),this.delaySetPopupVisible(!1,this.props.mouseLeaveDelay)},onPopupMouseEnter:function(){this.clearDelayTimer()},onPopupMouseLeave:function(e){e.relatedTarget&&!e.relatedTarget.setTimeout&&this._component&&r(this._component.getPopupDomNode(),e.relatedTarget)||this.delaySetPopupVisible(!1,this.props.mouseLeaveDelay)},onFocus:function(e){this.fireEvents("onFocus",e),this.clearDelayTimer(),this.isFocusToShow()&&(this.focusTime=Date.now(),this.delaySetPopupVisible(!0,this.props.focusDelay))},onMouseDown:function(e){this.fireEvents("onMouseDown",e),this.preClickTime=Date.now()},onTouchStart:function(e){this.fireEvents("onTouchStart",e),this.preTouchTime=Date.now()},onBlur:function(e){this.fireEvents("onBlur",e),this.clearDelayTimer(),this.isBlurToHide()&&this.delaySetPopupVisible(!1,this.props.blurDelay)},onClick:function(e){if(this.fireEvents("onClick",e),this.focusTime){var t=void 0;if(this.preClickTime&&this.preTouchTime?t=Math.min(this.preClickTime,this.preTouchTime):this.preClickTime?t=this.preClickTime:this.preTouchTime&&(t=this.preTouchTime),Math.abs(t-this.focusTime)<20)return;this.focusTime=0}this.preClickTime=0,this.preTouchTime=0,e.preventDefault();var n=!this.state.popupVisible;(this.isClickToHide()&&!n||n&&this.isClickToShow())&&this.setPopupVisible(!this.state.popupVisible)},onDocumentClick:function(e){if(!this.props.mask||this.props.maskClosable){var t=e.target,n=me.findDOMNode(this),o=this.getPopupDomNode();r(n,t)||r(o,t)||this.close()}},getPopupDomNode:function(){return this._component&&this._component.getPopupDomNode?this._component.getPopupDomNode():null},getRootDomNode:function(){return me.findDOMNode(this)},getPopupClassNameFromAlign:function(e){var t=[],n=this.props,r=n.popupPlacement,o=n.builtinPlacements,i=n.prefixCls;return r&&o&&t.push(a(o,i,e)),n.getPopupClassNameFromAlign&&t.push(n.getPopupClassNameFromAlign(e)),t.join(" ")},getPopupAlign:function(){var e=this.props,t=e.popupPlacement,n=e.popupAlign,r=e.builtinPlacements;return t&&r?i(r,t,n):n},getComponent:function(){var e=this.props,t=this.state,n={};return this.isMouseEnterToShow()&&(n.onMouseEnter=this.onPopupMouseEnter),this.isMouseLeaveToHide()&&(n.onMouseLeave=this.onPopupMouseLeave),de.a.createElement(ae,ce.a({prefixCls:e.prefixCls,destroyPopupOnHide:e.destroyPopupOnHide,visible:t.popupVisible,className:e.popupClassName,action:e.action,align:this.getPopupAlign(),onAlign:e.onPopupAlign,animation:e.popupAnimation,getClassNameFromAlign:this.getPopupClassNameFromAlign},n,{getRootDomNode:this.getRootDomNode,style:e.popupStyle,mask:e.mask,zIndex:e.zIndex,transitionName:e.popupTransitionName,maskAnimation:e.maskAnimation,maskTransitionName:e.maskTransitionName}),"function"==typeof e.popup?e.popup():e.popup)},setPopupVisible:function(e){this.clearDelayTimer(),this.state.popupVisible!==e&&("popupVisible"in this.props||this.setState({popupVisible:e}),this.props.onPopupVisibleChange(e))},delaySetPopupVisible:function(e,t){var n=this,r=1e3*t;this.clearDelayTimer(),r?this.delayTimer=setTimeout(function(){n.setPopupVisible(e),n.clearDelayTimer()},r):this.setPopupVisible(e)},clearDelayTimer:function(){this.delayTimer&&(clearTimeout(this.delayTimer),this.delayTimer=null)},clearOutsideHandler:function(){this.clickOutsideHandler&&(this.clickOutsideHandler.remove(),this.clickOutsideHandler=null),this.touchOutsideHandler&&(this.touchOutsideHandler.remove(),this.touchOutsideHandler=null)},createTwoChains:function(e){var t=this.props.children.props,n=this.props;return t[e]&&n[e]?this["fire"+e]:t[e]||n[e]},isClickToShow:function(){var e=this.props,t=e.action,n=e.showAction;return-1!==t.indexOf("click")||-1!==n.indexOf("click")},isClickToHide:function(){var e=this.props,t=e.action,n=e.hideAction;return-1!==t.indexOf("click")||-1!==n.indexOf("click")},isMouseEnterToShow:function(){var e=this.props,t=e.action,n=e.showAction;return-1!==t.indexOf("hover")||-1!==n.indexOf("mouseEnter")},isMouseLeaveToHide:function(){var e=this.props,t=e.action,n=e.hideAction;return-1!==t.indexOf("hover")||-1!==n.indexOf("mouseLeave")},isFocusToShow:function(){var e=this.props,t=e.action,n=e.showAction;return-1!==t.indexOf("focus")||-1!==n.indexOf("focus")},isBlurToHide:function(){var e=this.props,t=e.action,n=e.hideAction;return-1!==t.indexOf("focus")||-1!==n.indexOf("blur")},forcePopupAlign:function(){this.state.popupVisible&&this._component&&this._component.alignInstance&&this._component.alignInstance.forceAlign()},fireEvents:function(e,t){var n=this.props.children.props[e];n&&n(t);var r=this.props[e];r&&r(t)},close:function(){this.setPopupVisible(!1)},render:function(){var e=this.props,t=e.children,n=de.a.Children.only(t),r={};return this.isClickToHide()||this.isClickToShow()?(r.onClick=this.onClick,r.onMouseDown=this.onMouseDown,r.onTouchStart=this.onTouchStart):(r.onClick=this.createTwoChains("onClick"),r.onMouseDown=this.createTwoChains("onMouseDown"),r.onTouchStart=this.createTwoChains("onTouchStart")),this.isMouseEnterToShow()?r.onMouseEnter=this.onMouseEnter:r.onMouseEnter=this.createTwoChains("onMouseEnter"),this.isMouseLeaveToHide()?r.onMouseLeave=this.onMouseLeave:r.onMouseLeave=this.createTwoChains("onMouseLeave"),this.isFocusToShow()||this.isBlurToHide()?(r.onFocus=this.onFocus,r.onBlur=this.onBlur):(r.onFocus=this.createTwoChains("onFocus"),r.onBlur=this.createTwoChains("onBlur")),de.a.cloneElement(n,r)}});t.default=Se},function(e,t,n){"use strict";function r(e){var t=[];return f.a.Children.forEach(e,function(e){t.push(e)}),t}function o(e,t){var n=null;return e&&e.forEach(function(e){n||e&&e.key===t&&(n=e)}),n}function i(e,t,n){var r=null;return e&&e.forEach(function(e){if(e&&e.key===t&&e.props[n]){if(r)throw new Error("two child with same key for <rc-animate> children");r=e}}),r}function a(e,t,n){var r=e.length===t.length;return r&&e.forEach(function(e,o){var i=t[o];e&&i&&(e&&!i||!e&&i?r=!1:e.key!==i.key?r=!1:n&&e.props[n]!==i.props[n]&&(r=!1))}),r}function s(e,t){var n=[],r={},i=[];return e.forEach(function(e){e&&o(t,e.key)?i.length&&(r[e.key]=i,i=[]):i.push(e)}),t.forEach(function(e){e&&r.hasOwnProperty(e.key)&&(n=n.concat(r[e.key])),n.push(e)}),n=n.concat(i)}function l(e){var t=e.children;return X.a.isValidElement(t)&&!t.key?X.a.cloneElement(t,{key:Z}):t}function u(){}Object.defineProperty(t,"__esModule",{value:!0});var c=n(0),f=n.n(c),d={isAppearSupported:function(e){return e.transitionName&&e.transitionAppear||e.animation.appear},isEnterSupported:function(e){return e.transitionName&&e.transitionEnter||e.animation.enter},isLeaveSupported:function(e){return e.transitionName&&e.transitionLeave||e.animation.leave},allowAppearCallback:function(e){return e.transitionAppear||e.animation.appear},allowEnterCallback:function(e){return e.transitionEnter||e.animation.enter},allowLeaveCallback:function(e){return e.transitionLeave||e.animation.leave}},p=d,h=n(184),m=n.n(h),g=n(139),_=n.n(g),v=n(140),y=n.n(v),b=n(141),w=n.n(b),C=n(142),S=n.n(C),x=n(0),T=n.n(x),E=n(13),M=n.n(E),A=n(37),k=n.n(A),R=n(507),I=n.n(R),O={enter:"transitionEnter",appear:"transitionAppear",leave:"transitionLeave"},D=function(e){function t(){return _.a(this,t),w.a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return S.a(t,e),y.a(t,[{key:"componentWillUnmount",value:function(){this.stop()}},{key:"componentWillEnter",value:function(e){p.isEnterSupported(this.props)?this.transition("enter",e):e()}},{key:"componentWillAppear",value:function(e){p.isAppearSupported(this.props)?this.transition("appear",e):e()}},{key:"componentWillLeave",value:function(e){p.isLeaveSupported(this.props)?this.transition("leave",e):e()}},{key:"transition",value:function(e,t){var n=this,r=M.a.findDOMNode(this),o=this.props,i=o.transitionName,a="object"===(void 0===i?"undefined":m.a(i));this.stop();var s=function(){n.stopper=null,t()};if((R.isCssAnimationSupported||!o.animation[e])&&i&&o[O[e]]){var l=a?i[e]:i+"-"+e,u=l+"-active";a&&i[e+"Active"]&&(u=i[e+"Active"]),this.stopper=I.a(r,{name:l,active:u},s)}else this.stopper=o.animation[e](r,s)}},{key:"stop",value:function(){var e=this.stopper;e&&(this.stopper=null,e.stop())}},{key:"render",value:function(){return this.props.children}}]),t}(T.a.Component);D.propTypes={children:k.a.any};var P=D,N=n(67),F=n.n(N),L=n(300),H=n.n(L),V=n(139),j=n.n(V),B=n(140),U=n.n(B),W=n(141),z=n.n(W),Y=n(142),G=n.n(Y),K=n(0),X=n.n(K),q=n(37),J=n.n(q),Z="rc_animate_"+Date.now(),Q=function(e){function t(e){j.a(this,t);var n=z.a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return $.call(n),n.currentlyAnimatingKeys={},n.keysToEnter=[],n.keysToLeave=[],n.state={children:r(l(n.props))},n.childrenRefs={},n}return G.a(t,e),U.a(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.showProp,n=this.state.children;t&&(n=n.filter(function(e){return!!e.props[t]})),n.forEach(function(t){t&&e.performAppear(t.key)})}},{key:"componentWillReceiveProps",value:function(e){var t=this;this.nextProps=e;var n=r(l(e)),a=this.props;a.exclusive&&Object.keys(this.currentlyAnimatingKeys).forEach(function(e){t.stop(e)});var u=a.showProp,c=this.currentlyAnimatingKeys,f=a.exclusive?r(l(a)):this.state.children,d=[];u?(f.forEach(function(e){var t=e&&o(n,e.key),r=void 0;(r=t&&t.props[u]||!e.props[u]?t:X.a.cloneElement(t||e,H.a({},u,!0)))&&d.push(r)}),n.forEach(function(e){e&&o(f,e.key)||d.push(e)})):d=s(f,n),this.setState({children:d}),n.forEach(function(e){var n=e&&e.key;if(!e||!c[n]){var r=e&&o(f,n);if(u){var a=e.props[u];if(r){!i(f,n,u)&&a&&t.keysToEnter.push(n)}else a&&t.keysToEnter.push(n)}else r||t.keysToEnter.push(n)}}),f.forEach(function(e){var r=e&&e.key;if(!e||!c[r]){var a=e&&o(n,r);if(u){var s=e.props[u];if(a){!i(n,r,u)&&s&&t.keysToLeave.push(r)}else s&&t.keysToLeave.push(r)}else a||t.keysToLeave.push(r)}})}},{key:"componentDidUpdate",value:function(){var e=this.keysToEnter;this.keysToEnter=[],e.forEach(this.performEnter);var t=this.keysToLeave;this.keysToLeave=[],t.forEach(this.performLeave)}},{key:"isValidChildByKey",value:function(e,t){var n=this.props.showProp;return n?i(e,t,n):o(e,t)}},{key:"stop",value:function(e){delete this.currentlyAnimatingKeys[e];var t=this.childrenRefs[e];t&&t.stop()}},{key:"render",value:function(){var e=this,t=this.props;this.nextProps=t;var n=this.state.children,r=null;n&&(r=n.map(function(n){if(null===n||void 0===n)return n;if(!n.key)throw new Error("must set key for <rc-animate> children");return X.a.createElement(P,{key:n.key,ref:function(t){return e.childrenRefs[n.key]=t},animation:t.animation,transitionName:t.transitionName,transitionEnter:t.transitionEnter,transitionAppear:t.transitionAppear,transitionLeave:t.transitionLeave},n)}));var o=t.component;if(o){var i=t;return"string"==typeof o&&(i=F.a({className:t.className,style:t.style},t.componentProps)),X.a.createElement(o,i,r)}return r[0]||null}}]),t}(X.a.Component);Q.propTypes={component:J.a.any,componentProps:J.a.object,animation:J.a.object,transitionName:J.a.oneOfType([J.a.string,J.a.object]),transitionEnter:J.a.bool,transitionAppear:J.a.bool,exclusive:J.a.bool,transitionLeave:J.a.bool,onEnd:J.a.func,onEnter:J.a.func,onLeave:J.a.func,onAppear:J.a.func,showProp:J.a.string},Q.defaultProps={animation:{},component:"span",componentProps:{},transitionEnter:!0,transitionLeave:!0,transitionAppear:!1,onEnd:u,onEnter:u,onLeave:u,onAppear:u};var $=function(){var e=this;this.performEnter=function(t){e.childrenRefs[t]&&(e.currentlyAnimatingKeys[t]=!0,e.childrenRefs[t].componentWillEnter(e.handleDoneAdding.bind(e,t,"enter")))},this.performAppear=function(t){e.childrenRefs[t]&&(e.currentlyAnimatingKeys[t]=!0,e.childrenRefs[t].componentWillAppear(e.handleDoneAdding.bind(e,t,"appear")))},this.handleDoneAdding=function(t,n){var o=e.props;if(delete e.currentlyAnimatingKeys[t],!o.exclusive||o===e.nextProps){var i=r(l(o));e.isValidChildByKey(i,t)?"appear"===n?p.allowAppearCallback(o)&&(o.onAppear(t),o.onEnd(t,!0)):p.allowEnterCallback(o)&&(o.onEnter(t),o.onEnd(t,!0)):e.performLeave(t)}},this.performLeave=function(t){e.childrenRefs[t]&&(e.currentlyAnimatingKeys[t]=!0,e.childrenRefs[t].componentWillLeave(e.handleDoneLeaving.bind(e,t)))},this.handleDoneLeaving=function(t){var n=e.props;if(delete e.currentlyAnimatingKeys[t],!n.exclusive||n===e.nextProps){var o=r(l(n));if(e.isValidChildByKey(o,t))e.performEnter(t);else{var i=function(){p.allowLeaveCallback(n)&&(n.onLeave(t),n.onEnd(t,!1))};a(e.state.children,o,n.showProp)?i():e.setState({children:o},i)}}}};t.default=Q},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(518),i=r(o);n(530),t.default=i.default,e.exports=t.default},,function(e,t,n){var r=n(419),o=n(617),i=n(618),a=n(265),s=n(418),l=n(411),u=Object.prototype,c=u.hasOwnProperty,f=i(function(e,t){if(s(t)||a(t))return void o(t,l(t),e);for(var n in t)c.call(t,n)&&r(e,n,t[n])});e.exports=f},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){function r(e,t,n){"__proto__"==t&&o?o(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}var o=n(420);e.exports=r},,function(e,t,n){function r(e){return a(e)?o(e):i(e)}var o=n(593),i=n(600),a=n(265);e.exports=r},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){function n(){return u}function r(e){c.push(e);var t=!0;return function(){if(t){t=!1;var n=c.indexOf(e);c.splice(n,1)}}}function o(e){if(!a.default(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(f)throw new Error("Reducers may not dispatch actions.");try{f=!0,u=l(u,e)}finally{f=!1}return c.slice().forEach(function(e){return e()}),e}function i(e){l=e,o({type:s.INIT})}if("function"!=typeof e)throw new Error("Expected the reducer to be a function.");var l=e,u=t,c=[],f=!1;return o({type:s.INIT}),{dispatch:o,subscribe:r,getState:n,replaceReducer:i}}t.__esModule=!0,t.default=o;var i=n(413),a=r(i),s={INIT:"@@redux/INIT"};t.ActionTypes=s},function(e,t,n){"use strict";function r(e){if(!e||"object"!=typeof e)return!1;var t="function"==typeof e.constructor?Object.getPrototypeOf(e):Object.prototype;if(null===t)return!0;var n=t.constructor;return"function"==typeof n&&n instanceof n&&o(n)===o(Object)}t.__esModule=!0,t.default=r;var o=function(e){return Function.prototype.toString.call(e)};e.exports=t.default},function(e,t,n){"use strict";function r(e,t){return Object.keys(e).reduce(function(n,r){return n[r]=t(e[r],r),n},{})}t.__esModule=!0,t.default=r,e.exports=t.default},function(e,t,n){"use strict";function r(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.reduceRight(function(e,t){return t(e)},e)}}t.__esModule=!0,t.default=r,e.exports=t.default},function(e,t,n){function r(e){if(!i(e))return!1;var t=o(e);return t==s||t==l||t==a||t==u}var o=n(198),i=n(175),a="[object AsyncFunction]",s="[object Function]",l="[object GeneratorFunction]",u="[object Proxy]";e.exports=r},function(e,t,n){(function(t){var n="object"==typeof t&&t&&t.Object===Object&&t;e.exports=n}).call(t,n(36))},function(e,t){function n(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||r)}var r=Object.prototype;e.exports=n},function(e,t,n){function r(e,t,n){var r=e[t];s.call(e,t)&&i(r,n)&&(void 0!==n||t in e)||o(e,t,n)}var o=n(409),i=n(325),a=Object.prototype,s=a.hasOwnProperty;e.exports=r},function(e,t,n){var r=n(269),o=function(){try{var e=r(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=o},function(e,t,n){var r,o,i;!function(a,s){o=[e,n(422)],r=s,void 0!==(i="function"==typeof r?r.apply(t,o):r)&&(e.exports=i)}(0,function(e,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=n(t),i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function(){function e(t){r(this,e),this.resolveOptions(t),this.initSelection()}return a(e,[{key:"resolveOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action=e.action,this.container=e.container,this.emitter=e.emitter,this.target=e.target,this.text=e.text,this.trigger=e.trigger,this.selectedText=""}},{key:"initSelection",value:function(){this.text?this.selectFake():this.target&&this.selectTarget()}},{key:"selectFake",value:function(){var e=this,t="rtl"==document.documentElement.getAttribute("dir");this.removeFake(),this.fakeHandlerCallback=function(){return e.removeFake()},this.fakeHandler=this.container.addEventListener("click",this.fakeHandlerCallback)||!0,this.fakeElem=document.createElement("textarea"),this.fakeElem.style.fontSize="12pt",this.fakeElem.style.border="0",this.fakeElem.style.padding="0",this.fakeElem.style.margin="0",this.fakeElem.style.position="absolute",this.fakeElem.style[t?"right":"left"]="-9999px";var n=window.pageYOffset||document.documentElement.scrollTop;this.fakeElem.style.top=n+"px",this.fakeElem.setAttribute("readonly",""),this.fakeElem.value=this.text,this.container.appendChild(this.fakeElem),this.selectedText=(0,o.default)(this.fakeElem),this.copyText()}},{key:"removeFake",value:function(){this.fakeHandler&&(this.container.removeEventListener("click",this.fakeHandlerCallback),this.fakeHandler=null,this.fakeHandlerCallback=null),this.fakeElem&&(this.container.removeChild(this.fakeElem),this.fakeElem=null)}},{key:"selectTarget",value:function(){this.selectedText=(0,o.default)(this.target),this.copyText()}},{key:"copyText",value:function(){var e=void 0;try{e=document.execCommand(this.action)}catch(t){e=!1}this.handleResult(e)}},{key:"handleResult",value:function(e){this.emitter.emit(e?"success":"error",{action:this.action,text:this.selectedText,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)})}},{key:"clearSelection",value:function(){this.trigger&&this.trigger.focus(),window.getSelection().removeAllRanges()}},{key:"destroy",value:function(){this.removeFake()}},{key:"action",set:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"copy";if(this._action=e,"copy"!==this._action&&"cut"!==this._action)throw new Error('Invalid "action" value, use either "copy" or "cut"')},get:function(){return this._action}},{key:"target",set:function(e){if(void 0!==e){if(!e||"object"!==(void 0===e?"undefined":i(e))||1!==e.nodeType)throw new Error('Invalid "target" value, use a valid Element');if("copy"===this.action&&e.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if("cut"===this.action&&(e.hasAttribute("readonly")||e.hasAttribute("disabled")))throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes');this._target=e}},get:function(){return this._target}}]),e}();e.exports=s})},function(e,t){function n(e){var t;if("SELECT"===e.nodeName)e.focus(),t=e.value;else if("INPUT"===e.nodeName||"TEXTAREA"===e.nodeName){var n=e.hasAttribute("readonly");n||e.setAttribute("readonly",""),e.select(),e.setSelectionRange(0,e.value.length),n||e.removeAttribute("readonly"),t=e.value}else{e.hasAttribute("contenteditable")&&e.focus();var r=window.getSelection(),o=document.createRange();o.selectNodeContents(e),r.removeAllRanges(),r.addRange(o),t=r.toString()}return t}e.exports=n},function(e,t){function n(){}n.prototype={on:function(e,t,n){var r=this.e||(this.e={});return(r[e]||(r[e]=[])).push({fn:t,ctx:n}),this},once:function(e,t,n){function r(){o.off(e,r),t.apply(n,arguments)}var o=this;return r._=t,this.on(e,r,n)},emit:function(e){var t=[].slice.call(arguments,1),n=((this.e||(this.e={}))[e]||[]).slice(),r=0,o=n.length;for(r;r<o;r++)n[r].fn.apply(n[r].ctx,t);return this},off:function(e,t){var n=this.e||(this.e={}),r=n[e],o=[];if(r&&t)for(var i=0,a=r.length;i<a;i++)r[i].fn!==t&&r[i].fn._!==t&&o.push(r[i]);return o.length?n[e]=o:delete n[e],this}},e.exports=n},function(e,t,n){function r(e,t,n){if(!e&&!t&&!n)throw new Error("Missing required arguments");if(!s.string(t))throw new TypeError("Second argument must be a String");if(!s.fn(n))throw new TypeError("Third argument must be a Function");if(s.node(e))return o(e,t,n);if(s.nodeList(e))return i(e,t,n);if(s.string(e))return a(e,t,n);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}function o(e,t,n){return e.addEventListener(t,n),{destroy:function(){e.removeEventListener(t,n)}}}function i(e,t,n){return Array.prototype.forEach.call(e,function(e){e.addEventListener(t,n)}),{destroy:function(){Array.prototype.forEach.call(e,function(e){e.removeEventListener(t,n)})}}}function a(e,t,n){return l(document.body,e,t,n)}var s=n(425),l=n(426);e.exports=r},function(e,t){t.node=function(e){return void 0!==e&&e instanceof HTMLElement&&1===e.nodeType},t.nodeList=function(e){var n=Object.prototype.toString.call(e);return void 0!==e&&("[object NodeList]"===n||"[object HTMLCollection]"===n)&&"length"in e&&(0===e.length||t.node(e[0]))},t.string=function(e){return"string"==typeof e||e instanceof String},t.fn=function(e){return"[object Function]"===Object.prototype.toString.call(e)}},function(e,t,n){function r(e,t,n,r,i){var a=o.apply(this,arguments);return e.addEventListener(n,a,i),{destroy:function(){e.removeEventListener(n,a,i)}}}function o(e,t,n,r){return function(n){n.delegateTarget=i(n.target,t),n.delegateTarget&&r.call(e,n)}}var i=n(427);e.exports=r},function(e,t){function n(e,t){for(;e&&e.nodeType!==r;){if("function"==typeof e.matches&&e.matches(t))return e;e=e.parentNode}}var r=9;if("undefined"!=typeof Element&&!Element.prototype.matches){var o=Element.prototype;o.matches=o.matchesSelector||o.mozMatchesSelector||o.msMatchesSelector||o.oMatchesSelector||o.webkitMatchesSelector}e.exports=n},function(e,t,n){(function(e){function n(t,n){return e.assign({},t,n)}Object.defineProperty(t,"__esModule",{value:!0}),t.updateState=n}).call(t,n(1))},,,,,function(e,t,n){(function(r){function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e){return e&&e.__esModule?e:{default:e}}function a(e){switch(e.type){case"RECONNECT_READY":S.cooperators.length=0,s(e.clients);break;case"USER_ENTER":s([e.userInfo]);break;case"USER_LEAVE":l([e.userInfo])}}function s(e){e.forEach(function(e){if(e.id!==x.id){var t=r.find(S.cooperators,{id:e.id});t?t.count++:(e.color=d(e.id),e.count=1,S.cooperators.push(e),m.default.notify("avatar:add",e))}}),u()}function l(e){e.forEach(function(e){e.id!==x.id&&r.remove(S.cooperators,function(t){return t.id===e.id&&--t.count<=0})}),u()}function u(){m.default.notify("cooperation:updateAvatar",S.cooperators)}function c(e){return S.status="loading",S.currentFileGuid=e,S.cooperators=[],u(),new Promise(function(t,n){y.default.getFileCollaborators(e).then(function(e){for(S.status="loaded",f(e);S.messagePool.length;)a(S.messagePool.pop());t(e)},function(e){f([]),n(e)})})}function f(e){S.shareUserMaps={},(e||[]).forEach(function(e,t){e.index=t,S.shareUserMaps[e.id]=e}),S.shareUsers=r.sortBy(e,["index"],["asc"])}function d(e){return+e===x.id?T:S.shareUserMaps[e]?E[S.shareUserMaps[e].index%40]:cow.guideUsers&&cow.guideUsers.indexOf(e)>-1?E[cow.guideUsers.indexOf(e)%40]:"#41464b"}function p(e){return S.shareUserMaps[e]}Object.defineProperty(t,"__esModule",{value:!0});var h=n(9),m=i(h),g=n(33),_=i(g),v=n(72),y=i(v),b=n(21),w=o(b),C=w.isRNClient(),S={},x=cow.currentUser,T="#5292F7",E=["#A69ACA","#EC6E79","#F39801","#00A496","#FFD900","#674599","#83D4E7","#AF7C4F","#B8D200","#9D5B8B","#F15B1C","#41464B","#CD9F00","#47885E","#D7003B","#436EC9","#F897C7","#9C4109","#6E7A56","#83D4E7","#83609C","#F8DCDB","#E7C39C","#87B151","#9E0038","#B09FC9","#7DCFC8","#BEE7F0","#CD9F00","#CBAAC2","#F5C5C9","#CD8C28","#1A5A52","#9EB4E1","#406619","#CAB738","#F6C751","#8D699D","#613A14","#189DEC"];S.shareUserMaps={},S.shareUsers=[],S.cooperators=[],S.status="",S.currentFileGuid="",S.messagePool=[],_.default.bind("Invite",function(e){if("create"===e.db_event){var t=S.shareUsers.length?S.shareUsers.slice(-1)[0].index:-1;r.isArray(e.data)?e.data.forEach(function(e,n){e.index=t+n+1,S.shareUsers.push(e),S.shareUserMaps[e.id]=e}):(e.data.index=t+1,S.shareUserMaps[e.data.id]=e.data,S.shareUsers.push(e.data))}else if("delete"===e.db_event){var n=r.remove(S.shareUsers,function(t){return r.isArray(e.data)?e.data.some(function(e){return e.id===t.id}):e.data.id===t.id});n.forEach(function(e){S.shareUserMaps[e.id]&&delete S.shareUserMaps[e.id]})}}),m.default.attach("socket:message",function(e){(cow.currentFile.guid===S.currentFileGuid||C)&&(["USER_ENTER","USER_LEAVE","SELECT","UNSELECT"].indexOf(e.data.type)>=0&&+e.data.userInfo.id===x.id||"COLLABROOM"===e.type&&("loaded"===S.status||C?a(e.data):"loading"===S.status&&S.messagePool.push(e.data)))}),t.default={reset:c,getColor:d,getShareUser:p},e.exports=t.default}).call(t,n(1))},,,function(e,t,n){function r(e){return"symbol"==typeof e||i(e)&&o(e)==a}var o=n(198),i=n(199),a="[object Symbol]";e.exports=r},function(e,t,n){"use strict";function r(e){var t=e.dispatch,n=e.getState;return function(e){return function(r){return"function"==typeof r?r(t,n):e(r)}}}e.exports=r},function(e,t,n){(function(t){function n(e,t){var n={};for(var r in e)t.indexOf(r)<0&&(n[r]=e[r]);return n}e.exports=function(){return function(e){return function(r){var o=r.promise,i=r.types,a=n(r,["promise","types"]);if(!o)return e(r);var s=i[0],l=i[1],u=i[2];return e({type:"@@REQUEST/START"}),e(t.assign({},a,{type:s})),o.then(function(n){return e({type:"@@REQUEST/SUCCESS"}),e(t.assign({},a,{type:l,result:n})),n},function(n){return e({type:"@@REQUEST/FAILED",payload:{err:n}}),e(t.assign({},a,{type:u,error:n})),n})}}}}).call(t,n(1))},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(20),f=r(c),d=n(5),p=r(d),h=n(54),m=n(695),g=r(m),_=n(753),v=r(_),y=n(22),b=n(270),w=r(b),C=n(146),S=r(C),x=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.renderItem=n.renderItem.bind(n),n.renderAction=n.renderAction.bind(n),n.handleUserListClick=n.handleUserListClick.bind(n),n}return a(t,e),s(t,null,[{key:"propTypes",get:function(){return{file:l.PropTypes.object,data:l.PropTypes.array,getPopupContainer:l.PropTypes.func,setPermission:l.PropTypes.func,getSharedUsers:l.PropTypes.func,getListData:l.PropTypes.func,onButtonClick:l.PropTypes.func,renderActionComponent:l.PropTypes.func,overflow:l.PropTypes.array,cleanModals:l.PropTypes.func,hasMore:l.PropTypes.boolean}}},{key:"defaultProps",get:function(){return{data:[],overflow:[0,40]}}}]),s(t,[{key:"handleUserListClick",value:function(e,t){var n=this;if("transfer"===t)return this.props.onButtonClick("transfer");var r="升级到高级版或企业版，获得无限制协作";e.id?this.props.setPermission(this.props.file.guid,e.id,t).then(function(o){if(o.error){return-1!==o.error.message.indexOf(r)?(0,S.default)({title:"到达上限",description:o.error.message,buttons:[{buttonLabel:"了解详情",customClass:"btn btn-ok",closeAfterClick:!0,type:"link-button",href:"/payment"},{buttonLabel:"取消",customClass:"btn",closeAfterClick:!0,type:"button"}]}):void p.default.alert({title:o.error.message,type:"error"})}"add"===t?p.default.alert({title:"添加成功"}):"remove"===t?p.default.alert({title:"移除成功"}):"remove"===t&&e.id===cow.currentUser.id&&n.props.cleanModals()}):(0,y.ajaxPost)("/api/invite",{file_id:this.props.file.id,users:e.email}).then(function(e){var t=e.data,o=t.success,i=t.detail;if(o)n.props.getSharedUsers(n.props.file.guid),n.forceUpdate();else if(i.length&&i[0].error){var a=i[0].error.message;-1!==a.indexOf(r)?(0,S.default)({title:"到达上限",description:i[0].error.message,buttons:[{buttonLabel:"了解详情",customClass:"btn btn-ok",closeAfterClick:!0,type:"link-button",href:"/payment"},{buttonLabel:"取消",customClass:"btn",closeAfterClick:!0,type:"button"}]}):p.default.alert({title:i[0].error.message,type:"error"})}else p.default.alert({title:"未知错误, 请稍后重试",type:"error"})})}},{key:"renderAction",value:function(e){return this.props.renderActionComponent?this.props.renderActionComponent(e):u.default.createElement(v.default,{userId:e.id,email:e.email,file:this.props.file,permission:e.permission,getPopupContainer:this.props.getPopupContainer,handleActionClick:this.handleUserListClick})}},{key:"renderItem",value:function(e){var t=cow.currentUser.id===e.id?e.name+" (我)":e.name,n=(0,f.default)("user-list-item",{outsider:e.isOutsider,disabled:"disabled"===e.teamRole});return u.default.createElement("div",{className:n,key:e.id},u.default.createElement(h.ImageIcon,{customClass:"avatar",defaultImg:"https://assets-cdn.shimo.im/assets/images/loading-b67e5a67dc.gif",realImg:e.avatar}),u.default.createElement("span",{className:"name"},u.default.createElement(w.default,{width:110},t)),u.default.createElement("span",{className:"email ellipsis"},e.email),this.renderAction(e))}},{key:"render",value:function(){return u.default.createElement(g.default,{className:"user-list",initData:this.props.data,data:this.props.data,hasMore:this.props.hasMore,renderItem:this.renderItem,getListData:this.props.getListData,getPopupContainer:this.props.getPopupContainer})}}]),t}(l.Component);t.default=x,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=r(u),f=n(54),d=n(252),p=n(603),h=r(p),m=n(613),g=r(m),_=n(614),v=r(_),y=n(270),b=(r(y),function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleAddPanelBtnClick=n.handleAddPanelBtnClick.bind(n),n.handleTransferButtonClick=n.handleTransferButtonClick.bind(n),n.handleContentSwitch=n.handleContentSwitch.bind(n),n.renderBody=n.renderBody.bind(n),n.onClose=n.onClose.bind(n),n}return a(t,e),l(t,null,[{key:"propTypes",get:function(){return{file:u.PropTypes.object,storage:u.PropTypes.object,maxShareCount:u.PropTypes.number,getSharedUsers:u.PropTypes.func,setPermission:u.PropTypes.func,cleanModals:u.PropTypes.func,pushModal:u.PropTypes.func,popModal:u.PropTypes.func}}},{key:"defaultProps",get:function(){return{disableAddUser:!1}}}]),l(t,[{key:"handleAddPanelBtnClick",value:function(){this.props.popModal(),this.props.pushModal(g.default,{file:this.props.file})}},{key:"handleTransferButtonClick",value:function(){this.props.popModal(),this.props.pushModal(v.default,{file:this.props.file})}},{key:"handleContentSwitch",value:function(e){"add"===e&&this.handleAddPanelBtnClick(),"transfer"===e&&this.handleTransferButtonClick()}},{key:"onClose",value:function(){this.props.cleanModals()}},{key:"renderHeader",value:function(){return c.default.createElement("div",null,c.default.createElement("span",{className:"dialog-title"},"协作"),c.default.createElement("span",{className:"hicon icon-close dialog-close-btn",onClick:this.onClose}))}},{key:"renderBody",value:function(){return c.default.createElement(h.default,s({},this.props,{showButton:!0,onButtonClick:this.handleContentSwitch}))}},{key:"render",value:function(){return c.default.createElement(f.Dialog,{open:!0,hasMask:!1,ref:"target",customClass:"teamworker-sharelist-inner",headTpl:this.renderHeader,bodyTpl:this.renderBody,actions:[],onClose:this.onClose})}}]),t}(u.Component));t.default=(0,d.register)("SharedUsersDialog",b),e.exports=t.default},function(e,t,n){var r,o;r=[n(30),n(77)],void 0!==(o=function(e,t){var n,r,o,i;return o={},r={HTMLEvents:/^(?:load|unload|abort|error|select|change|submit|reset|focus|blur|resize|scroll)$/,MouseEvents:/^(?:click|dblclick|mouse(?:down|up|over|move|out))$/},n={pointerX:0,pointerY:0,button:0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,bubbles:!0,cancelable:!0},i=function(e,t){var n;for(n in t)e[n]=t[n];return e},o.simulate=function(e,t){var o,a,s,l,u;u=i(n,arguments[2]||{}),l=void 0,o=null;for(s in r)if(r[s].test(t)){o=s;break}if(!o)throw new SyntaxError("Only HTMLEvents and MouseEvents interfaces are supported");return document.createEvent?(l=document.createEvent(o),"HTMLEvents"===o?l.initEvent(t,u.bubbles,u.cancelable):l.initMouseEvent(t,u.bubbles,u.cancelable,document.defaultView,u.button,u.pointerX,u.pointerY,u.pointerX,u.pointerY,u.ctrlKey,u.altKey,u.shiftKey,u.metaKey,u.button,e),e.dispatchEvent(l)):(u.clientX=u.pointerX,u.clientY=u.pointerY,a=document.createEventObject(),l=i(a,u),e.fireEvent("on"+t,l)),e},function(e,t){var n,r;r=e,document.createEvent?(n=document.createEvent("MouseEvents"),n.initEvent(t,!0,!1),r.dispatchEvent(n)):document.createEventObject&&(n=document.createEventObject(),r.fireEvent("on"+t,n))},o.detectIE=function(){var e,t,n,r;return r=window.navigator.userAgent,(t=r.indexOf("MSIE "))>0?parseInt(r.substring(t+5,r.indexOf(".",t)),10):r.indexOf("Trident/")>0?(n=r.indexOf("rv:"),parseInt(r.substring(n+3,r.indexOf(".",n)),10)):(e=r.indexOf("Edge/"))>0&&parseInt(r.substring(e+5,r.indexOf(".",e)),10)},o}.apply(t,r))&&(e.exports=o)},function(e,t){e.exports="<html>\n  <head>\n    <link rel='stylesheet' type='text/css' href='<%= css %>'>\n    <style>\n     #buddle-comment-btn {\n       display: none !important;\n     }\n     table, tr, td {\n       border: 1px solid black;\n     }\n     table {\n       border-collapse: collapse;\n       margin-bottom: 20px;\n     }\n     td {\n       min-width: 50px;\n       padding: 0 4px 0 4px;\n       height: 22px;\n     }\n     .comment-buddle {\n       display: none;\n     }\n     #mention-pop {\n       display: none;\n     }\n    </style>\n  </head>\n  <body>\n    <%= body %>\n  </body>\n</html>\n"},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=[],n=null,r=function(){for(var r=0;r<t.length;r++){var o=t[r];if(o.condition===e)return"function"==typeof o.result?o.result():o.result}return"function"==typeof n?n():n||null},o=function(e){return n=e,{done:r}};return{when:function e(n,i){return t.push({condition:n,result:i}),{when:e,others:o,done:r}},others:o,done:r}},e.exports=t.default},function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return!!t.reduce(function(e,t){return e?e[t]:null},window)};t.default=n,e.exports=t.default},function(e,t){function n(e){var t="";return s.some(function(n){return n.tag===e&&(t=n.items[0].tag,!0)}),t}function r(e,t){var n=[];if(s.some(function(t){return t.tag===e&&(n=t.items,!0)})){var r=null;if(n.some(function(e){return e.tag===t&&(r=e,!0)}))return r}return null}function o(){return{groupTag:s[0].tag,item:s[0].items[0]}}function i(e){var t=-1;return s.some(function(n,r){return n.tag===e&&(t=r,!0)})?t:-1}function a(e,t){return s.some(function(n){return n.tag===t&&!!n.items.some(function(t){return t.tag===e})})}Object.defineProperty(t,"__esModule",{value:!0}),t.getFirstTagInGroup=n,t.getItemData=r,t.getDefaultData=o,t.getGroupIndex=i,t.isIncludeGroup=a;var s=[{label:"协作功能",tag:"cooperation",items:[{tag:"assignTask",label:"待办事项 指派任务",img:"https://assets-cdn.shimo.im/assets/images/help/team_assign_task-5136ede733.gif",desc:"在文档内添加 <b>任务列表</b>，创建待办事项。输入 <b>“@” + 协作者的名字</b> 提及协作者、分配任务，对方会收到消息通知"},{tag:"invite",label:"邀请好友协作",img:"https://assets-cdn.shimo.im/assets/images/help/cooperation_invite-a462dd5645.gif",desc:"在文档内页，点击页面右上角 <b>“协作”</b> ，添加成员的邮箱，开始协作编辑。可以给协作者设置不同的<b>权限</b> “只能评论”、“只能阅读”"},{tag:"share",label:"公开链接分享",img:"https://assets-cdn.shimo.im/assets/images/help/cooperation_share-c9de567e7a.gif",desc:"在文档内页，点击页面右上角 <b>“分享”</b> 开启公开链接，复制链接给朋友，朋友即可访问文档。可以设置分享权限 <b>“只读／可写”</b>，可以随时关闭公开链接"},{tag:"comment",label:"划词评论",img:"https://assets-cdn.shimo.im/assets/images/help/cooperation_comment-caad713501.gif",desc:"选中文档里的文字／图片，或者点击某行文字右侧的 <b>“评论”</b> 按钮，添加划词评论"},{tag:"history",label:"编辑历史与还原",img:"https://assets-cdn.shimo.im/assets/images/help/cooperation_history-a3980efd56.gif",desc:"在文档内页，点击页面右上角的 <b>“查看” - “历史”</b>，你的所有编辑记录都在这里，还可随时还原历史编辑"},{tag:"at",label:"提醒 @人 @文档",img:"https://assets-cdn.shimo.im/assets/images/help/cooperation_at-cedcc4f72c.gif",desc:"在文档里输入 <b>“@” + 协作者的名字</b> 提及协作者、分配任务，对方会收到消息提醒。输入 <b>“@” + 文件名</b> 提及你的文档、表格、文件夹，创建文档索引"}]},{label:"文档功能",tag:"doc",items:[{tag:"import",label:"导入文档",img:"https://assets-cdn.shimo.im/assets/images/help/doc_import-a57f5c2d70.gif",desc:"在桌面，点击页面左上角的 <b>“新建” - “导入”</b>，导入文档，支持导入 <b>Word／Excel</b> 文件"},{tag:"export",label:"导出文档",img:"https://assets-cdn.shimo.im/assets/images/help/doc_export-db846391ec.gif",desc:"在文档内页，点击页面右上角 <b>“操作” - “导出”</b>，可以导出文档为 <b>pdf</b> 格式、<b>Word</b> 文件、<b>jpg</b> 图片"},{tag:"hyperlink",label:"插入超链接",img:"https://assets-cdn.shimo.im/assets/images/help/doc_hyperlink-88b929d698.gif",desc:"选中需要插入链接的文字，点击工具栏 <b>“插入” - “超链接”</b>，输入链接地址，按回车键确定"},{tag:"uploadFile",label:"插入图片、附件",img:"https://assets-cdn.shimo.im/assets/images/help/doc_upload_file-6e6f1da0b4.gif",desc:"将光标定位在文档中需要插入文件的位置，点击工具栏 <b>“插入” - “图片”／“附件”</b>，选择文件上传"},{tag:"format",label:"格式编辑",img:"https://assets-cdn.shimo.im/assets/images/help/doc_format-196afd42ae.gif",desc:"选中需要调整格式的文字或段落，点击工具栏中相应的工具，编辑格式"},{tag:"wordCount",label:"字数统计",img:"https://assets-cdn.shimo.im/assets/images/help/doc_word_count-378b691e8f.gif",desc:"选中想要统计字数的文字，页面下方会显示对应字数"}]}];t.default=s},,function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=r(u),f=n(271),d=r(f),p=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),l(t,[{key:"getPopupDomNode",value:function(){return this.refs.tooltip.getPopupDomNode()}},{key:"renderOverlay",value:function(){var e=this.props,t=e.title,n=e.prefixCls,r=e.content,o=e.innerClass;return c.default.createElement("div",{className:o},t&&c.default.createElement("div",{className:(o||n)+"-title"},t),c.default.createElement("div",{className:(o||n)+"-inner-content"},r))}},{key:"render",value:function(){return c.default.createElement(d.default,s({ref:"tooltip"},this.props,{overlay:this.renderOverlay()}))}}],[{key:"defaultProps",get:function(){return{prefixCls:"sm-popover",placement:"bottomRight",trigger:"click",mouseEnterDelay:.1,mouseLeaveDelay:.1,overlayStyle:{},innerClass:""}}}]),t}(u.Component);t.default=p,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(0),f=r(c),d=n(449),p=r(d),h=n(512),m=n(20),g=r(m);n(513);var _=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={visible:!1},n.onVisibleChange=n.onVisibleChange.bind(n),n.onPopupAlign=n.onPopupAlign.bind(n),n}return s(t,e),u(t,null,[{key:"defaultProps",get:function(){return{prefixCls:"sm-tooltip",placement:"top",mouseEnterDelay:.1,mouseLeaveDelay:.1,arrowPointAtCenter:!1,onVisibleChange:function(){}}}},{key:"propTypes",get:function(){return{title:c.PropTypes.string,overlay:c.PropTypes.oneOfType([c.PropTypes.node,c.PropTypes.func]),onVisibleChange:c.PropTypes.func,visible:c.PropTypes.bool,prefixCls:c.PropTypes.string,openClassName:c.PropTypes.string,arrowPointAtCenter:c.PropTypes.bool,builtinPlacements:c.PropTypes.object,trigger:c.PropTypes.oneOf(["hover","click","focus","none"]),placement:c.PropTypes.oneOf(["top","right","bottom","left","topLeft","topRight","bottomLeft","bottomRight","leftTop","leftBottom","rightTop","rightBottom"])}}}]),u(t,[{key:"shouldComponentUpdate",value:function(e,t){var n=this.state,r=this.props;return n.visible||t.visible!==n.visible||r.visible!==e.visible}},{key:"onVisibleChange",value:function(e){this.setState({visible:e}),this.props.onVisibleChange(e)}},{key:"getPopupDomNode",value:function(){return this.refs.tooltip.getPopupDomNode()}},{key:"getPlacements",value:function(){var e=this.props,t=e.builtinPlacements,n=e.arrowPointAtCenter;return t||(0,h.getPlacements)({arrowPointAtCenter:n,verticalArrowShift:8,horizontalArrowShif:16,arrowWidth:5})}},{key:"onPopupAlign",value:function(e,t){var n=this.getPlacements(),r=Object.keys(n).filter(function(e){return n[e].points[0]===t.points[0]&&n[e].points[1]===t.points[1]})[0];if(r){var o=e.getBoundingClientRect(),i={top:"50%",left:"50%"};r.indexOf("top")>=0||r.indexOf("Bottom")>=0?i.top=o.height-t.offset[1]+"px":(r.indexOf("Top")>=0||r.indexOf("bottom")>=0)&&(i.top=-t.offset[1]+"px"),r.indexOf("left")>=0||r.indexOf("Right")>=0?i.left=o.width-t.offset[0]+"px":(r.indexOf("right")>=0||r.indexOf("Left")>=0)&&(i.left=-t.offset[0]+"px"),e.style.transformOrigin=i.left+" "+i.top}}},{key:"render",value:function(){var e,t=this.state,n=this.props,r=n.prefixCls,i=n.title,a=n.overlay,s=n.children,u=t.visible;n.hasOwnProperty("visible")?u=n.visible:i||a||(u=!1);var c=null;"string"==typeof i?c=function(){return f.default.createElement("span",{className:r+"-text"},i)}:a&&(c=a);var d=s?s.props:{},h=(0,g.default)((e={},o(e,d.className,!!d.className),o(e,n.openClassName||r+"-open",!0),e));return f.default.createElement(p.default,l({overlay:c,visible:u,onPopupAlign:this.onPopupAlign,ref:"tooltip"},n,{builtinPlacements:this.getPlacements(),onVisibleChange:this.onVisibleChange}),u?f.default.cloneElement(s,{className:h}):s)}}]),t}(c.Component);t.default=_,e.exports=t.default},function(e,t,n){"use strict";e.exports=n(450)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=n(0),s=r(a),l=n(301),u=n(341),c=r(u),f=s.default.createClass({displayName:"Tooltip",propTypes:{trigger:a.PropTypes.any,children:a.PropTypes.any,defaultVisible:a.PropTypes.bool,visible:a.PropTypes.bool,placement:a.PropTypes.string,transitionName:a.PropTypes.string,animation:a.PropTypes.any,onVisibleChange:a.PropTypes.func,afterVisibleChange:a.PropTypes.func,overlay:a.PropTypes.oneOfType([s.default.PropTypes.node,s.default.PropTypes.func]).isRequired,overlayStyle:a.PropTypes.object,overlayClassName:a.PropTypes.string,prefixCls:a.PropTypes.string,mouseEnterDelay:a.PropTypes.number,mouseLeaveDelay:a.PropTypes.number,getTooltipContainer:a.PropTypes.func,destroyTooltipOnHide:a.PropTypes.bool,align:a.PropTypes.object,arrowContent:a.PropTypes.any},getDefaultProps:function(){return{prefixCls:"rc-tooltip",mouseEnterDelay:0,destroyTooltipOnHide:!1,mouseLeaveDelay:.1,align:{},placement:"right",trigger:["hover"],arrowContent:null}},getPopupElement:function(){var e=this.props,t=e.arrowContent,n=e.overlay,r=e.prefixCls;return[s.default.createElement("div",{className:r+"-arrow",key:"arrow"},t),s.default.createElement("div",{className:r+"-inner",key:"content"},"function"==typeof n?n():n)]},getPopupDomNode:function(){return this.refs.trigger.getPopupDomNode()},render:function(){var e=this.props,t=e.overlayClassName,n=e.trigger,r=e.mouseEnterDelay,a=e.mouseLeaveDelay,u=e.overlayStyle,f=e.prefixCls,d=e.children,p=e.onVisibleChange,h=e.transitionName,m=e.animation,g=e.placement,_=e.align,v=e.destroyTooltipOnHide,y=e.defaultVisible,b=e.getTooltipContainer,w=o(e,["overlayClassName","trigger","mouseEnterDelay","mouseLeaveDelay","overlayStyle","prefixCls","children","onVisibleChange","transitionName","animation","placement","align","destroyTooltipOnHide","defaultVisible","getTooltipContainer"]),C=i({},w);return"visible"in this.props&&(C.popupVisible=this.props.visible),s.default.createElement(c.default,i({popupClassName:t,ref:"trigger",prefixCls:f,popup:this.getPopupElement,action:n,builtinPlacements:l.placements,popupPlacement:g,popupAlign:_,getPopupContainer:b,onPopupVisibleChange:p,popupTransitionName:h,popupAnimation:m,defaultPopupVisible:y,destroyPopupOnHide:v,mouseLeaveDelay:a,popupStyle:u,mouseEnterDelay:r},C),d)}});t.default=f,e.exports=t.default},function(e,t,n){e.exports={default:n(452),__esModule:!0}},function(e,t,n){n(453),e.exports=n(78).Object.assign},function(e,t,n){var r=n(84);r(r.S+r.F,"Object",{assign:n(455)})},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,n){"use strict";var r=n(138),o=n(208),i=n(155),a=n(308),s=n(306),l=Object.assign;e.exports=!l||n(137)(function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach(function(e){t[e]=e}),7!=l({},e)[n]||Object.keys(l({},t)).join("")!=r})?function(e,t){for(var n=a(e),l=arguments.length,u=1,c=o.f,f=i.f;l>u;)for(var d,p=s(arguments[u++]),h=c?r(p).concat(c(p)):r(p),m=h.length,g=0;m>g;)f.call(p,d=h[g++])&&(n[d]=p[d]);return n}:l},function(e,t,n){var r=n(82),o=n(457),i=n(458);e.exports=function(e){return function(t,n,a){var s,l=r(t),u=o(l.length),c=i(a,u);if(e&&n!=n){for(;u>c;)if((s=l[c++])!=s)return!0}else for(;u>c;c++)if((e||c in l)&&l[c]===n)return e||c||0;return!e&&-1}}},function(e,t,n){var r=n(204),o=Math.min;e.exports=function(e){return e>0?o(r(e),9007199254740991):0}},function(e,t,n){var r=n(204),o=Math.max,i=Math.min;e.exports=function(e,t){return e=r(e),e<0?o(e+t,0):i(e,t)}},function(e,t,n){"use strict";var r=n(29),o=n(3),i=n(460);e.exports=function(){function e(e,t,n,r,a,s){s!==i&&o(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types")}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t};return n.checkPropTypes=r,n.PropTypes=n,n}},function(e,t,n){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t,n){"use strict";function r(e){return e}function o(e,t,n){function o(e,t){var n=v.hasOwnProperty(t)?v[t]:null;C.hasOwnProperty(t)&&s("OVERRIDE_BASE"===n,"ReactClassInterface: You are attempting to override `%s` from your class specification. Ensure that your method names do not overlap with React methods.",t),e&&s("DEFINE_MANY"===n||"DEFINE_MANY_MERGED"===n,"ReactClassInterface: You are attempting to define `%s` on your component more than once. This conflict may be due to a mixin.",t)}function u(e,n){if(n){s("function"!=typeof n,"ReactClass: You're attempting to use a component class or function as a mixin. Instead, just use a regular object."),s(!t(n),"ReactClass: You're attempting to use a component as a mixin. Instead, just use a regular object.");var r=e.prototype,i=r.__reactAutoBindPairs;n.hasOwnProperty(l)&&y.mixins(e,n.mixins);for(var a in n)if(n.hasOwnProperty(a)&&a!==l){var u=n[a],c=r.hasOwnProperty(a);if(o(c,a),y.hasOwnProperty(a))y[a](e,u);else{var f=v.hasOwnProperty(a),h="function"==typeof u,m=h&&!f&&!c&&!1!==n.autobind;if(m)i.push(a,u),r[a]=u;else if(c){var g=v[a];s(f&&("DEFINE_MANY_MERGED"===g||"DEFINE_MANY"===g),"ReactClass: Unexpected spec policy %s for key %s when mixing in component specs.",g,a),"DEFINE_MANY_MERGED"===g?r[a]=d(r[a],u):"DEFINE_MANY"===g&&(r[a]=p(r[a],u))}else r[a]=u}}}else;}function c(e,t){if(t)for(var n in t){var r=t[n];if(t.hasOwnProperty(n)){var o=n in y;s(!o,'ReactClass: You are attempting to define a reserved property, `%s`, that shouldn\'t be on the "statics" key. Define it as an instance property instead; it will still be accessible on the constructor.',n);var i=n in e;s(!i,"ReactClass: You are attempting to define `%s` on your component more than once. This conflict may be due to a mixin.",n),e[n]=r}}}function f(e,t){s(e&&t&&"object"==typeof e&&"object"==typeof t,"mergeIntoWithNoDuplicateKeys(): Cannot merge non-objects.");for(var n in t)t.hasOwnProperty(n)&&(s(void 0===e[n],"mergeIntoWithNoDuplicateKeys(): Tried to merge two objects with the same key: `%s`. This conflict may be due to a mixin; in particular, this may be caused by two getInitialState() or getDefaultProps() methods returning objects with clashing keys.",n),e[n]=t[n]);return e}function d(e,t){return function(){var n=e.apply(this,arguments),r=t.apply(this,arguments);if(null==n)return r;if(null==r)return n;var o={};return f(o,n),f(o,r),o}}function p(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function h(e,t){var n=t.bind(e);return n}function m(e){for(var t=e.__reactAutoBindPairs,n=0;n<t.length;n+=2){var r=t[n],o=t[n+1];e[r]=h(e,o)}}function g(e){var t=r(function(e,r,o){this.__reactAutoBindPairs.length&&m(this),this.props=e,this.context=r,this.refs=a,this.updater=o||n,this.state=null;var i=this.getInitialState?this.getInitialState():null;s("object"==typeof i&&!Array.isArray(i),"%s.getInitialState(): must return an object or null",t.displayName||"ReactCompositeComponent"),this.state=i});t.prototype=new S,t.prototype.constructor=t,t.prototype.__reactAutoBindPairs=[],_.forEach(u.bind(null,t)),u(t,b),u(t,e),u(t,w),t.getDefaultProps&&(t.defaultProps=t.getDefaultProps()),s(t.prototype.render,"createClass(...): Class specification must implement a `render` method.");for(var o in v)t.prototype[o]||(t.prototype[o]=null);return t}var _=[],v={mixins:"DEFINE_MANY",statics:"DEFINE_MANY",propTypes:"DEFINE_MANY",contextTypes:"DEFINE_MANY",childContextTypes:"DEFINE_MANY",getDefaultProps:"DEFINE_MANY_MERGED",getInitialState:"DEFINE_MANY_MERGED",getChildContext:"DEFINE_MANY_MERGED",render:"DEFINE_ONCE",componentWillMount:"DEFINE_MANY",componentDidMount:"DEFINE_MANY",componentWillReceiveProps:"DEFINE_MANY",shouldComponentUpdate:"DEFINE_ONCE",componentWillUpdate:"DEFINE_MANY",componentDidUpdate:"DEFINE_MANY",componentWillUnmount:"DEFINE_MANY",updateComponent:"OVERRIDE_BASE"},y={displayName:function(e,t){e.displayName=t},mixins:function(e,t){if(t)for(var n=0;n<t.length;n++)u(e,t[n])},childContextTypes:function(e,t){e.childContextTypes=i({},e.childContextTypes,t)},contextTypes:function(e,t){e.contextTypes=i({},e.contextTypes,t)},getDefaultProps:function(e,t){e.getDefaultProps?e.getDefaultProps=d(e.getDefaultProps,t):e.getDefaultProps=t},propTypes:function(e,t){e.propTypes=i({},e.propTypes,t)},statics:function(e,t){c(e,t)},autobind:function(){}},b={componentDidMount:function(){this.__isMounted=!0}},w={componentWillUnmount:function(){this.__isMounted=!1}},C={replaceState:function(e,t){this.updater.enqueueReplaceState(this,e,t)},isMounted:function(){return!!this.__isMounted}},S=function(){};return i(S.prototype,e.prototype,C),g}var i=n(149),a=n(73),s=n(3),l="mixins";e.exports=o},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n){function r(t){var r=new a.default(t);n.call(e,r)}return e.addEventListener?(e.addEventListener(t,r,!1),{remove:function(){e.removeEventListener(t,r,!1)}}):e.attachEvent?(e.attachEvent("on"+t,r),{remove:function(){e.detachEvent("on"+t,r)}}):void 0}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var i=n(463),a=r(i);e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){return null===e||void 0===e}function i(){return d}function a(){return p}function s(e){var t=e.type,n="function"==typeof e.stopPropagation||"boolean"==typeof e.cancelBubble;u.default.call(this),this.nativeEvent=e;var r=a;"defaultPrevented"in e?r=e.defaultPrevented?i:a:"getPreventDefault"in e?r=e.getPreventDefault()?i:a:"returnValue"in e&&(r=e.returnValue===p?i:a),this.isDefaultPrevented=r;var o=[],s=void 0,l=void 0,c=h.concat();for(m.forEach(function(e){t.match(e.reg)&&(c=c.concat(e.props),e.fix&&o.push(e.fix))}),s=c.length;s;)l=c[--s],this[l]=e[l];for(!this.target&&n&&(this.target=e.srcElement||document),this.target&&3===this.target.nodeType&&(this.target=this.target.parentNode),s=o.length;s;)(0,o[--s])(this,e);this.timeStamp=e.timeStamp||Date.now()}Object.defineProperty(t,"__esModule",{value:!0});var l=n(464),u=r(l),c=n(149),f=r(c),d=!0,p=!1,h=["altKey","bubbles","cancelable","ctrlKey","currentTarget","eventPhase","metaKey","shiftKey","target","timeStamp","view","type"],m=[{reg:/^key/,props:["char","charCode","key","keyCode","which"],fix:function(e,t){o(e.which)&&(e.which=o(t.charCode)?t.keyCode:t.charCode),void 0===e.metaKey&&(e.metaKey=e.ctrlKey)}},{reg:/^touch/,props:["touches","changedTouches","targetTouches"]},{reg:/^hashchange$/,props:["newURL","oldURL"]},{reg:/^gesturechange$/i,props:["rotation","scale"]},{reg:/^(mousewheel|DOMMouseScroll)$/,props:[],fix:function(e,t){var n=void 0,r=void 0,o=void 0,i=t.wheelDelta,a=t.axis,s=t.wheelDeltaY,l=t.wheelDeltaX,u=t.detail;i&&(o=i/120),u&&(o=0-(u%3==0?u/3:u)),void 0!==a&&(a===e.HORIZONTAL_AXIS?(r=0,n=0-o):a===e.VERTICAL_AXIS&&(n=0,r=o)),void 0!==s&&(r=s/120),void 0!==l&&(n=-1*l/120),n||r||(r=o),void 0!==n&&(e.deltaX=n),void 0!==r&&(e.deltaY=r),void 0!==o&&(e.delta=o)}},{reg:/^mouse|contextmenu|click|mspointer|(^DOMMouseScroll$)/i,props:["buttons","clientX","clientY","button","offsetX","relatedTarget","which","fromElement","toElement","offsetY","pageX","pageY","screenX","screenY"],fix:function(e,t){var n=void 0,r=void 0,i=void 0,a=e.target,s=t.button;return a&&o(e.pageX)&&!o(t.clientX)&&(n=a.ownerDocument||document,r=n.documentElement,i=n.body,e.pageX=t.clientX+(r&&r.scrollLeft||i&&i.scrollLeft||0)-(r&&r.clientLeft||i&&i.clientLeft||0),e.pageY=t.clientY+(r&&r.scrollTop||i&&i.scrollTop||0)-(r&&r.clientTop||i&&i.clientTop||0)),e.which||void 0===s||(e.which=1&s?1:2&s?3:4&s?2:0),!e.relatedTarget&&e.fromElement&&(e.relatedTarget=e.fromElement===a?e.toElement:e.fromElement),e}}],g=u.default.prototype;(0,f.default)(s.prototype,g,{constructor:s,preventDefault:function(){var e=this.nativeEvent;e.preventDefault?e.preventDefault():e.returnValue=p,g.preventDefault.call(this)},stopPropagation:function(){var e=this.nativeEvent;e.stopPropagation?e.stopPropagation():e.cancelBubble=d,g.stopPropagation.call(this)}}),t.default=s,e.exports=t.default},function(e,t,n){"use strict";function r(){return!1}function o(){return!0}function i(){this.timeStamp=Date.now(),this.target=void 0,this.currentTarget=void 0}Object.defineProperty(t,"__esModule",{value:!0}),i.prototype={isEventObject:1,constructor:i,isDefaultPrevented:r,isPropagationStopped:r,isImmediatePropagationStopped:r,preventDefault:function(){this.isDefaultPrevented=o},stopPropagation:function(){this.isPropagationStopped=o},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=o,this.stopPropagation()},halt:function(e){e?this.stopImmediatePropagation():this.stopPropagation(),this.preventDefault()}},t.default=i,e.exports=t.default},function(e,t,n){n(466);var r=n(78).Object;e.exports=function(e,t,n){return r.defineProperty(e,t,n)}},function(e,t,n){var r=n(84);r(r.S+r.F*!n(80),"Object",{defineProperty:n(79).f})},function(e,t,n){e.exports={default:n(468),__esModule:!0}},function(e,t,n){n(469),n(475),e.exports=n(213).f("iterator")},function(e,t,n){"use strict";var r=n(470)(!0);n(310)(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=r(t,n),this._i+=e.length,{value:e,done:!1})})},function(e,t,n){var r=n(204),o=n(203);e.exports=function(e){return function(t,n){var i,a,s=String(o(t)),l=r(n),u=s.length;return l<0||l>=u?e?"":void 0:(i=s.charCodeAt(l),i<55296||i>56319||l+1===u||(a=s.charCodeAt(l+1))<56320||a>57343?e?s.charAt(l):i:e?s.slice(l,l+2):a-56320+(i-55296<<10)+65536)}}},function(e,t,n){"use strict";var r=n(211),o=n(153),i=n(212),a={};n(85)(a,n(86)("iterator"),function(){return this}),e.exports=function(e,t,n){e.prototype=r(a,{next:o(1,n)}),i(e,t+" Iterator")}},function(e,t,n){var r=n(79),o=n(135),i=n(138);e.exports=n(80)?Object.defineProperties:function(e,t){o(e);for(var n,a=i(t),s=a.length,l=0;s>l;)r.f(e,n=a[l++],t[n]);return e}},function(e,t,n){e.exports=n(68).document&&document.documentElement},function(e,t,n){var r=n(81),o=n(308),i=n(205)("IE_PROTO"),a=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=o(e),r(e,i)?e[i]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?a:null}},function(e,t,n){n(476);for(var r=n(68),o=n(85),i=n(210),a=n(86)("toStringTag"),s=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],l=0;l<5;l++){var u=s[l],c=r[u],f=c&&c.prototype;f&&!f[a]&&o(f,a,u),i[u]=i.Array}},function(e,t,n){"use strict";var r=n(477),o=n(478),i=n(210),a=n(82);e.exports=n(310)(Array,"Array",function(e,t){this._t=a(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,o(1)):"keys"==t?o(0,n):"values"==t?o(0,e[n]):o(0,[n,e[n]])},"values"),i.Arguments=i.Array,r("keys"),r("values"),r("entries")},function(e,t){e.exports=function(){}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){e.exports={default:n(480),__esModule:!0}},function(e,t,n){n(481),n(487),n(488),n(489),e.exports=n(78).Symbol},function(e,t,n){"use strict";var r=n(68),o=n(81),i=n(80),a=n(84),s=n(311),l=n(482).KEY,u=n(137),c=n(206),f=n(212),d=n(154),p=n(86),h=n(213),m=n(214),g=n(483),_=n(484),v=n(485),y=n(135),b=n(82),w=n(202),C=n(153),S=n(211),x=n(486),T=n(313),E=n(79),M=n(138),A=T.f,k=E.f,R=x.f,I=r.Symbol,O=r.JSON,D=O&&O.stringify,P="prototype",N=p("_hidden"),F=p("toPrimitive"),L={}.propertyIsEnumerable,H=c("symbol-registry"),V=c("symbols"),j=c("op-symbols"),B=Object[P],U="function"==typeof I,W=r.QObject,z=!W||!W[P]||!W[P].findChild,Y=i&&u(function(){return 7!=S(k({},"a",{get:function(){return k(this,"a",{value:7}).a}})).a})?function(e,t,n){var r=A(B,t);r&&delete B[t],k(e,t,n),r&&e!==B&&k(B,t,r)}:k,G=function(e){var t=V[e]=S(I[P]);return t._k=e,t},K=U&&"symbol"==typeof I.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof I},X=function(e,t,n){return e===B&&X(j,t,n),y(e),t=w(t,!0),y(n),o(V,t)?(n.enumerable?(o(e,N)&&e[N][t]&&(e[N][t]=!1),n=S(n,{enumerable:C(0,!1)})):(o(e,N)||k(e,N,C(1,{})),e[N][t]=!0),Y(e,t,n)):k(e,t,n)},q=function(e,t){y(e);for(var n,r=_(t=b(t)),o=0,i=r.length;i>o;)X(e,n=r[o++],t[n]);return e},J=function(e,t){return void 0===t?S(e):q(S(e),t)},Z=function(e){var t=L.call(this,e=w(e,!0));return!(this===B&&o(V,e)&&!o(j,e))&&(!(t||!o(this,e)||!o(V,e)||o(this,N)&&this[N][e])||t)},Q=function(e,t){if(e=b(e),t=w(t,!0),e!==B||!o(V,t)||o(j,t)){var n=A(e,t);return!n||!o(V,t)||o(e,N)&&e[N][t]||(n.enumerable=!0),n}},$=function(e){for(var t,n=R(b(e)),r=[],i=0;n.length>i;)o(V,t=n[i++])||t==N||t==l||r.push(t);return r},ee=function(e){for(var t,n=e===B,r=R(n?j:b(e)),i=[],a=0;r.length>a;)!o(V,t=r[a++])||n&&!o(B,t)||i.push(V[t]);return i};U||(I=function(){if(this instanceof I)throw TypeError("Symbol is not a constructor!");var e=d(arguments.length>0?arguments[0]:void 0),t=function(n){this===B&&t.call(j,n),o(this,N)&&o(this[N],e)&&(this[N][e]=!1),Y(this,e,C(1,n))};return i&&z&&Y(B,e,{configurable:!0,set:t}),G(e)},s(I[P],"toString",function(){return this._k}),T.f=Q,E.f=X,n(312).f=x.f=$,n(155).f=Z,n(208).f=ee,i&&!n(209)&&s(B,"propertyIsEnumerable",Z,!0),h.f=function(e){return G(p(e))}),a(a.G+a.W+a.F*!U,{Symbol:I});for(var te="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ne=0;te.length>ne;)p(te[ne++]);for(var te=M(p.store),ne=0;te.length>ne;)m(te[ne++]);a(a.S+a.F*!U,"Symbol",{for:function(e){return o(H,e+="")?H[e]:H[e]=I(e)},keyFor:function(e){if(K(e))return g(H,e);throw TypeError(e+" is not a symbol!")},useSetter:function(){z=!0},useSimple:function(){z=!1}}),a(a.S+a.F*!U,"Object",{create:J,defineProperty:X,defineProperties:q,getOwnPropertyDescriptor:Q,getOwnPropertyNames:$,getOwnPropertySymbols:ee}),O&&a(a.S+a.F*(!U||u(function(){var e=I();return"[null]"!=D([e])||"{}"!=D({a:e})||"{}"!=D(Object(e))})),"JSON",{stringify:function(e){if(void 0!==e&&!K(e)){for(var t,n,r=[e],o=1;arguments.length>o;)r.push(arguments[o++]);return t=r[1],"function"==typeof t&&(n=t),!n&&v(t)||(t=function(e,t){if(n&&(t=n.call(this,e,t)),!K(t))return t}),r[1]=t,D.apply(O,r)}}}),I[P][F]||n(85)(I[P],F,I[P].valueOf),f(I,"Symbol"),f(Math,"Math",!0),f(r.JSON,"JSON",!0)},function(e,t,n){var r=n(154)("meta"),o=n(136),i=n(81),a=n(79).f,s=0,l=Object.isExtensible||function(){return!0},u=!n(137)(function(){return l(Object.preventExtensions({}))}),c=function(e){a(e,r,{value:{i:"O"+ ++s,w:{}}})},f=function(e,t){if(!o(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!i(e,r)){if(!l(e))return"F";if(!t)return"E";c(e)}return e[r].i},d=function(e,t){if(!i(e,r)){if(!l(e))return!0;if(!t)return!1;c(e)}return e[r].w},p=function(e){return u&&h.NEED&&l(e)&&!i(e,r)&&c(e),e},h=e.exports={KEY:r,NEED:!1,fastKey:f,getWeak:d,onFreeze:p}},function(e,t,n){var r=n(138),o=n(82);e.exports=function(e,t){for(var n,i=o(e),a=r(i),s=a.length,l=0;s>l;)if(i[n=a[l++]]===t)return n}},function(e,t,n){var r=n(138),o=n(208),i=n(155);e.exports=function(e){var t=r(e),n=o.f;if(n)for(var a,s=n(e),l=i.f,u=0;s.length>u;)l.call(e,a=s[u++])&&t.push(a);return t}},function(e,t,n){var r=n(307);e.exports=Array.isArray||function(e){return"Array"==r(e)}},function(e,t,n){var r=n(82),o=n(312).f,i={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],s=function(e){try{return o(e)}catch(e){return a.slice()}};e.exports.f=function(e){return a&&"[object Window]"==i.call(e)?s(e):o(r(e))}},function(e,t){},function(e,t,n){n(214)("asyncIterator")},function(e,t,n){n(214)("observable")},function(e,t,n){e.exports={default:n(491),__esModule:!0}},function(e,t,n){n(492),e.exports=n(78).Object.setPrototypeOf},function(e,t,n){var r=n(84);r(r.S,"Object",{setPrototypeOf:n(493).set})},function(e,t,n){var r=n(136),o=n(135),i=function(e,t){if(o(e),!r(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,r){try{r=n(302)(Function.call,n(313).f(Object.prototype,"__proto__").set,2),r(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,n){return i(e,n),t?e.__proto__=n:r(e,n),e}}({},!1):void 0),check:i}},function(e,t,n){e.exports={default:n(495),__esModule:!0}},function(e,t,n){n(496);var r=n(78).Object;e.exports=function(e,t){return r.create(e,t)}},function(e,t,n){var r=n(84);r(r.S,"Object",{create:n(211)})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(498),i=r(o);t.default=i.default,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){for(var n=Object.getOwnPropertyNames(t),r=0;r<n.length;r++){var o=n[r],i=Object.getOwnPropertyDescriptor(t,o);i&&i.configurable&&void 0===e[o]&&Object.defineProperty(e,o,i)}return e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):o(e,t))}function l(e,t){function n(){o&&(clearTimeout(o),o=null)}function r(){n(),o=setTimeout(e,t)}var o=void 0;return r.clear=n,r}Object.defineProperty(t,"__esModule",{value:!0});var u=n(0),c=r(u),f=n(37),d=r(f),p=n(13),h=r(p),m=n(499),g=r(m),_=n(258),v=r(_),y=n(506),b=r(y),w=function(e){function t(){var n,r,o;i(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return n=r=a(this,e.call.apply(e,[this].concat(l))),r.forceAlign=function(){var e=r.props;if(!e.disabled){var t=h.default.findDOMNode(r);e.onAlign(t,(0,g.default)(t,e.target(),e.align))}},o=n,a(r,o)}return s(t,e),t.prototype.componentDidMount=function(){var e=this.props;this.forceAlign(),!e.disabled&&e.monitorWindowResize&&this.startMonitorWindowResize()},t.prototype.componentDidUpdate=function(e){var t=!1,n=this.props;if(!n.disabled)if(e.disabled||e.align!==n.align)t=!0;else{var r=e.target(),o=n.target();(0,b.default)(r)&&(0,b.default)(o)?t=!1:r!==o&&(t=!0)}t&&this.forceAlign(),n.monitorWindowResize&&!n.disabled?this.startMonitorWindowResize():this.stopMonitorWindowResize()},t.prototype.componentWillUnmount=function(){this.stopMonitorWindowResize()},t.prototype.startMonitorWindowResize=function(){this.resizeHandler||(this.bufferMonitor=l(this.forceAlign,this.props.monitorBufferTime),this.resizeHandler=(0,v.default)(window,"resize",this.bufferMonitor))},t.prototype.stopMonitorWindowResize=function(){this.resizeHandler&&(this.bufferMonitor.clear(),this.resizeHandler.remove(),this.resizeHandler=null)},t.prototype.render=function(){var e=this.props,t=e.childrenProps,n=e.children,r=c.default.Children.only(n);if(t){var o={};for(var i in t)t.hasOwnProperty(i)&&(o[i]=this.props[t[i]]);return c.default.cloneElement(r,o)}return r},t}(u.Component);w.propTypes={childrenProps:d.default.object,align:d.default.object.isRequired,target:d.default.func,onAlign:d.default.func,monitorBufferTime:d.default.number,monitorWindowResize:d.default.bool,disabled:d.default.bool,children:d.default.any},w.defaultProps={target:function(){return window},onAlign:function(){},monitorBufferTime:50,monitorWindowResize:!1,disabled:!1},t.default=w,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n){return e.left<n.left||e.left+t.width>n.right}function i(e,t,n){return e.top<n.top||e.top+t.height>n.bottom}function a(e,t,n){return e.left>n.right||e.left+t.width<n.left}function s(e,t,n){return e.top>n.bottom||e.top+t.height<n.top}function l(e,t,n){var r=[];return h.default.each(e,function(e){r.push(e.replace(t,function(e){return n[e]}))}),r}function u(e,t){return e[t]=-e[t],e}function c(e,t){return(/%$/.test(e)?parseInt(e.substring(0,e.length-1),10)/100*t:parseInt(e,10))||0}function f(e,t){e[0]=c(e[0],t.width),e[1]=c(e[1],t.height)}function d(e,t,n){var r=n.points,c=n.offset||[0,0],d=n.targetOffset||[0,0],p=n.overflow,m=n.target||t,g=n.source||e;c=[].concat(c),d=[].concat(d),p=p||{};var _={},y=0,w=(0,v.default)(g),S=(0,C.default)(g),T=(0,C.default)(m);f(c,S),f(d,T);var E=(0,x.default)(S,T,r,c,d),M=h.default.merge(S,E);if(w&&(p.adjustX||p.adjustY)){if(p.adjustX&&o(E,S,w)){var A=l(r,/[lr]/gi,{l:"r",r:"l"}),k=u(c,0),R=u(d,0);a((0,x.default)(S,T,A,k,R),S,w)||(y=1,r=A,c=k,d=R)}if(p.adjustY&&i(E,S,w)){var I=l(r,/[tb]/gi,{t:"b",b:"t"}),O=u(c,1),D=u(d,1);s((0,x.default)(S,T,I,O,D),S,w)||(y=1,r=I,c=O,d=D)}y&&(E=(0,x.default)(S,T,r,c,d),h.default.mix(M,E)),_.adjustX=p.adjustX&&o(E,S,w),_.adjustY=p.adjustY&&i(E,S,w),(_.adjustX||_.adjustY)&&(M=(0,b.default)(E,S,w,_))}return M.width!==S.width&&h.default.css(g,"width",h.default.width(g)+M.width-S.width),M.height!==S.height&&h.default.css(g,"height",h.default.height(g)+M.height-S.height),h.default.offset(g,{left:M.left,top:M.top},{useCssRight:n.useCssRight,useCssBottom:n.useCssBottom,useCssTransform:n.useCssTransform}),{points:r,offset:c,targetOffset:d,overflow:_}}Object.defineProperty(t,"__esModule",{value:!0});var p=n(143),h=r(p),m=n(314),g=r(m),_=n(501),v=r(_),y=n(502),b=r(y),w=n(503),C=r(w),S=n(504),x=r(S);d.__getOffsetParent=g.default,d.__getVisibleRectForElement=v.default,t.default=d,e.exports=t.default},function(e,t,n){"use strict";function r(){if(void 0!==f)return f;f="";var e=document.createElement("p").style;for(var t in d)t+"Transform"in e&&(f=t);return f}function o(){return r()?r()+"TransitionProperty":"transitionProperty"}function i(){return r()?r()+"Transform":"transform"}function a(e,t){var n=o();n&&(e.style[n]=t,"transitionProperty"!==n&&(e.style.transitionProperty=t))}function s(e,t){var n=i();n&&(e.style[n]=t,"transform"!==n&&(e.style.transform=t))}function l(e){return e.style.transitionProperty||e.style[o()]}function u(e){var t=window.getComputedStyle(e,null),n=t.getPropertyValue("transform")||t.getPropertyValue(i());if(n&&"none"!==n){var r=n.replace(/[^0-9\-.,]/g,"").split(",");return{x:parseFloat(r[12]||r[4],0),y:parseFloat(r[13]||r[5],0)}}return{x:0,y:0}}function c(e,t){var n=window.getComputedStyle(e,null),r=n.getPropertyValue("transform")||n.getPropertyValue(i());if(r&&"none"!==r){var o=void 0,a=r.match(p);if(a)a=a[1],o=a.split(",").map(function(e){return parseFloat(e,10)}),o[4]=t.x,o[5]=t.y,s(e,"matrix("+o.join(",")+")");else{o=r.match(h)[1].split(",").map(function(e){return parseFloat(e,10)}),o[12]=t.x,o[13]=t.y,s(e,"matrix3d("+o.join(",")+")")}}else s(e,"translateX("+t.x+"px) translateY("+t.y+"px) translateZ(0)")}Object.defineProperty(t,"__esModule",{value:!0}),t.getTransformName=i,t.setTransitionProperty=a,t.getTransitionProperty=l,t.getTransformXY=u,t.setTransformXY=c;var f=void 0,d={Webkit:"-webkit-",Moz:"-moz-",ms:"-ms-",O:"-o-"},p=/matrix\((.*)\)/,h=/matrix3d\((.*)\)/},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){for(var t={left:0,right:1/0,top:0,bottom:1/0},n=(0,l.default)(e),r=void 0,o=void 0,i=void 0,s=e.ownerDocument,u=s.defaultView||s.parentWindow,c=s.body,f=s.documentElement;n;){if(-1!==navigator.userAgent.indexOf("MSIE")&&0===n.clientWidth||n===c||n===f||"visible"===a.default.css(n,"overflow")){if(n===c||n===f)break}else{var d=a.default.offset(n);d.left+=n.clientLeft,d.top+=n.clientTop,t.top=Math.max(t.top,d.top),t.right=Math.min(t.right,d.left+n.clientWidth),t.bottom=Math.min(t.bottom,d.top+n.clientHeight),t.left=Math.max(t.left,d.left)}n=(0,l.default)(n)}return r=a.default.getWindowScrollLeft(u),o=a.default.getWindowScrollTop(u),t.left=Math.max(t.left,r),t.top=Math.max(t.top,o),i={width:a.default.viewportWidth(u),height:a.default.viewportHeight(u)},t.right=Math.min(t.right,r+i.width),t.bottom=Math.min(t.bottom,o+i.height),t.top>=0&&t.left>=0&&t.bottom>t.top&&t.right>t.left?t:null}Object.defineProperty(t,"__esModule",{value:!0});var i=n(143),a=r(i),s=n(314),l=r(s);t.default=o,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n,r){var o=a.default.clone(e),i={width:t.width,height:t.height};return r.adjustX&&o.left<n.left&&(o.left=n.left),r.resizeWidth&&o.left>=n.left&&o.left+i.width>n.right&&(i.width-=o.left+i.width-n.right),r.adjustX&&o.left+i.width>n.right&&(o.left=Math.max(n.right-i.width,n.left)),r.adjustY&&o.top<n.top&&(o.top=n.top),r.resizeHeight&&o.top>=n.top&&o.top+i.height>n.bottom&&(i.height-=o.top+i.height-n.bottom),r.adjustY&&o.top+i.height>n.bottom&&(o.top=Math.max(n.bottom-i.height,n.top)),a.default.mix(o,i)}Object.defineProperty(t,"__esModule",{value:!0});var i=n(143),a=r(i);t.default=o,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=void 0,n=void 0,r=void 0;if(a.default.isWindow(e)||9===e.nodeType){var o=a.default.getWindow(e);t={left:a.default.getWindowScrollLeft(o),top:a.default.getWindowScrollTop(o)},n=a.default.viewportWidth(o),r=a.default.viewportHeight(o)}else t=a.default.offset(e),n=a.default.outerWidth(e),r=a.default.outerHeight(e);return t.width=n,t.height=r,t}Object.defineProperty(t,"__esModule",{value:!0});var i=n(143),a=r(i);t.default=o,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n,r,o){var i=void 0,s=void 0,l=void 0,u=void 0;return i={left:e.left,top:e.top},l=(0,a.default)(t,n[1]),u=(0,a.default)(e,n[0]),s=[u.left-l.left,u.top-l.top],{left:i.left-s[0]+r[0]-o[0],top:i.top-s[1]+r[1]-o[1]}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(505),a=r(i);t.default=o,e.exports=t.default},function(e,t,n){"use strict";function r(e,t){var n=t.charAt(0),r=t.charAt(1),o=e.width,i=e.height,a=void 0,s=void 0;return a=e.left,s=e.top,"c"===n?s+=i/2:"b"===n&&(s+=i),"c"===r?a+=o/2:"r"===r&&(a+=o),{left:a,top:s}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r,e.exports=t.default},function(e,t,n){"use strict";function r(e){return null!=e&&e==e.window}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){for(var n=window.getComputedStyle(e,null),r="",o=0;o<h.length&&!(r=n.getPropertyValue(h[o]+t));o++);return r}function i(e){if(d){var t=parseFloat(o(e,"transition-delay"))||0,n=parseFloat(o(e,"transition-duration"))||0,r=parseFloat(o(e,"animation-delay"))||0,i=parseFloat(o(e,"animation-duration"))||0,a=Math.max(n+t,i+r);e.rcEndAnimTimeout=setTimeout(function(){e.rcEndAnimTimeout=null,e.rcEndListener&&e.rcEndListener()},1e3*a+200)}}function a(e){e.rcEndAnimTimeout&&(clearTimeout(e.rcEndAnimTimeout),e.rcEndAnimTimeout=null)}Object.defineProperty(t,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=n(508),u=r(l),c=n(509),f=r(c),d=0!==u.default.endEvents.length,p=["Webkit","Moz","O","ms"],h=["-webkit-","-moz-","-o-","ms-",""],m=function(e,t,n){var r="object"===(void 0===t?"undefined":s(t)),o=r?t.name:t,l=r?t.active:t+"-active",c=n,d=void 0,p=void 0,h=(0,f.default)(e);return n&&"[object Object]"===Object.prototype.toString.call(n)&&(c=n.end,d=n.start,p=n.active),e.rcEndListener&&e.rcEndListener(),e.rcEndListener=function(t){t&&t.target!==e||(e.rcAnimTimeout&&(clearTimeout(e.rcAnimTimeout),e.rcAnimTimeout=null),a(e),h.remove(o),h.remove(l),u.default.removeEndEventListener(e,e.rcEndListener),e.rcEndListener=null,c&&c())},u.default.addEndEventListener(e,e.rcEndListener),d&&d(),h.add(o),e.rcAnimTimeout=setTimeout(function(){e.rcAnimTimeout=null,h.add(l),p&&setTimeout(p,0),i(e)},30),{stop:function(){e.rcEndListener&&e.rcEndListener()}}};m.style=function(e,t,n){e.rcEndListener&&e.rcEndListener(),e.rcEndListener=function(t){t&&t.target!==e||(e.rcAnimTimeout&&(clearTimeout(e.rcAnimTimeout),e.rcAnimTimeout=null),a(e),u.default.removeEndEventListener(e,e.rcEndListener),e.rcEndListener=null,n&&n())},u.default.addEndEventListener(e,e.rcEndListener),e.rcAnimTimeout=setTimeout(function(){for(var n in t)t.hasOwnProperty(n)&&(e.style[n]=t[n]);e.rcAnimTimeout=null,i(e)},0)},m.setTransition=function(e,t,n){var r=t,o=n;void 0===n&&(o=r,r=""),r=r||"",p.forEach(function(t){e.style[t+"Transition"+r]=o})},m.isCssAnimationSupported=d,t.default=m,e.exports=t.default},function(e,t,n){"use strict";function r(){var e=document.createElement("div"),t=e.style;"AnimationEvent"in window||delete a.animationend.animation,"TransitionEvent"in window||delete a.transitionend.transition;for(var n in a)if(a.hasOwnProperty(n)){var r=a[n];for(var o in r)if(o in t){s.push(r[o]);break}}}function o(e,t,n){e.addEventListener(t,n,!1)}function i(e,t,n){e.removeEventListener(t,n,!1)}Object.defineProperty(t,"__esModule",{value:!0});var a={transitionend:{transition:"transitionend",WebkitTransition:"webkitTransitionEnd",MozTransition:"mozTransitionEnd",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd"},animationend:{animation:"animationend",WebkitAnimation:"webkitAnimationEnd",MozAnimation:"mozAnimationEnd",OAnimation:"oAnimationEnd",msAnimation:"MSAnimationEnd"}},s=[];"undefined"!=typeof window&&"undefined"!=typeof document&&r();var l={addEndEventListener:function(e,t){if(0===s.length)return void window.setTimeout(t,0);s.forEach(function(n){o(e,n,t)})},endEvents:s,removeEndEventListener:function(e,t){0!==s.length&&s.forEach(function(n){i(e,n,t)})}};t.default=l,e.exports=t.default},function(e,t,n){function r(e){if(!e||!e.nodeType)throw new Error("A DOM element reference is required");this.el=e,this.list=e.classList}try{var o=n(315)}catch(e){var o=n(315)}var i=/\s+/,a=Object.prototype.toString;e.exports=function(e){return new r(e)},r.prototype.add=function(e){if(this.list)return this.list.add(e),this;var t=this.array();return~o(t,e)||t.push(e),this.el.className=t.join(" "),this},r.prototype.remove=function(e){if("[object RegExp]"==a.call(e))return this.removeMatching(e);if(this.list)return this.list.remove(e),this;var t=this.array(),n=o(t,e);return~n&&t.splice(n,1),this.el.className=t.join(" "),this},r.prototype.removeMatching=function(e){for(var t=this.array(),n=0;n<t.length;n++)e.test(t[n])&&this.remove(t[n]);return this},r.prototype.toggle=function(e,t){return this.list?(void 0!==t?t!==this.list.toggle(e,t)&&this.list.toggle(e):this.list.toggle(e),this):(void 0!==t?t?this.add(e):this.remove(e):this.has(e)?this.remove(e):this.add(e),this)},r.prototype.array=function(){var e=this.el.getAttribute("class")||"",t=e.replace(/^\s+|\s+$/g,""),n=t.split(i);return""===n[0]&&n.shift(),n},r.prototype.has=r.prototype.contains=function(e){return this.list?this.list.contains(e):!!~o(this.array(),e)}},function(e,t,n){"use strict";t.__esModule=!0,t.default=function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(){var e=document.createElement("div");return document.body.appendChild(e),e}function i(e){function t(e,t,n){if(!c||e._component||c(e)){e._container||(e._container=p(e));var r=void 0;r=e.getComponent?e.getComponent(t):f(e,t),u.default.unstable_renderSubtreeIntoContainer(e,r,e._container,function(){e._component=this,n&&n.call(this)})}}function n(e){if(e._container){var t=e._container;u.default.unmountComponentAtNode(t),t.parentNode.removeChild(t),e._container=null}}var r=e.autoMount,i=void 0===r||r,a=e.autoDestroy,l=void 0===a||a,c=e.isVisible,f=e.getComponent,d=e.getContainer,p=void 0===d?o:d,h=void 0;return i&&(h=(0,s.default)({},h,{componentDidMount:function(){t(this)},componentDidUpdate:function(){t(this)}})),i&&l||(h=(0,s.default)({},h,{renderComponent:function(e,n){t(this,e,n)}})),h=l?(0,s.default)({},h,{componentWillUnmount:function(){n(this)}}):(0,s.default)({},h,{removeContainer:function(){n(this)}})}Object.defineProperty(t,"__esModule",{value:!0});var a=n(67),s=r(a);t.default=i;var l=n(13),u=r(l);e.exports=t.default},function(e,t,n){function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!e.arrowPointAtCenter)return o.placements;var t=e.arrowWidth,n=void 0===t?5:t,r=e.horizontalArrowShift,s=void 0===r?16:r,l=e.verticalArrowShift,u=void 0===l?12:l;return{left:{points:["cr","cl"],overflow:i,offset:[-4,0],targetOffset:a},right:{points:["cl","cr"],overflow:i,offset:[4,0],targetOffset:a},top:{points:["bc","tc"],overflow:i,offset:[0,-4],targetOffset:a},bottom:{points:["tc","bc"],overflow:i,offset:[0,4],targetOffset:a},topLeft:{points:["bl","tc"],overflow:i,offset:[-(s+n),-4],targetOffset:a},leftTop:{points:["tr","cl"],overflow:i,offset:[-4,-(u+n)],targetOffset:a},topRight:{points:["br","tc"],overflow:i,offset:[s+n,-4],targetOffset:a},rightTop:{points:["tl","cr"],overflow:i,offset:[4,-(u+n)],targetOffset:a},bottomRight:{points:["tr","bc"],overflow:i,offset:[s+n,4],targetOffset:a},rightBottom:{points:["bl","cr"],overflow:i,offset:[4,u+n],targetOffset:a},bottomLeft:{points:["tl","bc"],overflow:i,offset:[-(s+n),4],targetOffset:a},leftBottom:{points:["br","cl"],overflow:i,offset:[-4,u+n],targetOffset:a}}}Object.defineProperty(t,"__esModule",{value:!0}),t.getPlacements=r;var o=n(301),i={adjustX:1,adjustY:1},a=[0,0]},function(e,t){},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(54),f=function(e){function t(e){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return a(t,e),s(t,null,[{key:"propTypes",get:function(){return{avatarSrc:l.PropTypes.string,customClass:l.PropTypes.string}}}]),s(t,[{key:"render",value:function(){var e=this.props.avatarSrc;return u.default.createElement("div",{className:"avatar "+this.props.customClass},u.default.createElement(c.ImageIcon,{customClass:"",defaultImg:"https://assets-cdn.shimo.im/assets/images/loading-b67e5a67dc.gif",realImg:e}))}}]),t}(l.Component);t.default=f,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(13),u=n(0),c=r(u),f=n(20),d=r(f),p=n(516),h=r(p),m=n(517),g=r(m),_=n(5),v=r(_),y=n(343),b=r(y),w=n(531),C=r(w);n(532);var S=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onMenuItemClick=n.onMenuItemClick.bind(n),n.onDownloadAppClose=n.onDownloadAppClose.bind(n),n}return a(t,e),s(t,null,[{key:"propTypes",get:function(){return{currentUser:u.PropTypes.object,closeMenuPopover:u.PropTypes.func}}}]),s(t,[{key:"onMenuItemClick",value:function(e){var t=this,n=this.props.closeMenuPopover,r=e.currentTarget.getAttribute("data-action");if("download"===r&&(this.modalContainer=document.getElementById("downloadapp-modal-container"),this.modalContainer||(this.modalContainer=document.createElement("div"),this.modalContainer.id="downloadapp-modal-container",document.body.appendChild(this.modalContainer)),this.downloadAppModal=(0,l.render)(c.default.createElement(g.default,{onClose:this.onDownloadAppClose}),this.modalContainer)),"invite"===r){var o=this.props.currentUser,i="invite-friends-modal-container";this.infModalContainer=document.getElementById(i),this.infModalContainer||(this.infModalContainer=document.createElement("div"),this.infModalContainer.id=i,document.body.appendChild(this.infModalContainer)),(0,l.render)(c.default.createElement(b.default,{onClose:function(){return(0,l.unmountComponentAtNode)(t.infModalContainer)},currentUser:o}),this.infModalContainer)}"function"==typeof n&&n()}},{key:"renderDividingLine",value:function(){return c.default.createElement("div",{className:"header-menu-dividing"})}},{key:"renderPlainMenuItem",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=(0,d.default)({"header-menu-item":!0,"one-line":!0,"enable-click":t}),i=t?this.onMenuItemClick:null;return t&&n?c.default.createElement("a",{className:o,href:n,rel:"external",target:r?"_blank":"",onClick:i},c.default.createElement("span",null,e)):c.default.createElement("div",{className:o,onClick:i},c.default.createElement("span",null,e))}},{key:"renderInviteFriends",value:function(){var e=this.props.currentUser.accountType;return-1===["personal_free","personal_premium"].indexOf(void 0===e?"personal_free":e)?null:c.default.createElement("div",{className:"invite-friends-wrap"},c.default.createElement("div",{className:"header-menu-item enable-click","data-action":"invite",onClick:this.onMenuItemClick},c.default.createElement("span",null,"邀请好友免费获得高级版")),c.default.createElement(C.default,null))}},{key:"onDownloadAppClose",value:function(){(0,l.unmountComponentAtNode)(this.modalContainer)}},{key:"renderDownloadApp",value:function(){return c.default.createElement("div",{className:"header-menu-item enable-click","data-action":"download",onClick:this.onMenuItemClick},c.default.createElement("span",null,"下载石墨文档 App"),c.default.createElement("i",{className:"desktop-sprite download-app-icon"}))}},{key:"renderAccountType",value:function(){return c.default.createElement("div",{className:"header-menu-item"},c.default.createElement(h.default,{currentUser:this.props.currentUser,onItemClick:this.onMenuItemClick}))}},{key:"renderManageSetting",value:function(){var e=this.props.currentUser,t=e.accountType,n=e.teamRole;return["enterprise_standard","enterprise_dingding","enterprise_expired"].indexOf(t)>-1?this.renderPlainMenuItem("member"===n?"我的企业":"企业管理",!0,"/enterprise",!v.default.isDingtalkPc()):null}},{key:"render",value:function(){var e=this.props.currentUser,t=e.name;return c.default.createElement("div",{className:"header-menu-items"},this.renderPlainMenuItem(t,!1)," ",this.renderDividingLine(),this.renderAccountType()," ",this.renderDividingLine()," ",this.renderPlainMenuItem("帐号设置",!0,"/profile",!1),this.renderManageSetting()," ",this.renderDividingLine(),this.renderInviteFriends(),this.renderDownloadApp()," ",this.renderPlainMenuItem("使用帮助",!0,"https://shimo.im/help",!v.default.isDingtalkPc()),this.renderDividingLine(),this.renderPlainMenuItem("退出登录",!0,"/logout",!1))}}]),t}(u.Component);t.default=S,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(22),f=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={orders:null},n.showEnterPrisePayment=n.showEnterPrisePayment.bind(n),n}return a(t,e),s(t,null,[{key:"propTypes",get:function(){return{currentUser:l.PropTypes.object,onItemClick:l.PropTypes.func}}}]),s(t,[{key:"componentDidMount",value:function(){var e=this;this.props.currentUser.accountType.match(/^personal_/)||(0,c.ajaxGet)("/orders?type=team").then(function(t){var n=t.data;e.changeOrders(n)})}},{key:"changeOrders",value:function(e){this.setState({orders:e})}},{key:"showEnterPrisePayment",value:function(e,t){var n=this;return function(r){r.preventDefault(),n.context.showEnterprisePayment(e,t),n.props.onItemClick(r)}}},{key:"render",value:function(){var e=this.props,t=e.currentUser,n=e.onItemClick,r=t.team,o=t.email,i=t.accountType,a=this.state.orders,s=a&&a[0]&&"offline"===a[0].channel&&!a[0].isPaid,l="",c=null;["enterprise_standard","enterprise_dingding","enterprise_expired"].indexOf(i)>-1?(l=t.isOfficial?"企业版":s?u.default.createElement("a",{href:"#",onClick:this.showEnterPrisePayment("normal",{page:"transfers-inventory",order:a&&a[0]})},"购买企业版"):u.default.createElement("a",{href:"#",onClick:this.showEnterPrisePayment()},"购买企业版"),c=u.default.createElement("span",{className:"enterprise-name"},r.name)):"personal_premium"===i?(l="高级版",c=u.default.createElement("span",null,u.default.createElement("a",{href:"/payment?renew",target:"_blank",className:"account-upgrade-btn header-menu-link"},"续费"),u.default.createElement("span",{className:"maybe"},"或"),u.default.createElement("a",{href:"/company/register",target:"_blank",className:"header-menu-link"},"升级到企业版"))):"personal_free"===i&&(l="基础版",c=u.default.createElement("a",{href:"/payment",target:"_blank",onClick:n,className:"account-upgrade-btn header-menu-link"},"升级"));var f=null;return f=o?u.default.createElement("span",{className:"account-email"},o):u.default.createElement("a",{className:"account-email-setting header-menu-link",href:"/profile#setting-email",onClick:n,target:"_blank"},"设置您的登录邮箱"),u.default.createElement("div",{className:"account-info"},u.default.createElement("div",{className:"account-type-wrapper"},u.default.createElement("span",{className:"account-type-text"},l),c),f)}}]),t}(l.Component);t.default=f,f.contextTypes={showEnterprisePayment:u.default.PropTypes.func},e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(51),f=r(c),d=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.bodyTpl=n.bodyTpl.bind(n),n.onModalClose=n.onModalClose.bind(n),n}return a(t,e),s(t,null,[{key:"propTypes",get:function(){return{onClose:l.PropTypes.func}}}]),s(t,[{key:"bodyTpl",value:function(){return u.default.createElement("div",{className:"download-app-content-wrap"},u.default.createElement("span",{className:"download-app-title"},"扫码下载 石墨文档 App"),u.default.createElement("div",{className:"download-app-url-qrcode"}),u.default.createElement("div",{className:"download-app-actions"},u.default.createElement("a",{href:"https://itunes.apple.com/cn/app/shi-mo-wen-dang-zui-mei-xie/id1013727678?l=en&mt=8",style:{display:"block"},className:"sm-btn sm-btn-primary download-app-btn",target:"_blank"},u.default.createElement("i",{className:"band-icon-sprite ios-band-icon band-icon"}),u.default.createElement("span",{className:"download-btn-text"},"App Store 下载")),u.default.createElement("a",{href:"https://shimo.im/resources/android_app",style:{display:"block"},className:"sm-btn sm-btn-primary download-app-btn",target:"_blank"},u.default.createElement("i",{className:"band-icon-sprite android-band-icon band-icon"}),u.default.createElement("span",{className:"download-btn-text"},"Android 版下载"))))}},{key:"onModalClose",value:function(){var e=this.props.onClose;"function"==typeof e&&e()}},{key:"render",value:function(){return u.default.createElement(f.default,{customClass:"download-app-modal",ref:"flatDialog",hasCloseButton:!0,open:!0,enableCloseClickMask:!0,bodyTpl:this.bodyTpl,onClose:this.onModalClose})}}]),t}(l.Component);t.default=d,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),i=r(o),a=n(54),s=n(519),l=r(s),u=n(526),c=r(u),f=function(e){var t=e.onClose,n=void 0===t?function(){}:t,r=e.currentUser;return i.default.createElement(a.Dialog,{open:!0,enableCloseClickMask:!0,title:"免费获得石墨文档高级版！",headTpl:function(e){return i.default.createElement(l.default,{title:e,onClose:n})},bodyTpl:function(){return i.default.createElement(c.default,{currentUser:r})},actions:[],onClose:n})};f.propTypes={onClose:o.PropTypes.func,currentUser:o.PropTypes.object},t.default=f,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),i=r(o),a=n(520),s=r(a),l=n(523),u=r(l),c=function(e){var t=e.title,n=e.onClose,r=void 0===n?function(){}:n;return i.default.createElement("div",null,t,i.default.createElement(s.default,{template:i.default.createElement(u.default,null)},i.default.createElement("span",{className:"question-tip"},"?")),i.default.createElement("span",{className:"hicon icon-close dialog-close right",onClick:function(){return r()}}))};c.propTypes={title:o.PropTypes.string,onClose:o.PropTypes.func},t.default=c,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(521),i=r(o);t.default=i.default,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),i=r(o);n(522);var a=o.PropTypes.node,s=function(e){var t=e.template,n=e.children;return i.default.createElement("div",{className:"bubble--"},i.default.createElement("div",{className:"bubble--container"},i.default.createElement("div",{className:"bubble--content"},t),i.default.createElement("div",{className:"bubble--tip"})),n)};s.propTypes={template:a,children:a},t.default=s,e.exports=t.default},function(e,t){},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(524),i=r(o);t.default=i.default,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),i=r(o);n(525);var a=function(){return i.default.createElement("div",{className:"bonus-tip-wrapper"},i.default.createElement("div",{className:"bonus-tip-head"},"石墨文档 ",i.default.createElement("b",null,"高级版"),i.default.createElement("span",{className:"price-desc right"},i.default.createElement("span",{className:"price-number"},"¥ 9")," / 人 / 月")),i.default.createElement("hr",null),i.default.createElement("div",{className:"bonus-tip-body"},i.default.createElement("div",null,"可多人协作的文档与表格",i.default.createElement("span",{className:"right"},"✓")),i.default.createElement("div",null,"单文件协作人数上限",i.default.createElement("span",{className:"right"},"无限")),i.default.createElement("div",null,"单图片附件体积上限",i.default.createElement("span",{className:"right"},"无限")),i.default.createElement("div",null,"优先使用新功能",i.default.createElement("span",{className:"right"},"✓")),i.default.createElement("div",null,"优先售后与技术支持",i.default.createElement("span",{className:"right"},"✓"))))};t.default=a,e.exports=t.default},function(e,t){},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=r(u),f=n(527),d=r(f),p=n(528),h=r(p),m=n(529),g=r(m),_=n(22),v=n(33),y=r(v),b=n(5),w=r(b),C=15,S=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={imgUrl:"",ticket:"",isWechat:!0,invite:{count:0,bonus:0,isBound:!1,isObtained:!1}},n.changeToHigh=n.changeToHigh.bind(n),n.getInviteUser=n.getInviteUser.bind(n),n.resolveInviteStatus=n.resolveInviteStatus.bind(n),n.bindNotification=n.bindNotification.bind(n),n.rewardWechat=n.rewardWechat.bind(n),n.rewardByInvitor=n.rewardByInvitor.bind(n),n.noRewardWechat=n.noRewardWechat.bind(n),n.reloadSession=n.reloadSession.bind(n),n}return a(t,e),l(t,[{key:"componentDidMount",value:function(){this.getImgUrl(),this.getInviteUser(),this.bindNotification()}},{key:"componentWillUnmount",value:function(){var e=this.listener;y.default.unbind("INVITE_ACTS",e)}},{key:"getInviteUser",value:function(){var e=this;(0,_.ajaxGet)("/smapi/invite/invite_info").then(function(t){if(0===t.code){var n=e.resolveInviteStatus(t.data);e.setState({invite:s({},e.state.invite,n)})}}).catch(function(e){console.log(e)})}},{key:"resolveInviteStatus",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.have_rewarded,n=void 0===t?0:t,r=e.not_yet_rewarded,o=void 0===r?0:r,i=e.rewarded_by_self_count,a=void 0===i?0:i,s=e.self_bind,l=void 0!==s&&s,u=e.rewarded_by_self_bind,c=void 0!==u&&u,f=e.is_reward_just;return void 0!==f&&f&&this.reloadSession(),{count:n+o-a,bonus:o*C,isBound:l,isObtained:c}}},{key:"getImgUrl",value:function(){var e=this;(0,g.default)("/wechat/binding_qrcode").then(function(t){if(0!==t.code||!t.data.url)return null;e.setState({imgUrl:t.data.url,ticket:t.data.ticket})}).catch(function(e){console.log(e,"error")})}},{key:"changeToHigh",value:function(){var e=this;if(0===this.state.invite.bonus)return null;(0,_.ajaxPost)("/smapi/invite/invitee_convert",{}).then(function(t){0===t.code?(e.setState({invite:s({},e.state.invite,e.resolveInviteStatus(t.data))}),w.default.alert({title:"兑换成功！",delay:1500})):w.default.alert({title:t.message,delay:1500,type:"error"})}).catch(function(e){console.log(e)})}},{key:"bindNotification",value:function(){var e=this;e.listener=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.name;switch(n){case"wechat_rewarded":e.rewardWechat();break;case"invitor_bind":e.rewardByInvitor();break;case"wechat_no_reward":e.noRewardWechat();break;default:console.error("unexpected notification name ["+n+"] from push #INVITE_ACTS")}e.reloadSession()},y.default.bind("INVITE_ACTS",this.listener)}},{key:"rewardWechat",value:function(){var e=this.state.invite;this.setState({invite:s({},e,{isBound:!0,isObtained:!0})})}},{key:"rewardByInvitor",value:function(){var e=this.state.invite;this.setState({invite:s({},e,{count:e.count+1,bonus:e.bonus+C})})}},{key:"noRewardWechat",value:function(){var e=this.state.invite;this.setState({invite:s({},e,{isBound:!0})})}},{key:"reloadSession",value:function(){w.default.get("/relogin",function(){})}},{key:"render",value:function(){var e=this.state.invite,t=e.count,n=void 0===t?0:t,r=e.bonus,o=void 0===r?0:r,i=e.isBound,a=void 0!==i&&i,s=e.isObtained,l=void 0!==s&&s,u=this.props.currentUser,f=void 0===u?{}:u,p=location.origin+"?inviterid="+f.id+"&invitername="+f.name+"&share=1&force=1",m=location.origin+"/?inviterid="+f.id+"&invitername="+encodeURIComponent(f.name),g="试试可多人实时协作的云端文档和表格吧，还能免费获得 15 天高级版帐号，点击链接开始使用 "+m;return c.default.createElement("div",null,c.default.createElement("div",{className:"invite-friends-body-wrapper"},c.default.createElement("div",{className:"invite-friends-section-wrapper"},c.default.createElement("div",{className:"invite-friends-section-title"},"方式一：邀请好友注册并绑定微信"),c.default.createElement("div",{className:"invite-friends-desc"},c.default.createElement("div",{className:"invite-friends-text"},c.default.createElement("div",{className:"paragraph"},"每当您成功邀请一位好友注册石墨文档并绑定他的微信时， 你可以免费获得 15 天高级版。"),c.default.createElement("div",{className:"paragraph"},c.default.createElement(h.default,{text:g},c.default.createElement("a",null,"点击这里复制专属邀请链接"))," 或 扫码分享石墨文档给朋友。")),c.default.createElement(d.default,{className:"qrcode",size:80,url:p})),c.default.createElement("div",{className:"invite-friends-summary-wrapper"},c.default.createElement("div",{className:"invite-friends-text invite-friends-text-success"},"已成功邀请并绑定微信的好友",c.default.createElement("span",{className:"right"},n,"人")),c.default.createElement("div",{className:"invite-friends-text"},"可兑换高级版使用期",c.default.createElement("span",{className:"right"},o,"天"),c.default.createElement("span",{className:"invite-friends-claim "+(0!==o?"highlight":"disabled"),onClick:this.changeToHigh},"立即兑换高级版")))),c.default.createElement("hr",null),c.default.createElement("div",{className:"invite-friends-section-wrapper invite-friends-section-wrapper-bindself"},c.default.createElement("div",{className:"invie-frinends-section-left",style:{paddingTop:16}},c.default.createElement("div",{className:"invite-friends-section-title"},"方式二：绑定你的微信号"),c.default.createElement("div",null,c.default.createElement("span",{className:a?"line-through":""},"用微信扫码，绑定帐号，立即获得 15 天高级版。"),l?c.default.createElement("span",{className:"bind-success"},"已获得 ✓"):null)),a?null:c.default.createElement(d.default,{className:"qrcode",size:80,url:this.state.imgUrl,isWechat:this.state.isWechat,ticket:this.state.ticket}))),c.default.createElement("div",{className:"invite-friends-modal-footer"},"每人每月不到一杯咖啡的价格，即可获得更多企业管理功能。",c.default.createElement("b",null,c.default.createElement("a",{href:"/pricing",target:"_blank"},"了解更多 >"))))}}]),t}(u.Component);S.propTypes={count:u.PropTypes.number,bonus:u.PropTypes.number,currentUser:u.PropTypes.object},t.default=S,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(0),a=r(i),s=i.PropTypes.number,l=i.PropTypes.string,u=i.PropTypes.bool,c={backgroundPosition:"center",backgroundRepeat:"no-repeat"},f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:300,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return"/qrcode?size="+(e>300?e:300)+"&margin=0&url="+t},d=function(e){var t=e.className,n=e.size,r=void 0===n?100:n,i=e.url,s=e.isWechat,l=e.ticket;return a.default.createElement("div",{className:t,style:o({width:r,height:r,backgroundSize:s&&l?"117%":"cover",backgroundImage:s&&l?"url(https://mp.weixin.qq.com/cgi-bin/showqrcode?ticket="+l+")":"url("+f(r,i)+")"},c)})};d.propTypes={className:l,size:s,url:l.isRequired,isWechat:u,ticket:l},t.default=d,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(5),f=r(c),d=n(327),p=r(d),h=l.PropTypes.string,m=l.PropTypes.func,g=l.PropTypes.node,_=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"componentDidMount",value:function(){this.initClipboard()}},{key:"componentWillUnmount",value:function(){this.clipboard&&this.clipboard.destroy()}},{key:"initClipboard",value:function(){var e=this.props,t=e.onCopy,n=void 0===t?function(){}:t,r=e.onError,o=void 0===r?function(){}:r;this.clipboard=new p.default(this.elm),this.clipboard.on("success",function(){n(),f.default.alert({title:"复制成功！",delay:1500})}),this.clipboard.on("error",function(){o(),f.default.alert({title:"复制失败！",delay:1500,type:"error"})})}},{key:"render",value:function(){var e=this,t=this.props,n=t.text,r=t.children;return u.default.createElement("span",{"data-clipboard-action":"copy","data-clipboard-text":n,ref:function(t){e.elm=t}},r)}}]),t}(l.Component);_.propTypes={text:h,onCopy:m,onError:m,children:g},t.default=_,e.exports=t.default},function(e,t,n){function r(e){return(0,o.ajaxGet)(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var o=n(22);e.exports=t.default},function(e,t){},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=r(u),f=n(22),d=n(33),p=r(d),h=n(5),m=r(h),g=15,_=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={count:0,bonus:0,isBound:!1,isObtained:!0},n.getInviteUser=n.getInviteUser.bind(n),n.bindNotification=n.bindNotification.bind(n),n.rewardWechat=n.rewardWechat.bind(n),n.rewardByInvitor=n.rewardByInvitor.bind(n),n.noRewardWechat=n.noRewardWechat.bind(n),n.reloadSession=n.reloadSession.bind(n),n}return a(t,e),l(t,[{key:"componentDidMount",value:function(){this.getInviteUser(),this.bindNotification()}},{key:"componentWillUnmount",value:function(){var e=this.listener;p.default.unbind("INVITE_ACTS",e)}},{key:"getInviteUser",value:function(){var e=this;(0,f.ajaxGet)("/smapi/invite/invite_info").then(function(t){if(0===t.code){var n=e.resolveInviteStatus(t.data);e.setState(s({},e.state,n))}}).catch(function(e){console.log(e)})}},{key:"resolveInviteStatus",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.have_rewarded,n=void 0===t?0:t,r=e.not_yet_rewarded,o=void 0===r?0:r,i=e.rewarded_by_self_count,a=void 0===i?0:i,s=e.self_bind,l=void 0!==s&&s,u=e.rewarded_by_self_bind,c=void 0!==u&&u,f=e.is_reward_just;return void 0!==f&&f&&m.default.get("/relogin",function(){}),{count:n+o-a,bonus:o*g,isBound:l,isObtained:c}}},{key:"bindNotification",value:function(){var e=this;e.listener=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.name;switch(n){case"wechat_rewarded":e.rewardWechat();break;case"invitor_bind":e.rewardByInvitor();break;case"wechat_no_reward":e.noRewardWechat();break;default:console.error("unexpected notification name ["+n+"] from push #INVITE_ACTS")}e.reloadSession()},p.default.bind("INVITE_ACTS",e.listener)}},{key:"rewardWechat",value:function(){this.setState(s({},this.state,{isBound:!0,isObtained:!0}))}},{key:"rewardByInvitor",value:function(){this.setState(s({},this.state,{count:this.state.count+1,bonus:this.state.bonus+g}))}},{key:"noRewardWechat",value:function(){var e=this.state.invite;this.setState({invite:s({},e,{isBound:!0})})}},{key:"reloadSession",value:function(){m.default.get("/relogin",function(){})}},{key:"render",value:function(){var e=this.state,t=e.isObtained,n=e.bonus;return!t||n?c.default.createElement("span",{className:"bubble"},"可领取"):null}}]),t}(c.default.Component);t.default=_,e.exports=t.default},function(e,t){},,,,,,,,,,,,function(e,t,n){e.exports=function(){n(74).injection.injectEventPluginsByName({TapEventPlugin:n(550)})}},function(e,t,n){"use strict";t.__esModule=!0;var r=n(0);t.default=r.PropTypes.shape({subscribe:r.PropTypes.func.isRequired,dispatch:r.PropTypes.func.isRequired,getState:r.PropTypes.func.isRequired})},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=t.repeat=function(e,t){return new Array(t+1).join(e)},o=t.pad=function(e,t){return r("0",t-e.toString().length)+e};t.formatTime=function(e){return o(e.getHours(),2)+":"+o(e.getMinutes(),2)+":"+o(e.getSeconds(),2)+"."+o(e.getMilliseconds(),3)},t.timer="undefined"!=typeof performance&&null!==performance&&"function"==typeof performance.now?performance:Date},,,function(e,t,n){"use strict";function r(e,t){var n=u.extractSingleTouch(t);return n?n[e.page]:e.page in t?t[e.page]:t[e.client]+c[e.envScroll]}function o(e,t){var n=r(b.x,t),o=r(b.y,t);return Math.pow(Math.pow(n-e.x,2)+Math.pow(o-e.y,2),.5)}var i=n(35),a=n(264),s=n(75),l=n(76),u=n(551),c=n(180),f=n(49),d=i.topLevelTypes,p=a.isStartish,h=a.isEndish,m=function(e){return[d.topTouchCancel,d.topTouchEnd,d.topTouchStart,d.topTouchMove].indexOf(e)>=0},g=10,_=750,v={x:null,y:null},y=null,b={x:{page:"pageX",client:"clientX",envScroll:"currentPageScrollLeft"},y:{page:"pageY",client:"clientY",envScroll:"currentPageScrollTop"}},w=[d.topTouchStart,d.topTouchCancel,d.topTouchEnd,d.topTouchMove],C=[d.topMouseDown,d.topMouseMove,d.topMouseUp].concat(w),S={touchTap:{phasedRegistrationNames:{bubbled:f({onTouchTap:null}),captured:f({onTouchTapCapture:null})},dependencies:C}},x=function(){return Date.now?Date.now:function(){return+new Date}}(),T={tapMoveThreshold:g,ignoreMouseThreshold:_,eventTypes:S,extractEvents:function(e,t,n,i,a){if(m(e))y=x();else if(y&&x()-y<_)return null;if(!p(e)&&!h(e))return null;var u=null,c=o(v,i);return h(e)&&c<g&&(u=l.getPooled(S.touchTap,n,i,a)),p(e)?(v.x=r(b.x,i),v.y=r(b.y,i)):h(e)&&(v.x=0,v.y=0),s.accumulateTwoPhaseDispatches(u),u}};e.exports=T},function(e,t){var n={extractSingleTouch:function(e){var t=e.touches,n=e.changedTouches,r=t&&t.length>0,o=n&&n.length>0;return!r&&o?n[0]:r?t[0]:e}};e.exports=n},function(e,t,n){(function(r){var o,i;o=[n(34)],void 0!==(i=function(e){return new(function(){function t(){this.isReady=!1,this.guideDocTitle="欢迎使用石墨文档",this.$tipContainter=r("body"),this.sheetSplashName="spread_sheet_splash",this.needToGuide()&&(window.cow.guideStatus?this.guideStatus=window.cow.guideStatus:this.getGuideInfo()),this.accountTypeStatus=""}return t.prototype.needToGuide=function(){return(["payment","home","folder"].indexOf(window.cow.pageType)>=0||this.isGuideDoc())&&!cow.isMobile&&!cow.readonly&&cow.currentUser.id>0},t.prototype.checkIsReady=function(){var e,t;return t=this,e=r.Deferred(),t.isReady?e.resolve(t.guideStatus):t.getGuideInfo().then(function(){return t.isReady=!0,e.resolve(t.guideStatus)}).fail(function(){return e.reject()}),e.promise()},t.prototype.getGuideInfo=function(){var t,n;return n=this,t=r.Deferred(),e.get("/api/user_guide_info",{guide_type:"web"},function(e){return 0===e.code?(window.cow.guideStatus=e.data.status,n.guideStatus=window.cow.guideStatus,window.cow.guideStatus.tips=[],n.isReady=!0,t.resolve()):t.reject()},function(){return t.reject()}),t.promise()},t.prototype.getMembershipInfo=function(){var t,n;return n=this,t=r.Deferred(),e.get("/api/get_membership_info",{},function(e){return 0===e.code?(n.shouldNotifyRenewal=e.data.shouldNotifyRenewal,n.shouldNotifyExpiration=e.data.shouldNotifyExpiration,n.shouldNotifyExceedMemberCount=e.data.shouldNotifyExceedMemberCount,cow.currentUser.accountTypeExpiredAt=e.data.accountTypeExpiredAt,t.resolve()):t.reject()},function(){return t.reject()}),t.promise()},t.prototype.removeMembershipTip=function(){return e.post("/flash_messages/read",{message_name:"membership_"+this.accountTypeStatus})},t.prototype.removeTipAjax=function(t){var n,o;return o=this,n=r.Deferred(),e.post("/api/update_user_guide_info",{guide_type:"web",type:t}).then(function(){return window.cow.guideStatus[t]=o.guideStatus[t]=!0,n.resolve()}).fail(function(){return n.reject()}),n.promise()},t.prototype.isGuideDoc=function(){return"doc"===window.cow.pageType&&window.cow.currentFile.name===this.guideDocTitle},t}())}.apply(t,o))&&(e.exports=i)}).call(t,n(2))},function(e,t){function n(e){if(null!=e){try{return o.call(e)}catch(e){}try{return e+""}catch(e){}}return""}var r=Function.prototype,o=r.toString;e.exports=n},function(e,t,n){var r=n(595),o=n(199),i=Object.prototype,a=i.hasOwnProperty,s=i.propertyIsEnumerable,l=r(function(){return arguments}())?r:function(e){return o(e)&&a.call(e,"callee")&&!s.call(e,"callee")};e.exports=l},function(e,t,n){(function(e){var r=n(150),o=n(596),i="object"==typeof t&&t&&!t.nodeType&&t,a=i&&"object"==typeof e&&e&&!e.nodeType&&e,s=a&&a.exports===i,l=s?r.Buffer:void 0,u=l?l.isBuffer:void 0,c=u||o;e.exports=c}).call(t,n(52)(e))},function(e,t,n){var r=n(597),o=n(598),i=n(599),a=i&&i.isTypedArray,s=a?o(a):r;e.exports=s},,,,,,,,,,,,,,,,,function(e,t,n){(function(t){e.exports=function(e,n,r,o,i){if("Script error."!==e&&i){var a={msg:e,url:window.location.href,error_name:i.name,error_message:i.message,error_stack:i.stack,error_file:n},s=JSON.stringify(a);window._lastJSErrorString!==s&&t.post("/api/log/jserror",a,function(){}),window._lastJSErrorString=s}}}).call(t,n(2))},,,,,function(e,t){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=null,i={userInfo:{avatar:"face",name:"uname",realName:"realname",mobile:"tel",email:"email"},customFiled:{userType:"customField11",userRole:"customField12",isOfficial:"customField13",registerAt:"customField14",enterprise:"customField15"}},a=function(){function e(t){var r=this;n(this,e),this.options=t,this.insertSobotScript(),this.checkScriptLoaded().then(function(){window.zhiManager=o=window.getzhiSDKInstance(),o.on("load",function(){r.initSobot()})})}return r(e,[{key:"checkScriptLoaded",value:function(){return new Promise(function(e,t){window.getzhiSDKInstance&&e();var n=0,r=setInterval(function(){window.getzhiSDKInstance&&(clearInterval(r),e()),n>100&&(clearInterval(r),t(new Error("load sobot failed"))),n++},200)})}},{key:"getDataArgs",value:function(){var e=this.options.dataArgs,t=i.userInfo,n=i.customFiled,r="";for(var o in t){var a=t[o];a&&e.hasOwnProperty(o)&&(r&&(r+="&"),r+=a+"="+e[o])}var s={};for(var l in n){var u=n[l];u&&e.hasOwnProperty(l)&&(s[u]=e[l])}return"manual=true&customBtn=true&powered=false&moduleType="+("number"==typeof this.options.moduleType?this.options.moduleType:3)+"&partnerId="+(e.userId||"")+"&"+r+"&customerFields="+JSON.stringify(s)}},{key:"insertSobotScript",value:function(){var e=document.createElement("script");e.src="https://www.sobot.com/chat/frame/js/entrance.js?sysNum=99f41a92d15542b7a884c7e355359961",e.id="zhichiScript",e.className=this.options.trigger,e.setAttribute("data-args",this.getDataArgs()),document.head.appendChild(e)}},{key:"initSobot",value:function(){this.bindSobotHook(),this.initSobotSetting(),this.initSobotBtn()}},{key:"initSobotBtn",value:function(){o.initBtnDOM()}},{key:"initSobotSetting",value:function(){}},{key:"bindSobotHook",value:function(){var e=this;o.on("core.framestatuschange",function(t){"collapse"===t?e.options.onVisibleChange&&e.options.onVisibleChange(!1):"expand"===t&&e.options.onVisibleChange&&e.options.onVisibleChange(!0)}),o.on("unread.count",function(t){e.options.onOfflineMessageChange&&e.options.onOfflineMessageChange(t)}),o.on("receivemessage",function(t){e.options.onUnreadChange&&e.options.onUnreadChange(t)}),o.on("frame.onload",function(){e.options.onFrameLoaded&&e.options.onFrameLoaded()})}}]),e}();t.default=a,e.exports=t.default},function(e,t,n){var r,o;r=[n(670)],void 0!==(o=function(e){return e.configure({minimum:.6,easing:"linear",positionUsing:"",speed:250,trickle:!0,trickleRate:.01,trickleSpeed:150,showSpinner:!1,barSelector:'[role="bar"]',parent:"body",template:'<div class="bar" role="bar"><div class="peg"></div></div></div></div>'}),e}.apply(t,r))&&(e.exports=o)},,function(e,t){function n(e,t,n){void 0!==window.ga&&window.ga("send","event",e,t,n)}Object.defineProperty(t,"__esModule",{value:!0}),t.default={track:n},e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(5),f=r(c),d=n(9),p=r(d),h=n(21),m=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=window.cow.currentFile.updated_at||new Date,a=f.default.DateTime.format(r)+"更新",s=n.fileTypeName=(0,h.getFileTypeName)(window.cow.currentFile.type);return"刚刚更新"===a&&(a=((0,h.isDoc)(window.cow.pageType),s+"将实时更新")),n.state={offline:!1,displayText:a,lastUpdateTime:r,timerId:-1},n.clickNum=0,n}return a(t,e),s(t,[{key:"componentWillMount",value:function(){this._triggerCleanData=this._triggerCleanData.bind(this)}},{key:"componentDidMount",value:function(){var e=this;p.default.attachOne("saveStatus:start",function(){return e._startSave()}),p.default.attachOne("saveStatus:success",function(){return e._saveSuccess()}),p.default.attachOne("saveStatus:error",function(){return e._saveError()}),p.default.attachOne("saveStatus:getUpdate",function(){return e._getUpdateFromServer()}),p.default.attachOne("saveStatus:offline",function(){return e._saveOffline()}),p.default.attachOne("saveStatus:offlineSuccess",function(){return e._saveOfflineSuccess()}),p.default.attachOne("saveStatus:uninit",function(){return e._saveUninit()}),p.default.attach("doc:goback",function(){return e._destroyTimerTick()}),p.default.attach("spreadsheet:exit",function(){return e._destroyTimerTick()}),this._tellClient(),this._createTimerTick()}},{key:"_startSave",value:function(){this._destroyTimerTick();var e="正在保存...";this.state.offline&&(e="正在离线保存..."),this.setState({displayText:e},this._tellClient)}},{key:"_saveSuccess",value:function(){this.setState({offline:!1,displayText:"所有更改都已保存在云端",lastUpdateTime:(new Date).toString()},this._tellClient),this._createTimerTick()}},{key:"_saveError",value:function(){this.setState({displayText:"保存失败"},this._tellClient)}},{key:"_saveOffline",value:function(){this.setState({offline:!0,displayText:"已离线保存"},this._tellClient)}},{key:"_saveOfflineSuccess",value:function(){this.setState({displayText:"离线保存成功"},this._tellClient)}},{key:"_saveUninit",value:function(){this.setState({displayText:"初始化中"},this._tellClient)}},{key:"_getUpdateFromServer",value:function(){this.setState({displayText:this.fileTypeName+"将实时更新",lastUpdateTime:(new Date).toString()},this._tellClient),this._destroyTimerTick(),this._createTimerTick()}},{key:"_createTimerTick",value:function(){var e=this,t=setInterval(function(){if(e.state.lastUpdateTime){var t=f.default.DateTime.format(e.state.lastUpdateTime)+"更新";"刚刚更新"===t&&(t=this.fileTypeName+"将实时更新"),e.setState({displayText:t},e._tellClient)}},18e5);e.setState({timerId:t})}},{key:"_destroyTimerTick",value:function(){clearInterval(this.state.timerId)}},{key:"_tellClient",value:function(){if((0,h.isClient)()){var e=this.state.displayText;p.default.notify("updateSaveStatus",{message:e})}}},{key:"_triggerCleanData",value:function(){var e=(new Date).getTime();0===this.clickNum&&(this.start=e),0!==this.clickNum&&e-this.start>1500&&(this.start=e,this.clickNum=0),this.clickNum+=1,5===this.clickNum&&(this.clickNum=0,p.default.notify("statusBar:triggerCleanData"))}},{key:"render",value:function(){var e;return"保存失败"===this.state.displayText&&(e={color:"#ee7b70"}),u.default.createElement("span",{className:this.props.customClassName,style:e,id:"save-status",onClick:this._triggerCleanData},this.state.displayText)}}]),t}(l.Component);t.default=m,m.propTypes={customClassName:u.default.PropTypes.string},e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var n=t&&t.type;return'Reducer "'+e+'" returned undefined handling '+(n&&'"'+n.toString()+'"'||"an action")+". To ignore an action, you must explicitly return the previous state."}function i(e){Object.keys(e).forEach(function(t){var n=e[t];if(void 0===n(void 0,{type:s.ActionTypes.INIT}))throw new Error('Reducer "'+t+'" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined.');if(void 0===n(void 0,{type:"@@redux/PROBE_UNKNOWN_ACTION_"+Math.random().toString(36).substring(7).split("").join(".")}))throw new Error('Reducer "'+t+"\" returned undefined when probed with a random type. Don't try to handle "+s.ActionTypes.INIT+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined.')})}function a(e){var t,n=d.default(e,function(e){return"function"==typeof e});try{i(n)}catch(e){t=e}var r=c.default(n,function(){});return function(e,i){if(void 0===e&&(e=r),t)throw t;var a=!1,s=c.default(n,function(t,n){var r=e[n],s=t(r,i);if(void 0===s){var l=o(n,i);throw new Error(l)}return a=a||s!==r,s});return a?s:e}}t.__esModule=!0,t.default=a;var s=n(412),l=n(413),u=(r(l),n(414)),c=r(u),f=n(584),d=r(f);e.exports=t.default},function(e,t,n){"use strict";function r(e,t){return Object.keys(e).reduce(function(n,r){return t(e[r])&&(n[r]=e[r]),n},{})}t.__esModule=!0,t.default=r,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){return function(){return t(e.apply(void 0,arguments))}}function i(e,t){if("function"==typeof e)return o(e,t);if("object"!=typeof e||null===e||void 0===e)throw new Error("bindActionCreators expected an object or a function, instead received "+(null===e?"null":typeof e)+'. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?');return s.default(e,function(e){return o(e,t)})}t.__esModule=!0,t.default=i;var a=n(414),s=r(a);e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return function(n,r){var o=e(n,r),a=o.dispatch,l=[],u={getState:o.getState,dispatch:function(e){return a(e)}};return l=t.map(function(e){return e(u)}),a=s.default.apply(void 0,l)(o.dispatch),i({},o,{dispatch:a})}}}t.__esModule=!0;var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};t.default=o;var a=n(415),s=r(a);e.exports=t.default},function(e,t,n){function r(e){return!(!a(e)||i(e))&&(o(e)?h:u).test(s(e))}var o=n(416),i=n(590),a=n(175),s=n(553),l=/[\\^$.*+?()[\]{}|]/g,u=/^\[object .+?Constructor\]$/,c=Function.prototype,f=Object.prototype,d=c.toString,p=f.hasOwnProperty,h=RegExp("^"+d.call(p).replace(l,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=r},function(e,t,n){function r(e){var t=a.call(e,l),n=e[l];try{e[l]=void 0;var r=!0}catch(e){}var o=s.call(e);return r&&(t?e[l]=n:delete e[l]),o}var o=n(324),i=Object.prototype,a=i.hasOwnProperty,s=i.toString,l=o?o.toStringTag:void 0;e.exports=r},function(e,t){function n(e){return o.call(e)}var r=Object.prototype,o=r.toString;e.exports=n},function(e,t,n){function r(e){return!!i&&i in e}var o=n(591),i=function(){var e=/[^.]+$/.exec(o&&o.keys&&o.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();e.exports=r},function(e,t,n){var r=n(150),o=r["__core-js_shared__"];e.exports=o},function(e,t){function n(e,t){return null==e?void 0:e[t]}e.exports=n},function(e,t,n){function r(e,t){var n=a(e),r=!n&&i(e),c=!n&&!r&&s(e),d=!n&&!r&&!c&&u(e),p=n||r||c||d,h=p?o(e.length,String):[],m=h.length;for(var g in e)!t&&!f.call(e,g)||p&&("length"==g||c&&("offset"==g||"parent"==g)||d&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||l(g,m))||h.push(g);return h}var o=n(594),i=n(554),a=n(261),s=n(555),l=n(329),u=n(556),c=Object.prototype,f=c.hasOwnProperty;e.exports=r},function(e,t){function n(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}e.exports=n},function(e,t,n){function r(e){return i(e)&&o(e)==a}var o=n(198),i=n(199),a="[object Arguments]";e.exports=r},function(e,t){function n(){return!1}e.exports=n},function(e,t,n){function r(e){return a(e)&&i(e.length)&&!!s[o(e)]}var o=n(198),i=n(336),a=n(199),s={};s["[object Float32Array]"]=s["[object Float64Array]"]=s["[object Int8Array]"]=s["[object Int16Array]"]=s["[object Int32Array]"]=s["[object Uint8Array]"]=s["[object Uint8ClampedArray]"]=s["[object Uint16Array]"]=s["[object Uint32Array]"]=!0,s["[object Arguments]"]=s["[object Array]"]=s["[object ArrayBuffer]"]=s["[object Boolean]"]=s["[object DataView]"]=s["[object Date]"]=s["[object Error]"]=s["[object Function]"]=s["[object Map]"]=s["[object Number]"]=s["[object Object]"]=s["[object RegExp]"]=s["[object Set]"]=s["[object String]"]=s["[object WeakMap]"]=!1,e.exports=r},function(e,t){function n(e){return function(t){return e(t)}}e.exports=n},function(e,t,n){(function(e){var r=n(417),o="object"==typeof t&&t&&!t.nodeType&&t,i=o&&"object"==typeof e&&e&&!e.nodeType&&e,a=i&&i.exports===o,s=a&&r.process,l=function(){try{return s&&s.binding&&s.binding("util")}catch(e){}}();e.exports=l}).call(t,n(52)(e))},function(e,t,n){function r(e){if(!o(e))return i(e);var t=[];for(var n in Object(e))s.call(e,n)&&"constructor"!=n&&t.push(n);return t}var o=n(418),i=n(601),a=Object.prototype,s=a.hasOwnProperty;e.exports=r},function(e,t,n){var r=n(602),o=r(Object.keys,Object);e.exports=o},function(e,t){function n(e,t){return function(n){return e(t(n))}}e.exports=n},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),f=n(54),d=n(439),p=r(d),h=n(5),m=r(h),g=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getGroupedUsers=n.getGroupedUsers.bind(n),n.showAddUsersPanel=n.showAddUsersPanel.bind(n),n}return a(t,e),s(t,null,[{key:"propTypes",get:function(){return{file:l.PropTypes.object,storage:l.PropTypes.object,maxShareCount:l.PropTypes.number,getSharedUsers:l.PropTypes.func,getFile:l.PropTypes.func,setPermission:l.PropTypes.func,onButtonClick:l.PropTypes.func,cleanModals:l.PropTypes.func,pushModal:l.PropTypes.func,popModal:l.PropTypes.func,overflow:l.PropTypes.array}}},{key:"defaultProps",get:function(){return{onButtonClick:function(){},file:cow.currentFile}}}]),s(t,[{key:"componentDidMount",value:function(){this.props.getSharedUsers(this.props.file.guid)}},{key:"getSharedUsers",value:function(){var e=this.props,t=e.storage,n=e.file,r=t.filePermissions[n.guid],o=t.permissions[n.guid];return(0,c.map)(r,function(e){var n=t.users[e],r=o[e]||"editable";return(0,c.assign)({},n,{permission:r})})}},{key:"getGroupedUsers",value:function(){var e=this.getSharedUsers(),t=[],n=[],r=[],o=this.props.file?this.props.file.teamId:0;return(0,c.forEach)(e,function(e){"owner"===e.role?t.push(e):e.team_id&&e.team_id===o?n.push(e):r.push(e)}),[].concat(t).concat(r).concat(n)}},{key:"showAddUsersPanel",value:function(){var e=this.props.file,t=window.cow.currentUser;e.permissions&&e.permissions.collaboratorManageable?this.props.onButtonClick("add"):t.teamId&&t.teamId===e.teamId?m.default.alert({title:"你是只读权限或只能评论的权限，不能添加协作者",type:"error"}):m.default.alert({title:"你是外部协作者，没有权限添加协作者，请联系文件所有者",type:"error"})}},{key:"render",value:function(){var e=u.default.createElement(f.TabItem,{key:"3",title:"协作者 ("+this.getSharedUsers().length+")"},u.default.createElement(p.default,{data:this.getGroupedUsers(),file:this.props.file,setPermission:this.props.setPermission,onButtonClick:this.props.onButtonClick,overflow:this.props.overflow,getPopupContainer:function(){return document.querySelector(".teamwork-shared-users")}}));return u.default.createElement("div",{className:"teamwork-shared-users"},u.default.createElement(f.Tab,{customClass:"sm-tab",disableSetWidth:!0},e),u.default.createElement("button",{className:"btn btn-ok",onClick:this.showAddUsersPanel},"添加协作者"))}}]),t}(l.Component);t.default=g,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Divider=t.ItemGroup=t.MenuItemGroup=t.MenuItem=t.Item=t.SubMenu=void 0;var o=n(755),i=r(o),a=n(761),s=r(a),l=n(765),u=r(l),c=n(766),f=r(c),d=n(767),p=r(d);t.SubMenu=s.default,t.Item=u.default,t.MenuItem=u.default,t.MenuItemGroup=f.default,t.ItemGroup=f.default,t.Divider=p.default,t.default=i.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){return!e.length||e.every(function(e){return!!e.props.disabled})}function i(e,t){var n=t,r=e.children,o=e.eventKey;if(n){var i=void 0;if((0,T.loopMenuItem)(r,function(e,t){e&&!e.props.disabled&&n===(0,T.getKeyFromChildrenIndex)(e,o,t)&&(i=!0)}),i)return n}return n=null,e.defaultActiveFirst?((0,T.loopMenuItem)(r,function(e,t){n||!e||e.props.disabled||(n=(0,T.getKeyFromChildrenIndex)(e,o,t))}),n):n}function a(e,t,n){n&&(void 0!==t?(this.instanceArray[e]=this.instanceArray[e]||[],this.instanceArray[e][t]=n):this.instanceArray[e]=n)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(300),l=r(s),u=n(67),c=r(u),f=n(0),d=r(f),p=n(37),h=r(p),m=n(13),g=r(m),_=n(339),v=r(_),y=n(756),b=r(y),w=n(20),C=r(w),S=n(757),x=r(S),T=n(340),E=n(760),M=r(E),A={propTypes:{focusable:h.default.bool,multiple:h.default.bool,style:h.default.object,defaultActiveFirst:h.default.bool,visible:h.default.bool,activeKey:h.default.string,selectedKeys:h.default.arrayOf(h.default.string),defaultSelectedKeys:h.default.arrayOf(h.default.string),defaultOpenKeys:h.default.arrayOf(h.default.string),openKeys:h.default.arrayOf(h.default.string),children:h.default.any},getDefaultProps:function(){return{prefixCls:"rc-menu",className:"",mode:"vertical",level:1,inlineIndent:24,visible:!0,focusable:!0,style:{}}},getInitialState:function(){var e=this.props;return{activeKey:i(e,e.activeKey)}},componentWillReceiveProps:function(e){var t=void 0;if("activeKey"in e)t={activeKey:i(e,e.activeKey)};else{var n=this.state.activeKey,r=i(e,n);r!==n&&(t={activeKey:r})}t&&this.setState(t)},shouldComponentUpdate:function(e){return this.props.visible||e.visible},componentWillMount:function(){this.instanceArray=[]},onKeyDown:function(e){var t=this,n=e.keyCode,r=void 0;if(this.getFlatInstanceArray().forEach(function(t){t&&t.props.active&&(r=t.onKeyDown(e))}),r)return 1;var o=null;return n!==v.default.UP&&n!==v.default.DOWN||(o=this.step(n===v.default.UP?-1:1)),o?(e.preventDefault(),this.setState({activeKey:o.props.eventKey},function(){(0,x.default)(g.default.findDOMNode(o),g.default.findDOMNode(t),{onlyScrollIfNeeded:!0})}),1):void 0===o?(e.preventDefault(),this.setState({activeKey:null}),1):void 0},getOpenChangesOnItemHover:function(e){var t=this.props.mode,n=e.key,r=e.hover,o=e.trigger,i=this.state.activeKey;if(o&&!r&&!this.props.closeSubMenuOnMouseLeave&&e.item.isSubMenu&&"inline"!==t||this.setState({activeKey:r?n:null}),r&&"inline"!==t){var a=this.getFlatInstanceArray().filter(function(e){return e&&e.props.eventKey===i})[0];if(a&&a.isSubMenu&&a.props.eventKey!==n)return{item:a,originalEvent:e,key:a.props.eventKey,open:!1}}return[]},getFlatInstanceArray:function(){var e=this.instanceArray;return e.some(function(e){return Array.isArray(e)})&&(e=[],this.instanceArray.forEach(function(t){Array.isArray(t)?e.push.apply(e,t):e.push(t)}),this.instanceArray=e),e},renderCommonMenuItem:function(e,t,n,r){var o=this.state,i=this.props,s=(0,T.getKeyFromChildrenIndex)(e,i.eventKey,t),l=e.props,u=s===o.activeKey,f=(0,c.default)({mode:i.mode,level:i.level,inlineIndent:i.inlineIndent,renderMenuItem:this.renderMenuItem,rootPrefixCls:i.prefixCls,index:t,parentMenu:this,ref:l.disabled?void 0:(0,b.default)(e.ref,a.bind(this,t,n)),eventKey:s,closeSubMenuOnMouseLeave:i.closeSubMenuOnMouseLeave,onItemHover:this.onItemHover,active:!l.disabled&&u,multiple:i.multiple,onClick:this.onClick,openTransitionName:this.getOpenTransitionName(),openAnimation:i.openAnimation,onOpenChange:this.onOpenChange,onDeselect:this.onDeselect,onDestroy:this.onDestroy,onSelect:this.onSelect},r);return"inline"===i.mode&&(f.closeSubMenuOnMouseLeave=f.openSubMenuOnMouseEnter=!1),d.default.cloneElement(e,f)},renderRoot:function(e){var t;this.instanceArray=[];var n=(t={},(0,l.default)(t,e.prefixCls,1),(0,l.default)(t,e.prefixCls+"-"+e.mode,1),(0,l.default)(t,e.className,!!e.className),t),r={className:(0,C.default)(n),role:"menu","aria-activedescendant":""};return e.id&&(r.id=e.id),e.focusable&&(r.tabIndex="0",r.onKeyDown=this.onKeyDown),d.default.createElement(M.default,(0,c.default)({style:e.style,tag:"ul",hiddenClassName:e.prefixCls+"-hidden",visible:e.visible},r),d.default.Children.map(e.children,this.renderMenuItem))},step:function(e){var t=this.getFlatInstanceArray(),n=this.state.activeKey,r=t.length;if(!r)return null;e<0&&(t=t.concat().reverse());var i=-1;if(t.every(function(e,t){return!e||e.props.eventKey!==n||(i=t,!1)}),this.props.defaultActiveFirst||-1===i||!o(t.slice(i,r-1)))for(var a=(i+1)%r,s=a;;){var l=t[s];if(l&&!l.props.disabled)return l;if((s=(s+1+r)%r)===a)return null}}};t.default=A,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=r(u),f=n(768),d=r(f),p=n(771),h=r(p),m=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleDocumentScroll=n.handleDocumentScroll.bind(n),n}return a(t,e),l(t,null,[{key:"propTypes",get:function(){return{trigger:u.PropTypes.array,overlay:u.PropTypes.element,style:u.PropTypes.object,onVisibleChange:u.PropTypes.func,visible:u.PropTypes.bool,align:u.PropTypes.object,mask:u.PropTypes.bool,getPopupContainer:u.PropTypes.func}}},{key:"defaultProps",get:function(){return{prefixCls:"sm-dropdown",trigger:["click"],mask:!1}}}]),l(t,[{key:"componentDidMount",value:function(){this.mousewheelHandler=this.handleDocumentScroll(),document.addEventListener("mousewheel",this.mousewheelHandler,!1)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousewheel",this.mousewheelHandler,!1)}},{key:"handleDocumentScroll",value:function(){var e=this;return(0,h.default)(function(t){"sm-dropdown-mask"===t.target.className&&e.refs.dropdown.refs.trigger.setPopupVisible(!1)},200)}},{key:"render",value:function(){return c.default.createElement(d.default,s({ref:"dropdown",overlayClassName:this.props.className},this.props))}}]),t}(u.Component);t.default=m,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(606),f=r(c),d=n(20),p=r(d),h=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={active:!1},n.handleVisibleChange=n.handleVisibleChange.bind(n),n}return a(t,e),s(t,null,[{key:"propTypes",get:function(){return{type:l.PropTypes.string,onClick:l.PropTypes.func,trigger:l.PropTypes.string,overlay:l.PropTypes.element,visible:l.PropTypes.bool,disabled:l.PropTypes.bool,onVisibleChange:l.PropTypes.func,style:l.PropTypes.object,prefixCls:l.PropTypes.string,getPopupContainer:l.PropTypes.func}}},{key:"defaultProps",get:function(){return{prefixCls:"sm-dropdown-button",type:"default",mask:!1,disabled:!1,align:{points:["tr","br"],overlay:{adjustX:1,adjustY:1},offset:[0,5],targetOffset:[0,0]}}}}]),s(t,[{key:"handleVisibleChange",value:function(e){this.setState({active:e})}},{key:"render",value:function(){var e=(0,p.default)(this.props.prefixCls,this.props.className,{active:this.state.active});return u.default.createElement(f.default,{align:this.props.align,className:this.props.className,mask:this.props.mask,onVisibleChange:this.handleVisibleChange,overlay:this.props.overlay,trigger:this.props.trigger,getPopupContainer:this.props.getPopupContainer},u.default.createElement("div",{className:e,disabled:this.props.disabled,onClick:this.props.onClick},this.props.children))}}]),t}(l.Component);t.default=h,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),i=r(o),a=n(20),s=r(a),l={size:o.PropTypes.number,width:o.PropTypes.number,children:o.PropTypes.string,className:o.PropTypes.string},u={size:0,width:0,children:"",className:""},c=function(e,t){return e.replace(/[^\x00-\xff]/gi,"aa").length<=t?e:e.substr(0,Math.ceil(t/2))+"..."},f=function(e){var t={},n=e.children,r=(0,s.default)("sm-label",e.className,{"text-overflow":e.width>0});return e.width>0&&(t.maxWidth=e.width),e.size>0&&(n=c(n,e.size)),i.default.createElement("span",{className:r,style:t},n)};f.propTypes=l,f.defaultProps=u,t.default=f,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(5),f=n(1),d=n(323),p=r(d),h=n(54),m=n(610),g=(r(m),n(776)),_=r(g),v=n(439),y=r(v),b=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={search:"",result:[]},n.getSearchResults=n.getSearchResults.bind(n),n.getUserInfoByEmail=n.getUserInfoByEmail.bind(n),n.getRecentContacts=n.getRecentContacts.bind(n),n.getTeamMembers=n.getTeamMembers.bind(n),n.onSearchChange=n.onSearchChange.bind(n),n}return a(t,e),s(t,null,[{key:"propTypes",get:function(){return{file:l.PropTypes.object,storage:l.PropTypes.object,maxShareCount:l.PropTypes.number,getTeamMembers:l.PropTypes.func,getRecentContacts:l.PropTypes.func,setPermission:l.PropTypes.func,getSharedUsers:l.PropTypes.func,showButton:l.PropTypes.bool,onButtonClick:l.PropTypes.func,cleanModals:l.PropTypes.func,pushModal:l.PropTypes.func,popModal:l.PropTypes.func,overflow:l.PropTypes.array}}},{key:"defaultProps",get:function(){return{showButton:!1,onButtonClick:function(){},file:cow.currentFile,maxShareCount:5}}}]),s(t,[{key:"componentDidMount",value:function(){this.props.getRecentContacts(),cow.currentUser.teamId&&this.props.getTeamMembers()}},{key:"componentWillReceiveProps",value:function(e){var t=this;setTimeout(function(){t.getSearchResults()},30)}},{key:"getRecentContacts",value:function(){var e=this.props,t=e.storage,n=e.file,r=t.permissions[n.guid];return(0,f.map)(t.recentContacts,function(e){var n=t.users[e],o=r[e];return(0,f.assign)({},n,{permission:o})})}},{key:"getTeamMembers",value:function(){var e=this.props,t=e.storage,n=e.file,r=t.permissions[n.guid];return(0,f.map)(t.teamMembers,function(e){var n=t.users[e],o=r[e];return(0,f.assign)({},n,{permission:o})})}},{key:"getSharedUsers",value:function(){var e=this.props,t=e.storage,n=e.file,r=t.filePermissions[n.guid],o=t.permissions[n.guid];return(0,f.map)(r,function(e){var n=t.users[e],r=o[e];return(0,f.assign)({},n,{permission:r})})}},{key:"getSearchResults",value:function(){var e=this,t=this.state.search,n=[].concat(this.getSharedUsers(),this.getRecentContacts(),this.getTeamMembers()),r=(0,f.sortedUniqBy)((0,f.sortBy)(n,"id"),"id"),o=p.default.searchByKeyword(t,r);if(this.setState({result:o}),0===o.length&&c.regs.email.test(t)){var i={name:"",email:t,avatar:"https://assets-cdn.shimo.im/assets/images/loading-b67e5a67dc.gif"};o.push(i),this.setState({result:o},function(){e.getUserInfoByEmail(t)})}}},{key:"getUserInfoByEmail",value:function(e){var t=this;p.default.searchByEmail(e).then(function(e){var n=t.state.result;1===n.length&&n[0].email===e.email&&(n[0].id=e.id,n[0].name=e.name,n[0].avatar=e.avatar),t.setState({result:n})},function(){var e=t.state.result;1===e.length&&(e[0].name="邮箱邀请",e[0].avatar="https://assets-cdn.shimo.im/assets/images/invited-f41924e412.png",t.setState({result:e}))})}},{key:"onSearchChange",value:function(e){var t=this;this.setState({search:e.target.value},function(){t.getSearchResults()})}},{key:"renderMemberList",value:function(){var e=0,t=this.getRecentContacts(),n=[].concat(u.default.createElement(h.TabItem,{key:"1",title:"最近"},u.default.createElement(y.default,{file:this.props.file,data:t,setPermission:this.props.setPermission,onButtonClick:this.props.onButtonClick,overflow:this.props.overflow,getPopupContainer:function(){return document.querySelector(".teamwork-add-users")}})));return cow.currentUser.teamId&&(n.push(u.default.createElement(h.TabItem,{key:"2",title:"企业成员"},u.default.createElement(y.default,{hasMore:!0,file:this.props.file,data:this.getTeamMembers(),getListData:this.props.getTeamMembers,setPermission:this.props.setPermission,onButtonClick:this.props.onButtonClick,overflow:this.props.overflow,getPopupContainer:function(){return document.querySelector(".teamwork-add-users")}}))),0===t.length&&(e=1)),u.default.createElement(h.Tab,{customClass:"sm-tab",selectedIndex:e,disableSetWidth:!0},n)}},{key:"renderSearchResult",value:function(){return u.default.createElement(y.default,{file:this.props.file,data:this.state.result,getSharedUsers:this.props.getSharedUsers,setPermission:this.props.setPermission,onButtonClick:this.props.onButtonClick,overflow:this.props.overflow,getPopupContainer:function(){return document.querySelector(".teamwork-add-users")}})}},{key:"render",value:function(){var e=this.state.search.length>0;return u.default.createElement("div",{className:"teamwork-add-users"},u.default.createElement("div",{className:"flex"},u.default.createElement("div",{className:"sm-form-control search-box"},u.default.createElement("span",{className:"team-sprite team-icon-search"}),u.default.createElement("input",{type:"text",placeholder:"输入邮箱、搜索姓名，添加协作者",autoFocus:"autofocus",value:this.state.search,onChange:this.onSearchChange}))),!e&&this.renderMemberList(),e&&this.renderSearchResult(),u.default.createElement(_.default,{fileGuid:this.props.file.guid}),this.props.showButton&&u.default.createElement("div",{style:{textAlign:"right"}},u.default.createElement("button",{className:"btn btn-ok",onClick:this.props.onButtonClick},"确定")))}}]),t}(l.Component);t.default=b,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(611),i=r(o),a=n(775),s=r(a);i.default.InfiniteScroll=s.default,t.default=i.default,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=r(u),f=n(20),d=r(f),p=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleScroll=n.handleScroll.bind(n),n}return s(t,e),l(t,null,[{key:"propTypes",get:function(){return{className:u.PropTypes.string,overflow:u.PropTypes.array,spinning:u.PropTypes.bool,onScroll:u.PropTypes.func}}},{key:"defaultProps",get:function(){return{className:"",overflow:[0,0],spinning:!1,onScroll:function(){}}}}]),l(t,[{key:"componentWillReceiveProps",value:function(e){var t=this;setTimeout(function(){return t.forceUpdate()},0)}},{key:"outterStyle",value:function(){return{marginLeft:-this.props.overflow[0],marginRight:-this.props.overflow[1],height:"100%",overflowY:"auto"}}},{key:"innerStyle",value:function(){var e=this.refs.outter,t=this.refs.inner,n=e?e.offsetWidth:0,r=e?t.offsetWidth:0;return{paddingLeft:this.props.overflow[0],paddingRight:this.props.overflow[1]-(n-r)}}},{key:"handleScroll",value:function(e){this.props.onScroll(e)}},{key:"renderChildren",value:function(){return c.default.createElement("div",{className:"scroll-view-outter",style:this.outterStyle(),onScroll:this.handleScroll,ref:"outter"},c.default.createElement("div",{className:"scroll-view-inner",style:this.innerStyle(),ref:"inner"},this.props.children))}},{key:"render",value:function(){var e=this.props.className.split(/\s/),t=d.default.apply(void 0,["scroll-view"].concat(o(e),[{spinner:this.props.spinning}]));return c.default.createElement("div",{className:t},!this.props.spinning&&this.renderChildren())}}]),t}(u.Component);t.default=p,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),f=n(54),d=n(439),p=r(d),h=n(146),m=r(h),g=n(5),_=r(g),v=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleUserListClick=n.handleUserListClick.bind(n),n.renderActionComponent=n.renderActionComponent.bind(n),n}return a(t,e),s(t,null,[{key:"propTypes",get:function(){return{file:l.PropTypes.object,storage:l.PropTypes.object,maxShareCount:l.PropTypes.number,getSharedUsers:l.PropTypes.func,getFile:l.PropTypes.func,patchFile:l.PropTypes.func,setPermission:l.PropTypes.func,showButton:l.PropTypes.bool,onButtonClick:l.PropTypes.func,cleanModals:l.PropTypes.func,pushModal:l.PropTypes.func,popModal:l.PropTypes.func,overflow:l.PropTypes.array}}},{key:"defaultProps",get:function(){return{showButton:!1,onButtonClick:function(){},file:cow.currentFile}}}]),s(t,[{key:"handleUserListClick",value:function(e){var t=this,n=document.querySelector(".modal-root");n&&(n.style.display="none"),(0,m.default)({title:"移交所有者",description:"确定要将所有者角色转交给 "+e.name+"?",confirmFun:function(){n&&(n.style.display="block"),t.props.onButtonClick(),t.props.patchFile(t.props.file.guid,{userId:e.id}).then(function(){_.default.alert({title:"移交所有权成功"})})}})}},{key:"getSharedUsers",value:function(){var e=this.props,t=e.storage,n=e.file,r=t.filePermissions[n.guid],o=t.permissions[n.guid],i=[];return(0,c.map)(r,function(e){var n=t.users[e];if(n.status>=0){var r=o[e]||"editable";i.push((0,c.assign)({},n,{permission:r}))}}),i}},{key:"getGroupedUsers",value:function(e){var t=[],n=[],r=this.props.file;return(0,c.forEach)(e,function(e){e.team_id&&e.team_id===r.teamId?t.push(e):n.push(e)}),{teamMembers:t,otherMembers:n}}},{key:"renderActionComponent",value:function(e){var t=this;return this.props.file.userId===e.id?u.default.createElement("div",{className:"sm-dropdown-button no-overlay"},"所有者"):u.default.createElement("div",{className:"sm-dropdown-button no-overlay",onClick:function(){return t.handleUserListClick(e)}},"选择")}},{key:"render",value:function(){var e=this.getSharedUsers(),t="协作者 ("+e.length+")",n=this.props.file.teamId?this.getGroupedUsers(e).teamMembers:e;return u.default.createElement("div",{className:"teamwork-transfer-ownship"},u.default.createElement(f.Tab,{customClass:"sm-tab",disableSetWidth:!0},u.default.createElement(f.TabItem,{title:t},u.default.createElement(p.default,{data:n,file:this.props.file,overflow:this.props.overflow,renderActionComponent:this.renderActionComponent,getPopupContainer:function(){return document.querySelector(".teamwork-transfer-ownship")}}))),this.props.showButton&&u.default.createElement("button",{className:"btn btn-ok",onClick:this.props.onButtonClick},"返回"))}}]),t}(l.Component);t.default=v,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=r(u),f=n(252),d=n(54),p=n(440),h=r(p),m=n(609),g=r(m),_=n(614),v=r(_),y=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleTransferButtonClick=n.handleTransferButtonClick.bind(n),n.handleContentSwitch=n.handleContentSwitch.bind(n),n.renderBody=n.renderBody.bind(n),n.onClose=n.onClose.bind(n),n}return a(t,e),l(t,null,[{key:"propTypes",get:function(){return{storage:u.PropTypes.object,file:u.PropTypes.object,getRecentContacts:u.PropTypes.func,getTeamMembers:u.PropTypes.func,setPermission:u.PropTypes.func,getSharedUsers:u.PropTypes.func,popModal:u.PropTypes.func,pushModal:u.PropTypes.func}}}]),l(t,[{key:"handleTransferButtonClick",value:function(){this.props.popModal(),this.props.pushModal(v.default,{file:this.props.file})}},{key:"handleContentSwitch",value:function(e){"transfer"===e&&this.handleTransferButtonClick()}},{key:"onClose",value:function(){this.props.popModal(),this.props.pushModal(h.default,{file:this.props.file})}},{key:"renderBody",value:function(){return c.default.createElement(g.default,s({},this.props,{onButtonClick:this.handleContentSwitch}))}},{key:"render",value:function(){var e=[];return e.push({customClass:"btn btn-ok",onTap:this.onClose,label:"确定"}),c.default.createElement(d.Dialog,{open:!0,hasMask:!1,customClass:"teamworker-sharelist-inner button-right",bodyTpl:this.renderBody,actions:e,onClose:this.onClose})}}]),t}(u.Component);t.default=(0,f.register)("AddUserDialog",y),e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=r(u),f=n(54),d=n(252),p=n(612),h=r(p),m=n(440),g=r(m),_=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleButtonClick=n.handleButtonClick.bind(n),n.renderBody=n.renderBody.bind(n),n.onClose=n.onClose.bind(n),n}return a(t,e),l(t,null,[{key:"propTypes",get:function(){return{file:u.PropTypes.object,storage:u.PropTypes.object,getSharedUsers:u.PropTypes.func,setPermission:u.PropTypes.func,cleanModals:u.PropTypes.func,pushModal:u.PropTypes.func,popModal:u.PropTypes.func}}}]),l(t,[{key:"handleButtonClick",value:function(){this.props.popModal(),this.props.pushModal(g.default,{file:this.props.file})}},{key:"onClose",value:function(){this.props.cleanModals()}},{key:"renderHeader",value:function(e){return c.default.createElement("div",null,c.default.createElement("span",{className:"dialog-title"},e),c.default.createElement("span",{className:"hicon icon-close dialog-close-btn",onClick:this.onClose}))}},{key:"renderBody",value:function(){return c.default.createElement(h.default,s({},this.props,{onButtonClick:this.handleButtonClick}))}},{key:"render",value:function(){var e=[];return e.push({customClass:"btn btn-ok",onTap:this.handleButtonClick,label:"返回"}),c.default.createElement(f.Dialog,{open:!0,hasMask:!1,ref:"target",title:"转让所有权",customClass:"teamworker-sharelist-inner",headTpl:this.renderHeader,bodyTpl:this.renderBody,actions:e,onClose:this.onClose})}}]),t}(u.Component);t.default=(0,d.register)("TransferOwnshipDialog",_),e.exports=t.default},function(e,t,n){(function(r,o){function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();n(794);var f=n(0),d=i(f),p=n(13),h=i(p),m=n(607),g=i(m),_=n(604),v=i(_),y=n(795),b=i(y),w=n(442),C=i(w),S=n(146),x=i(S),T=n(72),E=i(T),M=n(5),A=i(M),k=n(323),R=i(k),I=n(9),O=i(I),D=n(33),P=i(D),N=n(730),F=n(21),L=n(646),H=i(L),V=n(22),j=function(e){function t(e){a(this,t);var n=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=["comments"];return cow.currentFile.starred&&r.push("star"),n.state={selectedKeys:r},n.commentOpened=!0,n.fileInfo={},n}return l(t,e),c(t,[{key:"componentDidMount",value:function(){var e=this;O.default.attach("doc:history:hide",function(){e._deSelect("history")},{scope:this}),O.default.attach("history:hide",function(){e._deSelect("history")},{scope:this}),O.default.attach("doc:directory:hide",function(){e._deSelect("directory")},{scope:this}),O.default.attach("doc:authors:show",function(){e._select("authors"),e._toggleAuthors(!0)},{scope:this}),O.default.attach("doc:goback",this._closeSidebar,{scope:this}),P.default.bind("StarredFile",function(t){if(t.data.fileId===cow.currentFile.id){"create"===t.action?e._select("star"):e._deSelect("star")}}),O.default.attach("history:toggle",function(){var t=-3===window.cow.currentFile.type;e._isHistoryActive(t)?(e._toggleHistory(!1,t),e._deSelect("history")):(e._toggleHistory(!0,t),e._select("history"),e._isLockSidebarActive()&&e._deSelect("locksheet"))}),O.default.attach("directory:toggle",function(){e._isDirectoryActive()?(e._toggleDirectory(!1),e._deSelect("directory")):(e._toggleDirectory(!0),e._select("directory"))}),O.default.attach("lock:sidebar:hide",function(){e._deSelect("locksheet")},{scope:this})}},{key:"componentWillUnmount",value:function(){var e=this;O.default.detach("doc:history:hide",this),O.default.detach("history:hide",this),O.default.detach("doc:directory:hide",this),O.default.detach("doc:authors:show",this),O.default.detach("history:toggle",this),O.default.detach("directory:toggle",this),O.default.detach("lock:sidebar:hide",this),setTimeout(function(){O.default.detach("doc:goback",e)},0)}},{key:"_showFileMover",value:function(e){(0,N.showFileMover)({sourceFile:e,onSuccess:function(){}})}},{key:"_select",value:function(e){-1===this.state.selectedKeys.indexOf(e)&&(this.state.selectedKeys.push(e),this.setState({selectedKeys:this.state.selectedKeys}))}},{key:"_deSelect",value:function(e){-1!==this.state.selectedKeys.indexOf(e)&&this.setState({selectedKeys:r.without(this.state.selectedKeys,e)})}},{key:"_showExportDoc",value:function(){var e=document.createElement("div"),t=function(){return document.body.removeChild(e)};h.default.render(d.default.createElement(b.default,{close:t}),e),document.body.appendChild(e)}},{key:"_showExportSpreadsheet",value:function(){A.default.isSafari()?A.default.alert({title:"暂时不支持 Safari ，请换用最新版 Chrome "}):n.e(3).then(function(e){var t=n(1021),r=n(410),o=r.getCurDoc();t.exportToFile(o,window.cow.currentFile.name+".xlsx")}.bind(null,n)).catch(n.oe)}},{key:"_showExportSheet",value:function(){var e=window.cow,t=e.currentFile,i=e.currentSheetGuid;O.default.notify("btn:getExportJSON",function(e,a){n.e(4).then(function(s){function l(e,t,n){return new Promise(function(r){var o=new Image;o.crossOrigin="Anonymous",o.onload=function(){var e=document.createElement("CANVAS"),o=e.getContext("2d");e.height=this.height,e.width=this.width,o.drawImage(this,0,0);var i=e.toDataURL();r({dataURL:i,index:t,sheetName:n})},o.onerror=function(){r({})},o.src=e,(o.complete||void 0===o.complete)&&(o.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",o.src=e)})}var c=n(1022),f=n(1023),d=new f.IO,p="sheet/"+i+"/"+t.name+".xlsx",h="sheet/"+i+"/"+encodeURIComponent(t.name)+".xlsx";e=c.exportToFile(e);var m=[];r.mapKeys(e.sheets,function(e,t){if("object"===(void 0===e?"undefined":u(e))&&!r.isEmpty(e.floatingObjects)){e.floatingObjects.forEach(function(e,n){/^picture/.test(e.name)&&m.push(l(e.src,n,t))})}}),Promise.all(m).then(function(t){var n=!1;t.forEach(function(t){r.isEmpty(t)?n=!0:e.sheets[t.sheetName].floatingObjects[t.index].src=t.dataURL}),d.save(e,function(e){A.default.alert({title:"导出操作成功，请耐心等待",type:""}),o.ajax({url:"/api/upload/oss_forms",type:"POST",data:{head:a,guid:i},success:function(t){var r=t.data,i=new FormData;i.append("OSSAccessKeyId",r.OSSAccessKeyId),i.append("policy",btoa(JSON.stringify(r.policy))),i.append("Signature",r.signature),i.append("key",p),i.append("Content-Type","multipart/form-data"),i.append("file",e),o.ajax({url:"https://shimo-exports.oss-cn-shanghai.aliyuncs.com",type:"POST",data:i,contentType:!1,processData:!1,success:function(){var e="https://shimo-exports.oss-cn-shanghai.aliyuncs.com/"+h,t={title:"导出提示",description:"检测到部分图片可能无法导出，确定导出吗",buttons:[{type:"link-button",buttonLabel:"确定",href:e,target:"_self",customClass:"btn-ok",closeAfterClick:!0},{type:"button",buttonLabel:"取消",customClass:"",closeAfterClick:!0}]};n?(0,x.default)(t):window.location=e},error:function(){A.default.hide();var e={buttonLabel:"确认",customClass:"btn-ok",closeAfterClick:!0},t={title:"出错啦",buttons:[e]};t.description="导出遇到问题，请检查网络后重试",(0,x.default)(t)}})}})},function(e){A.default.alert({title:"导出出错，请重试",type:e})})})}.bind(null,n)).catch(n.oe)})}},{key:"_print",value:function(){var e=void 0,t=function(e){(e.contentDocument||e.contentWindow.document).documentElement.innerHTML=""},n=document.getElementById("printer"),i=function(e){return setTimeout(function(){return o(".operation-btn").removeClass("active"),o(".operation-dropdown").removeClass("active"),e.contentWindow.print(),t(n)},1e3)},a=o("#editorcontainer").clone(),s=a.find("#doc-title-input");s.removeAttr("placeholder"),s.removeAttr("class"),s.attr("value",a.find("#doc-title-input").val()),a.find(".table-div").each(function(e){e=o(e);var t=e.find(".shadow-table").html();e.html(t)}),a.find("span.mention").each(function(e){try{var t=r.filter(e.parentElement.classList,function(e){if(e.startsWith("lineguid-"))return e}),n=o("."+t[0]+" span.mention").css("font-family").match(/^'(.+)-(.+)'$/)[2];e.innerHTML="@"+n}catch(t){e.innerHtml="@"}}),o("link").each(function(t,n){n.href.match(/\/main-(.+)\.css$/)&&(e=n.href)});var l=r.template(C.default)({body:a.html(),css:e});n.contentWindow.document.write(l),n.contentWindow.document.close(),i(n)}},{key:"_deleteFile",value:function(){var e=this,t=cow.currentFile,n={title:"确认操作",buttons:[]},r={buttonLabel:"确认删除",customClass:"btn-error",closeAfterClick:!0,onClick:function(){E.default.updateFile(t,{is_delete:1}).then(function(){e._goback()}).fail(function(e){R.default.isEnterpriseStandard(cow.currentUser)||R.default.isEnterpriseDingding(cow.currentUser)?A.default.alert({title:e.responseText||"删除失败",type:"error"}):A.default.alert({title:"删除失败",type:"error"})})}},o={buttonLabel:"退出共享",customClass:"btn-ok",closeAfterClick:!0,onClick:function(){E.default.quiteShare(t).then(function(){e._goback(),A.default.alert({title:"已从此"+t.name+"的共享中退出"})}).fail(function(){A.default.alert({title:"操作失败",type:"error"})})}},i={buttonLabel:"取消",customClass:"",closeAfterClick:!0},a={buttonLabel:"确认",customClass:"btn-ok",closeAfterClick:!0},s=cow.currentFile.typeName,l=t.permissions.manageable,u=t.permissions.quitable;l&&u?(n.buttons=[r,o,i],n.description="你可以删除"+s+"<br />也可以退出共享，但不删除"+s):l?(n.buttons=[r,i],n.description="确认删除"+s+"吗？<br />删除后，所有协作者都无法访问此"+s):u?(n.buttons=[o,i],n.description="你不是"+s+"的创建者<br />继续此操作会退出"+s+"共享<br />但不会删除"+s):(n.title="没有权限",n.buttons=[a],n.description="你没有权限删除或退出此"+s),(0,x.default)(n)}},{key:"_isHistoryActive",value:function(e){return e?o("#sheet-view .s-sidebar").hasClass("show"):!o("#doc-history").hasClass("hide")}},{key:"_isLockSidebarActive",value:function(){return o("#sheet-view .lock-sidebar").hasClass("show")}},{key:"_isDirectoryActive",value:function(){return!o("#doc-directory").hasClass("hide")}},{key:"_toggleComments",value:function(e){var t=this;e?(o("#pad-view").addClass("comment-show").removeClass("history-show"),this._toggleHistory(!1),this._toggleDirectory(!1)):(o("#pad-view").removeClass("comment-show"),setTimeout(function(){return t._deSelect("comments")},0))}},{key:"_toggleHistory",value:function(e,t){if(t)return O.default.notify("spreadsheet:history:"+(e?"show":"hide"));e?(this._toggleDirectory(!1),this._toggleComments(!1),o("#pad-view").addClass("history-show"),o("#doc-history").removeClass("hide"),O.default.notify("doc:history:show")):(o("#pad-view").removeClass("history-show"),o("#doc-history").addClass("hide"),setTimeout(function(){return O.default.notify("doc:history:hide")},0),this.commentOpened&&(this._select("comments"),o("#pad-view").addClass("comment-show").removeClass("history-show")))}},{key:"_toggleDirectory",value:function(e){e?(this._toggleHistory(!1),this._toggleComments(!1),o("#innerdocbody").focus(),window.cow.directory.firstOpen=!0,o("#pad-view").addClass("history-show directory-show"),o("#doc-directory").removeClass("hide"),window.cow.directory.isOpened=!0):(o("#pad-view").removeClass("directory-show"),o("#doc-directory").addClass("hide"),window.cow.directory.isOpened=!1,setTimeout(function(){return O.default.notify("doc:directory:hide")},0),this.commentOpened&&(this._select("comments"),o("#pad-view").addClass("comment-show").removeClass("history-show")))}},{key:"_toggleAuthors",value:function(e){e?o("#pad-view").addClass("edit-mode"):o("#pad-view").removeClass("edit-mode")}},{key:"openInfoDialog",value:function(){var e=this;window.cow.currentFile.guid!==this.fileInfo.guid?(0,V.ajaxGet)("/smapi/files/"+window.cow.currentFile.guid+"?creator=1").then(function(t){var n=t.data;e.fileInfo=n||{},e.showInfoModal()}):this.showInfoModal()}},{key:"showInfoModal",value:function(){var e=this.fileInfo,t=e.createdAt,n=e.views,r=e.creator,o=window.cow.currentFile.typeName,i=r.name,a=r.email,s=i+" ("+a+")",l="";if("文档"===o){var u=document.getElementById("innerdocbody").innerText;l="<div>"+o+"总字数： "+this.filterTextCount(u)+" (不计标点)</div>"}var c={title:o+"信息",description:'\n        <div class="operations-info-dialog-creator">'+o+'创建者：\n          <span title="'+s+'">'+s+"</span>\n        </div>\n        <div>"+o+"创建时间： "+(0,H.default)(t).format("YYYY.MM.DD HH:mm")+" (GMT+08:00)</div>"+l+"<div>阅读次数： "+n+"次</div>\n      ",buttons:[{type:"button",buttonLabel:"确定",customClass:"btn-ok",closeAfterClick:!0}]};(0,x.default)(c)}},{key:"filterTextCount",value:function(e){var t=0,n=/^[A-Za-z0-9]+$/gi,o=/[A-Za-z0-9]+/gi,i=/↵|\s/,a=/[^a-zA-Z0-9\s\u4e00-\u9fa5]/g;return e=e.replace(/\b[a-zA-Z]+'[a-zA-Z]+\b/g,"0").replace(/\b\d+\.\d+\b/g,"0").replace(a," "),r.compact(e.split(i)).forEach(function(e){var r=e.trim(),i=r.match(n);if(Array.isArray(i))t+=i.length;else{var a=r.match(o);if(Array.isArray(a)){var s=r.split(o).join("");t+=s.length,t+=a.length}else t+=r.length}}),t}},{key:"_closeSidebar",value:function(){this._toggleDirectory(!1),this._toggleHistory(!1)}},{key:"_toggleStar",value:function(){cow.currentFile.starred?(0,T.unstarFile)(cow.currentFile.id):(0,T.starFile)(cow.currentFile.id)}},{key:"_handleMenu",value:function(e){var t=e.key,n=e.selectedKeys,r=this.props.file;if("locksheet"!==t||(0,F.isEnterprise)(cow.currentUser)){if("history"===t||"locksheet"===t){var o="";o="history"===t?"locksheet":"history";var i=n.indexOf(o);i>=0&&n.splice(i,1)}this.setState({selectedKeys:n});var a=-1!==n.indexOf(t);if("star"===t)return void this._toggleStar();if("delete"===t)return void this._deleteFile();if("move"===t)return void this._showFileMover(r);if(0===cow.currentFile.type)switch(t){case"export":this._showExportDoc();break;case"print":this._print();break;case"history":this._toggleHistory(a);break;case"directory":this._toggleDirectory(a);break;case"comments":this.commentOpened=a,this._toggleComments(a);break;case"authors":this._toggleAuthors(a);break;case"info":this.openInfoDialog()}else if(-1===cow.currentFile.type||-3===cow.currentFile.type){var s=-3===cow.currentFile.type;switch(t){case"history":O.default.notify("spreadsheet:history:show");break;case"locksheet":O.default.notify("spreadsheet:lock:toggle");break;case"export":s?this._showExportSheet():this._showExportSpreadsheet();break;case"info":this.openInfoDialog()}}}}},{key:"_enterMenuItem",value:function(){(0,F.isEnterprise)(cow.currentUser)||o(".operations-tip").css("display","block")}},{key:"_leaveMenuItem",value:function(){o(".operations-tip").css("display","none")}},{key:"render",value:function(){var e=d.default.createElement("div",null);0===cow.currentFile.type?e=d.default.createElement(v.default,{multiple:!0,className:"operations",selectedKeys:this.state.selectedKeys,onSelect:this._handleMenu.bind(this),onDeselect:this._handleMenu.bind(this)},cow.currentUser.id>0&&d.default.createElement(_.Item,{key:"star"},"给文档标星"),cow.currentUser.id>0&&d.default.createElement(_.Divider,null),d.default.createElement(_.Item,{key:"directory"},"查看目录"),d.default.createElement(_.Item,{key:"history"},"查看历史"),d.default.createElement(_.Item,{key:"comments"},"查看评论"),d.default.createElement(_.Item,{key:"authors"},"查看编写者"),cow.authorized&&d.default.createElement(_.Item,{key:"info",className:"operations-noselect"},"文档信息"),d.default.createElement(_.Divider,null),cow.authorized&&d.default.createElement(_.Item,{key:"move",className:"operations-noselect"},"移动"),d.default.createElement(_.Item,{key:"export",className:"operations-noselect"},"导出"),d.default.createElement(_.Item,{key:"print",className:"operations-noselect"},"打印"),cow.currentFile.permissions.manageable&&d.default.createElement(_.Divider,null),cow.currentFile.permissions.manageable&&d.default.createElement(_.Item,{key:"delete",className:"operations-noselect operations-red"},"删除文档")):-1===cow.currentFile.type||-3===cow.currentFile.type?e=d.default.createElement(v.default,{multiple:!0,className:"operations",selectedKeys:this.state.selectedKeys,onSelect:this._handleMenu.bind(this),onDeselect:this._handleMenu.bind(this)},cow.currentUser.id>0&&d.default.createElement(_.Item,{key:"star"},"给表格标星"),d.default.createElement(_.Item,{key:"history"},"查看历史"),d.default.createElement(_.Item,{key:"locksheet",className:(0,F.isEnterprise)(cow.currentUser)?"":"locksheet_disabled",onMouseEnter:this._enterMenuItem.bind(this),onMouseLeave:this._leaveMenuItem.bind(this)},"查看锁定工作表"),cow.authorized&&d.default.createElement(_.Item,{key:"info",className:"operations-noselect"},"表格信息"),cow.authorized&&d.default.createElement(_.Item,{key:"move",className:"operations-noselect"},"移动"),d.default.createElement(_.Item,{key:"export",className:"operations-noselect"},"导出"),cow.currentFile.permissions.manageable&&d.default.createElement(_.Divider,null),cow.currentFile.permissions.manageable&&d.default.createElement(_.Item,{key:"delete",className:"operations-noselect operations-red"},"删除表格"),d.default.createElement("div",{className:"s-tooltip operations-tip",style:{top:cow.currentUser.id>0?"80px":"45px"}},"企业版功能")):-2===cow.currentFile.type&&(e=d.default.createElement(v.default,{multiple:!0,className:"operations",selectedKeys:this.state.selectedKeys,onSelect:this._handleMenu.bind(this),onDeselect:this._handleMenu.bind(this)},d.default.createElement(_.Item,{key:"star"},"给文档标星"),d.default.createElement(_.Divider,null),d.default.createElement(_.Item,{key:"delete",className:"operations-noselect operations-red"},"删除文档")));var t={points:["tr","br"],overlay:{adjustX:1,adjustY:1},offset:[10,10],targetOffset:[0,0]};return d.default.createElement(g.default,{className:"operations",type:"primary",overlay:e,align:t})}}]),t}(f.Component);t.default=j,j.propTypes={file:f.PropTypes.object},e.exports=t.default}).call(t,n(1),n(2))},function(e,t,n){e.exports=n(742)},function(e,t,n){function r(e,t,n,r){var a=!n;n||(n={});for(var s=-1,l=t.length;++s<l;){var u=t[s],c=r?r(n[u],e[u],u,n,e):void 0;void 0===c&&(c=e[u]),a?i(n,u,c):o(n,u,c)}return n}var o=n(419),i=n(409);e.exports=r},function(e,t,n){function r(e){return o(function(t,n){var r=-1,o=n.length,a=o>1?n[o-1]:void 0,s=o>2?n[2]:void 0;for(a=e.length>3&&"function"==typeof a?(o--,a):void 0,s&&i(n[0],n[1],s)&&(a=o<3?void 0:a,o=1),t=Object(t);++r<o;){var l=n[r];l&&e(t,l,r,a)}return t})}var o=n(619),i=n(626);e.exports=r},function(e,t,n){function r(e,t){return a(i(e,t,o),e+"")}var o=n(338),i=n(620),a=n(622);e.exports=r},function(e,t,n){function r(e,t,n){return t=i(void 0===t?e.length-1:t,0),function(){for(var r=arguments,a=-1,s=i(r.length-t,0),l=Array(s);++a<s;)l[a]=r[t+a];a=-1;for(var u=Array(t+1);++a<t;)u[a]=r[a];return u[t]=n(l),o(e,this,u)}}var o=n(621),i=Math.max;e.exports=r},function(e,t){function n(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}e.exports=n},function(e,t,n){var r=n(623),o=n(625),i=o(r);e.exports=i},function(e,t,n){var r=n(624),o=n(420),i=n(338),a=o?function(e,t){return o(e,"toString",{configurable:!0,enumerable:!1,value:r(t),writable:!0})}:i;e.exports=a},function(e,t){function n(e){return function(){return e}}e.exports=n},function(e,t){function n(e){var t=0,n=0;return function(){var a=i(),s=o-(a-n);if(n=a,s>0){if(++t>=r)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var r=800,o=16,i=Date.now;e.exports=n},function(e,t,n){function r(e,t,n){if(!s(n))return!1;var r=typeof t;return!!("number"==r?i(n)&&a(t,n.length):"string"==r&&t in n)&&o(n[t],e)}var o=n(325),i=n(265),a=n(329),s=n(175);e.exports=r},,,,,,,,,,,,,,,,,,function(e,t,n){function r(e){if("string"==typeof e||o(e))return e;var t=e+"";return"0"==t&&1/e==-i?"-0":t}var o=n(436),i=1/0;e.exports=r},,function(e,t,n){(function(e){!function(t,n){e.exports=n()}(0,function(){"use strict";function t(){return br.apply(null,arguments)}function n(e){br=e}function r(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function o(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)}function i(e){var t;for(t in e)return!1;return!0}function a(e){return void 0===e}function s(e){return"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e)}function l(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function u(e,t){var n,r=[];for(n=0;n<e.length;++n)r.push(t(e[n],n));return r}function c(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function f(e,t){for(var n in t)c(t,n)&&(e[n]=t[n]);return c(t,"toString")&&(e.toString=t.toString),c(t,"valueOf")&&(e.valueOf=t.valueOf),e}function d(e,t,n,r){return yt(e,t,n,r,!0).utc()}function p(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function h(e){return null==e._pf&&(e._pf=p()),e._pf}function m(e){if(null==e._isValid){var t=h(e),n=Cr.call(t.parsedDateParts,function(e){return null!=e}),r=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidMonth&&!t.invalidWeekday&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&n);if(e._strict&&(r=r&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour),null!=Object.isFrozen&&Object.isFrozen(e))return r;e._isValid=r}return e._isValid}function g(e){var t=d(NaN);return null!=e?f(h(t),e):h(t).userInvalidated=!0,t}function _(e,t){var n,r,o;if(a(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),a(t._i)||(e._i=t._i),a(t._f)||(e._f=t._f),a(t._l)||(e._l=t._l),a(t._strict)||(e._strict=t._strict),a(t._tzm)||(e._tzm=t._tzm),a(t._isUTC)||(e._isUTC=t._isUTC),a(t._offset)||(e._offset=t._offset),a(t._pf)||(e._pf=h(t)),a(t._locale)||(e._locale=t._locale),Sr.length>0)for(n=0;n<Sr.length;n++)r=Sr[n],o=t[r],a(o)||(e[r]=o);return e}function v(e){_(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===xr&&(xr=!0,t.updateOffset(this),xr=!1)}function y(e){return e instanceof v||null!=e&&null!=e._isAMomentObject}function b(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function w(e){var t=+e,n=0;return 0!==t&&isFinite(t)&&(n=b(t)),n}function C(e,t,n){var r,o=Math.min(e.length,t.length),i=Math.abs(e.length-t.length),a=0;for(r=0;r<o;r++)(n&&e[r]!==t[r]||!n&&w(e[r])!==w(t[r]))&&a++;return a+i}function S(e){!1===t.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function x(e,n){var r=!0;return f(function(){if(null!=t.deprecationHandler&&t.deprecationHandler(null,e),r){for(var o,i=[],a=0;a<arguments.length;a++){if(o="","object"==typeof arguments[a]){o+="\n["+a+"] ";for(var s in arguments[0])o+=s+": "+arguments[0][s]+", ";o=o.slice(0,-2)}else o=arguments[a];i.push(o)}S(e+"\nArguments: "+Array.prototype.slice.call(i).join("")+"\n"+(new Error).stack),r=!1}return n.apply(this,arguments)},n)}function T(e,n){null!=t.deprecationHandler&&t.deprecationHandler(e,n),Tr[e]||(S(n),Tr[e]=!0)}function E(e){return e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function M(e){var t,n;for(n in e)t=e[n],E(t)?this[n]=t:this["_"+n]=t;this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function A(e,t){var n,r=f({},e);for(n in t)c(t,n)&&(o(e[n])&&o(t[n])?(r[n]={},f(r[n],e[n]),f(r[n],t[n])):null!=t[n]?r[n]=t[n]:delete r[n]);for(n in e)c(e,n)&&!c(t,n)&&o(e[n])&&(r[n]=f({},r[n]));return r}function k(e){null!=e&&this.set(e)}function R(e,t,n){var r=this._calendar[e]||this._calendar.sameElse;return E(r)?r.call(t,n):r}function I(e){var t=this._longDateFormat[e],n=this._longDateFormat[e.toUpperCase()];return t||!n?t:(this._longDateFormat[e]=n.replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e])}function O(){return this._invalidDate}function D(e){return this._ordinal.replace("%d",e)}function P(e,t,n,r){var o=this._relativeTime[n];return E(o)?o(e,t,n,r):o.replace(/%d/i,e)}function N(e,t){var n=this._relativeTime[e>0?"future":"past"];return E(n)?n(t):n.replace(/%s/i,t)}function F(e,t){var n=e.toLowerCase();Nr[n]=Nr[n+"s"]=Nr[t]=e}function L(e){return"string"==typeof e?Nr[e]||Nr[e.toLowerCase()]:void 0}function H(e){var t,n,r={};for(n in e)c(e,n)&&(t=L(n))&&(r[t]=e[n]);return r}function V(e,t){Fr[e]=t}function j(e){var t=[];for(var n in e)t.push({unit:n,priority:Fr[n]});return t.sort(function(e,t){return e.priority-t.priority}),t}function B(e,n){return function(r){return null!=r?(W(this,e,r),t.updateOffset(this,n),this):U(this,e)}}function U(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function W(e,t,n){e.isValid()&&e._d["set"+(e._isUTC?"UTC":"")+t](n)}function z(e){return e=L(e),E(this[e])?this[e]():this}function Y(e,t){if("object"==typeof e){e=H(e);for(var n=j(e),r=0;r<n.length;r++)this[n[r].unit](e[n[r].unit])}else if(e=L(e),E(this[e]))return this[e](t);return this}function G(e,t,n){var r=""+Math.abs(e),o=t-r.length;return(e>=0?n?"+":"":"-")+Math.pow(10,Math.max(0,o)).toString().substr(1)+r}function K(e,t,n,r){var o=r;"string"==typeof r&&(o=function(){return this[r]()}),e&&(jr[e]=o),t&&(jr[t[0]]=function(){return G(o.apply(this,arguments),t[1],t[2])}),n&&(jr[n]=function(){return this.localeData().ordinal(o.apply(this,arguments),e)})}function X(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function q(e){var t,n,r=e.match(Lr);for(t=0,n=r.length;t<n;t++)jr[r[t]]?r[t]=jr[r[t]]:r[t]=X(r[t]);return function(t){var o,i="";for(o=0;o<n;o++)i+=E(r[o])?r[o].call(t,e):r[o];return i}}function J(e,t){return e.isValid()?(t=Z(t,e.localeData()),Vr[t]=Vr[t]||q(t),Vr[t](e)):e.localeData().invalidDate()}function Z(e,t){function n(e){return t.longDateFormat(e)||e}var r=5;for(Hr.lastIndex=0;r>=0&&Hr.test(e);)e=e.replace(Hr,n),Hr.lastIndex=0,r-=1;return e}function Q(e,t,n){oo[e]=E(t)?t:function(e,r){return e&&n?n:t}}function $(e,t){return c(oo,e)?oo[e](t._strict,t._locale):new RegExp(ee(e))}function ee(e){return te(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,n,r,o){return t||n||r||o}))}function te(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function ne(e,t){var n,r=t;for("string"==typeof e&&(e=[e]),s(t)&&(r=function(e,n){n[t]=w(e)}),n=0;n<e.length;n++)io[e[n]]=r}function re(e,t){ne(e,function(e,n,r,o){r._w=r._w||{},t(e,r._w,r,o)})}function oe(e,t,n){null!=t&&c(io,e)&&io[e](t,n._a,n,e)}function ie(e,t){return new Date(Date.UTC(e,t+1,0)).getUTCDate()}function ae(e,t){return e?r(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||_o).test(t)?"format":"standalone"][e.month()]:r(this._months)?this._months:this._months.standalone}function se(e,t){return e?r(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[_o.test(t)?"format":"standalone"][e.month()]:r(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function le(e,t,n){var r,o,i,a=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)i=d([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(i,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(i,"").toLocaleLowerCase();return n?"MMM"===t?(o=go.call(this._shortMonthsParse,a),-1!==o?o:null):(o=go.call(this._longMonthsParse,a),-1!==o?o:null):"MMM"===t?-1!==(o=go.call(this._shortMonthsParse,a))?o:(o=go.call(this._longMonthsParse,a),-1!==o?o:null):-1!==(o=go.call(this._longMonthsParse,a))?o:(o=go.call(this._shortMonthsParse,a),-1!==o?o:null)}function ue(e,t,n){var r,o,i;if(this._monthsParseExact)return le.call(this,e,t,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(o=d([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(o,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(o,"").replace(".","")+"$","i")),n||this._monthsParse[r]||(i="^"+this.months(o,"")+"|^"+this.monthsShort(o,""),this._monthsParse[r]=new RegExp(i.replace(".",""),"i")),n&&"MMMM"===t&&this._longMonthsParse[r].test(e))return r;if(n&&"MMM"===t&&this._shortMonthsParse[r].test(e))return r;if(!n&&this._monthsParse[r].test(e))return r}}function ce(e,t){var n;if(!e.isValid())return e;if("string"==typeof t)if(/^\d+$/.test(t))t=w(t);else if(t=e.localeData().monthsParse(t),!s(t))return e;return n=Math.min(e.date(),ie(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n),e}function fe(e){return null!=e?(ce(this,e),t.updateOffset(this,!0),this):U(this,"Month")}function de(){return ie(this.year(),this.month())}function pe(e){return this._monthsParseExact?(c(this,"_monthsRegex")||me.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(c(this,"_monthsShortRegex")||(this._monthsShortRegex=bo),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function he(e){return this._monthsParseExact?(c(this,"_monthsRegex")||me.call(this),e?this._monthsStrictRegex:this._monthsRegex):(c(this,"_monthsRegex")||(this._monthsRegex=wo),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function me(){function e(e,t){return t.length-e.length}var t,n,r=[],o=[],i=[];for(t=0;t<12;t++)n=d([2e3,t]),r.push(this.monthsShort(n,"")),o.push(this.months(n,"")),i.push(this.months(n,"")),i.push(this.monthsShort(n,""));for(r.sort(e),o.sort(e),i.sort(e),t=0;t<12;t++)r[t]=te(r[t]),o[t]=te(o[t]);for(t=0;t<24;t++)i[t]=te(i[t]);this._monthsRegex=new RegExp("^("+i.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+o.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+r.join("|")+")","i")}function ge(e){return _e(e)?366:365}function _e(e){return e%4==0&&e%100!=0||e%400==0}function ve(){return _e(this.year())}function ye(e,t,n,r,o,i,a){var s=new Date(e,t,n,r,o,i,a);return e<100&&e>=0&&isFinite(s.getFullYear())&&s.setFullYear(e),s}function be(e){var t=new Date(Date.UTC.apply(null,arguments));return e<100&&e>=0&&isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e),t}function we(e,t,n){var r=7+t-n;return-(7+be(e,0,r).getUTCDay()-t)%7+r-1}function Ce(e,t,n,r,o){var i,a,s=(7+n-r)%7,l=we(e,r,o),u=1+7*(t-1)+s+l;return u<=0?(i=e-1,a=ge(i)+u):u>ge(e)?(i=e+1,a=u-ge(e)):(i=e,a=u),{year:i,dayOfYear:a}}function Se(e,t,n){var r,o,i=we(e.year(),t,n),a=Math.floor((e.dayOfYear()-i-1)/7)+1;return a<1?(o=e.year()-1,r=a+xe(o,t,n)):a>xe(e.year(),t,n)?(r=a-xe(e.year(),t,n),o=e.year()+1):(o=e.year(),r=a),{week:r,year:o}}function xe(e,t,n){var r=we(e,t,n),o=we(e+1,t,n);return(ge(e)-r+o)/7}function Te(e){return Se(e,this._week.dow,this._week.doy).week}function Ee(){return this._week.dow}function Me(){return this._week.doy}function Ae(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")}function ke(e){var t=Se(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")}function Re(e,t){return"string"!=typeof e?e:isNaN(e)?(e=t.weekdaysParse(e),"number"==typeof e?e:null):parseInt(e,10)}function Ie(e,t){return"string"==typeof e?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function Oe(e,t){return e?r(this._weekdays)?this._weekdays[e.day()]:this._weekdays[this._weekdays.isFormat.test(t)?"format":"standalone"][e.day()]:r(this._weekdays)?this._weekdays:this._weekdays.standalone}function De(e){return e?this._weekdaysShort[e.day()]:this._weekdaysShort}function Pe(e){return e?this._weekdaysMin[e.day()]:this._weekdaysMin}function Ne(e,t,n){var r,o,i,a=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)i=d([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(i,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(i,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(i,"").toLocaleLowerCase();return n?"dddd"===t?(o=go.call(this._weekdaysParse,a),-1!==o?o:null):"ddd"===t?(o=go.call(this._shortWeekdaysParse,a),-1!==o?o:null):(o=go.call(this._minWeekdaysParse,a),-1!==o?o:null):"dddd"===t?-1!==(o=go.call(this._weekdaysParse,a))?o:-1!==(o=go.call(this._shortWeekdaysParse,a))?o:(o=go.call(this._minWeekdaysParse,a),-1!==o?o:null):"ddd"===t?-1!==(o=go.call(this._shortWeekdaysParse,a))?o:-1!==(o=go.call(this._weekdaysParse,a))?o:(o=go.call(this._minWeekdaysParse,a),-1!==o?o:null):-1!==(o=go.call(this._minWeekdaysParse,a))?o:-1!==(o=go.call(this._weekdaysParse,a))?o:(o=go.call(this._shortWeekdaysParse,a),-1!==o?o:null)}function Fe(e,t,n){var r,o,i;if(this._weekdaysParseExact)return Ne.call(this,e,t,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(o=d([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(o,"").replace(".",".?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(o,"").replace(".",".?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(o,"").replace(".",".?")+"$","i")),this._weekdaysParse[r]||(i="^"+this.weekdays(o,"")+"|^"+this.weekdaysShort(o,"")+"|^"+this.weekdaysMin(o,""),this._weekdaysParse[r]=new RegExp(i.replace(".",""),"i")),n&&"dddd"===t&&this._fullWeekdaysParse[r].test(e))return r;if(n&&"ddd"===t&&this._shortWeekdaysParse[r].test(e))return r;if(n&&"dd"===t&&this._minWeekdaysParse[r].test(e))return r;if(!n&&this._weekdaysParse[r].test(e))return r}}function Le(e){if(!this.isValid())return null!=e?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=Re(e,this.localeData()),this.add(e-t,"d")):t}function He(e){if(!this.isValid())return null!=e?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")}function Ve(e){if(!this.isValid())return null!=e?this:NaN;if(null!=e){var t=Ie(e,this.localeData());return this.day(this.day()%7?t:t-7)}return this.day()||7}function je(e){return this._weekdaysParseExact?(c(this,"_weekdaysRegex")||We.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(c(this,"_weekdaysRegex")||(this._weekdaysRegex=Mo),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function Be(e){return this._weekdaysParseExact?(c(this,"_weekdaysRegex")||We.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(c(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Ao),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function Ue(e){return this._weekdaysParseExact?(c(this,"_weekdaysRegex")||We.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(c(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=ko),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function We(){function e(e,t){return t.length-e.length}var t,n,r,o,i,a=[],s=[],l=[],u=[];for(t=0;t<7;t++)n=d([2e3,1]).day(t),r=this.weekdaysMin(n,""),o=this.weekdaysShort(n,""),i=this.weekdays(n,""),a.push(r),s.push(o),l.push(i),u.push(r),u.push(o),u.push(i);for(a.sort(e),s.sort(e),l.sort(e),u.sort(e),t=0;t<7;t++)s[t]=te(s[t]),l[t]=te(l[t]),u[t]=te(u[t]);this._weekdaysRegex=new RegExp("^("+u.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+s.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+a.join("|")+")","i")}function ze(){return this.hours()%12||12}function Ye(){return this.hours()||24}function Ge(e,t){K(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}function Ke(e,t){return t._meridiemParse}function Xe(e){return"p"===(e+"").toLowerCase().charAt(0)}function qe(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"}function Je(e){return e?e.toLowerCase().replace("_","-"):e}function Ze(e){for(var t,n,r,o,i=0;i<e.length;){for(o=Je(e[i]).split("-"),t=o.length,n=Je(e[i+1]),n=n?n.split("-"):null;t>0;){if(r=Qe(o.slice(0,t).join("-")))return r;if(n&&n.length>=t&&C(o,n,!0)>=t-1)break;t--}i++}return null}function Qe(t){var n=null;if(!Po[t]&&void 0!==e&&e&&e.exports)try{n=Ro._abbr,function(){var e=new Error('Cannot find module "./locale"');throw e.code="MODULE_NOT_FOUND",e}(),$e(n)}catch(e){}return Po[t]}function $e(e,t){var n;return e&&(n=a(t)?nt(e):et(e,t))&&(Ro=n),Ro._abbr}function et(e,t){if(null!==t){var n=Do;if(t.abbr=e,null!=Po[e])T("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=Po[e]._config;else if(null!=t.parentLocale){if(null==Po[t.parentLocale])return No[t.parentLocale]||(No[t.parentLocale]=[]),No[t.parentLocale].push({name:e,config:t}),null;n=Po[t.parentLocale]._config}return Po[e]=new k(A(n,t)),No[e]&&No[e].forEach(function(e){et(e.name,e.config)}),$e(e),Po[e]}return delete Po[e],null}function tt(e,t){if(null!=t){var n,r=Do;null!=Po[e]&&(r=Po[e]._config),t=A(r,t),n=new k(t),n.parentLocale=Po[e],Po[e]=n,$e(e)}else null!=Po[e]&&(null!=Po[e].parentLocale?Po[e]=Po[e].parentLocale:null!=Po[e]&&delete Po[e]);return Po[e]}function nt(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return Ro;if(!r(e)){if(t=Qe(e))return t;e=[e]}return Ze(e)}function rt(){return Ar(Po)}function ot(e){var t,n=e._a;return n&&-2===h(e).overflow&&(t=n[so]<0||n[so]>11?so:n[lo]<1||n[lo]>ie(n[ao],n[so])?lo:n[uo]<0||n[uo]>24||24===n[uo]&&(0!==n[co]||0!==n[fo]||0!==n[po])?uo:n[co]<0||n[co]>59?co:n[fo]<0||n[fo]>59?fo:n[po]<0||n[po]>999?po:-1,h(e)._overflowDayOfYear&&(t<ao||t>lo)&&(t=lo),h(e)._overflowWeeks&&-1===t&&(t=ho),h(e)._overflowWeekday&&-1===t&&(t=mo),h(e).overflow=t),e}function it(e){var t,n,r,o,i,a,s=e._i,l=Fo.exec(s)||Lo.exec(s);if(l){for(h(e).iso=!0,t=0,n=Vo.length;t<n;t++)if(Vo[t][1].exec(l[1])){o=Vo[t][0],r=!1!==Vo[t][2];break}if(null==o)return void(e._isValid=!1);if(l[3]){for(t=0,n=jo.length;t<n;t++)if(jo[t][1].exec(l[3])){i=(l[2]||" ")+jo[t][0];break}if(null==i)return void(e._isValid=!1)}if(!r&&null!=i)return void(e._isValid=!1);if(l[4]){if(!Ho.exec(l[4]))return void(e._isValid=!1);a="Z"}e._f=o+(i||"")+(a||""),dt(e)}else e._isValid=!1}function at(e){var t,n,r,o,i,a,s,l,u={" GMT":" +0000"," EDT":" -0400"," EST":" -0500"," CDT":" -0500"," CST":" -0600"," MDT":" -0600"," MST":" -0700"," PDT":" -0700"," PST":" -0800"},c="YXWVUTSRQPONZABCDEFGHIKLM";if(t=e._i.replace(/\([^\)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s|\s$/g,""),n=Uo.exec(t)){if(r=n[1]?"ddd"+(5===n[1].length?", ":" "):"",o="D MMM "+(n[2].length>10?"YYYY ":"YY "),i="HH:mm"+(n[4]?":ss":""),n[1]){var f=new Date(n[2]),d=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][f.getDay()];if(n[1].substr(0,3)!==d)return h(e).weekdayMismatch=!0,void(e._isValid=!1)}switch(n[5].length){case 2:0===l?s=" +0000":(l=c.indexOf(n[5][1].toUpperCase())-12,s=(l<0?" -":" +")+(""+l).replace(/^-?/,"0").match(/..$/)[0]+"00");break;case 4:s=u[n[5]];break;default:s=u[" GMT"]}n[5]=s,e._i=n.splice(1).join(""),a=" ZZ",e._f=r+o+i+a,dt(e),h(e).rfc2822=!0}else e._isValid=!1}function st(e){var n=Bo.exec(e._i);if(null!==n)return void(e._d=new Date(+n[1]));it(e),!1===e._isValid&&(delete e._isValid,at(e),!1===e._isValid&&(delete e._isValid,t.createFromInputFallback(e)))}function lt(e,t,n){return null!=e?e:null!=t?t:n}function ut(e){var n=new Date(t.now());return e._useUTC?[n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate()]:[n.getFullYear(),n.getMonth(),n.getDate()]}function ct(e){var t,n,r,o,i=[];if(!e._d){for(r=ut(e),e._w&&null==e._a[lo]&&null==e._a[so]&&ft(e),null!=e._dayOfYear&&(o=lt(e._a[ao],r[ao]),(e._dayOfYear>ge(o)||0===e._dayOfYear)&&(h(e)._overflowDayOfYear=!0),n=be(o,0,e._dayOfYear),e._a[so]=n.getUTCMonth(),e._a[lo]=n.getUTCDate()),t=0;t<3&&null==e._a[t];++t)e._a[t]=i[t]=r[t];for(;t<7;t++)e._a[t]=i[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[uo]&&0===e._a[co]&&0===e._a[fo]&&0===e._a[po]&&(e._nextDay=!0,e._a[uo]=0),e._d=(e._useUTC?be:ye).apply(null,i),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[uo]=24)}}function ft(e){var t,n,r,o,i,a,s,l;if(t=e._w,null!=t.GG||null!=t.W||null!=t.E)i=1,a=4,n=lt(t.GG,e._a[ao],Se(bt(),1,4).year),r=lt(t.W,1),((o=lt(t.E,1))<1||o>7)&&(l=!0);else{i=e._locale._week.dow,a=e._locale._week.doy;var u=Se(bt(),i,a);n=lt(t.gg,e._a[ao],u.year),r=lt(t.w,u.week),null!=t.d?((o=t.d)<0||o>6)&&(l=!0):null!=t.e?(o=t.e+i,(t.e<0||t.e>6)&&(l=!0)):o=i}r<1||r>xe(n,i,a)?h(e)._overflowWeeks=!0:null!=l?h(e)._overflowWeekday=!0:(s=Ce(n,r,o,i,a),e._a[ao]=s.year,e._dayOfYear=s.dayOfYear)}function dt(e){if(e._f===t.ISO_8601)return void it(e);if(e._f===t.RFC_2822)return void at(e);e._a=[],h(e).empty=!0;var n,r,o,i,a,s=""+e._i,l=s.length,u=0;for(o=Z(e._f,e._locale).match(Lr)||[],n=0;n<o.length;n++)i=o[n],r=(s.match($(i,e))||[])[0],r&&(a=s.substr(0,s.indexOf(r)),a.length>0&&h(e).unusedInput.push(a),s=s.slice(s.indexOf(r)+r.length),u+=r.length),jr[i]?(r?h(e).empty=!1:h(e).unusedTokens.push(i),oe(i,r,e)):e._strict&&!r&&h(e).unusedTokens.push(i);h(e).charsLeftOver=l-u,s.length>0&&h(e).unusedInput.push(s),e._a[uo]<=12&&!0===h(e).bigHour&&e._a[uo]>0&&(h(e).bigHour=void 0),h(e).parsedDateParts=e._a.slice(0),h(e).meridiem=e._meridiem,e._a[uo]=pt(e._locale,e._a[uo],e._meridiem),ct(e),ot(e)}function pt(e,t,n){var r;return null==n?t:null!=e.meridiemHour?e.meridiemHour(t,n):null!=e.isPM?(r=e.isPM(n),r&&t<12&&(t+=12),r||12!==t||(t=0),t):t}function ht(e){var t,n,r,o,i;if(0===e._f.length)return h(e).invalidFormat=!0,void(e._d=new Date(NaN));for(o=0;o<e._f.length;o++)i=0,t=_({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[o],dt(t),m(t)&&(i+=h(t).charsLeftOver,i+=10*h(t).unusedTokens.length,h(t).score=i,(null==r||i<r)&&(r=i,n=t));f(e,n||t)}function mt(e){if(!e._d){var t=H(e._i);e._a=u([t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],function(e){return e&&parseInt(e,10)}),ct(e)}}function gt(e){var t=new v(ot(_t(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function _t(e){var t=e._i,n=e._f;return e._locale=e._locale||nt(e._l),null===t||void 0===n&&""===t?g({nullInput:!0}):("string"==typeof t&&(e._i=t=e._locale.preparse(t)),y(t)?new v(ot(t)):(l(t)?e._d=t:r(n)?ht(e):n?dt(e):vt(e),m(e)||(e._d=null),e))}function vt(e){var n=e._i;a(n)?e._d=new Date(t.now()):l(n)?e._d=new Date(n.valueOf()):"string"==typeof n?st(e):r(n)?(e._a=u(n.slice(0),function(e){return parseInt(e,10)}),ct(e)):o(n)?mt(e):s(n)?e._d=new Date(n):t.createFromInputFallback(e)}function yt(e,t,n,a,s){var l={};return!0!==n&&!1!==n||(a=n,n=void 0),(o(e)&&i(e)||r(e)&&0===e.length)&&(e=void 0),l._isAMomentObject=!0,l._useUTC=l._isUTC=s,l._l=n,l._i=e,l._f=t,l._strict=a,gt(l)}function bt(e,t,n,r){return yt(e,t,n,r,!1)}function wt(e,t){var n,o;if(1===t.length&&r(t[0])&&(t=t[0]),!t.length)return bt();for(n=t[0],o=1;o<t.length;++o)t[o].isValid()&&!t[o][e](n)||(n=t[o]);return n}function Ct(){return wt("isBefore",[].slice.call(arguments,0))}function St(){return wt("isAfter",[].slice.call(arguments,0))}function xt(e){for(var t in e)if(-1===Go.indexOf(t)||null!=e[t]&&isNaN(e[t]))return!1;for(var n=!1,r=0;r<Go.length;++r)if(e[Go[r]]){if(n)return!1;parseFloat(e[Go[r]])!==w(e[Go[r]])&&(n=!0)}return!0}function Tt(){return this._isValid}function Et(){return Yt(NaN)}function Mt(e){var t=H(e),n=t.year||0,r=t.quarter||0,o=t.month||0,i=t.week||0,a=t.day||0,s=t.hour||0,l=t.minute||0,u=t.second||0,c=t.millisecond||0;this._isValid=xt(t),this._milliseconds=+c+1e3*u+6e4*l+1e3*s*60*60,this._days=+a+7*i,this._months=+o+3*r+12*n,this._data={},this._locale=nt(),this._bubble()}function At(e){return e instanceof Mt}function kt(e){return e<0?-1*Math.round(-1*e):Math.round(e)}function Rt(e,t){K(e,0,0,function(){var e=this.utcOffset(),n="+";return e<0&&(e=-e,n="-"),n+G(~~(e/60),2)+t+G(~~e%60,2)})}function It(e,t){var n=(t||"").match(e);if(null===n)return null;var r=n[n.length-1]||[],o=(r+"").match(Ko)||["-",0,0],i=60*o[1]+w(o[2]);return 0===i?0:"+"===o[0]?i:-i}function Ot(e,n){var r,o;return n._isUTC?(r=n.clone(),o=(y(e)||l(e)?e.valueOf():bt(e).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+o),t.updateOffset(r,!1),r):bt(e).local()}function Dt(e){return 15*-Math.round(e._d.getTimezoneOffset()/15)}function Pt(e,n,r){var o,i=this._offset||0;if(!this.isValid())return null!=e?this:NaN;if(null!=e){if("string"==typeof e){if(null===(e=It(to,e)))return this}else Math.abs(e)<16&&!r&&(e*=60);return!this._isUTC&&n&&(o=Dt(this)),this._offset=e,this._isUTC=!0,null!=o&&this.add(o,"m"),i!==e&&(!n||this._changeInProgress?Jt(this,Yt(e-i,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,t.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?i:Dt(this)}function Nt(e,t){return null!=e?("string"!=typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function Ft(e){return this.utcOffset(0,e)}function Lt(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(Dt(this),"m")),this}function Ht(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var e=It(eo,this._i);null!=e?this.utcOffset(e):this.utcOffset(0,!0)}return this}function Vt(e){return!!this.isValid()&&(e=e?bt(e).utcOffset():0,(this.utcOffset()-e)%60==0)}function jt(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Bt(){if(!a(this._isDSTShifted))return this._isDSTShifted;var e={};if(_(e,this),e=_t(e),e._a){var t=e._isUTC?d(e._a):bt(e._a);this._isDSTShifted=this.isValid()&&C(e._a,t.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted}function Ut(){return!!this.isValid()&&!this._isUTC}function Wt(){return!!this.isValid()&&this._isUTC}function zt(){return!!this.isValid()&&(this._isUTC&&0===this._offset)}function Yt(e,t){var n,r,o,i=e,a=null;return At(e)?i={ms:e._milliseconds,d:e._days,M:e._months}:s(e)?(i={},t?i[t]=e:i.milliseconds=e):(a=Xo.exec(e))?(n="-"===a[1]?-1:1,i={y:0,d:w(a[lo])*n,h:w(a[uo])*n,m:w(a[co])*n,s:w(a[fo])*n,ms:w(kt(1e3*a[po]))*n}):(a=qo.exec(e))?(n="-"===a[1]?-1:1,i={y:Gt(a[2],n),M:Gt(a[3],n),w:Gt(a[4],n),d:Gt(a[5],n),h:Gt(a[6],n),m:Gt(a[7],n),s:Gt(a[8],n)}):null==i?i={}:"object"==typeof i&&("from"in i||"to"in i)&&(o=Xt(bt(i.from),bt(i.to)),i={},i.ms=o.milliseconds,i.M=o.months),r=new Mt(i),At(e)&&c(e,"_locale")&&(r._locale=e._locale),r}function Gt(e,t){var n=e&&parseFloat(e.replace(",","."));return(isNaN(n)?0:n)*t}function Kt(e,t){var n={milliseconds:0,months:0};return n.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(n.months,"M").isAfter(t)&&--n.months,n.milliseconds=+t-+e.clone().add(n.months,"M"),n}function Xt(e,t){var n;return e.isValid()&&t.isValid()?(t=Ot(t,e),e.isBefore(t)?n=Kt(e,t):(n=Kt(t,e),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function qt(e,t){return function(n,r){var o,i;return null===r||isNaN(+r)||(T(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),i=n,n=r,r=i),n="string"==typeof n?+n:n,o=Yt(n,r),Jt(this,o,e),this}}function Jt(e,n,r,o){var i=n._milliseconds,a=kt(n._days),s=kt(n._months);e.isValid()&&(o=null==o||o,i&&e._d.setTime(e._d.valueOf()+i*r),a&&W(e,"Date",U(e,"Date")+a*r),s&&ce(e,U(e,"Month")+s*r),o&&t.updateOffset(e,a||s))}function Zt(e,t){var n=e.diff(t,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function Qt(e,n){var r=e||bt(),o=Ot(r,this).startOf("day"),i=t.calendarFormat(this,o)||"sameElse",a=n&&(E(n[i])?n[i].call(this,r):n[i]);return this.format(a||this.localeData().calendar(i,this,bt(r)))}function $t(){return new v(this)}function en(e,t){var n=y(e)?e:bt(e);return!(!this.isValid()||!n.isValid())&&(t=L(a(t)?"millisecond":t),"millisecond"===t?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(t).valueOf())}function tn(e,t){var n=y(e)?e:bt(e);return!(!this.isValid()||!n.isValid())&&(t=L(a(t)?"millisecond":t),"millisecond"===t?this.valueOf()<n.valueOf():this.clone().endOf(t).valueOf()<n.valueOf())}function nn(e,t,n,r){return r=r||"()",("("===r[0]?this.isAfter(e,n):!this.isBefore(e,n))&&(")"===r[1]?this.isBefore(t,n):!this.isAfter(t,n))}function rn(e,t){var n,r=y(e)?e:bt(e);return!(!this.isValid()||!r.isValid())&&(t=L(t||"millisecond"),"millisecond"===t?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf()))}function on(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function an(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function sn(e,t,n){var r,o,i,a;return this.isValid()?(r=Ot(e,this),r.isValid()?(o=6e4*(r.utcOffset()-this.utcOffset()),t=L(t),"year"===t||"month"===t||"quarter"===t?(a=ln(this,r),"quarter"===t?a/=3:"year"===t&&(a/=12)):(i=this-r,a="second"===t?i/1e3:"minute"===t?i/6e4:"hour"===t?i/36e5:"day"===t?(i-o)/864e5:"week"===t?(i-o)/6048e5:i),n?a:b(a)):NaN):NaN}function ln(e,t){var n,r,o=12*(t.year()-e.year())+(t.month()-e.month()),i=e.clone().add(o,"months");return t-i<0?(n=e.clone().add(o-1,"months"),r=(t-i)/(i-n)):(n=e.clone().add(o+1,"months"),r=(t-i)/(n-i)),-(o+r)||0}function un(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function cn(){if(!this.isValid())return null;var e=this.clone().utc();return e.year()<0||e.year()>9999?J(e,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):E(Date.prototype.toISOString)?this.toDate().toISOString():J(e,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}function fn(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="";this.isLocal()||(e=0===this.utcOffset()?"moment.utc":"moment.parseZone",t="Z");var n="["+e+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",o=t+'[")]';return this.format(n+r+"-MM-DD[T]HH:mm:ss.SSS"+o)}function dn(e){e||(e=this.isUtc()?t.defaultFormatUtc:t.defaultFormat);var n=J(this,e);return this.localeData().postformat(n)}function pn(e,t){return this.isValid()&&(y(e)&&e.isValid()||bt(e).isValid())?Yt({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function hn(e){return this.from(bt(),e)}function mn(e,t){return this.isValid()&&(y(e)&&e.isValid()||bt(e).isValid())?Yt({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function gn(e){return this.to(bt(),e)}function _n(e){var t;return void 0===e?this._locale._abbr:(t=nt(e),null!=t&&(this._locale=t),this)}function vn(){return this._locale}function yn(e){switch(e=L(e)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":case"date":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e&&this.weekday(0),"isoWeek"===e&&this.isoWeekday(1),"quarter"===e&&this.month(3*Math.floor(this.month()/3)),this}function bn(e){return void 0===(e=L(e))||"millisecond"===e?this:("date"===e&&(e="day"),this.startOf(e).add(1,"isoWeek"===e?"week":e).subtract(1,"ms"))}function wn(){return this._d.valueOf()-6e4*(this._offset||0)}function Cn(){return Math.floor(this.valueOf()/1e3)}function Sn(){return new Date(this.valueOf())}function xn(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function Tn(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function En(){return this.isValid()?this.toISOString():null}function Mn(){return m(this)}function An(){return f({},h(this))}function kn(){return h(this).overflow}function Rn(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}function In(e,t){K(0,[e,e.length],0,t)}function On(e){return Fn.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function Dn(e){return Fn.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function Pn(){return xe(this.year(),1,4)}function Nn(){var e=this.localeData()._week;return xe(this.year(),e.dow,e.doy)}function Fn(e,t,n,r,o){var i;return null==e?Se(this,r,o).year:(i=xe(e,r,o),t>i&&(t=i),Ln.call(this,e,t,n,r,o))}function Ln(e,t,n,r,o){var i=Ce(e,t,n,r,o),a=be(i.year,0,i.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}function Hn(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)}function Vn(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")}function jn(e,t){t[po]=w(1e3*("0."+e))}function Bn(){return this._isUTC?"UTC":""}function Un(){return this._isUTC?"Coordinated Universal Time":""}function Wn(e){return bt(1e3*e)}function zn(){return bt.apply(null,arguments).parseZone()}function Yn(e){return e}function Gn(e,t,n,r){var o=nt(),i=d().set(r,t);return o[n](i,e)}function Kn(e,t,n){if(s(e)&&(t=e,e=void 0),e=e||"",null!=t)return Gn(e,t,n,"month");var r,o=[];for(r=0;r<12;r++)o[r]=Gn(e,r,n,"month");return o}function Xn(e,t,n,r){"boolean"==typeof e?(s(t)&&(n=t,t=void 0),t=t||""):(t=e,n=t,e=!1,s(t)&&(n=t,t=void 0),t=t||"");var o=nt(),i=e?o._week.dow:0;if(null!=n)return Gn(t,(n+i)%7,r,"day");var a,l=[];for(a=0;a<7;a++)l[a]=Gn(t,(a+i)%7,r,"day");return l}function qn(e,t){return Kn(e,t,"months")}function Jn(e,t){return Kn(e,t,"monthsShort")}function Zn(e,t,n){return Xn(e,t,n,"weekdays")}function Qn(e,t,n){return Xn(e,t,n,"weekdaysShort")}function $n(e,t,n){return Xn(e,t,n,"weekdaysMin")}function er(){var e=this._data;return this._milliseconds=ai(this._milliseconds),this._days=ai(this._days),this._months=ai(this._months),e.milliseconds=ai(e.milliseconds),e.seconds=ai(e.seconds),e.minutes=ai(e.minutes),e.hours=ai(e.hours),e.months=ai(e.months),e.years=ai(e.years),this}function tr(e,t,n,r){var o=Yt(t,n);return e._milliseconds+=r*o._milliseconds,e._days+=r*o._days,e._months+=r*o._months,e._bubble()}function nr(e,t){return tr(this,e,t,1)}function rr(e,t){return tr(this,e,t,-1)}function or(e){return e<0?Math.floor(e):Math.ceil(e)}function ir(){var e,t,n,r,o,i=this._milliseconds,a=this._days,s=this._months,l=this._data;return i>=0&&a>=0&&s>=0||i<=0&&a<=0&&s<=0||(i+=864e5*or(sr(s)+a),a=0,s=0),l.milliseconds=i%1e3,e=b(i/1e3),l.seconds=e%60,t=b(e/60),l.minutes=t%60,n=b(t/60),l.hours=n%24,a+=b(n/24),o=b(ar(a)),s+=o,a-=or(sr(o)),r=b(s/12),s%=12,l.days=a,l.months=s,l.years=r,this}function ar(e){return 4800*e/146097}function sr(e){return 146097*e/4800}function lr(e){if(!this.isValid())return NaN;var t,n,r=this._milliseconds;if("month"===(e=L(e))||"year"===e)return t=this._days+r/864e5,n=this._months+ar(t),"month"===e?n:n/12;switch(t=this._days+Math.round(sr(this._months)),e){case"week":return t/7+r/6048e5;case"day":return t+r/864e5;case"hour":return 24*t+r/36e5;case"minute":return 1440*t+r/6e4;case"second":return 86400*t+r/1e3;case"millisecond":return Math.floor(864e5*t)+r;default:throw new Error("Unknown unit "+e)}}function ur(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*w(this._months/12):NaN}function cr(e){return function(){return this.as(e)}}function fr(e){return e=L(e),this.isValid()?this[e+"s"]():NaN}function dr(e){return function(){return this.isValid()?this._data[e]:NaN}}function pr(){return b(this.days()/7)}function hr(e,t,n,r,o){return o.relativeTime(t||1,!!n,e,r)}function mr(e,t,n){var r=Yt(e).abs(),o=Ci(r.as("s")),i=Ci(r.as("m")),a=Ci(r.as("h")),s=Ci(r.as("d")),l=Ci(r.as("M")),u=Ci(r.as("y")),c=o<=Si.ss&&["s",o]||o<Si.s&&["ss",o]||i<=1&&["m"]||i<Si.m&&["mm",i]||a<=1&&["h"]||a<Si.h&&["hh",a]||s<=1&&["d"]||s<Si.d&&["dd",s]||l<=1&&["M"]||l<Si.M&&["MM",l]||u<=1&&["y"]||["yy",u];return c[2]=t,c[3]=+e>0,c[4]=n,hr.apply(null,c)}function gr(e){return void 0===e?Ci:"function"==typeof e&&(Ci=e,!0)}function _r(e,t){return void 0!==Si[e]&&(void 0===t?Si[e]:(Si[e]=t,"s"===e&&(Si.ss=t-1),!0))}function vr(e){if(!this.isValid())return this.localeData().invalidDate();var t=this.localeData(),n=mr(this,!e,t);return e&&(n=t.pastFuture(+this,n)),t.postformat(n)}function yr(){if(!this.isValid())return this.localeData().invalidDate();var e,t,n,r=xi(this._milliseconds)/1e3,o=xi(this._days),i=xi(this._months);e=b(r/60),t=b(e/60),r%=60,e%=60,n=b(i/12),i%=12;var a=n,s=i,l=o,u=t,c=e,f=r,d=this.asSeconds();return d?(d<0?"-":"")+"P"+(a?a+"Y":"")+(s?s+"M":"")+(l?l+"D":"")+(u||c||f?"T":"")+(u?u+"H":"")+(c?c+"M":"")+(f?f+"S":""):"P0D"}var br,wr;wr=Array.prototype.some?Array.prototype.some:function(e){for(var t=Object(this),n=t.length>>>0,r=0;r<n;r++)if(r in t&&e.call(this,t[r],r,t))return!0;return!1};var Cr=wr,Sr=t.momentProperties=[],xr=!1,Tr={};t.suppressDeprecationWarnings=!1,t.deprecationHandler=null;var Er;Er=Object.keys?Object.keys:function(e){var t,n=[];for(t in e)c(e,t)&&n.push(t);return n};var Mr,Ar=Er,kr={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},Rr={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},Ir="Invalid date",Or="%d",Dr=/\d{1,2}/,Pr={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},Nr={},Fr={},Lr=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Hr=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Vr={},jr={},Br=/\d/,Ur=/\d\d/,Wr=/\d{3}/,zr=/\d{4}/,Yr=/[+-]?\d{6}/,Gr=/\d\d?/,Kr=/\d\d\d\d?/,Xr=/\d\d\d\d\d\d?/,qr=/\d{1,3}/,Jr=/\d{1,4}/,Zr=/[+-]?\d{1,6}/,Qr=/\d+/,$r=/[+-]?\d+/,eo=/Z|[+-]\d\d:?\d\d/gi,to=/Z|[+-]\d\d(?::?\d\d)?/gi,no=/[+-]?\d+(\.\d{1,3})?/,ro=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,oo={},io={},ao=0,so=1,lo=2,uo=3,co=4,fo=5,po=6,ho=7,mo=8;Mr=Array.prototype.indexOf?Array.prototype.indexOf:function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1};var go=Mr;K("M",["MM",2],"Mo",function(){return this.month()+1}),K("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)}),K("MMMM",0,0,function(e){return this.localeData().months(this,e)}),F("month","M"),V("month",8),Q("M",Gr),Q("MM",Gr,Ur),Q("MMM",function(e,t){return t.monthsShortRegex(e)}),Q("MMMM",function(e,t){return t.monthsRegex(e)}),ne(["M","MM"],function(e,t){t[so]=w(e)-1}),ne(["MMM","MMMM"],function(e,t,n,r){var o=n._locale.monthsParse(e,r,n._strict);null!=o?t[so]=o:h(n).invalidMonth=e});var _o=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,vo="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),yo="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),bo=ro,wo=ro;K("Y",0,0,function(){var e=this.year();return e<=9999?""+e:"+"+e}),K(0,["YY",2],0,function(){return this.year()%100}),K(0,["YYYY",4],0,"year"),K(0,["YYYYY",5],0,"year"),K(0,["YYYYYY",6,!0],0,"year"),F("year","y"),V("year",1),Q("Y",$r),Q("YY",Gr,Ur),Q("YYYY",Jr,zr),Q("YYYYY",Zr,Yr),Q("YYYYYY",Zr,Yr),ne(["YYYYY","YYYYYY"],ao),ne("YYYY",function(e,n){n[ao]=2===e.length?t.parseTwoDigitYear(e):w(e)}),ne("YY",function(e,n){n[ao]=t.parseTwoDigitYear(e)}),ne("Y",function(e,t){t[ao]=parseInt(e,10)}),t.parseTwoDigitYear=function(e){return w(e)+(w(e)>68?1900:2e3)};var Co=B("FullYear",!0);K("w",["ww",2],"wo","week"),K("W",["WW",2],"Wo","isoWeek"),F("week","w"),F("isoWeek","W"),V("week",5),V("isoWeek",5),Q("w",Gr),Q("ww",Gr,Ur),Q("W",Gr),Q("WW",Gr,Ur),re(["w","ww","W","WW"],function(e,t,n,r){t[r.substr(0,1)]=w(e)});var So={dow:0,doy:6};K("d",0,"do","day"),K("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)}),K("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)}),K("dddd",0,0,function(e){return this.localeData().weekdays(this,e)}),K("e",0,0,"weekday"),K("E",0,0,"isoWeekday"),F("day","d"),F("weekday","e"),F("isoWeekday","E"),V("day",11),V("weekday",11),V("isoWeekday",11),Q("d",Gr),Q("e",Gr),Q("E",Gr),Q("dd",function(e,t){return t.weekdaysMinRegex(e)}),Q("ddd",function(e,t){return t.weekdaysShortRegex(e)}),Q("dddd",function(e,t){return t.weekdaysRegex(e)}),re(["dd","ddd","dddd"],function(e,t,n,r){var o=n._locale.weekdaysParse(e,r,n._strict);null!=o?t.d=o:h(n).invalidWeekday=e}),re(["d","e","E"],function(e,t,n,r){t[r]=w(e)});var xo="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),To="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Eo="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Mo=ro,Ao=ro,ko=ro;K("H",["HH",2],0,"hour"),K("h",["hh",2],0,ze),K("k",["kk",2],0,Ye),K("hmm",0,0,function(){return""+ze.apply(this)+G(this.minutes(),2)}),K("hmmss",0,0,function(){return""+ze.apply(this)+G(this.minutes(),2)+G(this.seconds(),2)}),K("Hmm",0,0,function(){return""+this.hours()+G(this.minutes(),2)}),K("Hmmss",0,0,function(){return""+this.hours()+G(this.minutes(),2)+G(this.seconds(),2)}),Ge("a",!0),Ge("A",!1),F("hour","h"),V("hour",13),Q("a",Ke),Q("A",Ke),Q("H",Gr),Q("h",Gr),Q("k",Gr),Q("HH",Gr,Ur),Q("hh",Gr,Ur),Q("kk",Gr,Ur),Q("hmm",Kr),Q("hmmss",Xr),Q("Hmm",Kr),Q("Hmmss",Xr),ne(["H","HH"],uo),ne(["k","kk"],function(e,t,n){var r=w(e);t[uo]=24===r?0:r}),ne(["a","A"],function(e,t,n){n._isPm=n._locale.isPM(e),n._meridiem=e}),ne(["h","hh"],function(e,t,n){t[uo]=w(e),h(n).bigHour=!0}),ne("hmm",function(e,t,n){var r=e.length-2;t[uo]=w(e.substr(0,r)),t[co]=w(e.substr(r)),h(n).bigHour=!0}),ne("hmmss",function(e,t,n){var r=e.length-4,o=e.length-2;t[uo]=w(e.substr(0,r)),t[co]=w(e.substr(r,2)),t[fo]=w(e.substr(o)),h(n).bigHour=!0}),ne("Hmm",function(e,t,n){var r=e.length-2;t[uo]=w(e.substr(0,r)),t[co]=w(e.substr(r))}),ne("Hmmss",function(e,t,n){var r=e.length-4,o=e.length-2;t[uo]=w(e.substr(0,r)),t[co]=w(e.substr(r,2)),t[fo]=w(e.substr(o))});var Ro,Io=/[ap]\.?m?\.?/i,Oo=B("Hours",!0),Do={calendar:kr,longDateFormat:Rr,invalidDate:Ir,ordinal:Or,dayOfMonthOrdinalParse:Dr,relativeTime:Pr,months:vo,monthsShort:yo,week:So,weekdays:xo,weekdaysMin:Eo,weekdaysShort:To,meridiemParse:Io},Po={},No={},Fo=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Lo=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Ho=/Z|[+-]\d\d(?::?\d\d)?/,Vo=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],jo=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Bo=/^\/?Date\((\-?\d+)/i,Uo=/^((?:Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d?\d\s(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(?:\d\d)?\d\d\s)(\d\d:\d\d)(\:\d\d)?(\s(?:UT|GMT|[ECMP][SD]T|[A-IK-Za-ik-z]|[+-]\d{4}))$/;t.createFromInputFallback=x("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))}),t.ISO_8601=function(){},t.RFC_2822=function(){};var Wo=x("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=bt.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:g()}),zo=x("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=bt.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:g()}),Yo=function(){return Date.now?Date.now():+new Date},Go=["year","quarter","month","week","day","hour","minute","second","millisecond"];Rt("Z",":"),Rt("ZZ",""),Q("Z",to),Q("ZZ",to),ne(["Z","ZZ"],function(e,t,n){n._useUTC=!0,n._tzm=It(to,e)});var Ko=/([\+\-]|\d\d)/gi;t.updateOffset=function(){};var Xo=/^(\-)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,qo=/^(-)?P(?:(-?[0-9,.]*)Y)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)W)?(?:(-?[0-9,.]*)D)?(?:T(?:(-?[0-9,.]*)H)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)S)?)?$/;Yt.fn=Mt.prototype,Yt.invalid=Et;var Jo=qt(1,"add"),Zo=qt(-1,"subtract");t.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",t.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var Qo=x("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return void 0===e?this.localeData():this.locale(e)});K(0,["gg",2],0,function(){return this.weekYear()%100}),K(0,["GG",2],0,function(){return this.isoWeekYear()%100}),In("gggg","weekYear"),In("ggggg","weekYear"),In("GGGG","isoWeekYear"),In("GGGGG","isoWeekYear"),F("weekYear","gg"),F("isoWeekYear","GG"),V("weekYear",1),V("isoWeekYear",1),Q("G",$r),Q("g",$r),Q("GG",Gr,Ur),Q("gg",Gr,Ur),Q("GGGG",Jr,zr),Q("gggg",Jr,zr),Q("GGGGG",Zr,Yr),Q("ggggg",Zr,Yr),re(["gggg","ggggg","GGGG","GGGGG"],function(e,t,n,r){t[r.substr(0,2)]=w(e)}),re(["gg","GG"],function(e,n,r,o){n[o]=t.parseTwoDigitYear(e)}),K("Q",0,"Qo","quarter"),F("quarter","Q"),V("quarter",7),Q("Q",Br),ne("Q",function(e,t){t[so]=3*(w(e)-1)}),K("D",["DD",2],"Do","date"),F("date","D"),V("date",9),Q("D",Gr),Q("DD",Gr,Ur),Q("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient}),ne(["D","DD"],lo),ne("Do",function(e,t){t[lo]=w(e.match(Gr)[0],10)});var $o=B("Date",!0);K("DDD",["DDDD",3],"DDDo","dayOfYear"),F("dayOfYear","DDD"),V("dayOfYear",4),Q("DDD",qr),Q("DDDD",Wr),ne(["DDD","DDDD"],function(e,t,n){n._dayOfYear=w(e)}),K("m",["mm",2],0,"minute"),F("minute","m"),V("minute",14),Q("m",Gr),Q("mm",Gr,Ur),ne(["m","mm"],co);var ei=B("Minutes",!1);K("s",["ss",2],0,"second"),F("second","s"),V("second",15),Q("s",Gr),Q("ss",Gr,Ur),ne(["s","ss"],fo);var ti=B("Seconds",!1);K("S",0,0,function(){return~~(this.millisecond()/100)}),K(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),K(0,["SSS",3],0,"millisecond"),K(0,["SSSS",4],0,function(){return 10*this.millisecond()}),K(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),K(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),K(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),K(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),K(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),F("millisecond","ms"),V("millisecond",16),Q("S",qr,Br),Q("SS",qr,Ur),Q("SSS",qr,Wr);var ni;for(ni="SSSS";ni.length<=9;ni+="S")Q(ni,Qr);for(ni="S";ni.length<=9;ni+="S")ne(ni,jn);var ri=B("Milliseconds",!1);K("z",0,0,"zoneAbbr"),K("zz",0,0,"zoneName");var oi=v.prototype;oi.add=Jo,oi.calendar=Qt,oi.clone=$t,oi.diff=sn,oi.endOf=bn,oi.format=dn,oi.from=pn,oi.fromNow=hn,oi.to=mn,oi.toNow=gn,oi.get=z,oi.invalidAt=kn,oi.isAfter=en,oi.isBefore=tn,oi.isBetween=nn,oi.isSame=rn,oi.isSameOrAfter=on,oi.isSameOrBefore=an,oi.isValid=Mn,oi.lang=Qo,oi.locale=_n,oi.localeData=vn,oi.max=zo,oi.min=Wo,oi.parsingFlags=An,oi.set=Y,oi.startOf=yn,oi.subtract=Zo,oi.toArray=xn,oi.toObject=Tn,oi.toDate=Sn,oi.toISOString=cn,oi.inspect=fn,oi.toJSON=En,oi.toString=un,oi.unix=Cn,oi.valueOf=wn,oi.creationData=Rn,oi.year=Co,oi.isLeapYear=ve,oi.weekYear=On,oi.isoWeekYear=Dn,oi.quarter=oi.quarters=Hn,oi.month=fe,oi.daysInMonth=de,oi.week=oi.weeks=Ae,oi.isoWeek=oi.isoWeeks=ke,oi.weeksInYear=Nn,oi.isoWeeksInYear=Pn,oi.date=$o,oi.day=oi.days=Le,oi.weekday=He,oi.isoWeekday=Ve,oi.dayOfYear=Vn,oi.hour=oi.hours=Oo,oi.minute=oi.minutes=ei,oi.second=oi.seconds=ti,oi.millisecond=oi.milliseconds=ri,oi.utcOffset=Pt,oi.utc=Ft,oi.local=Lt,oi.parseZone=Ht,oi.hasAlignedHourOffset=Vt,oi.isDST=jt,oi.isLocal=Ut,oi.isUtcOffset=Wt,oi.isUtc=zt,oi.isUTC=zt,oi.zoneAbbr=Bn,oi.zoneName=Un,oi.dates=x("dates accessor is deprecated. Use date instead.",$o),oi.months=x("months accessor is deprecated. Use month instead",fe),oi.years=x("years accessor is deprecated. Use year instead",Co),oi.zone=x("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",Nt),oi.isDSTShifted=x("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",Bt);var ii=k.prototype;ii.calendar=R,ii.longDateFormat=I,ii.invalidDate=O,ii.ordinal=D,ii.preparse=Yn,ii.postformat=Yn,ii.relativeTime=P,ii.pastFuture=N,ii.set=M,ii.months=ae,ii.monthsShort=se,ii.monthsParse=ue,ii.monthsRegex=he,ii.monthsShortRegex=pe,ii.week=Te,ii.firstDayOfYear=Me,ii.firstDayOfWeek=Ee,ii.weekdays=Oe,ii.weekdaysMin=Pe,ii.weekdaysShort=De,ii.weekdaysParse=Fe,ii.weekdaysRegex=je,ii.weekdaysShortRegex=Be,ii.weekdaysMinRegex=Ue,ii.isPM=Xe,ii.meridiem=qe,$e("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10;return e+(1===w(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")}}),t.lang=x("moment.lang is deprecated. Use moment.locale instead.",$e),t.langData=x("moment.langData is deprecated. Use moment.localeData instead.",nt);var ai=Math.abs,si=cr("ms"),li=cr("s"),ui=cr("m"),ci=cr("h"),fi=cr("d"),di=cr("w"),pi=cr("M"),hi=cr("y"),mi=dr("milliseconds"),gi=dr("seconds"),_i=dr("minutes"),vi=dr("hours"),yi=dr("days"),bi=dr("months"),wi=dr("years"),Ci=Math.round,Si={ss:44,s:45,m:45,h:22,d:26,M:11},xi=Math.abs,Ti=Mt.prototype;return Ti.isValid=Tt,Ti.abs=er,Ti.add=nr,Ti.subtract=rr,Ti.as=lr,Ti.asMilliseconds=si,Ti.asSeconds=li,Ti.asMinutes=ui,Ti.asHours=ci,Ti.asDays=fi,Ti.asWeeks=di,Ti.asMonths=pi,Ti.asYears=hi,Ti.valueOf=ur,Ti._bubble=ir,Ti.get=fr,Ti.milliseconds=mi,Ti.seconds=gi,Ti.minutes=_i,Ti.hours=vi,Ti.days=yi,Ti.weeks=pr,Ti.months=bi,Ti.years=wi,Ti.humanize=vr,Ti.toISOString=yr,Ti.toString=yr,Ti.toJSON=yr,Ti.locale=_n,Ti.localeData=vn,Ti.toIsoString=x("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",yr),Ti.lang=Qo,K("X",0,0,"unix"),K("x",0,0,"valueOf"),Q("x",$r),Q("X",no),ne("X",function(e,t,n){n._d=new Date(1e3*parseFloat(e,10))}),ne("x",function(e,t,n){n._d=new Date(w(e))}),t.version="2.18.1",n(bt),t.fn=oi,t.min=Ct,t.max=St,t.now=Yo,t.utc=d,t.unix=Wn,t.months=qn,t.isDate=l,t.locale=$e,t.invalid=g,t.duration=Yt,t.isMoment=y,t.weekdays=Zn,t.parseZone=zn,t.localeData=nt,t.isDuration=At,t.monthsShort=Jn,t.weekdaysMin=$n,t.defineLocale=et,t.updateLocale=tt,t.locales=rt,t.weekdaysShort=Qn,t.normalizeUnits=L,t.relativeTimeRounding=gr,t.relativeTimeThreshold=_r,t.calendarFormat=Zt,t.prototype=oi,t})}).call(t,n(52)(e))},,,function(e,t,n){"use strict";var r={childContextTypes:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,mixins:!0,propTypes:!0,type:!0},o={name:!0,length:!0,prototype:!0,caller:!0,arguments:!0,arity:!0},i="function"==typeof Object.getOwnPropertySymbols;e.exports=function(e,t,n){if("string"!=typeof t){var a=Object.getOwnPropertyNames(t);i&&(a=a.concat(Object.getOwnPropertySymbols(t)));for(var s=0;s<a.length;++s)if(!(r[a[s]]||o[a[s]]||n&&n[a[s]]))try{e[a[s]]=t[a[s]]}catch(e){}}return e}},function(e,t){function n(e,t){return"string"!=typeof e&&(e=e._name),{type:"@@modal/PUSH_MODAL",payload:{name:e,params:t}}}function r(){return{type:"@@modal/POP_MODAL"}}function o(){return{type:"@@modal/CLEAN_MODALS"}}Object.defineProperty(t,"__esModule",{value:!0}),t.pushModal=n,t.popModal=r,t.cleanModals=o},function(e,t,n){(function(r){function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(0),f=o(c),d=n(681),p=o(d),h=n(683),m=o(h),g=n(684),_=o(g),v=n(685),y=o(v),b=n(686),w=o(b),C=n(687),S=o(C),x=n(688),T=o(x),E=n(689),M=o(E),A=n(690),k=o(A),R=n(691),I=o(R),O=n(692),D=o(O),P=n(693),N=o(P),F=n(694),L=o(F),H=n(189),V=o(H),j={purchase:function(e){return(0,V.default)(e).when("renew",function(){return m.default}).when("supplementary",function(){return _.default}).others(function(){return p.default}).done()},"alipay-qrcode":function(){return y.default},"payment-success":function(){return w.default},"payment-failure":function(){return S.default},"transfers-inventory":function(){return T.default},"confirm-invoice-info":function(){return M.default},"confirm-VATInvoice-info":function(){return k.default},"fill-invoice-info":function(){return I.default},"thanks-to-buy":function(){return D.default},"waiting-pay":function(){return N.default},"cancel-order":function(){return L.default}},B=5,U=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),o=e.data&&e.data.page,s=cow.currentUser.team.membership;return n.state={current:o||"purchase",data:l({},n.props.data,{memberCount:r.max([s&&s.memberCount||0,B]),needRefresh:!1})},n.onNext=n.onNext.bind(n),n}return s(t,e),u(t,null,[{key:"propTypes",get:function(){return{data:c.PropTypes.object,open:c.PropTypes.bool,type:c.PropTypes.string,onClose:c.PropTypes.func,currentUser:c.PropTypes.object,team:c.PropTypes.object}}}]),u(t,[{key:"onNext",value:function(e,t){this.setState({current:e,data:l({},this.state.data,t)})}},{key:"renderComponent",value:function(e){var t=this.props,n=t.open,r=t.onClose,o=t.type,i=j[e](o),a=this.props.team;return f.default.createElement(i,{open:n,onClose:this.state.data.needRefresh?function(){return location.replace(location.pathname)}:r,onNext:this.onNext,data:this.state.data,type:o,currentUser:this.props.currentUser,team:a})}},{key:"render",value:function(){var e=this;return f.default.createElement("div",{id:"enterprise-payment"},(0,V.default)(this.state.current).when("purchase",function(){return e.renderComponent("purchase")}).when("alipay-qrcode",function(){return e.renderComponent("alipay-qrcode")}).when("payment-success",function(){return e.renderComponent("payment-success")}).when("payment-failure",function(){return e.renderComponent("payment-failure")}).when("transfers-inventory",function(){return e.renderComponent("transfers-inventory")}).when("confirm-invoice-info",function(){return e.renderComponent("confirm-invoice-info")}).when("confirm-VATInvoice-info",function(){return e.renderComponent("confirm-VATInvoice-info")}).when("fill-invoice-info",function(){return e.renderComponent("fill-invoice-info")}).when("thanks-to-buy",function(){return e.renderComponent("thanks-to-buy")}).when("waiting-pay",function(){return e.renderComponent("waiting-pay")}).when("cancel-order",function(){return e.renderComponent("cancel-order")}).done())}}]),t}(c.Component);t.default=U,e.exports=t.default}).call(t,n(1))},function(e,t,n){function r(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}var o=n(929),i=n(930),a=n(931),s=n(932),l=n(933);r.prototype.clear=o,r.prototype.delete=i,r.prototype.get=a,r.prototype.has=s,r.prototype.set=l,e.exports=r},function(e,t,n){function r(e,t){for(var n=e.length;n--;)if(o(e[n][0],t))return n;return-1}var o=n(325);e.exports=r},function(e,t,n){var r=n(269),o=r(Object,"create");e.exports=o},function(e,t,n){function r(e,t){var n=e.__data__;return o(t)?n["string"==typeof t?"string":"hash"]:n.map}var o=n(947);e.exports=r},function(e,t,n){var r;!function(o){function i(){this._events={},this._conf&&a.call(this,this._conf)}function a(e){e&&(this._conf=e,e.delimiter&&(this.delimiter=e.delimiter),e.maxListeners&&(this._events.maxListeners=e.maxListeners),e.wildcard&&(this.wildcard=e.wildcard),e.newListener&&(this.newListener=e.newListener),this.wildcard&&(this.listenerTree={}))}function s(e){this._events={},this.newListener=!1,a.call(this,e)}function l(e,t,n,r){if(!n)return[];var o,i,a,s,u,c,f,d=[],p=t.length,h=t[r],m=t[r+1];if(r===p&&n._listeners){if("function"==typeof n._listeners)return e&&e.push(n._listeners),[n];for(o=0,i=n._listeners.length;o<i;o++)e&&e.push(n._listeners[o]);return[n]}if("*"===h||"**"===h||n[h]){if("*"===h){for(a in n)"_listeners"!==a&&n.hasOwnProperty(a)&&(d=d.concat(l(e,t,n[a],r+1)));return d}if("**"===h){f=r+1===p||r+2===p&&"*"===m,f&&n._listeners&&(d=d.concat(l(e,t,n,p)));for(a in n)"_listeners"!==a&&n.hasOwnProperty(a)&&("*"===a||"**"===a?(n[a]._listeners&&!f&&(d=d.concat(l(e,t,n[a],p))),d=d.concat(l(e,t,n[a],r))):d=a===m?d.concat(l(e,t,n[a],r+2)):d.concat(l(e,t,n[a],r)));return d}d=d.concat(l(e,t,n[h],r+1))}if(s=n["*"],s&&l(e,t,s,r+1),u=n["**"])if(r<p){u._listeners&&l(e,t,u,p);for(a in u)"_listeners"!==a&&u.hasOwnProperty(a)&&(a===m?l(e,t,u[a],r+2):a===h?l(e,t,u[a],r+1):(c={},c[a]=u[a],l(e,t,{"**":c},r+1)))}else u._listeners?l(e,t,u,p):u["*"]&&u["*"]._listeners&&l(e,t,u["*"],p);return d}function u(e,t){e="string"==typeof e?e.split(this.delimiter):e.slice();for(var n=0,r=e.length;n+1<r;n++)if("**"===e[n]&&"**"===e[n+1])return;for(var o=this.listenerTree,i=e.shift();i;){if(o[i]||(o[i]={}),o=o[i],0===e.length){if(o._listeners){if("function"==typeof o._listeners)o._listeners=[o._listeners,t];else if(c(o._listeners)&&(o._listeners.push(t),!o._listeners.warned)){var a=f;void 0!==this._events.maxListeners&&(a=this._events.maxListeners),a>0&&o._listeners.length>a&&(o._listeners.warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",o._listeners.length),console.trace&&console.trace())}}else o._listeners=t;return!0}i=e.shift()}return!0}var c=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},f=10;s.EventEmitter2=s,s.prototype.delimiter=".",s.prototype.setMaxListeners=function(e){this._events||i.call(this),this._events.maxListeners=e,this._conf||(this._conf={}),this._conf.maxListeners=e},s.prototype.event="",s.prototype.once=function(e,t){return this.many(e,1,t),this},s.prototype.many=function(e,t,n){function r(){0==--t&&o.off(e,r),n.apply(this,arguments)}var o=this;if("function"!=typeof n)throw new Error("many only accepts instances of Function");return r._origin=n,this.on(e,r),o},s.prototype.emit=function(){this._events||i.call(this);var e=arguments[0];if("newListener"===e&&!this.newListener&&!this._events.newListener)return!1;var t,n,r,o,a,s=arguments.length;if(this._all&&this._all.length){if(a=this._all.slice(),s>3)for(t=new Array(s),o=1;o<s;o++)t[o]=arguments[o];for(r=0,n=a.length;r<n;r++)switch(this.event=e,s){case 1:a[r].call(this,e);break;case 2:a[r].call(this,e,arguments[1]);break;case 3:a[r].call(this,e,arguments[1],arguments[2]);break;default:a[r].apply(this,t)}}if(this.wildcard){a=[];var u="string"==typeof e?e.split(this.delimiter):e.slice();l.call(this,a,u,this.listenerTree,0)}else{if("function"==typeof(a=this._events[e])){switch(this.event=e,s){case 1:a.call(this);break;case 2:a.call(this,arguments[1]);break;case 3:a.call(this,arguments[1],arguments[2]);break;default:for(t=new Array(s-1),o=1;o<s;o++)t[o-1]=arguments[o];a.apply(this,t)}return!0}a&&(a=a.slice())}if(a&&a.length){if(s>3)for(t=new Array(s-1),o=1;o<s;o++)t[o-1]=arguments[o];for(r=0,n=a.length;r<n;r++)switch(this.event=e,s){case 1:a[r].call(this);break;case 2:a[r].call(this,arguments[1]);break;case 3:a[r].call(this,arguments[1],arguments[2]);break;default:a[r].apply(this,t)}return!0}if(!this._all&&"error"===e)throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");return!!this._all},s.prototype.emitAsync=function(){this._events||i.call(this);var e=arguments[0];if("newListener"===e&&!this.newListener&&!this._events.newListener)return Promise.resolve([!1]);var t,n,r,o,a,s=[],u=arguments.length;if(this._all){if(u>3)for(t=new Array(u),o=1;o<u;o++)t[o]=arguments[o];for(r=0,n=this._all.length;r<n;r++)switch(this.event=e,u){case 1:s.push(this._all[r].call(this,e));break;case 2:s.push(this._all[r].call(this,e,arguments[1]));break;case 3:s.push(this._all[r].call(this,e,arguments[1],arguments[2]));break;default:s.push(this._all[r].apply(this,t))}}if(this.wildcard){a=[];var c="string"==typeof e?e.split(this.delimiter):e.slice();l.call(this,a,c,this.listenerTree,0)}else a=this._events[e];if("function"==typeof a)switch(this.event=e,u){case 1:s.push(a.call(this));break;case 2:s.push(a.call(this,arguments[1]));break;case 3:s.push(a.call(this,arguments[1],arguments[2]));break;default:for(t=new Array(u-1),o=1;o<u;o++)t[o-1]=arguments[o];s.push(a.apply(this,t))}else if(a&&a.length){if(u>3)for(t=new Array(u-1),o=1;o<u;o++)t[o-1]=arguments[o];for(r=0,n=a.length;r<n;r++)switch(this.event=e,u){case 1:s.push(a[r].call(this));break;case 2:s.push(a[r].call(this,arguments[1]));break;case 3:s.push(a[r].call(this,arguments[1],arguments[2]));break;default:s.push(a[r].apply(this,t))}}else if(!this._all&&"error"===e)return arguments[1]instanceof Error?Promise.reject(arguments[1]):Promise.reject("Uncaught, unspecified 'error' event.");return Promise.all(s)},s.prototype.on=function(e,t){if("function"==typeof e)return this.onAny(e),this;if("function"!=typeof t)throw new Error("on only accepts instances of Function");if(this._events||i.call(this),this.emit("newListener",e,t),this.wildcard)return u.call(this,e,t),this;if(this._events[e]){if("function"==typeof this._events[e])this._events[e]=[this._events[e],t];else if(c(this._events[e])&&(this._events[e].push(t),!this._events[e].warned)){var n=f;void 0!==this._events.maxListeners&&(n=this._events.maxListeners),n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),console.trace&&console.trace())}}else this._events[e]=t;return this},s.prototype.onAny=function(e){if("function"!=typeof e)throw new Error("onAny only accepts instances of Function");return this._all||(this._all=[]),this._all.push(e),this},s.prototype.addListener=s.prototype.on,s.prototype.off=function(e,t){function n(e){if(e!==o){var t=Object.keys(e);for(var r in t){var i=t[r],a=e[i];a instanceof Function||"object"!=typeof a||(Object.keys(a).length>0&&n(e[i]),0===Object.keys(a).length&&delete e[i])}}}if("function"!=typeof t)throw new Error("removeListener only takes instances of Function");var r,i=[];if(this.wildcard){var a="string"==typeof e?e.split(this.delimiter):e.slice();i=l.call(this,null,a,this.listenerTree,0)}else{if(!this._events[e])return this;r=this._events[e],i.push({_listeners:r})}for(var s=0;s<i.length;s++){var u=i[s];if(r=u._listeners,c(r)){for(var f=-1,d=0,p=r.length;d<p;d++)if(r[d]===t||r[d].listener&&r[d].listener===t||r[d]._origin&&r[d]._origin===t){f=d;break}if(f<0)continue;return this.wildcard?u._listeners.splice(f,1):this._events[e].splice(f,1),0===r.length&&(this.wildcard?delete u._listeners:delete this._events[e]),this.emit("removeListener",e,t),this}(r===t||r.listener&&r.listener===t||r._origin&&r._origin===t)&&(this.wildcard?delete u._listeners:delete this._events[e],this.emit("removeListener",e,t))}return n(this.listenerTree),this},s.prototype.offAny=function(e){var t,n=0,r=0;if(e&&this._all&&this._all.length>0){for(t=this._all,n=0,r=t.length;n<r;n++)if(e===t[n])return t.splice(n,1),this.emit("removeListenerAny",e),this}else{for(t=this._all,n=0,r=t.length;n<r;n++)this.emit("removeListenerAny",t[n]);this._all=[]}return this},s.prototype.removeListener=s.prototype.off,s.prototype.removeAllListeners=function(e){if(0===arguments.length)return!this._events||i.call(this),this;if(this.wildcard)for(var t="string"==typeof e?e.split(this.delimiter):e.slice(),n=l.call(this,null,t,this.listenerTree,0),r=0;r<n.length;r++){var o=n[r];o._listeners=null}else{if(!this._events||!this._events[e])return this;this._events[e]=null}return this},s.prototype.listeners=function(e){if(this.wildcard){var t=[],n="string"==typeof e?e.split(this.delimiter):e.slice();return l.call(this,t,n,this.listenerTree,0),t}return this._events||i.call(this),this._events[e]||(this._events[e]=[]),c(this._events[e])||(this._events[e]=[this._events[e]]),this._events[e]},s.prototype.listenersAny=function(){return this._all?this._all:[]},(r=function(){return s}.call(t,n,t,e))!==o&&(e.exports=r)}()},,,,,,,,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(){f||(f=!0,console.error("<Provider> does not support changing `store` on the fly. It is most likely that you see this error because you updated to Redux 2.x and React Redux 2.x which no longer hot reload reducers automatically. See https://github.com/rackt/react-redux/releases/tag/v2.0.0 for the migration instructions."))}t.__esModule=!0,t.default=void 0;var l=n(0),u=n(545),c=r(u),f=!1,d=function(e){function t(n,r){o(this,t);var a=i(this,e.call(this,n,r));return a.store=n.store,a}return a(t,e),t.prototype.getChildContext=function(){return{store:this.store}},t.prototype.componentWillReceiveProps=function(e){this.store!==e.store&&s()},t.prototype.render=function(){var e=this.props.children;return l.Children.only(e)},t}(l.Component);t.default=d,d.propTypes={store:c.default.isRequired,children:l.PropTypes.element.isRequired},d.childContextTypes={store:c.default.isRequired}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){return e.displayName||e.name||"Component"}function l(e,t,n){function r(e,t){var n=e.getState(),r=A?v(n,t):v(n);return(0,S.default)((0,_.default)(r),"`mapStateToProps` must return an object. Instead received %s.",r),r}function l(e,t){var n=e.dispatch,r=k?b(n,t):b(n);return(0,S.default)((0,_.default)(r),"`mapDispatchToProps` must return an object. Instead received %s.",r),r}function d(e,t,n){var r=C(e,t,n);return(0,S.default)((0,_.default)(r),"`mergeProps` must return an object. Instead received %s.",r),r}var h=arguments.length<=3||void 0===arguments[3]?{}:arguments[3],g=Boolean(e),v=e||x,b=(0,_.default)(t)?(0,y.default)(t):t||T,C=n||E,A=v.length>1,k=b.length>1,R=h.pure,I=void 0===R||R,O=h.withRef,D=void 0!==O&&O,P=M++;return function(e){var t=function(t){function n(e,a){o(this,n);var s=i(this,t.call(this,e,a));return s.version=P,s.store=e.store||a.store,(0,S.default)(s.store,'Could not find "store" in either the context or props of "'+s.constructor.displayName+'". Either wrap the root component in a <Provider>, or explicitly pass "store" as a prop to "'+s.constructor.displayName+'".'),s.stateProps=r(s.store,e),s.dispatchProps=l(s.store,e),s.state={storeState:null},s.updateState(),s}return a(n,t),n.prototype.shouldComponentUpdate=function(e,t){if(!I)return this.updateStateProps(e),this.updateDispatchProps(e),this.updateState(e),!0;var n=t.storeState!==this.state.storeState,r=!(0,m.default)(e,this.props),o=!1,i=!1;return(n||r&&A)&&(o=this.updateStateProps(e)),r&&k&&(i=this.updateDispatchProps(e)),!!(r||o||i)&&(this.updateState(e),!0)},n.prototype.computeNextState=function(){var e=arguments.length<=0||void 0===arguments[0]?this.props:arguments[0];return d(this.stateProps,this.dispatchProps,e)},n.prototype.updateStateProps=function(){var e=arguments.length<=0||void 0===arguments[0]?this.props:arguments[0],t=r(this.store,e);return!(0,m.default)(t,this.stateProps)&&(this.stateProps=t,!0)},n.prototype.updateDispatchProps=function(){var e=arguments.length<=0||void 0===arguments[0]?this.props:arguments[0],t=l(this.store,e);return!(0,m.default)(t,this.dispatchProps)&&(this.dispatchProps=t,!0)},n.prototype.updateState=function(){var e=arguments.length<=0||void 0===arguments[0]?this.props:arguments[0];this.nextState=this.computeNextState(e)},n.prototype.isSubscribed=function(){return"function"==typeof this.unsubscribe},n.prototype.trySubscribe=function(){g&&!this.unsubscribe&&(this.unsubscribe=this.store.subscribe(this.handleChange.bind(this)),this.handleChange())},n.prototype.tryUnsubscribe=function(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null)},n.prototype.componentDidMount=function(){this.trySubscribe()},n.prototype.componentWillUnmount=function(){this.tryUnsubscribe()},n.prototype.handleChange=function(){this.unsubscribe&&this.setState({storeState:this.store.getState()})},n.prototype.getWrappedInstance=function(){return(0,S.default)(D,"To access the wrapped instance, you need to specify { withRef: true } as the fourth argument of the connect() call."),this.refs.wrappedInstance},n.prototype.render=function(){var t=D?"wrappedInstance":null;return f.default.createElement(e,u({},this.nextState,{ref:t}))},n}(c.Component);return t.displayName="Connect("+s(e)+")",t.WrappedComponent=e,t.contextTypes={store:p.default},t.propTypes={store:p.default},(0,w.default)(t,e)}}var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};t.__esModule=!0,t.default=l;var c=n(0),f=r(c),d=n(545),p=r(d),h=n(666),m=r(h),g=n(667),_=r(g),v=n(668),y=r(v),b=n(649),w=r(b),C=n(267),S=r(C),x=function(){return{}},T=function(e){return{dispatch:e}},E=function(e,t,n){return u({},n,e,t)},M=0},function(e,t,n){"use strict";function r(e,t){if(e===t)return!0;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(var o=Object.prototype.hasOwnProperty,i=0;i<n.length;i++)if(!o.call(t,n[i])||e[n[i]]!==t[n[i]])return!1;return!0}t.__esModule=!0,t.default=r},function(e,t,n){"use strict";function r(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}function o(e){if(!e||"object"!==(void 0===e?"undefined":r(e)))return!1;var t="function"==typeof e.constructor?Object.getPrototypeOf(e):Object.prototype;if(null===t)return!0;var n=t.constructor;return"function"==typeof n&&n instanceof n&&i(n)===i(Object)}t.__esModule=!0,t.default=o;var i=function(e){return Function.prototype.toString.call(e)}},function(e,t,n){"use strict";function r(e){return function(t){return(0,o.bindActionCreators)(e,t)}}t.__esModule=!0,t.default=r;var o=n(151)},function(e,t,n){function r(e){if("number"==typeof e)return e;if(i(e))return a;if(o(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=o(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(s,"");var n=u.test(e);return n||c.test(e)?f(e.slice(2),n?2:8):l.test(e)?a:+e}var o=n(175),i=n(436),a=NaN,s=/^\s+|\s+$/g,l=/^[-+]0x[0-9a-f]+$/i,u=/^0b[01]+$/i,c=/^0o[0-7]+$/i,f=parseInt;e.exports=r},function(e,t,n){var r,o;!function(i,a){r=a,void 0!==(o="function"==typeof r?r.call(t,n,t,e):r)&&(e.exports=o)}(0,function(){function e(e,t,n){return e<t?t:e>n?n:e}function t(e){return 100*(-1+e)}function n(e,n,r){var o;return o="translate3d"===u.positionUsing?{transform:"translate3d("+t(e)+"%,0,0)"}:"translate"===u.positionUsing?{transform:"translate("+t(e)+"%,0)"}:{"margin-left":t(e)+"%"},o.transition="all "+n+"ms "+r,o}function r(e,t){return("string"==typeof e?e:a(e)).indexOf(" "+t+" ")>=0}function o(e,t){var n=a(e),o=n+t;r(n,t)||(e.className=o.substring(1))}function i(e,t){var n,o=a(e);r(e,t)&&(n=o.replace(" "+t+" "," "),e.className=n.substring(1,n.length-1))}function a(e){return(" "+(e.className||"")+" ").replace(/\s+/gi," ")}function s(e){e&&e.parentNode&&e.parentNode.removeChild(e)}var l={};l.version="0.2.0";var u=l.settings={minimum:.08,easing:"ease",positionUsing:"",speed:200,trickle:!0,trickleRate:.02,trickleSpeed:800,showSpinner:!0,barSelector:'[role="bar"]',spinnerSelector:'[role="spinner"]',parent:"body",template:'<div class="bar" role="bar"><div class="peg"></div></div><div class="spinner" role="spinner"><div class="spinner-icon"></div></div>'};l.configure=function(e){var t,n;for(t in e)void 0!==(n=e[t])&&e.hasOwnProperty(t)&&(u[t]=n);return this},l.status=null,l.set=function(t){var r=l.isStarted();t=e(t,u.minimum,1),l.status=1===t?null:t;var o=l.render(!r),i=o.querySelector(u.barSelector),a=u.speed,s=u.easing;return o.offsetWidth,c(function(e){""===u.positionUsing&&(u.positionUsing=l.getPositioningCSS()),f(i,n(t,a,s)),1===t?(f(o,{transition:"none",opacity:1}),o.offsetWidth,setTimeout(function(){f(o,{transition:"all "+a+"ms linear",opacity:0}),setTimeout(function(){l.remove(),e()},a)},a)):setTimeout(e,a)}),this},l.isStarted=function(){return"number"==typeof l.status},l.start=function(){l.status||l.set(0);var e=function(){setTimeout(function(){l.status&&(l.trickle(),e())},u.trickleSpeed)};return u.trickle&&e(),this},l.done=function(e){return e||l.status?l.inc(.3+.5*Math.random()).set(1):this},l.inc=function(t){var n=l.status;return n?("number"!=typeof t&&(t=(1-n)*e(Math.random()*n,.1,.95)),n=e(n+t,0,.994),l.set(n)):l.start()},l.trickle=function(){return l.inc(Math.random()*u.trickleRate)},function(){var e=0,t=0;l.promise=function(n){return n&&"resolved"!==n.state()?(0===t&&l.start(),e++,t++,n.always(function(){t--,0===t?(e=0,l.done()):l.set((e-t)/e)}),this):this}}(),l.render=function(e){if(l.isRendered())return document.getElementById("nprogress");o(document.documentElement,"nprogress-busy");var n=document.createElement("div");n.id="nprogress",n.innerHTML=u.template;var r,i=n.querySelector(u.barSelector),a=e?"-100":t(l.status||0),c=document.querySelector(u.parent);return f(i,{transition:"all 0 linear",transform:"translate3d("+a+"%,0,0)"}),u.showSpinner||(r=n.querySelector(u.spinnerSelector))&&s(r),c!=document.body&&o(c,"nprogress-custom-parent"),c.appendChild(n),n},l.remove=function(){i(document.documentElement,"nprogress-busy"),i(document.querySelector(u.parent),"nprogress-custom-parent");var e=document.getElementById("nprogress");e&&s(e)},l.isRendered=function(){return!!document.getElementById("nprogress")},l.getPositioningCSS=function(){var e=document.body.style,t="WebkitTransform"in e?"Webkit":"MozTransform"in e?"Moz":"msTransform"in e?"ms":"OTransform"in e?"O":"";return t+"Perspective"in e?"translate3d":t+"Transform"in e?"translate":"margin"};var c=function(){function e(){var n=t.shift();n&&n(e)}var t=[];return function(n){t.push(n),1==t.length&&e()}}(),f=function(){function e(e){return e.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(e,t){return t.toUpperCase()})}function t(e){var t=document.body.style;if(e in t)return e;for(var n,r=o.length,i=e.charAt(0).toUpperCase()+e.slice(1);r--;)if((n=o[r]+i)in t)return n;return e}function n(n){return n=e(n),i[n]||(i[n]=t(n))}function r(e,t,r){t=n(t),e.style[t]=r}var o=["Webkit","O","Moz","ms"],i={};return function(e,t){var n,o,i=arguments;if(2==i.length)for(n in t)void 0!==(o=t[n])&&t.hasOwnProperty(n)&&r(e,n,o);else r(e,i[1],i[2])}}();return l})},function(e,t,n){var r=n(0),o=n(9),i=n(21),a=i.isClient();e.exports=r.createClass({displayName:"exports",propTypes:{customClass:r.PropTypes.string,placeholder:r.PropTypes.string,defaultValue:r.PropTypes.string,autoWidth:r.PropTypes.bool,tooltip:r.PropTypes.string},getInitialState:function(){return{inputWidth:this._getInputMinWidth(),value:this.props.defaultValue,inputValue:this.props.defaultValue,showTooltip:!1,focused:!1}},componentDidMount:function(){this._copyInputStyles(),this._updateInputWidth()},shouldComponentUpdate:function(e,t){return t!=this.state},componentDidUpdate:function(){this._updateInputWidth()},render:function(){var e=this.props,t={};this.state.inputWidth&&(t.width=this.state.inputWidth+"px");var n=this.state.showTooltip&&!this.state.focused?" active":"",o=e.readOnly;return r.createElement("div",{className:"span-input-wrap"},r.createElement("input",{className:e.customClass+" span-input",placeholder:e.placeholder||"输入",defaultValue:e.defaultValue||"石墨表格",readOnly:o,onChange:this._onChange,onBlur:this._onBlur,onFocus:o?null:this._onFocus,onKeyUp:this._onKeyUp,onKeyDown:this._onKeyDown,onMouseOver:this._onMouseOver,onMouseOut:this._onMouseOut,value:this.state.inputValue,style:t,maxLength:100,ref:"input"}),r.createElement("span",{ref:"input-pre",className:e.customClass+"-pre span-input-pre"},this.state.value),r.createElement("span",{className:"tooltip span-input-tooltip s-tooltip"+n},this.props.tooltip))},getValue:function(){return this.state.inputValue},setValue:function(e){this.setState({value:e,inputValue:e}),this._updateInputWidth()},_copyInputStyles:function(){if(this.isMounted()&&window.getComputedStyle){var e=window.getComputedStyle(this.refs.input),t=this.refs["input-pre"];t.style.fontSize=e.fontSize,t.style.fontFamily=e.fontFamily,t.style.fontWeight=e.fontWeight,t.style.fontStyle=e.fontStyle,t.style.letterSpacing=e.letterSpacing}},_updateInputWidth:function(){if(""===this.state.value&&this.props.placeholder)return void this.setState({value:this.props.placeholder});if(this.props.autoWidth&&this.isMounted()&&void 0!==this.refs["input-pre"].scrollWidth){var e=this.refs["input-pre"].scrollWidth+4,t=this._getInputMinWidth(),n=this._getInputMaxWidth();e<t?e=t:e>n&&(e=n),e!==this.state.inputWidth&&this.setState({inputWidth:e})}},_getInputMinWidth:function(){var e=parseInt(this.props.minWidth);return e=isNaN(e)?0:e},_getInputMaxWidth:function(){var e=parseInt(this.props.maxWidth);return e=isNaN(e)?9999999:e},_onChange:function(e){var t=this;this.setState({value:e.target.value,inputValue:e.target.value},function(){t.props.onChange&&t.props.onChange(),t._updateInputWidth()})},_onBlur:function(e){var t=this.props;""===this.state.inputValue&&t.placeholder?this.setState({inputValue:this.props.placeholder},function(){t.onBlur&&t.onBlur()}):t.onBlur&&t.onBlur(),this.setState({focused:!1}),a&&t.enableJsBridge&&o.notify("sheetTitleStatus",{status:"blur"})},_onFocus:function(e){"无标题"===e.target.value&&this.setState({inputValue:""});var t=this.props;this.setState({focused:!0},function(){t.onFocus&&t.onFocus()}),a&&this.props.enableJsBridge&&o.notify("sheetTitleStatus",{status:"focus"})},_onKeyUp:function(e){13==e.keyCode&&e.target.blur()},_onKeyDown:function(e){if((90===e.keyCode||89===e.keyCode)&&e.ctrlKey)return e.stopPropagation(),e.preventDefault(),!1},_onMouseOver:function(e){this.props.tooltip&&!this.state.showTooltip&&this.setState({showTooltip:!0})},_onMouseOut:function(e){this.props.tooltip&&this.state.showTooltip&&this.setState({showTooltip:!1})}})},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return f(e,t)};var o=n(151),i=n(437),a=r(i),s=n(673),l=(r(s),n(438)),u=r(l),c=[a.default,u.default],f=o.applyMiddleware.apply(void 0,c)(o.createStore);e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=i({},u.default,e),n=t.logger,r=t.transformer,o=t.stateTransformer,l=t.errorTransformer,c=t.predicate,f=t.logErrors,d=t.diffPredicate;if(void 0===n)return function(){return function(e){return function(t){return e(t)}}};if(r&&console.error("Option 'transformer' is deprecated, use 'stateTransformer' instead!"),e.getState&&e.dispatch)return console.error("[redux-logger] redux-logger not installed. Make sure to pass logger instance as middleware:\n\n// Logger with default options\nimport { logger } from 'redux-logger'\nconst store = createStore(\n  reducer,\n  applyMiddleware(logger)\n)\n\n\n// Or you can create your own logger with custom options http://bit.ly/redux-logger-options\nimport createLogger from 'redux-logger'\n\nconst logger = createLogger({\n  // ...options\n});\n\nconst store = createStore(\n  reducer,\n  applyMiddleware(logger)\n)\n"),function(){return function(e){return function(t){return e(t)}}};var p=[];return function(e){var n=e.getState;return function(e){return function(r){if("function"==typeof c&&!c(n,r))return e(r);var u={};p.push(u),u.started=s.timer.now(),u.startedTime=new Date,u.prevState=o(n()),u.action=r;var h=void 0;if(f)try{h=e(r)}catch(e){u.error=l(e)}else h=e(r);u.took=s.timer.now()-u.started,u.nextState=o(n());var m=t.diff&&"function"==typeof d?d(n,r):t.diff;if((0,a.printBuffer)(p,i({},t,{diff:m})),p.length=0,u.error)throw u.error;return h}}}}Object.defineProperty(t,"__esModule",{value:!0}),t.logger=t.defaults=void 0;var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=n(674),s=n(547),l=n(677),u=r(l),c=o();t.defaults=u.default,t.logger=c,t.default=o,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e,t,n,r){switch(void 0===e?"undefined":l(e)){case"object":return"function"==typeof e[r]?e[r].apply(e,o(n)):e[r];case"function":return e(t);default:return e}}function a(e){var t=e.timestamp,n=e.duration;return function(e,r,o){var i=["action"];return i.push("%c"+String(e.type)),t&&i.push("%c@ "+r),n&&i.push("%c(in "+o.toFixed(2)+" ms)"),i.join(" ")}}function s(e,t){var n=t.logger,r=t.actionTransformer,o=t.titleFormatter,s=void 0===o?a(t):o,l=t.collapsed,c=t.colors,d=t.level,p=t.diff;e.forEach(function(o,a){var h=o.started,m=o.startedTime,g=o.action,_=o.prevState,v=o.error,y=o.took,b=o.nextState,w=e[a+1];w&&(b=w.prevState,y=w.started-h);var C=r(g),S="function"==typeof l?l(function(){return b},g,o):l,x=(0,u.formatTime)(m),T=c.title?"color: "+c.title(C)+";":"",E=["color: gray; font-weight: lighter;"];E.push(T),t.timestamp&&E.push("color: gray; font-weight: lighter;"),t.duration&&E.push("color: gray; font-weight: lighter;");var M=s(C,x,y);try{S?c.title?n.groupCollapsed.apply(n,["%c "+M].concat(E)):n.groupCollapsed(M):c.title?n.group.apply(n,["%c "+M].concat(E)):n.group(M)}catch(e){n.log(M)}var A=i(d,C,[_],"prevState"),k=i(d,C,[C],"action"),R=i(d,C,[v,_],"error"),I=i(d,C,[b],"nextState");A&&(c.prevState?n[A]("%c prev state","color: "+c.prevState(_)+"; font-weight: bold",_):n[A]("prev state",_)),k&&(c.action?n[k]("%c action    ","color: "+c.action(C)+"; font-weight: bold",C):n[k]("action    ",C)),v&&R&&(c.error?n[R]("%c error     ","color: "+c.error(v,_)+"; font-weight: bold;",v):n[R]("error     ",v)),I&&(c.nextState?n[I]("%c next state","color: "+c.nextState(b)+"; font-weight: bold",b):n[I]("next state",b)),p&&(0,f.default)(_,b,n,S);try{n.groupEnd()}catch(e){n.log("—— log end ——")}})}Object.defineProperty(t,"__esModule",{value:!0});var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.printBuffer=s;var u=n(547),c=n(675),f=r(c)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e){return"color: "+c[e].color+"; font-weight: bold"}function a(e){var t=e.kind,n=e.path,r=e.lhs,o=e.rhs,i=e.index,a=e.item;switch(t){case"E":return[n.join("."),r,"→",o];case"N":return[n.join("."),o];case"D":return[n.join(".")];case"A":return[n.join(".")+"["+i+"]",a];default:return[]}}function s(e,t,n,r){var s=(0,u.default)(e,t);try{r?n.groupCollapsed("diff"):n.group("diff")}catch(e){n.log("diff")}s?s.forEach(function(e){var t=e.kind,r=a(e);n.log.apply(n,["%c "+c[t].text,i(t)].concat(o(r)))}):n.log("—— no diff ——");try{n.groupEnd()}catch(e){n.log("—— diff end —— ")}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=s;var l=n(676),u=r(l),c={E:{color:"#2196F3",text:"CHANGED:"},N:{color:"#4CAF50",text:"ADDED:"},D:{color:"#F44336",text:"DELETED:"},A:{color:"#2196F3",text:"ARRAY:"}};e.exports=t.default},function(e,t,n){(function(n){var r,o;!function(n,i){"use strict";r=[],void 0!==(o=function(){return i()}.apply(t,r))&&(e.exports=o)}(0,function(e){"use strict";function t(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}function r(e,t){Object.defineProperty(this,"kind",{value:e,enumerable:!0}),t&&t.length&&Object.defineProperty(this,"path",{value:t,enumerable:!0})}function o(e,t,n){o.super_.call(this,"E",e),Object.defineProperty(this,"lhs",{value:t,enumerable:!0}),Object.defineProperty(this,"rhs",{value:n,enumerable:!0})}function i(e,t){i.super_.call(this,"N",e),Object.defineProperty(this,"rhs",{value:t,enumerable:!0})}function a(e,t){a.super_.call(this,"D",e),Object.defineProperty(this,"lhs",{value:t,enumerable:!0})}function s(e,t,n){s.super_.call(this,"A",e),Object.defineProperty(this,"index",{value:t,enumerable:!0}),Object.defineProperty(this,"item",{value:n,enumerable:!0})}function l(e,t,n){var r=e.slice((n||t)+1||e.length);return e.length=t<0?e.length+t:t,e.push.apply(e,r),e}function u(e){var t=typeof e;return"object"!==t?t:e===Math?"math":null===e?"null":Array.isArray(e)?"array":"[object Date]"===Object.prototype.toString.call(e)?"date":void 0!==e.toString&&/^\/.*\//.test(e.toString())?"regexp":"object"}function c(t,n,r,f,d,p,h){d=d||[];var m=d.slice(0);if(void 0!==p){if(f){if("function"==typeof f&&f(m,p))return;if("object"==typeof f){if(f.prefilter&&f.prefilter(m,p))return;if(f.normalize){var g=f.normalize(m,p,t,n);g&&(t=g[0],n=g[1])}}}m.push(p)}"regexp"===u(t)&&"regexp"===u(n)&&(t=t.toString(),n=n.toString());var _=typeof t,v=typeof n;if("undefined"===_)"undefined"!==v&&r(new i(m,n));else if("undefined"===v)r(new a(m,t));else if(u(t)!==u(n))r(new o(m,t,n));else if("[object Date]"===Object.prototype.toString.call(t)&&"[object Date]"===Object.prototype.toString.call(n)&&t-n!=0)r(new o(m,t,n));else if("object"===_&&null!==t&&null!==n){if(h=h||[],h.indexOf(t)<0){if(h.push(t),Array.isArray(t)){var y;t.length;for(y=0;y<t.length;y++)y>=n.length?r(new s(m,y,new a(e,t[y]))):c(t[y],n[y],r,f,m,y,h);for(;y<n.length;)r(new s(m,y,new i(e,n[y++])))}else{var b=Object.keys(t),w=Object.keys(n);b.forEach(function(o,i){var a=w.indexOf(o);a>=0?(c(t[o],n[o],r,f,m,o,h),w=l(w,a)):c(t[o],e,r,f,m,o,h)}),w.forEach(function(t){c(e,n[t],r,f,m,t,h)})}h.length=h.length-1}}else t!==n&&("number"===_&&isNaN(t)&&isNaN(n)||r(new o(m,t,n)))}function f(t,n,r,o){return o=o||[],c(t,n,function(e){e&&o.push(e)},r),o.length?o:e}function d(e,t,n){if(n.path&&n.path.length){var r,o=e[t],i=n.path.length-1;for(r=0;r<i;r++)o=o[n.path[r]];switch(n.kind){case"A":d(o[n.path[r]],n.index,n.item);break;case"D":delete o[n.path[r]];break;case"E":case"N":o[n.path[r]]=n.rhs}}else switch(n.kind){case"A":d(e[t],n.index,n.item);break;case"D":e=l(e,t);break;case"E":case"N":e[t]=n.rhs}return e}function p(e,t,n){if(e&&t&&n&&n.kind){for(var r=e,o=-1,i=n.path?n.path.length-1:0;++o<i;)void 0===r[n.path[o]]&&(r[n.path[o]]="number"==typeof n.path[o]?[]:{}),r=r[n.path[o]];switch(n.kind){case"A":d(n.path?r[n.path[o]]:r,n.index,n.item);break;case"D":delete r[n.path[o]];break;case"E":case"N":r[n.path[o]]=n.rhs}}}function h(e,t,n){if(n.path&&n.path.length){var r,o=e[t],i=n.path.length-1;for(r=0;r<i;r++)o=o[n.path[r]];switch(n.kind){case"A":h(o[n.path[r]],n.index,n.item);break;case"D":case"E":o[n.path[r]]=n.lhs;break;case"N":delete o[n.path[r]]}}else switch(n.kind){case"A":h(e[t],n.index,n.item);break;case"D":case"E":e[t]=n.lhs;break;case"N":e=l(e,t)}return e}function m(e,t,n){if(e&&t&&n&&n.kind){var r,o,i=e;for(o=n.path.length-1,r=0;r<o;r++)void 0===i[n.path[r]]&&(i[n.path[r]]={}),i=i[n.path[r]];switch(n.kind){case"A":h(i[n.path[r]],n.index,n.item);break;case"D":case"E":i[n.path[r]]=n.lhs;break;case"N":delete i[n.path[r]]}}}function g(e,t,n){if(e&&t){c(e,t,function(r){n&&!n(e,t,r)||p(e,t,r)})}}var _,v,y=[];return _="object"==typeof n&&n?n:"undefined"!=typeof window?window:{},v=_.DeepDiff,v&&y.push(function(){void 0!==v&&_.DeepDiff===f&&(_.DeepDiff=v,v=e)}),t(o,r),t(i,r),t(a,r),t(s,r),Object.defineProperties(f,{diff:{value:f,enumerable:!0},observableDiff:{value:c,enumerable:!0},applyDiff:{value:g,enumerable:!0},applyChange:{value:p,enumerable:!0},revertChange:{value:m,enumerable:!0},isConflict:{value:function(){return void 0!==v},enumerable:!0},noConflict:{value:function(){return y&&(y.forEach(function(e){e()}),y=null),f},enumerable:!0}}),f})}).call(t,n(36))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={level:"log",logger:console,logErrors:!0,collapsed:void 0,predicate:void 0,duration:!1,timestamp:!0,stateTransformer:function(e){return e},actionTransformer:function(e){return e},errorTransformer:function(e){return e},colors:{title:function(){return"inherit"},prevState:function(){return"#9E9E9E"},action:function(){return"#03A9F4"},nextState:function(){return"#4CAF50"},error:function(){return"#F20404"}},diff:!1,diffPredicate:void 0,transformer:void 0},e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e,t){return t._name=e,h[e]=t,t}Object.defineProperty(t,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.register=s;var c=n(0),f=r(c),d=n(345),p=r(d),h={},m=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleCloseClick=n.handleCloseClick.bind(n),n}return a(t,e),u(t,null,[{key:"propTypes",get:function(){return{popModal:c.PropTypes.func.isRequired,cleanModals:c.PropTypes.func.isRequired,modals:c.PropTypes.arrayOf(c.PropTypes.shape({name:c.PropTypes.string,params:c.PropTypes.object})).isRequired}}}]),u(t,[{key:"handleCloseClick",value:function(e){var t=e.target.dataset.modal;"clean"===t?this.props.cleanModals():"pop"===t&&this.props.popModal()}},{key:"renderModalComponent",value:function(){if(0!==this.props.modals.length){var e=this.props.modals[0],t=e.name,n=e.params,r=h[t],o=(0,p.default)({},this.props,n);return f.default.createElement("div",{className:"shimo-modal-overlay","data-modal":"clean"},f.default.createElement(r,l({},o,{params:n})))}}},{key:"render",value:function(){return f.default.createElement("div",{className:"modal-root",onClick:this.handleCloseClick},this.renderModalComponent())}}]),t}(c.Component);t.default=m},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=r(u),f=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),l(t,[{key:"componentDidMount",value:function(){this.calcModalPosition()}},{key:"componentWillReceiveProps",value:function(){var e=this;setTimeout(function(){return e.calcModalPosition()},50)}},{key:"calcModalPosition",value:function(){var e=this.refs.modal,t=e.offsetWidth,n=e.offsetHeight;this.refs.modal.style.marginLeft=-t/2+"px",this.refs.modal.style.marginTop=-n/2+"px"}},{key:"render",value:function(){var e=this.props,t=c.default.Children.toArray(e.children),n=s(t,2),r=n[0],o=n[1];return c.default.createElement("div",{className:"shimo-modal",style:e.style,ref:"modal"},c.default.createElement("div",{className:"shimo-modal-header"},c.default.createElement("span",null,e.title),c.default.createElement("span",{className:"dialog-close-icon","data-modal":"clean"})),c.default.createElement("div",{className:"shimo-modal-content",style:e.contentStyle},r),o&&c.default.createElement("div",{className:"shimo-modal-footer"},o))}}],[{key:"propTypes",get:function(){return{title:u.PropTypes.string.isRequired,style:u.PropTypes.object,contentStyle:u.PropTypes.object}}}]),t}(u.Component);t.default=f,e.exports=t.default},function(e,t){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1];switch(t.type){case"@@modal/PUSH_MODAL":return[].concat(e,t.payload);case"@@modal/POP_MODAL":return[].concat(e.slice(0,-1));case"@@modal/CLEAN_MODALS":return[];default:return e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n,e.exports=t.default},function(e,t,n){(function(r,o){function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),f=n(0),d=i(f),p=n(51),h=i(p),m=n(144),g=n(189),_=i(g),v=n(190),y=n(682),b=i(y),w=0,C={},S=function(e){var t=e.index,n=e.duration,r=e.price,o=e.active,i=e.originPrice,a=e.discount,s=e.loading,l=e.onClick;return d.default.createElement("div",{className:o?"option-outer-border active":"option-outer-border",onClick:function(){l(t)}},s||0===r?d.default.createElement("div",{className:"option"},d.default.createElement("div",{className:"year"},n),d.default.createElement("div",{className:"price"},"正在获取价格...")):d.default.createElement("div",{className:"option"},d.default.createElement("div",{className:"year"},n),d.default.createElement("div",{className:"price"},"¥"," ",r," ","/"," ","人",i&&a?d.default.createElement("span",{className:"origin-price"},"¥ ",i):null),a?d.default.createElement("div",{className:"discount "+a}):null))};S.propTypes={index:f.PropTypes.number,duration:f.PropTypes.string,price:f.PropTypes.oneOfType([f.PropTypes.string,f.PropTypes.number]),active:f.PropTypes.bool,originPrice:f.PropTypes.oneOfType([f.PropTypes.string,f.PropTypes.number]),discount:f.PropTypes.string,loading:f.PropTypes.bool,onClick:f.PropTypes.func};var x=function(e){var t=e.id,n=e.icon,r=e.text,o=e.active,i=e.onClick;return d.default.createElement("div",{onClick:function(){i(t)},className:o?"option-outer-border active":"option-outer-border"},d.default.createElement("div",{className:"option "+n},r))};x.propTypes={id:f.PropTypes.number,icon:f.PropTypes.string,text:f.PropTypes.string,active:f.PropTypes.bool,onClick:f.PropTypes.func};var T=function(e){var t=e.children,n=e.checked,r=e.onClick;return d.default.createElement("div",{className:"checkbox noselect "+(n?"checked":"")},d.default.createElement("span",{onClick:r},t))};T.propTypes={checked:f.PropTypes.bool,onClick:f.PropTypes.func};var E=[{index:0,month:3,text:"3 个月"},{index:1,month:12,text:"1 年"},{index:2,month:24,text:"2 年"}],M=function(e){function t(e){a(this,t);var n=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=e.data.memberCount||0,o={memberCount:r,recentMembersCount:0,unitPrice:216,quantity:{min:5,realValue:r,value:r,error:null},price:{selectedIndex:1,real:[0,0,0],original:[0,0,0],loading:!1},payment:{selectedId:1},agree:{checked:!1,error:!1},ajaxError:null,loadingDuringSubmitting:!1},i=e.data.purchase?e.data.purchase:{quantity:null};return n.state=u({},o,i,{quantity:u({},o.quantity,i.quantity),loadingDuringSubmitting:!1,showRecentMembers:!1}),n.onQuantityChange=n.onQuantityChange.bind(n),n.onPriceChange=n.onPriceChange.bind(n),n.onPaymentChange=n.onPaymentChange.bind(n),n.onAgreeChange=n.onAgreeChange.bind(n),n.onSubmit=n.onSubmit.bind(n),n.ajaxRetry=n.ajaxRetry.bind(n),n.renderContent=n.renderContent.bind(n),n.hideRecentMembers=n.hideRecentMembers.bind(n),n.renderRecentMembers=n.renderRecentMembers.bind(n),n.showRecentMembers=n.showRecentMembers.bind(n),n}return l(t,e),c(t,null,[{key:"propTypes",get:function(){return{onClose:f.PropTypes.func,open:f.PropTypes.bool,data:f.PropTypes.object,onNext:f.PropTypes.func,type:f.PropTypes.string,getRecentMembersCount:f.PropTypes.func,currentUser:f.PropTypes.object,team:f.PropTypes.object}}},{key:"defaultProps",get:function(){return{onClose:function(){},open:!1}}}]),c(t,[{key:"componentDidMount",value:function(){this.getSumPrice(),this.getRecentMembersCount()}},{key:"componentWillReceiveProps",value:function(e){var t=e.data.memberCount;this.setState({memberCount:t,quantity:u({},this.state.quantity,{value:t,realValue:t,error:this.checkMemberCount(t)})})}},{key:"componentDidUpdate",value:function(e,t){t.quantity.realValue===this.state.quantity.realValue&&t.quantity.error===this.state.quantity.error||this.getSumPrice()}},{key:"ajaxRetry",value:function(e){for(var t=this,n=arguments.length,r=Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return function(){t[e].apply(t,r)}}},{key:"calculateSumPrice",value:function(e,t,n){Promise.all(E.map(function(t){return(0,m.ajaxGet)("/smapi/orders/action/calculate?type=team&duration="+t.month+"&memberCount="+e+"&detail=1")})).then(function(n){var r=n.map(function(e){return(0,v.getAmount)(e.data.real)}),o=n.map(function(e){return(0,v.getAmount)(e.data.original)});"function"==typeof t&&t(e,r,o)}).catch(function(){"function"==typeof n&&n(e)})}},{key:"getSumPrice",value:function(){var e=this,t=this.state.quantity.realValue;if(!(t<=0)){var n=t===this.state.quantity.min||C[t]?0:800;n>0&&this.setState({price:u({},this.state.price,{loading:!0})}),setTimeout(function(){if(w===t){var n=C[t];n?e.setState({price:u({},e.state.price,{real:n.real,original:n.original,loading:!1}),ajaxError:null}):e.calculateSumPrice(t,function(t,n,r){e.state.quantity.error||(C[t]={real:n,original:r},e.state.quantity.realValue===t&&e.setState({price:u({},e.state.price,{real:n,original:r,loading:!1}),ajaxError:null}))},function(){e.setState({price:u({},e.state.price),ajaxError:{functionName:"getSumPrice",functionParams:[]}})})}else w=t,e.getSumPrice()},n)}}},{key:"checkMemberCount",value:function(e){var t=this.state.quantity;return isNaN(e)?"请输入数字":r.isInteger(e)?e<0?"请输入正整数":e<r.max([t.min,this.state.memberCount])?e<t.min?"最少购买 "+t.min+" 人":"不可小于当前企业人数 "+this.state.memberCount:null:"请输入整数"}},{key:"onQuantityChange",value:function(e){var t=this,n=(0,v.allowNumber)(e.target.value);null===this.checkMemberCount(n)?this.setState({quantity:u({},this.state.quantity,{value:n,realValue:n,error:null})}):(this.setState({quantity:u({},this.state.quantity,{value:n})}),setTimeout(function(){var n=(0,v.allowNumber)(e.target.value),r=t.checkMemberCount(n);null!==r&&t.setState({quantity:u({},t.state.quantity,{error:r})})},1e3))}},{key:"onPriceChange",value:function(e){var t=this.state.price;this.setState({price:u({},t,{selectedIndex:e})})}},{key:"onPaymentChange",value:function(e){var t=this.state.payment;this.setState({payment:u({},t,{selectedId:e})})}},{key:"onAgreeChange",value:function(){var e=this.state.agree;this.setState({agree:u({},e,{checked:!e.checked,error:!1})})}},{key:"navTo",value:function(e,t){var r=this,o=E[this.state.price.selectedIndex].month,i=this.state.quantity.realValue,a=(0,_.default)(e).when("alipay-qrcode","alipay_qr").when("waiting-pay","upacp").when("transfers-inventory","offline").done(),s=(0,_.default)(e).when("alipay-qrcode",{type:"team",duration:o,channel:a,member_count:i}).when("waiting-pay",{type:"team",duration:o,channel:a,member_count:i}).when("transfers-inventory",{skip_charge:1,duration:o,member_count:i,type:"team",channel:a}).done();this.setState({loadingDuringSubmitting:!0}),(0,m.ajaxPost)("/orders/create",s).then(function(o){if("alipay-qrcode"===e)r.props.onNext(e,u({},t,o.data,{purchase:r.state,needRefresh:!0}));else if("waiting-pay"===e)n.e(2).then(function(r){n(546).createPayment(o.data.charge,function(n){"success"===n?this.props.onNext(e,u({},t,o.data,{needRefresh:!0})):"fail"===n?this.setState({ajaxError:{functionName:"navTo",functionParams:[e,t]},loadingDuringSubmitting:!1}):"cancel"===n&&this.setState({ajaxError:{functionName:"navTo",functionParams:[e,t]},loadingDuringSubmitting:!1})})}.bind(null,n)).catch(n.oe);else{if("transfers-inventory"!==e)throw new Error("Unknown nextPage: "+e);r.props.onNext(e,u({},t,o.data,{needRefresh:!0}))}}).catch(function(){r.setState({ajaxError:{functionName:"navTo",functionParams:[e,t]},loadingDuringSubmitting:!1})})}},{key:"onSubmit",value:function(e){var t=this;return function(){var n=t.state,r=n.payment,o=n.agree;e?1===r.selectedId?t.navTo("alipay-qrcode"):2===r.selectedId?t.navTo("waiting-pay"):3===r.selectedId&&t.navTo("transfers-inventory"):o.checked||t.setState({agree:u({},o,{error:!0})})}}},{key:"showRecentMembers",value:function(){this.setState({showRecentMembers:!0})}},{key:"hideRecentMembers",value:function(){this.setState({showRecentMembers:!1})}},{key:"getRecentMembersCount",value:function(){var e=this;o.get("/smapi/teams/mine/members/recent_count").then(function(t){0===t.code&&e.setState({recentMembersCount:t.data})})}},{key:"renderRecentMembers",value:function(){return d.default.createElement(b.default,{onClose:this.hideRecentMembers})}},{key:"renderContent",value:function(){var e=this.state,t=e.quantity,n=e.price,r=e.payment,i=e.agree,a=e.unitPrice,s=e.ajaxError,l=e.loadingDuringSubmitting,u=document.getElementById("enterprise-payment-purchase-input"),c=Math.floor(216),f=Math.floor(388.8),p=n.loading,h=n.real[n.selectedIndex],m=this.props.type,g=!t.error&&u&&Number(u.value)>=t.min&&i.checked&&!p,v=this.props.team||window.cow.currentUser.team||this.props.currentUser.team;return d.default.createElement("div",{className:"purchase"},d.default.createElement("div",{className:"crumb-list"},d.default.createElement("span",{className:"crumb"},"确认订单"),d.default.createElement("span",{className:"hicon icon-breadcrumb"}),d.default.createElement("span",{className:"no-crumb"},"付款"),d.default.createElement("span",{className:"hicon icon-breadcrumb"}),d.default.createElement("span",{className:"no-crumb"},"填写发票信息")),(0,_.default)(m).when("supplementary",d.default.createElement("div",{className:"field first expired-time"},d.default.createElement("header",null,"当前企业版到期时间"),d.default.createElement("div",{className:"text"},"2017 / 07 / 12"))).others(null).done(),(0,_.default)(m).when("supplementary",null).others(d.default.createElement("div",{className:"field price-options"},d.default.createElement("header",null,"购买时长"),d.default.createElement("div",{className:"options-wrapper"},d.default.createElement(S,{index:0,active:0===n.selectedIndex,duration:E[0].text,price:54,onClick:this.onPriceChange,loading:!1}),d.default.createElement(S,{index:1,active:1===n.selectedIndex,duration:E[1].text,price:c,originPrice:216,onClick:this.onPriceChange,loading:!1}),d.default.createElement(S,{index:2,active:2===n.selectedIndex,duration:E[2].text,price:f,originPrice:432,discount:"nine",onClick:this.onPriceChange,loading:!1})))).done(),d.default.createElement("div",{className:"field quantity "+(0,_.default)(m).when("supplementary","").others("first").done()},d.default.createElement("header",null,"购买席位数"),d.default.createElement("div",{className:"input",onClick:function(){return o("#enterprise-payment-purchase-input").select()}},(0,_.default)(m).when("supplementary",d.default.createElement("label",{className:"placeholder"},a," 元 / 人")).done(),t.error?d.default.createElement("label",{className:"error"},t.error):null,d.default.createElement("input",{id:"enterprise-payment-purchase-input",type:"text",maxLength:"3",onChange:this.onQuantityChange,value:t.value})),v.dingtalkCorp?null:d.default.createElement("div",{className:"purchase-seatTips"},"您的企业最近有 ",d.default.createElement("span",{className:"count",onClick:this.showRecentMembers},this.state.recentMembersCount,"人"),"  使用石墨文档，推荐您购买 ",this.state.recentMembersCount+5," 席位")),d.default.createElement("div",{className:"field payment-options"},d.default.createElement("header",null,"支付方式"),d.default.createElement("div",{className:"options-wrapper"},d.default.createElement(x,{id:1,icon:"alipay",text:"支付宝",active:1===r.selectedId,onClick:this.onPaymentChange}),d.default.createElement(x,{id:3,icon:"transfers",text:"对公转账",active:3===r.selectedId,onClick:this.onPaymentChange}))),d.default.createElement("div",{className:"field sum-price"},d.default.createElement("div",{className:"sum-price-title"},"总计："),p?d.default.createElement("div",{className:"sum-price-number-loading"},"正在获取价格..."):d.default.createElement("div",{className:"sum-price-number"},"¥"," ",h,".00")),d.default.createElement("div",{className:"field agree"},s?d.default.createElement("span",{className:"error"},"网络异常，请重试"):i.error?d.default.createElement("span",{className:"error"},"请勾选同意"):null,d.default.createElement(T,{checked:i.checked,onClick:this.onAgreeChange},"我已阅读并同意签署",d.default.createElement("a",{target:"_blank",href:"https://shimo.im/agreement"},"《服务协议》"))),l?d.default.createElement("div",{className:"fluid-submit-button"},"...跳转中"):d.default.createElement("div",{className:"fluid-submit-button "+(g?"enabled":""),onClick:this.onSubmit(g)},p?"正在获取价格...":"下一步"))}},{key:"render",value:function(){var e=this.props.type,t=(0,_.default)(e).when("renew","续约企业版").when("supplementary","补充席位").others("购买企业版").done();return this.state.showRecentMembers?d.default.createElement(h.default,{key:"1",ref:"flatDialog",customClass:"purchase-recentMembers",title:"最近使用石墨文档的成员",open:this.props.open,onClose:this.hideRecentMembers,bodyTpl:this.renderRecentMembers}):d.default.createElement(h.default,{key:"2",customClass:"purchase-dialog"+(this.props.data.loading?" purchase-loading":""),ref:"flatDialog",title:t,hasCloseButton:!0,onClose:this.props.onClose,open:this.props.open,enableCloseClickMask:!1,bodyTpl:this.renderContent})}}]),t}(f.Component);t.default=M,e.exports=t.default}).call(t,n(1),n(2))},function(e,t,n){(function(r){function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=o(u),f=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={recentMembers:[]},n.close=n.close.bind(n),n}return s(t,e),l(t,null,[{key:"propTypes",get:function(){return{onClose:u.PropTypes.func}}}]),l(t,[{key:"componentDidMount",value:function(){var e=this;r.get("/smapi/teams/mine/members/recent").then(function(t){0===t.code&&e.setState({recentMembers:t.data})})}},{key:"close",value:function(){this.props.onClose()}},{key:"render",value:function(){return c.default.createElement("div",{className:"recentMembersList"},c.default.createElement("div",{className:"member-header"},c.default.createElement("div",{className:"header-member"},"成员"),c.default.createElement("div",{className:"header-email"},"邮箱"),c.default.createElement("div",{className:"header-lastVisit"},"上次登陆时间")),this.state.recentMembers.map(function(e){return c.default.createElement("div",{key:e.id,className:"row"},c.default.createElement("div",{className:"avatarAndName"},c.default.createElement("img",{className:"avatar",src:e.avatar,alt:""}),c.default.createElement("div",{className:"name"},e.name)),c.default.createElement("div",{className:"email"},e.email),c.default.createElement("div",{className:"lastVisit"},e.last_visit.slice(0,-14).replace(/-/g,"/")))}),c.default.createElement("div",{className:"bottom"},c.default.createElement("div",{className:"submit-button enabled",onClick:this.close},"知道了")))}}]),t}(c.default.Component);t.default=f,e.exports=t.default}).call(t,n(2))},function(e,t,n){(function(r,o){function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),f=n(0),d=i(f),p=n(51),h=i(p),m=n(144),g=n(189),_=i(g),v=n(190),y=0,b={},w=function(e){var t=e.index,n=e.duration,r=e.price,o=e.active,i=e.originPrice,a=e.discount,s=e.loading,l=e.onClick;return d.default.createElement("div",{className:o?"option-outer-border active":"option-outer-border",onClick:function(){l(t)}},s||0===r?d.default.createElement("div",{className:"option"},d.default.createElement("div",{className:"year"},n),d.default.createElement("div",{className:"price"},"正在获取价格...")):d.default.createElement("div",{className:"option"},d.default.createElement("div",{className:"year"},n),d.default.createElement("div",{className:"price"},"¥"," ",r," ","/"," ","人",i&&a?d.default.createElement("span",{className:"origin-price"},"¥ ",i):null),a?d.default.createElement("div",{className:"discount "+a}):null))};w.propTypes={index:f.PropTypes.number,duration:f.PropTypes.string,price:f.PropTypes.oneOfType([f.PropTypes.string,f.PropTypes.number]),active:f.PropTypes.bool,originPrice:f.PropTypes.oneOfType([f.PropTypes.string,f.PropTypes.number]),discount:f.PropTypes.string,loading:f.PropTypes.bool,onClick:f.PropTypes.func};var C=function(e){var t=e.id,n=e.icon,r=e.text,o=e.active,i=e.onClick;return d.default.createElement("div",{onClick:function(){i(t)},className:o?"option-outer-border active":"option-outer-border"},d.default.createElement("div",{className:"option "+n},r))};C.propTypes={id:f.PropTypes.number,icon:f.PropTypes.string,text:f.PropTypes.string,active:f.PropTypes.bool,onClick:f.PropTypes.func};var S=function(e){var t=e.children,n=e.checked,r=e.onClick;return d.default.createElement("div",{className:"checkbox noselect "+(n?"checked":"")},d.default.createElement("span",{onClick:r},t))};S.propTypes={checked:f.PropTypes.bool,onClick:f.PropTypes.func};var x=[{index:1,month:12,text:"1 年"},{index:2,month:24,text:"2 年"}],T=function(e){function t(e){a(this,t);var n=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=e.data.memberCount||0,o={memberCount:r,quantity:{min:5,value:r,realValue:r,error:null},price:{selectedIndex:0,real:[0,0],original:[0,0],sum:[0,0],loading:!1},payment:{selectedId:1},agree:{checked:!1,error:!1},ajaxError:null,loadingDuringSubmitting:!1},i=e.data.purchase?u({},e.data.purchase,{quantity:{value:e.data.purchase.quantity.realValue+e.data.memberCount,realValue:e.data.purchase.quantity.realValue+e.data.memberCount}}):{quantity:null};return n.state=u({},o,i,{quantity:u({},o.quantity,i.quantity),loadingDuringSubmitting:!1}),n.onQuantityChange=n.onQuantityChange.bind(n),n.onPriceChange=n.onPriceChange.bind(n),n.onPaymentChange=n.onPaymentChange.bind(n),n.onAgreeChange=n.onAgreeChange.bind(n),n.onSubmit=n.onSubmit.bind(n),n.ajaxRetry=n.ajaxRetry.bind(n),n.renderContent=n.renderContent.bind(n),n}return l(t,e),c(t,null,[{key:"propTypes",get:function(){return{data:f.PropTypes.object,onNext:f.PropTypes.func,onClose:f.PropTypes.func,open:f.PropTypes.bool}}},{key:"defaultProps",get:function(){return{onClose:function(){},open:!1}}}]),c(t,[{key:"componentDidMount",value:function(){this.getSumPrice()}},{key:"componentWillReceiveProps",value:function(e){var t=e.data.memberCount;this.setState({memberCount:t,quantity:u({},this.state.quantity,{value:t,realValue:t,error:this.checkMemberCount(t)})})}},{key:"componentDidUpdate",value:function(e,t){t.quantity.realValue===this.state.quantity.realValue&&t.quantity.error===this.state.quantity.error||this.getSumPrice()}},{key:"ajaxRetry",value:function(e){for(var t=this,n=arguments.length,r=Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return function(){t[e].apply(t,r)}}},{key:"calculateSumPrice",value:function(e,t,n){var r=this;Promise.all(x.map(function(t){return(0,m.ajaxGet)("/smapi/orders/action/calculate?type=team&duration="+t.month+"&memberCount="+e+"&detail=1")})).then(function(n){var o=n.map(function(e){return Math.floor((0,v.getAmount)(e.data.real/r.state.quantity.realValue))}),i=n.map(function(e){return Math.floor((0,v.getAmount)(e.data.original/r.state.quantity.realValue))}),a=n.map(function(e){return(0,v.getAmount)(e.data.real)});"function"==typeof t&&t(e,o,i,a)}).catch(function(){"function"==typeof n&&n(e)})}},{key:"getSumPrice",value:function(){var e=this,t=this.state.quantity.realValue-this.state.memberCount,n=0===t||b[t]?0:800;n>0&&this.setState({price:u({},this.state.price,{loading:!0})}),setTimeout(function(){if(y===t){var n=b[t];n?e.setState({price:u({},e.state.price,{real:n.real,original:n.original,sum:n.sum,loading:!1}),ajaxError:null}):e.calculateSumPrice(t,function(t,n,r,o){e.state.quantity.error||(b[t]={real:n,original:r,sum:o},e.state.quantity.realValue-e.state.memberCount===t&&e.setState({price:u({},e.state.price,{real:n,original:r,sum:o,loading:!1}),ajaxError:null}))},function(){e.setState({price:u({},e.state.price),ajaxError:{functionName:"getSumPrice",functionParams:[]}})})}else y=t,e.getSumPrice()},n)}},{key:"checkMemberCount",value:function(e){var t=this.state.quantity;return isNaN(e)?"请输入数字":r.isInteger(e)?e<0?"请输入正整数":e<r.max([t.min,this.state.memberCount])?e<t.min?"最少购买 "+t.min+" 人":"不可小于当前企业席位数 "+this.state.memberCount:null:"请输入整数"}},{key:"onQuantityChange",value:function(e){var t=this,n=(0,v.allowNumber)(e.target.value);null===this.checkMemberCount(n)?this.setState({quantity:u({},this.state.quantity,{value:n,realValue:n,error:null})}):(this.setState({quantity:u({},this.state.quantity,{value:n})}),setTimeout(function(){var n=(0,v.allowNumber)(e.target.value),r=t.checkMemberCount(n);null!==r&&t.setState({quantity:u({},t.state.quantity,{error:r})})},1e3))}},{key:"onPriceChange",value:function(e){var t=this.state.price;this.setState({price:u({},t,{selectedIndex:e})})}},{key:"onPaymentChange",value:function(e){var t=this.state.payment;this.setState({payment:u({},t,{selectedId:e})})}},{key:"onAgreeChange",value:function(){var e=this.state.agree;this.setState({agree:u({},e,{checked:!e.checked,error:!1})})}},{key:"navTo",value:function(e,t){var r=this,o=x[this.state.price.selectedIndex].month,i=this.state.quantity.realValue,a=this.state.memberCount,s=(0,_.default)(e).when("alipay-qrcode","alipay_qr").when("waiting-pay","upacp").when("transfers-inventory","offline").done(),l=(0,_.default)(e).when("alipay-qrcode",{type:"team",duration:o,channel:s,member_count:i-a}).when("waiting-pay",{type:"team",duration:o,channel:s,member_count:i-a}).when("transfers-inventory",{skip_charge:1,duration:o,member_count:i-a,type:"team",channel:s}).done();this.setState({loadingDuringSubmitting:!0}),(0,m.ajaxPost)("/orders/create",l).then(function(o){if("alipay-qrcode"===e)r.props.onNext(e,u({},t,o.data,{purchase:u({},r.state,{quantity:{realValue:r.state.quantity.realValue-r.state.memberCount,value:r.state.quantity.realValue-r.state.memberCount}}),needRefresh:!0}));else if("waiting-pay"===e)n.e(2).then(function(r){n(546).createPayment(o.data.charge,function(n){"success"===n?this.props.onNext(e,u({},t,o.data,{needRefresh:!0})):"fail"===n?this.setState({ajaxError:{functionName:"navTo",functionParams:[e,t]},loadingDuringSubmitting:!1}):"cancel"===n&&this.setState({ajaxError:{functionName:"navTo",functionParams:[e,t]},loadingDuringSubmitting:!1})})}.bind(null,n)).catch(n.oe);else{if("transfers-inventory"!==e)throw new Error("Unknown nextPage: "+e);r.props.onNext(e,u({},t,o.data,{needRefresh:!0}))}}).catch(function(){r.setState({ajaxError:{functionName:"navTo",functionParams:[e,t]},loadingDuringSubmitting:!1})})}},{key:"onSubmit",value:function(e){var t=this;return function(){var n=t.state,r=n.payment,o=n.agree;e?1===r.selectedId?t.navTo("alipay-qrcode"):2===r.selectedId?t.navTo("waiting-pay"):3===r.selectedId&&t.navTo("transfers-inventory"):o.checked||t.setState({agree:u({},o,{error:!0})})}}},{key:"renderContent",value:function(){var e=this.state,t=e.quantity,n=e.price,r=e.payment,i=e.agree,a=e.ajaxError,s=e.loadingDuringSubmitting,l=document.getElementById("enterprise-payment-purchase-input"),u=n.real[0],c=n.real[1],f=n.loading,p=n.original[0],h=n.original[1],m=n.sum[n.selectedIndex],g=!t.error&&l&&Number(l.value)>=t.min&&i.checked&&!f;return d.default.createElement("div",{id:"renew",className:"purchase"},d.default.createElement("div",{className:"crumb-list"},d.default.createElement("span",{className:"crumb"},"确认订单"),d.default.createElement("span",{className:"hicon icon-breadcrumb"}),d.default.createElement("span",{className:"no-crumb"},"付款"),d.default.createElement("span",{className:"hicon icon-breadcrumb"}),d.default.createElement("span",{className:"no-crumb"},"填写发票信息")),d.default.createElement("div",{className:"field price-options"},d.default.createElement("header",null,"续约时长"),d.default.createElement("div",{className:"options-wrapper"},d.default.createElement(w,{index:0,active:0===n.selectedIndex,duration:x[0].text,price:u,originPrice:p,loading:f,onClick:this.onPriceChange}),d.default.createElement(w,{index:1,active:1===n.selectedIndex,duration:x[1].text,price:c,originPrice:h,discount:"nine",loading:f,onClick:this.onPriceChange}))),d.default.createElement("div",{className:"field quantity first"},d.default.createElement("header",null,"续约席位数"),d.default.createElement("div",{className:"input",onClick:function(){return o("#enterprise-payment-purchase-input").select()}},t.error?d.default.createElement("label",{className:"error"},t.error):null,d.default.createElement("input",{id:"enterprise-payment-purchase-input",type:"text",disabled:!0,maxLength:"3",onChange:this.onQuantityChange,value:t.value}))),d.default.createElement("div",{className:"field payment-options"},d.default.createElement("header",null,"支付方式"),d.default.createElement("div",{className:"options-wrapper"},d.default.createElement(C,{id:1,icon:"alipay",text:"支付宝",active:1===r.selectedId,onClick:this.onPaymentChange}),d.default.createElement(C,{id:3,icon:"transfers",text:"对公转账",active:3===r.selectedId,onClick:this.onPaymentChange}))),d.default.createElement("div",{className:"field sum-price"},d.default.createElement("div",{className:"sum-price-title"},"总计："),f?d.default.createElement("div",{className:"sum-price-number-loading"},"正在获取价格..."):d.default.createElement("div",{className:"sum-price-number"},"¥"," ",m,".00")),d.default.createElement("div",{className:"field agree"},a?d.default.createElement("span",{className:"error"},"网络异常，请重试"):i.error?d.default.createElement("span",{className:"error"},"请勾选同意"):null,d.default.createElement(S,{checked:i.checked,onClick:this.onAgreeChange},"我已阅读并同意签署",d.default.createElement("a",{target:"_blank",href:"https://shimo.im/agreement"},"《服务协议》"))),s?d.default.createElement("div",{className:"fluid-submit-button"},"...跳转中"):d.default.createElement("div",{className:"fluid-submit-button "+(g?"enabled":""),onClick:this.onSubmit(g)},f?"正在获取价格...":"下一步"))}},{key:"render",value:function(){return d.default.createElement(h.default,{customClass:"purchase-dialog"+(this.props.data.loading?" purchase-loading":""),ref:"flatDialog",hasCloseButton:!0,title:"续约企业版",onClose:this.props.onClose,open:this.props.open,enableCloseClickMask:!1,bodyTpl:this.renderContent})}}]),t}(f.Component);t.default=T,e.exports=t.default}).call(t,n(1),n(2))},function(e,t,n){(function(r,o){function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),f=n(0),d=i(f),p=n(51),h=i(p),m=n(144),g=n(189),_=i(g),v=n(190),y=0,b={},w=function(e){var t=e.id,n=e.icon,r=e.text,o=e.active,i=e.onClick;return d.default.createElement("div",{onClick:function(){i(t)},className:o?"option-outer-border active":"option-outer-border"},d.default.createElement("div",{className:"option "+n},r))};w.propTypes={id:f.PropTypes.number,icon:f.PropTypes.string,text:f.PropTypes.string,active:f.PropTypes.bool,onClick:f.PropTypes.func};var C=function(e){var t=e.children,n=e.checked,r=e.onClick;return d.default.createElement("div",{className:"checkbox noselect "+(n?"checked":"")},d.default.createElement("span",{onClick:r},t))};C.propTypes={checked:f.PropTypes.bool,onClick:f.PropTypes.func};var S=function(e){function t(e){a(this,t);var n=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r={unitPrice:0,quantity:{min:1,value:1,realValue:1,error:null},price:{loading:!1},sumPrice:0,payment:{selectedId:1},agree:{checked:!1,error:!1},ajaxError:null,loadingDuringSubmitting:!1},o=e.data.purchase?e.data.purchase:{quantity:null};return n.state=u({},r,e.data.purchase,{quantity:u({},r.quantity,o.quantity),loadingDuringSubmitting:!1}),n.onQuantityChange=n.onQuantityChange.bind(n),n.onPaymentChange=n.onPaymentChange.bind(n),n.onAgreeChange=n.onAgreeChange.bind(n),n.onSubmit=n.onSubmit.bind(n),n.ajaxRetry=n.ajaxRetry.bind(n),n.renderContent=n.renderContent.bind(n),n}return l(t,e),c(t,null,[{key:"propTypes",get:function(){return{data:f.PropTypes.object,onClose:f.PropTypes.func,open:f.PropTypes.bool,onNext:f.PropTypes.func}}},{key:"defaultProps",get:function(){return{onClose:function(){},open:!1}}}]),c(t,[{key:"componentDidMount",value:function(){this.getSumPrice()}},{key:"componentDidUpdate",value:function(e,t){t.quantity.realValue===this.state.quantity.realValue&&t.quantity.error===this.state.quantity.error||this.getSumPrice()}},{key:"ajaxRetry",value:function(e){for(var t=this,n=arguments.length,r=Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return function(){t[e].apply(t,r)}}},{key:"calculateSumPrice",value:function(e,t,n){(0,m.ajaxGet)("/smapi/orders/action/calculate?type=team&duration=0&memberCount="+e).then(function(n){var r=(0,v.getAmount)(n.data),o=(0,v.getAmount)(n.data/e);"function"==typeof t&&t(e,r,o)}).catch(function(){"function"==typeof n&&n(e)})}},{key:"getSumPrice",value:function(){var e=this,t=this.state.quantity.realValue,n=t===this.state.quantity.min||b[t]?0:800;n>0&&this.setState({price:u({},this.state.price,{loading:!0})}),setTimeout(function(){if(y===t){var n=b[t];n?e.setState({price:u({},e.state.price,{loading:!1}),sumPrice:n.sumPrice,unitPrice:n.unitPrice,ajaxError:null}):e.calculateSumPrice(t,function(t,n,r){e.state.quantity.error||(b[t]={sumPrice:n,unitPrice:r},e.setState({price:u({},e.state.price,{loading:!1}),sumPrice:n,unitPrice:r,ajaxError:null}))},function(){e.setState({ajaxError:{functionName:"getSumPrice",functionParams:[]}})})}else y=t,e.getSumPrice()},n)}},{key:"checkMemberCount",value:function(e){var t=this.state.quantity;return isNaN(e)?"请输入数字":r.isInteger(e)?e<0?"请输入正整数":e<t.min?"最少购买 "+t.min+" 人":null:"请输入整数"}},{key:"onQuantityChange",value:function(e){var t=this,n=(0,v.allowNumber)(e.target.value);null===this.checkMemberCount(n)?this.setState({quantity:u({},this.state.quantity,{value:n,realValue:n,error:null})}):(this.setState({quantity:u({},this.state.quantity,{value:n})}),setTimeout(function(){var n=(0,v.allowNumber)(e.target.value),r=t.checkMemberCount(n);null!==r&&t.setState({quantity:u({},t.state.quantity,{error:r})})},1e3))}},{key:"onPaymentChange",value:function(e){var t=this.state.payment;this.setState({payment:u({},t,{selectedId:e})})}},{key:"onAgreeChange",value:function(){var e=this.state.agree;this.setState({agree:u({},e,{checked:!e.checked,error:!1})})}},{key:"navTo",value:function(e,t){var r=this,o=this.state.quantity.realValue,i=(0,_.default)(e).when("alipay-qrcode","alipay_qr").when("waiting-pay","upacp").when("transfers-inventory","offline").done(),a=(0,_.default)(e).when("alipay-qrcode",{type:"team",duration:0,channel:i,member_count:o}).when("waiting-pay",{type:"team",duration:0,channel:i,member_count:o}).when("transfers-inventory",{skip_charge:1,duration:0,member_count:o,type:"team",channel:i}).done();this.setState({loadingDuringSubmitting:!0}),(0,m.ajaxPost)("/orders/create",a).then(function(o){if("alipay-qrcode"===e)r.props.onNext(e,u({},t,o.data,{purchase:r.state,needRefresh:!0}));else if("waiting-pay"===e)n.e(2).then(function(r){n(546).createPayment(o.data.charge,function(n){"success"===n?this.props.onNext(e,u({},t,o.data,{needRefresh:!0})):"fail"===n?this.setState({ajaxError:{functionName:"navTo",functionParams:[e,t]},loadingDuringSubmitting:!1}):"cancel"===n&&this.setState({ajaxError:{functionName:"navTo",functionParams:[e,t]},loadingDuringSubmitting:!1})})}.bind(null,n)).catch(n.oe);else{if("transfers-inventory"!==e)throw new Error("Unknown nextPage: "+e);r.props.onNext(e,u({},t,o.data,{needRefresh:!0}))}}).catch(function(){r.setState({ajaxError:{functionName:"navTo",functionParams:[e,t]},loadingDuringSubmitting:!1})})}},{key:"onSubmit",value:function(e){var t=this;return function(){var n=t.state,r=n.payment,o=n.agree;e?1===r.selectedId?t.navTo("alipay-qrcode"):2===r.selectedId?t.navTo("waiting-pay"):3===r.selectedId&&t.navTo("transfers-inventory",{durationDesc:"",discount:""}):o.checked||t.setState({agree:u({},o,{error:!0})})}}},{key:"renderContent",value:function(){var e=this.state,t=e.quantity,n=e.payment,r=e.agree,i=e.unitPrice,a=e.price,s=e.ajaxError,l=e.sumPrice,u=e.loadingDuringSubmitting,c=document.getElementById("enterprise-payment-purchase-input"),f=a.loading,p=!t.error&&c&&Number(c.value)>=t.min&&r.checked&&!f,h=function(){var e=function(e){return e>0&&e<10?"0"+e:e},t=new Date(cow.currentUser.accountTypeExpiredAt);return t.getFullYear()+" / "+e(t.getMonth()+1)+" / "+e(t.getDate())}();return d.default.createElement("div",{className:"purchase"},d.default.createElement("div",{className:"crumb-list"},d.default.createElement("span",{className:"crumb"},"确认订单"),d.default.createElement("span",{className:"hicon icon-breadcrumb"}),d.default.createElement("span",{className:"no-crumb"},"付款"),d.default.createElement("span",{className:"hicon icon-breadcrumb"}),d.default.createElement("span",{className:"no-crumb"},"填写发票信息")),d.default.createElement("div",{className:"field first expired-time"},d.default.createElement("header",null,"当前企业版到期时间"),d.default.createElement("div",{className:"text"},h)),d.default.createElement("div",{className:"field quantity"},d.default.createElement("header",null,"补充席位数"),d.default.createElement("div",{className:"input",onClick:function(){return o("#enterprise-payment-purchase-input").select()}},f&&!i?null:d.default.createElement("label",{className:"placeholder"},i," 元 / 人"),t.error?d.default.createElement("label",{className:"error"},t.error):null,d.default.createElement("input",{id:"enterprise-payment-purchase-input",type:"text",maxLength:"3",onChange:this.onQuantityChange,value:t.value}))),d.default.createElement("div",{className:"field payment-options"},d.default.createElement("header",null,"支付方式"),d.default.createElement("div",{className:"options-wrapper"},d.default.createElement(w,{id:1,icon:"alipay",text:"支付宝",active:1===n.selectedId,onClick:this.onPaymentChange}),d.default.createElement(w,{id:3,icon:"transfers",text:"对公转账",active:3===n.selectedId,onClick:this.onPaymentChange}))),d.default.createElement("div",{className:"field agree"},s?d.default.createElement("span",{className:"error"},"网络异常，请重试"):r.error?d.default.createElement("span",{className:"error"},"请勾选同意"):null,d.default.createElement(C,{checked:r.checked,onClick:this.onAgreeChange},"我已阅读并同意签署",d.default.createElement("a",{target:"_blank",href:"https://shimo.im/agreement"},"《服务协议》"))),u?d.default.createElement("div",{className:"fluid-submit-button"},"...跳转中"):d.default.createElement("div",{className:"fluid-submit-button "+(p?"enabled":""),onClick:this.onSubmit(p)},f?"正在获取价格...":"确认支付 ¥ "+l))}},{key:"render",value:function(){return d.default.createElement(h.default,{customClass:"purchase-dialog"+(this.props.data.loading?" purchase-loading":""),ref:"flatDialog",hasCloseButton:!0,title:"补充席位",onClose:this.props.onClose,open:this.props.open,enableCloseClickMask:!1,bodyTpl:this.renderContent})}}]),t}(f.Component);t.default=S,e.exports=t.default}).call(t,n(1),n(2))},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=r(u),f=n(51),d=r(f),p=n(189),h=r(p),m=n(5),g=r(m),_=n(144),v=n(190),y=n(9),b=r(y),w=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={loading:!1},n.navTo=n.navTo.bind(n),n.onClickHere=n.onClickHere.bind(n),n.renderContent=n.renderContent.bind(n),n}return a(t,e),l(t,null,[{key:"propTypes",get:function(){return{onNext:u.PropTypes.func,data:u.PropTypes.object,type:u.PropTypes.string,onClose:u.PropTypes.func,open:u.PropTypes.bool}}},{key:"defaultProps",get:function(){return{onClose:function(){},open:!1}}}]),l(t,[{key:"componentDidMount",value:function(){b.default.attach("enterprise-payment:payment-success",this.navToPaymentSuccess,{scope:this,isAsync:!0})}},{key:"componentWillUnmount",value:function(){b.default.detach("enterprise-payment:payment-success",this.navToPaymentSuccess)}},{key:"navToPaymentSuccess",value:function(){this.props.onNext("payment-success",s({},this.props.data))}},{key:"navTo",value:function(e,t){var n=this;return function(){n.props.onNext(e,t)}}},{key:"onClickHere",value:function(){var e=this;return function(){var t=e.props.data.charge.id;e.setState({loading:!0}),(0,_.ajaxPost)("/orders/payment_succeed",{charge_id:t}).then(function(t){!0===t.data.paid?e.props.onNext("payment-success",s({},e.props.data)):e.setState({loading:!1})}).catch(function(){e.setState({loading:!1})})}}},{key:"renderContent",value:function(){var e=this.state.loading,t=this.props.data,n=function(){var e=t.charge,n=e.credential,r=n[e.channel];return g.default.getQrImageUrl(300,r)}();return c.default.createElement("div",{className:"alipay-qrcode"},c.default.createElement("div",{className:"crumb-list"},c.default.createElement("span",{className:"no-crumb back",onClick:this.navTo("purchase")},"确认订单"),c.default.createElement("span",{className:"hicon icon-breadcrumb"}),c.default.createElement("span",{className:"crumb"},"付款"),c.default.createElement("span",{className:"hicon icon-breadcrumb"}),c.default.createElement("span",{className:"no-crumb"},"填写发票信息")),c.default.createElement("div",{className:"qrcode-container"},c.default.createElement("header",null,"请用支付宝扫码完成支付"),c.default.createElement("div",{className:"qrcode",style:{backgroundImage:"url("+n+")"}}),c.default.createElement("footer",null,"扫码支付后，如果没有自动跳转",c.default.createElement("br",null),e?c.default.createElement("span",{className:"link"},"...跳转中"):c.default.createElement("span",{className:"link",onClick:this.onClickHere()},"请点这里"))))}},{key:"render",value:function(){var e=this.props.data,t=this.props.type,n=(0,v.getAmount)(e.order.amount),r=(0,h.default)(t).when("renew","续约企业版").when("supplementary","补充席位").others("购买企业版").done();return c.default.createElement(d.default,{customClass:"alipay-qrcode-dialog",ref:"flatDialog",hasCloseButton:!0,title:r+" 支付 ¥ "+n,onClose:this.props.onClose,open:this.props.open,enableCloseClickMask:!1,bodyTpl:this.renderContent})}}]),t}(u.Component);t.default=w,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(51),f=r(c),d=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.timer=null,n.navTo=n.navTo.bind(n),n.renderContent=n.renderContent.bind(n),n}return a(t,e),s(t,null,[{key:"propTypes",get:function(){return{onClose:l.PropTypes.func,open:l.PropTypes.bool,data:l.PropTypes.object,onNext:l.PropTypes.func}}},{key:"defaultProps",get:function(){return{onClose:function(){},open:!1}}}]),s(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.data;this.timer=setTimeout(function(){e.props.onNext("fill-invoice-info",t)},1500)}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timer)}},{key:"navTo",value:function(e){var t=this;return function(){t.props.onNext(e)}}},{key:"renderContent",value:function(){return u.default.createElement("div",{className:"payment-success"},u.default.createElement("div",{className:"success-icon"}),u.default.createElement("div",{className:"success-text"},"支付成功"),u.default.createElement("footer",null,"如果没有自动跳转",u.default.createElement("br",null),u.default.createElement("span",{className:"link",onClick:this.navTo("fill-invoice-info")},"请点这里")))}},{key:"render",value:function(){return u.default.createElement(f.default,{customClass:"payment-success-dialog",ref:"flatDialog",hasCloseButton:!0,title:"",onClose:this.props.onClose,open:this.props.open,enableCloseClickMask:!1,bodyTpl:this.renderContent})}}]),t}(l.Component);t.default=d,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(51),f=r(c),d=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.navTo=n.navTo.bind(n),n.renderContent=n.renderContent.bind(n),n}return a(t,e),s(t,null,[{key:"propTypes",get:function(){return{onClose:l.PropTypes.func,open:l.PropTypes.bool,onNext:l.PropTypes.func}}},{key:"defaultProps",get:function(){return{onClose:function(){},open:!1}}}]),s(t,[{key:"navTo",value:function(e){var t=this;return function(){t.props.onNext(e)}}},{key:"renderContent",value:function(){return u.default.createElement("div",{className:"payment-failure"},u.default.createElement("header",null,"支付失败"),u.default.createElement("div",{className:"failure-text"},"如您有任何疑问，请立即联系我们的客户顾问帮助您解决"),u.default.createElement("div",{className:"telephone"},"电话 400-006-0506"),u.default.createElement("div",{className:"center"},u.default.createElement("div",{className:"submit-button enabled",onClick:this.navTo("purchase")},"重新支付")))}},{key:"render",value:function(){return u.default.createElement(f.default,{customClass:"payment-failure-dialog",ref:"flatDialog",hasCloseButton:!0,title:"",onClose:this.props.onClose,open:this.props.open,enableCloseClickMask:!1,bodyTpl:this.renderContent})}}]),t}(l.Component);t.default=d,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(51),f=r(c),d=n(189),p=r(d),h=n(190),m=function(e){return Math.round(e/31)},g=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.navTo=n.navTo.bind(n),n.renderContent=n.renderContent.bind(n),n}return a(t,e),s(t,null,[{key:"propTypes",get:function(){return{data:l.PropTypes.object,onClose:l.PropTypes.func,open:l.PropTypes.bool,onNext:l.PropTypes.func,type:l.PropTypes.string}}},{key:"defaultProps",get:function(){return{onClose:function(){},open:!1}}}]),s(t,[{key:"navTo",value:function(e){var t=this;return function(){var n=t.props.data.order,r=t.props.type;t.props.onNext(e,{purchase:{quantity:{value:String(n.memberCount),realValue:n.memberCount,error:null},price:function(){return"normal"===r?{selectedIndex:m(n.duration)<12?0:m(n.duration)<24?1:2,real:[0,0,0],original:[0,0,0]}:"renew"===r?{selectedIndex:m(n.duration)>=24?1:0,real:[0,0],original:[0,0]}:{}}(),payment:{selectedId:3},agree:{checked:!0,error:!1},ajaxError:null,loadingDuringSubmitting:!1}})}}},{key:"renderContent",value:function(){var e=this.props.type,t=this.props.data.order,n=t.memberCount,r=t.amount,o=t.orderNo,i=t.duration,a=m(i),s=a<12?" "+a+" 个月":a>=12&&a<24?" 1 年":" 2 年",l=a<12?"":a>=12&&a<24?"（八折）":"（七折）",c=function(){return"renew"===e?0===n?"延长"+s+"使用期"+l:"补充 "+n+" 席位，延长"+s+"使用期"+l:"supplementary"===e?"补充 "+n+" 席位":"购买 "+n+" 席位，"+s+"使用期"+l}(),f=cow.currentUser.team.enterpriseId.length<8?"0"+cow.currentUser.team.enterpriseId:cow.currentUser.team.enterpriseId;return u.default.createElement("div",{className:"transfers-inventory"},u.default.createElement("section",null,u.default.createElement("div",{className:"two-column-grid"},u.default.createElement("div",{className:"row"},u.default.createElement("div",{className:"left-column"},"转账金额"),u.default.createElement("div",{className:"right-column"},u.default.createElement("strong",null,(0,h.getAmount)(r)," 元"))),u.default.createElement("div",{className:"row"},u.default.createElement("div",{className:"left-column"},"收款公司名"),u.default.createElement("div",{className:"right-column"},u.default.createElement("strong",null,"武汉初心科技有限公司"))),u.default.createElement("div",{className:"row"},u.default.createElement("div",{className:"left-column"},"收款账户"),u.default.createElement("div",{className:"right-column"},u.default.createElement("strong",null,"1279 0701 9410 802 ",f))),u.default.createElement("div",{className:"row"},u.default.createElement("div",{className:"left-column"},"开户行"),u.default.createElement("div",{className:"right-column"},u.default.createElement("strong",null,"招商银行武汉分行光谷科技支行"))),u.default.createElement("div",{className:"row"},u.default.createElement("div",{className:"left-column"},"开户地"),u.default.createElement("div",{className:"right-column"},u.default.createElement("strong",null,"武汉"))))),u.default.createElement("section",null,u.default.createElement("div",{className:"two-column-grid"},u.default.createElement("div",{className:"row"},u.default.createElement("div",{className:"left-column"},"订单号"),u.default.createElement("div",{className:"right-column"},o)),u.default.createElement("div",{className:"row"},u.default.createElement("div",{className:"left-column"},"订单详情"),u.default.createElement("div",{className:"right-column"},c)))),u.default.createElement("section",null,u.default.createElement("div",{className:"noting"},"请于 ",u.default.createElement("strong",null,"10日")," 内完成转账，我们会尽快确认到账并开通服务。如您有任何疑问，请立即联系我们的客户顾问帮助您解决，电话 400-006-0506")),u.default.createElement("footer",null,u.default.createElement("div",{className:"submit-button enabled",onClick:this.props.onClose},"知道了"),u.default.createElement("div",{className:"submit-button flat",onClick:this.navTo("purchase")},"更改支付方式")))}},{key:"render",value:function(){var e=this.props.data.order.amount,t=this.props.type,n=(0,p.default)(t).when("renew","续约企业版").when("supplementary","补充席位").others("购买企业版").done();return u.default.createElement(f.default,{customClass:"transfers-inventory-dialog",ref:"flatDialog",hasCloseButton:!0,title:n+" 对公转账 ¥ "+(0,h.getAmount)(e),onClose:this.props.onClose,open:this.props.open,enableCloseClickMask:!1,bodyTpl:this.renderContent})}}]),t}(l.Component);t.default=g,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=r(u),f=n(51),d=r(f),p=n(144),h=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=e.data.invoice,a=r.taxType,s=r.amount,l=r.title,u=r.address,c=r.contact,f=r.phone;return n.state={taxType:a,amount:s,title:l,address:u,contact:c,phone:f,loading:!1,error:!1},n.navTo=n.navTo.bind(n),n.submit=n.submit.bind(n),n.renderContent=n.renderContent.bind(n),n}return a(t,e),l(t,null,[{key:"propTypes",get:function(){return{onClose:u.PropTypes.func,open:u.PropTypes.bool,data:u.PropTypes.object,onNext:u.PropTypes.func}}},{key:"defaultProps",get:function(){return{onClose:function(){},open:!1}}}]),l(t,[{key:"navTo",value:function(e,t){var n=this;return function(){n.props.onNext(e,{fillInvoiceInfo:s({},n.props.data.fillInvoiceInfo,{selectedIndex:0},t)})}}},{key:"submit",value:function(){var e=this,t=this.state,n=t.taxType,r=t.title,o=t.contact,i=t.phone,a=t.address;this.setState({loading:!0}),(0,p.ajaxPost)("/smapi/invoices",{taxType:n,title:r,contact:o,phone:i,address:a}).then(function(){e.props.onNext("thanks-to-buy",{needRefresh:!0})}).catch(function(){e.setState({loading:!1,error:!0})})}},{key:"renderContent",value:function(){var e=this.state,t=e.amount,n=e.title,r=e.address,o=e.contact,i=e.phone,a=e.loading,s=e.error;return c.default.createElement("div",{className:"confirm-invoice-info"},c.default.createElement("section",null,c.default.createElement("div",{className:"two-column-grid"},c.default.createElement("div",{className:"row"},c.default.createElement("div",{className:"left-column"},"发票金额"),c.default.createElement("div",{className:"right-column"},c.default.createElement("strong",null,t," 元"))),c.default.createElement("div",{className:"row"},c.default.createElement("div",{className:"left-column"},"发票抬头"),c.default.createElement("div",{className:"right-column"},c.default.createElement("strong",null,n))),c.default.createElement("div",{className:"row"},c.default.createElement("div",{className:"left-column"},"发票邮寄地址"),c.default.createElement("div",{className:"right-column"},c.default.createElement("strong",null,r))),c.default.createElement("div",{className:"row"},c.default.createElement("div",{className:"left-column"},"收件人"),c.default.createElement("div",{className:"right-column"},c.default.createElement("strong",null,o))),c.default.createElement("div",{className:"row"},c.default.createElement("div",{className:"left-column"},"联系电话"),c.default.createElement("div",{className:"right-column"},c.default.createElement("strong",null,i))))),s?c.default.createElement("section",{className:"error"},"网络异常，请重试"):c.default.createElement("section",{className:"noting"},"确认后不能修改发票信息，不能重开发票"),c.default.createElement("footer",null,a?c.default.createElement("div",{className:"submit-button"},"...跳转中"):c.default.createElement("div",{className:"submit-button enabled",onClick:this.submit},"确认提交"),c.default.createElement("div",{className:"submit-button flat",onClick:this.navTo("fill-invoice-info",{modify:!0})},"修改信息")))}},{key:"render",value:function(){return c.default.createElement(d.default,{customClass:"confirm-invoice-info-dialog",ref:"flatDialog",hasCloseButton:!0,title:"请确认发票信息",onClose:this.props.onClose,open:this.props.open,enableCloseClickMask:!1,bodyTpl:this.renderContent})}}]),t}(u.Component);t.default=h,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=r(u),f=n(51),d=r(f),p=n(144),h=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=n.props.data.VATInvoice,a=r.amount,s=r.taxType,l=r.contact,u=r.phone,c=r.address,f=r.taxpayer,d=r.taxpayerId,p=r.bank,h=r.bankAccount,m=r.companyAddress,g=r.companyPhone;return n.state={amount:a,taxType:s,contact:l,phone:u,address:c,taxpayer:f,taxpayerId:d,bank:p,bankAccount:h,companyAddress:m,companyPhone:g,loading:!1,error:!1},n.submit=n.submit.bind(n),n.renderContent=n.renderContent.bind(n),n}return a(t,e),l(t,null,[{key:"propTypes",get:function(){return{onClose:u.PropTypes.func,open:u.PropTypes.bool,data:u.PropTypes.object,onNext:u.PropTypes.func}}},{key:"defaultProps",get:function(){return{onClose:function(){},open:!1}}}]),l(t,[{key:"navTo",value:function(e,t){var n=this;return function(){n.props.onNext(e,{fillInvoiceInfo:s({},n.props.data.fillInvoiceInfo,{selectedIndex:1},t)})}}},{key:"submit",value:function(){var e=this,t=this.state,n=t.taxType,r=t.contact,o=t.phone,i=t.address,a=t.taxpayer,s=t.taxpayerId,l=t.bank,u=t.bankAccount,c=t.companyAddress,f=t.companyPhone;this.setState({loading:!0}),(0,p.ajaxPost)("/smapi/invoices",{taxType:n,contact:r,phone:o,address:i,taxpayer:a,taxpayerId:s,bank:l,bankAccount:u,companyAddress:c,companyPhone:f}).then(function(){e.props.onNext("thanks-to-buy",{needRefresh:!0})}).catch(function(){e.setState({loading:!1,error:!0})})}},{key:"renderContent",value:function(){var e=this.state,t=e.amount,n=e.contact,r=e.phone,o=e.address,i=e.taxpayer,a=e.taxpayerId,s=e.bank,l=e.bankAccount,u=e.companyAddress,f=e.companyPhone,d=e.loading,p=e.error;return c.default.createElement("div",{className:"confirm-vat-invoice-info"},c.default.createElement("section",null,c.default.createElement("div",{className:"two-column-grid"},c.default.createElement("div",{className:"row"},c.default.createElement("div",{className:"left-column"},"发票金额"),c.default.createElement("div",{className:"right-column"},c.default.createElement("strong",null,t," 元"))),c.default.createElement("div",{className:"row"},c.default.createElement("div",{className:"left-column"},"纳税人名称"),c.default.createElement("div",{className:"right-column"},c.default.createElement("strong",null,i))),c.default.createElement("div",{className:"row"},c.default.createElement("div",{className:"left-column"},"纳税人识别号"),c.default.createElement("div",{className:"right-column"},c.default.createElement("strong",null,a))),c.default.createElement("div",{className:"row"},c.default.createElement("div",{className:"left-column"},"公司地址"),c.default.createElement("div",{className:"right-column"},c.default.createElement("strong",null,u))),c.default.createElement("div",{className:"row"},c.default.createElement("div",{className:"left-column"},"开户银行"),c.default.createElement("div",{className:"right-column"},c.default.createElement("strong",null,s))),c.default.createElement("div",{className:"row"},c.default.createElement("div",{className:"left-column"},"银行账户"),c.default.createElement("div",{className:"right-column"},c.default.createElement("strong",null,l))),c.default.createElement("div",{className:"row"},c.default.createElement("div",{className:"left-column"},"联系电话"),c.default.createElement("div",{className:"right-column"},c.default.createElement("strong",null,f))))),c.default.createElement("section",null,c.default.createElement("div",{className:"two-column-grid"},c.default.createElement("div",{className:"row"},c.default.createElement("div",{className:"left-column"},"发票邮寄地址"),c.default.createElement("div",{className:"right-column"},c.default.createElement("strong",null,o))),c.default.createElement("div",{className:"row"},c.default.createElement("div",{className:"left-column"},"收件人"),c.default.createElement("div",{className:"right-column"},c.default.createElement("strong",null,n))),c.default.createElement("div",{className:"row"},c.default.createElement("div",{className:"left-column"},"联系电话"),c.default.createElement("div",{className:"right-column"},c.default.createElement("strong",null,r))))),p?c.default.createElement("section",{className:"error"},"网络异常，请重试"):c.default.createElement("section",{className:"noting"},"确认后不能修改发票信息，不能重开发票"),c.default.createElement("footer",null,d?c.default.createElement("div",{className:"submit-button"},"...跳转中"):c.default.createElement("div",{className:"submit-button enabled",onClick:this.submit},"确认提交"),c.default.createElement("div",{className:"submit-button flat",onClick:this.navTo("fill-invoice-info",{modify:!0})},"修改信息")))}},{key:"render",value:function(){return c.default.createElement(d.default,{customClass:"confirm-vat-invoice-info-dialog",ref:"flatDialog",hasCloseButton:!0,title:"请确认发票信息",onClose:this.props.onClose,open:this.props.open,enableCloseClickMask:!1,bodyTpl:this.renderContent})}}]),t}(u.Component);t.default=h,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(0),f=r(c),d=n(51),p=r(d),h=n(54),m=n(190),g=n(144),_=200,v=[{field:"title",name:"发票抬头"},{field:"address",name:"邮寄地址"},{field:"receiver",name:"收件人"},{field:"phone",name:"联系电话"}],y=[{field:"taxpayerName",name:"纳税人名称"},{field:"taxpayerId",name:"纳税人识别号"},{field:"registerAddress",name:"注册地址"},{field:"registerPhone",name:"注册电话"},{field:"bankName",name:"开户银行"},{field:"bankAccount",name:"银行账户"},{field:"postAddress",name:"发票邮寄地址"},{field:"receiverName",name:"收件人"},{field:"receiverPhone",name:"联系电话"}],b=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r={invoice:{amount:{value:"",loading:!1,error:null},title:"",address:"",receiver:"",phone:"",error:null},VATInvoice:{amount:{value:"",loading:!1,error:null},taxpayerName:"",taxpayerId:"",registerAddress:"",registerPhone:"",bankName:"",bankAccount:"",postAddress:"",receiverName:"",receiverPhone:"",error:null},selectedIndex:0},o=n.props.data.fillInvoiceInfo;return n.state=l({},r,o),n.onChange=n.onChange.bind(n),n.onInvoiceSubmit=n.onInvoiceSubmit.bind(n),n.onVATInvoiceSubmit=n.onVATInvoiceSubmit.bind(n),n.tabDidChange=n.tabDidChange.bind(n),n.renderContent=n.renderContent.bind(n),n}return s(t,e),u(t,null,[{key:"propTypes",get:function(){return{onClose:c.PropTypes.func,open:c.PropTypes.bool,data:c.PropTypes.object,onNext:c.PropTypes.func}}},{key:"defaultProps",get:function(){return{onClose:function(){},open:!1}}}]),u(t,[{key:"componentDidMount",value:function(){this.props.data.fillInvoiceInfo&&this.props.data.fillInvoiceInfo.modify||this.getInvoiceContent(),this.getInvoiceAmount()}},{key:"componentDidUpdate",value:function(e,t){t.selectedIndex!==this.state.selectedIndex&&this.tabDidChange()}},{key:"getInvoiceContent",value:function(){var e=this;(0,g.ajaxGet)("/invoices?page=1&per_page=1&type=team").then(function(t){var n=t.data;if(!(n.length<=0)){var r=n[0];"vat"===r.type?e.setState({VATInvoice:l({},e.state.VATInvoice,{taxpayerName:r.taxpayer,taxpayerId:r.taxpayerId,registerAddress:r.companyAddress,registerPhone:r.companyPhone,bankName:r.bank,bankAccount:r.bankAccount,postAddress:r.address,receiverName:r.contact,receiverPhone:r.phone}),selectedIndex:1}):e.setState({invoice:l({},e.state.invoice,{title:r.title,address:r.address,receiver:r.contact,phone:r.phone}),selectedIndex:0})}})}},{key:"getInvoiceAmount",value:function(){var e=this;this.setState({invoice:l({},this.state.invoice,{amount:l({},this.state.invoice.amount,{loading:!0})}),VATInvoice:l({},this.state.VATInvoice,{amount:l({},this.state.VATInvoice.amount,{loading:!0})})}),(0,g.ajaxGet)("/smapi/invoices/amount").then(function(t){var n=(0,m.getAmount)(t.data),r=null;n<_&&(r="抱歉，开票金额需大于 "+_+" 元"),e.setState({invoice:l({},e.state.invoice,{amount:l({},e.state.invoice.amount,{loading:!1,error:r,value:n})}),VATInvoice:l({},e.state.VATInvoice,{amount:l({},e.state.VATInvoice.amount,{loading:!1,error:r,value:n})})})}).catch(function(){e.setState({invoice:l({},e.state.invoice,{amount:l({},e.state.invoice.amount,{loading:!1,value:"",error:f.default.createElement("span",null,"获取失败，请",f.default.createElement("span",{onClick:e.getInvoiceAmount.bind(e),style:{textDecoration:"underline",cursor:"pointer"}},"重试"))})}),VATInvoice:l({},e.state.VATInvoice,{amount:l({},e.state.VATInvoice.amount,{loading:!1,value:"",error:f.default.createElement("span",null,"获取失败，请",f.default.createElement("span",{onClick:e.getInvoiceAmount.bind(e),style:{textDecoration:"underline",cursor:"pointer"}},"重试"))})})})})}},{key:"onChange",value:function(e){var t=this;return function(n){return function(r){var i;t.setState(o({},e,l({},t.state[e],(i={},o(i,n,r.target.value),o(i,"error",null),i))))}}}},{key:"checkInvoiceItems",value:function(){for(var e=v,t=this.state.invoice,n=void 0,r=0;r<e.length;r++){var o=e[r];if(t[o.field].length<=0){n="请填写"+o.name;break}}return n&&this.setState({invoice:l({},t,{error:n})}),n}},{key:"onInvoiceSubmit",value:function(){var e=this.state.invoice;this.checkInvoiceItems()||e.amount.error||this.props.onNext("confirm-invoice-info",l({},this.props.data,{invoice:{taxType:"normal",title:e.title,address:e.address,contact:e.receiver,phone:e.phone,amount:this.state.invoice.amount.value},fillInvoiceInfo:this.state}))}},{key:"checkVATInvoiceItems",value:function(){for(var e=y,t=this.state.VATInvoice,n=void 0,r=0;r<e.length;r++){var o=e[r];if(t[o.field].length<=0){n="请填写"+o.name;break}}return n&&this.setState({VATInvoice:l({},t,{error:n})}),n}},{key:"onVATInvoiceSubmit",value:function(){var e=this.state.VATInvoice;this.checkVATInvoiceItems()||e.amount.error||this.props.onNext("confirm-VATInvoice-info",l({},this.props.data,{VATInvoice:{amount:this.state.VATInvoice.amount.value,taxType:"vat",taxpayer:e.taxpayerName,taxpayerId:e.taxpayerId,bank:e.bankName,bankAccount:e.bankAccount,companyAddress:e.registerAddress,companyPhone:e.registerPhone,contact:e.receiverName,phone:e.receiverPhone,address:e.postAddress},fillInvoiceInfo:this.state}))}},{key:"tabDidChange",value:function(){var e=document.getElementsByClassName("fill-invoice-info-dialog")[0];e&&(e.style.marginLeft=-e.clientWidth/2+"px",e.style.marginTop=-e.clientHeight/2+"px")}},{key:"renderField",value:function(e){var t=this.state,n=e.key,r=e.name,o=e.field,i=e.subField,a=e.space,s=t[o][i];return f.default.createElement("div",{key:n,className:a?"row space":"row"},f.default.createElement("div",{className:"left-column"},r),f.default.createElement("div",{className:"right-column"},f.default.createElement("input",{type:"text",onChange:this.onChange(o)(i),value:s})))}},{key:"renderInvoiceTab",value:function(){var e=this,t=this.state.invoice,n=!t.amount.loading&&!t.amount.error&&!t.error;return f.default.createElement(h.TabItem,{title:"开增值税普票"},f.default.createElement("div",{className:"two-column-grid"},f.default.createElement("div",{className:"row"},f.default.createElement("div",{className:"left-column"},"发票金额"),f.default.createElement("div",{className:"right-column"},t.amount.loading?f.default.createElement("span",{className:"text"},"...正在获取"):f.default.createElement("span",{className:"text"},t.amount.value," 元"),t.amount.error?f.default.createElement("div",{className:"error"},t.amount.error):null)),v.reduce(function(t,n,r){return t.push(e.renderField({key:r,name:n.name,field:"invoice",subField:n.field})),t},[])),f.default.createElement("footer",null,t.error?f.default.createElement("div",{className:"error"},t.error):null,f.default.createElement("div",{className:"submit-button "+(n?"enabled":""),onClick:this.onInvoiceSubmit},"确定"),f.default.createElement("div",{className:"submit-button flat",onClick:this.props.onClose},"稍后再开")))}},{key:"renderVATInvoiceTab",value:function(){var e=this,t=this.state.VATInvoice,n=!t.amount.loading&&!t.amount.error&&!t.error;return f.default.createElement(h.TabItem,{title:"开增值税专票"},f.default.createElement("div",{className:"two-column-grid"},f.default.createElement("div",{className:"row"},f.default.createElement("div",{className:"left-column"},"发票金额"),f.default.createElement("div",{className:"right-column"},t.amount.loading?f.default.createElement("span",{className:"text"},"...正在获取"):f.default.createElement("span",{className:"text"},t.amount.value," 元"),t.amount.error?f.default.createElement("div",{className:"error"},t.amount.error):null)),y.reduce(function(t,n,r){return t.push(e.renderField({key:r,name:n.name,field:"VATInvoice",subField:n.field,space:"postAddress"===n.field})),t},[])),f.default.createElement("footer",null,t.error?f.default.createElement("div",{className:"error"},t.error):null,f.default.createElement("div",{className:"submit-button "+(n?"enabled":""),onClick:this.onVATInvoiceSubmit},"确定"),f.default.createElement("div",{className:"submit-button flat",onClick:this.props.onClose},"稍后再开")))}},{key:"renderContent",value:function(){return f.default.createElement("div",{className:"fill-invoice-info"},f.default.createElement("span",{className:"hicon icon-close dialog-close",onClick:this.props.onClose}),f.default.createElement(h.Tab,{customClass:"sm-nav-tabs invitation-tabs large",disableSetWidth:!0,selectedIndex:this.state.selectedIndex,headTpl:function(e){return f.default.createElement("div",null,e)},tabDidChange:this.tabDidChange},this.renderInvoiceTab(),this.renderVATInvoiceTab()))}},{key:"render",value:function(){return f.default.createElement(p.default,{customClass:"fill-invoice-info-dialog",ref:"flatDialog",hasCloseButton:!0,title:"",onClose:this.props.onClose,open:this.props.open,enableCloseClickMask:!1,bodyTpl:this.renderContent})}}]),t}(c.Component);t.default=b,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(51),f=r(c),d=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.renderContent=n.renderContent.bind(n),n}return a(t,e),s(t,null,[{key:"propTypes",get:function(){return{onClose:l.PropTypes.func,open:l.PropTypes.bool}}},{key:"defaultProps",get:function(){return{onClose:function(){},open:!1}}}]),s(t,[{key:"componentDidMount",value:function(){var e=this;setTimeout(function(){e.props.onClose()},1500)}},{key:"renderContent",value:function(){return u.default.createElement("div",{className:"thanks-to-buy"},u.default.createElement("div",{className:"icon"}),u.default.createElement("div",{className:"text"},"感谢您的购买"),u.default.createElement("div",{className:"desc"},"发票会在 10 个工作日内",u.default.createElement("br",null),"快递给您"))}},{key:"render",value:function(){return u.default.createElement(f.default,{customClass:"thanks-to-buy-dialog",ref:"flatDialog",hasCloseButton:!0,title:"",onClose:this.props.onClose,open:this.props.open,enableCloseClickMask:!1,bodyTpl:this.renderContent})}}]),t}(l.Component);t.default=d,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(51),f=r(c),d=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.navTo=n.navTo.bind(n),n.renderContent=n.renderContent.bind(n),n}return a(t,e),s(t,null,[{key:"propTypes",get:function(){return{onClose:l.PropTypes.func,open:l.PropTypes.bool,onNext:l.PropTypes.func}}},{key:"defaultProps",get:function(){return{onClose:function(){},open:!1}}}]),s(t,[{key:"navTo",value:function(e,t){var n=this;return function(){n.props.onNext(e,t)}}},{key:"renderContent",value:function(){return u.default.createElement("div",{className:"waiting-pay"},u.default.createElement("header",null,"等待支付"),u.default.createElement("p",null,"在新打开的页面中完成支付，支付完成前请不要关闭这个窗口。如遇到问题请联系我们的客户顾问 400-006-0506"),u.default.createElement("footer",null,u.default.createElement("div",{className:"submit-button enabled",onClick:this.navTo("payment-success")},"支付成功"),u.default.createElement("div",{className:"submit-button flat",onClick:this.navTo("payment-failure")},"遇到问题")))}},{key:"render",value:function(){return u.default.createElement(f.default,{customClass:"waiting-pay-dialog",ref:"flatDialog",hasCloseButton:!0,title:"",onClose:this.props.onClose,open:this.props.open,enableCloseClickMask:!1,bodyTpl:this.renderContent})}}]),t}(l.Component);t.default=d,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(51),f=r(c),d=n(144),p=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={loading:!1,errorMessage:null},n.cancel=n.cancel.bind(n),n.renderContent=n.renderContent.bind(n),n}return a(t,e),s(t,null,[{key:"propTypes",get:function(){return{onClose:l.PropTypes.func,open:l.PropTypes.bool}}},{key:"defaultProps",get:function(){return{onClose:function(){},open:!1}}}]),s(t,[{key:"cancel",value:function(){var e=this,t={type:"team",duration:0,channel:"alipay_qr",member_count:0,skip_charge:1};this.setState({loading:!0,errorMessage:null}),(0,d.ajaxPost)("/orders/create",t).then(function(){location.replace(location.pathname)}).catch(function(){e.setState({loading:!1,errorMessage:"网络异常，请重试"})})}},{key:"renderContent",value:function(){var e=this.state;return u.default.createElement("div",{className:"cancel-order"},u.default.createElement("p",null,"确认取消对公转账订单吗?",u.default.createElement("br",null),"取消后，你可以重新购买企业版"),u.default.createElement("footer",null,e.errorMessage?u.default.createElement("div",{className:"error"},e.errorMessage):null,e.loading?u.default.createElement("div",{className:"submit-button"},"...正在取消"):u.default.createElement("div",{className:"submit-button warn",onClick:this.cancel},"确认取消"),u.default.createElement("div",{className:"submit-button flat",onClick:this.props.onClose},"取消")))}},{key:"render",value:function(){return u.default.createElement(f.default,{customClass:"cancel-order-dialog",ref:"flatDialog",hasCloseButton:!0,title:"取消订单",onClose:this.props.onClose,open:this.props.open,enableCloseClickMask:!1,bodyTpl:this.renderContent})}}]),t}(l.Component);t.default=p,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(696),i=r(o);t.default=i.default,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),f=n(20),d=r(f),p=n(697),h=r(p),m=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleLoadMore=n.handleLoadMore.bind(n),n.state={data:n.props.initData,hasMore:n.props.hasMore},n}return a(t,e),s(t,null,[{key:"propTypes",get:function(){return{className:l.PropTypes.string,children:l.PropTypes.node,renderItem:l.PropTypes.func,initData:l.PropTypes.array,data:l.PropTypes.array,getListData:l.PropTypes.func,getScrollContainer:l.PropTypes.func,loadingState:l.PropTypes.node,noMoreState:l.PropTypes.node,throttle:l.PropTypes.number,threshold:l.PropTypes.number,useWindow:l.PropTypes.bool}}},{key:"defaultProps",get:function(){return{initData:[],renderItem:c.noop,getListData:void 0}}}]),s(t,[{key:"componentWillReceiveProps",value:function(e){void 0!==e.data&&this.setState({data:e.data})}},{key:"patchData",value:function(e,t){var n=[];this.state.data.forEach(function(r){if(r.id===e){if(void 0===t)return;r=(0,c.assign)(r,t)}n.push(r)}),this.setState({data:n})}},{key:"handleLoadMore",value:function(e){var t=this;return this.props.getListData(e,!0).then(function(e){(400===e.code||e.error&&400===e.error.code)&&t.setState({hasMore:!1})})}},{key:"renderItems",value:function(){return this.state.data.map(this.props.renderItem)}},{key:"render",value:function(){var e=(0,d.default)("member-list",this.props.className);return u.default.createElement("div",{className:e},u.default.createElement(h.default,{useWindow:this.props.useWindow,hasMore:this.state.hasMore,loadMore:this.handleLoadMore,getScrollContainer:this.props.getScrollContainer,loadingState:this.props.loadingState,noMoreState:this.props.noMoreState,throttle:this.props.throttle,threshold:this.props.throttle},this.props.children||this.renderItems()))}}]),t}(l.Component);t.default=m,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),n(698);var o=n(699),i=r(o);t.default=i.default,e.exports=t.default},function(e,t){},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=(n(1),{LOADING:1,LOADED:2}),f=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.eventHandler=n.eventHandler.bind(n),n.state={loadState:void 0},n}return a(t,e),s(t,null,[{key:"propTypes",get:function(){return{useWindow:l.PropTypes.bool,hasMore:l.PropTypes.bool,loadMore:l.PropTypes.func,loadingState:l.PropTypes.node,noMoreState:l.PropTypes.node,throttle:l.PropTypes.number,threshold:l.PropTypes.number}}},{key:"defaultProps",get:function(){return{useWindow:!1,hasMore:!1,loadMore:function(){return new Promise(function(e){return setTimeout(e,3e3)})},loadingState:"正在加载下一页...",noMoreState:"已经是最后一页了.",throttle:300,threshold:20,pageStart:1}}}]),s(t,[{key:"componentDidMount",value:function(){this.pageLoaded=this.props.pageStart,this.attachListener()}},{key:"componentDidUpdate",value:function(){this.attachListener()}},{key:"componentWillUnmount",value:function(){this.detachListener()}},{key:"attachListener",value:function(){if(this.props.hasMore){(this.props.useWindow?document.querySelector(".content-wrap"):this.refs.waterfall).addEventListener("scroll",this.eventHandler,!1),this.props.initialLoad&&this.eventHandler()}}},{key:"detachListener",value:function(){(this.props.useWindow?document.querySelector(".content-wrap"):this.refs.waterfall).removeEventListener("scroll",this.eventHandler)}},{key:"eventHandler",value:function(e){var t=this,n=e.target;n.firstChild.offsetHeight-n.offsetHeight-n.scrollTop<this.props.threshold&&(this.detachListener(),this.setState({loadState:c.LOADING}),this.props.loadMore(this.pageLoaded+=1).then(function(){t.setState({loadState:c.LOADED})}))}},{key:"renderLoadMore",value:function(){var e=null;return this.props.hasMore?this.state.loadState===c.LOADING&&(e=u.default.createElement("div",{className:"loadMore"},this.props.loadingState)):this.state.loadState===c.LOADED&&(e=u.default.createElement("div",{className:"loadMore"},this.props.noMoreState)),e}},{key:"render",value:function(){return u.default.createElement("div",{className:"waterfall",ref:"waterfall"},u.default.createElement("div",{className:"waterfall-inner"},this.props.children),this.renderLoadMore())}}]),t}(l.Component);t.default=f,e.exports=t.default},function(e,t,n){(function(r,o){function i(e){return e&&e.__esModule?e:{default:e}}function a(){function e(e,n){var a=r.pick(e,["guid","rev","changeset","apool","clientId","committingCS","userCS"]),s=a.changeset,l=a.rev,u=a.apool,f=a.docType,p=a.guid,m=a.committingCS,g=a.userCS,_=a.clientId,y=void 0,w=void 0,C=void 0,S=void 0;if((m||g)&&(m.apool&&g.apool||(f="newdoc"),"doc"===f?(m&&(C=(new v.default).fromJsonable(t(m.apool))),g&&(S=g&&(new v.default).fromJsonable(t(g.apool))),m&&g?(s=d.default.moveOpsToNewPool(m.changeset,C,S),s=d.default.compose(s,g.changeset,S),l=m.rev,u=S):m?(s=m.changeset,l=m.rev,u=C):(s=g.changeset,l=g.rev,u=S)):"newdoc"===f&&(m&&g?("string"!=typeof m.changeset&&(m.changeset=JSON.stringify(m.changeset)),"string"!=typeof g.changeset&&(g.changeset=JSON.stringify(g.changeset)),s=h.default.pack(h.default.unpack(m.changeset).compose(h.default.unpack(g.changeset))),l=m.rev):m?(s=m.changeset,l=m.rev):(s=g.changeset,l=g.rev))),!l||!s)return i.remove(p,_),void n(!0);u=JSON.stringify(u),y=k.SYNC_OFFLINE.replace("{%guid%}",p),w={guid:p,rev:l,changeset:s,apool:u,clientId:_},c.default.post(y,w,function(){console.log("offline sync success"),n(!0)},function(){try{var e=d.default.unpack(s).charBank.trim();if(0===e.length)return void n(!0);var t='文档离线同步出现错误，同步失败内容的纯文本为：<br /><span style="color:black;font-size: 13px;">'+e+"</span><br />你可以复制该文本，在文档打开后粘贴到文档。";b.default.show({okCallback:function(){window.location.href="/doc/"+p},modal:!0,okText:"前往文档",headText:"非常抱歉",bodyText:t}),o.post("/api/log/sockets",{guid:p,sockets:JSON.stringify(s)}),n(!1)}catch(e){n(!1)}})}function t(e){return"object"!==(void 0===e?"undefined":l(e))&&e?JSON.parse(e):e}s();var n=r.get(window,"cow.currentUser.id");if(!(n<1)){var i=void 0;try{i=new E.default({userId:n})}catch(e){return void x.default.alert({type:"error",title:"您的浏览器不支持离线编辑",delay:1e4})}var a=r.get(window,"cow.tempCurrentFile.guid");A.default.initialize({userId:n,currentFileGuid:a,store:i,syncFn:e}).sync()}}function s(){R||(R=!0,g.default.attach("statusBar:triggerCleanData",function(){if("doc"!==window.cow.pageType)return!1;(0,C.default)({title:"确认删除离线数据？",description:"删除离线数据无法恢复，请确认已手动复制内容到本地，以免数据丢失",confirmFun:function(){try{window.localStorage.removeItem("shimo-offline-data")}catch(e){console.log("remove error"),console.dir(e)}x.default.alert({title:"删除成功",delay:1e3})}})}))}Object.defineProperty(t,"__esModule",{value:!0});var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.default=a;var u=n(34),c=i(u),f=n(88),d=i(f),p=n(53),h=i(p),m=n(9),g=i(m),_=n(196),v=i(_),y=n(194),b=i(y),w=n(146),C=i(w),S=n(5),x=i(S),T=n(446),E=i(T),M=n(701),A=i(M),k=n(69),R=!1;e.exports=t.default}).call(t,n(1),n(2))},function(e,t,n){"use strict";var r=n(1),o={initialize:function(e){return this.userId=e.userId,this.currentFileGuid=e.currentFileGuid,this.syncFn=e.syncFn,this.store=e.store,this.dataArray=this._flattern(this.currentFileGuid),this},_flattern:function(e){var t=[],n=this.store.getAll();return Object.keys(n).forEach(function(e){Object.keys(n[e]).forEach(function(o){t.push(r.assign({clientId:e},n[e][o]))})}),e?r.sortBy(t,function(t){return t.guid===e?-1:1}):t},sync:function(){if(this.dataArray.length>0)try{this._syncOne(this.dataArray[0])}catch(e){console.error(e)}},_syncOne:function(e){var t=this;this.syncFn.call(null,e,function(n){t.store.remove(e.guid,e.clientId),t.dataArray.shift(),n&&t.sync()})}};e.exports=o},function(e,t,n){(function(r,o,i){function a(e){return e&&e.__esModule?e:{default:e}}function s(e){var t=window.cow.favicons,n=B.faviconNode,r=t.default;if(n.length>0)switch(e=e||window.cow.pageType){case"home":r=t.default;break;case"folder":r=t.folder;break;case"doc":r=t.doc;break;case"spreadsheet":case"sheet":r=t.sheet}if(n.attr("href")!==r){if(i.msie)return;n.attr("href",r)}}Object.defineProperty(t,"__esModule",{value:!0});var l=n(9),u=a(l),c=n(5),f=a(c),d=n(884),p=a(d),h=n(885),m=a(h),g=n(887),_=a(g),v=n(48),y=a(v),b=n(628),w=a(b),C=n(629),S=a(C),x=n(579),T=a(x),E=n(710),M=a(E),A=n(0),k=a(A),R=n(13),I=a(R);n(888);var O=n(433),D=a(O),P=n(700),N=a(P),F=n(627),L=n(576),H=a(L),V=n(630),j=a(V),B={headerWrap:r("#header-wrap"),listViewWrap:r("#list-view-wrap"),docViewWrap:r("#doc-view"),padViewWrap:r("#pad-view"),qlViewWrap:r("#ql-view"),spreadsheetViewWrap:r("#spreadsheet-view"),sheetViewWrap:r("#sheet-view"),feedback:r(".meiqia-feedback"),galleryBox:r("#gallery-box"),faviconNode:r("#favicon-link"),headNode:r("head"),bodyNode:r("body")},U=!1,W=null,z={checkNewVersion:function(e,t){window.cow._needReload&&(window.location.href=e.path),t()},checkNewSeq:function(e,t){window.cow.usingNewSeq=!1;var n=(0,j.default)(e.pathname);(0,H.default)(n).then(function(e){window.cow.usingNewSeq=e,t()})},setPageType:function(e,t){var n=e.path,r=/^\/(desktop|recent|favorites)/,o=/^\/folder\/*/,i=/^\/doc\/\/*/,a=/^\/spreadsheet\/*/,s=/^\/sheet\/*/,l=/^\/newdoc\/\/*/,u=!0,c="";switch(r.test(n)?c="home":o.test(n)?c="folder":i.test(n)?c="doc":a.test(n)?c="spreadsheet":s.test(n)?c="sheet":l.test(n)?c="newdoc":u=!1,window.ga&&window.ga("send","event","visit",c,e.path),e.path){case"/recent":window.cow.listType="recent";break;case"/favorites":window.cow.listType="favorites";break;default:window.cow.listType="list"}u&&(window.cow.pageType=c),e.init||(window._czc&&window._czc.push(["_trackPageview",e.path]),window.ga&&window.ga("send","pageview",e.path)),t()},syncOfflineData:function(e,t){(0,N.default)(),(0,F.syncOfflineData)(),t()},renderHeader:function(){B.headerWrap.length>0&&(r(".header-avatar-wrap").children().remove(),W?W.update({type:cow.pageType,currentFile:cow.currentFile}):W=I.default.render(k.default.createElement(M.default,{type:cow.pageType,currentUser:cow.currentUser,currentFile:cow.currentFile}),document.getElementById("header-wrap"))),s()},hideLast:function(){z.renderHeader(),"doc"===window.cow.lastType?G.hide("doc"):"spreadsheet"===window.cow.lastType?K.hide():"sheet"===window.cow.lastType?X.hide():"newdoc"===window.cow.lastType?G.hide("newdoc"):window.cow.lastType&&Y.hide(),window.cow.loading=!1},exit:function(e,t){T.default.start(),window.cow.lastType=window.cow.pageType,window.cow.loading=!0,t()}},Y={show:function(){z.hideLast(),B.listViewWrap.removeClass("hide"),B.spreadsheetViewWrap.addClass("hide"),B.sheetViewWrap.addClass("hide"),B.padViewWrap.add(B.qlViewWrap).addClass("hide"),B.bodyNode.addClass("list"),r(".list-container").scrollTop(0),r("div.import").show()},render:function(e){""!==window.cow.welcomeFile&&location.search.indexOf("from=register")>0&&(location.href="/doc/"+window.cow.welcomeFile);var t=e.params.guid||"",n=!0;e.init&&(y.default.load(),n=!1),(0,p.default)({guid:t,isAjaxForce:n})},hide:function(){}},G={show:function(e){z.hideLast(),B.listViewWrap.addClass("hide"),B.spreadsheetViewWrap.addClass("hide"),B.sheetViewWrap.addClass("hide"),B.feedback.removeClass("hide"),B.bodyNode.removeClass("list"),"newdoc"===e?(B.padViewWrap.addClass("hide"),B.qlViewWrap.removeClass("hide")):(B.padViewWrap.removeClass("hide"),B.qlViewWrap.addClass("hide"))},init:function(e){var t=e.params.guid;y.default.load(t),window.cow.currentUser.id<0&&o.stop(),U=!1,window.cow.directory={firstOpen:!1,isOpened:!1,isRunTimer:null},window.cow.doceditor={},/^\/newdoc\/\/*/.test(e.path)?(0,_.default)(t,!0):(0,m.default)(t,!0)},hide:function(e){r("#pad-view-inner").removeClass("readonly commentable"),r(".image-resize-bar").removeClass("active"),B.docViewWrap.scrollTop(0),r("#doc-title-input").blur(),r("#doc-container").css("opacity",0),B.padViewWrap.add(B.qlViewWrap).removeClass("selection-unfold edit-mode"),r(".sidebar-body").removeClass("start-s-comment s-comment"),r("#doc-directory").children("ul").html('<li class="dir-not-found">添加标题后会在这里自动生成目录。</li>'),r("#display-selection .display-item").removeClass("pressed"),B.galleryBox.removeClass("modal"),r("#tempImageResizeStyle").remove(),r("#tempAttachmentStyle").remove(),f.default.clearDropdown(),"doc"===e?(u.default.notify("pad:dispose"),u.default.detach("caret:change")):"newdoc"===e&&u.default.notify("newpad:dispose"),u.default.notify("doc:goback")}},K={show:function(){z.hideLast(),B.listViewWrap.addClass("hide"),B.padViewWrap.add(B.padViewWrap).addClass("hide"),B.feedback.addClass("hide"),B.sheetViewWrap.addClass("hide"),B.spreadsheetViewWrap.removeClass("hide"),B.bodyNode.removeClass("list").addClass("spreadsheet"),D.default.reset(cow.currentFile.guid),u.default.notify("spreadsheet:enter")},init:function(e){var t=e.params.guid,n=e.params.sheetId;y.default.load(t),(0,w.default)(t,n,{isReadonly:!1})},hide:function(){B.spreadsheetViewWrap.removeClass("ready"),B.bodyNode.removeClass("spreadsheet"),B.feedback.removeClass("hide"),u.default.notify("handsontable:destroy"),window.cow.tempCurrentFile&&(window.cow.tempCurrentFile.content=null),window._collabClient&&window._collabClient.stop(),u.default.notify("spreadsheet:exit"),u.default.detach("handsontable:inited"),I.default.unmountComponentAtNode(document.getElementById("spreadsheet-view"))}},X={show:function(){z.hideLast(),B.listViewWrap.addClass("hide"),B.padViewWrap.add(B.padViewWrap).addClass("hide"),B.feedback.addClass("hide"),B.spreadsheetViewWrap.addClass("hide"),B.sheetViewWrap.removeClass("hide"),B.bodyNode.removeClass("list").addClass("spreadsheet"),D.default.reset(cow.currentFile.guid),u.default.notify("spreadsheet:enter")},init:function(e){var t=e.params.guid,n=e.params.sheetId;y.default.load(t),(0,S.default)(t,n,{isReadonly:!1})},hide:function(){B.sheetViewWrap.removeClass("ready"),B.bodyNode.removeClass("spreadsheet"),B.feedback.removeClass("hide"),window.cow.tempCurrentFile&&(window.cow.tempCurrentFile.content=null),u.default.notify("spreadsheet:exit"),I.default.unmountComponentAtNode(document.getElementById("sheet-view"))}},q=function(){if(!U){var e=o.current.replace("/doc/",""),t=history.state.isAjaxForce||!1;y.default.load(e),window.cow.currentUser.id<0&&o.stop(),(0,m.default)(e,t)}},J=function(e){U=e};u.default.attach("socket:reconnected",function(){if("doc"===window.cow.pageType){var e=/^\/doc\/*/,t=o.current;e.test(t)&&q()}});var Z=function(e,t){W=I.default.render(k.default.createElement(M.default,{type:cow.pageType,currentUser:cow.currentUser,currentFile:cow.currentFile}),document.getElementById("header-wrap")),t()};t.default={common:z,list:Y,doc:G,spreadsheet:K,sheet:X,setDocInit:J,preloadHeader:Z},e.exports=t.default}).call(t,n(2),n(23),n(262))},,,,,,,function(e,t){function n(e,t){return{type:"RECEIVE_INIT_SHEET",submittedCS:e,revision:t}}function r(e,t){return{type:"COMPOSE_USER_CHANGES",disableRecords:t,newChange:e}}function o(){return{type:"SEND_CHANGE"}}function i(){return{type:"SEND_OFFLINE_CHANGE"}}function a(e,t){return{type:"SEND_CHANGE_SUCCESS",revision:e,msgType:t}}function s(e,t){return{type:"NEW_CHANGE_FROM_SERVER",newChange:e,revision:t}}function l(e,t){return{type:"SEND_CLIENT_STATUS",status:e,isReconnect:t}}function u(){return{type:"OFFLINE"}}e.exports={receivedInitSheet:n,composeUserChanges:r,sendChange:o,sendOfflineChange:i,sendChangeSuccess:a,receivedNewChange:s,sendClientStatus:l,offline:u}},function(e,t,n){(function(r,o){function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(0),f=i(c),d=n(13),p=i(d),h=n(803),m=i(h),g=n(804),_=i(g),v=n(810),y=i(v),b=n(811),w=i(b),C=n(813),S=i(C),x=n(817),T=i(x),E=n(20),M=i(E),A=n(819),k=i(A),R=n(745),I=i(R),O=n(747),D=i(O),P=n(820),N=i(P),F=n(72),L=n(331),H=i(L),V=n(651),j=i(V),B=n(821),U=i(B),W=n(615),z=i(W),Y=n(5),G=i(Y),K=n(823),X=i(K),q=n(824),J=i(q),Z=n(825),Q=i(Z),$=["spreadsheet","sheet","doc","newdoc"],ee=function(e){function t(e){a(this,t);var n=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.isDingtalkPc=G.default.isDingtalkPc(),n.state={currentUser:r.assign({},e.currentUser),currentFile:e.currentFile,type:e.type,showEnterprisePayment:!1,enterprisePaymentType:"normal",enterprisePaymentDialogParams:null},n.closeEnterprisePaymentDialog=n.closeEnterprisePaymentDialog.bind(n),n.showEnterprisePaymentDialog=n.showEnterprisePaymentDialog.bind(n),n}return l(t,e),u(t,null,[{key:"propTypes",get:function(){return{currentUser:c.PropTypes.object.isRequired,currentFile:c.PropTypes.object,type:c.PropTypes.string,showEnterprisePayment:c.PropTypes.bool,enterprisePaymentType:c.PropTypes.string}}}]),u(t,[{key:"getChildContext",value:function(){return{showEnterprisePayment:this.showEnterprisePaymentDialog}}},{key:"componentDidMount",value:function(){(0,y.default)(),(0,I.default)()}},{key:"componentDidUpdate",value:function(e,t){if(t.showEnterprisePayment!==this.state.showEnterprisePayment){document.getElementById("enterprise-payment-wrapper")||o(document.body).append(o('<div id="enterprise-payment-wrapper"></div>'));var n=document.getElementById("enterprise-payment-wrapper");this.state.showEnterprisePayment?p.default.render(f.default.createElement(j.default,{type:this.state.enterprisePaymentType,open:this.state.showEnterprisePayment,onClose:this.closeEnterprisePaymentDialog,data:this.state.enterprisePaymentDialogParams}),n):p.default.render(f.default.createElement("div",null),n)}}},{key:"closeEnterprisePaymentDialog",value:function(){this.setState({showEnterprisePayment:!1})}},{key:"showEnterprisePaymentDialog",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"normal",t=arguments[1];this.setState({showEnterprisePayment:!0,enterprisePaymentType:e,enterprisePaymentDialogParams:t})}},{key:"update",value:function(e){this.setState(e)}},{key:"renderLeftHeader",value:function(){var e=this.state.type;if($.indexOf(e)>-1){var t=[f.default.createElement(T.default,{key:"file_info",currentFile:this.state.currentFile,currentUser:this.state.currentUser})];return this.isDingtalkPc&&t.push(f.default.createElement(U.default,{mode:"file",key:"dingtalk_external_entry"})),t}var n=this.state.currentUser.team,r=[],o=void 0;return n&&n.resources&&(o=f.default.createElement("img",{className:"header-logo-img",src:n.resources.desktopLogo})),r.push(f.default.createElement("a",{key:"shimo-logo",className:"header-logo "+(o?"":"logo-22"),href:"/desktop"},o)),this.isDingtalkPc&&r.push(f.default.createElement(U.default,{key:"dingtalk-entry"})),r}},{key:"renderRightHeader",value:function(){var e=this.state,t=e.type,n=e.currentUser,r=e.currentFile,o=[];return $.indexOf(t)>-1?(o=[f.default.createElement(k.default,{key:0}),f.default.createElement("div",{key:1,className:"header-item-wrap"},f.default.createElement(m.default,{currentUser:n}))],this.state.currentUser.id<0?o.push(f.default.createElement(H.default,{key:"star_file",currentFile:r,currentUser:n}),f.default.createElement(z.default,{key:"operations",file:r})):o.push(f.default.createElement(D.default,{key:"action_btns",file:r})),(0,F.checkIsExampleFile)()&&o.push(f.default.createElement(N.default,{key:"doc_guide_tip"}))):(o.push(f.default.createElement("div",{key:0,className:"header-item-wrap"},f.default.createElement(w.default,{currentUser:n}))),-1===["profile"].indexOf(t)&&o.push(f.default.createElement("div",{key:1,className:"header-item-wrap"},f.default.createElement(S.default,null))),o.push(f.default.createElement("div",{key:2,className:"header-item-wrap"},f.default.createElement(_.default,{onlyUnread:!0}))),o.push(f.default.createElement("div",{key:3,className:"header-item-wrap"},f.default.createElement(m.default,{currentUser:n})))),o}},{key:"render",value:function(){var e=this.state.type,t=(0,M.default)({header:!0,"file-header":$.indexOf(e)>-1,"old-sheet-header":"spreadsheet"===e}),n=-1===["sheet","spreadsheet"].indexOf(e)?"":"hide";return f.default.createElement("div",{id:"header",className:t},f.default.createElement("div",{className:n},f.default.createElement(X.default,null,f.default.createElement(J.default,{name:"meiqia"}),f.default.createElement(Q.default,{name:"userGuide"}))),f.default.createElement("div",{className:"h-container"},f.default.createElement("div",{className:"header-left-box list-header"},this.renderLeftHeader()),f.default.createElement("div",{className:"header-right-box"},this.renderRightHeader())))}}]),t}(c.Component);t.default=ee,ee.childContextTypes={showEnterprisePayment:f.default.PropTypes.func},e.exports=t.default}).call(t,n(1),n(2))},function(e,t){function n(e,t){window.cow.usingNewSeq&&t&&"COLLABROOM"===t.type||window.socket&&window.socket.emit(e,t)}e.exports={send:n}},,function(e,t,n){var r=n(269),o=n(150),i=r(o,"Map");e.exports=i},function(e,t,n){function r(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}var o=n(939),i=n(946),a=n(948),s=n(949),l=n(950);r.prototype.clear=o,r.prototype.delete=i,r.prototype.get=a,r.prototype.has=s,r.prototype.set=l,e.exports=r},function(e,t,n){function r(e,t){if(o(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!i(e))||(s.test(e)||!a.test(e)||null!=t&&e in Object(t))}var o=n(261),i=n(436),a=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;e.exports=r},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(1),u=n(2),c=n(176).v4,f=n(429),d=n(656).EventEmitter2,p=n(344)("collab:client"),h=n(434),m=[].slice,g={memory:n(717),localStorage:n(446)},_={etherpad:n(718),spreadsheet:n(719),quill:n(720)},v=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));n.id=e.id||c(),n.userId=e.userId,n.rev=e.rev,n.docType=e.docType,n.fileId=e.fileId,n.pullUrl=e.pullUrl.replace("{fileId}",n.fileId),n.composeUrl=e.composeUrl.replace("{fileId}",n.fileId),n.beforePipelining=e.beforePipelining||function(e){return f.resolve(e)},n.request=function(t){return(e.request||u.ajax)(t)},n.editor=_[e.type](e.editor);var i="string"==typeof e.store?g[e.store||"memory"]:e.store,a=void 0;try{a=new i({userId:n.userId,clientId:n.id})}catch(e){n.emit("warning","离线编辑功能暂不可用"),a=new g.memory({userId:n.userId,clientId:n.id})}return n.store=n.wrapStore(a),n.editor.setUserChangeNotificationCallback(function(){return n.compose()}),n.delayRunTimeouts={},n.onPullSuccess=n.onPullSuccess.bind(n),n.onPullError=n.onPullError.bind(n),n.onComposeSuccess=n.onComposeSuccess.bind(n),n.onComposeError=n.onComposeError.bind(n),p("id %s created",n.id),n.pull(),n}return i(t,e),s(t,[{key:"compose",value:function(){var e=Date.now();if(this.saving=!0,this.lastComposeTime&&e-this.lastComposeTime<800)return p("compose too ofter, delay run in %s ms",e-this.lastComposeTime),void this.delayRun(this.compose,e-this.lastComposeTime);this.lastComposeTime=e;var t=this.editor.getUncommittedChanges(this.waitingForResponse);if(t&&t.changeset){p("store offline data to localStorage",t);var n=l.assign({},t,{rev:this.rev});this.waitingForResponse?this.store.set(this.fileId,{committingCS:this._lastComposeData,userCS:n,docType:this.docType}):this.store.set(this.fileId,{committingCS:n,docType:this.docType})}if(!this.stopped){if(this.waitingForResponse)return void this.delayRun(this.compose,1e3);var r=this.editor.prepareUserChangeset();if(!r||!r.changeset)return void(this.saving=!1);p("id %s compose new cs based on rev %s",this.id,this.rev),r.rev=this.rev,p("id %s sending changeset rev: %s cs: %j",this.id,r.rev,r.changeset);var o=this._lastComposeData={fileId:this.fileId,clientId:this.id,rev:r.rev,changeset:r.changeset,apool:JSON.stringify(r.apool),guid:c().replace(/-/g,"")};this.request({url:this.composeUrl,method:"POST",success:this.onComposeSuccess,error:this.onComposeError,data:o}),this.waitingForResponse=!0}}},{key:"pull",value:function(){var e=this;return this.stopped&&this.reader?void this.reader.abort():this.reader?void this.read():void this.beforePipelining({url:this.pullUrl,data:{rev:this.rev,clientId:this.id},timeout:45e3}).then(function(t){return e.reader=h(t.url,t),e.read(),null}).catch(function(t){e.onPullError(t)})}},{key:"read",value:function(){var e=this;this.reader.read().then(function(t){return t.done?(e.reader.abort(),delete e.reader,"2"!==String(t.status)[0]?(setTimeout(function(){e.pull()},3e3),null):(e.pull(),null)):t.data.errorMessage?(e.onPullError(new Error(t.data.errorMessage)),null):(e.onPullSuccess(t.data),null)}).catch(function(t){e.onPullError(t)})}},{key:"resend",value:function(){this.stopped||this.request({url:this.composeUrl,method:"POST",success:this.onComposeSuccess,error:this.onComposeError,data:this._lastComposeData})}},{key:"onPullSuccess",value:function(e){if(this.editor.getInInternationalComposition&&this.editor.getInInternationalComposition())return void this.delayRun(this.onPullSuccess,1e3,e);for(var t=0;t<e.length;t++){var n=e[t];if("new"===n.type){p("id %s applyChangesToBase %j",this.id,n);try{this.editor.applyChangesToBase(n)}catch(e){this.onFatalError(e)}}else if("accept"===n.type){p("id %s accept commit %j",this.id,n),this.store.remove(this.fileId),this.waitingForResponse=!1,this.emit("accept");try{this.editor.applyPreparedChangesetToBase(n.rev)}catch(e){this.onFatalError(e)}}else("error"===n.type||n.errorMessage)&&this.stop(new Error(n.message||n.errorMessage));n.rev&&(this.rev=n.rev)}this.pull()}},{key:"onPullError",value:function(e){return console.log(e.message,e.stack),"bad_changeset"===e.message?(this.emit("bad_changeset",l.assign({rev:this.rev},this.editor.getUncommittedChanges())),this.stop(new Error("bad_changeset"))):(this.reader&&(this.reader.abort(),delete this.reader),this.delayRun(this.pull,2e3))}},{key:"onComposeSuccess",value:function(e,t,n){if(204!==n.status&&(e.data||e.code)){var r=new Error(e.message||JSON.stringify(e.data));r.status=e.status||e.code,this.onComposeError(r)}}},{key:"onComposeError",value:function(e){return console.error(e),this._isNetworkError(e)&&(this.state="OFFLINE"),this.delayRun(this.resend,1500)}},{key:"onFatalError",value:function(e){console.error(e),this.stop(e||new Error("服务器错误"))}},{key:"delayRun",value:function(e,t){var n=this,r=e.toString(),o=this.delayRunTimeouts[r],i=m.call(arguments).slice(2);o&&clearTimeout(o),this.delayRunTimeouts[r]=setTimeout(function(){return e.apply(n,i)},t)}},{key:"stop",value:function(e){p("id %s stopped",this.id),this.stopped=!0;for(var t in this.delayRunTimeouts)clearTimeout(this.delayRunTimeouts[t]);clearInterval(this.resendInterval),clearTimeout(this.waitingForResponseTimeout),e&&this.emit("error",e),setTimeout(this.removeAllListeners,0)}},{key:"_isNetworkError",value:function(e){if(!e)return!1;var t=String(e.message).toLowerCase();return[0,502,503,429,408].indexOf(e.status)>-1||t.indexOf("connect")>-1||t.indexOf("no available worker")>-1||t.indexOf("no available receiver")>-1||t.indexOf("socket hang up")>-1}},{key:"wrapStore",value:function(e){var t=this,n={};return["getAll","get","remove","set"].forEach(function(r){e&&"function"==typeof e[r]&&(n[r]=function(){e[r].apply(e,arguments),t.emit.apply(this,["store:"+r].concat(m.call(arguments,0)))})}),n}},{key:"state",set:function(e){"OFFLINE"===e&&clearTimeout(this.waitingForResponseTimeout),e!==this._state&&(this._state=e,p("id %s change state to %s",this.id,e),this.emit("save_state",e))},get:function(){return this._state}},{key:"saving",set:function(e){var t=this._saving=e;this.state=t?"SAVING":"SAVED"},get:function(){return this._saving}},{key:"waitingForResponse",set:function(e){var t=this;(this._waitingForResponse=e)?(this.lastSavingTime=Date.now(),this.waitingForResponseTimeout=setTimeout(function(){t.emit("error",new Error("accept_commit_timeout"))},3e4),this.resendInterval=setTimeout(function(){p("resend data due to 5s timeout"),t.resend()},5e3)):(this.saving=!1,this.lastSavedTime=Date.now(),clearTimeout(this.waitingForResponseTimeout),clearInterval(this.resendInterval))},get:function(){return this._waitingForResponse}}]),t}(d);e.exports=v},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(1),a=n(176).v4,s=function(){function e(t){var n=this;r(this,e),this.userId=t.userId,this.clientId=t.clientId,this.stack=t.stack||{};var o=this.stack,i=a();Object.keys(o).forEach(function(e){if(o[e]){var t=Object.keys(o[e]);t.forEach(function(r){t[0]&&/^[a-zA-Z0-9]{16}$/.test(t[0])&&(n.set(r,o[e][r],i),delete o[e][r])})}})}return o(e,[{key:"getAll",value:function(){return this.stack[this.userId]}},{key:"get",value:function(e,t){var n=t||this.clientId;return i.get(this.stack,this.userId+"."+n+"."+e)}},{key:"remove",value:function(e,t){var n=t||this.clientId;i.get(this.stack,this.userId+"."+n+"."+e)&&(delete this.stack[this.userId][n][e],0===Object.keys(this.stack[this.userId][n]).length&&delete this.stack[this.userId][n])}},{key:"set",value:function(e,t,n){var r=n||this.clientId,o=this.userId;i.set(this.stack,o+"."+r+"."+e,i.assign({guid:e},t))}}]),e}();e.exports=s},function(e,t,n){"use strict";e.exports=function(e){var t={};return["setUserChangeNotificationCallback","prepareUserChangeset","getUncommittedChanges","applyPreparedChangesetToBase","getInInternationalComposition"].forEach(function(n){t[n]=e[n].bind(e)}),t.applyChangesToBase=function(t){var n=t.changeset,r=t.author||"",o=t.apool,i=Number(t.authorId);e.applyChangesToBase(n,r,o,i,t.rev)},t}},function(e,t,n){"use strict";var r=n(53);e.exports=function(e){var t=e.store,n=e.actions,o=e._global;return{setUserChangeNotificationCallback:function(e){o.cow.curSheetComposeUserChange=e},prepareUserChangeset:function(){var e=t.getState().msg;return t.dispatch(n.sendChange()),{changeset:r.pack(e.userCS)}},getUncommittedChanges:function(e){var n=t.getState().msg,o=void 0;return o=e?n.userCS:n.committingCS.compose(n.userCS),{changeset:r.pack(o)}},applyPreparedChangesetToBase:function(){t.dispatch(n.sendChangeSuccess())},applyChangesToBase:function(e){t.dispatch(n.receivedNewChange(e.changeset,e.rev))}}}},function(e,t,n){"use strict";e.exports=function(e){var t={};return["setUserChangeNotificationCallback","prepareUserChangeset","getUncommittedChanges","applyPreparedChangesetToBase","applyChangesToBase"].forEach(function(n){t[n]=e[n].bind(e)}),t}},function(e,t,n){(function(t){e.exports=function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=76)}([function(e,t,n){function r(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}var o=n(11);n(78),r(o,n(20)),r(o,n(79)),o._Types=n(14),o._ArrayHelper=n(38),o._DateTimeHelper=n(37),o._NumberHelper=n(21),o._RegexHelper=n(15),o._StringHelper=n(16),o.SR={},o.SR.en=n(39),e.exports=o},function(e,t,n){var t=n(2),r=n(5);n(3),n(4);var o=n(93),i=o._productType;1===i?(n(29),n(17),n(23)):2===i?(n(17),n(23),n(29)):(n(23),n(29),n(17)),n(8),n(9),n(45),n(13),n(6),r&&(n(46),n(95),n(96),n(31)),n(97),n(47),n(54),n(98),n(99),n(100),n(101),n(102),n(55),n(103),n(48),n(24),r&&n(104),n(105),n(32),n(52),n(53),n(51),n(12),n(50),n(106),1!==i&&2!==i||o._replace(),t.SR={},t.SR.en=n(56),e.exports=t},function(e,t){e.exports={}},function(e,t,n){function r(e){return typeof e!==q}function o(e){return G.createElement(e)}function i(e){G.body&&G.body.insertBefore(e,Q)}function a(e,t,n){Object.defineProperty(e,t,{get:function(){return this._ps[t]},set:function(e){var r=this._ps[t];r!==e&&(this._ps[t]=e,n&&n(t,e,r))},enumerable:!0})}function s(e){return e.preventDefault?(e.preventDefault(),e.stopPropagation()):(e.cancelBubble=!1,e.returnValue=!1),!1}function l(){this._eventSuspended=0,this._init(),this._clickOutsideSheetCallBack=[]}function u(e,t){var n=o("span");return n.className=e,t&&(n.id=t),n.style.display="none",i(n),n}function c(e,t,n,r){e.addEventListener(t,n,r)}function f(e){var t=e.currentStyle,n=G.defaultView;return n&&n.getComputedStyle&&(t=n.getComputedStyle(e,"")),t}function d(e){if(!(Y._gcGlobal._eventSuspended>0)){var t=pe._getActiveElement(),n=t&&t._validationSelect;if(n&&P(n).isVisible())return;if(t&&t._eventHandler&&t._eventHandler._doKeyDown&&(t._eventHandler._doKeyDown(e),!t.isEditing())){var r=e.keyCode,o=e.ctrlKey,i=e.altKey;90!==r&&89!==r||!o||i?86===r&&o&&!i&&e.stopPropagation&&e.stopPropagation():s(e)}}}function p(e){if(!(Y._gcGlobal._eventSuspended>0)){var t=pe._getActiveElement();t&&t._eventHandler&&t._eventHandler._doKeyUp&&t._eventHandler._doKeyUp(e)}}function h(e){if(!(Y._gcGlobal._eventSuspended>0)){var t=pe._getActiveElement();t&&t._eventHandler&&t._eventHandler._doCompositionStart&&t._eventHandler._doCompositionStart(e)}}function m(e){return G.all===Z&&pe._getActiveElement()&&s(e),!1}function g(e,t){this.x=e,this.y=t}function _(e,t,n,r){var o=this;o.x=e,o.y=t,o.width=n,o.height=r}function v(e,t,n,r){var o=this;o.row=e,o.rowCount=n,o.col=t,o.colCount=r}function y(){}function b(e){this._sheet=e}function w(e,t,n,r){var o=t._id,i=ve._cache,a=i[e.id];a||(a=i[e.id]={validator:e,sheet:t});var s=a[o];s||(s=a[o]={});var l=n+"_"+r;s[l]||(s[l]=!0)}function C(e,t,n){var r=e._id,o=ve._cache;for(var i in o)if(o.hasOwnProperty(i)){var a=o[i];if(a){var s=a[r],l=t+"_"+n;if(s&&s[l]){if(delete s[l],!j(s))return;if(delete a[r],!j(a))return;return void delete o[i]}}}}function S(e){var t=e._matrix||{scaleX:1,scaleY:1,translateX:0,translateY:0,skewX:0,skewY:0,orgTranslateX:0,orgTranslateY:0};return e._matrix=t,t}function x(){var e=Y.screen,t=e.deviceXDPI,n=Y.devicePixelRatio||(t?t/e.logicalXDPI:1);if(n<=1)return 1;var r=20*n,o=re(r);return o-r>.82?o/20:re(100*n)/100}function T(e,t){e&&(e._gcDPIScaleX=t)}function E(e,t){e&&(e._gcDPIScaleY=t)}function M(e,t){e._gcLogicWidth=t}function A(e,t){e._gcLogicHeight=t}function k(){return we._ctx||(we._ctx=o("canvas").getContext("2d"))}function R(e){for(var t=[],n=0,r=le,o=0;o<e.length;o++){t[n]===Z&&(t[n]="");var i=e.charAt(o),a="";o+1<e.length&&(a=e.charAt(o+1)),i===r&&a!==r?(t[n]+=i,n++):t[n]+=i}return t}function I(e){for(var t=e.length-1;" "===e.charAt(t);)t--;return t!==e.length-1&&(e=e.substring(0,t+1)),e}function O(e,t){var n=[],r=k();if(!r)return n;var o=r.measureText(e).width,i=o/e.length,a=ee(t/i);if(o>t)for(var s=!1;;){var l=e.substring(0,a),u=r.measureText(l).width;if(u===t||s&&u<t)return n.push(l),n.push(e.substring(l.length)),n;if(u>t){if(1===l.length){var c=e.substring(l.length);return 0!==we._measureText(c,Z,!0)?(n.push(l),n.push(c)):n.push(e),n}a-=1,s=!0}else{var f=(t-u)/i;f=f>=1?f:1,a+=f}}else e!==Q&&e.length>0&&n.push(e);return n}function D(e,t){var n=[],r=R(e),o=k();if(!o)return n;for(var i=o.measureText(e).width,a=i/e.length,s=oe(t/a+"",10),l=0,u=0,c=0,f=0,d=[],p=!1;f<r.length;){if(!1===p){var h=r[f];if(d.push(h),(u+=h.length)<s){f++;continue}c=u,u=0}var m=we._measureText(d.join(""),Z,!0);if(m>t){var g=d.pop();if(0===d.length){var _=O(g,t);d.push(_[0]),2===_.length?r[f]=_[1]:f++,n[l++]=d.join(""),p=!1,d=[]}else p=!0,f--}else m<t&&!0===p||m===t?(p=!1,n[l++]=I(d.join("")),d=[],f++):m<t&&(f++,u=c)}return 0!==d.length&&(n[l]=I(d.join(""))),n}var P=n(4).GC$,N=n(0),F=n(5),L=n(10),t=n(2),H=P.each,V=P.extend,j=P.isEmptyObject,B=N._NumberHelper,U=N._DateTimeHelper._localeFormat,W=N._DateTimeHelper._toOADate,z=L&&L.GeneralFormatter,Y=window,G=document,K="boolean",X="date",q="undefined",J="function",Z=void 0,Q=null,$=Math.floor,ee=Math.ceil,te=Math.min,ne=Math.max,re=Math.round,oe=parseInt,ie=parseFloat,ae=isNaN,se="px",le=" ",ue=".",ce="string",fe="number";t.productInfo={productVersion:"10.0.1"},t.CursorResource={ResizeCol:"col-Resize",ResizeRow:"row-resize",ResizeHiddenCol:"w-resize",ResizeHiddenRow:"n-resize"},t.getTypeFromString=function(e){var t=!1,n=Y;if(typeof e===ce){for(var r=e.split(ue),o=0,i=r.length;o<i&&n;o++)n=n[r[o]];n&&o===i&&i>0&&(t=!0)}return t?n:Z},t.findControl=function(e){return typeof e===ce&&(e=G.getElementById(e)),P(e).data("workbook")};var de={};de._cancelDefault=s,de._getHAlignByValueType=function(e,t,n){if(3===e){var r=P.getType(t);e=n&&"@"===n?0:r===K?1:r===fe||r===X?2:0}return e},de._toString=function(e){var t=P.getType(e);return e=e===Q||e===Z?"":t===K?e.toString().toUpperCase():t===X?W(e)<1?U(e,"HH:mm:ss"):0===e.getHours()&&0===e.getMinutes()&&0===e.getSeconds()&&0===e.getMilliseconds()?U(e,"yyyy/MM/dd"):U(e,"yyyy/MM/dd HH:mm:ss"):e.toString()},de._applyBackgroundImageLayout=function(e,t,n,r,o,i){var a=P(e),s=t,l=n,u="background-position",c="background-size",f="auto",d="0%",p="50%",h="100%";switch(i){case 0:a.css(u,d+le+d).css(c,h+le+h);break;case 1:var m=p,g=p;r>s&&(m=d),o>l&&(g=d),a.css(u,m+le+g).css(c,f+le+f);break;case 2:var _=0,v=0,y=s,b=l;l>0&&o>0&&s/l>r/o?(y=r/o*l,_=_+s/2-y/2):s>0&&r>0&&l/s>o/r&&(b=o/r*s,v=v+l/2-b/2),a.css(u,_+se+le+v+se).css(c,y+se+le+b+se);break;case 3:a.css(u,d+le+d).css(c,f+le+f)}},de._device=de.device=function(){var e,t,n,r,o=navigator.userAgent,i=o.match(/iPad/i);return i&&(e=i[0])&&(t="ipad"===e.toLowerCase()),i=o.match(/iPhone/i),i&&(e=i[0])&&(n="iphone"===e.toLowerCase()),i=o.match(/android/i),i&&(e=i[0])&&(r="android"===e.toLowerCase()),{ipad:t,iphone:n,android:r}},de.isMobile=function(){var e=de._device();return e.ipad||e.iphone||e.android},de._isMacOS=function(){var e=navigator.platform;return e&&e.indexOf("Mac")>-1},de._isStringNumber=function(e){if(e===Z||e===Q)return!1;var t=e.toString();return t=B._replaceCultureSymbolToNormal(t),!ae(Number(""===t.trim()?NaN:t))||/^[1-9]\d{0,2}(?:(,\d{3})*|\d*)(?:\.\d*)?$/.test(t)},de._parseText2Value=function(e,t,n,r){var o=Q;if(e&&(e.formatter?typeof(o=e.formatter)===ce&&z&&(o=new z(o)):o=e._autoFormatter),o&&!o.isAuto){var i=Q;try{var a=t,s=B._replaceCultureSymbolToNormal(t);if(de._isStringNumber(s)&&(a=s),typeof(i=o.parse(a))===fe)return i}catch(e){}return i===Z||i===Q?t:i}if(n){var l,u={},c=Q;if(z)try{c=(new z).getPreferredDisplayFormatter(t,u)}catch(e){}return l=u.value,typeof l===fe?t=l:de._isStringNumber(t)&&(l=u.value=t),r&&(r.value=c),l!==Z&&l!==Q?l:t}return t},de._getPreferredZIndex=function(e){for(var t=G.body,n=e;n&&n.parentElement&&n.parentElement!==t;)n=n.parentElement;var r,o=1e3;return n&&n.parentElement===t&&(r=oe(P(n).css("z-index")),ae(r)||(o+=r)),o},de._getLinearGradientColors=function(e){if(!e)return[];var t=e.indexOf("("),n=e.lastIndexOf(")"),r=e.substring(t+1,n);if(!r)return[];for(var o=[],i=0,a="",s=0,l=0;l<r.length;)s=r.indexOf("rgb",i),l=r.indexOf("rgb",i+1),-1===l&&(l=r.length),a=r.substring(s,l),o.push(a),i=s=l;for(var u=[],c=0,f=o.length;c<f;c++){var d=o[c],p=d.indexOf(")"),h=d.substring(0,p+1),m=ie(d.substring(p+1,d.length));ae(m)&&(c===f-1?m=100:c<=1&&(m=0)),(h||0!==c)&&(m/=100,u.push({color:h,point:m}))}return u},de._getColumnAutoFitValue=function(e,t,n,r){var o=t._render,i=0,a=[n];1===r&&(3===n?a.push(1):2===n&&a.push(0));for(var s=0;s<a.length;s++)for(var l=0,u=a[s],c=t.getRowCount(u);l>=0&&l<c;){var f=t._getSpanModel(u).find(l,e);if(f&&(f.col<e||f.colCount>1||f.row<l))l=f.row+f.rowCount;else{if(t.getRowHeight(l,n)>0){var d=t.getActualStyle(l,e,u),p=0,h=d.cellType||t._getDefaultCellType(u);if(h){var m=d.font||o._getDefaultFont();d.font=o._getZoomFont(m);var g=t.rowFilter&&t.rowFilter(),_=!(!g||!g._isFilterHeader(l,e,u));if(!_&&3===u){var v=t.tables?t.tables.find(l,e):Q;v&&v.showHeader()&&v.headerIndex()===l&&v.rowFilter()&&v.filterButtonVisible(e-v.range().col)&&(_=!0)}var y=d.formatter?d.formatter:d._autoFormatter,b={sheet:t,row:l,col:e,sheetArea:u},w=t.getValue(l,e,u),C=h.format(w,y,b);if(p=h._getAutoFitContainerWidth(w,C,d,t._zoomFactor,b),_){var S=te(t._zoomFactor,1),x=oe((t.defaults.rowHeight*S).toString(),10);p+=x}}p>i&&(i=p)}3===u?l=de._nextAutoFitRow(l,e,t,u):l++}}return 0===i?i=t.defaults.colWidth:i+=ee(3/t._zoomFactor),ee(i)},de._nextAutoFitRow=function(e,t,n,r){for(var o=-1,i=n.getRowCount(r),a=e+1;a<i;a++){if(n.getText(a,t,r)){o=a;break}var s=n.getActualStyle(a,t,r);if(s&&s.cellType){o=a;break}}return o},de._getRowAutoFitValue=function(e,t,n,r){var o=t._render,i=0,a=[n];1===r&&(3===n?a.push(2):1===n&&a.push(0));for(var s=0;s<a.length;s++){n=a[s];for(var l=0,u=t.getColumnCount(n);l>=0&&l<u;){var c=t._getSpanModel(n).find(e,l);if(c&&(c.row<e||c.rowCount>1||c.col<l))l=c.col+c.colCount;else{if(t.getColumnWidth(l,n)>0){var f=t.getActualStyle(e,l,n),d=f.font||o._getDefaultFont();f.font=o._getZoomFont(d);var p=0,h=t.getCellType(e,l,n);if(h){var m=t.getText(e,l,n),g=t.getValue(e,l,n),_={sheet:t,row:e,col:l,sheetArea:n};p=h._getAutoFitContainerHeight(g,m,f,t._zoomFactor,_)}p>i&&(i=p)}3===n?l=de._nextAutoFitColumn(e,l,t,n):l++}}}return 0!==i&&(i+=ee(3/t._zoomFactor),i=Math.max(i,t.defaults.rowHeight)),ee(i)},de._nextAutoFitColumn=function(e,t,n,r){for(var o=-1,i=n.getColumnCount(r),a=t+1;a<i;a++){if(n.getText(e,a,r)){o=a;break}var s=n.getActualStyle(e,a,r);if(s&&s.cellType){o=a;break}}return o},de._formatValue2Text=function(e,t,n){if(n){var r=n._activeRowIndex,o=n._activeColIndex,i=e.formatter?e.formatter:e._autoFormatter;if(z&&t!==Q&&t!==Z){var a;if(i&&i.isAuto){a=typeof t===fe;var s=de._isStringNumber(t);!a&&s&&(t=B._replaceCultureSymbolToNormal(t)),t=i.getPreferredEditingFormatter?i.getPreferredEditingFormatter(t).format(t):t}else if(typeof i===ce&&(i=new z(i)),i)try{if(t instanceof Date){var l=F&&F.Convert._toDateTime(t);l&&(t=l),i=new z(W(t)<1?"HH:mm:ss":0===t.getHours()&&0===t.getMinutes()&&0===t.getSeconds()&&0===t.getMilliseconds()?"YYYY/MM/DD":"YYYY/MM/DD HH:mm:ss"),n._editingTimeValue=!0,t=i.format(t)}else typeof t===fe&&(t=B._replaceNormalToCultureSymbol(t.toString()))}catch(e){t=n.getText(r,o)}else t=n.getText(r,o)}}return t!==Q&&t!==Z&&(t=de._toString(t)),t},de._browser=de.browser=function(){function e(e){e=e.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}}function t(){var e=Q,t=!1;try{new ActiveXObject("")}catch(t){e=t.name}try{t=!!new ActiveXObject("htmlfile")}catch(e){t=!1}return!(t="ReferenceError"===e||!1!==t)}var n=navigator.userAgent,r=e(n),o={};r.browser&&(o[r.browser]=!0,o.version=r.version),o.chrome?o.webkit=!0:o.webkit&&(o.safari=!0),n.indexOf("PhantomJS")>=0&&(o.safari=!1,o.chrome=!0);var i=n.toLowerCase();i.indexOf("compatible")<0&&/(trident)(?:.*? rv ([\w.]+)|)/.exec(i)!==Q&&o&&(o.mozilla=Z,o.msie=!0);var a=/Edge\/\d+/.exec(n);return a!==Q&&a.length>0&&o&&(o.webkit=Z,o.chrome=Z,o.msie=!0,o.edge=!0,o.version=a[0].substr(a[0].indexOf("/")+1)),o.msie&&t()&&(o.metroMode=!0),o}(),de._createElement=o,de._isDefined=r,de._defProperty=function(e,t,n,r){var o=e,i=t,a=function(e,t){var a=this;a.hasOwnProperty("_ps")||(a._ps={});var s=a._ps;if(0===arguments.length)return s[o]!==Z?s[o]:i;if(!1===t||!r||r.call(a,e)){var l=s[o]!==Z?s[o]:i;l!==e&&(s[o]=e,!1!==t&&n&&n.call(a,e,l))}return a};return a.isDefault=function(e){return e===i},a},de._createOptions=function(e,t){var n={};return n._ps={},N._Types._each(e,function(e){a(n,e,t)}),n},de._getDistance=function(e,t,n,r,o){for(var i=te(t,n),a=ne(t,n),s=0,l=i;l<a&&(s+=r?e._getZoomRowHeight(l,3):e._getZoomColumnWidth(l,3),!(o&&s>o));l++);return s},de._getRelativeOffset=function(e,t){var n=0,r=0;if(e!==t){var o=P(e).offset(),i=P(t).offset();n=o.left-i.left,r=o.top-i.top}return{_top:r,_left:n}},t._util=t.util=de;var pe=t._FocusHelper={};pe._isActiveElement=function(e){return pe._getActiveElement()===e&&e._eventHandler&&e._eventHandler._focusElem},pe._getActiveElement=function(){return Y._gcGlobal.activeElement},pe._setActiveElement=function(e,t){function n(e){function t(t){for(var n=0;n<=2;n++){var a=t.call(r,n);a&&0!==a.width&&0!==a.height&&(e._dirty=!0,o._paintBody(i,a))}}if(e&&!pe._isActiveElement(e)&&e.parent&&e.parent.options.hideSelection){var n,r=e._getSheetLayout(),o=e._render,i=o._getCtx(),a=e.getSelections();for(n=0;n<a.length;n++){var s=a[n],l=e._getRangeWholeRect(s);l.width>=0&&l.height>=0&&(l.x-=9,l.y-=9,l.width+=18,l.height+=30,o._copyDoubleBufferRect(l))}l=r._headerCornerRect(),e._dirty=!0,o._paintBody(i,l),t(r._rowHeaderRect),t(r._colHeaderRect)}}var r=pe._getActiveElement();Y._gcGlobal.activeElement=e,e===r||t||(r&&(r.endEdit(),n(r),r._disposeValidationUI&&r._disposeValidationUI()),e&&e._render._repaintSelection())};var he=l.prototype={_createDummyObjects:function(){he._getDummyHeader(),he._getDummyContent(),he._getDummyHover(),he._getDummyHighlight()},_getDummyHeader:function(){var e="gc-theme-version ui-widget-header ui-state-default wijmoThemeHelper btn-default",t="span."+e.split(le).join(ue);return he._dummyHeader?P(G).find(t).length<=0&&i(he._dummyHeader):he._dummyHeader=u(e),he._dummyHeader},_getDummyContent:function(){var e="gc-theme-version ui-widget-content wijmoThemeHelper btn-default",t="span."+e.split(le).join(ue);return he._dummyContent?P(G).find(t).length<=0&&i(he._dummyContent):he._dummyContent=u(e),he._dummyContent},_getDummyHover:function(){var e="gc-theme-version ui-state-hover wijmoThemeHelper btn-primary",t="span."+e.split(le).join(ue);return he._dummyHover?P(G).find(t).length<=0&&i(he._dummyHover):he._dummyHover=u(e),he._dummyHover},_getDummyHighlight:function(){var e="gc-theme-version ui-state-highlight wijmoThemeHelper btn-warning",t="span."+e.split(le).join(ue);return he._dummyHighlight?P(G).find(t).length<=0&&i(he._dummyHighlight):he._dummyHighlight=u(e),he._dummyHighlight},_getDummyElement:function(){var e="gcDummyElement";return he._dummyElement?P(G).find("#"+e).length<=0&&i(he._dummyElement):he._dummyElement=u("gc-theme-version",e),he._dummyElement},_init:function(){var e=this;e._eventSuspended=0,c(Y,"keydown",d,!0),c(Y,"keyup",p,!0),c(Y,"compositionstart",h,!0),c(Y,"selectstart",m,!0),"mousedown touchstart MSPointerDown pointerdown".split(le).forEach(function(t){P(G).bind(t,function(t){var n=pe._getActiveElement();if(n){var r=he._getUIElement(t.target);e._clickOutsideSheetCallBack.forEach(function(e){e&&e(n,r)});var o=r&&"gcAttachedFormulaTextBox"===r.getAttribute("gcUIElement");if(!r&&n.endEdit&&!o){n.endEdit();var i=de._device();if(i.ipad||i.iphone){var a=n._eventHandler;a&&a._setFocusToReadonlyFocusElem&&a._setFocusToReadonlyFocusElem()}}r||pe._setActiveElement(Q)}})}),P(G).bind("DOMContentLoaded",function(){he._createDummyObjects()})},_getUIElement:function(e){for(var t=e;t&&"BODY"!==t.tagName&&typeof t.getAttribute===J;){var n=t.getAttribute("gcUIElement");if(n||(n=t.gcUIElement),n)return t;t=t.parentNode}return Q},_getExternalThemeStyle:function(e,t){var n=he._getDummyHeader();1===e||2===e?n=he._getDummyHighlight():4===e&&(n=he._getDummyHover());var r=n.className;P(n).removeClass(r).addClass(t);var o=f(n),i={backgroundColor:o.backgroundColor,backgroundImage:o.backgroundImage};P(n).addClass(r),o=f(n);var a={backgroundColor:o.backgroundColor,backgroundImage:o.backgroundImage,color:o.color,zIndex:o.zIndex};return a.borderLeftColor=o.borderLeftColor,a.borderRightColor=o.borderRightColor,a.borderBottomColor=o.borderBottomColor,a.borderBottomWidth=o.borderBottomWidth,a.borderTopColor=o.borderTopColor,a.borderRightWidth=o.borderRightWidth,a.backgroundImage===i.backgroundImage&&a.backgroundColor!==i.backgroundColor&&(a.backgroundImage=Z),P(n).removeClass(t),a},_getStyleByCssClass:function(e){var t=he._getDummyElement();P(t).removeClass(t.className).addClass("gc-theme-version "+e);var n=f(t);return V({},n)},_getThemeContentStyle:function(e){var t=he._getDummyContent();P(t).removeClass(t.className).addClass("gc-theme-version ui-widget-content wijmoThemeHelper btn-default "+e);var n=f(t);return V({},n)},_suspendEvent:function(){Y._gcGlobal._eventSuspended++},_resumeEvent:function(){var e=Y._gcGlobal;--e._eventSuspended<0&&(e._eventSuspended=0)}};Y._gcGlobal||(Y._gcGlobal=new l),t.VisualState={normal:0,highlight:1,selected:2,active:3,hover:4},t.SortState={none:0,ascending:1,descending:2};var me=t._ThemeStyleHelper={styleCache:{}};me._getString=function(e){return{0:"normal",1:"highlight",2:"selected",3:"active",4:"hover"}[e]||""},me._getVisualStateThemeStyle=function(e,t){var n=me._getString(e)+t,r=me.styleCache;return r[n]||(r[n]=he._getExternalThemeStyle(e,t)),r[n]},me._getCssClassThemeStyle=function(e){var t=e,n=me.styleCache;return n[t]||(n[t]=he._getStyleByCssClass(e)),n[t]},me._getContentThemeStyle=function(e){var t="content"+e,n=me.styleCache;return n[t]||(n[t]=he._getThemeContentStyle(e)),n[t]},me._clearCache=function(){me.styleCache={}},g.prototype.clone=function(){return new g(this.x,this.y)},t.Point=g,_.prototype={intersect:function(e,t,n,r){var o=this;return e<o.x+o.width&&o.x<e+n&&t<o.y+o.height&&o.y<t+r},intersectRect:function(e){return this.intersect(e.x,e.y,e.width,e.height)},contains:function(e,t){var n=this;return e<n.x+n.width&&n.x<e&&t<n.y+n.height&&n.y<t},containsRect:function(e){return this.contains(e.x,e.y)&&this.contains(e.x+e.width,e.y+e.height)},getIntersectRect:function(e){return this.getIntersect(e.x,e.y,e.width,e.height)},getIntersect:function(e,t,n,r){var o=this,i=o.x,a=o.y,s=o.x+o.width,l=o.y+o.height,u=e,c=t,f=e+n,d=t+r,p=ne(i,u),h=ne(a,c),m=te(s,f),g=te(l,d),v=p,y=h,b=m-p,w=g-h;return b>0&&w>0?new _(v,y,b,w):Q},round:function(){var e=this;e.x=$(e.x),e.y=$(e.y),e.width=ee(e.width),e.height=ee(e.height)},clone:function(){var e=this;return new _(e.x,e.y,e.width,e.height)}},t.Rect=_,v.prototype={intersect:function(e,t,n,r){var o=this;return(-1===e||-1===o.row||o.row<e+n&&e<o.row+o.rowCount)&&(-1===t||-1===o.col||o.col<t+r&&t<o.col+o.colCount)},getIntersect:function(e,t,n){var r=this;if(!e||!r.intersect(e.row,e.col,e.rowCount,e.colCount))return Q;var o=-1===r.col?n-1:r.col+r.colCount-1,i=-1===e.col?n-1:e.col+e.colCount-1,a=-1===r.row?t-1:r.row+r.rowCount-1,s=-1===e.row?t-1:e.row+e.rowCount-1,l=ne(r.col,e.col),u=te(o,i),c=ne(r.row,e.row),f=te(a,s);return new v(c,l,-1===c?-1:f-c+1,-1===l?-1:u-l+1)},contains:function(e,t,n,r){var o=this,i=arguments.length,a=!1;return 2!==i&&4!==i||(2===i&&(n=1,r=1),a=(-1===o.row||o.row<=e&&e+n<=o.row+o.rowCount)&&(-1===o.col||o.col<=t&&t+r<=o.col+o.colCount)),a},containsRange:function(e){return this.contains(e.row,e.col,e.rowCount,e.colCount)},offset:function(e,t){var n=this,r=n.col,o=n.row;return-1!==r&&(r+=e),-1!==o&&(o+=t),new v(o,r,n.rowCount,n.colCount)},union:function(e){var t=this,n=te(t.row,e.row),r=te(t.col,e.col),o=ne(t.row+t.rowCount-1,e.row+e.rowCount-1),i=ne(t.col+t.colCount-1,e.col+e.colCount-1);return n>=0&&r>=0?new v(n,r,o-n+1,i-r+1):n>=0?new v(n,-1,o-n+1,-1):r>=0?new v(-1,r,-1,i-r+1):new v(-1,-1,-1,-1)},equals:function(e){var t=this;return e instanceof v&&t.row===e.row&&t.col===e.col&&t.rowCount===e.rowCount&&t.colCount===e.colCount}},t.Range=v,t._createRange=function(e,t,n,r){return new v(e,t,n,r)},y._getColor=function(e,t){if(e&&t){var n=e._currentTheme;if(n)return n.getColor(t)}return t},y._getFont=function(e,t){if(e&&t){var n=e._currentTheme;return n?n.getFont(t):t}return Q},t._ThemeContext=y;var ge={};H(["ValidationError","CellClick","CellDoubleClick","EnterCell","LeaveCell","ValueChanged","TopRowChanged","LeftColumnChanged","InvalidOperation","RangeFiltering","RangeFiltered","TableFiltering","TableFiltered","RangeSorting","RangeSorted","ClipboardChanging","ClipboardChanged","ClipboardPasting","ClipboardPasted","ColumnWidthChanging","ColumnWidthChanged","RowHeightChanging","RowHeightChanged","AutoFitRowHeightChanging","AutoFitRowHeightChanged","DragDropBlock","DragDropBlockCompleted","DragFillBlock","DragFillBlockCompleted","EditStarting","EditStarted","EditChange","EditEnding","EditEnd","EditEnded","RangeGroupStateChanging","RangeGroupStateChanged","SelectionChanging","SelectionChanged","SheetTabClick","SheetTabDoubleClick","SheetNameChanging","SheetNameChanged","UserZooming","UserFormulaEnter","UserFormulaEntered","CellChanged","ColumnChanged","RowChanged","ActiveSheetChanging","ActiveSheetChanged","SparklineChanged","RangeChanged","ButtonClicked","EditorStatusChanged","FloatingObjectChanged","FloatingObjectSelectionChanged","FloatingObjectCuting","PictureChanged","FloatingObjectRemoving","FloatingObjectRemoved","PictureSelectionChanged","FloatingObjectLoaded","TouchToolStripOpening","CommentChanged","CommentRemoving","CommentRemoved","SlicerChanged","ResetBinding","InitBinding","BeforeDragDrop","FormulatextboxActiveSheetChanging","FormulatextboxActiveSheetChanged","FormulatextboxEditStarted","FormulatextboxEnterCell","FormulatextboxEditEnded","FormulatextboxRangeChanged","FormulatextboxEditing"],function(e,t){ge[t]=t}),t.Events=ge,b.prototype={_getCellOverflowBuilder:function(e,t,n){var r=this._cellOverflowBuilderCache,o=e<<4+t;if(!r)return n();var i=r[o];return i||(i=n(),r[o]=i),i},_getConditionalFormat:function(e,t){var n=this._conditionalFormatCache;if(n){var r=n[e];if(r)return r[t]}return Q},_setConditionalFormat:function(e,t,n,r){var o=this._conditionalFormatCache;o&&((o[e]||(o[e]={}))[t]={d:n,i:r})},_getValue:function(e,t,n){var r=this,o=r._sheet,i=r._valueCache;if(n===Z&&(n=3),!i)return o.getValue(e,t,n);var a,s,l=i[n];return l||(l={},i[n]=l),a=l[e],a||(a={},l[e]=a),s=a[t],s===Z&&(s=o.getValue(e,t,n),a[t]=s),s},_getActualStyle:function(e,t,n){var r=this,o=r._sheet,i=r._styleCache;if(n===Z&&(n=3),!i)return o.getActualStyle(e,t,n,!1,!1);var a,s,l=i[n];return l||(l={},i[n]=l),a=l[e],a||(a={},l[e]=a),s=a[t],s||(s=o.getActualStyle(e,t,n,!1,!0),a[t]=s),s.clone(!0)},_getZoomRowHeight:function(e){var t=this,n=t._sheet,r=t._rowHeightCache;if(!r)return n._getZoomRowHeight(e);var o=r[e];return o===Z&&(o=r[e]=n._getZoomRowHeight(e)),o},_getZoomColWidth:function(e){var t=this,n=t._sheet,r=t._colWidthCache;if(!r)return n._getZoomColumnWidth(e);var o=r[e];return o===Z&&(o=r[e]=n._getZoomColumnWidth(e)),o},_getRowGroups:function(e){var t=this;return t._valueCache?(t._rowGroups||(t._rowGroups=e()),t._rowGroups):e()},_getColGroups:function(e){var t=this;return t._valueCache?(t._colGroups||(t._colGroups=e()),t._colGroups):e()},_startCacheBeforPan:function(){var e=this;e._isCaching=!0,e._cellOverflowBuilderCache={},e._conditionalFormatCache={},e._valueCache={},e._styleCache={},e._rowHeightCache={},e._colWidthCache={}},_endCache:function(){this._isCaching=!1},_clearCacheEndPan:function(){var e=this;e._isCaching=!1,e._cellOverflowBuilderCache=Q,e._conditionalFormatCache=Q,e._valueCache=Q,e._styleCache=Q,e._colWidthCache=Q,e._rowHeightCache=Q,e._rowGroups=Q,e._colGroups=Q}},t._CachePool=b;var _e=t._CacheMgr={_cached:!1,_formatterCache:{},_formattedTextCache:{}};_e._startCache=function(e,t,n,r,o){_e._cached=!0;var i=e.tables;if(i&&i._has(t,n,r-t+1,o-n+1))for(var a=-1,s=_e._visibleRowIndexCache=[],l=0;l<=r;l++)e.getRowVisible(l)?(a++,s[l]=a):s[l]=-1},_e._clearCache=function(){_e._visibleRowIndexCache=Q,_e._cached=!1},_e._getFormatter=function(e){var t=_e._formatterCache;return t[e]||(t[e]=z?new z(e):Q)},_e._getFormattedText=function(e,t,n){var r=_e._formattedTextCache;if(z){var o=r[t]||(r[t]={}),i=o[e];if(i)return n&&(n.value=i.color),i.text;var a=_e._formatterCache,s=a[t]||(a[t]=new z(t)),l={},u=s.format(e,l),c=o[e]={};return c.text=u,c.color=l.value,n&&(n.value=l.value),u}return e.toString()},_e._getFormattedTextByStyle=function(e,t,n,r){var o=t.cellType||e._getDefaultCellType(),i=t.formatter||t._autoFormatter;return o.format(n,i,r,Q)},_e._clearFormatCache=function(){_e._formatterCache={},_e._formattedTextCache={}};var ve=t._DataValidatorCache={_cache:{}};ve._setStyle=function(e,t,n,r){if(typeof e===ce&&(e=t.getNamedStyle(e)||t.parent&&t.parent.getNamedStyle(e)),e){C(t,n,r);var o=e.validator,i=o&&o.condition();i&&i.getFormulas&&i.getFormulas().length>0&&w(o,t,n,r)}},ve._getAllValidators=function(){var e=[],t=ve._cache;for(var n in t)t.hasOwnProperty(n)&&e.push(t[n]);return e},ve._clear=function(){ve._cache={}};var ye=t._CanvasHelper={_scaleTo:function(e,t,n){var r=S(e);r.scaleX=t,r.scaleY=n,r.translateX=r.orgTranslateX*t,r.translateY=r.orgTranslateY*n,e.setTransform(r.scaleX,r.skewX,r.skewY,r.scaleY,r.translateX,r.translateY)},_translate:function(e,t,n){var r=S(e);r.orgTranslateX+=t,r.orgTranslateY+=n,r.translateX=r.orgTranslateX*r.scaleX,r.translateY=r.orgTranslateY*r.scaleY,e.setTransform(r.scaleX,r.skewX,r.skewY,r.scaleY,r.translateX,r.translateY)}},be=t._DPIHelper={dpr:1,_spreadCanvasCaches:[]};be._adjustDevicePixel=function(e,t,n){var r=be;T(e,1),E(e,1);var o=x();if(1!==o||1!==r.dpr){r.dpr=o;var i=t||n&&n.parent;if(i){for(var a,s=r._spreadCanvasCaches,l=0;l<s.length;l++)if(i===s[l].workbook){a=s[l];break}if(a||(a={workbook:i,sheets:[],canvases:[]},s.push(a)),t)a.canvases.push(e);else{for(var u,c=a.sheets,f=0;f<c.length;f++)if(c[f].sheet===n){u=c[f];break}u||(u={sheet:n,canvases:[]},c.push(u)),u.canvases.push(e)}}}},be._getScaleX=function(e){return e&&e._gcDPIScaleX||1},be._getScaleY=function(e){return e&&e._gcDPIScaleY||1},be._getLogicWidth=function(e){return e._gcLogicWidth},be._getLogicHeight=function(e){return e._gcLogicHeight},be._setSize=function(e,t,n){var r=be,o=r.dpr,i=r._getScaleX(e),a=r._getScaleY(e);if(M(e,t),A(e,n),1===o&&1===i&&1===a)e.width=t,e.height=n;else{var s=e.getContext("2d");ye._scaleTo(s,1,1),de._browser.mozilla?(e.width=ee(t*o),e.height=ee(n*o)):(e.width=re(t*o),e.height=re(n*o)),e.style.width=t+se,e.style.height=n+se;var l=e.width/t,u=e.height/n;l===i&&u===a||(T(e,l),E(e,u)),ye._scaleTo(s,l,u)}},be._disposeCanvasForSheet=function(e,t){for(var n,r,o=be._spreadCanvasCaches,i=e.parent,a=0;a<o.length;a++)if(!i||o[a].workbook===i){n=o[a].sheets;for(var s=0;s<n.length;s++)if(n[s].sheet===e){r=n[s].canvases;for(var l=0;l<r.length;l++)if(r[l]===t){r.splice(l,1);break}break}}},be._disposeCanvasForSpread=function(e,t){for(var n,r=be._spreadCanvasCaches,o=0;o<r.length;o++)if(r[o].workbook===e){n=r[o].canvases;for(var i=0;i<n.length;i++)if(n[i]===t){n.splice(i,1);break}}},be._disposeSheet=function(e){for(var t,n=be._spreadCanvasCaches,r=e.parent,o=0;o<n.length;o++)if(!r||n[o].workbook===r){t=n[o].sheets;for(var i=0;i<t.length;i++)t[i].sheet===e&&t.splice(i,1);return}},be._disposeSpread=function(e){for(var t=be._spreadCanvasCaches,n=0;n<t.length;n++)if(t[n].workbook===e)return void t.splice(n,1)},be._updateDPI=function(){var e=be,t=x();if(e.dpr!==t){var n,r,o,i,a=e._spreadCanvasCaches;e.dpr=t;for(var s=0;s<a.length;s++){r=a[s],o=r.canvases,n=r.sheets;for(var l=0;l<n.length;l++)o=o.concat(n[l].canvases);for(var u=0;u<o.length;u++)i=o[u],e._setSize(i,e._getLogicWidth(i),e._getLogicHeight(i))}}};var we=t._WordWrapHelper={};we._getWrapInfo=function(e,t,n){var r=[];if(0===e.length)return r;var o=k();if(!o)return r;if(o.font=n,t<=0){for(var i=-1,a=!0,s=0;s<e.length;s++){var l=e.charAt(s);l===le||a?l!==le&&a&&(i=o.measureText(l).width,a=!1):i=te(i,o.measureText(l).width)}if((t=i)<=0)return[e]}for(var u=e.split(/\r\n|\r|\n/),c=0;c<u.length;c++){var f=D(u[c],t);if(f)if(0===f.length)r.push("");else for(var d=0;d<f.length;d++)r.push(f[d])}return r},we._measureText=function(e,t,n){var r=k();if(!r)return 0;t&&(r.font=t);var o=n?I(e):e;return r.measureText(o).width},t._defineFeature=function(e){e._registerFeature=function(t,n){var r=e._features||(e._features=[]);n.name=t,n.priority=n.priority||5e3;for(var o=0;;o++)if(o>=r.length||n.priority>r[o].priority){r.splice(o,0,n);break}},e._callFeatureHandler=function(t,n,r){var o=e._features;if(o)for(var i=0;i<o.length;i++){var a=o[i][n];a&&a.call(t,r)}}},e.exports=t},function(e,t,n){function r(e,t){Array.call(this);var n;"string"==typeof e?n=(t||k).querySelectorAll(e):e&&(n=e instanceof Array||e instanceof HTMLCollection?e:[e]);for(var r=0;n&&r<n.length;r++)this.push(n[r])}function o(e,t){return new r(e,t)}function i(e){return o.isWindow(e)?e:9===e.nodeType&&(e.defaultView||e.parentWindow)}function a(e,t){var n=e.nodeName;return n&&n.toLowerCase()===t.toLowerCase()}function s(e,t){return"top left right bottom width height border-radius border-width border-left-width border-right-width border-top-width border-bottom-width line-height padding padding-left padding-right padding-top padding-bottom margin margin-left margin-right margin-top margin-bottom".split(" ").indexOf(e)>=0&&isFinite(t)?("width height".split(" ").indexOf(e)>=0&&t<0&&(t=0),t+="px"):t}function l(e,t,n){var r,o,i,a=e.nodeType;if(e&&3!==a&&8!==a&&2!==a)return i=1!==a,i&&(t=G[t]||t,o=K[t]),g(n)?o&&O in o&&(r=o.get(e,t))!==M?r:e[t]:o&&D in o&&!g(r=o.set(e,n,t))?r:e[t]=n}function u(e){var t=e.nodeType;if(t&&1!==t&&9!==t)return!1;var n={embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},r=e.nodeName,o=r&&n[r.toLowerCase()];return!o||!0!==o&&e.getAttribute("classid")===o}function c(e){return e.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(e,t){return t.toUpperCase()})}function f(e,t,n,r){if(u(e)){var i,a,s=J,l=h(t),f=e.nodeType,d=f?q:e,p=f?e[s]:e[s]&&s;if(p&&d[p]&&(r||d[p].data)||!l||!g(n))return p||(f?e[s]=p=Z++:p=s),d[p]||(d[p]={},f||(d[p].toJSON=function(){})),(m(t)||"function"==typeof t)&&(r?d[p]=o.extend(d[p],t):d[p].data=o.extend(d[p].data,t)),i=d[p],r||(i=i.data||(i.data={})),g(n)||(i[c(t)]=n),l?(a=i[t])!==M&&a!==E||(a=i[c(t)]):a=i,a}}function d(e,t,n){if(u(e)){var r,i,a,s=function(e){var t;for(t in e)if(("data"!==t||!o.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0},l=e.nodeType,f=l?q:e,d=l?e[J]:J;if(f[d]){if(t&&(a=n?f[d]:f[d].data)){o.isArray(t)?t=t.concat(o.map(t,c)):t in a?t=[t]:(t=c(t),t=t in a?[t]:t.split(" "));for(r=0,i=t.length;r<i;r++)delete a[t[r]];if(!(n?s:o.isEmptyObject)(a))return}(n||(delete f[d].data,s(f[d])))&&(l?p([e],!0):f!==f.window?delete f[d]:f[d]=M)}}}function p(e,t){for(var n,r,o,i=0,a=J,s=q;(n=e[i])!==M&&void 0!==n;i++)if((t||u(n))&&(r=n[a],o=r&&s[r])){var l=o.events;if(l)for(var c in l)if(T(l,c)){var f=l[c];if(f)for(var d in f)if(T(f,d)){var p=f[d];if(p)for(var h=0,m=p.length;h<m;h++)C(n,c,p[h])}}s[r]&&(delete s[r],delete n[a])}}function h(e){return"string"==typeof e}function m(e){return"object"==typeof e}function g(e){return typeof e==typeof E}function _(e){var t=e;return function(e){var n,r=this,o="border-box"===r.css("box-sizing"),i=t?P:N,a=t?F:H,s=t?L:V;return 0===arguments.length?(n=Math.round(A(r.css(i)))||0,o&&(n-=A(r.css("padding-"+a))+A(r.css("padding-"+s))+A(r.css("border-"+a+"-"+P))+A(r.css("border-"+s+"-"+P))),n):(r.css(i,e),r)}}function v(e){var t=e;return function(){var e=this,n=t?F:H,r=t?L:V;return t?e.width():e.height()+A(e.css("padding-"+n))+A(e.css("padding-"+r))}}function y(e){var t=e;return function(e){var n=t?F:H,r=t?L:V,o=this,i=t?o.innerWidth():o.innerHeight();return i+=A(o.css("border-"+n+"-"+P))+A(o.css("border-"+r+"-"+P)),e&&(i+=A(o.css("margin-"+n))+A(o.css("margin-"+r))),i}}function b(e){var t=e;return function(e){return this.forEach(function(n){n.style[Y]=t?B:U,e&&e.apply(n)}),this}}function w(e){var t=e;return function(e){var n="scrollLeft",r="scrollTop",a=t?n:r,s=t?"pageXOffset":"pageYOffset",l=this,u=l[0],c=i(u);return g(e)?c?s in c?c[s]:k.documentElement[a]:u[a]:(c?c.scrollTo(t?e:o(c)[n](),t?o(c)[r]():e):u[a]=e,l)}}function C(e,t,n){e.removeEventListener(t,n)}var S=n(0),x=S._Types,T=S._hasOwnProperty,E=void 0,M=null,A=parseFloat,k=document,R="_nonamespace",I="events",O="get",D="set",P="width",N="height",F="left",L="right",H="top",V="bottom",j="hidden",B="block",U="none",W="position",z="visibility",Y="display",G={tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},K={tabIndex:{get:function(e){var t=e.getAttributeNode("tabindex"),n=/^(?:input|select|textarea|button|object)$/i,r=/^(?:a|area)$/i,o=e.nodeName;return t&&t.specified?parseInt(t.value,10):n.test(o)||r.test(o)&&e.href?0:E}}},X={option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){var t,n,r=e.options,i=e.selectedIndex,s="select-one"===e.type||i<0,l=s?M:[],u=s?i+1:r.length,c=s?i:0;for(i<0&&(c=u);c<u;c++)if(n=r[c],(n.selected||c===i)&&!n.disabled&&(!n.parentNode.disabled||!a(n.parentNode,"optgroup"))){if(t=o(n).val(),s)return t;l.push(t)}return l},set:function(e,t){var n=o.makeArray(t);return o(e).find("option").getAll().forEach(function(e){e.selected=o.inArray(o(e).val(),n)>=0}),n.length||(e.selectedIndex=-1),n}}},q={},J="GC$"+(""+Math.random()).replace(/\D/g,""),Z=1,Q={};[N,P].forEach(function(e){Q[e]={get:function(t){var n=getComputedStyle(t),r=t.style,o=r[W],i=r[z],a=r[Y],s=0===t.offsetWidth&&/^(none|table(?!-c[ea]).+)/.test(n[Y]);s&&(r[W]="absolute",r[z]=j,r[Y]=B);var l=n&&n[e];if(s&&(r[W]=o,r[z]=i,r[Y]=a),""===l){for(var u=t.parentElement,c=k.body;u&&u!==c;)u=u.parentElement;u!==c&&(l=r[e])}return l}}});var $={get:function(e){return this[e]},getAll:function(){return this},bind:function(e,t,n){var r=this;return g(n)&&(n=t,t=E),r.forEach(function(r){var o=f(r,I,E,!0);o||(o={},f(r,I,o,!0));var i=e.split("."),a=i[0],s=i[1]||R,l=o[s];l||(l=o[s]={});var u=function(e){g(t)||(e.data=t);var o=n.apply(r,arguments);e.result=o,!1===o&&(e.preventDefault?(e.preventDefault(),"mousedown"!==e.type&&e.stopPropagation()):(e.cancelBubble=!1,e.returnValue=!1))};u.original=n;var c=l[a];c||(c=l[a]=[]),c.push(u),r.addEventListener(a,u)}),r},unbind:function(e,t){var n=this;return n.forEach(function(n){var r,o,i,a=e.split("."),s=a[0],l=a[1]||R,u=f(n,I,E,!0),c=u&&u[l];if(t){if(c&&s&&(r=c[s]))for(o=0,i=r.length;o<i;o++)if(r[o].original===t){C(n,s,r[o]),r.splice(o,1);break}}else if(c)if(s){if(r=c[s])for(o=0,i=r.length;o<i;o++)C(n,s,r[o]);c[s]=E}else{for(var d in c)if(T(c,d)&&(r=c[d]))for(o=0,i=r.length;o<i;o++)C(n,d,r[o]);u[l]=E}}),n},trigger:function(e,t){for(var n=this,r=0,o=n.length;r<o;r++){var i=n[r],a=f(i,I,E,!0);if(a){var s=e.split("."),l=s[0];for(var u in a)if(T(a,u)){var c=a[u],d=c&&c[l];if(d)for(var p=0,h=d.length;p<h;p++)d[p].apply(i,[{type:l},t])}}}return n},css:function(e,t){function n(e,t){o.forEach(function(n){n.style[e]=s(e,t)})}var r=this,o=r,i=arguments.length;if(1===i){if(!m(e)){var a=r[0],l=Q[e];if(l&&O in l)return l.get(a);var u=getComputedStyle(a);return u&&u[e]}o.forEach(function(t){for(var n in e)T(e,n)&&(t.style[n]=s(n,e[n]))})}else 2===i&&(Array.isArray(e)&&Array.isArray(t)&&e.length===t.length?e.forEach(function(e,r){n(e,t[r])}):n(e,t));return r},width:_(!0),height:_(),innerWidth:v(!0),innerHeight:v(),outerWidth:y(!0),outerHeight:y(),append:function(e){var t=[e];e instanceof o&&(t=e.getAll());var n=this,r=n[0];return t.forEach(function(e){e&&r.appendChild(e)}),n},appendTo:function(e){var t=e;e instanceof o&&(t=e[0]);var n=this;return n.forEach(function(e){t.appendChild(e)}),n},prepend:function(e){var t=this,n=t[0];return n.insertBefore(e,n.firstChild),t},insertBefore:function(e){var t=this,n=e.parentElement;return t.forEach(function(t){n.insertBefore(t,e)}),t},addClass:function(e){var t,n,r,i,a,s=0,l=this,u=l.length,c=/\S+/g,f=/[\t\r\n]/g;for(t=(e||"").match(c)||[];s<u;s++)if(n=l[s],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(f," "):" ")){for(a=0;i=t[a++];)r.indexOf(" "+i+" ")<0&&(r+=i+" ");n.className=o.trim(r)}return this},removeClass:function(e){var t,n,r,i,a,s=0,l=this,u=l.length,c=/\S+/g,f=/[\t\r\n]/g;for(t=(e||"").match(c)||[];s<u;s++)if(n=l[s],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(f," "):"")){for(a=0;i=t[a++];)for(;r.indexOf(" "+i+" ")>=0;)r=r.replace(" "+i+" "," ");n.className=e?o.trim(r):""}return this},hasClass:function(e){var t=0,n=this,r=n.length,o=/[\t\r\n]/g;for(e=" "+e+" ";t<r;t++){var i=n[t];if(1===i.nodeType&&(" "+i.className+" ").replace(o," ").indexOf(e)>=0)return!0}return!1},toggle:function(){var e=this;return e[0].style[Y]===U?e.show():e.hide(),e},show:b(!0),hide:b(),attr:function(e,t){var n=this,r=n,o=arguments.length;if(1===o){if(!m(e))return n[0].getAttribute(e);r.forEach(function(t){for(var n in e)T(e,n)&&t.setAttribute(n,e[n])})}else 2===o&&r.forEach(function(n){n.setAttribute(e,t)});return n},removeAttr:function(e){return this.forEach(function(t){t.removeAttribute(e)}),this},prop:function(e,t){var n=this,r=n,o=arguments.length;if(1===o){if(!m(e))return l(n[0],e);r.forEach(function(t){for(var n in e)T(e,n)&&l(t,n,e[n])})}else 2===o&&r.forEach(function(n){l(n,e,t)});return n},removeProp:function(e){e=G[e]||e;var t=this;return t.forEach(function(t){try{t[e]=E,delete t[e]}catch(e){}}),t},text:function(e){var t=this,n=t;return 0===arguments.length?t[0].textContent:(n.forEach(function(t){t.textContent=e}),t)},val:function(e){var t,n=this;{if(arguments.length){var r=o.isFunction(e);return n.forEach(function(n,i){var a;1===n.nodeType&&(a=r?e.call(n,i,o(n).val()):e,a===M||a===E?a="":"number"==typeof a?a+="":o.isArray(a)&&(a=o.map(a,function(e){return e===M||e===E?"":e+""})),(t=X[n.type]||X[n.nodeName.toLowerCase()])&&D in t&&!g(t.set(n,a,"value"))||(n.value=a))}),n}var i,a=n[0];if(a)return(t=X[a.type]||X[a.nodeName.toLowerCase()])&&O in t&&!g(i=t.get(a,"value"))?i:(i=a.value,h(i)?i.replace(/\r/g,""):i===M||i===E?"":i)}},position:function(){var e=this[0];if(e){var t,n={top:0,left:0};if("fixed"===o(e).css(W))t=e.getBoundingClientRect();else{var r=this.offsetParent();t=this.offset();var i=r[0];a(i,"html")||(n=r.offset(),n.left-=i.scrollLeft,n.top-=i.scrollTop),n.top+=A(o(i).css("borderTopWidth")),n.left+=A(o(i).css("borderLeftWidth"))}return{top:t.top-n.top-A(o(e).css("marginTop")),left:t.left-n.left-A(o(e).css("marginLeft"))}}},offsetParent:function(){return o(o.map(this,function(e){for(var t=k.documentElement,n=e.offsetParent||t;n&&!a(n,"html")&&"static"===o(n).css(W);)n=n.offsetParent;return n||t}))},offset:function(){var e,t,n={top:0,left:0},r=this[0],o=r&&r.ownerDocument;if(o)return e=o.documentElement,g(r.getBoundingClientRect)||(n=r.getBoundingClientRect()),t=i(o),{top:n.top+(t.pageYOffset||e.scrollTop)-(e.clientTop||0),left:n.left+(t.pageXOffset||e.scrollLeft)-(e.clientLeft||0)}},scrollLeft:w(!0),scrollTop:w(),html:function(e){var t=this,n=t;return 0===arguments.length?t[0].innerHTML:(n.forEach(function(t){t.innerHTML=e}),t)},remove:function(){this.forEach(function(e){var t=e.parentElement;t&&(t.removeChild(e),p([e]))})},empty:function(){return this.forEach(function(e){o(e.children).remove()}),this},find:function(e){var t=[];return h(e)&&this.forEach(function(n){var r=n.querySelectorAll(e);o.merge(t,r)}),o(t)},parent:function(){var e=[];return this.forEach(function(t){var n=t.parentElement;n&&e.push(n)}),o(e)},index:function(e){var t=this[0];return e?h(e)?o.inArray(t,o(e).getAll()):o.inArray(e,this):t&&t.parentElement?o.inArray(t,t.parentElement.children):-1},focus:function(){var e=this,t=e[0];return t!==k.activeElement&&t.focus&&t.focus(),e},isVisible:function(){var e=0;return this.forEach(function(t){var n=getComputedStyle(t);n[z]!==j&&n[Y]!==U&&e++}),e>0},data:function(e,t){var n=this,r=g(t);return r&&(n=void 0),o.each(this,function(o,i){var a=f(i,e,t);if(r)return n=a,!1}),n},removeData:function(e){return o.each(this,function(t,n){d(n,e)}),this}},ee=r.prototype=[];x._extend(ee,$),o.prototype=ee,o.each=x._each,o.isEmptyObject=x._isEmptyObject,o.isFunction=x._isFunction,o.isArray=x._isArray,o.isNumeric=x._isNumeric,o.getType=x._getType,o.inArray=x._inArray,o.merge=x._merge,o.map=x._map,o.extend=x._extend,o.inherit=x._inherit,o.isPlainObject=x._isPlainObject,o.isArraylike=x._isArraylike,o.isWindow=x._isWindow,o.makeArray=x._makeArray,o.trim=function(e){if(e.trim)return e.trim();var t=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;return e===M||e===E?"":(e+"").replace(t,"")},o._createElement=function(e,t,n,r,i){var a=o(k.createElement(e));return t&&n&&a.css(t,n),r&&a.addClass(r),i&&(i instanceof o?i.append(a):o(i).append(a)),a};var t=n(2);t.GC$=o,e.exports=t},function(e,t,n){var r=n(22);n(83),n(84),n(85),r.SR={},r.SR.en=n(43),e.exports=r},function(e,t,n){function r(){return C._getResource(t.SR)()}function o(e){if(typeof e===ne&&"/"===e.charAt(0)){var t;pe.test(e)?(t=e.match(pe),e=W._fromOADate(X(t[1]))):de.test(e)&&(t=e.match(de),e=new Date(X(t[1])))}return e}function i(e){return k(e)||e.constructor!==Date||(e="/OADate("+W._toOADate(e)+")/"),e}function a(e,t){var n,r,o,i=[],a=e._getModel()._dirtyNodes;if(a)for(n in a)z(a,n)&&(r=a[n])&&r.rs===(t?"e":"n")&&(o={row:+n,item:e.getDataItem&&e.getDataItem(n)},t&&(o.originalItem=r.originalItem),i.push(o));return i}function s(e,t,n){for(var r=0,o=t;o<=n;o++)r+=e._getZoomColWidth(o);return r}function l(e,t,n){for(var r=0,o=t;o<=n;o++)r+=e._getZoomRowHeight(o);return r}function u(e){return e.getColumnCount()}function c(e){return e.getRowCount()}function f(e){return e.frozenTrailingColumnCount()}function d(e){return e.frozenTrailingRowCount()}function p(e){return e.frozenColumnCount()}function h(e){return e.frozenRowCount()}function m(e,t,n){Object.defineProperty(e,t,{get:function(){return this["_"+t]},set:function(e){var r=this["_"+t];r!==e&&(this["_"+t]=e,n&&n(t,e,r))}})}function g(e,t){var n=this;n._id=g._ID++,t&&(n._guid=t),n.options=P(me,function(e,t,r){n._onOptionChanged(e,t,r)}),n._init(e)}var t=n(2),_=n(3),v=n(17)._ImageLoader,y=n(9).Style,b=n(13),w=n(4).GC$,C=n(0),S=n(27),x=_._util,T=_._DPIHelper,E=_._DataValidatorCache,M=_._util._createElement,A=_._createRange,k=C._Types._isNullOrUndefined,R=_._CachePool,I=_.Rect,O=_.Events,D=x._defProperty,P=x._createOptions,N=_._FocusHelper,F=_._ThemeStyleHelper,L=_.Themes,H=_.Theme,V=b._Layout,j=b._LayoutModel,B=w.each,U=w.isEmptyObject,W=C._DateTimeHelper,z=C._hasOwnProperty,Y=window,G=document,K=parseInt,X=parseFloat,q=isNaN,J=null,Z=void 0,Q=Math.min,$=Math.max,ee=Math.floor,te="undefined",ne="string",re="width",oe="height",ie="black",ae="tag",se="onLayoutChanged",le="isVisible",ue="resizable",ce=".gcSheet",fe=".gcSheetInternal",de=new RegExp("^/Date\\((-?\\d+)([-+]{1}\\d+)?\\)/\\s*$"),pe=new RegExp("^/OADate\\(([-+]?(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)\\)/\\s*$"),he={backColor:!0,foreColor:!0,font:!0,borderLeft:!0,borderTop:!0,borderRight:!0,borderBottom:!0,textDecoration:!0};t.RangeChangedAction={dragDrop:0,dragFill:1,clear:2,paste:3,sort:4,setArrayFormula:5,evaluateFormula:6},t.SheetArea={corner:0,colHeader:1,rowHeader:2,viewport:3},t.HeaderAutoText={blank:0,numbers:1,letters:2};var me={rowHeaderVisible:!0,colHeaderVisible:!0,clipBoardOptions:0,frozenlineColor:ie,rowHeaderAutoText:1,colHeaderAutoText:2,rowHeaderAutoTextIndex:-1,colHeaderAutoTextIndex:-1,sheetTabColor:J,selectionBackColor:J,selectionBorderColor:J,allowCellOverflow:!1,isProtected:!1,protectionOptions:{},gridline:{},borderColor:ie,borderWidth:0};_._defineFeature(g),g._ID=1,g._defaultOptions=me,g._defaultRowCount=200,g._defaultColCount=18,g._defaultRowHeaderColumnCount=1,g._defaultColHeaderRowCount=1,g._defaultRowHeight=22,g._defaultColWidth=100,g._defaultRowHeaderColWidth=40,g._defaultColHeaderRowHeight=22,g.prototype={constructor:g,_onOptionChanged:function(e,t,n){var r=this,o=r.parent;switch(e){case"allowCellOverflow":case"colHeaderAutoText":case"colHeaderAutoTextIndex":case"colHeaderVisible":case"frozenlineColor":case"rowHeaderAutoText":case"rowHeaderAutoTextIndex":case"rowHeaderVisible":case"selectionBackColor":case"selectionBorderColor":r._invalidate();break;case"gridline":var i=function(){r._invalidate()},a=r.options.gridline;["color","showHorizontalGridline","showVerticalGridline"].forEach(function(e){var n=t[e];m(a,e,i),a[e]=n});break;case"isProtected":o&&o.undoManager().clear(),r._adjustActiveCellToSelectable(),r._invalidate();break;case"protectionOptions":r._adjustActiveCellToSelectable();break;case"sheetTabColor":o&&o._doTabHSResize()}},name:function(e){var t=this,n=t.parent;if(0===arguments.length)return t._name;if(!t._isValidSheetName(e))throw r().Exp_NotSupported;return e!==t._name&&t._setNameCore(e),n&&n._doTabHSResize(),t},guid:function(e){return 0===arguments.length?this._guid:(this._guid=e,this)},_setNameCore:function(e){var t=!!g.getDataValidatorsBeforeSetSheetName,n=t?g.getDataValidatorsBeforeSetSheetName(this):J;this._name=e,t&&(g.adjustModelFormulasAfterSetSheetName(this),g.adjustValidatorsAfterSetSheetName(this,n))},visible:D("visible",!0,function(e){var t=this,n=t.parent,r=n.sheets,o=r.length,i=w.inArray(t,r),a=n.getActiveSheetIndex();if(e)a<0?n._setActiveSheetIndexImp(i,1):n._doTabHSResize();else if(i===a){for(var s=i+1;s<o&&!r[s].visible();)s++;if(s>=o)for(s=i-1;s>=0&&!r[s].visible();)s--;s<n._tab._firstTab&&(n._tab._firstTab=s),s<0?(t._dispose(!1),n._activeSheetIndex=s,n._doResize()):n._setActiveSheetIndexImp(s,1)}else n._doTabHSResize()}),addRows:function(e,t){if(!(t<=0)){var n=this,r=c(n);(e<0||e>r)&&(e=r),n.suspendPaint();try{var o={changeType:"addingRows",row:e,rowCount:t,canAdd:!0};if(g._callFeatureHandler(n,se,o),!o.canAdd)return;k(o.newRow)||(e=o.newRow);this._getRowInfos().addItems(e,t);this._getModel().addRows(e,t);n._getModel(2).addRows(e,t);var i=n._getSpanModel(2);i.addRows(e,t),i=n._getSpanModel(),i.addRows(e,t),n._needSyncVScrollbarSize=!0;var a="addRows";if(g._callFeatureHandler(n,se,{changeType:a,row:e,oldValue:r,rowCount:t}),g._callFeatureHandler(n,se,{changeType:"addRows2",row:e,oldValue:r,rowCount:t}),n.options.isProtected){var s=n.getRange(e,0,t,n.getColumnCount());S.hasSheetLock(n)&&s.tag({locked:!0}),S.hasCellLocks(n)&&s.locked(!1)}n._raiseRowChanged(e,3,a,t,r)}finally{n.resumePaint()}}},deleteRows:function(e,t){var n=this,r=c(n);if(!(0>e||e>=r||t<=0)){n.suspendPaint();try{var o={changeType:"deletingRows",row:e,rowCount:t,canDelete:!0};if(g._callFeatureHandler(n,se,o),!o.canDelete)return;this._getRowInfos().deleteItems(e,t);n._getModel().deleteRows(e,t);n._getModel(2).deleteRows(e,t);var i=n._getSpanModel(2);i.removeRows(e,t),i=n._getSpanModel(),i.removeRows(e,t);var a=n._scrollTopRow;if(a>=0){for(var s=-1,l=h(n),u=a;u>=l;u--)if(n.getRowVisible(u)&&n._getZoomRowHeight(u)>0){s=u;break}-1===s&&(s=0),a!==s&&n._setTopRow(s)}var f=r;n.getActiveRowIndex()>=f&&n.setActiveCell(f-1,n.getActiveColumnIndex()),n._needSyncVScrollbarSize=!0;var d="deleteRows";g._callFeatureHandler(n,se,{changeType:d,row:e,oldValue:r,rowCount:t}),n._raiseRowChanged(e,3,d,t,r)}finally{n.resumePaint()}}},addColumns:function(e,t){if(!(t<=0)){var n=this,r=u(n);(e<0||e>r)&&(e=r);var o={changeType:"addingColumns",col:e,colCount:t,canAdd:!0};if(g._callFeatureHandler(n,se,o),o.canAdd){n._getColInfos().addItems(e,t);n._getModel().addColumns(e,t);n._getModel(1).addColumns(e,t);var i=n._getSpanModel(1);i.addColumns(e,t),i=n._getSpanModel(),i.addColumns(e,t),n._needSyncHScrollbarSize=!0;var a="addColumns";if(g._callFeatureHandler(n,se,{changeType:a,col:e,oldValue:r,colCount:t}),n.options.isProtected){var s=n.getRange(0,e,n.getRowCount(),t);S.hasSheetLock(n)&&s.tag({locked:!0}),S.hasCellLocks(n)&&s.locked(!1)}n._raiseColumnChanged(e,3,a,t,r),n._invalidate()}}},deleteColumns:function(e,t){var n=this,r=u(n);if(!(0>e||e>=r||t<=0)){var o={changeType:"deletingColumns",col:e,colCount:t,canDelete:!0};if(g._callFeatureHandler(n,se,o),o.canDelete){n._getColInfos().deleteItems(e,t);n._getModel().deleteColumns(e,t);n._getModel(1).deleteColumns(e,t);var i=n._getSpanModel(1);i.removeColumns(e,t),i=n._getSpanModel(),i.removeColumns(e,t);var a=n._scrollLeftCol;if(a>=0){for(var s=-1,l=p(n),c=a;c>=l;c--)if(n.getColumnVisible(c)&&n._getZoomColumnWidth(c)>0){s=c;break}-1===s&&(s=0),a!==s&&n._setLeftColumn(s)}var f=r;n.getActiveColumnIndex()>=f&&n.setActiveCell(n.getActiveRowIndex(),f-1),n._needSyncHScrollbarSize=!0;var d="deleteColumns";g._callFeatureHandler(n,se,{changeType:d,col:e,oldValue:r,colCount:t}),n._raiseColumnChanged(e,3,d,t,r),n._invalidate()}}},frozenColumnCount:D("frozenColumnCount",0,function(e){var t=this;t._scrollLeftCol<e&&(t._scrollLeftCol=e),t._needSyncHScrollbarSize=!0,t._invalidate()},function(e){return e>=0}),frozenRowCount:D("frozenRowCount",0,function(e){var t=this;t._scrollTopRow<e&&(t._scrollTopRow=e),t._needSyncVScrollbarSize=!0,t._invalidate()},function(e){return e>=0}),frozenTrailingRowCount:D("frozenTrailingRowCount",0,function(){var e=this;e._needSyncVScrollbarSize=!0,e._invalidate()},function(e){return e>=0}),frozenTrailingColumnCount:D("frozenTrailingColumnCount",0,function(){var e=this;e._needSyncHScrollbarSize=!0,e._invalidate()},function(e){return e>=0}),getRowCount:function(e){return 0===e?0:c(this._getModel(e))},getColumnCount:function(e){return 0===e?0:u(this._getModel(e))},setRowCount:function(e,t){k(t)&&(t=3);var n=this,r={changeType:"settingRowCount",rowCount:e,sheetArea:t,canSet:!0};g._callFeatureHandler(n,se,r),r.canSet&&n.setRowCountCore(e,t)},setRowCountCore:function(e,t){if(e=K(e,10),!q(e)){k(t)&&(t=3);var n=this,r=n._getModel();if(!(e<0||e===n.getRowCount(t))){if(3===t||2===t){var o=c(r);o>e&&n.deleteRows(e,o-e),r.setRowCount(e),n._getModel(2).setRowCount(e),h(n)>e&&n.frozenRowCount(e)}else if(1===t){var i=n._getModel(1);if(c(i)>e){var a=n._getRowInfos(t);a.deleteItems(e,c(i)-e)}i.setRowCount(e)}g._callFeatureHandler(n,se,{changeType:"setRowCount",rowCount:e,sheetArea:t}),n._needSyncVScrollbarSize=!0,n._activeRowIndex>=e&&(3===t||2===t)&&n.setActiveCell(e-1,n.getActiveColumnIndex()),n._invalidate(),n.clearPendingChanges()}}},setColumnCount:function(e,t){if(e=K(e,10),!q(e)){var n=this,r=n._getModel();if(!(e<0||e===n.getColumnCount(t))){if(k(t)&&(t=3),3===t||1===t){var o=u(r);o>e&&n.deleteColumns(e,o-e),n._getModel().setColumnCount(e),n._getModel(1).setColumnCount(e),p(n)>e&&n.frozenColumnCount(e)}else if(2===t){var i=n._getModel(2);if(u(i)>e){var a=n._getColInfos(t);a.deleteItems(e,u(i)-e)}i.setColumnCount(e)}g._callFeatureHandler(n,se,{changeType:"setColumnCount",colCount:e,sheetArea:t}),n._needSyncHScrollbarSize=!0,n._activeColIndex>=e&&(3===t||1===t)&&n.setActiveCell(n.getActiveRowIndex(),e-1),n._invalidate(),n.clearPendingChanges()}}},getText:function(e,t,n){k(n)&&(n=3);var r=this,o=r.getValue(e,t,n),i=r.getCellType(e,t,n),a=r._getStyleProperty(e,t,"formatter",n);return a||(a=r._getStyleProperty(e,t,"_autoFormatter",n)),o=i.format(o,a,{sheet:r,row:e,col:t,sheetArea:n}),o&&"string"==typeof o&&""!==o&&(o=o.replace(/\r\n?/g,"\n")),o},setText:function(e,t,n,r){var o=this;k(r)&&(r=3);var i=n,a={value:n};g._callFeatureHandler(o,"settingText",a),n=a.value;var s=n,l=o.getCellType(e,t,r),u=o.getFormatter&&o.getFormatter(e,t,r);if(l&&u){var c={sheet:o,row:e,col:t,sheetArea:r};s=l.parse(i,u,c),s=k(s)?n:s}o._setValueInternal(e,t,s,r),o._invalidate()},getValue:function(e,t,n){if(0===n)return J;k(n)&&(n=3);var r,o=this,i=o.options,a=o._getModel(n),s=o._getValueImp(a,e,t,n);if(1===n){if(k(s)){var l=o._bindingManager;if(l&&l._dataSource&&c(l)>0){var f=o._getColInfos()._getItem(t),d=i.colHeaderAutoTextIndex;f&&(d>=0&&e===d||-1===d&&e===c(a)-1)&&(s=f.displayName||f.name)}if(k(s)&&(r=i.colHeaderAutoTextIndex,(r<0||r>=c(a))&&(r=c(a)-1),e===r)){var p=i.colHeaderAutoText;2===p?s=o._indexToLetters(t+1):1===p&&(s=t+1)}}}else if(2===n&&k(s)&&(r=i.rowHeaderAutoTextIndex,(r<0||r>=u(a))&&(r=u(a)-1),t===r)){var h=i.rowHeaderAutoText;2===h?s=o._indexToLetters(e+1):1===h&&(s=e+1)}return s},setValue:function(e,t,n,r,o){this._setValueInternal(e,t,n,r,o),this._invalidate()},_setValueInternal:function(e,n,r,o,a){if(0!==o){k(o)&&(o=3);var s=this,l=s._getModel(o),u=3===o;r=i(r);var c,f=s._getValueImp(l,e,n,o),d=!1,p=s.tables;if(u&&p&&p.find(e,n)){if(c=p._setValue(e,n,r),!c.isValid)return;d=c.isValueSet}if(u){var h=s._bindingManager;if(!d&&h&&h._dataSource){var m=h.getValue(e,n);if(m.hasBinding&&r!==m.value){var g=w.extend({},s.getDataItem(e));l._updateDirty(e,n,{_originalItem:g,_oldValue:f}),h.setValue(e,n,r)}d=m.hasBinding}d||l.setValue(e,n,r)}else l.setValue(e,n,r);u&&!a&&t._supportsCalc&&s._recalcCell(l,e,n),s._updateTableSlicer&&s._updateTableSlicer(e,n,1,1,o);var _=s.conditionalFormats;_&&_._clearCache();s.isEventSuspended()>0||f===r||s._raiseCellChanged("value",e,n,o,f,r)}},getActualStyle:function(e,t,n,r,o){if(k(n)&&(n=3),0===n)return new y;if(-1===e&&-1===t)return this.getDefaultStyle(n);var i,a,s,l,u,c,f,d,p,h,m,g,_=this,v=_._styleComposeCache,b="__spreadJSDefault",w="__undefined",C=this._getModel(n);s=C.getStyle(e,t),l=C.getStyle(e,-1),u=C.getStyle(-1,t),s=s||J,l=l||J,u=u||J,h=w,s&&(h=s.charAt?s:b+s._id),m=w,l&&(m=l.charAt?l:b+l._id),g=w,u&&(g=u.charAt?u:b+u._id),p=v[n],c=p[h];var S=_.tables,x=3===n&&S?S.find(e,t):J;if(x||(c||(c=p[h]={}),f=c[m],f?d=f[g]:f=c[m]={}),d||(a=_._getCompositeStyle(e,t,n,s,l,u,x)),3===n&&!r){if(!d){var T=a.formatter;if(T&&T.hasFormatedColor&&T.hasFormatedColor()){var E={value:J};T.format(_.getValue(e,t),E),E.value&&(i=new y,i.foreColor=E.value)}}var M=_.conditionalFormats;M&&(i=M._applyFormats(i,e,t,n))}if(i)i._compose(d||a),a=i;else if(d)return o?d:d.clone(!0);return k(a.locked)&&(a.locked=!0),a=a._normalize(_._currentTheme),i||x||(f[g]=a.clone(!0)),a},_getStyleProperty:function(e,t,n,r){if(0===r)return Z;k(r)&&(r=3);var o,i,a,s,l,u=this,c=u._getModel(r),f=!1;if(3===r){if("foreColor"===n){var d=u._getStyleProperty(e,t,"formatter",r);if(d&&d.hasFormatedColor&&d.hasFormatedColor()){var p={value:J};d.format(u.getValue(e,t),p),p.value&&(s=p.value,f=!0)}}var h=u.conditionalFormats;if(h&&h.count()>0){var m=h._getConditionalStyle(e,t,n,r);f=m._hasResult,s=m._result}}for(var g=0;!f&&g<=4;){if(0===g)o=c.getStyle(e,t);else if(1===g){var _=u.tables,v=3===r&&_?_.find(e,t):J;v&&he[n]&&(o=v._getStyle(e,t,n))}else o=2===g?c.getStyle(e,-1):3===g?c.getStyle(-1,t):u.getDefaultStyle(r);if(g++,o&&o.charAt&&typeof o===ne&&(o=u._name2Style(o)),o){if("font"===n&&o.themeFont&&!l&&(l=o.themeFont),o[n]!==Z){s=o[n],f=!0;break}for(i=o.parentName;i&&(a=u._name2Style(i));){if(a[n]!==Z){s=a[n],f=!0;break}i=a.parentName}}}return"locked"===n?!!k(s)||s:f||l?("foreColor"!==n&&"backColor"!==n&&"font"!==n&&"borderLeft"!==n&&"borderTop"!==n&&"borderRight"!==n&&"borderBottom"!==n||(o=new y,o[n]=s,"font"===n&&l&&(o.themeFont=l),o._normalize(u._currentTheme),s=o[n]),s):Z},getStyle:function(e,t,n){return this._getStyleImp(e,t,n,!0)},_getStyleImp:function(e,t,n,r){if(k(n)&&(n=3),0!==n){var o=this._getModel(n),i=o.getStyle(e,t);if(i instanceof y)return r&&this._clearStyleCache(),i;if(typeof i===ne){var a=this._name2Style(i);if(a!==J){var s=new y;return s._compose(a),r&&this._clearStyleCache(),s}}}return J},addNamedStyle:function(e){this._addNamedStyleImp(e),this._invalidate()},_addNamedStyleImp:function(e){if(e){if(!e.name)throw new Error(r.Exp_EmptyNamedStyle);var t=e.name.toUpperCase();this._namedStyles[t]=e}},getNamedStyle:function(e){return this._getNamedStyleImp(e,!0)},_getNamedStyleImp:function(e,t){var n=this._namedStyles;if(n&&e){e=e.toUpperCase();var r=n[e];return r&&t&&this._clearStyleCache(),r}return J},_clearStyleCache:function(){this._styleComposeCache=[{},{},{},{}]},removeNamedStyle:function(e){var t=this._namedStyles;t&&e&&(e=e.toUpperCase(),z(t,e)&&(delete t[e],this._clearStyleCache(),this._invalidate()))},getNamedStyles:function(){var e=[],t=this._namedStyles;return t&&B(t,function(t,n){e.push(n)}),this._clearStyleCache(),e},setStyle:function(e,t,n,r){k(r)&&(r=3);var o=this;o._setStyleObject(e,t,n,r),-1===e&&-1===t&&(o._composedDefaultStyle[r]=J),-1!==e&&-1!==t||n&&n.validator&&n.validator.condition()&&4===n.validator.condition().conType()&&n.validator.condition().getExpected(this,e<0?0:e,t<0?0:t),o._clearStyleCache(),o._invalidate()},_setStyleWithoutLocked:function(e,t,n,r){var o=this;if(o.options.isProtected){var i,a=o.getStyle(e,t,r);n?(i=a?a.locked:Z,n.locked!==i&&(n.locked=i),o.setStyle(e,t,n,r)):a&&(i=a.locked,i!==Z&&(n=new y,n.locked=i),o.setStyle(e,t,n,r))}else o.setStyle(e,t,n,r)},getStyleName:function(e,t,n){var r=this._getStyleObject(e,t,n);return r instanceof y?r.name:r},setStyleName:function(e,t,n,r){typeof n===ne&&(this._setStyleObject(e,t,n,r),this._invalidate())},_getStyleObject:function(e,t,n){k(n)&&(n=3);var r;if(0!==n){r=this._getModel(n).getStyle(e,t)}return r||J},_setStyleObject:function(e,t,n,r){if(k(r)&&(r=3),0!==r){var o=this,i=o._getStyleObject(e,t,r),a=o._getModel(r),s=a.getStyle(e,t);a.setStyle(e,t,n),E._setStyle(n,o,e,t);var l=i&&i.cellType&&i.cellType.typeName||J,u=n&&n.cellType&&n.cellType.typeName||J;if(e===o._activeRowIndex&&t===o._activeColIndex&&l!==u&&N._isActiveElement(o)&&o._eventHandler._changeFocusHolder(),0===o._eventSuspended){var c="[styleinfo]";-1!==e&&-1!==t?o._raiseCellChanged(c,e,t,r,s,n):-1!==e&&-1===t?o._raiseRowChanged(e,r,c,n,s):-1===e&&-1!==t&&o._raiseColumnChanged(t,r,c,n,s)}}},getDefaultStyle:function(e){k(e)&&(e=3);var t=this,n=t._composedDefaultStyle,r=n[e];if(r)return r;if(0!==e){var o=t._getModel(e),i=o.getStyle(-1,-1);typeof i===ne&&(i=t._name2Style(i)),i||(i=new y,o.setStyle(-1,-1,i));var a=1===e||2===e;return typeof i.hAlign===te&&(i.hAlign=a?1:3),typeof i.vAlign===te&&(i.vAlign=a?1:0),typeof i.imeMode===te&&(i.imeMode=1),i.font||typeof i.themeFont!==te||(i.themeFont="Body"),n[e]=i,i}var s=new y;return s.locked=!0,n[e]=s,s},setDefaultStyle:function(e,t){k(t)&&(t=3);var n=this;if(0!==t){n._getModel(t).setStyle(-1,-1,e),E._setStyle(e,n,-1,-1)}n._composedDefaultStyle[t]=J,n._clearStyleCache(),n._invalidate()},_name2Style:function(e){var t=this._getNamedStyleImp(e,!1);if(t)return t;var n=this.parent;return n?n._getNamedStyleImp(e,!1):J},_getCompositeStyle:function(e,t,n,r,o,i,a,s){if(k(n)&&(n=3),0!==n){var l,f,d,p=this,h=new y,m=!1,g=p._getModel(n),_=p.tables,v=c(g),b=u(g);if(0<=e&&e<v&&0<=t&&t<b&&(d=r!==Z?r:g.getStyle(e,t),d&&d.charAt&&(d=p._name2Style(d)),d))for(h._compose(d,!0,10),m=!0,f=d.parentName;f&&(l=p._name2Style(f));)h._compose(l,!1,10),f=l.parentName;if(s)return h;if(a===Z&&(a=3===n&&_?_.find(e,t):J),a&&(a._compose(e,t,h),m=!0),0<=e&&e<v&&(d=o!==Z?o:g.getStyle(e,-1),d&&d.charAt&&(d=p._name2Style(d)),d))for(h._compose(d,!m,30),m=!0,f=d.parentName;f&&(l=p._name2Style(f));)h._compose(l,!1,30),f=l.parentName;if(0<=t&&t<b&&(d=i!==Z?i:g.getStyle(-1,t),d&&d.charAt&&(d=p._name2Style(d)),d))for(h._compose(d,!m,40),m=!0,f=d.parentName;f&&(l=p._name2Style(f));)h._compose(l,!1,40),f=l.parentName}var w=p.getDefaultStyle(n);if(w&&w.charAt&&(w=p._name2Style(w)),w)for(h._compose(w,!m,50),f=w.parentName;f&&(l=p._name2Style(f));)h._compose(l,!1,50),f=l.parentName;return h},getCellType:function(e,t,n){return this._getStyleProperty(e,t,"cellType",n)||this._getDefaultCellType(n)},_getDefaultCellType:function(e){k(e)&&(e=3);var t=n(12).CellTypes,r=this._defaultCellType;return r||(r=this._defaultCellType=new t.Text),3===e?r:1===e?new t.ColumnHeader:2===e?new t.RowHeader:0===e?new t.Corner:r},setCellType:function(e,t,n,r){var o=this._getStyleImp(e,t,r);o||(o=new y),o.cellType=n,this.setStyle(e,t,o,r)},_addSpanImp:function(e,t,n,r,o){var i=this;k(o)&&(o=3);var a=i._getSpanModel(o);a.clear(e,t,n,r);var s=A(e,t,n,r),l=i._getActualRange(s,o);if(a.addSpan(l),3===o){var u=i._selectionModel;if(u){for(var c=i.getSelections(),f=0;f<c.length;f++)c[f].intersect(e,t,n,r)&&(c[f]=c[f].union(s));u.fromArray(c)}}i._invalidate()},addSpan:function(e,n,o,i,a){var s=this;if((1!==o||1!==i)&&0!==a){var l=!0;if(t._supportsCalc&&(3===a||k(a))&&(l=s._checkArrayFormula(e,n,o,i,!1)),l){if(s._getSpanModel(a).hasPartSpans(e,n,o,i))throw new Error(r().Exp_InvalidRange);s._addSpanImp(e,n,o,i,a);var u={sheet:s,row:e,col:n,rowCount:o,colCount:i,sheetArea:a,changeType:"addSpan"};g._callFeatureHandler(s,se,u),s._trigger("spanChanged",u)}}},removeSpan:function(e,t,n){var r=this;k(n)&&(n=3);for(var o=r._getSpanModel(n),i=0;i<o.length;i++){var a=o[i];if(a.row===e&&a.col===t){o.removeSpan(i,1);break}}var s={sheet:r,row:e,col:t,sheetArea:n,changeType:"removeSpan"};g._callFeatureHandler(r,se,s),r._trigger("spanChanged",s),r._invalidate()},getSpans:function(e,t){return 0===t?[]:this._getSpanModel(t).getSpans(e)},getSpan:function(e,t,n){return 0===n?J:this._getSpanModel(n).find(e,t)},repaint:function(e){this._layoutSuspended<=0&&this._render.repaint(e)},_scrollByMoveCell:function(e,t){var n=this,r=h(n),o=p(n),i=o?n._getNextVisualColumn(o-1):n._getFirstVisualColumn(),a=r?n._getNextVisualRow(r-1):n._getFirstVisualRow();if(t<n._scrollLeftCol&&t>=i&&n._setLeftColumn(n._getPrevVisualColumn(t+1)),t>n._getLastFullyVisibleColumn()&&t<=n._getLastVisualColumn()){var s=0,l=t,u=n._getSheetLayout(),c=n._getSpanModel().find(e,l);for(c&&(l=c.col+c.colCount-1);l>n._scrollLeftCol&&!((s+=n._getZoomColumnWidth(l))>u._viewportWidth);)l--;var f=n._getNextVisualColumn(l);n._setLeftColumn(f)}if(e<n._scrollTopRow&&e>=a&&n._setTopRow(n._getPrevVisualRow(e+1)),e>n._getLastFullyVisibleRow()&&e<=n._getLastVisualRow()){var d=0,m=e,g=n._getSpanModel().find(m,t);g&&(m=g.row+g.rowCount-1);for(var _=n._getSheetLayout();m>n._scrollTopRow&&!((d+=n._getZoomRowHeight(m))>_._viewportHeight);)m--;var v=n._getNextVisualRow(m);n._setTopRow(v)}e===n._getLastVisualRow()&&n._setTopRow(n._getLastPageTopRow()),t===n._getLastVisualColumn()&&n._setLeftColumn(n._getLastPageLeftColumn())},hitTest:function(e,t,n){var r=this;r._getSheetLayout();var o,i,a,s={x:e,y:t,rowViewportIndex:J,colViewportIndex:J,row:-1,col:-1,resizeInfo:J,hitTestType:J,outlineHitInfo:J,filterButtonHitInfo:J,dragInfo:J,cellTypeHitInfo:J,floatingObjectHitInfo:J,formulaRangeHitInfo:J,commentHitInfo:J},l=r.rowOutlines,u=r.columnOutlines;if(l&&(o=l.hitTest(r,e,t)),!o&&u&&(o=u.hitTest(r,e,t)),o)s.outlineHitInfo=o;else{if(i=r._getRowViewportIndexFromY(t),a=r._getColumnViewportIndexFromX(e),s.rowViewportIndex=i,s.colViewportIndex=a,s.row=r._getRowIndexFromY(t,i),s.col=r._getColumnIndexFromX(e,a),i>=0&&i<=2&&a>=0){var c=r._getCellLayoutByCell(i,a,Z,s.row,s.col);c&&!0!==n&&(s.row=c.row,s.col=c.col)}s.hitTestType=r._getSheetArea(i,a);var f=r._eventHandler,d=f._getDragInfo&&f._getDragInfo(s,e,t);if(d)s.dragInfo=d;else{var p=f._getResizingRowCol(s,e,t,5);if(p)s.resizeInfo=p;else{var h=f._getFormulaRangeHitInfo?f._getFormulaRangeHitInfo(s,e,t):J;if(h)s.formulaRangeHitInfo=h;else{var m=r.comments,g=m&&m.hitTest(e,t);if(g)s.commentHitInfo=g;else{var _=r._floatingObjectModel,v=_&&_.hitTest(e,t);if(v)s.floatingObjectHitInfo=v;else{var y=r._rowFilter,b=y&&y.hitTest(s,e,t);if(!b){var w=r.tables,C=w&&w.find(s.row,s.col),S=C&&C._rowFilter;b=S&&S.hitTest(s,e,t)}b?s.filterButtonHitInfo=b:s.cellTypeHitInfo=r._getCellTypeHitInfo(s,e,t)}}}}}}return s},getCellRect:function(e,t,n,r){var o=3;-1===n?o=1:-1===r&&(o=2);var i=this,a=i._getSheetLayout();if(-1===n&&-1===r)return new I(a._headerX,a._headerY,a._rowHeaderWidth,a._colHeaderHeight);var s=i._getBounds();k(n)&&(n=i._getRowViewportIndex(e)),k(r)&&(r=i._getColumnViewportIndex(t));var l=i._getRowLayout(n,o).findRow(e),u=i._getColumnLayout(r,o).findCol(t),c=i._getCellLayout(n,r,o).findCell(e,t);return c?new I(c.x-s.x,c.y-s.y,c.width,c.height):l&&u?new I(u.x-s.x,l.y-s.y,u.width,l.height):new I},_setActiveCellCore:function(e,t,n){var r=this,o=r._eventHandler,i=!1;if(k(e)||(r._activeRowIndex=e,i=!0),k(t)||(r._activeColIndex=t,i=!0),!n&&o&&i){var a=sheet.getRange(e,t,1,1).tag();x.isMobile()&&a&&a.locked?o._releaseFocus():o._changeFocusHolder()}},_setActiveCellImp:function(e,t,n,r,o){var i=this,a=i._activeRowIndex,s=i._activeColIndex,l=i._getSpanModel().get(e,t);if(i._activeRowCount=l.rowCount,i._activeColCount=l.colCount,i._layoutSuspended<=0){var u=i._getSpanModel().get(a,s);i._render._repaintSelection(A(a,s,u.rowCount,u.colCount))}i._activeRowViewportIndex=n,i._activeColViewportIndex=r,i._setActiveCellCore(e,t,o),i._leadingCellRow=e,i._leadingCellCol=t},setActiveCell:function(e,t,n,r){this._selectionModel&&this._setActiveCellAndSelection(e,t,n,r,2)},_setActiveCellAndSelection:function(e,t,n,r,o){var i=this,a=c(i),s=u(i);e<0?e=0:e>=a&&(e=a-1),t<0?t=0:t>=s&&(t=s-1),i._clearSelectionImp();var l=2===o?N._isActiveElement(i):1===o;i._setActiveCellImp(e,t,n,r,!l);var f=i._getSpanModel().get(e,t);i._setSelectedRange(f.row,f.col,f.rowCount,f.colCount),i._invalidate()},getActiveRowIndex:function(){return this._activeRowIndex},getActiveColumnIndex:function(){return this._activeColIndex},getRowResizable:function(e,t){return this._getRowInfos(t).getResizable(e)},setRowResizable:function(e,t,n){this._setRowColInfo(e,t,ue,!0,n)},_setRowColInfo:function(e,n,r,o,i){k(i)&&(i=3);var a,s=this,l=o?s._getRowInfos(i):s._getColInfos(i);switch(r){case ue:a=l.getResizable(e),l.setResizable(e,n);break;case"autoFitRow":a=l.getSize(e,"autoFit"),l.setSize(e,n,"autoFit"),!t._supportsCalc||3!==i||a===n||0!==a&&0!==n||s.recalcRows([e]);break;case"pageBreak":a=l.getPageBreak(e),l.setPageBreak(e,n);break;case le:a=l.getVisible(e),l.setVisible(e,n),t._supportsCalc&&3===i&&a!==n&&s.recalcRows([e]);break;case oe:a=l.getSize(e),l.setSize(e,n),!t._supportsCalc||3!==i||a===n||0!==a&&0!==n||s.recalcRows([e]);break;case re:a=l.getSize(e),l.setSize(e,n)}o?s._raiseRowChanged(e,i,r,n,a):s._raiseColumnChanged(e,i,r,n,a)},getColumnResizable:function(e,t){return this._getColInfos(t).getResizable(e)},setColumnResizable:function(e,t,n){this._setRowColInfo(e,t,ue,!1,n)},getRowHeight:function(e,t){var n=this;if(k(t)&&(t=3),3===t||2===t){var r=n._getModel(t),o=c(r)||0;if(e<0||e>=o)return 0;for(var i=n._rowStateProviders,a=0;a<i.length;a++){if(!i[a]._isVisible(e))return 0}}var s=n.defaults,l=s.rowHeight;1===t&&(l=s.colHeaderRowHeight);var u=n._getRowInfos(t).getSize(e,null);return u||0===u?u:l},getAutoFitRowHeight:function(e,t){var n=this;if(k(t)&&(t=3),3===t||2===t){var r=n._getModel(t),o=c(r)||0;if(e<0||e>=o)return 0;for(var i=n._rowStateProviders,a=0;a<i.length;a++){if(!i[a]._isVisible(e))return 0}}var s=n.defaults;s.rowHeight;return 1===t&&s.colHeaderRowHeight,n._getRowInfos(t).getSize(e,"autoFit")},_getActualAutoFitRowHeight:function(e,t){return k(t)&&(t=3),this._getRowInfos(t).getActualSize(e,"autoFit")},_getActualRowHeight:function(e,t){k(t)&&(t=3);var n=this,r=n.defaults,o=r.rowHeight;1===t&&(o=r.colHeaderRowHeight);var i=n._getRowInfos(t).getActualSize(e);return i||0===i?i:o},setRowHeight:function(e,t,n){this._setRowColInfo(e,t,oe,!0,n),this._needSyncVScrollbarSize=!0,this._invalidate()},setAutoFitRowHeight:function(e,t,n){this._setRowColInfo(e,t,"autoFitRow",!0,n),this._needSyncVScrollbarSize=!0,this._invalidate()},setAutoFitRows:function(e){for(var t,n=this.getRowCount(),r=(x._getRowAutoFitValue,0);r<=n;r++)null!=e[r]&&(t=e[r],this._setRowColInfo(r,t,"autoFitRow",!0));this._needSyncVScrollbarSize=!0,this._invalidate()},getRowVisible:function(e,t,n){var r=this;if(k(t)&&(t=3),!n&&(3===t||2===t))for(var o=r._rowStateProviders,i=0;i<o.length;i++){var a=o[i];if(!a._isVisible(e))return!1}return this._getRowInfos(t).getVisible(e)},setRowVisible:function(e,t,n){var r=this;r._setRowColInfo(e,t,le,!0,n),r._needSyncVScrollbarSize=!0,r._invalidate()},getColumnWidth:function(e,t){var n=this;k(t)&&(t=3);var r=n.defaults,o=r.colWidth;if(2===t&&(o=r.rowHeaderColWidth),3===t||1===t){var i=n._getModel(t),a=u(i)||0;if(e<0||e>=a)return 0;for(var s=n._colStateProviders,l=0;l<s.length;l++){if(!s[l]._isVisible(e))return 0}}var c=this._getColInfos(t).getSize(e);return c||0===c?c:o},_getActualColumnWidth:function(e,t){k(t)&&(t=3);var n=this,r=n.defaults,o=r.colWidth;2===t&&(o=r.rowHeaderColWidth);var i=n._getColInfos(t).getActualSize(e);return i||0===i?i:o},setColumnWidth:function(e,t,n){this._setRowColInfo(e,t,re,!1,n),this._needSyncHScrollbarSize=!0,this._invalidate()},getColumnVisible:function(e,t){var n=this;if(k(t)&&(t=3),3===t||1===t)for(var r=n._colStateProviders,o=0;o<r.length;o++){var i=r[o];if(!i._isVisible(e))return!1}return n._getColInfos(t).getVisible(e)},setColumnVisible:function(e,t,n){var r=this;r._setRowColInfo(e,t,le,!1,n),r._needSyncHScrollbarSize=!0,r._invalidate()},zoom:function(e){var t=this;return 0===arguments.length?t._zoomFactor:(e=X(e),!q(e)&&isFinite(e)&&(e>4?e=4:e<.25&&(e=.25),t._zoomFactor=e,t._needSyncHScrollbarSize=!0,t._needSyncVScrollbarSize=!0,t._invalidate()),t)},invalidateLayout:function(){var e=this,t=e._eventHandler;e._layoutModel=J,e._rowLayoutCache={colHeader:J,viewport:J,colFooter:J},e._colLayoutCache={rowHeader:J,viewport:J},g._callFeatureHandler(e,se,{changeType:"invalidateLayout"}),t&&t._updateValidationUI&&N._isActiveElement(e)&&t._updateValidationUI(e._activeRowIndex,e._activeColIndex),e._needSyncHScrollbarSize&&(e._syncHScrollbarSize(),e._needSyncHScrollbarSize=!1),e._needSyncVScrollbarSize&&(e._syncVScrollbarSize(),e._needSyncVScrollbarSize=!1),e._dirty=!0},_invalidate:function(){var e=this;e._layoutSuspended<=0&&(e.invalidateLayout(),e.repaint())},getViewportHeight:function(e){var t=this._getSheetLayout();return 0===e?t._frozenHeight:1===e?t._viewportHeight:2===e?t._frozenTrailingHeight:0},getViewportWidth:function(e){var t=this._getSheetLayout();return 0===e?t._frozenWidth:1===e?t._viewportWidth:2===e?t._frozenTrailingWidth:0},getViewportTopRow:function(e){var t=this,n=h(t);return 0===e?0:1===e?$(n,t._scrollTopRow):2===e?$(n,c(t)-d(t)):-1},getViewportBottomRow:function(e){var t=this;if(2===e)return c(t)-1;var n=t.getViewportTopRow(e),r=t.getViewportHeight(e),o=0,i=0,a=c(t)-d(t);0===e&&(a=Q(h(t),a));for(var s=n;s<a&&o<r;s++,i++)o+=t._getZoomRowHeight(s);return n+i-1},getViewportLeftColumn:function(e){var t=this,n=p(t);return 0===e?0:1===e?$(n,t._scrollLeftCol):2===e?$(n,u(t)-f(t)):-1},getViewportRightColumn:function(e){var t=this;if(2===e)return u(t)-1;var n=t.getViewportLeftColumn(e),r=t.getViewportWidth(e),o=0,i=0,a=u(t)-f(t);0===e&&(a=Q(p(t),a));for(var s=n;s<a&&i<r;s++,o++)i+=t._getZoomColumnWidth(s);return n+o-1},showCell:function(e,t,n,r){var o=this;if(!(e<0||e>=c(o)||t<0||t>=u(o))){var i=o._getColumnViewportIndex(t),a=o._getRowViewportIndex(e),s=o.getViewportTopRow(a),l=o.getViewportLeftColumn(i);1===i&&(t=o._getNewLeftColumn(t,r)),1===a&&(e=o._getNewTopRow(e,n));var f=!1;if(1===a&&e!==s&&(e=Q(e,o._getLastVisualScrollRow()),o._scrollTopRow=e,o._syncVScrollbarPosition(),f=!0),1===i&&t!==l&&(t=Q(t,o._getLastVisualScrollColumn()),o._scrollLeftCol=t,o._syncHScrollbarPosition(),f=!0),f){var d=o.parent;d&&!d.options.scrollbarShowMax&&(o._needSyncHScrollbarSize=!0,o._needSyncVScrollbarSize=!0),o._invalidate()}}},_getRowViewportIndex:function(e){var t=this,n=1;return e<h(t)?n=0:e>=c(t)-d(t)&&(n=2),n},_getColumnViewportIndex:function(e){var t=this,n=1;return e<p(t)?n=0:e>=u(t)-f(t)&&(n=2),n},_getNewLeftColumn:function(e,t){var n,r=this,o=r._cachePool,i=r._getColumnViewportIndex(e),a=r.getViewportLeftColumn(i);if(0!==t)if(1===t)for(n=ee((r.getViewportWidth(i)-o._getZoomColWidth(e))/2);0<e&&!((n-=o._getZoomColWidth(e-1))<0);e--);else if(2===t)for(n=r.getViewportWidth(i)-o._getZoomColWidth(e);0<e&&!((n-=o._getZoomColWidth(e-1))<0);e--);else if(3===t&&e>=a)for(n=r.getViewportWidth(i)-o._getZoomColWidth(e);a<e&&!((n-=o._getZoomColWidth(e-1))<0);e--);return e},_getNewTopRow:function(e,t){var n,r=this,o=r._cachePool,i=r._getRowViewportIndex(e),a=r.getViewportTopRow(i);if(0!==t)if(1===t)for(n=ee((r.getViewportHeight(i)-o._getZoomRowHeight(e))/2);0<e&&!((n-=o._getZoomRowHeight(e-1))<0);e--);else if(2===t)for(n=r.getViewportHeight(i)-o._getZoomRowHeight(e);0<e&&!((n-=o._getZoomRowHeight(e-1))<0);e--);else if(3===t&&!(e<a||-1===a))for(n=r.getViewportHeight(i)-o._getZoomRowHeight(e);a<e&&!((n-=o._getZoomRowHeight(e-1))<0);e--);return e},showColumn:function(e,t){this.showCell(this._scrollTopRow,e,0,t)},showRow:function(e,t){this.showCell(e,this._scrollLeftCol,t,0)},suspendEvent:function(){this._eventSuspended++},resumeEvent:function(){--this._eventSuspended<0&&(this._eventSuspended=0)},isEventSuspended:function(){return this._eventSuspended>0},currentTheme:function(e){var t=this;return 0===arguments.length?(t._currentTheme||t._resetCurrentTheme(),t._currentTheme):(typeof e===ne&&(e=L[e]?L[e]:new H(e)),t._currentTheme=e,t._render._resetDefaultFont(),t._clearStyleCache(),t._invalidate(),t)},_getDefaultTheme:function(){var e=F._getCssClassThemeStyle(""),t=K(e.zIndex),n=L.Office2007;return t>2007&&(n=L.Office),n},_resetCurrentTheme:function(){this._currentTheme=this._getDefaultTheme(),this._clearStyleCache()},reset:function(){var e=this;e._resetImp(),e._invalidate()},_resetImp:function(){var e=this;e._zoomFactor=1,e._initializeActiveCell(),e._activeRowViewportIndex=0,e._activeColViewportIndex=0,e.defaults={rowHeight:g._defaultRowHeight,colWidth:g._defaultColWidth,rowHeaderColWidth:g._defaultRowHeaderColWidth,colHeaderRowHeight:g._defaultColHeaderRowHeight},e._initOptions(),e._layoutModel=J,e._rowLayoutCache={colHeader:J,viewport:J,colFooter:J},e._colLayoutCache={rowHeader:J,viewport:J},e._scrollTopRow=0,e._scrollLeftCol=0,e.frozenRowCount(0),e.frozenColumnCount(0),e.frozenTrailingRowCount(0),e.frozenTrailingColumnCount(0),this._eventHandler=new t._SheetEventHandler(this);var n=e.parent;if(n){var r=n.getActiveSheet();r&&e.name()===r.name()&&e._setHost(n._vp)}e._styleComposeCache=[{},{},{},{}],e._cachePool=new R(e),e._composedDefaultStyle={},t._supportsCalc&&e.resetCalc();var o,i=b._SheetModel,a=b._AxisModel,s=b._SpanModel;e._dataModel=o=new i(g._defaultRowCount,g._defaultColCount),e._rowHeaderModel=new i(o.rowCount,g._defaultRowHeaderColumnCount),e._colHeaderModel=new i(g._defaultColHeaderRowCount,o.colCount),e._rowInfos=new a("row"),e._colInfos=new a,e._colHeaderRowInfos=new a,e._rowHeaderColInfos=new a,e._spanModel=new s,e._colHeaderSpanModel=new s,e._rowHeaderSpanModel=new s,e._tag=J,e._resetCurrentTheme(),e._namedStyles={},e._needSyncHScrollbarSize=!0,e._needSyncVScrollbarSize=!0,e._layoutSuspended=0,e._eventSuspended=0,e._dirtySuspended=0,e._disposed=!1,e._containerDiv=J,e._rowStateProviders=[],e._colStateProviders=[],g._callFeatureHandler(e,"init")},_initOptions:function(){var e=this;B(me,function(t,n){if(!k(n)){var r=n;"gridline"===t?r={color:F._getCssClassThemeStyle("gc-gridlineColor").borderTopColor,showVerticalGridline:!0,showHorizontalGridline:!0}:"object"==typeof r&&(r=w.extend({},n)),e.options[t]=r}})},_onAttached:function(e){var t=this;t.parent=e,t._layoutSuspended=e._paintSuspended,g._callFeatureHandler(t,"attach",e)},_canChange:function(e,n,r,o,i,a){var s=this;return s.options.isProtected&&s._isAnyCellInRangeLocked(A(e,n,r,o))?(i&&s._raiseInvalidOperation(1,i),!1):!(t._supportsCalc&&!s._checkArrayFormula(e,n,r,o))||(a&&s._raiseInvalidOperation(1,a),!1)},clear:function(e,t,n,r,o,i){0!==o&&this._clearCore(e,t,n,r,o,i)},_clearCore:function(e,n,r,o,i,a,s,l){var f=this;try{var d=t._supportsCalc;d&&f.suspendCalcService(),f.suspendPaint();var p,h,m,_,v=f.defaults,y=3;if(t._supportsCalc&&(k(i)||i===y)){if(!f._checkArrayFormula(e,n,r,o))return!1;if(1&a&&f.getDataSource&&f.getDataSource()){for(f.suspendEvent(),p=e;p<e+r;p++)if(!(s&&f._isRowFilterOut&&f._isRowFilterOut(p)))for(h=n;h<n+o;h++)f.setValue(p,h,J,i);f.resumeEvent()}}var b={changeType:"clear",row:e,col:n,rowCount:r,colCount:o,sheetArea:i,type:a,ignoreTable:l};g._callFeatureHandler(f,se,b);var w=f._getModel(i),C=d&&f._getCalcModel();p=-1===e?0:e;var S=-1===e?c(w):r;h=-1===n?0:n;for(var x=-1===n?u(w):o,T=[],E=p;E<S;E++)s&&f._isRowFilterOut&&f._isRowFilterOut(E)&&T.push(E);var M=[];for(m=0;m<S;m++)for(_=0;_<x;_++)M.push({row:p+m,col:h+_,value:f.getValue(p+m,h+_)});if(w.clear(p,h,S,x,a,T),C&&1&a&&(C._unlinkCellExpression(p,h,S,x),C.clear(p,h,S,x)),8&a&&!(e>=0&&n>=0))if(n>=0)for(_=0;_<x;_++)f.setTag(-1,h+_,J,i);else if(e>=0)for(m=0;m<S;m++)s&&f._isRowFilterOut&&f._isRowFilterOut(p+m)||f.setTag(p+m,-1,J,i);else f.setTag(-1,-1,J,i);if(2&a&&!(e>=0&&n>=0))if(n>=0)for(_=0;_<x;_++)f.setStyle(-1,h+_,J,i);else if(e>=0)for(m=0;m<S;m++)s&&f._isRowFilterOut&&f._isRowFilterOut(p+m)||f.setStyle(p+m,-1,J,i);else f.setStyle(-1,-1,J,i);if(32&a){if(e<0)for(_=0;_<x;_++)f.setColumnVisible(h+_,!0,i),f.setColumnResizable(h+_,!0,i),f.setColumnWidth(h+_,2===i?v.rowHeaderColWidth:v.colWidth,i);if(n<0)for(m=0;m<S;m++)s&&f._isRowFilterOut&&f._isRowFilterOut(p+m)||(f.setRowVisible(p+m,!0,i),f.setRowResizable(p+m,!0,i),f.setRowHeight(p+m,1===i?v.colHeaderRowHeight:v.rowHeight,i))}if((k(i)||i===y)&&d&&1==(1&a)){var A=f._getCalcModel();A&&A._addCellsToDirty(e,n,r,o)}f._raiseRangeDataChanged(e,n,S,x,M,2,i)}finally{f.resumePaint(),d&&f.resumeCalcService(!1)}},_adjustActiveCellToSelectable:function(){var e=this,t=e.options,n=t.protectionOptions;if(t.isProtected&&n&&(!1===n.allowSelectLockedCells||!1===n.allowSelectUnlockedCells)){var r=e._activeRowIndex,o=e._activeColIndex;e._canSelect(r,o)||(e._clearSelectionImp(),e._moveActiveCellRight(r,o,!0),e._moveActiveCellEnd(4,r,o))}},setArray:function(e,n,r,o){var i=this;o=t._supportsCalc&&o;var a=c(i),s=u(i);if(r&&0<=e&&e<a&&0<=n&&n<s){t._supportsCalc&&i.suspendCalcService(),i.suspendPaint();try{B(r,function(t,r){if(r instanceof Array)B(r,function(r,l){var u=e+t,c=n+r;u<a&&c<s&&(o?i.setFormula(u,c,l):i.setValue(u,c,l,3,!0))});else{var l=e+t,u=n;l<a&&u<s&&(o?i.setFormula(l,u,r):i.setValue(l,u,r,3,!0))}})}finally{t._supportsCalc&&i.resumeCalcService(),i.resumePaint()}}},getArray:function(e,n,r,o,i){var a=this,s=[],l=c(a),f=u(a);if(i=i&&t._supportsCalc,0<=e&&e<l&&0<=n&&n<f){e+r>l&&(r=l-e),n+o>f&&(o=f-n);for(var d=0;d<r;d++){s[d]=[];for(var p=0;p<o;p++)s[d][p]=i?a.getFormula(e+d,n+p):a.getValue(e+d,n+p)}}return s},setTag:function(e,t,n,r){k(r)&&(r=3);var o=this;if(0!==r){var a=o._getModel(r),s=c(a),l=u(a);if(e<-1||e>=s||t<-1||t>=l)return;n=i(n);var f,d=o._eventSuspended>0;d||(f=o.getTag(e,t,r)),a.setValueForKey(e,t,ae,n),d||f===n||(-1!==e&&-1!==t?o._raiseCellChanged(ae,e,t,r,f,n):-1!==e&&-1===t?o._raiseRowChanged(e,r,ae,n,f):-1===e&&-1!==t&&o._raiseColumnChanged(t,r,ae,n,f))}},getTag:function(e,t,n){var r=this;if(k(n)&&(n=3),0!==n){return o(r._getModel(n).getValueForKey(e,t,ae))}return J},tag:function(e){var t=this;return 0===arguments.length?o(t._tag):(t._tag=i(e),t)},getParent:function(){return this.parent},getDirtyRows:function(){return a(this,!0)},getInsertRows:function(){return a(this,!1)},getDeletedRows:function(){var e=[],t=this._deletedRows;return t&&B(t,function(t,n){n&&!w.isFunction(n)&&e.push({row:n.row,originalItem:n.data})}),e},hasPendingChanges:function(){var e=this,t=e._deletedRows;if(t&&t.length>0)return!0;var n=e._getModel()._dirtyNodes;return!U(n)},clearPendingChanges:function(){this._getModel()._dirtyNodes={},this._deletedRows=[]},getDirtyCells:function(e,t,n,r){function o(e,t,n,r){return{row:t,col:n,newValue:e.getValue(t,n),oldValue:r}}var i=this;k(e)&&(e=-1),k(t)&&(t=-1),(k(n)||n<=0)&&(n=1),(k(r)||r<=0)&&(r=1);var a=[],s=i._getModel()._dirtyNodes;if(!U(s)){var l=[];if(e>=0)for(var u=e;u<e+n;u++)l.push(u);else for(var c in s)z(s,c)&&l.push(K(c));var f,d;B(l,function(e,n){if((f=s[n])&&"e"===f.rs)if(t>=0)for(var l=t;l<t+r;l++)(d=f[l])&&a.push(o(i,n,l,d.oldValue));else for(var u in f)q(u)||(d=f[u])&&a.push(o(i,n,K(u),d.oldValue))})}return a},suspendDirty:function(){this._dirtySuspended++,this._getModel()._dirtySuspended++},resumeDirty:function(){var e=this,t=e._getModel();e._dirtySuspended--,t._dirtySuspended--,e._dirtySuspended<0&&(e._dirtySuspended=0,t._dirtySuspended=0)},isDirtySuspended:function(){return this._dirtySuspended>0},_isValidSheetName:function(e){if(!e||""===e)return!1;var t,n;for(n=0;n<e.length;n++)if("*"===(t=e.charAt(n))||":"===t||"["===t||"]"===t||"?"===t||"\\"===t||"/"===t)return!1;var r=this,o=r.parent;if(!o)return!0;var i=o.sheets,a=i.length;for(n=0;n<a;n++){var s=i[n];if(s!==r&&e===s._name)return!1}return!0},_init:function(e){this._name=e,this._setBounds(new I(0,0,0,0)),this._resetImp()},_getCanvasOffset:function(){var e=this,t=w(e._getCanvas()).offset();t?(t.top+=G.body.clientTop||0,t.left+=G.body.clientLeft||0):t={top:0,left:0};var n=Y._gcGlobal.canvasOffset;return n&&(t=n),t},_setHost:function(e){if(e){var t=this;t._disposed=!1;t._canvas&&t._dispose(!1);var n=M("canvas");w(n).attr("id",e.getAttribute("id")+"_vp").html(r().NeedCanvasSupport).appendTo(e),T._adjustDevicePixel(n,J,t),t._canvas=n,t._doResize(),t.repaint(),t.parent&&t.parent._paintWorkbookBackgroundImage(),g._callFeatureHandler(t,"setHost",w(n))}},_doResize:function(){var e=this,t=e._getCanvas();if(t&&t.parentNode){var n=getComputedStyle(t.parentNode),r=n.width,o=n.height,i=r.indexOf("px");i>0&&(r=r.substring(0,i)),i=o.indexOf("px"),i>0&&(o=o.substring(0,i));var a=K(r),s=K(o);if(q(a)&&(a=w(t.parentNode).width()),q(s)&&(s=w(t.parentNode).height()),0!==a&&0!==s){var l=$(a,0),u=$(s,0);t.style.display="none",t.style.display="",t.width=l,t.height=u,t.style.width=l+"px",t.style.height=u+"px",l=t.clientWidth||t.width,u=t.clientHeight||t.height,e._bounds.width=l,e._bounds.height=u,T._setSize(t,l,u),e.invalidateLayout()}}},_dispose:function(e){var t=this;T._disposeSheet(t),t.isEditing&&t.isEditing()&&t.endEdit(),g._callFeatureHandler(t,"dispose",e);var n,r=t._canvas;if(r&&(n=r.parentNode,n&&n.removeChild(r),t._canvas=J),t._disposeStringWidthPre(),t._disposeStringWidthSpan(),!1!==e){t._disposed=!0;var o=t._cutCopyIndicatorManager;o&&o._dispose(),t.parent=J,t._dataModel=J,t._rowHeaderModel=J,t._colHeaderModel=J,t._rowInfos=J,t._colInfos=J,t._colHeaderRowInfos=J,t._rowHeaderColInfos=J,t._spanModel=J,t._colHeaderSpanModel=J,t._rowHeaderSpanModel=J,t._cachePool=J,t._imageLoader=J,N._isActiveElement(t)&&N._setActiveElement(J,!0)}},_disposeStringWidthSpan:function(){var e=this._editingSpan;e&&(w(e).remove(),this._editingSpan=Z)},_disposeStringWidthPre:function(){var e=this._editingPre;e&&(w(e).remove(),this._editingPre=Z)},_getModel:function(e){return 3===e||k(e)?this._dataModel:2===e?this._rowHeaderModel:1===e?this._colHeaderModel:J},_getRowInfos:function(e){return 1===e||0===e?this._colHeaderRowInfos:this._rowInfos},_getColInfos:function(e){return 2===e||0===e?this._rowHeaderColInfos:this._colInfos},_getValueImp:function(e,t,n,r){var i=this;k(r)&&(r=3);var a=3===r,s=J;if(a){var l=i.tables;if(l){l.find(t,n)&&(s=l._getValue(t,n),s=s._hasValue?s._value:J)}}if(k(s)){var u=i._bindingManager,c=J;u&&u._dataSource&&a&&(c=u.getValue(t,n)),s=c&&c.hasBinding?c.value:e.getValue(t,n)}return s=o(s)},_getActualRange:function(e,t){k(t)&&(t=3);var n=A(-1,-1,-1,-1);if(e){var r=this,o=e.row,i=e.col,a=e.rowCount,s=e.colCount;-1===i&&(i=0,s=r.getColumnCount(t)),-1===o&&(o=0,a=r.getRowCount(t)),n.col=i,n.row=o,n.colCount=s,n.rowCount=a}return n},getRangeRect:function(e,t,n){function r(e,t){for(;e>t;)if(e--,g.getColumnVisible(e))return e;return e}function o(e,t){for(;e<t;)if(e++,g.getColumnVisible(e))return e;return e}function i(e,t){for(;e>t;)if(e--,g.getRowVisible(e))return e;return e}function a(e,t){for(;e<t;)if(e++,g.getRowVisible(e))return e;return e}var m=new I(-1,-1,-1,-1),g=this,_=g._getSheetLayout();if(0===_.width||0===_.height)return m;var v=g._getViewportColumnLayout(t),y=g._getViewportRowLayout(e);if(!v||0===v.length||!y||0===y.length)return m;var b=g._getActualRange(n),w=g._cachePool,C=b.row,S=b.row+b.rowCount-1,x=b.col,T=b.col+b.colCount-1,E=h(g),M=c(g)-d(g)-1,A=p(g),k=u(g)-f(g)-1,R=v[0].col,O=v[v.length-1].col,D=y[0].row,P=y[y.length-1].row;return x<R&&(x=r(R,x)),T>O&&(T=o(O,T)),C<D&&(C=i(D,C)),S>P&&(S=a(P,S)),T<x||S<C?m:(0===t?x<A&&(m.x=_._frozenX+s(w,0,x-1),m.width=s(w,x,T)):1===t?x<=k&&T>=A&&(m.x=x<R?v[0].x-s(w,x,R-1):v[0].x+s(w,R,x-1),m.width=s(w,x,T)):2===t&&T>k&&(m.x=x<R?_._frozenTrailingX-s(w,x,R-1):_._frozenTrailingX+s(w,R,x-1),m.width=s(w,x,T)),0===e?C<E&&(m.y=_._frozenY+l(w,0,C-1),m.height=l(w,C,S)):1===e?C<=M&&S>=E&&(m.y=C<D?y[0].y-l(w,C,D-1):y[0].y+l(w,D,C-1),m.height=l(w,C,S)):2===e&&S>M&&(m.y=C<D?_._frozenTrailingY-l(w,C,D-1):_._frozenTrailingY+l(w,D,C-1),m.height=l(w,C,S)),m)},_getRangeWholeRect:function(e){var t=this,n=new I(-1,-1,-1,-1),r=t._getSheetLayout();if(0===r.width||0===r.height)return n;var o,i,a=t._getActualRange(e),m=p(t),g=h(t),_=f(t),v=d(t),y=t._cachePool,b=a.row,w=a.row+a.rowCount-1,C=a.col,S=a.col+a.colCount-1,x=c(t),T=u(t);if(C<m)n.x=r._frozenX+s(y,0,C-1),n.width=s(y,C,Q(S,m-1)),m<=S&&S<T-_?(o=t._getViewportColumnLayout(1))&&o.length>0&&(n.width+=s(y,o[0].col,Q(S,o[o.length-1].col))):S>=T-_&&(o=t._getViewportColumnLayout(2))&&o.length>0&&(n.width=o[0].x-n.x,n.width+=s(y,T-_,Q(S,T-1)));else if(C<T-_){if(!(o=t._getViewportColumnLayout(1))||0===o.length||C>o[o.length-1].col||S<o[0].col)return n;n.x=r._viewportX+s(y,o[0].col,C-1),m<=S&&S<T-_?n.width=s(y,$(C,o[0].col),Q(S,o[o.length-1].col)):S>=T-_&&(o=t._getViewportColumnLayout(2))&&o.length>0&&(n.width=o[0].x-n.x,n.width+=s(y,T-_,Q(S,T-1)))}else C<T&&(o=t._getViewportColumnLayout(2))&&o.length>0&&(n.x=r._frozenTrailingX+s(y,o[0].col,C-1),n.width=s(y,C,Q(S,T-1)));if(b<g)n.y=r._frozenY+l(y,0,b-1),n.height=l(y,b,Q(w,g-1)),g<=w&&w<x-v?(i=t._getViewportRowLayout(1))&&i.length>0&&(n.height+=l(y,i[0].row,Q(w,i[i.length-1].row))):w>=x-v&&(i=t._getViewportRowLayout(2))&&i.length>0&&(n.height=i[0].y-n.y,n.height+=l(y,x-v,Q(w,x-1)));else if(b<x-v){if(!(i=t._getViewportRowLayout(1))||0===i.length||b>i[i.length-1].row||w<i[0].row)return n;n.y=r._viewportY+l(y,i[0].row,b-1),g<=w&&w<x-v?n.height=l(y,$(b,i[0].row),Q(w,i[i.length-1].row)):w>=x-v&&(i=t._getViewportRowLayout(2))&&i.length>0&&(n.height=i[0].y-n.y,n.height+=l(y,x-v,Q(w,x-1)))}else b<x&&(i=t._getViewportRowLayout(2))&&i.length>0&&(n.y=r._frozenTrailingY+l(y,i[0].row,b-1),n.height+=l(y,b,Q(w,x-1)));return n},_getCanvas:function(){return this._canvas},_getStringWidth:function(e,t){return this._getStringWidthByCanvas(e,t)+1},_getStringWidthByCanvas:function(e,t){var n="",r=this._render;return n=t||r._getZoomFont(r._getDefaultFont()),_._WordWrapHelper._measureText(e,n)},_getFontHeight:function(e,t){var n=this,r=n._fontHeightCache;if(!t)if(r){var o=r[e];if(o)return o}else r=n._fontHeightCache={};var i=n._getEditingSpan();i.style.font=e||n._render._getDefaultFont(),i.innerHTML="H";var a=i.offsetHeight;return t||(r[e]=a),a},_getEditingSpan:function(){if(!this._editingSpan){var e=M("span"),t=e.style,n="-10000px";t.visibility="hidden",t.top=n,t.left=n,t.position="absolute",e.setAttribute("gcUIElement","gcStringWidthSpan"),G.body.insertBefore(e,J),this._editingSpan=e}return this._editingSpan},_getColumnViewportIndexFromX:function(e){var t=this._getSheetLayout(),n=J;return t._headerX<e&&e<t._headerX+t._rowHeaderWidth?n=-1:t._frozenX<e&&e<t._frozenX+t._frozenWidth?n=0:t._viewportX<e&&e<t._viewportX+t._viewportWidth?n=1:t._frozenTrailingX<e&&e<t._frozenTrailingX+t._frozenTrailingWidth&&(n=2),n},_getRowViewportIndexFromY:function(e){var t=this._getSheetLayout(),n=J;return t._headerY<e&&e<t._headerY+t._colHeaderHeight?n=-1:t._frozenY<e&&e<t._frozenY+t._frozenHeight?n=0:t._viewportY<e&&e<t._viewportY+t._viewportHeight?n=1:t._frozenTrailingY<e&&e<t._frozenTrailingY+t._frozenTrailingHeight&&(n=2),n},_getRowIndexFromY:function(e,t){var n=J;if(n=-1===t?this._getColumnHeaderRowLayout():this._getViewportRowLayout(t)){var r=n.findY(e);if(r)return r.row}},_getColumnIndexFromX:function(e,t){var n=J;if(n=-1===t?this._getRowHeaderColumnLayout():this._getViewportColumnLayout(t)){var r=n.findX(e);if(r)return r.col}},_isActiveCell:function(e,t){var n=this;return n._activeRowIndex<=e&&e<n._activeRowIndex+n._activeRowCount&&n._activeColIndex<=t&&t<n._activeColIndex+n._activeColCount},_isColumnSelected:function(e){var t=this._selectionModel;return!!t&&t._isColumnSelected(e)},_isRowSelected:function(e){var t=this._selectionModel;return!!t&&t._isRowSelected(e)},_isSelected:function(e,t,n,r){var o=this,i=o._selectionModel;if(!i)return!1;var a=c(o),s=u(o);return i._isSelected(e,t,n,a,s,r)},_isAllSelected:function(e,t,n){var r=this,o=r._selectionModel;if(!o)return!1;var i=c(r),a=u(r);return o._isAllSelected(e,t,n,i,a)},_isHover:function(e,t,n){var r,o,i,a=this,s=a._currentTarget;if(s&&!s.resizeInfo&&!k(n)){var l=s.hitTestType,u=s.row,c=s.col;if(1===n)return r=!1,o=a._getSpanModel(1).find(u,c),o&&(r=o.contains(e,t,1,1)),i=e===u&&t===c||r,l===n&&i;if(2===n)return r=!1,o=a._getSpanModel(2).find(u,c),o&&(r=o.contains(e,t,1,1)),i=e===u&&t===c||r,l===n&&i;if(3===n)return l===n&&e===u&&t===c;if(0===n)return l===n}return!1},_indexToLetters:function(e){for(var t="A",n=t.charCodeAt(0),r="";e>0;e=parseInt((e-1)/26),10){var o=(e-1)%26;r=String.fromCharCode(n+o)+r}return r},_getSheetArea:function(e,t){return e>=0&&e<=2&&t>=0?3:e>=0&&e<=2&&t<0?2:e<0&&t>=0?1:e<0&&t<0?0:J},_setFocus:function(e){var t=this._eventHandler;t&&t._setFocus(e)},_getHost:function(){var e,t=this,n=t.parent;if(!(e=n&&n._host)){var r=t._canvas;e=r&&r.parentElement}return e},_initializeActiveCell:function(){var e=this,t=0,n=0;e._activeRowIndex=t,e._activeColIndex=n,e._activeRowCount=1,e._activeColCount=1,e._leadingCellRow=t,e._leadingCellCol=n},_getZoomRowHeight:function(e,t){var n=this,r=n.getRowHeight(e,t),o=n._zoomFactor;return 1!==o&&(r*=o),ee(r)},_getZoomColumnWidth:function(e,t){var n=this,r=n.getColumnWidth(e,t),o=n._zoomFactor;return 1!==o&&(r*=o),ee(r)},_createLayout:function(){var e=this,t=e._getBounds(),n=e.options,r=n.borderWidth,o=new I(t.x+r,t.y+r,$(0,t.width-2*r),$(0,t.height-2*r)),i=o.width,a=o.height,s={x:o.x,y:o.y,width:o.width,height:o.height,_rowHeaderWidth:0,_colHeaderHeight:0,_frozenWidth:0,_frozenHeight:0,_frozenTrailingWidth:0,_frozenTrailingHeight:0,_footerHeight:0,_footerWidth:0,_footerX:0,_footerY:0,_frozenX:0,_frozenY:0,_frozenTrailingX:0,_frozenTrailingY:0,_viewportX:0,_viewportY:0,_viewportHeight:0,_viewportWidth:0,_headerX:0,_headerY:0,_headerCornerRect:function(){var e=this;return new I(e.x,e.y,e._rowHeaderWidth,e._colHeaderHeight)},_colHeaderRect:function(e){var t=this;return 0===e?new I(t._frozenX,t.y,t._frozenWidth,t._colHeaderHeight):1===e?new I(t._viewportX,t.y,t._viewportWidth,t._colHeaderHeight):2===e?new I(t._frozenTrailingX,t.y,t._frozenTrailingWidth,t._colHeaderHeight):J},_rowHeaderRect:function(e){var t=this;return 0===e?new I(t.x,t._frozenY,t._rowHeaderWidth,t._frozenHeight):1===e?new I(t.x,t._viewportY,t._rowHeaderWidth,t._viewportHeight):2===e?new I(t.x,t._frozenTrailingY,t._rowHeaderWidth,t._frozenTrailingHeight):J},_viewportRect:function(e,t){var n=this;if(0===e){if(0===t)return new I(n._frozenX,n._frozenY,n._frozenWidth,n._frozenHeight);if(1===t)return new I(n._viewportX,n._frozenY,n._viewportWidth,n._frozenHeight);if(2===t)return new I(n._frozenTrailingX,n._frozenY,n._frozenTrailingWidth,n._frozenHeight)}else if(1===e){if(0===t)return new I(n._frozenX,n._viewportY,n._frozenWidth,n._viewportHeight);if(1===t)return new I(n._viewportX,n._viewportY,n._viewportWidth,n._viewportHeight);if(2===t)return new I(n._frozenTrailingX,n._viewportY,n._frozenTrailingWidth,n._viewportHeight)}else if(2===e){if(0===t)return new I(n._frozenX,n._frozenTrailingY,n._frozenWidth,n._frozenTrailingHeight);if(1===t)return new I(n._viewportX,n._frozenTrailingY,n._viewportWidth,n._frozenTrailingHeight);if(2===t)return new I(n._frozenTrailingX,n._frozenTrailingY,n._frozenTrailingWidth,n._frozenTrailingHeight)}return J}};if(e._getOutlineLayout){var l=e._getOutlineLayout();s.x+=l.width,s.y+=l.height,i-=l.width,a-=l.height}var m,g,_,v;if(n.rowHeaderVisible)for(v=e.getColumnCount(2),_=0;_<v;_++)s._rowHeaderWidth+=e._getZoomColumnWidth(_,2);if(n.colHeaderVisible)for(g=e.getRowCount(1),m=0;m<g;m++)s._colHeaderHeight+=e._getZoomRowHeight(m,1);var y=p(e);if(y>0)for(v=u(e),_=0;_<y&&_<v;_++)e.getColumnVisible(_)&&(s._frozenWidth+=e._getZoomColumnWidth(_));var b=h(e);if(b>0)for(g=c(e),m=0;m<b&&m<g;m++)e.getRowVisible(m)&&(s._frozenHeight+=e._getZoomRowHeight(m));var w=f(e);if(w>0)for(v=u(e),_=$(y,v-w);_<v;_++)s._frozenTrailingWidth+=e._getZoomColumnWidth(_);var C=d(e);if(C>0)for(g=c(e),m=$(b,g-C);m<g;m++)s._frozenTrailingHeight+=e._getZoomRowHeight(m);return i-=s._rowHeaderWidth,a-=s._colHeaderHeight,i-=s._frozenWidth,a-=s._frozenHeight,i-=s._frozenTrailingWidth,a-=s._frozenTrailingHeight,a-=s._footerHeight,s._viewportWidth=$(0,i),s._viewportHeight=$(0,a),s._headerX=s.x,s._headerY=s.y,s._frozenX=s._headerX+s._rowHeaderWidth,s._frozenY=s._headerY+s._colHeaderHeight,s._viewportX=s._frozenX+s._frozenWidth,s._viewportY=s._frozenY+s._frozenHeight,s._frozenTrailingX=s._viewportX+s._viewportWidth,s._frozenTrailingY=s._viewportY+s._viewportHeight,s._footerX=s._headerX,s._footerY=s.y+s.height-s._footerHeight,s},_getSheetLayout:function(){var e=this;return e._layoutModel||(e._layoutModel=e._createLayout()),e._layoutModel},_getColumnLayout:function(e,t){return k(t)||3===t||1===t?this._getViewportColumnLayout(e):2===t?this._getRowHeaderColumnLayout():J},_getRowHeaderColumnLayout:function(){var e=this;return e._colLayoutCache.rowHeader||(e._colLayoutCache.rowHeader=e._createRowHeaderColumnLayout()),e._colLayoutCache.rowHeader},_getViewportColumnLayout:function(e){var t=this;return t._colLayoutCache.viewport||(t._colLayoutCache.viewport={}),t._colLayoutCache.viewport[e]||(t._colLayoutCache.viewport[e]=t._createViewportColumnLayout(e)),t._colLayoutCache.viewport[e]},_createRowHeaderColumnLayout:function(){for(var e,t=new j,n=this._getSheetLayout(),r=n._headerX,o=this.getColumnCount(2),i=0;i<o;i++)e=this._getZoomColumnWidth(i,2),t.push(new V(-1,i,r,-1,e,-1)),r+=e;return t},_createViewportColumnLayout:function(e){var t,n,r,o=this,i=new j,a=o._getSheetLayout(),s=u(o),l=o._cachePool,c=p(o),d=f(o);if(0===e)for(n=a._frozenX,s=Q(c,s),t=0;t<s;t++)r=l._getZoomColWidth(t),i.push(new V(-1,t,n,-1,r,-1)),n+=r;else if(1===e){n=a._viewportX,s-=d;var h=a._viewportWidth,m=$(c,o._scrollLeftCol);for(t=m;h>0&&t<s;t++)r=l._getZoomColWidth(t),i.push(new V(-1,t,n,-1,r,-1)),n+=r,h-=r}else if(2===e)for(n=a._frozenTrailingX,t=$(c,s-d);t<s;t++)r=l._getZoomColWidth(t),i.push(new V(-1,t,n,-1,r,-1)),n+=r;return i},_getRowLayout:function(e,t){return k(t)||3===t||2===t?this._getViewportRowLayout(e):1===t?this._getColumnHeaderRowLayout():J},_getAllRowLayout:function(e){for(var t=new j,n=0;n<3;n++){var r=this._getRowLayout(n,e);r&&r.length>0&&(t=w.merge(t,r))}return t},_getAllColumnLayout:function(e){for(var t=new j,n=0;n<3;n++){var r=this._getColumnLayout(n,e);r&&r.length>0&&(t=w.merge(t,r))}return t},_getColumnHeaderRowLayout:function(){var e=this;return e._rowLayoutCache.colHeader||(e._rowLayoutCache.colHeader=e._createColumnHeaderRowLayout()),e._rowLayoutCache.colHeader},_getViewportRowLayout:function(e){var t=this;return t._rowLayoutCache.viewport||(t._rowLayoutCache.viewport={}),t._rowLayoutCache.viewport[e]||(t._rowLayoutCache.viewport[e]=t._createViewportRowLayout(e)),t._rowLayoutCache.viewport[e]},_createColumnHeaderRowLayout:function(){for(var e,t=new j,n=this._getSheetLayout(),r=n._headerY,o=this.getRowCount(1),i=0;i<o;i++)e=this._getZoomRowHeight(i,1),t.push(new V(i,-1,-1,r,-1,e)),r+=e;return t},_createViewportRowLayout:function(e){var t,n,r,o=this,i=new j,a=h(o),s=d(o),l=o._getSheetLayout(),u=c(o),f=o._cachePool;if(0===e)for(n=l._frozenY,u=Q(a,u),t=0;t<u;t++)r=f._getZoomRowHeight(t),i.push(new V(t,-1,-1,n,-1,r)),n+=r;else if(1===e){n=l._viewportY,u-=s;var p=l._viewportHeight,m=$(a,o._scrollTopRow);for(t=m;p>0&&t<u;t++)r=f._getZoomRowHeight(t),i.push(new V(t,-1,-1,n,-1,r)),n+=r,p-=r}else if(2===e)for(n=l._frozenTrailingY,t=$(a,u-s);t<u;t++)r=f._getZoomRowHeight(t),i.push(new V(t,-1,-1,n,-1,r)),n+=r;return i},_getCellLayout:function(e,t,n){var r=this,o=r.getRowCount(n),i=r.getColumnCount(n),a=r._getRowLayout(e,n),s=r._getColumnLayout(t,n),l=new j;if(a&&a.length>0&&s&&s.length>0){var u=a[0].row,c=s[0].col,f=a[a.length-1].row,d=s[s.length-1].col,p=r.getSpans(A(u,c,f-u+1,d-c+1),n);p&&p.length>0&&r._addCellLayout(p,u,c,f,d,l,o,i,n,a,s)}return l},_getCellLayoutByCell:function(e,t,n,r,o){var i=this,a=i.getRowCount(n),s=i.getColumnCount(n),l=i._getRowLayout(e,n),u=i._getColumnLayout(t,n),c=new j;if(l&&l.length>0&&u&&u.length>0){var f=l[0].row,d=u[0].col,p=i.getSpan(r,o,n);if(p){var h=[];h.push(p),i._addCellLayout(h,f,d,p.row+p.rowCount,p.col+p.colCount,c,a,s,n,l,u)}return c.length>0?c[0]:J}return J},_addCellLayout:function(e,t,n,r,o,i,a,s,l,u,c){var f=e.length;if(!(f<=0)){var d,p=this,h=r+1,m=o+1,g=[],_=[],v=[],y=[],b=0,w=0;for(d=t-1;d>=0;d--)g[d]=p._getZoomRowHeight(d,l),w-=g[d],y[d]=w;for(w=0,d=t;d<h;d++)y[d]=w,g[d]=p._getZoomRowHeight(d,l),w+=g[d];for(d=n-1;d>=0;d--)_[d]=p._getZoomColumnWidth(d,l),b-=_[d],v[d]=b;for(b=0,d=n;d<m;d++)v[d]=b,_[d]=p._getZoomColumnWidth(d,l),b+=_[d];for(var C=0;C<f;C++){var S=e[C];if(S.intersect(t,n,r-t+1,o-n+1)){var x=S.row+S.rowCount;if(x>h){for(d=h;d<x;d++)g.push(p._getZoomRowHeight(d,l)),y.push(y[d-1]+g[d]);h=x}var T=S.col+S.colCount;if(T>m){for(d=m;d<T;d++)_.push(p._getZoomColumnWidth(d,l)),v.push(v[d-1]+_[d]);m=T}var E,M,A=v[S.col],k=y[S.row],R=0,I=0;for(M=S.col;M<S.col+S.colCount&&M<s;M++)R+=_[M];for(E=S.row;E<S.row+S.rowCount&&E<a;E++)I+=g[E];i.push(new V(S.row,S.col,c[0].x+A,u[0].y+k,R,I,S.rowCount,S.colCount))}}}},_syncHScrollbarPosition:function(){var e=this,t=e.parent,n=e._getScrollableColumn(e._scrollLeftCol);-1!==n&&n!==e._scrollLeftCol&&(e._scrollLeftCol=n),t&&t._scrollbarH&&t._scrollbarH.value(e._getVisibleColIndex(e._scrollLeftCol))},_syncVScrollbarPosition:function(){var e=this,t=e.parent,n=e._getScrollableRow(e._scrollTopRow);-1!==n&&n!==e._scrollTopRow&&(e._scrollTopRow=n),t&&t._scrollbarV&&t._scrollbarV.value(e._getVisibleRowIndex(e._scrollTopRow))},_syncHScrollbarSize:function(){var e=this,t=e.parent;t&&t._resizeHScrollBar&&(t.options.scrollIgnoreHidden&&(e._columnIndexInfo=e._getColumnIndexInfo(!0)),t._resizeHScrollBar())},_syncVScrollbarSize:function(){var e=this,t=e.parent;t&&t._resizeVScrollBar&&(t.options.scrollIgnoreHidden&&(e._rowIndexInfo=e._getRowIndexInfo(!0)),t._resizeVScrollBar())},_getFirstPageLeftColumn:function(){var e=this,t=p(e);return t>0?e._getNextVisualColumn(t-1):e._getFirstVisualColumn()},_getFirstPageTopRow:function(){var e=this,t=h(e);return t>0?e._getNextVisualRow(t-1):e._getFirstVisualRow()},_getFirstVisualColumn:function(){return this._getNextVisualColumn(-1)},_getNextVisualColumn:function(e){for(var t=this,n=u(t)-1-f(t);e<n;)if(e++,t.getColumnVisible(e)&&t._getZoomColumnWidth(e)>0)return e;return J},_getPrevVisualColumn:function(e,t){for(var n=this,r=p(n);e>r;)if(e--,n.getColumnVisible(e,t)&&n._getZoomColumnWidth(e,t)>0)return e;return J},_getFirstVisualRow:function(){return this._getNextVisualRow(-1)},_getNextVisualRow:function(e,t){for(var n=this,r=t?c(n)-1:c(n)-1-d(n);e<r;)if(e++,n.getRowVisible(e)&&n._getZoomRowHeight(e)>0)return e;return J},_getPrevVisualRow:function(e,t,n){for(var r=this,o=n?0:h(r);e>o;)if(e--,r.getRowVisible(e,t)&&r._getZoomRowHeight(e,t)>0)return e;return J},_invalidateVScrollbar:function(){var e=this.parent;e&&e.options.scrollIgnoreHidden&&(this._needSyncVScrollbarSize=!0),this._syncVScrollbarPosition()},_invalidateHScrollbar:function(){var e=this.parent;e&&e.options.scrollIgnoreHidden&&(this._needSyncHScrollbarSize=!0),this._syncHScrollbarPosition()},_getVisibleRowIndex:function(e){var t=this.parent;if(t&&t.options.scrollIgnoreHidden){return this._getRowIndexInfo().visibleIndex[e]}return e},_getOriginalRowIndex:function(e){var t=this.parent;if(t&&t.options.scrollIgnoreHidden){return this._getRowIndexInfo().originalIndex[e]}return e},_getVisibleColIndex:function(e){var t=this.parent;if(t&&t.options.scrollIgnoreHidden){return this._getColumnIndexInfo().visibleIndex[e]}return e},_getOriginalColIndex:function(e){var t=this.parent;if(t&&t.options.scrollIgnoreHidden){return this._getColumnIndexInfo().originalIndex[e]}return e},_getColumnIndexInfo:function(e){var t=this;if(t._columnIndexInfo&&!e)return t._columnIndexInfo;var n=p(t),r=u(t)-f(t)-n,o=n,i=o+r-1,a=t._cachePool,s={visibleIndex:{},originalIndex:{}};if(i-o+1<=0)return s;for(var l=0,c=o;c<=i;c++)s.originalIndex[l]=c,s.visibleIndex[c]=l,a._getZoomColWidth(c)>0&&l++;for(c--,l--;a._getZoomColWidth(c)<=0&&c>=o;)s.originalIndex[l]=c,s.visibleIndex[c]=l,c--;return s},_getRowIndexInfo:function(e){var t=this;if(t._rowIndexInfo&&!e)return t._rowIndexInfo;var n=h(t),r=c(t)-d(t)-n,o=n,i=o+r-1,a=t._cachePool,s={visibleIndex:{},originalIndex:{}};if(i-o+1<=0)return s;for(var l=0,u=o;u<=i;u++)s.originalIndex[l]=u,s.visibleIndex[u]=l,a._getZoomRowHeight(u)>0&&l++;for(u--,l--;a._getZoomRowHeight(u)<=0&&u>=o;)s.originalIndex[l]=u,s.visibleIndex[u]=l,u--;return s},_getScrollableRow:function(e,t){var n,r=this,o=h(r),i=c(r)-d(r)-1;if(t){if(e>i&&(e=i),(n=r._getPrevVisualRow(e+1))!==J&&n>=o)return n}else if(e<o&&(e=o),(n=r._getNextVisualRow(e-1))!==J&&n<=i)return n;return-1},_getScrollableColumn:function(e,t){var n,r=this,o=p(r),i=u(r)-f(r)-1;if(t){if(e>i&&(e=i),(n=r._getPrevVisualColumn(e+1))!==J&&n>=o)return n}else if(e<o&&(e=o),(n=r._getNextVisualColumn(e-1))!==J&&n<=i)return n;return-1},_getTopRowWhenLastRowShowComplete:function(e,t,n){if(n<t)return n;for(var r=0,o=this._cachePool,i=this.parent.options.bottomPadding||0,a=n,s=n;a>=t;a--){var l=o._getZoomRowHeight(a);if(!(l<=0)){if((r+=l)>e-i)break;s=a}}return s},_getLeftColWhenLastColShowComplete:function(e,t,n){if(n<t)return n;for(var r=0,o=this._cachePool,i=this.parent.options.rightPadding||0,a=n,s=n;a>=t;a--){var l=o._getZoomColWidth(a);if(!(l<=0)){if((r+=l)>e-i)break;s=a}}return s},_getPageValueH:function(){var e=this._getSheetLayout(),t=this._getColumnLayout(1,3),n=0,r=0;if(t)for(var o=0;o<t.length;o++){var i=t[o].width;n+=i,i>0&&r++}r=0===r?1:r;var a=n/r;return 0===a?1:ee(e._viewportWidth/a)},_getPageValueV:function(){var e=this._getSheetLayout(),t=this._getRowLayout(1,3),n=0,r=0;if(t)for(var o=0;o<t.length;o++){var i=t[o].height;n+=i,i>0&&r++}r=0===r?1:r;var a=n/r;return 0===a?1:ee(e._viewportHeight/a)},_getLastVisualScrollRow:function(e){k(e)&&(e=3);var t=this,n=t.parent,r=h(t),o=d(t);if(n&&n.options.scrollbarMaxAlign){var i=t._getSheetLayout();return t._getTopRowWhenLastRowShowComplete(i._viewportHeight,r,c(t)-o-1)}var a=t.getRowCount(e);3!==e&&2!==e||(a-=o);var s=t._getPrevVisualRow(a,e);return s===J&&(s=r),s},_getLastVisualScrollColumn:function(e){k(e)&&(e=3);var t=this,n=t.parent,r=p(t);if(n&&n.options.scrollbarMaxAlign){var o=t._getSheetLayout();return t._getLeftColWhenLastColShowComplete(o._viewportWidth,r,u(t)-f(t)-1)}var i=t.getColumnCount(e);3!==e&&1!==e||(i-=f(t));var a=t._getPrevVisualColumn(i,e);return a===J&&(a=r),a},_getLastNonNullRowAndCol:function(){var e,t=this,n=h(t),r=p(t),o=c(t)-d(t)-1,i=u(t)-f(t)-1,a=t._getRowInfos(3),s=t._getColInfos(3);a&&(e=a._getItems(),e.length>0&&e.length-1>n&&(n=e.length-1)),s&&(e=s._getItems(),e.length>0&&e.length-1>r&&(r=e.length-1));var l=t._getModel();l._lastNonNullRow>n&&(n=l._lastNonNullRow),l._lastNonNullColumn>r&&(r=l._lastNonNullColumn);var m=t._getModel(2);m._lastNonNullRow>n&&(n=m._lastNonNullRow);var _=t._getModel(1);_._lastNonNullColumn>r&&(r=_._lastNonNullColumn);var v=t._getSpanModel();v._lastNonNullRow>n&&(n=v._lastNonNullRow),v._lastNonNullColumn>r&&(r=v._lastNonNullColumn);var y=t._getSpanModel(2);y._lastNonNullRow>n&&(n=y._lastNonNullRow);var b=t._getSpanModel(1);b._lastNonNullColumn>r&&(r=b._lastNonNullColumn);var w=g._features;return w&&B(w,function(e,o){var i=o.lastNonNullRowAndCol;if(i){var a=i.call(t);n=$(n,a.lastNonNullRow),r=$(r,a.lastNonNullCol)}}),n>o&&(n=o),r>i&&(r=i),{lastNonNullRow:n,lastNonNullCol:r}},_setTopRow:function(e){var t=this,n=t._scrollTopRow;if(e>=t._getFirstPageTopRow()&&e<=t._getLastVisualScrollRow()&&e!==n){var r=t.parent;r&&(r._scrollService._vScrollTo(e),t._syncVScrollbarPosition()),r&&!r.options.scrollbarShowMax&&t._syncVScrollbarSize()}},_setLeftColumn:function(e){var t=this,n=t._scrollLeftCol;if(e>=t._getFirstPageLeftColumn()&&e<=t._getLastVisualScrollColumn()&&e!==n){var r=t.parent;r&&(r._scrollService._hScrollTo(e),t._syncHScrollbarPosition()),r&&!r.options.scrollbarShowMax&&t._syncHScrollbarSize()}},_getSpanModel:function(e){return k(e)||3===e?this._spanModel:1===e?this._colHeaderSpanModel:2===e?this._rowHeaderSpanModel:void 0},_getCellTypeHitInfo:function(e,t,n){var r=this,o=e.row,i=e.col,a=e.hitTestType;if(k(o)||k(i))return J;var s=r.getSpan(o,i,a);s&&(o=s.row,i=s.col);var l=r.getActualStyle(o,i,a),u=1===a?-1:Z,c=2===a?-1:Z,f=r.getCellRect(o,i,u,c),d={sheet:r,row:o,col:i,sheetArea:a};return(l.cellType||r._getDefaultCellType(a))._getHitInfoWrapper(t,n,l,f,d)},_disposeUserEvents:function(){this.unbindAll(),this._unbindAll()},_isAnyCellInRangeLocked:function(e){for(var t,n=this._getActualRange(e),r=n.row,o=n.col,i=r+n.rowCount,a=o+n.colCount,s=r;s<i;s++)for(var l=o;l<a;l++){var u=this.getSpan(s,l),c=u?u.row:s,f=u?u.col:l;if(t=this.getActualStyle(c,f),!0===t.locked)return!0}return!1},_isValidRange:function(e,t,n,r,o,i){if(-1<=e&&e<o&&-1<=t&&t<i){if(-1===e&&-1===t)return!0;if(-1===e){if(0!==r&&t+r<=i)return!0}else if(-1===t){if(0!==n&&e+n<=o)return!0}else if(0!==r&&t+r<=i&&0!==n&&e+n<=o)return!0}return!1},_hasPartSpans:function(e,t,n,r){var o=this;if(e<0&&t<0)return!1;if(e<0){var i=o._getSpanModel(1);if(i&&i.length>0)return i.hasPartSpans(-1,t,-1,r)}if(t<0){var a=o._getSpanModel(2);if(a&&a.length>0)return a.hasPartSpans(e,-1,n,-1)}var s=o._getSpanModel();return!!(s&&s.length>0)&&s.hasPartSpans(e,t,n,r)},suspendPaint:function(){this._layoutSuspended++},resumePaint:function(){var e=this;if(--e._layoutSuspended<=0){e._layoutSuspended=0;var t=e.parent;t&&t.getActiveSheet()!==e||e._invalidate()}},isPaintSuspended:function(){return this._layoutSuspended>0},_cellRangeInflate:function(e,t){for(var n=this,r=e&&e.length,o=0;o<r;o++){var i=e[o];if(t.intersect(i.row,i.col,i.rowCount,i.colCount))return e.splice(o--,1),n._cellRangeInflate(e,t.union(i))}return t},_getClipboardHelper:function(){var e=this,t=e.parent;return e._clipboardHelper||(e._clipboardHelper=t&&t._clipboardHelper),e._clipboardHelper},_getImageLoader:function(){if(!this._imageLoader){var e=this;e._imageLoader=new v(function(){e._imageLoader&&e.repaint()})}return this._imageLoader},_commandManager:function(){var e=this,t=e.parent;if(t)return t.commandManager()},_raiseInvalidOperation:function(e,t){this._trigger(O.InvalidOperation,{sheet:this,sheetName:this._name,invalidType:e,message:t})},_raiseCellChanged:function(e,t,n,r,o,i){var a={sheet:this,sheetName:this._name,row:t,col:n,sheetArea:r,propertyName:e,newValue:i};o&&(a.oldValue=o),this._trigger(O.CellChanged,a)},_raiseValueChanged:function(e,t,n,r){this._trigger(O.ValueChanged,{sheet:this,sheetName:this._name,row:e,col:t,oldValue:n,newValue:r})},_raiseColumnChanged:function(e,t,n,r,o){var i={sheet:this,sheetName:this._name,col:e,sheetArea:t,propertyName:n};r&&(i.newValue=r,"addColumns"!==n&&"deleteColumns"!==n||(i.count=r)),o&&(i.oldValue=o),this._trigger(O.ColumnChanged,i)},_raiseRowChanged:function(e,t,n,r,o){var i={sheet:this,sheetName:this._name,row:e,sheetArea:t,propertyName:n};r&&(i.newValue=r,"addRows"!==n&&"deleteRows"!==n||(i.count=r)),o&&(i.oldValue=o),this._trigger(O.RowChanged,i)},_raiseSelectionChanging:function(e,t){return!!this._eventHandler._notEqualSelecions(e,t)&&(this._trigger(O.SelectionChanging,{sheet:this,sheetName:this._name,oldSelections:e,newSelections:t}),!0)},_raiseSelectionChanged:function(e){this._trigger(O.SelectionChanged,{sheet:this,sheetName:this._name,oldSelections:e,newSelections:this.getSelections()})},_raiseRangeDataChanged:function(e,t,n,r,o,i,a,s){var l={sheet:this,sheetName:this._name,row:e,col:t,rowCount:n,colCount:r,changedCells:o,action:i};a&&(l.sheetArea=a),s&&(l.value=s),o&&o.length>0&&(this._trigger(O.RangeChanged,l),this._trigger(O.FormulatextboxRangeChanged,l))},_raiseEditorStatusChanged:function(e,t){var n={sheet:this,sheetName:this._name,oldStatus:e,newStatus:t};this._trigger(O.EditorStatusChanged,n)},_getElem:function(){return this._$elem||(this._$elem=w(M("input"))),this._$elem},bind:function(e,t,n){this._getElem().bind(e+ce,t,n)},unbind:function(e,t){this._getElem().unbind(e+ce,t)},_trigger:function(e,t){this.updateEventsData&&this.updateEventsData(e,t),0===this._eventSuspended&&this._getElem().trigger(e,t)},unbindAll:function(){this.unbind(ce)},_bind:function(e,t,n){e.indexOf(".")>=0?this.bind(e,t,n):this.bind(e+fe,t,n)},_unbind:function(e,t){e.indexOf(".")>=0?this.unbind(e,t):this.unbind(e+fe,t)},_unbindAll:function(){this.unbind(fe)},_getBounds:function(){var e=this._bounds;return new I(e.x,e.y,e.width,e.height)},_setBounds:function(e){this._bounds=new I(e.x,e.y,e.width,e.height)}},t.Worksheet=g,e.exports=t},function(e,t){var n={FONT_FAMILY:'-apple-system, BlinkMacSystemFont, PingFang SC, Helvetica, Tahoma, Arial, "Hiragino Sans GB", "Microsoft YaHei", SimSun, Heiti, sans-serif',FONT_SIZE:"9pt",BLUE_COLOR:"#71a1e6",BTN_CLASS:"btn btn-default",BTNOK_CLASS:"btn-ok",SELECTION_RECT_COLOR:"#73a2e3",SHOW_PASTE_COPY:!1};e.exports=n},function(e,t,n){function r(){}var t=n(2),o=n(4).GC$,i=n(3)._util,a=n(7),s=document,l=Math.floor,u=Math.max,c=void 0,f=t._DefaultFontSize=a.FONT_SIZE;r._composeFont=function(e,t){return t?r._normalizeFont(e,t):e},r._splitFont=function(e){if(!e)return{};var t=r._getMeasureSpan();t.style.font=e;var n=t.style;return{fontFamily:n.fontFamily,fontSize:n.fontSize,fontStyle:n.fontStyle,fontWeight:n.fontWeight}},r._buildFontString=function(e){if(i._browser.safari)return e.font;var t="",n="normal",r=e.fontStyle,o=e.fontVariant,s=e.fontWeight,l=e.lineHeight;return r!==n&&(t=r),o!==n&&(t+=(t?" ":"")+o),s!==n&&"400"!==s&&(t+=(t?" ":"")+s),t+=(t?" ":"")+e.fontSize,l!==n&&(t+="/"+l),t+=" "+a.FONT_FAMILY},r._normalizeFont=function(e,t){if(!e&&!t)return e;var n,i,a;if(e){if(i=t?e+"+"+t:e,a=r._fontStringCache[i])return a;n=r._getMeasureSpan(),o(n).css("font",e)}else{if(i=t,a=r._fontStringCache[i])return a;n=r._getMeasureSpan(),o(n).css("fontSize",f),o(n).css("fontFamily",t)}var l=n.currentStyle,u=s.defaultView;return u&&u.getComputedStyle&&(l=u.getComputedStyle(n,"")),a=r._buildFontString(l),r._fontStringCache[i]=a,r._fontStringCache[a]=a,a},r._scaleFont=function(e,t,n,o){var i,a=r._scaleFontInfoCache[t];if(!o)if(a){if(i=a[e])return i}else a=r._scaleFontInfoCache[t]={};var c=r._getMeasureSpan();c.style.font=e;var f=c.currentStyle,d=s.defaultView;d&&d.getComputedStyle&&(f=d.getComputedStyle(c,""));var p=f.fontSize,h="px";if(-1!==p.indexOf(h)){var m=u(1,l(parseFloat(p.replace(h,""))*t));n&&1===m&&(n.value=!0),p=m+h}var g=f.lineHeight;if(-1!==g.indexOf(h)){g=u(1,l(parseFloat(g.replace(h,""))*t))+h}return 1===t?i={font:e,fontSize:m}:(c.style.fontSize=p,c.style.lineHeight=g,i={font:c.style.font,fontSize:m}),o||(a[e]=i),i},r._getMeasureSpan=function(){if(r._measureSpan)r._measureSpan.style.cssText=r._measureSpanOriginalStyleText;else{var e="-10000px",t=i._createElement("span"),n=t.style;n.visibility="hidden",n.top=e,n.left=e,n.lineHeight="normal",n.position="absolute",n.fontWeight="normal",n.fontStretch="normal",n.fontVariant="normal",n.fontStyle="normal",s.body.insertBefore(t,null),r._measureSpan=t,r._measureSpanOriginalStyleText=n.cssText}return r._measureSpan},r._dispose=function(){var e=r._measureSpan;e&&(o(e).remove(),r._measureSpan=c,r._measureSpanOriginalStyleText=c)};var d={};r._setStringFont=function(e,t){var n=e+","+t,o=d,i=o[n];if(!i){var a=r._getMeasureSpan();a.style.font=e,t&&(a.style.fontWeight=t),i=o[n]=a.style.font}return i},r._fontStringCache={},r._scaleFontInfoCache={},r._composeTextDecoration=function(e){if(e<=0)return"none";var t="";return(1|e)===e&&(t+="underline "),(2|e)===e&&(t+="line-through "),(4|e)===e&&(t+="overline "),t.trim()},t._StyleHelper=r,e.exports=t},function(e,t,n){function r(e,t,n){this.color=e||"black",this.style=t||0,this.level=n}function o(){var e=this;e._id=o._styleId++;var t,n=arguments;if(0!==n.length)for(t=0;t<S.length;t++)e[S[t]]=n[t]}function i(e,t,r,o){var i=t;if(r&&t){t.toJSON&&(t=t.toJSON());var a=n(12).CellTypes._typeDict,s=t.typeName,l=a[t.type]||a[s]||u.getTypeFromString(s);l&&(i=new l,i.fromJSON(t,o))}e.cellType=i}function a(e,t,r){var o=t;if(r&&"object"==typeof t){t.toJSON&&(t=t.toJSON());var i=n(10),a=i&&i.GeneralFormatter;if(a){var s=t.typeName;if(s){var l=u.getTypeFromString(s);l&&(o=new l,o.fromJSON(t))}else o=new a(t.formatCached,t.customerCultureName)}}e.formatter=o}function s(e,t,r){var o=t;if(r&&t){t.toJSON&&(t=t.toJSON());var i=n(10),a=i&&i.GeneralFormatter;a&&(o=new a(t.formatCached,t.customerCultureName),o.isAuto=!0)}e._autoFormatter=o}var t=n(2),l=n(4).GC$,u=n(3),c=n(8)._StyleHelper,f=l.each,d=u._util,p=d._isDefined,h=void 0,m=null,g="autoFormatter",_="validator",v="formatter",y="cellType",b="hAlign",w="vAlign",C="imeMode";t.HorizontalAlign={left:0,center:1,right:2,general:3},t.VerticalAlign={top:0,center:1,bottom:2},t.ImageLayout={stretch:0,center:1,zoom:2,none:3},t.LineStyle={empty:0,thin:1,medium:2,dashed:3,dotted:4,thick:5,double:6,hair:7,mediumDashed:8,dashDot:9,mediumDashDot:10,dashDotDot:11,mediumDashDotDot:12,slantedDashDot:13},t.TextDecorationType={underline:1,lineThrough:2,overline:4,none:0},t.LineBorderComposeLevel={conditionalFormat:1,cell:10,table:20,row:30,column:40,sheet:50},t.LabelAlignment={topLeft:0,topCenter:1,topRight:2,bottomLeft:3,bottomCenter:4,bottomRight:5},t.LabelVisibility={visible:0,hidden:1,auto:2},r.prototype={constructor:r,_clone:function(){return new r(this.color,this.style,this.level)},toJSON:function(){var e={},t=this,n=t.color,r=t.style;return"black"!==n&&(e.color=n),0!==r&&(e.style=r),l.isEmptyObject(e)?h:e},fromJSON:function(e){if(e){var t=this,n=e.color,r=e.style;p(n)&&(t.color=n),p(r)&&(t.style=r)}}},r._width=function(e){return{9:1,1:1,3:1,4:1,7:1,11:1,2:2,10:2,12:2,8:2,13:2,5:3,6:3}[e&&e.style]||0},t.LineBorder=r;var S=["backColor","foreColor",b,w,"font","themeFont",v,"borderLeft","borderTop","borderRight","borderBottom","locked","textIndent","wordWrap","shrinkToFit","backgroundImage",y,"backgroundImageLayout","tabStop","textDecoration",C,"name","parentName","watermark","cellPadding","labelOptions",_];o.prototype={constructor:o,_compose:function(e,t,n){var r,o,i,a,s=this,l=e.labelOptions;t?(s._autoFormatter=e._autoFormatter,s.backgroundImage=e.backgroundImage,s.backgroundImageLayout=e.backgroundImageLayout,s.backColor=e.backColor,s.foreColor=e.foreColor,s.hAlign=e.hAlign,s.vAlign=e.vAlign,s.font=e.font,s.themeFont=e.themeFont,s.formatter=e.formatter,r=e.borderLeft,s.borderLeft=r&&r._clone()||r,s.borderLeft&&n&&(s.borderLeft.level=n),o=e.borderTop,s.borderTop=o&&o._clone()||o,s.borderTop&&n&&(s.borderTop.level=n),i=e.borderRight,s.borderRight=i&&i._clone()||i,s.borderRight&&n&&(s.borderRight.level=n),a=e.borderBottom,s.borderBottom=a&&a._clone()||a,s.borderBottom&&n&&(s.borderBottom.level=n),s.locked=e.locked,s.textIndent=e.textIndent,s.wordWrap=e.wordWrap,s.shrinkToFit=e.shrinkToFit,s.validator=e.validator,s.cellType=e.cellType,s.name=e.name,s.parentName=e.parentName,s.tabStop=e.tabStop,s.textDecoration=e.textDecoration,s.imeMode=e.imeMode,s.watermark=e.watermark,s.cellPadding=e.cellPadding,s.labelOptions={alignment:l&&l.alignment,font:l&&l.font,foreColor:l&&l.foreColor,visibility:l&&l.visibility,margin:l&&l.margin}):(s.backgroundImage===h&&(s.backgroundImage=e.backgroundImage),s.backgroundImageLayout===h&&(s.backgroundImageLayout=e.backgroundImageLayout),s.backColor===h&&(s.backColor=e.backColor),s.foreColor===h&&(s.foreColor=e.foreColor),s.hAlign===h&&(s.hAlign=e.hAlign),s.vAlign===h&&(s.vAlign=e.vAlign),s.themeFont===h&&s.font===h?(s.themeFont=e.themeFont,s.font=e.font):s.themeFont!==h&&s.font===h&&(s.font=e.font),s.formatter===h&&(s.formatter=e.formatter),s.validator===h&&(s.validator=e.validator),s._autoFormatter===h&&(s._autoFormatter=e._autoFormatter),s.borderLeft===h&&(r=e.borderLeft,s.borderLeft=r&&r._clone()||r,s.borderLeft&&n&&(s.borderLeft.level=n)),s.borderTop===h&&(o=e.borderTop,s.borderTop=o&&o._clone()||o,s.borderTop&&n&&(s.borderTop.level=n)),s.borderRight===h&&(i=e.borderRight,s.borderRight=i&&i._clone()||i,s.borderRight&&n&&(s.borderRight.level=n)),s.borderBottom===h&&(a=e.borderBottom,s.borderBottom=a&&a._clone()||a,s.borderBottom&&n&&(s.borderBottom.level=n)),s.locked===h&&(s.locked=e.locked),s.textIndent===h&&(s.textIndent=e.textIndent),s.wordWrap===h&&(s.wordWrap=e.wordWrap),s.shrinkToFit===h&&(s.shrinkToFit=e.shrinkToFit),s.cellType===h&&(s.cellType=e.cellType),s.tabStop===h&&(s.tabStop=e.tabStop),s.textDecoration===h&&(s.textDecoration=e.textDecoration),s.imeMode===h&&(s.imeMode=e.imeMode),s.name===h&&(s.name=e.name),s.parentName===h&&(s.parentName=e.parentName),s.watermark===h&&(s.watermark=e.watermark),s.cellPadding===h&&(s.cellPadding=e.cellPadding),s.labelOptions||(s.labelOptions={}),s.labelOptions.alignment===h&&(s.labelOptions.alignment=l&&l.alignment),s.labelOptions.font===h&&(s.labelOptions.font=l&&l.font),s.labelOptions.foreColor===h&&(s.labelOptions.foreColor=l&&l.foreColor),s.labelOptions.visibility===h&&(s.labelOptions.visibility=l&&l.visibility),s.labelOptions.margin===h&&(s.labelOptions.margin=l&&l.margin))},_clear:function(e){var t=this;0===arguments.length?f(S,function(e,n){t[n]=h}):("dataValidator"===e&&(e=_),t[e]=h)},clone:function(e){var t=this,n=t.borderLeft,r=t.borderTop,l=t.borderRight,u=t.borderBottom,c=new o(t.backColor,t.foreColor,t.hAlign,t.vAlign,t.font,t.themeFont,h,n&&!e&&n._clone()||n,r&&!e&&r._clone()||r,l&&!e&&l._clone()||l,u&&!e&&u._clone()||u,t.locked,t.textIndent,t.wordWrap,t.shrinkToFit,t.backgroundImage,h,t.backgroundImageLayout,t.tabStop,t.textDecoration,t.imeMode,t.name,t.parentName,t.watermark,t.cellPadding,t.labelOptions);a(c,t.formatter,!e),s(c,t._autoFormatter,!e);var f=t.validator;return!e&&f&&f.clone&&(f=f.clone()),c.validator=f,i(c,t.cellType,!e,!0),c},_normalize:function(e){function t(e,t,n){t&&(t=e.getColor(t))&&n(t)}var n=this;if(e&&e.getColor){t(e,n.foreColor,function(e){n.foreColor=e}),t(e,n.backColor,function(e){n.backColor=e});for(var r=[n.borderLeft,n.borderTop,n.borderRight,n.borderBottom],o=0,i=r.length;o<i;o++){var a=r[o];a&&a.color&&t(e,a.color,function(e){a.color=e})}}var s=n.themeFont,l=n.font;return e&&e.getFont&&(s?n.font=c._composeFont(l,e.getFont(s)):l||(n.font=c._composeFont(l,e.bodyFont()))),n},_setActualAutoFormatter:function(e){var t=this,n=t._autoFormatter;if(n&&e!==m){var r=n.getPreferredEditingFormatter(e);r.isAuto=!0,t._autoFormatter=r}},toJSON:function(e,t){function n(e,t,n){return e===b?2===n?1===t:1===n?1===t:3===t:e===w?2===n?1===t:1===n?1===t:0===t:e===C?1===t:e===g?t===h:void 0}var r,o,i=this,a={},s=i._autoFormatter;for(!p(s)||t&&n(g,s,e)||(a[g]=s.toJSON?s.toJSON():s),r=0;r<S.length;r++)o=S[r],s=i[o],!p(s)||t&&n(o,s,e)||(a[o]=s&&s.toJSON?s.toJSON():s);return l.isEmptyObject(a)?h:a},fromJSON:function(e,t){if(e){var n,l,u=this;for(n in e){if(l=e[n],!p(l))return;var c={p:n,v:l,r:!1};if(o._callFeatureHandler(u,"fromJson",c),!c.r)if("formatter"===n)a(u,l,!0);else if("autoFormatter"===n)s(u,l,!0);else if(n===y)i(u,l,!0,t);else if(n.indexOf("border")>=0){var f=new r;f.fromJSON(l,t),u[n]=f}else u[n]=l}}}},u._defineFeature(o),o._styleId=0,t.Style=o,e.exports=t},function(e,t,n){function r(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}var t={};r(t,n(82)),t.SR={},t.SR.en=n(41),e.exports=t},function(e,t,n){function r(e,t,n,r){if(e&&0<=n&&n<t){var o,i,a=[];for(i=n;i<t;i++)void 0!==e[i]&&a.push(i);for(o=a.length,i=0;i<o;i++){var s=a[o-i-1],l=e[s];e[s]=null,e[Math.floor(s)+r]=l}}}function o(e,t,n,r){if(e&&0<=n&&n<t){var o,i,a=[],s=n+r;for(i=n;i<t;i++)void 0!==e[i]&&(n<=i&&i<s?e[i]=null:i>=s&&a.push(i));for(o=a.length,i=0;i<o;i++){var l=a[i],u=e[l];e[l]=null,e[Math.floor(l)-r]=u}}}function i(e,t){return e.hasOwnProperty(t)}function a(e,t){return e instanceof t}var s={},l=n(20).CultureManager,u=function(e){return function(){var t=l.culture();if(e&&t){var n=t.substr(0,2).toLowerCase();return e.hasOwnProperty(n)?e[n]:e.en}return{}}};s._addElements=r,s._deleteElements=o,s._getResource=u,s._hasOwnProperty=i,s._isInstanceOf=a,e.exports=s},function(e,t,n){function r(e,t,n,r){var o=e.conditionalFormats;if(o)return o._hasIconSet(t,n,r)}function o(e,t,n,r,o,i,a,s,l,u){(i||a||u)&&(e.save(),e.beginPath(),i&&(e.fillStyle!==i&&(e.fillStyle=i),e.fillRect(t,n,r,o)),e.save(),e.translate(t,n),e.fillStyle=u,e.fillRect(0,1,r-1,o-1),e.restore(),W._paintBackgroundImage(e,t,n,r,o,a,s,l),e.restore())}function i(e,t,r,o,i,a,s){var l=n(30),u=l&&l.SparklineExValue;if(u&&t instanceof u){var c=s&&s.parent;if(c){var f=c.getSparklineEx(t.name);if(f)return f.paint(e,t.value,r,o,i,a,{zoomFactor:s._zoomFactor,sheet:s}),!0}}return!1}function a(e,t,n,o,i,a){0===e&&r(t,n,o,i)&&(a.x+=N,a.width-=N)}function s(e,t,n,r){var o=e.cellPadding,i=0,a=e.labelOptions;return n&&(o=a?a.margin:"0"),o&&(i=parseInt(u(o)[t]),i=typeof i===L&&i>0?i:0),r===V?i:i*r}function l(e,t,n,r){var o=r&&r.sheet;if(o&&n){var i=r.canvasOffset||o._eventHandler._getCanvasPosition(),a=o._getBounds();v(e).css("top",i.top+a.y+n.y-2).css("left",i.left+a.x+n.x-2).css("background-color",t.backColor||"white").width(n.width).height(n.height)}}function u(e){var t=[0,0,0,0];if(typeof e===F){var n,r,o=e.split(" ",4),i=o.length;1===i?(n=o[0],t=[n,n,n,n]):2===i?(n=o[0],r=o[1],t=[n,r,n,r]):3===i?(r=o[1],t=[o[0],r,o[2],r]):4===i&&(t=[o[0],o[1],o[2],o[3]])}return t}function c(e,t){var n=s(e,0),r=s(e,2),o=s(e,0,!0),i=s(e,2,!0);if(s(e,3,!0)+s(e,1,!0)>=t.width)return!1;var a=e.labelOptions.alignment;if(a===V&&(a=e.labelOptions.alignment=0),0===a||1===a||2===a){if(n>0&&o+i<n)return!0}else if((3===a||4===a||5===a)&&n<t.height&&r>0&&o+i<r)return!0;return!1}function f(e,t){var n=s(t,0),r=s(t,3,!0),o=s(t,2,!0),i=e.clone(),a=t.labelOptions.alignment;return 0===a||1===a||2===a?n<e.height&&(i.height=n-o+1):3!==a&&4!==a&&5!==a||(i.height=e.height-o),i.x+=r,i.width-=r+s(t,1,!0),i}function d(e){var t="left";return 1===e||4===e?t="center":2!==e&&5!==e||(t="right"),t}function p(e,t,n,r){var o=new y.Point(e.x,e.y),i=n.fontSize,a=s(t,0),l=s(t,2),u=s(t,3,!0),c=s(t,1,!0),f=e.width,d=e.height,p=i>8?Math.floor((i-8)/5+2):1,h=r/2-i/2+p-1,m=i>8?1:2,g=r-h+s(t,0,!0),_=g+1,v=a+l>d?a+g:d-l+g-1;switch(t.labelOptions.alignment){case 0:o.x+=u+m+1,o.y+=_;break;case 1:o.x+=u+(f-u-c)/2,o.y+=_;break;case 2:o.x+=f-c-2,o.y+=_;break;case 3:o.x+=u+m+1,o.y+=v;break;case 4:o.x+=u+(f-u-c)/2,o.y+=v;break;case 5:o.x+=f-c-2,o.y+=v}return o}function h(e,t){var n=s(t,3,!0),r=s(t,1,!0),o=s(t,0,!0),i=s(t,2,!0),a=e.clone(),l=t.labelOptions.alignment;return a.x=n+1,a.width-=n+r,0===l||1===l||2===l?(a.y=o,a.height=s(t,0)-o-i):3!==l&&4!==l&&5!==l||(a.y=e.height-s(t,2)+o,a.height=s(t,2)-o-i),2!==l&&5!==l||(a.width-=2),a}function m(e,t){if(e.cellPadding){var n,r=u(e.cellPadding);for(n=0;n<4;n++)r[n]=parseInt(r[n]),"number"==typeof r[n]&&r[n]>0&&(r[n]*=t);e.cellPadding=r.join(" ")}}function g(){this.allowOverflow=!1,this.typeName="0"}var _=n(0),v=n(4).GC$,y=n(3),b=n(8)._StyleHelper,t=n(2),w=t.CellTypes={},C=_.CultureManager,S=_._NumberHelper,x=_._DateTimeHelper,T=_._ColorHelper,E=y._CacheMgr,M=_._Types._isNullOrUndefined,A=y._WordWrapHelper,k=y.Rect,R=y._ThemeStyleHelper,I=y._util,O=I._getHAlignByValueType,D="right",P="center",N=16,F="string",L="number",H=null,V=void 0,j=Math.floor,B=Math.ceil,U="none",W=w.Context={};W._paintBackgroundImage=function(e,t,n,r,o,i,a,s){if(i&&"none"!==i&&s)try{if(s._getState(i)){var l=s._getImage(i),u=l.width,c=l.height,f=u,d=c,p=r,h=o,m=t,g=n;1===a?(f=r>=u?u:r,d=o>=c?c:o,m=r>u&&u>0?B(t+r/2-u/2):t,g=o>c&&c>0?B(n+o/2-c/2):n,p=f,h=d):2===a?o>0&&c>0&&r/o>u/c?(p=u/c*o,m=t+r/2-p/2):r>0&&u>0&&o/r>c/u&&(h=c/u*r,g=n+o/2-h/2):3===a&&(f=r>=u?u:r,d=o>=c?c:o,p=f,h=d),e.drawImage(l,0,0,f,d,m,g,p,h)}else s._addImage(i)}catch(e){}},W._getAutoFitWidth=function(e,t,n,o,i){var a=0,s=i&&i.sheet,l=n.textIndent,u=n.font,c=n.hAlign;if(s&&typeof t===F&&t){if(n.wordWrap)for(var f=t.split(/\r\n|\r|\n/),d=0;d<f.length;d++)a=Math.max(a,A._measureText(f[d],u,!0)/o);else a=s._getStringWidthByCanvas(t,u)/o;1!==c&&l>0&&(a+=8*l/o),0===c&&r(s,i.row,i.col,i.sheetArea)&&(a+=N)}return a},W._getAutoFitHeight=function(e,t,n,r,o){var i=0,a=o&&o.sheet,s=n.font;if(a&&typeof t===F&&t){var l=a._getFontHeight(s)/r;if(n.wordWrap){var u=o.row,c=o.col,f=o.sheetArea,d=0,p=a._getSpanModel(f).find(u,c);if(p){if(p.row>=u&&p.rowCount<=1&&p.col>=c&&c===p.col&&(d=a._getZoomColumnWidth(c),p.colCount>1))for(var h=c+1;h<c+p.colCount;h++)d+=a._getZoomColumnWidth(h)}else d=a._getZoomColumnWidth(c);var m=0,g=n.textIndent;g>0&&(m=8*g);i=A._getWrapInfo(t,d-3-m,s).length*l}else i=l}return i},W._paintHeaderCellGridline=function(e,t,n,r,o,i,a,s,l){var u;1===l?(e.beginPath(),u=e.createLinearGradient(t,n+1,t,n+o-2),u.addColorStop(0,s.borderLeftColor),u.addColorStop(1,s.borderRightColor),e.strokeStyle=u,i.borderLeft||(e.moveTo(t+.5,n),e.lineTo(t+.5,n+o)),i.borderRight||(e.moveTo(t+r-.5,n),e.lineTo(t+r-.5,n+o)),e.stroke(),s.borderBottomWidth&&!i.borderBottom&&(e.beginPath(),e.strokeStyle=s.borderBottomColor,e.moveTo(t+1,n+o-.5),e.lineTo(t+r,n+o-.5),e.stroke())):(e.beginPath(),u=e.createLinearGradient(t,n,t+r-2,n),u.addColorStop(0,s.borderTopColor),u.addColorStop(1,s.borderBottomColor),e.strokeStyle=u,i.borderTop||(e.moveTo(t,n+.5),e.lineTo(t+r,n+.5)),i.borderBottom||(e.moveTo(t,n+o-.5),e.lineTo(t+r,n+o-.5)),e.stroke(),s.borderRightWidth&&!i.borderRight&&(e.beginPath(),e.strokeStyle=s.borderRightColor,e.moveTo(t+r-.5,n+1),e.lineTo(t+r-.5,n+o),e.stroke()))},W._setImeMode=function(e,t){var n;n=2===t?"active":4===t?"inactive":0===t?"disabled":"auto",v(e).css("ime-mode",n)},W._getPositionOffset=s,g.prototype={constructor:g,_paintLabel:function(e,t,n,r){var o=r.sheet,i=n.watermark,a=n.labelOptions,s=a.visibility;if(i){var l=o.getText(r.row,r.col,r.sheetArea);if(1===s||(2===s||s===V)&&""===l)return;1!==o._zoomFactor&&m(n,o._zoomFactor);var u,h=a.font;u=h?b._scaleFont(h,o._zoomFactor):b._scaleFont(n.font,1);var g,_=o._getFontHeight(u.font),v=f(t,n);c(n,t)&&(g=p(t,n,u,_)),g&&(e.save(),e.textAlign=d(a.alignment),e.textBaseline="Alphabetic",e.font=u.font,e.fillStyle=a.foreColor||n.foreColor||"grey",e.rect(v.x,v.y,v.width,v.height),e.clip(),e.beginPath(),e.fillText(i,g.x,g.y),e.restore())}},_getContentRect:function(e,t){var n=e.clone(),r=s(t,0),o=s(t,1),i=s(t,2),a=s(t,3);return r>0&&(n.y+=r,n.height-=r),i>0&&(n.height-=i),a>0&&(n.x+=a,n.width-=a),o>0&&(n.width-=o),o+a>=e.width&&(n.width=0),r+i>=e.height&&(n.height=0),n},_createLabelElement:function(e,t,n,r){var o=r.sheet,i=o.getText(r.row,r.col,r.sheetArea),a=n.watermark,s=n.labelOptions,l=s.visibility;if(1!==l&&a){var u=s.font||n.font||o._render._getDefaultFont();1!==o._zoomFactor&&(u=o._render._getZoomFont(u),m(n,o._zoomFactor));var f,p=o._getFontHeight(u);if(c(n,t)&&(f=h(t,n,p)),f){var g=v(I._createElement("span"));g.text(a);var _=2===l&&""===i,y=f.height-p,b=f.y+(_&&y>0?y:0);if(g.css({display:"block",position:"absolute",left:f.x,top:b,width:f.width,height:f.height,font:u,color:s.foreColor||n.foreColor||"grey",textAlign:d(s.alignment),overflow:"hidden",whiteSpace:"nowrap"}).attr("gcUIElement","gcEditorLabel"),v(e).append(g),_)var w=setInterval(function(){b--,g.css("top",b),b<=f.y&&clearInterval(w)},20)}}},_createCellTypeElement:function(e){var t,n=this;n._cellWrapperElement=t=I._createElement("div"),v(t).css({position:"absolute",margin:0,padding:0,overflow:"hidden","box-sizing":"content-box",resize:U,outline:U,border:"2px #5292f7 solid","box-shadow":"1px 2px 5px rgba(0,0,0,0.4)","background-color":"white"}),n._contentContainer=I._createElement("div");var r=v(n._contentContainer);r.css({position:"absolute",outline:U,border:U}),v(t).append(r);var o=n.createEditorElement(e);return o&&v(n._contentContainer).append(v(o)),n._cellWrapperElement},_activateEditorWrapper:function(e,t,n,r){if(e&&e.firstChild){var o=this;n.width-=1,n.height-=1,l(e,t,n,r),o._createLabelElement&&o._createLabelElement(e,n,t,r);var i=o._getContentRect?o._getContentRect(n,t):n;o.activateEditor(e.firstChild.firstChild,t,i,r)}},updateEditorContainer:function(e,t,n){if(e&&t){var r=e.parentNode;if(r){var o=r.parentNode,i=v(o),a=t.width,l=t.height;if(a>0){i.width(a);var u=o.lastChild;"gcEditorLabel"===u.getAttribute("gcUIElement")&&v(u).width(a-s(n,3,!0)-s(n,1,!0)-2)}l>0&&i.height(l)}}},_updateEditorWrapper:function(e,t,n,r,o){var i=this,a=e.firstChild,u=r.sheet;l(e,t,n,r),o&&u&&m(t,u._zoomFactor),v(a).css({left:s(t,3),top:s(t,0)});var c=a.firstChild,f=i._getContentRect?i._getContentRect(n,t):n,d=i.updateEditor(c,t,f,r);i.updateEditorContainer(c,d,t)},_getHitInfoWrapper:function(e,t,n,r,o){var i=this,a=i._getContentRect?i._getContentRect(r,n):r;return i.getHitInfo(e,t,n,a,o)},_getAutoFitContainerWidth:function(e,t,n,r,o){return s(n,3,!1,r)+s(n,1,!1,r)+this.getAutoFitWidth(e,t,n,r,o)},_getAutoFitContainerHeight:function(e,t,n,r,o){return s(n,0,!1,r)+s(n,2,!1,r)+this.getAutoFitHeight(e,t,n,r,o)},paintValue:function(e,t,n,r,o,i,a,s){var l,u={};(l=this.format(t,a.formatter||a._autoFormatter,u))&&this.paintText(e,t,n,r,o,i,a,s,l,u)},paintText:function(e,t,n,r,o,i,a,s,l,u,c){e.save(),e.beginPath();var f=a.foreColor,d=a.font,p=u.value;if(p&&(f=p),!M(c)){var h=T._fromString(f);h.a=c,f=T._toString(h)}f&&e.fillStyle!==f&&(e.fillStyle=f),d&&e.font!==d&&(e.font=d);var m=0,g=a.textIndent,_=a.wordWrap,v=a.hAlign,y=a.vAlign,b=a.textDecoration,w="left",C="alphabetic",S=2,x=2,E=0,k=s.lineHeight,R=[],I=0,N=s.fontInfo.fontSize;if(g>0&&(m=8*g),3===v&&(v=O(v,t,a.formatter)),S+=m,1===v?(S=o/2,w=P):2===v&&(S=o-1-2,S-=m,w=D),e.textAlign!==w&&(e.textAlign=w),_){var F=o-3-m;F-=1,R=A._getWrapInfo(l,F,d),I=R.length,I>1&&0!==y&&(E=(I-1)*k)}var L=N>8?j((N-8)/5+2):1,H=k/2-N/2+L-1;x+=k-H,1===y?x=(i-E)/2+k/2-H:2===y&&(x=i-E-2-H),e.textBaseline!==C&&(e.textBaseline=C);var V=s.cellOverflowLayout,B=V&&V.layout,U={x:B?B.x:n+1,y:B?B.y:r+1,width:B?B.width:o-2,height:B?B.height:i-2},W=U.x,z=U.y,Y=U.width,G=U.height;if(_){e.rect(W,z,Y,G),e.clip(),e.beginPath();for(var K=r+x,X=0;X<I;X++){if(e.fillText(R[X],n+S,K),b){var q=e.measureText(R[X]).width;this._renderTextDecoration(e,b,n+S,K,q,N,L)}K+=k}}else{var J=e.measureText(l).width,Z=J>Y||k>G;if(!Z)if(1===v){if(V){var Q=J/2;(Q>V.backgroundLeftWidth||Q>V.backgroundRightWidth)&&(Z=!0)}}else J+m>Y&&(Z=!0);Z&&(e.rect(W,z,Y,G),e.clip(),e.beginPath()),e.fillText(l,n+S,r+x),b&&this._renderTextDecoration(e,b,n+S,r+x,J,N,L)}e.restore()},paint:function(e,t,n,r,i,a,s,l){if(e){var u=s.backColor;l.parentBackColor!==u&&o(e,n,r,i,a,u,s.backgroundImage,s.backgroundImageLayout,l.imageLoader,l.lockCellBgPattern);var c=this,f=new k(n,r,i,a);c._paintLabel&&(c._paintLabel(e,f,s,l),f=c._getContentRect(f,s)),f.width>0&&f.height>0&&c.paintContent(e,t,f.x,f.y,f.width,f.height,s,l)}},paintContent:function(e,t,n,r,o,s,l,u){var c=u.sheetArea;if(2===c||1===c){var f=u.visualState||0,d="columnHeader";2===c&&(d="rowHeader");var p=this.getThemeStyle(u.visualState,"gc-"+d+"-"+R._getString(f));W._paintHeaderCellGridline(e,n,r,o,s,l,d,p,c)}var h,m=u.conditionalFormats;m&&(h=m._paint(e,t,n,r,o,s,l,u)),u.showBarIconOnly=h;var g=u.sparkline;g&&g.paintSparkline(e,n,r,o,s);var _=i(e,t,n,r,o,s,u.sheet);if(!u.cellOverflowLayout&&!h&&!_){var v=new k(n,r,o,s);a(l.hAlign,u.sheet,u.row,u.col,u.sheetArea,v),this.paintValue(e,t,v.x,v.y,v.width,v.height,l,u)}},createEditorElement:function(e){return H},getEditorValue:function(e,t){return H},_formatEditorValue:function(e,t,n,r){return n},setEditorValue:function(e,t,n){},getEditingElement:function(){return H},parse:function(e,t,r){var o=M(t),i=M(e);try{var a=n(10),s=a&&a.GeneralFormatter;if(!o&&!i&&s){return(typeof t===F?new s(t):t).parse(e)}}catch(e){}return i?"":e.toString()},format:function(e,t,r,o){if(M(e)||""===e)return"";if(typeof t===F&&"object"!=typeof e)return E._getFormattedText(e,t,r);if(!t){if("boolean"==typeof e||e instanceof Boolean)return e.toString().toUpperCase();if(e instanceof Date){var i=C._getCultureInfo(C.culture()).DateTimeFormat;return x._localeFormat(e,i.shortDatePattern+" H:mm:ss")}return typeof e===L&&(e=S._replaceNormalToCultureSymbol(e.toString())),e.toString()}try{var a=n(10);if(a&&a.GeneralFormatter){var s=H;s=typeof t===F?E._getFormatter(t):t;return s.format(e,r)}return e.toString()}catch(t){return e.toString()}},focus:function(e,t){e&&e.focus&&e.focus()},getThemeStyle:function(e,t){return R._getVisualStateThemeStyle(e,t)},activateEditor:function(e,t,n,r){},deactivateEditor:function(e,t){},selectAll:function(e,t){e&&e.select&&e.select()},updateEditor:function(e,t,n,r){},setImeMode:function(e,t,n){this.isImeAware(n)?this.updateImeMode(e,t,n):e&&W._setImeMode(e,0)},updateImeMode:function(e,t,n){e&&W._setImeMode(e,t)},getHitInfo:function(e,t,n,r,o){return H},processMouseDown:function(e){return!1},processMouseMove:function(e){return!1},processMouseUp:function(e){return!1},processMouseEnter:function(e){},processMouseLeave:function(e){},isReservedKey:function(e,t){return!1},isEditingValueChanged:function(e,t,n){return e!==t},processKeyDown:function(e,t){return!1},processKeyUp:function(e,t){return!1},getAutoFitWidth:function(e,t,n,r,o){return W._getAutoFitWidth(e,t,n,r,o)},getAutoFitHeight:function(e,t,n,r,o){return W._getAutoFitHeight(e,t,n,r,o)},_renderTextDecoration:function(e,t,n,r,o,i,a){e.strokeStyle=e.fillStyle;var s,l=e.textAlign,u=0,c=0,f=.5;s=i<=12?12:i,c=j((s-12)/21+1),e.lineWidth=c,0==(1&c)&&(f=0),l===P?n-=o/2:l===D&&(n-=o),e.beginPath(),4==(4&t)&&(u=B(r+a-i-1)-f,e.moveTo(n,u),e.lineTo(n+o,u)),2==(2&t)&&(u=B(r+a-i/2)-f,e.moveTo(n,u),e.lineTo(n+o,u)),1==(1&t)&&(u=B(r+a-1)-f,e.moveTo(n,u),e.lineTo(n+o,u)),e.stroke()},_setTextDecoration:function(e,t){var n="";4==(4&t)&&(n="overline"),2==(2&t)&&(n+=" line-through"),1==(1&t)&&(n+=" underline"),e.css("text-decoration",n)},isImeAware:function(e){return!1},isEditting:function(){return!1},toJSON:function(){var e={},t=this;for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},fromJSON:function(e){if(e)for(var t in e)M(e[t])||(this[t]=e[t])}},w.Base=g,w._typeDict={0:g},e.exports=t},function(e,t,n){function r(e,t){return e.hasOwnProperty(t)}function o(e){return e.rowCount}function i(e){return e.colCount}function a(e,t,n,r,o,i,a,s){var l=this;l.column=e,l.startColumn=t,l.endColumn=n,l.valueWidth=r,l.columnWidth=o,l.backgroundWidth=i,l.backgroundLeftWidth=a,l.backgroundRightWidth=s}function s(e,t,n,r,o,i,a,s){var l=this;l.rowCount=a,l.colCount=s,l.row=e,l.col=t,l.x=n,l.y=r,l.width=o,l.height=i}function l(e,t,n){var r=this;r.rowCount=e,r.colCount=t,r.name=n,r.dataTable={},r._rowDataArray=[],r._columnDataArray=[],r._defaultDataNode=f,r._dirtyNodes={},r._dirtySuspended=0,r._lastNonNullColumn=-1,r._lastNonNullRow=-1}function u(e,t){var n=e._infos,r=n[t];return r||(n[t]=r={},e.length=n.length),r}function c(e){this._infos=[],this.type=e}var f=null,d=void 0,p="string",h=Math.min,m=Math.floor,g=Math.max,t=n(2),_=n(9).Style,v=n(0),y=n(3),b=n(8)._StyleHelper,w=n(4).GC$,C=w.each,S=w.isEmptyObject,x=w.inherit,T=w.extend,E=v._addElements,M=v._deleteElements,A=v._Types._isNullOrUndefined,k=y._createRange,R=function(){return v._getResource(t.SR)()};t.StorageType={data:1,style:2,comment:4,tag:8,sparkline:16,axis:32,bindingPath:64};var I=function(e){function t(){e.call(this),this._lastNonNullColumn=-1,this._lastNonNullRow=-1}function n(e,t){e._lastNonNullRow=g(e._lastNonNullRow,t.row+o(t)-1),e._lastNonNullColumn=g(e._lastNonNullColumn,t.col+i(t)-1)}x(t,e);var r={find:function(e,t){for(var n=0,r=this.length;n<r;n++){var o=this[n];if(o&&o.contains(e,t))return o}return f},get:function(e,t){return this.find(e,t)||k(e,t,1,1)},remove:function(e){for(var t=0,n=this.length;t<n;t++)if(this[t]===e)return void this.splice(t,1)},addSpan:function(e){n(this,e),this.push(e)},removeSpan:function(e,t){this.splice(e,t)},copy:function(e,t,n,r,a,s){var l,u,c,f,d=this,p=d.length,h=[];for(f=0;f<p;f++)l=d[f],c=l.col,u=l.row,(-1===e||e<=u&&u<e+a)&&(-1===t||t<=c&&c<t+s)?h.push(k(-1===e?u:n+u-e,-1===t?c:r+c-t,o(l),i(l))):(-1===e||n<=u&&u<n+a)&&(-1===t||r<=c&&c<r+s)&&(d.splice(f,1),f--,p--);for(f=0;f<h.length;f++){if(l=h[f],!d.isValid(d,0,d.length,l))throw new Error(R().Exp_OverlappingSpans);d.addSpan(l)}},isValid:function(e,t,n,r){for(var a=t;a<n&&a<e.length;a++)if(e[a].intersect(r.row,r.col,o(r),i(r)))return!1;return!0},each:function(e,t,n,r,o){for(var i=this,a=0,s=i.length;a<s;a++){if(e>=0||t>=0)for(;a<s&&!i[a].intersect(e,t,n,r);)a++;if(a<s&&o){if(!1===o(i[a]))break}}},getSpans:function(e){if(!e)return this.slice(0);for(var t=[],n=0;n<this.length;n++){var r=this[n];r.intersect(e.row,e.col,o(e),i(e))&&t.push(r)}return t},hasPartSpans:function(e,t,n,r){for(var a=0;a<this.length;a++){var s=this[a];if(s.intersect(e,t,n,r)&&(-1!==e&&(s.row<e||s.row+o(s)>e+n)||-1!==t&&(s.col<t||s.col+i(s)>t+r)))return!0}return!1},hasSpans:function(e,t,n,r){var o=!1;return this.each(e,t,n,r,function(){return o=!0,!1}),o},clear:function(e,t,n,r){for(var o=0;o<this.length;o++){var i=this[o],a=i.row,s=i.col;(-1===e||e<=a&&a<e+n)&&(-1===t||t<=s&&s<t+r)&&this.splice(o--,1)}},move:function(e,n,r,a,s,l){var u,c,f,d,p,h=this,m=!1,g=new t,_=[],v=h.length;for(d=0;d<v;d++)u=h[d],c=u.row,f=u.col,(-1===e||e<=c&&c<e+s)&&(-1===n||n<=f&&f<n+l)?(p=k(-1===e?c:r+c-e,-1===n?f:a+f-n,o(u),i(u)),_.push(p),m=!0):(-1===e||r<=c&&c<r+s)&&(-1===n||a<=f&&f<a+l)?m=!0:g.push(u);if(m){if(_.length>0)for(d=0;d<_.length;d++){if(p=_[d],!h.isValid(g,0,g.length,p))throw new Error(R().Exp_OverlappingSpans);g.push(p)}for(h.length=0,d=0;d<g.length;d++)h.addSpan(g[d])}},isEmpty:function(){return this.length<=0},addRows:function(e,t){for(var r=this,a=r.length,s=0;s<a;s++){var l=r[s],u=l.row,c=l.col,f=o(l),d=i(l);u>=e?(r[s]=k(u+t,c,f,d),n(r,r[s])):u<e&&e<u+f&&(r[s]=k(u,c,f+t,d),n(r,r[s]))}},addColumns:function(e,t){for(var r=this,a=r.length,s=0;s<a;s++){var l=r[s],u=l.row,c=l.col,f=o(l),d=i(l);c>=e?(r[s]=k(u,c+t,f,d),n(r,r[s])):c<e&&e<c+d&&(r[s]=k(u,c,f,d+t),n(r,r[s]))}},removeRows:function(e,t){var n,r=this,a=[],s=r.length;for(n=0;n<s;n++){var l=r[n],u=l.row,c=l.col,f=o(l),d=i(l);u>=e?u<e+t?a.push(n):r[n]=k(u-t,c,f,d):u<e&&e<u+f&&(r[n]=k(u,c,f-h(u+f-e,t),d),1===r[n].rowCount&&1===r[n].colCount&&a.push(n))}for(n=a.length-1;n>=0;n--){var p=a[n];r.splice(p,1)}},removeColumns:function(e,t){var n,r=this,a=[],s=r.length;for(n=0;n<s;n++){var l=r[n],u=l.row,c=l.col,f=o(l),d=i(l);c>=e?c<e+t?a.push(n):r[n]=k(u,c-t,f,d):c<e&&e<c+d&&(r[n]=k(u,c,f,d-h(c+d-e,t)),1===r[n].rowCount&&1===r[n].colCount&&a.push(n))}for(n=a.length-1;n>=0;n--){var p=a[n];r.splice(p,1)}},toJSON:function(){var e=this.slice(0);return 0===e.length?d:e},fromJSON:function(e){if(e)for(var t=e,n=0;n<t.length;n++){var r=t[n];this.addSpan(k(r.row,r.col,o(r),i(r)))}}};return T(t.prototype,r),t}(Array);t._SpanModel=I;var O=function(e){function t(){e.call(this),this.headingOverflowlayout=f,this.trailingOverflowLayout=f}return x(t,e),t.prototype.find=function(e){for(var t,n=this,r=n.length,o=0;o<r;o++)if(t=n[o],t.contains(e))return t;return f},t}(Array);t._CellOverflowLayoutModel=O,a.prototype.contains=function(e){return e>=this.startColumn&&e<=this.endColumn},t._CellOverflowLayout=a;var D=function(e){function t(){e.call(this),this._selectionPolicy=2,this._selectionUnit=0}x(t,e);var n={find:function(e,t){for(var n,r=this,o=r.length,i=0;i<o;i++)if(n=r[i],n.contains(e,t))return n;return f},clear:function(){this.splice(0,this.length),this._activeSelectedRangeIndex=-1},add:function(e,t,n,r){var o=this,i=o._selectionPolicy,a=o._selectionUnit;0===i?(n=h(n,1),r=h(r,1),o.clear()):1===i&&o.clear(),1===a?(t=-1,r=-1):2===a&&(e=-1,n=-1),o.push(k(e,t,n,r)),o._activeSelectedRangeIndex=o.length-1},toArray:function(){return this.slice(0)},fromArray:function(e){this.splice(0,this.length);for(var t=0;t<e.length;t++)this.push(e[t])},toJSON:function(){var e=this,t={},n=e._selectionPolicy,r=e._selectionUnit,o=e._activeSelectedRangeIndex,i=e.length;2!==n&&(t.selectionPolicy=n),0!==r&&(t.selectionUnit=r),0!==o&&(t.activeSelectedRangeIndex=o),t.length=i;for(var a=0;a<i;a++)t[a]=e[a];return S(t)?d:t},fromJSON:function(e){if(e){var t=this;t.clear();var n=e.selectionPolicy,r=e.selectionUnit,a=e.length;A(a)&&(a=1);for(var s=0;s<a;s++){var l=e[s];t.push(k(l?l.row:0,l?l.col:0,l?o(l):1,l?i(l):1))}t._activeSelectedRangeIndex=e.activeSelectedRangeIndex||0,A(n)||(t._selectionPolicy=n),A(r)||(t._selectionUnit=r)}},_isColumnSelected:function(e){for(var t=this,n=0;n<t.length;n++){var r=t[n],o=-1===r.col?0:r.col;if(-1===r.row&&e>=o&&e<o+i(r))return!0}return!1},_isRowSelected:function(e){for(var t=this,n=0;n<t.length;n++){var r=t[n],i=-1===r.row?0:r.row;if(-1===r.col&&e>=i&&e<i+o(r))return!0}return!1},_isSelected:function(e,t,n,r,a,s){function l(e,t,n){var r=k(-1,-1,-1,-1);if(e){var a=e.col,s=e.row,l=-1===s,u=-1===a;r.row=l?0:s,r.rowCount=l?t:o(e),r.col=u?0:a,r.colCount=u?n:i(e)}return r}for(var u=!1,c=this,f=s?1:0,d=0,p=c.length;d<p;d++){var h=c[d],m=l(h,r,a),g=m.row,_=m.col,v=g-f<=e&&e<g+o(m)+f,y=_-f<=t&&t<_+i(m)+f;if(3===n||A(n)?u=v&&y:2===n?u=v:1===n?u=y:0===n&&(u=-1===h.row&&-1===h.col),u)break}return u},_isAllSelected:function(e,t,n,r,a){for(var s=this,l=!1,u=0;u<s.length;u++){var c=s[u],f=c.row,d=c.col,p=o(c),h=i(c),m=-1===d,g=-1===f;if(!A(n)&&3!==n){if(2===n){var _=g?0:f;l=m&&e>=_&&e<_+p}else if(1===n){var v=m?0:d;l=g&&t>=v&&t<v+h}else 0===n&&(l=g&&m&&p===r&&h===a);if(l)break}}return l}};return T(t.prototype,n),t}(Array);t._SelectionModel=D;var P=function(e){function t(){e.call(this)}function n(e,t,n,r,o){for(var i,a=e.length,s=0;s<a;s++)if(i=e[s],A(t)||A(n)?A(t)?A(n)?A(r)?i.containsY(o):i.containsX(r):i.col===n:i.row===t:i.contains(t,n))return i;return f}function r(e,t,n){var r=f,o=e.length,i=!A(t);return o>0&&((r=i?e.findX(t):e.findY(n))||(r=(i?t<e[0].x:n<e[0].y)?e[0]:e[o-1])),r}x(t,e);var o={findCell:function(e,t){for(var n,r=this.length,o=0;o<r;o++)if(n=this[o],n.contains(e,t))return n;return f},findRow:function(e){for(var t,n=this.length,r=0;r<n;r++)if(t=this[r],t.row===e)return t;return f},findCol:function(e){for(var t,n=this.length,r=0;r<n;r++)if(t=this[r],t.col===e)return t;return f},findX:function(e){return n(this,d,d,e)},findY:function(e){return n(this,d,d,d,e)},findNearX:function(e){return r(this,e)},findNearY:function(e){return r(this,d,e)}};return T(t.prototype,o),t}(Array);t._LayoutModel=P,s.prototype={contains:function(e,t){var n=this;return e<n.row+o(n)&&n.row<=e&&t<n.col+i(n)&&n.col<=t},intersect:function(e){var t=this;return(t.x<0||e.x<t.x+t.width&&t.x<e.x+e.width)&&(t.y<0||e.y<t.y+t.height&&t.y<e.y+e.height)},containsX:function(e){return this.x<=e&&e<this.x+this.width},containsY:function(e){return this.y<=e&&e<this.y+this.height}},t._Layout=s,l.prototype={constructor:l,getRowCount:function(){return this.rowCount},getColumnCount:function(){return this.colCount},setRowCount:function(e){this.rowCount=e},setColumnCount:function(e){this.colCount=e},_updateDirty:function(e,t,n){var r=this,o=r._dirtyNodes;if(!(r._dirtySuspended>0)&&e>=0&&t>=0){var i=o[e]||(o[e]={}),a=i[t]||(i[t]={});"n"!==i.rs&&(i.rs="e");var s=n._originalItem,l=n._oldValue;A(s)||(i.originalItem=s),A(l)||(a.oldValue=l)}},getValue:function(e,t){var n=this.getNode(e,t);return n&&!A(n.value)?n.value:f},setValue:function(e,t,n){var r=this.getNode(e,t,!0),o=r.value;o!==n&&(r.value=n,this._updateDirty(e,t,{_oldValue:o}))},getStyle:function(e,t){var n=this.getNode(e,t);return n&&n.style},setStyle:function(e,t,n){var r=this.getNode(e,t,!0);r&&r.style!==n&&(r.style=n)},getValueForKey:function(e,t,n){var r=this.getNode(e,t);return r&&r[n]},setValueForKey:function(e,t,n,r){var o=this.getNode(e,t,!0);o&&o[n]!==r&&(o[n]=r)},addRows:function(e,t){var n=this,r=o(n),i=n.dataTable,a=n._dirtyNodes;if(0<=e&&e<=r&&t>=0){E(i,r,e,t),E(n._rowDataArray,r,e,t),E(a,r,e,t),n.rowCount+=t;for(var s=0;s<t;s++)i[e+s]={rs:"n"},a[e+s]=i[e+s]}},deleteRows:function(e,t){var n=this,r=o(n);0<=e&&e<r&&t>0&&(e+t>r&&(t=r-e),M(n.dataTable,r,e,t),M(n._rowDataArray,r,e,t),M(n._dirtyNodes,r,e,t),n.rowCount-=t)},addColumns:function(e,t){var n=this,r=i(n);if(0<=e&&e<=r&&t>=0){for(var a=0;a<o(n);a++){var s=n.dataTable[a];s&&e<r&&E(s,r,e,t)}E(n._columnDataArray,r,e,t),n.colCount+=t}},deleteColumns:function(e,t){var n=this,r=i(n);if(0<=e&&e<r&&t>0){for(var a=0;a<o(n);a++){var s=n.dataTable[a];s&&e<r&&M(s,r,e,t)}M(n._columnDataArray,r,e,t),e+t>r&&(t=r-e),n.colCount-=t}},getNode:function(e,t,n){var r=this,o=r.dataTable,i=r._columnDataArray,a=r._rowDataArray,s=f;if(e<r.rowCount&&t<r.colCount)if(e>=0&&t>=0){var l=o[e];n&&!l&&(l=o[e]={},e>r._lastNonNullRow&&(r._lastNonNullRow=e)),l&&(s=l[t],n&&!s&&(s=l[t]={},r._lastNonNullColumn<t&&(r._lastNonNullColumn=t)))}else-1===e&&t>=0?(s=i[t],n&&!s&&(s=i[t]={},r._lastNonNullColumn<t&&(r._lastNonNullColumn=t))):e>=0&&-1===t?(s=a[e],n&&!s&&(s=a[e]={},r._lastNonNullRow<e&&(r._lastNonNullRow=e))):-1===e&&-1===t&&(s=r._defaultDataNode,n&&!s&&(s=r._defaultDataNode={}));return s},swapNode:function(e,t,n,r){function o(e,t,n,r,o,i,a,s){if(n>=0&&r>=0){(i[n]||(i[n]={}))[r]=o}else n>=0&&-1===r&&e>=0&&-1===t?a[n]=o:r>=0&&-1===n&&t>=0&&-1===e&&(s[r]=o)}var i=this,a=i.dataTable,s=i._rowDataArray,l=i._columnDataArray,u=i.getNode(e,t),c=i.getNode(n,r);u?o(e,t,n,r,u,a,s,l):c&&o(e,t,n,r,f,a,s,l),c?o(n,r,e,t,c,a,s,l):u&&o(n,r,e,t,f,a,s,l)},nextNonNullRow:function(e){e++;for(var t=o(this),n=this.dataTable;e>=0&&e<t&&!n[e];)e++;return e<t?e:-1},nextNonNullColumn:function(e,t){var n=this,r=f,a=i(n);if(e>=0&&e<o(n)&&(r=n.dataTable[e]),r){for(t++;t>=0&&t<a&&!r[t];)t++;if(t<a)return t}return-1},clear:function(e,t,n,r,a,s){var l,u,c,d=this,p=o(d),m=i(d),g=[];if(e>=0&&t>=0){if(n=h(n,p-e),r=h(r,m-t),n>0&&r>0)for(c=e;c<e+n;c++)if(!s||v._ArrayHelper._indexOf(s,c)<0)for(u=t;u<t+r;u++)(l=d.getNode(c,u))&&(g.push(l),(1&a)>0&&!A(l.value)&&d._updateDirty(c,u,{_oldValue:l.value}))}else if(e>=0&&-1===t){if((n=h(n,p-e))>0)for(c=e;c<e+n;c++)(l=d.getNode(c,-1))&&g.push(l)}else if(-1===e&&t>=0){if((r=h(r,m-t))>0)for(u=t;u<t+r;u++)(l=d.getNode(-1,u))&&g.push(l)}else-1===e&&-1===t&&(l=d._defaultDataNode)&&g.push(l);for(var _=0;_<g.length;_++)g[_]&&((8&a)>0&&(g[_].tag=f),(2&a)>0&&(g[_].style=f),(1&a)>0&&(g[_].value=f),(16&a)>0&&(g[_].sparkline=f),(64&a)>0&&(g[_].bindingPath=f),(4&a)>0&&(g[_].comment=f))},toJSON:function(e){function t(e,t,n){if(!e)return f;var r={},o=e.value;A(o)||(r.value=o);var i=e.style;if("string"==typeof i)r.style=i;else if(i){var a=i.toJSON(t,n),s=i.font;S(a)||(s&&(a.font=b._normalizeFont(s)),a.name=d,r.style=a)}var l=e.bindingPath;A(l)||(r.bindingPath=l);var u=e.tag;return A(u)||(r.tag=u),r}for(var n,a=this,s={},l={},u=a.nextNonNullRow(-1);u>=0;){var c={},p=!1;for(n=a.nextNonNullColumn(u,-1);n>=0;){var h=a.getNode(u,n);if(h){var m=t(h);S(m)||(c[n]=m,p=!0)}n=a.nextNonNullColumn(u,n)}p&&(l[u]=c),u=a.nextNonNullRow(u)}S(l)||(s.dataTable=l);var g=[],_=a._rowDataArray;for(u=0;u<o(a);u++)if(r(_,u)&&_[u]){var v=t(_[u]);S(v)||(g[u]=v)}g.length>0&&(s.rowDataArray=g);var y=[],w=a._columnDataArray;for(n=0;n<i(a);n++)if(r(w,n)&&w[n]){var C=t(w[n]);S(C)||(y[n]=C)}y.length>0&&(s.columnDataArray=y);var x=t(a._defaultDataNode,e,!0);return S(x)||(s.defaultDataNode=x),s},fromJSON:function(e,t,a){function s(e,t,r,o,i,a){if(e){var s=e.value;if(s!==d){if(s!==f&&(s._calcError||s._error&&s._code)){var l=n(5),u=l&&l.CalcError.parse(s._calcError||s._error);u!==d&&(s=u)}t.value=s}var c=e.style;if(c!==d){var h=f;typeof c===p?h=c:c&&(h=new _,h.fromJSON(c,r),h.name=d),t.style=h,a&&a.setStyle&&a.setStyle(o,i,h)}var m=e.visualState;m!==d&&(t.visualState=m);var g=e.bindingPath;g!==d&&(t.bindingPath=g);var v=e.tag;if(v!==d){var b=v.typeName;if(typeof b===p){var w=y.getTypeFromString(b);w&&(v=new w,v.fromJSON&&v.fromJSON(e.tag))}t.tag=v}}}if(e){var l=this;l._dirtySuspended++,A(e.name)||(l.name=e.name);var u,c,h,m,g=e.dataTable,v=o(l),b=i(l);if(g)for(u=0;u<v;u++)if(h=g[u])for(c=0;c<b;c++)(m=h[c])&&s(m,l.getNode(u,c,!0),t,u,c,a);var w=e.rowDataArray||e._rowDataArray;if(w)for(u=0;u<v;u++)r(w,u)&&w[u]&&s(w[u],l.getNode(u,-1,!0),t,u,-1,a);var C=e.columnDataArray||e._columnDataArray;if(C)for(c=0;c<b;c++)r(C,c)&&C[c]&&s(C[c],l.getNode(-1,c,!0),t,-1,c,a);var S=e.defaultDataNode||e._defaultDataNode;S&&s(S,l.getNode(-1,-1,!0),t,-1,-1,a),l._dirtySuspended--}}},t._SheetModel=l;var N=c.prototype={addItems:function(e,t){var n=this,r=n.length;0<=e&&e<=r&&t>0&&E(n._infos,r,e,t),n.length+=t},deleteItems:function(e,t){var n=this,r=n.length;0<=e&&e<r&&t>0&&(t=h(t,r-e),M(n._infos,r,e,t)),n.length-=t},reset:function(e){var t=this._infos;t.length>e&&(t[e]=f)},_getItems:function(){return this._infos},_setItems:function(e,t){this._infos=e,this.length=t},_getItem:function(e){return this._infos[e]},_setItem:function(e,t){this._infos[e]=t,this.length=this._infos.length},getSize:function(e,t){var n=this._infos[e],r=f,o="row"===this.type?22:0;return n&&(r=!1===n.visible?0:"autoFit"===t?m(n.autoFitSize||0):Math.max(m(n.autoFitSize||0),m(n.size||o))),r},getActualSize:function(e,t){var n="autoFit"===t?"autoFitSize":"size",r=this._infos[e],o=r&&r[n];return null!=o?m(o||0):f},setSize:function(e,t,n){var r=u(this,e),o="autoFit"===n?"autoFitSize":"size";r[o]!==t&&(r[o]=t)}};C({visible:!0,resizable:!0,pageBreak:!1},function(e,t){var n=e[0].toUpperCase()+e.substr(1);N["get"+n]=function(n){var r=t,o=this._infos[n];return o&&!A(o[e])&&(r=o[e]),r},N["set"+n]=function(t,n){var r=u(this,t);r[e]!==n&&(r[e]=n)}}),t._AxisModel=c,e.exports=t},function(e,t,n){var r={};r._each=function(e,t){if(r._isArraylike(e))for(var n=0,o=e.length;n<o&&!1!==t.call(e[n],n,e[n]);n++);else for(var i in e)if(e.hasOwnProperty(i)&&!1===t.call(e[i],i,e[i]))break;return e},r._isEmptyObject=function(e){return!e||"object"==typeof e&&0===Object.keys(e).length},r._isFunction=function(e){return"function"===r._getType(e)},r._isArray=function(e){return Array.isArray?Array.isArray(e):"array"===r._getType(e)},r._isNumeric=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},r._getType=function(e){if(null===e)return"null";var t=r._class2type;if(!t){t=r._class2type={};for(var n=["Boolean","Number","String","Function","Array","Date","RegExp","Object","Error"],o=0,i=n.length;o<i;o++)t["[object "+n[o]+"]"]=n[o].toLowerCase()}var a=t.toString,s=typeof e;return"object"===s||"function"===s?t[a.call(e)]||"object":s},r._inArray=function(e,t,n){var o;if(t){var i=[].indexOf;if(i)return i.call(t,e,n);for(o=t.length,r._isNullOrUndefined(n)&&(n=0),n=n<0?Math.max(0,o+n):n;n<o;n++)if(n in t&&t[n]===e)return n}return-1},r._merge=function(e,t){var n=t.length,r=e.length,o=0;if("number"==typeof n)for(;o<n;o++)e[r++]=t[o];else for(;void 0!==t[o];)e[r++]=t[o++];return e.length=r,e},r._map=function(e,t,n){var o,i=0,a=e.length,s=r._isArraylike(e),l=[];if(s)for(;i<a;i++)null!==(o=t(e[i],i,n))&&(l[l.length]=o);else for(i in e)e.hasOwnProperty(i)&&null!==(o=t(e[i],i,n))&&(l[l.length]=o);return[].concat.apply([],l)},r._extend=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n,o,i,a,s,l,u=arguments[0]||{},c=1,f=arguments.length,d=!1;for("boolean"==typeof u&&(d=u,u=arguments[1]||{},c=2),"object"==typeof u||r._isFunction(u)||(u={}),f===c&&(u=this,--c);c<f;c++)if(!r._isNullOrUndefined(s=arguments[c]))for(a in s)n=u[a],i=s[a],u!==i&&(d&&i&&(r._isPlainObject(i)||(o=r._isArray(i)))?(o?(o=!1,l=n&&r._isArray(n)?n:[]):l=n&&r._isPlainObject(n)?n:{},u[a]=r._extend(d,l,i)):void 0!==i&&(u[a]=i));return u},r._inherit=function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);n.prototype=t.prototype,e.prototype=new n},r._isWindow=function(e){return null!==e&&e===e.window},r._isPlainObject=function(e){if(!e||"object"!==r._getType(e)||e.nodeType||r._isWindow(e))return!1;var t={}.hasOwnProperty;try{if(e.constructor&&!t.call(e,"constructor")&&!t.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}var n;for(n in e);return void 0===n||t.call(e,n)},r._isArraylike=function(e){if(r._isNullOrUndefined(e))return!1;var t=e.length,n=r._getType(e);return!r._isWindow(e)&&(!(1!==e.nodeType||!t)||("array"===n||"function"!==n&&(0===t||"number"==typeof t&&t>0&&t-1 in e)))},r._makeArray=function(e,t){var n=t||[];return null!==e&&(r._isArraylike(Object(e))?r._merge(n,"string"==typeof e?[e]:e):[].push.call(n,e)),n},r._isType=function(e,t){return r._isNullOrUndefined(e)?"null"===t:!!t&&(t instanceof Function&&e instanceof t||(typeof e===t||(!("function"!==t||!/^\s*\bfunction\b/.test(""+e))||(Object.prototype.toString.call(e).slice(8,-1).toLowerCase()===t.toLowerCase()||("DateTime"===t||"TimeSpan"===t?e instanceof Date:("string"==typeof t&&"undefined number boolean string".indexOf(t),!1))))))},r._isNullOrUndefined=function(e){return void 0===e||null===e},r._isNumber=function(e,t){return e=n(21)._replaceCultureSymbolToNormal(e,t),r._isType(e,"number")||r._isType(e,"DateTime")||r._isType(e,"TimeSpan")||e&&!r._isType(e,"boolean")&&!isNaN(e)&&!isNaN(parseFloat(e))&&!(e.length>=2&&"0"===e[0]&&"x"===e[1])},r._toDouble=function(e){var t=n(37);return r._isNullOrUndefined(e)||""===e?0:r._isType(e,"number")?e:r._isType(e,"string")&&!isNaN(e)?n(21)._parseLocale(e):r._isType(e,"boolean")?e?1:0:r._isType(e,"DateTime")?t._toOADate(e):r._isType(e,"TimeSpan")?Math.floor(t._toOADate(e)):parseFloat(e)},r._cloneObject=function(e){if(!e)return e;if("number"==typeof e||"string"==typeof e||"boolean"==typeof e||r._isNullOrUndefined(e))return e;if(e.clone)return e.clone();if(e instanceof Date)return new Date(e);var t,n,o;t=e instanceof Object?new e.constructor:new e.constructor(e.valueOf());for(n in e)e.hasOwnProperty(n)&&(o=e[n],e.hasOwnProperty(n)&&t[n]!==o&&(t[n]="object"==typeof o?r._cloneObject(o):o));return t.toString=e.toString,t.valueOf=e.valueOf,t},e.exports=r},function(e,t,n){var r=n(16),o=function(){function e(){}return e._getReg=function(t){var n=e._regDict[t];return n||(n=e._regDict[t]=new RegExp(t,"g")),n.lastIndex=0,n},e._getRegIgnoreCase=function(t){var n=e._regDictIgnoreCase[t];return n||(n=e._regDictIgnoreCase[t]=new RegExp(t,"gi")),n.lastIndex=0,n},e._getWildcardCriteria=function(t,n){if(e._wildcardParseRecord[t])return e._wildcardParseResultBuffer[t];if(e._getReg("[~?*]+").test(t)){for(var r,o=[],i=t.split(""),a=0;a<i.length;a++)r=i[a],"~"===r&&a<i.length-1?(a++,r=i[a],"*"===r||"?"===r?o.push("\\"):n&&o.push("~"),o.push(r)):"?"===r?o.push("."):"*"===r?(o.push("."),o.push("*")):o.push(r);return o.join("")}return null},e._getWildcardCriteriaFullMatch=function(t,n){var r=e._getWildcardCriteria(t,n);return r&&(r="^"+r+"$"),r},e._getReplaceSymbol=function(e,t){for(var n="#"+e+"0#",o=1;t.indexOf(n)>0;)n=r._join(n,"#"+e+(o-1)+"#","#"+e+o+"#"),o++;return n},e._regDict={},e._regDictIgnoreCase={},e._wildcardParseRecord={},e._wildcardParseResultBuffer={},e._replaceRegString2NormalString=function(e){return e.replace(/([\~\!\@\#\$\%\^\&\*\(\)\-\_\+\=\[\]\{\}\|\\\;\:\'\"\,\.\/\<\>\?])/,"\\$1")},e}();e.exports=o},function(e,t,n){function r(e,t,n){return e.substr(t,n)}function o(e,t,n,r){if(!t)throw new Error;if(""===t)return!0;if(t.length>e.length)return!1;var o=e,i=t;return n&&(o=o.toLowerCase(),i=i.toLowerCase()),r(o,i)}var i=n(14)._isNullOrUndefined,a={_contains:function(e,t,n){return n&&(e=e.toLowerCase(),t=t.toLowerCase()),""===t||e.indexOf(t)>=0},_indexOf:function(e,t,n){if(!n)return e.indexOf(t);if(n){var r=e.toLowerCase(),o=t.toLowerCase();return r.indexOf(o)}return e.indexOf(t)},_trimStart:function(e,t){if(!t)return e;for(var n=e;r(n,0,t.length)===t;)n=r(n,t.length);return n},_trimEnd:function(e,t){if(!t)return e;for(var n=e;r(n,n.length-t.length,t.length)===t;)n=r(n,0,n.length-t.length);return n},_insert:function(e,t,n){if(t<0||t>e.length||i(n))throw new Error;return r(e,0,t)+n+r(e,t,e.length-t)},_remove:function(e,t,n){if(i(n)&&(n=e.length-t),t<0||n<0||t+n>e.length)throw new Error;return r(e,0,t)+r(e,t+n,e.length-t-n)},_startsWith:function(e,t,n){return o(e,t,n,function(e,t){return e.slice(0,t.length)===t})},_endsWith:function(e,t,n){return o(e,t,n,function(e,t){return e.slice(-t.length)===t})},_replace:function(e,t,n,r){if(!t||""===t)throw new Error;return n=(""+n).replace(/\$/g,"$$$$"),e.replace(new RegExp(t,"g"+(r?"i":"")),n)},_replaceAllNoReg:function(e,t,r,o){return t=n(15)._replaceRegString2NormalString(t),this._replace(e,t,r,o)},_leftBefore:function(e,t){var n=e.indexOf(t);return n<0||n>=e.length?e:r(e,0,n)},_count:function(e,t){for(var n=0,r=e.indexOf(t);r>=0;)n+=1,r=e.indexOf(t,r+1);return n},_join:function(e,t,n){return e.split(t).join(n)},_format:function(e,t){for(var n=e,r=0;r<t.length;r++){var o=new RegExp("\\{"+r+"\\}","g");n=n.replace(o,t[r])}return n},_padZero:function(e,t,n){for(var r=e.toString(),o=r.length;o<t;o++)r=n?"0"+r:r+"0";return r},_padZeroLeft:function(e,t){return a._padZero(e,t,!0)},_padZeroRight:function(e,t){return a._padZero(e,t,!1)},_compareStringIgnoreCase:function(e,t){return e===t||!e&&!t||e&&t&&e.toLowerCase()===t.toLowerCase()},_toUpperCase:function(e){return e.toUpperCase()},_escapeHtml:function(e){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},r=n(15)._getReg("(?:&|<|>|\"|'|`)");return r.test(e)?e.replace(r,function(e){return t[e]}):e},_unescapeHtml:function(e){var t={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#x27;":"'","&#x60;":"`"},r=n(15)._getReg("(?:&amp;|&lt;|&gt;|&quot;|&#x27;|&#x60;)");return r.test(e)?e.replace(r,function(e){return t[e]}):e}};e.exports=a},function(e,t,n){function r(e){var t=this;t._imageCount=0,t._loadedCount=0,t._onLoadedComplete=e,t._imgs={}}r.prototype={_addImage:function(e){function t(){r._imageLoaded(e)}var r=this,o=r._imgs,i=o[e];if(!i){var a=n(4).GC$,s=a(document.createElement("img"));s.bind("load",t),s.bind("error",t),s.bind("abort",t),r._imageCount++,o[e]=i={_state:!1,_img:s[0]},s[0].src=e}},_getState:function(e){var t=this._imgs[e];return!!t&&t._state},_getImage:function(e){var t=this._imgs[e];return t?t._img:null},_imageLoaded:function(e){var t=this;t._loadedCount++,t._imgs[e]._state=!0,t._isAllImagesLoaded()&&t._onLoadedComplete&&t._onLoadedComplete()},_isAllImagesLoaded:function(){return this._loadedCount>=this._imageCount},_dispose:function(){this._onLoadedComplete=null}};var t=n(2);t._ImageLoader=r,e.exports=t},function(e,t,n){var t=n(123);t.SR={},t.SR.en=n(65),e.exports=t},function(e,t,n){function r(e){return e.getActiveSheet()}function o(){var e=[];return C.each(m._getResource(p.SR)()._builtInFunctionsResource,function(t,n){n.name=t,e.push(n)}),e}function i(e){var t,n=[];return C.each(e,function(e,r){(t=r.description())&&(t.name=e,n.push(t))}),n}function a(e,t){if(!e)return!1;var n=!1,r=!1;if(1===t.rowCount){if(e.hasHeadersRow()&&t.row===e.startRow())return!0;if(e.hasTotalsRow()&&t.row===e.endRow())return!0}else e.hasHeadersRow()&&t.row===e.startRow()&&(t.rowCount===e.dataRange().rowCount+1&&(n=!0),e.hasTotalsRow()&&t.rowCount===e.dataRange().rowCount+1+1&&(n=!0)),t.row===e.dataRange().row&&(t.rowCount===e.dataRange().rowCount&&(n=!0),e.hasTotalsRow()&&t.rowCount===e.dataRange().rowCount+1&&(n=!0));return t.col+t.colCount<=e.startColumn()+e.dataRange().colCount&&(r=!0),n&&r}function s(e){var t=e.name();return/^\d+$/.test(t)||t.indexOf(" ")>-1||t.indexOf("'")>-1||t.indexOf("%")>-1||t.indexOf('"')>-1||t.indexOf("(")>-1||t.indexOf(")")>-1?"'"+t+"'":t}function l(e,t){if(!t)return v;var n=e._activeRowIndex,r=e._activeColIndex,o=e.parent,i=o&&1===o.options.referenceStyle,l=15;e._formulaTextBox&&e._formulaTextBox._isAbsoluteReference&&(l=0),t.row<0&&t.col<0&&(t=new d.Range(0,-1,e.getRowCount(),-1));var u=e.tables,c=u&&u.find(t.row,t.col),f=_._formulatextboxAcrossSheetSingleton._formulatextboxAcrossSheetInstance;if(a(c,t))return f&&f._text&&f._sheet!==e&&(n=r=-1),h.rangeToFormulaWithStructReference(e,t,n,r,l,i,c);var p=h.rangeToFormula(t,n,r,l,i);if(f&&f._text||e._formulaTextBox&&e._formulaTextBox._isSelectMode){p=s(e)+"!"+p}return p}function u(e,t){var n=e.parent,r=n&&n.options;if(t&&r&&r.allowUserEditFormula&&r.enableFormulaTextbox){e._formulaTextBox&&e._formulaTextBox.destroy(),e._formulaTextBox=new K(t,null,n);var a=e._formulaTextBox.text(),s=e.getFormulaInformation(e._activeRowIndex,e._activeColIndex);s&&s.hasFormula||"="===a[0]&&e._formulaTextBox.text(a);var l=e._formulaTextBox,u=e._eventHandler,c=e._render;l.bind("AppendStarted",function(){l.close();var t=e._editorStatus;1!==t&&(e._editorStatus=1,e._raiseEditorStatusChanged(t,1))}),l.bind("AppendEnded",function(){c._paintFormulaTextBox()}),l.bind("TextChanged",function(t,n){if(!e._disposed){if(n&&"input"!==n.type){u._updateEditingEditor(n);var r=e._activeRowIndex,o=e._activeColIndex,i=e.getCellType(r,o);e._trigger(d.Events.EditChange,{sheet:e,sheetName:e._name,row:r,col:o,editingText:i.getEditorValue(e._editor)})}c._paintFormulaTextBox(),e._trigger(d.Events.FormulaTextBoxTextChanged,{sheet:e,sheetName:e._name,text:l.text()})}}),l.bind("CaretChanged",function(){c._paintFormulaTextBox(),e._trigger(d.Events.FormulaTextBoxCaretChanged,{sheet:e,sheetName:e._name,caret:l.caret()})}),l.add(o()),l.add(i(p.Functions._customFunctions)),l.add(i(e._functions).concat(i(n._functions))),c._paintFormulaTextBox()}}function c(e){e._formulaTextBox&&(e._formulaTextBox.destroy(),e._formulaTextBox=v,e._render._paintFormulaTextBox());var t=e.parent&&e.parent._attachedFormulaTextBox;E.activeElement===(t&&t._host)&&e._eventHandler._changeFocusHolder()}function f(e,t){if(!t)return v;var n=e._activeRowIndex,r=e._activeColIndex;try{return h.formulaToRange(e,t,n,r)}catch(e){}return v}var d=n(1),p=n(5),h=d.CalcEngine,m=n(0),g=n(7),_={},v=null,y=void 0,b=Math.max,w=Math.min,C=d.GC$,S=C.extend,x=d._util._createElement,T=window,E=document,M=m._StringHelper,A=d._util,k=A._cancelDefault,R=A._browser,I=M._toUpperCase,O="formulatextbox",D=function(){return m._getResource(_.SR)()};_._rangeToString=l,d.Events.FormulaTextBoxTextChanged="FormulaTextBoxTextChanged",d.Events.FormulaTextBoxCaretChanged="FormulaTextBoxCaretChanged",T._gcGlobal._clickOutsideSheetCallBack.push(function(e,t){var n=t&&"gcAttachedFormulaTextBox"===t.getAttribute("gcUIElement"),r=_._formulatextboxAcrossSheetSingleton;if(!t&&e.endEdit&&!n&&r){var o=r._formulatextboxAcrossSheetInstance;o&&o._dom&&e._formulaTextBox&&(e._formulaTextBox&&e._formulaTextBox.destroy(),e._formulaTextBox=v,o._clear())}}),_._attachFormulaTextBox=u,_._detachFormulaTextBox=c,_._stringToRange=f,S(d._SheetTabBase.prototype,{_canCreateNewTab:function(e){return!(e&&e._formulaTextBox&&e._formulaTextBox._canAppendRange())}}),d.Worksheet._registerFeature(O,{startEdit:function(e){u(this,e.element)},endEdit:function(){c(this)}});var P=d._SheetTabBase,N=P.prototype,F=N._allowSheetReorder;P._registerFeature(O,{preProcessMouseDbClick:function(e){var t=r(this._workbook),n=t._formulaTextBox,o=n&&n._canAppendRange(),i=_._formulatextboxAcrossSheetSingleton._formulatextboxAcrossSheetInstance;o?e.r=!1:i&&i._dom&&i._clear()}}),N._allowSheetReorder=function(){var e=r(this._workbook),t=e._formulaTextBox,n=_._formulatextboxAcrossSheetSingleton._formulatextboxAcrossSheetInstance,o=n&&n._text;return F.call(this)&&!o&&!t};var L=".gcFormulaTextBoxInternal",H=".gcFormulaTextBox",V="TextChanged",j="CaretChanged",B="AppendStarted",U="AppendEnded",W={left:37,right:39,up:38,down:40,tab:9,enter:13,pup:33,pdn:34,end:35,home:36,esc:27},z=[g.BLUE_COLOR,"#008000","#9900cc","#800000","#00cc33","#cc6600","#cc0099"],Y='url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAARCAIAAACw+gCQAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAJSSURBVDhPY3hILqBYZ/eqV81LXpbNfp7S/yS0+Z5p+olD5x5OWXGyYcaBmql7yifuLOnbBkRFPVuACKIFqjNzwv2Qhhue5ReByK/qYlDtxb///n35+efd1z/PP/wB6vn2+/f7b79ffgIhiBaoTlPP5I2bN2/asmX7jh3Hjh+ft3wLUOfX779ef/h+6+nHtXsuffrx+/bj16euvwQiiBaETiAy904NTasGantRkvA8wetpsO0NJ839htKb9l/Jal6T3rgytX4FEEG0QHXuOnbr55+/P379AyIg40m8x8uZ3U+aC49bKn64eHzX0es4Xds0Y9ejl++vPXx3+f77Nx9/3PU3e5YR/CTM4WGs53pVPqBrgX6+8+QNFtdmNq0q6NpU1LOpe/6+o+fvH3fR36XCc9dE/KG3EdDNQPaF7VunLTuY0bA0omg2RAtUZ1LNUohjgCEJDJVtdlpPty6dr8x3yUDsvoPqRm2hqcp8Jy+9WbH/7cQ1EB0wnXEVCyBBt+fc8+NXXy9Yf/znz5/31swFaliiKjBZme/yrSe7z36YsuZBy4KbEC1QnRFFcxKqFgP1A1Fq7ZKcpqU1EzYuWX/kxIa1/WBtizYcAwqG5E71SZsA0QLVGZI3A+Lax+/+ACMwvHDmsn1v1xx8e+jSp83HXgP1ALmztryYsv4ZEEG0QHUGZk+FuHbHqadABORO3fC8Z/mdvmU3Oxdd9cuY1LX0VsOci/WzQQiiBaET4lQgii1fEFU6F4iAXgC6JShnakDWZKBmoDshCKIFqpMMQK7Ohw8BTajNa73pg9oAAAAASUVORK5CYII=")',G='url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAARCAIAAACw+gCQAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAItSURBVDhPY3hILqBYZ/eqVxDUuvRl/cKXZbNf5E59ntT3DIgi2p/6NT5xq35iV/YYiCyLHkG0IHQuOvR/1t6/03b+mbD1d/eGXy2rf9Yu/wFE5Yu+Fc79mjXza+rUz0BkmHoWogXFTqCFVfNfQmwLa3vqVfsYiBzA9sCRftIJiBaozuYZO+89eAREt+4+AKIbt+9fvXkPiC5du3P28s0T564dOnV579Hz2w6cSaqcDdEC1Vk/ZQtQQ2vv7MaumbUd0+o6ZzT3zmnunQ1kF9T0pZe2J+U3x+U0bNx9MqZ4CkQLVGdB6xKgDaX1/b/+/PnyE4E+ff/z8uPvR29/3X35MzCxfPW2o2HZPRAtUJ2lXSuADkstann/9febz7/ff/3zLDP4Spj9Pjs1oE6gthvPfnpEFS7deDAwrRWiBaozv3kh0D8RadVAlFvZvWLDrjvRrk+bCrdpCS1ZsyOpoMU9ssA5NBeo0zuhDqIFqjO9Zubhk1eA6MT5G+eu3H78/PVFX/OnxQnrNQTuPnyx9+hFoA+B2uav2ecaVQ7RAtUZVzQBKH3g+KXTl24fdjE44mp4yFbtSYrfGg3+yQocQLTryEWgzgVr9zmEFkK0QHWGZbbvPHQOiI6cvnb5wMENhjJPE30eB1k9dFIDaruy/wAwPoA6563eaxOQDdEC1YkG1hvKrNKVuOEA0nYr2Pp5qA1UAglg1wkEW03lF2kI3wy1xaoNCHDqJAjI1fnwIQDHT83/UVFPcQAAAABJRU5ErkJggg==")',K=function(){function e(e,n,r){var i=this,a=e;i._isSelectMode=!1,i._selectModeId=0,i._isAbsoluteReference=!1,n&&n.rangeSelectMode&&(!0===n.absoluteReference&&(i._isAbsoluteReference=!0),i._isSelectMode=!0,i._isSelectButtonPressed=!1,i._isSelectFocusIn=!1,i._selectModeDom=e,a=t(e,i),i._selectModeId=o++),i._init(r&&r.getHost()||E.body),a&&i._attachHost(a),r&&(i._isInWorkbook=!0,i._setWorkbook(r),i._workbook._unbind(d.Events.FormulatextboxActiveSheetChanging,_._formulatextboxAcrossSheetSingleton._handleFormulatextboxAcrossSheetBeforeTabChange),i._workbook._bind(d.Events.FormulatextboxActiveSheetChanging,_._formulatextboxAcrossSheetSingleton._handleFormulatextboxAcrossSheetBeforeTabChange),i._workbook._unbind(d.Events.FormulatextboxActiveSheetChanged,_._formulatextboxAcrossSheetSingleton._handleFormulatextboxAcrossSheetAfterTabChange),i._workbook._bind(d.Events.FormulatextboxActiveSheetChanged,_._formulatextboxAcrossSheetSingleton._handleFormulatextboxAcrossSheetAfterTabChange)),i._tokens=i._parse(i.text()),i._isEditableElement(a)&&i._colorText(i._tokens)}function t(e,t){var n=x("table");C(n).css("border-spacing","0"),C(n).css("width","100%"),C(e).append(n);var r=x("tbody");n.appendChild(r);var o=document.createElement("tr");r.appendChild(o);var i=document.createElement("td");C(i).css("padding-right","0px"),o.appendChild(i);var a=document.createElement("td");C(a).css("width","23px"),C(a).css("padding-right","0px"),o.appendChild(a);var s=C(e).width()-C(a).width(),l=x("div"),u=x("div");C(u).width(s),C(u).css({"overflow-y":"auto","overflow-x":"hidden",height:"20px"}),u.appendChild(l),i.appendChild(u);var c=x("div");a.appendChild(c),C(l).css({display:"inline-block",float:"left",height:"auto",outline:"none"}),C(l).width(s),C(l).attr("contenteditable","true"),C(l).attr("spellcheck","false");var f=C(c);return f.css({display:"block",float:"right",width:"23px",height:"23px",background:Y,"background-repeat":"no-repeat"}),f.bind("click",function(){t._isSelectButtonPressed?(t._isSelectButtonPressed=!1,t._endRangeSelect(),f.css("background",Y),f.css("background-repeat","no-repeat")):(t._isSelectButtonPressed=!0,t._beginRangeSelect(),f.css("background",G),f.css("background-repeat","no-repeat"))}),l}function n(e){var t=x("textarea");return C(t).css({display:"none"}),C(e).append(t),t}var o=1;return _._createEditorElement=n,e.prototype={constructor:e,_beginRangeSelect:function(e){var t=this;t._startingEdit(),t._startEdit(),t._isSelectFocusIn=!0;var r=n(t._workbook._host),o=t._activeSheet();o.suspendPaint(),u(o,r);var i=o._formulaTextBox;i._isSelectMode=!0,i._selectModeId=t._selectModeId,i._isAbsoluteReference=t._isAbsoluteReference,e&&(t.text(e),t.caret(e.length));var a=t.text(),s=t.caret();s<=0&&(s=a.length),t.focus(),t.caret(s),t._isAppending=!0,t._appendingStart=1;var l=a.lastIndexOf(",",s);-1!==l&&(t._appendingStart=l+1),a||(t.text("="),a="=",t.caret(1),s=1),i.text(a),i.caret(s),i._isAppending=t._isAppending,i._appendingStart=t._appendingStart,o.resumePaint()},_endRangeSelect:function(){var e=this._activeSheet();e._endEditImp(!0,y,!0),e.repaint()},destroy:function(){var e=this;e._isSelectButtonPressed&&e._endRangeSelect(),e._isAppending=!1,e._appendingStart=-1,e._detachHost(),e._detachWorkbook(),C(e._funcsPopup).remove(),C(e._funcHelpPopup).remove(),C(e._helpDiv).remove()},bind:function(e,t,n){var r=this._host;r&&e&&(e=e.split(/\s+/).join(H+" "),C(r).bind(e+H,t,n))},unbind:function(e,t){var n=this._host;n&&e&&(e=e.split(/\s+/).join(H+" "),C(n).unbind(e+H,t))},unbindAll:function(){var e=this._host;e&&C(e).unbind(H)},caret:function(e){var t=this,n=t._host;if(n){var r=E.activeElement===n,o=C(n);if(0===arguments.length)return r?t._getCaret(n).end:o.data("caret-before");e!==t.caret()&&(r?(t._setCaret(n,e),o.data("caret-before",t._getCaret(n).end)):o.data("caret-before",e),t._trigger(j,{}))}},_getCaret:function(e){var t=-1,n=-1,r=this._isInputElement(e),o=this._isEditableElement(e);if(r)t=e.selectionStart,n=e.selectionEnd;else if(o){var i=T.getSelection();if(i.rangeCount>0){var a=i.getRangeAt(0),s=a.cloneRange();s.selectNodeContents(e),s.setEnd(a.endContainer,a.endOffset),n=s.toString().length,s=a.cloneRange(),s.selectNodeContents(e),s.setEnd(a.startContainer,a.startOffset),t=s.toString().length,s.detach()}}return{start:t,end:n}},_setCaret:function(e,t){var n=this._isInputElement(e),r=this._isEditableElement(e);if(n)e.setSelectionRange(t,t);else if(r){var o=this._getColorNode(e,t);if(o){var i=T.getSelection(),a=E.createRange();a.setStart(o.node.firstChild,o.offset),a.collapse(!0),i.removeAllRanges(),i.addRange(a),this._isSelectMode&&(e.parentElement.scrollTop=e.parentElement.scrollHeight)}}},text:function(e){var t=this,n=t._host,r=t._activeSheet();if(!(!n||r&&r._disposed)){var o=t._isInputElement(n),i=t._isEditableElement(n);if(0===arguments.length){var a="";return o?a=n.value:i&&(a=n.textContent),a}if(null!==e&&void 0!==e||(e=""),e!==t.text()){t._tokens=t._parse(e),o?n.value=e:i&&t._colorText(t._tokens);var s={},l=_._formulatextboxAcrossSheetSingleton._formulatextboxAcrossSheetInstance;l&&l._text&&(s={sheet:l._sheet,editor:l._dom&&l._dom.firstChild.firstChild,canvasOffset:l._canvasOffset}),t._trigger(V,s)}}},autoComplete:function(e){if(0===arguments.length)return this._autoComplete;this._autoComplete=e},showHelp:function(e){if(0===arguments.length)return this._showHelp;this._showHelp=e},add:function(e){if(e)if(C.isArray(e))for(var t=e.length,n=0;n<t;n++)this._add(e[n]);else this._add(e)},_add:function(e){var t=e&&e.name&&I(e.name);if(t){var n,r,o=this._funcs,i=o.length;for(n=0;n<i;n++){if((r=I(o[n].name))===t)return;if(r>t)break}o.splice(n,0,e)}},remove:function(e){if(e){e=I(e);for(var t=this._funcs,n=t.length,r=0;r<n;r++)if(I(t[r].name)===e){t.splice(r,1);break}}},workbook:function(e){var t=this;if(0===arguments.length)return t._workbook;e===v?t._isSelectMode&&t._endRangeSelect():(t._setWorkbook(e),t._attachSpread())},_setWorkbook:function(e){if(e){var t=this;t._workbook&&t._detachWorkbook();var n=t._host;e&&n&&(t._workbook=e)}},_getRanges:function(){var e,t,n=[],r=this._tokens,o=r&&r.length,i=0,a=0;if(o>0)for(var s=0;s<o;s++)e=r[s],t=e.text,11===e.type&&n.push({textOffset:i,text:t,ranges:e.ranges,index:a++,allowDrag:e.allowDrag}),i+=t.length;return n},_getActiveRange:function(){var e=this._host,t=this._getRanges();if(e&&t&&t.length>0)for(var n,r,o=this.caret(),i=t.length,a=0;a<i;a++){if(n=t[a],(r=n.textOffset)<o&&o<=r+n.text.length)return n;if(r>=o)break}return v},_isActiveRange:function(e){if(!e)return!1;var t=this.caret(),n=e.text,r=e.textOffset;return r<t&&t<=r+n.length},_getRangeColor:function(e){var t=this._getRanges(),n=t.length;if(e<0||n<=e)return"";for(var r,o=[],i=0,a=0;a<n;a++){r=t[a];for(var s=!1,l=0;l<o.length;l++)if(o[l].text.replace(/\s+/g,"").toUpperCase()===r.text.replace(/\s+/g,"").toUpperCase()){s=!0;break}if(s){if(e===a){i=l;break}}else if(o.push(r),e===a){i=o.length-1;break}}var u=z;return u[i%u.length]},_canAppendRange:function(){if(this._isAppending)return!0;if(this._isSelectMode)return!0;var e=this._getToken(this.caret());if(e){var t=e.type,n=e.text;return 1===t||8===t||7===t&&"%"!==n||5===t||9===t||15===t}return!1},_isAppendingRange:function(e){if(!e||!this._isAppending)return!1;var t=this._appendingStart,n=this.caret(),r=e.textOffset;return t<=r&&r<n},_getAppendingRanges:function(){var e,t=[],n=this._getRanges(),r=n.length;if(r>0)for(var o=0;o<r;o++)e=n[o],this._isAppendingRange(e)&&t.push(e);return t},_appendRange:function(e,t,n){var r=this,o=r._host;if(e&&o){if(!r._isAppending){if(!r._canAppendRange())return;t=!1,r._isAppending=!0,r._appendingStart=r.caret(),r._trigger(B,{})}var i=r._appendingStart,a=r.text(),s=r.caret();a||(a="=",i=r._appendingStart=1,s=1);var l=s;n&&(t=!1,a=a.substr(0,i)+a.substr(s),r._tokens=r._parse(a),s=i,l=s);var u=r._getToken(s);if(t){var c=a.substr(0,s);c=c.substr(0,c.length-u.text.length),c.length>=i&&(u.text=e,l=c.length+e.length)}else{var f=r._tokens,d=m._ArrayHelper._indexOf(f,u);s>i?(f.splice(d+1,0,{text:this._listSeparator(),type:8}),f.splice(d+2,0,{text:e,type:11}),e=","+e):r._isSelectMode&&f.length>1&&d===f.length-1&&11===u.type?(f.splice(d+1,0,{text:this._listSeparator(),type:8}),f.splice(d+2,0,{text:e,type:11}),e=","+e):f.splice(d+1,0,{text:e,type:11}),l=s+e.length}r._updateHostValue();var p={},h=_._formulatextboxAcrossSheetSingleton._formulatextboxAcrossSheetInstance;h&&h._text&&(p={sheet:h._sheet,editor:h._dom&&h._dom.firstChild.firstChild,canvasOffset:h._canvasOffset}),r._trigger(V,p),r.caret(l)}},_stopAppending:function(){var e=this;e._isAppending&&(e._isAppending=!1,e._appendingStart=-1,e._trigger(U,{}))},_startAppending:function(){this._isAppending=!0,this._appendingStart=this.caret()},_appendingStartIndex:function(e){return 0===arguments.length?this._appendingStart:this._appendingStart=e},_repalceRange:function(e,t){var n=this;if(n._host&&!(e<0)&&t){for(var r,o=!1,i=n._tokens,a=i&&i.length,s=0,l=0;l<a;l++)if(r=i[l],11===r.type&&s++===e){i[l]={text:t,type:11},o=!0;break}o&&(n._updateHostValue(),n._trigger(V,{}),n.caret(n.text().length))}},_attachSpread:function(){var e=this;if(e._workbook){var t=e._host;if(e._workbook&&t){var n=d.Events;t.setAttribute("gcUIElement","gcAttachedFormulaTextBox"),e._isSelectMode||(e._workbook._attachedFormulaTextBox=e),e._workbook._bind(n.FormulatextboxEditStarted,e,e._onSpreadEditStarted),e._workbook._bind(n.FormulatextboxEnterCell,e,e._onSpreadEnterCell),e._workbook._bind(n.FormulatextboxEditEnded,e,e._onSpreadEditEnded),e._workbook._bind(n.FormulatextboxActiveSheetChanged,e,e._onSpreadActiveSheetChanged),e._workbook._bind(n.FormulatextboxRangeChanged,e,e._onSpreadRangeChanged),e._workbook._bind(n.FormulaTextBoxTextChanged,e,e._onSpreadFormulaTextBoxTextChanged),e._workbook._bind(n.FormulaTextBoxCaretChanged,e,e._onSpreadFormulaTextBoxCaretChanged);var o=r(e._workbook);o&&!e._isSelectMode&&e.text(e._getEditText(o,o._activeRowIndex,o._activeColIndex)),e._bind(V,e,e._onFormulaTextBoxTextChanged),e._bind(j,e,e._onFormulaTextBoxCaretChanged)}}},_detachWorkbook:function(){var e=this,t=e._workbook;if(!e._isInWorkbook&&t){var n=d.Events;e._isSelectMode||(t._attachedFormulaTextBox=null,t._unbind(n.FormulatextboxEditStarted,e._onSpreadEditStarted),t._unbind(n.FormulatextboxEnterCell,e._onSpreadEnterCell),t._unbind(n.FormulatextboxEditEnded,e._onSpreadEditEnded),t._unbind(n.FormulatextboxActiveSheetChanged,e._onSpreadActiveSheetChanged),t._unbind(n.FormulatextboxRangeChanged,e._onSpreadRangeChanged),t._unbind(n.FormulaTextBoxTextChanged,e._onSpreadFormulaTextBoxTextChanged),t._unbind(n.FormulaTextBoxCaretChanged,e._onSpreadFormulaTextBoxCaretChanged),e._unbind(V,e._onFormulaTextBoxTextChanged),e._unbind(j,e._onFormulaTextBoxCaretChanged)),e.text("")}e._workbook=null},_startingEdit:function(){var e=this;if(!e._isWorking){e._isWorking=!0;var t=this._workbook,n=t&&r(t);n&&!n.isEditing()?(e._isSelectMode||n._startEditImp(null,n._activeRowIndex,n._activeColIndex,null,null,!1,null),e._editStarting=!0):e._editStarting=!1,e._isWorking=!1,e._isFuncsShown||e._openFuncHelp()}},_startEdit:function(){var e=this,t=e._workbook,n=t&&r(t);if(n){var o=n._formulaTextBox;if(e._editStarting&&o){var i=o.text(),a=e.text();if(a!==i){var s=e.caret(),l=n.getFormulaInformation(n.getActiveRowIndex(),n.getActiveColumnIndex());e.text(i),l.isArrayFormula&&(s>=a.length&&(s-=1),s=b(0,s-1)),e.caret(s)}}var u=n._editorStatus;2!==u&&(n._editorStatus=2,n._raiseEditorStatusChanged(u,2))}},_getEditText:function(e,t,n){var r="";if(e){var o=e.parent,i=o&&o.options,a=e.getFormulaInformation(t,n);if(a&&a.hasFormula)r="="+a.formula,a.isArrayFormula&&(r="{"+r+"}");else{var s=e.getActualStyle(t,n),l=e.getValue(t,n);r=A._formatValue2Text(s,l,e)||"","="===r[0]&&i&&i.allowUserEditFormula}}return r},_onSpreadActiveSheetChanged:function(e,t){var n=e.data;if(!n._isWorking){var r=t.newSheet;if(!n._isSelectMode){if(n._isWorking=!0,n.close(),t){var o=r;n.text(n._getEditText(o,o._activeRowIndex,o._activeColIndex))}n._isWorking=!1}}},_onSpreadEditStarted:function(e){var t=e.data;if(!t._isWorking){var n=t._workbook,o=n&&r(n),i=o&&o._formulaTextBox;i&&t._isSelectMode===i._isSelectMode&&t._selectModeId===i._selectModeId&&(t._isWorking=!0,t.text(i.text()),t._isWorking=!1)}},_onSpreadEnterCell:function(e,t){var n=e.data;n._isSelectMode||n._isWorking||(n._isWorking=!0,t&&n.text(n._getEditText(t.sheet,t.row,t.col)),n._isWorking=!1)},_onSpreadRangeChanged:function(e,t){var n=e.data;if(!n._isWorking&&(!t.sheet._formulaTextBox||n._isSelectMode===t.sheet._formulaTextBox._isSelectMode&&n._selectModeId===t.sheet._formulaTextBox._selectModeId)){if(n._isWorking=!0,t){var r=t.sheet,o=t.row,i=t.col,a=t.rowCount,s=t.colCount;new d.Range(o,i,a,s).contains(r._activeRowIndex,r._activeColIndex)&&n.text(n._getEditText(r,r._activeRowIndex,r._activeColIndex))}n._isWorking=!1}},_onSpreadEditEnded:function(e,t){var n=e.data;if(n._isSelectMode&&n._isSelectButtonPressed&&n._isSelectFocusIn)return void(t.ignore=!0);n._isWorking||(n._isWorking=!0,n.close(),t&&t.sheet._formulaTextBox&&n._isSelectMode===t.sheet._formulaTextBox._isSelectMode&&(n._isSelectMode?t.sheet._formulaTextBox._isSelectMode&&n._selectModeId===t.sheet._formulaTextBox._selectModeId&&n.text(n._getEditText(t.sheet,t.row,t.col)):n.text(n._getEditText(t.sheet,t.row,t.col))),n._isWorking=!1)},_onSpreadFormulaTextBoxTextChanged:function(e,t){var n=e.data;if(!n._isWorking&&(!t.sheet._formulaTextBox||n._isSelectMode===t.sheet._formulaTextBox._isSelectMode&&n._selectModeId===t.sheet._formulaTextBox._selectModeId)){if(n._isWorking=!0,t){var r=n.caret();n.text(t.text),n.caret(r)}n._isWorking=!1}},_onSpreadFormulaTextBoxCaretChanged:function(e,t){var n=e.data;n._isWorking||(!t.sheet._formulaTextBox||n._isSelectMode===t.sheet._formulaTextBox._isSelectMode&&n._selectModeId===t.sheet._formulaTextBox._selectModeId)&&(n._isWorking=!0,t&&n.caret(t.caret),n._isWorking=!1)},_onFormulaTextBoxTextChanged:function(e){var t=e.data;if(!t._isWorking){var n=t._workbook,o=n&&r(n);if(o){t._isWorking=!0;var i=o._formulaTextBox,a=o.getCellType(t.rowIndex,t.columnIndex);if(i){if(t._isSelectMode!==i._isSelectMode||t._selectModeId!==i._selectModeId)return;var s=i.caret();i.text(t.text()),i.caret(s)}else{var l={sheet:o,row:t.rowIndex,col:t.columnIndex,sheetArea:3};a.setEditorValue(o._editor,t.text(),l)}t._isWorking=!1}}},_onFormulaTextBoxCaretChanged:function(e){var t=e.data;if(!t._isWorking){var n=t._workbook,o=n&&r(n);if(o&&o.isEditing()){var i=o&&o._formulaTextBox;(!i||t._isSelectMode===i._isSelectMode&&t._selectModeId===i._selectModeId)&&(t._isWorking=!0,i&&(i.caret(t.caret()),t._openFuncHelp()),t._isWorking=!1)}}},_init:function(e){var t=this;t._isImeInputting=!1,t._isInputKey=!1,t._isAppending=!1,t._appendingStart=-1,t._funcs=[],t._autoComplete=!0,t._showHelp=!0,t._autoClose=!0;var n=x("div");n.className="gcsj-func-ac-popup",n.style.display="none",n.setAttribute("gcUIElement","gcFuncACPopup"),e.insertBefore(n,v),t._funcsPopup=n,t._isFuncsShown=!1;var r=x("div");r.className="gcsj-func-help-popup",r.style.display="none",r.setAttribute("gcUIElement","gcFuncHelpPopup"),e.insertBefore(r,v),t._funcHelpPopup=r,t._isFuncHelpShown=!1,C(n).bind("mouseover",function(){t._autoClose=!1}).bind("mouseout",function(){t._autoClose=!0}),C(r).bind("mouseover",function(){t._autoClose=!1}).bind("mouseout",function(){t._autoClose=!0}),C(n).bind("scroll",function(){t._funcsScrollingTimer&&clearTimeout(t._funcsScrollingTimer),t._funcsScrollingTimer=setTimeout(function(){t._host&&t._host.focus()},100)});var o=x("div");o.style.display="none",o.setAttribute("gcUIElement","gcFuncHelpDiv"),e.insertBefore(o,v),t._helpDiv=o,t._workbook=null,t._isWorking=!1,t._editStarting=!1,t._isInWorkbook=!1},_attachHost:function(e){if(e){var t=this;if(t._isInputElement(e)||t._isEditableElement(e)){var n=C(e);if(t._host&&t._detachHost(),t._host=e,R&&R.msie){var o=parseInt(R.version,10)<10;t._isEditableElement(e)||o?(t._bind("focus",function(){n.data("text-before",t.text())}),t._bind("click",function(){n.focus()}),"input keydown keyup cut paste".split(" ").forEach(function(e){t._bind(e,function(){t._checkInput()})})):t._bind("input",function(){t._onInput()})}else t._bind("input",function(){t._onInput()});t._bind("keydown",function(e){var n=e.ctrlKey,o=e.shiftKey,i=e.altKey,a=e.metaKey,s=n||o||i||a,l=e.keyCode;if(t._isInputKey=!1,!s&&t._isFuncsShown&&(l===W.down?(t._selectFunc(1),k(e)):l===W.up?(t._selectFunc(-1),k(e)):l===W.tab&&(t._completeFunc(),k(e))),l===W.esc&&t.close(),t._checkCaret(e),t._isSelectMode){var u=r(t._workbook);if(u._eventHandler._allowEnterEditing(e)){var c=u._formulaTextBox;c&&c._isAppending&&c._stopAppending()}}}),t._bind("keyup",function(e){if(t._isInputKey&&R&&R.qtMode){var r=t.caret();n.data("caret-before")!==r&&(n.data("caret-before",r),t._trigger(j,{}),t._openFuncs(),t._isFuncsShown||t._openFuncHelp())}t._checkCaret(e)}),t._bind("focus",function(e){R&&R.mozilla&&!t._host.innerText&&(t._host.innerText=""),t._checkCaret(e),t._isSelectMode&&t._isSelectButtonPressed&&(t._isSelectFocusIn=!0,t._beginRangeSelect())}),t._bind("blur",function(){t._autoClose&&t.close(),t._isSelectMode&&(t._endRangeSelect(),t._isSelectFocusIn=!1)}),t._bind("mousedown",function(){t._isSelectFocusIn=!0,t._startingEdit()}),t._bind("mouseup",function(){t._startEdit()}),t._bind("click",function(e){t._isAppending&&t._stopAppending();var n=t._workbook,o=n&&r(n),i=o&&o._formulaTextBox;i&&i._isAppending&&(i._isSelectMode||i._stopAppending()),t._checkCaret(e)}),t._bind("compositionstart",function(){t._isImeInputting=!0}),t._bind("compositionend",function(){t._isImeInputting=!1,t._checkInput(!0)})}}},_detachHost:function(){var e=this,t=e._host;if(t){var n=C(t);n.removeData("text-before"),n.removeData("caret-before"),e._unbindAll(),e.unbindAll(),e._isSelectMode&&(C(e._selectModeDom).empty(),e._selectModeDom=v),e._host=v}},_checkInput:function(e){var t=this,n=C(t._host),r=t.text();(e||n.data("text-before")!==r)&&(t._isImeInputting||n.data("text-before",r),t._onInput())},_checkCaret:function(e){if(R&&R.msie){var t=function(e,t){return function(){e._checkCaretCore(e,t)}};setTimeout(t(this,e),10)}else this._checkCaretCore(this,e)},_checkCaretCore:function(e,t){var n=t.keyCode,r=n===W.left||n===W.right||n===W.home||n===W.end||n===W.pdn||n===W.pup||n===W.tab||n===W.enter;e._autoComplete||(r=r||n===W.up||n===W.down);var o=void 0!==t.button;if(r||o){var i=e._host,a=C(i),s=e._getCaret(i);if(s.start!==s.end)return;var l=s.end;a.data("caret-before")!==l&&(a.data("caret-before",l),e._trigger(j,{}),e._openFuncHelp())}},_activeRow:function(){return this._workbook?r(this._workbook)._activeRowIndex:y},_activeCol:function(){return this._workbook?r(this._workbook)._activeColIndex:y},_activeSheet:function(){if(this._workbook)return r(this._workbook)},_parse:function(e){var t=this,n=[];if(!e||"="!==e[0])return n.push({text:e,type:17}),n;var r=new p.Parser,o=r.parseReferenceExpressionInfos(e,t._activeSheet(),t._activeRow(),t._activeCol(),!0);return n=t._convertToTextboxToken(o)},_onInput:function(){var e=this,t=e._host,n=C(t);if(e._isInputKey=!0,e._tokens=e._parse(e.text()),e._isEditableElement(t)){if(!e._isImeInputting){var r=e.caret();e._colorText(e._tokens),e._trigger(V,{type:"input"}),e.caret(r)}}else e._trigger(V,{type:"input"});r=e.caret(),n.data("caret-before")!==r&&(n.data("caret-before",r),e._trigger(j,{})),e._openFuncs(),e._isFuncsShown||e._openFuncHelp()},_CR:function(){return m.CultureManager._getCultureInfo().NumberFormat},_arrayGroupSeperator:function(){var e=this._CR();return e&&e.arrayGroupSeperator||";"},_arrayListSeparator:function(){var e=this._CR();return e&&e.arrayListSeparator||","},_listSeparator:function(){var e=this._CR();return e&&e.listSeparator||","},_numberDecimalSeparator:function(){var e=this._CR();return e&&e.numberDecimalSeparator||"."},_convertToTextboxToken:function(e){for(var t=[],n=[],r=this._arrayGroupSeperator(),o=this._listSeparator(),i=this._arrayListSeparator(),a=!1,s=0;s<e.length;s++)if(!(s>0&&s<e.length-1&&";"===e[s-1].text&&","===e[s].text&&"ARRAYROW"===e[s+1].text)){var l=e[s],u=this._getCalcType(l,n),c=l.text;2===u?t.push({text:c,type:u}):a&&8===u&&","===c?t.push({text:i,type:9}):a&&8===u&&";"===c?t.push({text:r,type:10}):8===u?t.push({text:o,type:u}):3===u?("ARRAY"===c&&(a=!0),t.push({text:"{",type:3})):4===u?"ARRAY"===c?(a=!1,t.push({text:"}",type:4})):t.push({text:c,type:4}):6===u?t.push({text:")",type:u}):13===u?t.push({text:m._NumberHelper._replaceNormalToCultureSymbol(c),type:u,ranges:l.ranges,allowDrag:l.canDrag}):null!==u&&t.push({text:c,type:u,ranges:l.ranges,allowDrag:l.canDrag})}return t},_getCalcType:function(e,t){var n=e.type,r=e.subType,o=e.text,i=e.value;if(1===n){if(1===r)return"ARRAY"===o||"ARRAYROW"===o?(t.push(3),3):(t.push(5),"("===i.trim()?5:2);if(2===r){if(")"===i.trim())return 6;if(t.length>0){var a=t[t.length-1];if(3===a)return t.pop(),4;if(5===a)return t.pop(),6}}if("="===i.trim())return 1}else if(3===n){if(0===r)return 8}else{if(5===n||6===n||4===n)return 7;if(0===n)return 7===r||0===r?11:5===r?12:4===r?13:3===r?14:6===r?16:14;if(7===n)return 15;if(8===n)return 17}return 17},_updateHostValue:function(){var e=this,t=e._host,n=e._tokens;if(e._isInputElement(t)){for(var r="",o=n&&n.length,i=0;i<o;i++)r+=n[i].text;t.value=r}else e._isEditableElement(t)&&e._colorText(n)},_isInputElement:function(e){var t=e&&e.tagName;return"TEXTAREA"===t||"INPUT"===t},_isEditableElement:function(e){return e&&"DIV"===e.tagName&&"true"===e.contentEditable},_isFormula:function(e){return e&&"="===e[0]},_bind:function(e,t,n){var r=this._host;r&&e&&(e=e.split(/\s+/).join(L+" "),C(r).bind(e+L,t,n))},_unbind:function(e,t){var n=this._host;n&&e&&(e=e.split(/\s+/).join(L+" "),C(n).unbind(e+L,t))},_unbindAll:function(){var e=this._host;e&&C(e).unbind(L)},_trigger:function(e,t){var n=this._host;n&&C(n).trigger(e,t)},_getToken:function(e){if(e<=0)return v;var t=this._tokens,n=t&&t.length;if(n>0)for(var r,o=0,i=0;i<n;i++)if(r=t[i],(o+=r.text.length)>=e)return r;return v},_getFuncs:function(){var e=this._workbook,t=e&&r(e),n=t&&t._formulaTextBox;if(n){for(var o=n._funcs,i=0;i<o.length;i++)o[i].isFunc=!0;return o.concat(this._getCustomNames(e,t)).concat(this._getTableNames(t))}return this._funcs},_getCustomNames:function(e,t){var n=[],r=t.getCustomNames();r&&C.each(r,function(e,t){n.push({name:t._name,description:D().Fbx_CustomName_Description+t._name})});var o=e.getCustomNames();return o&&C.each(o,function(e,t){n.push({name:t._name,description:D().Fbx_CustomName_Description+t._name})}),n},_getTableNames:function(e){var t,n=[],r=e.tables;if(r&&(t=r.all()))for(var o=0;o<t.length;o++)n.push({name:t[o].name(),description:D().Fbx_TableName_Description+t[o].name()});return n},_getFuncsStartWith:function(e,t){e=I(e),M._contains(e,"[")&&(e=e.substr(e.lastIndexOf("[")+1),e=M._replace(e,"@",""));for(var n,r=[],o=t&&t.length,i=0;i<o;i++)n=t[i],0===I(n.name).indexOf(e)&&r.push(n);return r},_getTextInTokenBeforeCaret:function(){var e=this.caret();if(e<=0)return"";var t=this._tokens,n=t&&t.length;if(n>0)for(var r,o=0,i=0;i<n;i++){if(r=t[i],o+r.text.length>=e)return r.text.substring(0,e-o);o+=r.text.length}return""},_getActiveFuncInfo:function(){for(var e,t=this.caret(),n=this._tokens,r=n&&n.length,o=[],i=0,a=0;a<r;a++){if(e=n[a],o.push(e),6===e.type)for(var s=0;o.length>0;){var l=o.pop();if(6===l.type&&s++,5===l.type&&s--,0===s){o.length>0&&(l=o[o.length-1])&&2===l.type&&o.pop();break}}if((i+=e.text.length)>=t)break}if(o.length>0){for(var u=0;o.length>0;)if(e=o.pop(),8===e.type)u++;else if(2===e.type)break;if(2===e.type){var c,f=I(e.text),d=this._getFuncs(),p=d&&d.length;for(a=0;a<p;a++)if(c=d[a],I(c.name)===f)return{func:c,activeParamterIndex:u,isFunc:c.isFunc}}}return v},_openFuncs:function(){var e=this,t=e._getFuncsForInput();if(e._autoComplete&&e._isFormula(e.text())&&t&&t.length>0&&!e._isAppending&&!e._isImeInputting&&!e._isSelectMode){e._closeFuncHelp();var n=e._funcsPopup;t.length>8?(n.style.height="204px",n.style.overflowY="scroll"):(n.style.height="auto",n.style.overflowY="");for(var r,o="",i=t.length,a=0;a<i;a++)r=t[a],o+="<div class='gcsj-func-ac-row'><div class='gcsj-func-ac-row-name' isFunc="+r.isFunc+">"+r.name+"</div><div class='gcsj-func-ac-row-description'>"+(r.description||"")+"</div></div>";var s=C(e._funcsPopup);s.html(o).show(),e._isFuncsShown=!0;var l=s.find(".gcsj-func-ac-row");if(l.length>0){var u="gcsj-ac-row-active";C(l[0]).addClass(u),l.bind("mouseover",function(){l.removeClass(u),C(this).addClass(u)}),l.bind("click",function(){e._completeFunc()})}e._position()}else e._closeFuncs()},_getFuncsForInput:function(){var e=this,t=e._getToken(e.caret()),n=t&&t.text,r=[],o=e._tokens.indexOf(t);if(t&&14===t.type)return r;var i=e._getTableColumnNames(o);if(i.length>0){if(r=r.concat(i).concat(D()._tableFunctionsResource),M._endsWith(n,"[")||M._endsWith(n,"[@"))return r}else r=this._getFuncs();n=e._getTextInTokenBeforeCaret();var a=[];return n&&(a=e._getFuncsStartWith(n,r)),a},_getTableColumnNames:function(e){var t=[],n=this._tokens,o=n&&n.length;if(e<0||e>=n.length)return t;var i=this._workbook,a=i&&r(i),s={};if(void 0!==e&&e!==v||(e=o),a){var l=n[e],u=a.tables,c=u&&u.findByName(M._leftBefore(l.text,"["));if(void 0!==c&&c!==v&&!s[c]){s[c]=!0;for(var f=0,d="";d!==v;)(d=c.getColumnName(f++))!==v&&t.push({name:d,description:""});if(t.length>0)return t}}return t},_closeFuncs:function(){C(this._funcsPopup).hide(),this._isFuncsShown=!1},_selectFunc:function(e){var t=C(this._funcsPopup).find(".gcsj-func-ac-row"),n=t.length;if(0!==n){var r="gcsj-ac-row-active",o=0;if(e)for(var i=0;i<n;i++)if(C(t[i]).hasClass(r)){o=i+e;break}var a=C(this._funcsPopup).scrollTop();t.removeClass(r);var s=0;n>0&&(s=t[0].offsetHeight),o=b(o,0),o=w(o,n-1);var l=t[o];C(l).addClass(r),l.offsetTop+l.offsetHeight>C(this._funcsPopup).scrollTop()+C(this._funcsPopup).height()?C(this._funcsPopup).scrollTop(C(this._funcsPopup).scrollTop()+s):l.offsetTop<C(this._funcsPopup).scrollTop()?C(this._funcsPopup).scrollTop(l.offsetTop):C(this._funcsPopup).scrollTop(a)}},_completeFunc:function(){var e=this,t=C(e._funcsPopup).find(".gcsj-ac-row-active .gcsj-func-ac-row-name"),n=t.text(),r="true"===t.attr("isFunc");if(n){for(var o=e.caret(),i=e._tokens,a=i&&i.length,s=0,l=0,u=0,c=v;u<a&&(c=i[u],l=c.text.length,!(s+l>=o));)u++,s+=l;var f=o-s,d=c.text,p=0,h=0;M._contains(d,"[")?(p=d.lastIndexOf("[",f-1),-1===p?(p=d.indexOf("["),c.text=-1===p?n:n+d.substr(p),p=0):(p++,"@"===d.charAt(p)&&(p+=1),h=d.indexOf("]",f),-1===h&&(h=d.length),c.text=d.substring(0,p)+n+d.substr(h))):c.text=n,c.type=r?2:11;var m=u+1,g=i[m];!r||g&&5===g.type||i.splice(m,0,{text:"(",type:5}),e._closeFuncs(),e._host.focus(),e._updateHostValue(),e.caret(s+n.length+p+(r?1:0)),e._openFuncHelp(),e._tokens=e._parse(e.text()),e._trigger(V,{})}},_openFuncHelp:function(){var e=this;e._isFuncsShown&&e._closeFuncs();var t=e._getActiveFuncInfo();if(t===v||!0!==t.isFunc)return void e._closeFuncHelp();var n=e._listSeparator();if(e._showHelp&&e._isFormula(e.text())&&t&&!e._isAppending&&!e._isImeInputting&&!e._isSelectMode){for(var r,o=t.func,i=o.parameters,a=i&&i.length,s=w(a-1,t.activeParamterIndex),l="",u=0;u<a;u++){r=i[u];var c=r.name;r.repeatable&&(c+=n+"..."),r.optional&&(c="["+c+"]");var f=u===a-1?"":n+" ";c=u===s?"<span class='gcsj-func-help-paramter gcsj-func-help-paramter-active'>"+c+"</span>"+f:"<span class='gcsj-func-help-paramter'>"+c+"</span>"+f,l+=c}var d="<div class='gcsj-func-help-title'><div class='gcsj-func-help-formula'><span class='gcsj-func-help-formula-name'>"+o.name+"</span><span class='gcsj-func-help-paramter-paren'>(</span>"+l+"<span class='gcsj-func-help-paramter-paren'>)</span></div></div>",p="<div class='gcsj-func-help-section'><div class='gcsj-func-help-section-title'>"+D().Fbx_Summary+"</div><div class='gcsj-func-help-section-content'>"+(o.description||"")+"</div></div>",h="<div class='gcsj-func-help-section-content'>"+p+"</div>",m="<div class='gcsj-func-help-body'>"+h+"</div>",g=d+m;C(e._funcHelpPopup).html(g).show(),e._isFuncHelpShown=!0,e._position()}else e._closeFuncHelp()},_closeFuncHelp:function(){C(this._funcHelpPopup).hide(),this._isFuncHelpShown=!1},close:function(){this._closeFuncs(),this._closeFuncHelp()},_isReservedKey:function(e){if(this._isAppending)return!1;var t=e.ctrlKey||e.shiftKey||e.altKey||e.metaKey,n=e.keyCode;return this._isFuncsShown&&!t&&(n===W.down||n===W.up||n===W.tab)},_position:function(){var e=this,t=v;if(e._isFuncsShown?t=e._funcsPopup:e._isFuncHelpShown&&(t=e._funcHelpPopup),t){var n=C(e._host),r=C(t),o=_._formulatextboxAcrossSheetSingleton._formulatextboxAcrossSheetInstance;if(o&&o._sheet){var i=o._sheet.getCellRect(o._rowIndex,o._columnIndex),a=o._canvasOffset;return void r.css("top",i.y+i.height+a.top).css("left",i.x+a.left)}var s=n.parent(),l=n.outerHeight();"TEXTAREA"===e._host.tagName&&"gcEditingInput"===n.attr("gcUIElement")&&(s=s.parent(),l=s.outerHeight());var u=s.css("top"),c=parseFloat(u);isNaN(c)||(u=c);var f=s.css("left");"auto"===u&&(u=n.offset().top,f=n.offset().left);var d=u+l,p=C(E.body).outerHeight(),h=r.outerHeight();if(d+h>p){var m=u-h;m>=0&&(d=m)}r.css("top",d).css("left",f)}},focus:function(){C(this._host).focus()},_colorText:function(e){for(var t,n=this,r="",o="",i=e&&e.length,a=0,s=0;s<i;s++){t=e[s];var l="";11===t.type&&(l=" style='color: "+n._getRangeColor(a++)+"'"),r+="<span"+l+" class='gcsj-func-color-text'>"+C(n._helpDiv).text(t.text).html()+"</span>",o+=t.text}if(o||n.text()){var u=n._host;if(r)u.innerHTML="<span class='gcsj-func-color-content'>"+r+"</span>";else for(;u.firstChild;)u.removeChild(u.firstChild)}},_getColorNode:function(e,t){var n=C(e).find(".gcsj-func-color-content .gcsj-func-color-text"),r=n.length;if(r>0){t=b(0,t);for(var o,i,a=0;a<r;a++)if(o=n[a],i=o.textContent,(t-=i.length)<=0)return{node:o,offset:i.length+t};return{node:o,offset:i.length}}return v}},e}();_.FormulaTextBox=K,e.exports=_},function(e,t,n){function r(e,t,n){for(var r,o=this,i=0,a=t.length;i<a;i++)r=t[i],o[e][r]=n[i]}var o=n(14),i=void 0,a=null,s=o._inherit,l=o._each,u=function(){function e(){}return e._isValidEraDate=function(e){return e>=this._getEraMin()&&e<=this._getEraMax()},e._getEraDates=function(){var e=c.eras;if(e!==i){for(var t=[],n=0;n<e.length;n++)t[n]=new Date(e[n].startDate.replace(/-/g,"/"));return t}return this._EraDates},e._getEraPropByFormat=function(e){var t,n,r=this;switch(e){case"g":t="symbol",n=r._symbols;break;case"gg":t="abbreviation",n=r._abbreviations;break;case"ggg":t="name",n=r._names;break;default:return[]}var o=c.eras,a=[];if(o!==i){for(var s=0;s<o.length;s++)a[s]=o[s][t];return a}return n},e._getEraMax=function(){var e=c.eras;if(e!==i&&e.length>0){var t=new Date(e[e.length-1].startDate.replace(/-/g,"/"));return t.setFullYear(t.getFullYear()+99),t}return this._EraMax},e._getEraMin=function(){var e=c.eras;return e!==i&&e.length>0?new Date(e[0].startDate.replace(/-/g,"/")):this._EraMin},e._getEraCount=function(){var e=c.eras;return e!==i?e.length:this._EraCount},e._getEraYears=function(){var e=c.eras;if(e!==i){for(var t=[],n=1;n<e.length;n++){var r=new Date(e[n-1].startDate.replace(/-/g,"/")),o=new Date(e[n].startDate.replace(/-/g,"/"));t[n-1]=o.getFullYear()-r.getFullYear()+1}return t[n-1]=99,t}return this._EraYears},e._getEraDate=function(e){var t={};t._era=-1,t._eraYear=-1;var n=this;if(!n._isValidEraDate(e))return t;for(var r=0;r<n._getEraCount();r++){if(e<(r+1!==n._getEraCount()?n._getEraDates()[r+1]:n._addMilliseconds(n._getEraMax(),1))){t._era=r,t._eraYear=e.getFullYear()-n._getEraDates()[r].getFullYear()+1;break}}return t},e._addMilliseconds=function(e,t){var n=new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds());return n.setMilliseconds(n.getMilliseconds()+t),new Date(n.valueOf())},e._getYearFromEra=function(t,n){return e._getEraDates()[t].getFullYear()+n-1},e._parseEraPart=function(t,n){n=n.toUpperCase();for(var r=e._getEraPropByFormat(t),o=0;o<r.length;o++)if(r[o]===n)return o;return-1},e._formatEraPart=function(t,n){var r=e,o=r._getEraDate(n),i=o._era;if(i>=0){var a=r._getEraPropByFormat(t);if(a.length>0)return a[i]}var s=o._eraYear;if(s>=0){var l=s.toString();if("ee"===t)return 1===l.length&&(l="0"+l),l;if("e"===t)return l}return""},e._EraDates=[new Date(1868,8,8),new Date(1912,6,30),new Date(1926,11,25),new Date(1989,0,8)],e._EraCount=4,e._EraYears=[45,15,64,99],e._EraMax=new Date(2087,11,31,23,59,59),e._EraMin=new Date(1868,8,8),e._shortcuts=["1,m","2,t","3,s","4,h"],e._EraIndices=[0,1,2,3,0,1,2,3],e._names=["明治","大正","昭和","平成"],e._symbols=["M","T","S","H"],e._abbreviations=["明","大","昭","平"],e._EraYearMax=99,e}(),c=function(){function e(){this.NumberFormat={currencyDecimalDigits:2,currencyDecimalSeparator:".",currencyGroupSeparator:",",currencyGroupSizes:[3],currencyNegativePattern:0,currencyPositivePattern:0,currencySymbol:"¤",digitSubstitution:1,isReadOnly:!0,numberGroupSizes:[3],nanSymbol:"NaN",nativeDigits:["0","1","2","3","4","5","6","7","8","9"],numberNegativePattern:1,negativeInfinitySymbol:"-Infinity",negativeSign:"-",numberDecimalDigits:2,numberDecimalSeparator:".",numberGroupSeparator:",",positiveInfinitySymbol:"Infinity",positiveSign:"+",percentDecimalDigits:2,percentDecimalSeparator:".",percentGroupSeparator:",",percentGroupSizes:[3],percentNegativePattern:0,percentPositivePattern:0,percentSymbol:"%",perMilleSymbol:"‰",listSeparator:",",arrayListSeparator:",",arrayGroupSeparator:";",dbNumber:{}},this.DateTimeFormat={abbreviatedDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],abbreviatedMonthGenitiveNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],abbreviatedMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],amDesignator:"AM",calendarIsReadOnly:!0,calendarWeekRule:0,Calendar:{MinSupportedDateTime:"@-62135568000000@",MaxSupportedDateTime:"@253402300799999@",AlgorithmType:1,CalendarType:1,Eras:[1],TwoDigitYearMax:2029,isReadOnly:!0},dateSeparator:"/",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],firstDayOfWeek:0,fullDateTimePattern:"dddd, dd MMMM yyyy HH:mm:ss",longDatePattern:"dddd, dd MMMM yyyy",longTimePattern:"HH:mm:ss",monthDayPattern:"MMMM dd",monthGenitiveNames:["January","February","March","April","May","June","July","August","September","October","November","December",""],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December",""],nativeCalendarName:"Gregorian Calendar",pmDesignator:"PM",rfc1123Pattern:"ddd, dd MMM yyyy HH':'mm':'ss 'GMT'",shortDatePattern:"YYYY/MM/DD",shortestDayNames:["Su","Mo","Tu","We","Th","Fr","Sa"],shortTimePattern:"HH:mm:ss",sortableDateTimePattern:"yyyy'-'MM'-'dd'T'HH':'mm':'ss",timeSeparator:":",universalSortableDateTimePattern:"yyyy'-'MM'-'dd HH':'mm':'ss'Z'",yearMonthPattern:"yyyy MMMM"},this.name=function(){return""},this.id=-1}function t(e){return e.split(" ").join(" ").toUpperCase()}function n(e){for(var n=[],r=0,o=e.length;r<o;r++)n[r]=t(e[r]);return n}function r(e,n,r){var o=t(e),i=n.indexOf(o);return-1===i&&(i=r.indexOf(o)),i}return e.prototype={constructor:e,_getDateTimePattern:function(){return this._dateTimeFormatPattern||(this._dateTimeFormatPattern=v),this._dateTimeFormatPattern},_getMonthIndex:function(e){var t=this;return t._upperMonths||(t._upperMonths=n(t.DateTimeFormat.monthNames),t._upperMonthsGenitive=n(t.DateTimeFormat.monthGenitiveNames)),r(e,t._upperMonths,t._upperMonthsGenitive)},_getAbbrMonthIndex:function(e){var t=this;return t._upperAbbrMonths||(t._upperAbbrMonths=n(t.DateTimeFormat.abbreviatedMonthNames),t._upperAbbrMonthsGenitive=n(t.DateTimeFormat.abbreviatedMonthGenitiveNames)),r(e,t._upperAbbrMonths,t._upperAbbrMonthsGenitive)},_getDayIndex:function(e){var r=this;return r._upperDays||(r._upperDays=n(r.DateTimeFormat.dayNames)),r._upperDays.indexOf(t(e))},_getAbbrDayIndex:function(e){var r=this;return r._upperAbbrDays||(r._upperAbbrDays=n(r.DateTimeFormat.abbreviatedDayNames)),r._upperAbbrDays.indexOf(t(e))}},e}(),f=function(e){function t(){e.apply(this,arguments),r.call(this,"NumberFormat",["currencySymbol","isReadOnly"],["$",!1]),r.call(this,"DateTimeFormat",["fullDateTimePattern","longDatePattern","longTimePattern","shortDatePattern","shortTimePattern","yearMonthPattern","calendarIsReadOnly"],["dddd, MMMM dd, yyyy h:mm:ss tt","dddd, MMMM dd, yyyy","h:mm:ss tt","YYYY/MM/DD","h:mm tt","MMMM, yyyy",!1]),this.name=function(){return"en-US"},this.id=1033}return s(t,e),t}(c),d=function(e){function t(){e.apply(this,arguments);var t={1:{letters:["兆","千","百","十","亿","千","百","十","万","千","百","十",""],numbers:["〇","一","二","三","四","五","六","七","八","九"]},2:{letters:["兆","阡","百","拾","億","阡","百","拾","萬","阡","百","拾",""],numbers:["〇","壱","弐","参","四","伍","六","七","八","九"]},3:{letters:a,numbers:["０","１","２","３","４","５","６","７","８","９"]}};r.call(this,"NumberFormat",["currencyDecimalDigits","currencyNegativePattern","currencySymbol","isReadOnly","nanSymbol","negativeInfinitySymbol","percentNegativePattern","percentPositivePattern","positiveInfinitySymbol","dbNumber"],[0,1,"¥",!1,"NaN (非数値)","-∞",1,1,"+∞",t]);var n=["1","2","3","4","5","6","7","8","9","10","11","12",""],o=["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月",""];r.call(this,"DateTimeFormat",["abbreviatedDayNames","abbreviatedMonthGenitiveNames","abbreviatedMonthNames","amDesignator","calendarIsReadOnly","dayNames","fullDateTimePattern","longDatePattern","longTimePattern","monthDayPattern","monthGenitiveNames","monthNames","nativeCalendarName","pmDesignator","shortDatePattern","shortestDayNames","shortTimePattern","yearMonthPattern"],[["日","月","火","水","木","金","土"],n,n,"午前",!1,["日曜日","月曜日","火曜日","水曜日","木曜日","金曜日","土曜日"],"yyyy'年'M'月'd'日' H:mm:ss","yyyy'年'M'月'd'日'","H:mm:ss","M'月'd'日'",o,o,"西暦 (日本語)","午後","yyyy/MM/dd",["日","月","火","水","木","金","土"],"H:mm","yyyy'年'M'月'"]),this.DateTimeFormat.eras=u,this.name=function(){return"ja-JP"},this.id=1041}return s(t,e),t}(c),p=function(e){function t(){e.apply(this,arguments);var t={1:{letters:["兆","千","百","十","亿","千","百","十","万","千","百","十",""],numbers:["○","一","二","三","四","五","六","七","八","九"]},2:{letters:["兆","仟","佰","拾","亿","仟","佰","拾","万","仟","佰","拾",""],numbers:["零","壹","贰","叁","肆","伍","陆","柒","捌","玖"]},3:{letters:a,numbers:["０","１","２","３","４","５","６","７","８","９"]}};r.call(this,"NumberFormat",["currencyNegativePattern","currencySymbol","isReadOnly","nanSymbol","negativeInfinitySymbol","percentNegativePattern","percentPositivePattern","positiveInfinitySymbol","dbNumber"],[2,"¥",!1,"非数字","负无穷大",1,1,"正无穷大",t]);var n=["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月",""],o=["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月",""];r.call(this,"DateTimeFormat",["abbreviatedDayNames","abbreviatedMonthGenitiveNames","abbreviatedMonthNames","amDesignator","calendarIsReadOnly","dayNames","firstDayOfWeek","fullDateTimePattern","longDatePattern","longTimePattern","monthDayPattern","monthGenitiveNames","monthNames","nativeCalendarName","pmDesignator","shortDatePattern","shortestDayNames","shortTimePattern","yearMonthPattern"],[["周日","周一","周二","周三","周四","周五","周六"],n,n,"上午",!1,["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],1,"yyyy'年'M'月'd'日' H:mm:ss","yyyy'年'M'月'd'日'","HH:mm:ss","M'月'd'日'",o,o,"公历","下午","YYYY/MM/DD",["日","一","二","三","四","五","六"],"H:mm","yyyy'年'M'月'"]),this.name=function(){return"zh-cn"},this.id=2052}return s(t,e),t}(c),h={invariant:new c,"en-us":new f,"ja-jp":new d,"zh-cn":new p},m=["MM/dd/yyyy","MM/d/yyyy","M/dd/yyyy","M/d/yyyy","yy/MM/dd","yy/MM/d","yy/M/dd","yy/M/d","yyyy/MM/dd","yyyy/MM/d","yyyy/M/dd","yyyy/M/d"],g=["hh:mm:ss","hh:mm:s","hh:m:ss","hh:m:s","h:mm:ss","h:mm:s","h:m:ss","h:m:s","hh:mm:ss tt","hh:mm:s tt","hh:m:ss tt","hh:m:s tt","h:mm:ss tt","h:mm:s tt","h:m:ss tt","h:m:s tt","hh:mm","hh:m","h:mm","h:m","hh:mm tt","hh:m tt","h:mm tt","h:m tt"],_=["MM-dd-yyyy","MM-d-yyyy","M-dd-yyyy","M-d-yyyy","yy-MM-dd","yy-MM-d","yy-M-dd","yy-M-d","yyyy-MM-dd","yyyy-MM-d","yyyy-M-dd","yyyy-M-d","dd-MMMM-yy","dd-MMM-yy"],v=m.concat(g);l(m,function(e,t){l(g,function(e,n){e<g.length-4&&v.push(t+" "+n)})}),v=v.concat(_),l(_,function(e,t){l(g,function(e,n){e<g.length-4&&v.push(t+" "+n)})});var y=function(){function e(){var r="zh-cn";this.culture=function(e){if(0===arguments.length)return r;e&&r!==e&&(r=e.toLowerCase(),t(r))},this.addCultureInfo=function(e,t){var r=t.NumberFormat.numberDecimalSeparator,o=t.NumberFormat.arrayListSeparator,i=t.NumberFormat.arrayGroupSeparator;if(r===t.NumberFormat.listSeparator||i===o){var a=n(11);throw a._getResource(a.SR)().Exp_Separator}h[e.toLowerCase()]=t},this.getCultureInfo=function(e){if(0===arguments.length)return h[r];e="string"==typeof e?e.toLowerCase():e;var t=h,n=a;for(var o in t)if(o===e||t[o].id!==i&&t[o].id===e){n=t[o];break}return n},this._getCultureInfo=function(e){var t=this.getCultureInfo(e);return t||(t=h[r])||(t=new c),t},e.instance=this}function t(e){var t;"function"!=typeof CustomEvent?(t=document.createEvent("CustomEvent"),t.initCustomEvent("cultureChanged",!1,!1,void 0)):t=new CustomEvent("cultureChanged",{}),t.cultureInfo=e,document.dispatchEvent(t)}return"object"==typeof e.instance?e.instance:e}();e.exports={CultureInfo:c,CultureManager:new y}},function(e,t,n){function r(e,t,n){return e.substr(t,n)}function o(e){return s._getReg(e)}var i=n(11),a=n(14)._isNullOrUndefined,s=n(15),l=n(16),u=l._padZeroLeft,c=l._padZeroRight,f=n(20).CultureManager,d=null,p=void 0,h=parseInt,m=parseFloat,g=!1,_=!0,v=Math.floor,y=Math.abs,b=Math.pow,w=function(){return i._getResource(i.SR)()},C=function(){function e(e,t,n){return t&&0!==t.length&&"i"!==t?C().test(t)?i(e,t,n.NumberFormat):s(e,t,n.NumberFormat):n&&n.name.length>0?e.toLocaleString():e.toString()}function t(e,t,n,r,o,i){return n="n",t=O(y(e),r.charAt(0),-1===o?6:o,i.numberGroupSizes,i.numberGroupSeparator,i.numberDecimalSeparator,i.negativeSign),e<0&&(t="-"+t),[t,n]}function n(e,t,n,r,o,i){n=e<0?B[i.numberNegativePattern]:"n",-1===o&&(o=2);var a=m(t),s=v(a);return t=M(a-s,o,i.numberGroupSizes,i.numberGroupSeparator,i.numberDecimalSeparator,i.negativeSign),t=""+(s+(+t>=1?1:0))+t.substring(1),[t,n]}function i(e,r,o){var i=y(e).toString();r||(r="D");var a=-1;r.length>1&&(a=h(r.slice(1),10));var s,l;switch(r.charAt(0)){case"d":case"D":s="n",-1!==a&&(i=u(""+i,a)),e<0&&(i="-"+i);break;case"c":case"C":s=e<0?W[o.currencyNegativePattern]:U[o.currencyPositivePattern],-1===a&&(a=o.currencyDecimalDigits),i=M(y(e),a,o.currencyGroupSizes,o.currencyGroupSeparator,o.currencyDecimalSeparator,o.negativeSign);break;case"n":case"N":s=e<0?B[o.numberNegativePattern]:"n",-1===a&&(a=o.numberDecimalDigits),i=M(y(e),a,o.numberGroupSizes,o.numberGroupSeparator,o.numberDecimalSeparator,o.negativeSign);break;case"p":case"P":s=e<0?j[o.percentNegativePattern]:V[o.percentPositivePattern],-1===a&&(a=o.percentDecimalDigits),i=M(100*y(e),a,o.percentGroupSizes,o.percentGroupSeparator,o.percentDecimalSeparator,o.negativeSign);break;case"F":case"f":l=n(e,i,s,r,a,o),i=l[0],s=l[1];break;case"e":case"E":l=t(e,i,s,r,a,o),i=l[0],s=l[1];break;case"x":case"X":s="n",i=I(e,"x"===r.charAt(0),-1===a?0:a);break;case"g":case"G":var c=e.toString();l=[],l=-1===c.indexOf("e")&&-1===c.indexOf("E")?n(e,i,s,r,a,o):t(e,i,s,r.replace("g","e").replace("G","E"),a,o),i=l[0],s=l[1];break;default:throw new Error(w().Exp_BadFormatSpecifier)}for(var f=/n|\$|-|%/g,d="";;){var p=f.lastIndex,m=f.exec(s);if(d+=s.slice(p,m?m.index:s.length),!m)break;switch(m[0]){case"n":d+=i;break;case"$":d+=o.currencySymbol;break;case"-":/[1-9]/.test(i)&&(d+=o.negativeSign);break;case"%":d+=o.percentSymbol;break;default:throw new Error(w().Exp_InvalidNumberFormat)}}return d}function s(e,t,n){var r=T(t),o=d;0===e?o=r._zero:e<0&&(o=r._negative),o||(o=r._normal);var i=A(e,o,n)+"";return 1===i.indexOf(n.negativeSign)&&0===i.indexOf(n.currencySymbol)&&(i=i[1]+i[0]+i.substring(2)),i}function C(){return/^(C|c|D|d|E|e|F|f|G|g|N|n|P|p|R|r|X|x)(\d*)$/g}function S(e,t){for(var n=v(y(e)),o={_integer:1,_decimal:0};n>=10;)n/=10,o._integer++;var i,a=e.toString(),s=a.search(/e/gi),l=a.indexOf(t);if(-1!==s){var u=r(a,0,s),c=r(a,s+1),f=0;-1!==l&&(f=r(u,l+1).length);i=f-m(c),i<0&&(i=0),o._decimal=i}else i=0,-1!==l&&(i=r(a,l+1).length),o._decimal=i;return o}function x(e){for(var t={_symbol:e.charAt(0),_sign:0,_exp:0},n="",r=1;r<e.length;r++)if("+"===(n=e.charAt(r)))t._sign=1;else{if("-"!==n){if("0"===n){t._exp=e.length-r;break}throw new Error(w().Exp_InvalidExponentFormat)}t._sign=-1}return t}function T(e){for(var t=d,n=d,r=d,o={_intPart:d,_decPart:d,_group:g,_scale:0,_percent:0,_permile:0,_exponent:d},i="",s=g,l=g,u=g,c=g,p=g,h=g,m=g,v=g,y=d,b=d,C=[],S=0;S<e.length;S++)if(y=e.charAt(S),s)"'"!==y?i+=y:(C.push(i),i="",s=g),b=y;else if(l)'"'!==y?i+=y:(C.push(i),i="",l=g),b=y;else if(u)C.push(i+y),i="",b=y;else{if(c){if("E"===b||"e"===b){if("+"===y||"-"===y||"0"===y){i+=y;continue}c=g}else if("+"===b||"-"===b){if("0"===y){i+=y;continue}c=g,C.push(i),i=""}else if("0"===b){if("0"===y){i+=y;continue}c=g,m||(m=_,o._exponent=x(i)),C.push(i),i=""}}else if("0"===y||"#"===y){if(v=_,"0"===b||"#"===b){i+=y,b=y;continue}""!==i&&(C.push(i),i="")}else"0"!==b&&"#"!==b||"0"===y||"#"===y||(C.push(i),i="");if(";"===y){if(""!==i&&(c&&!m&&(o._exponent=x(i)),C.push(i),i=""),p?o._decPart=y:o._intPart=C,C=[],a(t))t=o;else if(a(n))n=o;else{if(!a(r))throw new Error(w().Exp_InvalidSemicolons);r=o}p=g,v=g,h&&(o._group=_,h=g),o={}}else if(p||"."!==y)if("'"===y)s=_;else if('"'===y)l=_;else if("%"===y)o._percent++,""!==i&&(C.push(i),i=""),C.push(y);else if(y===f._getCultureInfo().NumberFormat.perMilleSymbol)o._permile++,C.push(y);else if("0"===y||"#"===y)i+=y;else if(","===y)if(p)""!==i&&(C.push(i),i="");else{if(""!==i&&(C.push(i),i=""),!v)continue;for(var T=_,E="",M=S+1;M<e.length;M++){var A=e.charAt(M);if(""===E)if("'"===A||'"'===A)E=A;else{if("0"===A||"#"===A){T=g;break}if("."===A||";"===A)break}else"'"!==A&&'"'!==A||(E="")}T?o._scale++:h=_}else"E"===y||"e"===y?(c=_,""!==i&&C.push(i),i=y):i+=y;else"#"!==b&&"0"!==b&&(C.push(i),i="#"),""!==i&&(C.push(i),i=""),o._intPart=C,C=[],p=_,v=g,h&&(o._group=_,h=g);b=y}return""!==i&&(c&&!m&&(o._exponent=x(i)),C.push(i)),h&&(o._group=_),p?o._decPart=C:o._intPart=C,a(t)?t=o:a(n)?n=o:a(r)&&(r=o),{_normal:t,_negative:n,_zero:r}}function E(e,t,n){for(var r=t[0],o=1,i=e.length-1,a="",s=0,l=g;i>=0;){if(r<1||r>9)throw new Error(w().Exp_InvalidNumberGroupSize);/\d/gi.test(e[i])?(l&&(a=n+a,l=g),s++):s=0,a=e[i]+a,s===r&&(l=_,s=0,o<t.length&&(r=t[o],o++)),i--}return a}function M(e,t,n,o,i,a,s){var l=D(e,-t);isFinite(l)||(l=e),e=l;var f,d,p=e.toString(),m=p.split(/e/i);return p=m[0],d=m.length>1?h(m[1],10):0,m=p.split("."),p=m[0],f=m.length>1?m[1]:"",d>0?(f=c(f,d),p+=f.slice(0,d),f=r(f,d)):d<0&&(d=-d,p=e<0?a+u(p.replace(a,""),d+1):u(p,d+1),f=p.slice(-d,p.length)+f,p=p.slice(0,-d)),t>0?(f=f.length>t?f.slice(0,t):c(f,t),f=i+f):f="",s===_?p+f:E(p,n,o,a)+f}function A(e,t,n){var o="";e*=b(100,t._percent),e*=b(1e3,t._permile),e/=b(10,3*t._scale);var i=t._intPart,a=t._decPart;if(!i&&!a)return"";var s,l,c,f,p,h=d,m=d;if(i)for(h="",s=0;s<i.length;s++)l=i[s],/^(0|#)+/g.test(l)&&(h+=l);if(a)for(m="",c=0;c<a.length;c++)f=a[c],/^(0|#)+/g.test(f)&&(m+=f);if(!h&&!m)return(i?i.join(""):"")+(a?a.join(""):"");m||(m="");var v=0,w=S(e,".");if(t._exponent){var C=y(e),x=h?h.length:1;if(C>=1)w._integer>x?(w._integer-=x,w._decimal+=x,e/=b(10,w._integer),v=w._integer):v=(w._integer,0),-1===t._exponent._sign&&(t._exponent._sign=0);else if(C<1&&C>0){t._exponent._sign=-1,w._integer=x,w._decimal-=x;for(var T=b(10,x);10*C<T;)C*=10,v++;e*=b(10,v)}}var A=m.lastIndexOf("0"),k=m.lastIndexOf("#"),R=w._decimal;A>=0&&(R=A+1),k>A&&k<w._decimal&&(R=k+1),a||(R=0);var I=M(e,R,n.numberGroupSizes,n.numberGroupSeparator,n.numberDecimalSeparator,n.negativeSign,_);if(""===I)return(i?i.join(""):"")+(a?a.join(""):"");var O=g;if(i){var D=I.split(".")[0],P=r(D,0,1);P===n.negativeSign&&(D=r(D,1));var H=0,V="",j=h.indexOf("0"),B=1===D.length&&"0"===D?0:D.length,U=-1===j?B:h.length-j;for(D=0===U?"":D,s=i.length-1;s>=0;s--)if(l=i[s],/^(0|#)+/g.test(l))if((V=l+V)!==h){for(var W=l.length,z=D.length-H-1;z>=0&&W>0;z--){var Y=D.charAt(z);o=Y+o,W--,H++}H>=D.length&&H<U&&W>0&&(o=new Array(W+1).join("0")+o,H+=W)}else{var G=r(D,0,D.length-H);j>=0&&j<h.length-H-G.length&&(G=new Array(h.length-H-j-G.length+1).join("0")+G),o=G+o}else t._exponent&&!O&&/^((E(\+|-)?|e(\+|-)?)\d+)/g.test(l)?(O=_,p="",p+=t._exponent._symbol,p+=L[t._exponent._sign],p+=u(v.toString(),t._exponent._exp),o=p+o):o=l+o;P===n.negativeSign&&(o=P+o),t._group===_&&(o=E(o,n.numberGroupSizes,n.numberGroupSeparator,n.negativeSign))}if(a){var K="";if(R>0){var X=I.indexOf(".");-1!==X&&(K=I.substring(X+1),""===h&&(o+=r(I,0,X)),o+=n.numberDecimalSeparator)}else/^(#+)$/gi.test(m)&&a.join("").length===m.length||(A<=0&&I.indexOf(".")<0&&h===N&&m===F||(o+="."),A>0&&(K=new Array(A+1).join("0")));var q=0;for(c=0;c<a.length;c++)f=a[c],/^(0|#)+/g.test(f)?(o+=r(K,q,f.length),q+=f.length):t._exponent&&!O&&/^((E(\+|-)?|e(\+|-)?)\d+)/g.test(f)?(O=_,p="",p+=t._exponent._symbol,p+=L[t._exponent._sign],p+=u(v.toString(),t._exponent._exp),o+=p):o+=f}var J=o.indexOf("0.");return 0===J&&(J+2===o.length&&0===w._decimal?o=o.replace("0.","."):J+2<o.length&&(/[0-9]+/g.test(o.charAt(J+2))||(o=o.replace("0.",".")))),o}function k(e,t){if(e=a(e)?"":l._trimEnd(e,""),e.match(/^[+-]?infinity$/i))return m(e);if(e.match(/^0x[a-f0-9]+$/i))return h(e,10);var n=t.NumberFormat,o=n.numberNegativePattern,i=R(e,n,o),s=i[0],u=i[1];""===s&&1!==o&&(i=R(e,n,1),s=i[0],u=i[1]),""===s&&(s="+"),u[0]===n.currencySymbol&&(u=r(u,1));var c,f,p=u.indexOf("e");p<0&&(p=u.indexOf("E")),p<0?(f=u,c=d):(f=r(u,0,p),c=r(u,p+1));var g,_,v=f.indexOf(".");v<0?(g=f,_=d):(g=r(f,0,v),_=r(f,v+".".length)),g=g.split(",").join("");var y=",".replace(/\u00A0/g," ");","!==y&&(g=g.split(y).join(""));var b=s+g;if(_!==d&&(b+="."+_),b[b.length-1]===n.percentSymbol){b=r(b,0,b.length-1),b=l._trimEnd(b,"");var w=b.indexOf(".");-1===w&&(w=b.length);var C="";C+=r(b,0,w-2),C+=".",C+=r(b,w-2,2),C+=r(b,w+1),b=C}if(c!==d){var S=R(c,n,1);""===S[0]&&(S[0]="+"),b+="e"+S[0]+S[1]}return b.match(/^[+-]?\d*\.?\d*(e[+-]?\d+)?$/)?m(b):NaN}function R(e,t,n){var o=t.negativeSign,i=t.positiveSign,a=l;if(4!==n&&2!==n||(o=" "+o,i=" "+i),4===n||3===n){if(a._endsWith(e,o))return["-",r(e,0,e.length-o.length)];if(a._endsWith(e,i))return["+",r(e,0,e.length-i.length)]}else if(2===n||1===n){if(a._startsWith(e,o))return["-",r(e,o.length)];if(a._startsWith(e,i))return["+",r(e,i.length)]}else{if(0!==n)throw new Error("");if(a._startsWith(e,"(")&&a._endsWith(e,")"))return["-",r(e,1,e.length-2)]}return["",e]}function I(e,t,n){if(0!==y(v(e)-e))throw new Error(w().Exp_BadFormatSpecifier);var r=e>=0?e.toString(16):(H+e+1).toString(16);return r=t?r.toLowerCase():r.toUpperCase(),!a(n)&&r.length<n?u(r,n):r}function O(e,t,n,r,o,i,a){for(var s=0,l=e>=1||0===e;s<1e3;){var c=b(10,s);if(l&&e/c<10||!l&&e*c>=1)break;s++}e=l?y(e)/b(10,s):y(e)*b(10,s);var f=M(e,n,r,o,i,a);return f+=t+(l?"+":"-")+u(s.toString(),3)}function D(e,t){return typeof t===p||0==+t?Math.round(e):(e=+e,t=+t,isNaN(e)||"number"!=typeof t||t%1!=0?NaN:(e=e.toString().split("e"),e=Math.round(+(e[0]+"e"+(e[1]?+e[1]-t:-t))),e=e.toString().split("e"),+(e[0]+"e"+(e[1]?+e[1]+t:t))))}function P(e){var t=f._getCultureInfo().NumberFormat;return"string"==typeof e&&(t=f._getCultureInfo(e).NumberFormat),t}var N="##################0",F="################",L={1:"+",0:"","-1":"-"},H=4294967295,V=["n %","n%","%n","% n"],j=["-n %","-n%","-%n","%-n","%n-","n-%","n%-","-% n","n %-","% n-","% -n","n- %"],B=["(n)","-n","- n","n-","n -"],U=["$n","n$","$ n","n $"],W=["($n)","-$n","$-n","$n-","(n$)","-n$","n-$","n$-","-n $","-$ n","n $-","$ n-","$ -n","n- $","($ n)","(n $)"],z="#dot#",Y="#group#";return{_parseLocale:function(e){return k(e,f._getCultureInfo())},_parseInvariant:function(e){return k(e,f._getCultureInfo("invariant"))},_customCultureFormat:function(t,n,r){return r||(r=f._getCultureInfo()),e(t,n,r)},_replaceNormalToCultureSymbol:function(e,t){if("string"!=typeof e)return e;var n=P(t),r=n.numberDecimalSeparator,i=n.numberGroupSeparator;return"."!==r&&(e=e.replace(o("[.]"),z)),","!==i&&(e=e.replace(o("[,]"),Y)),"."!==r&&(e=e.replace(o(z),r)),","!==i&&(e=e.replace(o(Y),i)),e},_replaceCultureSymbolToNormal:function(e,t){if("string"!=typeof e)return e;var n=P(t),r=n.numberDecimalSeparator,i=n.numberGroupSeparator;return"."!==r&&(e=e.replace(o("["+r+"]"),z)),","!==i&&(e=e.replace(o("["+i+"]"),Y)),"."!==r&&(e=e.replace(o(z),".")),","!==i&&(e=e.replace(o(Y),",")),e},_parseFloat:function(e,t){return m(this._replaceCultureSymbolToNormal(e,t))},_toHexString:I}}();e.exports=C},function(e,t,n){function r(e){return e&&e.toUpperCase()}function o(e,t,n,r){return-1===e&&r>127||-1===t&&n>127||n*r>127}function i(e,t,n){e[t]||(e[t]=[]),e[t].push(n)}function a(e,t,n){var r=e[t];if(r)for(var o=0;o<r.length;o++)if(r[o]===n)return void r.splice(o,1)}function s(e,t){var n=new xe(12);return n.value=e,n.needExpendIndexs=t,n}function l(e){var t=new xe(3);return t.value=e,t}function u(e){var t=new xe(2);return t.value=e,t}function c(){}function f(e,t){return typeof e===P||e instanceof Date||!t&&(typeof e===F||!isNaN(e)&&!isNaN(parseFloat(e)))}function d(e){return e instanceof fe}function p(e){return e instanceof Ce}function h(e){return e instanceof Se}function m(e){return isNaN(e)||!isFinite(e)?_e:e}function g(e,t,n,r,o,i){var a;if(e&&e.length&&e.rowCount&&e.colCount)return e;if(p(e))a=e.toArray(t,n,r,o,i),a.isArray=!0;else if(h(e))a=e.toArray(t,n,r,o,i),a.isReference=!0;else if(q(e)&&e.length>0){if(a=[],q(e[0]))return c._convertArray(e,t,!0);for(var s=0;s<e.length;s++){var l=_(e[s],t,!1);l===c.CalcConvertedError&&(a.isConvertError=!0),a.push(l)}a.rowCount=1,a.colCount=e.length,a.rangeCount=1}else p(e)?a=[]:(e=_(e,t,!0),r&&d(e)?(a=[pe],a.isError=!0):e===c.CalcConvertedError?(a=[c.CalcConvertedError],a.isConvertError=!0):n?(a=[],a.push(e)):(a=[[]],a[0].push(e)),a.rowCount=1,a.colCount=1,a.rangeCount=1);return a}function _(e,t,n,r){if(d(e))return e;var o={value:ae},i=c.CalcConvertedError;if(r&&0!==t&&(e===ae||e===se))return i;switch(t){case 1:case 5:n&&5!==t?e=S(e,o)?o.value:i:typeof e===P||(e=e instanceof Date?te._toOADate(e):i);break;case 4:if(typeof e===N){var a=I._DateTimeHelper._parseLocale(e);e=a!==se&&a!==ae?te._toOADate(a):i}else n?e=S(e,o)?o.value:i:typeof e===P||e instanceof Date||(e=i);break;case 3:n?e=S(e,o)?o.value:i:typeof e!==F&&(e=i);break;case 2:e=e===ae||e===se?"":e.toString()}return e}function v(e,t,n){var r;if(!e||!e.length||!e[0].length)return r=[],r.isError=!0,[[pe]];if(0===t)return e;var o,i,a,s=oe[t],l=e.length,u=e[0].length,f={value:ae},p=!1,h=!1,m=c.CalcConvertedError;if(!(r=e[s])){r=[],e[s]=r;for(var g=0;g<l;g++){o=e[g],i=r[g]=[];for(var _=0;_<u;_++)if(a=o[_],d(a))p||(r.isError=!0,p=!0),i.push(a);else{switch(t){case 1:case 5:n&&5!==t?S(a,f)?a=f.value:(h||(h=!0,r.isConvertError=!0),a=0):typeof a===P||a instanceof Date||(h||(h=!0,r.isConvertError=!0),a=m);break;case 3:n?x(a,f)?a=f.value:(h||(h=!0,r.isConvertError=!0),a=!1):typeof a!==F&&(h||(h=!0,r.isConvertError=!0),a=m);break;case 2:a=a===ae||a===se?"":a.toString()}i.push(a)}}}return r}function y(e){return isNaN(e)||!isFinite(e)}function b(e){var t=C(e);if(le(t)<1e21)return parseInt(t,10);throw re().Exp_InvalidCast}function w(e,t){return!!S(e,t)&&le(t.value)<1e21&&(t.value=parseInt(t.value,10),!0)}function C(e){var t={value:0};if(S(e,t))return t.value;throw re().Exp_InvalidCast}function S(e,t){var n=ae;if(!e)return t.value=0,!0;var r=typeof e;try{if(r===P)n=e;else if(r===N){if(e=e.trim(),0===e.length)return t.value=0,!0;var o=!1;if("%"===e.charAt(e.length-1)&&(o=!0,e=e.substr(0,e.length-1)),e.length>=2&&"0"===e[0]&&"x"===e[1])return!1;if(n=new Number(e).valueOf(),c._isNaNOrInfinite(n)){var i=e.charCodeAt(0);if(i|=32,e.length>4&&i>=96&&i<=122){var a=e[0]+e[1]+e[2];if(a=a.toUpperCase(),!ze[a])return!1}if("/"===e[0]||"/"===e[e.length-1])return!1;if(n=new Date(e),c._isNaNOrInfinite(n.valueOf()))return!1;n=te._toOADate(n)}o&&(n/=100)}else if(r===F)n=e?1:0;else{if(!(e instanceof Date))return!1;n=te._toOADate(e)}}catch(e){return!1}return t.value=n,!0}function x(e,t){try{if(e)if(typeof e===F);else if(e instanceof Date)e=0!==te._toOADate(e);else{if(!f(e))return!1;e=0!==e}else e=!1}catch(e){return!1}return t.value=e,!0}function T(e){if(!e)return!1;if(typeof e===F)return e;if(e instanceof Date)return 0!==te._toOADate(e);if(f(e))return 0!==e;if(d(e))return!1;throw re().Exp_InvalidCast}function E(e){try{if(e===se||e===ae)return"";if(typeof e===F)return e?L:H;if(typeof e===N)return e;if(e instanceof Date)return te._toOADate(e).toString();if(p(e))throw re().Exp_InvalidCast;return e.toString()}catch(e){throw re().Exp_InvalidCast}}function M(e){var t={value:ae};if(A(e,t))return t.value;throw re().Exp_InvalidCast}function A(e,t){if(e)if(e instanceof Date)t.value=new Date(e);else if(typeof e===N){var n=I._DateTimeHelper._parseLocale(e);if(!n)if(isNaN(e)){if(n=new Date(e),isNaN(n.valueOf()))return!1;try{var r=/^[-+=\s]*(\d+)\W+(\d+)\W+(\d+)$/,o=ne._trimEnd(ne._trimStart(e.replace(/ |\n/g,"")," ")," "),i=r.exec(o);if(i&&4===i.length&&(-1===i.indexOf(n.getYear().toString())||-1===i.indexOf(n.getMonth().toString())||-1===i.indexOf(n.getDate().toString())))return!1}catch(e){return!1}}else if(!(n=I._DateTimeHelper._fromOADate(parseFloat(e))))return!1;t.value=n}else{if(typeof e!==P)return!1;t.value=I._DateTimeHelper._fromOADate(e)}else t.value=I._DateTimeHelper._fromOADate(0);return!0}function k(e,t){return D._customFunctions[r(e)]=t,t}function R(e){if(!e)return ae;e=r(e);var t=D._builtInFunctions,n=D._customFunctions;return t&&t[e]||n&&n[e]}var I=n(0),O={},D=O.Functions={},P="number",N="string",F="boolean",L="TRUE",H="FALSE",V="#NULL!",j="#DIV/0!",B="#VALUE!",U="#REF!",W="#NAME?",z="#N/A",Y="#NUM!",G=[V,j,B,U,W,z,Y],K=[0,7,15,23,29,42,36];O.ErrorList=G;var X=I._Types,q=X._isArray,J=X._extend,Z=O.BAND_INDEX_CONST=-2147483648,Q=O.MAX_ROW_COUNT=1048576,$=O.MAX_COLUMN_COUNT=16384,ee=I._Types._inherit,te=I._DateTimeHelper,ne=I._StringHelper,re=function(){return I._getResource(O.SR)()},oe=["o","n","s","b","d"],ie=O._createRange=function(e,t,n,r){return{row:e,col:t,rowCount:n,colCount:r}},ae=null,se=void 0,le=Math.abs;Math.min,Math.max;O.BangSource={},O.RefErrorSource={},O.supportRowColumnFormula=!1;var ue=I._addElements,ce=I._deleteElements,fe=function(){function e(t){var n=e._parseCore(t);if(!n)throw re().Exp_NotSupported;this._error=n.error,this._code=n.code}return e.prototype.toString=function(){return this._error},e.prototype.toJSON=function(){return{_calcError:this._error,_code:this._code}},e.parse=function(t){try{return new e(t)}catch(e){return se}},e._parseCore=function(e){if(e)for(var t=0;t<G.length;t++){var n=G[t];if(n===e||n===r(e))return{error:n,code:K[t]}}return se},e}();O.CalcError=fe;var de=O.Errors={};de.Null=new fe(V,0),de.DivideByZero=new fe(j,7);var pe=de.Value=new fe(B,15),he=de.Reference=new fe(U,23),me=de.Name=new fe(W,29),ge=de.NotAvailable=new fe(z,42),_e=de.Number=new fe(Y,36),ve=O._createCellIdentity=function(e,t){return{row:e,col:t}},ye=O._createRangeIdentity=function(e,t,n,r){return{row:e,col:t,rowCount:n,colCount:r}},be=O._createCellExpression=function(e,t,n,r,o,i){var a=new xe(1);return a.row=n,a.column=r,a.rowRelative=o,a.columnRelative=i,a._isCell=!0,e&&(a.source=e),t&&(a.endSource=t),a},we=O._createRangeExpression=function(e,t,n,r,o,i,a,s,l,u){var c,f=new xe(1);return f.isFullRow=r===Z,f.isFullColumn=n===Z,n>o&&(c=n,n=o,o=c,c=a,a=l,l=c),r>i&&(c=r,r=i,i=c,c=s,s=u,u=c),f.row=n,f.column=r,f.endRow=o,f.endColumn=i,f.rowRelative=a,f.columnRelative=s,f.endRowRelative=l,f.endColumnRelative=u,e&&(f.source=e),t&&(f.endSource=t),f},Ce=O.CalcArray=function(e){this.array=e};Ce.prototype={getRowCount:function(){return this.array.length},getColumnCount:function(){return this.array[0].length},getValue:function(e,t){var n=this.array;return e.row!==se&&(e=e.row,t=e.column),e<0||t<0||e>=n.length||t>=n[0].length?pe:this.array[e][t]},getValueByIndex:function(e){var t=this.getColumnCount(),n=Math.floor(e/t),r=e%t;return this.getValue(n,r)},toArray:function(e,t,n,r,o){var i,a,s=this,l=1,u=1,f=[],d=c.CalcConvertedError;t=t===se||t,l=s.getRowCount(),u=s.getColumnCount();for(var p=0;p<l;p++){t||(a=[],f.push(a));for(var h=0;h<u;h++){if(i=s.getValue(p,h),n&&c._isError(i))return f=[i],f.isError=!0,f;if(i=c._convertValue(i,e,!1,o),r&&i===d)return f=[i],f.isError=!0,f;t?f.push(i):a.push(i)}}return f.rowCount=l,f.colCount=u,f.rangeCount=1,f}};var Se=O.CalcReference=function(e,t){var n=this;n._source=e,t?(n._identities=t,n._rangeCount=t.length):n._rangeCount=1};Se.prototype={getRangeCount:function(){return this._rangeCount},getRow:function(e){return this._identities?this._identities[e||0].row:0},getColumn:function(e){return this._identities?this._identities[e||0].col:0},getRowCount:function(e){return this._identities?this._identities[e||0].rowCount:this._source.getRowCount()},getColumnCount:function(e){return this._identities?this._identities[e||0].colCount:this._source.getColumnCount()},getValue:function(e,t){var n,r;if(e.row!==se?(n=e.row,r=e.col):(n=arguments[1],r=arguments[2],t=arguments[0]),t=t||0,n>=0||r>=0){var o=this._identities;if(!o)return this._source.getValue(n,r);if(t<o.length)return this._source.getValue(n+o[t].row,r+o[t].col)}return he},getValueByIndex:function(e){var t=this.getColumnCount(),n=Math.floor(e/t),r=e%t;return this.getValue(n,r)},isHiddenRow:function(e,t,n){return this._source.isHiddenRow(t+this.getRow(e),n)},isSubtotal:function(e,t,n){var r=this._source;if(0===e&&t<r.getRowCount()&&n<r.getColumnCount()){var o=r.getCalcSourceModel().getExpression(t,n);return o&&7===o.type&&"SUBTOTAL"===o.functionName}return!1},getSource:function(){return this._source},create:function(e){return new Se(this._source,e)},toArray:function(e,t,n,r,o){return this._source.referenceToArray(this,e,t,n,r,o)}};var xe=(O.ExpressionType={unknow:0,reference:1,number:2,string:3,boolean:4,error:5,array:6,function:7,name:8,operator:9,parentheses:10,missingArgument:11,expand:12,structReference:13},O.Expression=function(){function e(e){var t=this;t.type=e,1===e&&(t._getRangeType=function(){var e=this;return e.isFullRow&&e.isFullColumn?3:e.isFullRow?1:e.isFullColumn?2:0},t.getRange=function(e,n){return Te(t,e,n)},t.offset=function(e,t,n){var r=this;if(r._isCell)return be(r.source,r.endSource,r.row+(r.rowRelative||n?e:0),r.column+(r.columnRelative||n?t:0),r.rowRelative,r.columnRelative);var o=we(r.source,r.endSource,r.row+(r.rowRelative||n?e:0),r.column+(r.columnRelative||n?t:0),r.endRow+(r.isFullColumn||!r.endRowRelative&&!n?0:e),r.endColumn+(r.isFullRow||!r.endColumnRelative&&!n?0:t),r.rowRelative,r.columnRelative,r.endRowRelative,r.endColumnRelative);return o.isFullRow=r.isFullRow,o.isFullColumn=r.isFullColumn,o},t.offset2=function(e,t,n,r){var o=this,i=we(o.source,o.endSource,o.row+(o.isFullColumn?0:e),o.column+(o.isFullRow?0:t),o.endRow+(o.isFullColumn?0:n),o.endColumn+(o.isFullRow?0:r),o.rowRelative,o.columnRelative,o.endRowRelative,o.endColumnRelative);return i.isFullRow=o.isFullRow,i.isFullColumn=o.isFullColumn,i})}return e.prototype.offset=function(e,t,n){var r=this,o=r.type;if(10===o)return Ue(r.value.offset(e,t,n));if(7===o){for(var i=r.arguments,a=[],s=0;s<i.length;s++)a.push(i[s].offset(e,t,n));return je(r.function,a)}return 9===o?Be(r.operatorType,r.value.offset(e,t,n),r.value2&&r.value2.offset(e,t,n)):this},e}()),Te=O.getRangeForReference=function(e,t,n){var r,o,i,a,s={row:-1,col:-1,rowCount:-1,colCount:-1};return e.isFullRow?(s.col=-1,s.colCount=-1):(e.columnRelative?(i=e.column+n,i=i>=$?i%$:i):i=e.column,e._isCell?(s.col=i,s.colCount=1):(e.endColumnRelative?(a=e.endColumn+n,a=a>=$?a%$:a):a=e.endColumn,s.col=i<=a?i:a,s.colCount=le(a-i)+1)),e.isFullColumn?(s.row=-1,s.rowCount=-1):(e.rowRelative?(r=e.row+t,r=r>=Q?r%Q:r):r=e.row,e._isCell?(s.row=r,s.rowCount=1):(e.endRowRelative?(o=e.endRow+t,o=o>=Q?o%Q:o):o=e.endRow,s.row=r<=o?r:o,s.rowCount=le(o-r)+1)),s};(O.CalcSource=function(){function e(t){this.id=e.sourceId++,this._service=t,this._calcSourceModel=null}return e.sourceId=1,e}()).prototype={getCalcService:function(){return this._service},_getCalcServiceInternal:function(){return this._service},setCalcService:function(e){this._service=e},getCalcSourceModel:function(){return this._calcSourceModel},setCalcSourceModel:function(e){this._calcSourceModel=e},getValue:function(e,t){return ae},getName:function(){return""},setValue:function(e,t){},getReference:function(e){return new Se(this,e)},getSources:function(e){return[this]},referenceToArray:function(e,t,n,r,o,i){var a,s,l,u,f,d,p,h=this,m=1,g=1,_=[];if(0===(f=e.getRangeCount()))return _.isError=!0,[];var v=h.getRowCount(),y=h.getColumnCount();n=n===se||n;for(var b=0;b<f;b++){if(n||(p=[],_.push(p)),0===(m=e.getRowCount(b)))return _.isError=!0,[];if(0===(g=e.getColumnCount(b)))return _.isError=!0,[];l=e.getRow(b),u=e.getColumn(b),m=Math.min(l+m,v)-l,g=Math.min(u+g,y)-u;for(var w,C=0;C<m;C++){a=l+C,n||(w=[],p.push(w));for(var S=0;S<g;S++){if(s=u+S,d=h.getValue(a,s),r&&c._isError(d))return _=[d],_.isError=!0,_;if(d=c.convertValue(d,t,!0,i),o&&d===c.CalcConvertedError)return _=[pe],_.isError=!0,_;d===ae&&i||(n?_.push(d):w.push(d))}}}return n||1!==f||(_=_[0]),_.rowCount=m,_.colCount=g,_.rangeCount=f,_},getSheetReference:function(){var e=this;return e._reference=e._reference||new Se(e),e._reference},setFormula:function(e,t){},setArrayFormula:function(e,t){},getRowCount:function(){return 1e3},getColumnCount:function(){return 100},isHiddenRow:function(e,t){return!1},getParserContext:function(e,t,n){return new O.ParserContext(this,e,t,n)},startCalculation:function(){},endCalculation:function(){},getEvaluatorContext:function(e,t,n){return new O.EvaluateContext(this,e,t,n)},getCustomFunction:function(e){return ae},getCustomName:function(e){return ae},refresh:function(){},toJSON:function(e,t){}};var Ee=O.CalcSourceModel=function(){function e(e,t){var n=this;n._lastNonNullRow=0,n._lastNonNullColumn=0,n._volatitleCells=[],n.dataTable={},n.dataTableByName={},n._rowDataArray=[],n._columnDataArray=[],n._defaultDataNode=ae,n._source=t,n._service=e,n._removedVolatileCount=0}return e}();Ee.prototype={getNode:function(e,t,n){var r=this,o=ae;if(e>=0&&t>=0){var i=r.dataTable[e];n&&!i&&(i=r.dataTable[e]={},e>r._lastNonNullRow&&(r._lastNonNullRow=e)),i&&(o=i[t],n&&!o&&(o=i[t]={},t>r._lastNonNullColumn&&(r._lastNonNullColumn=t)))}else-1===e&&t>=0?(o=r._columnDataArray[t],n&&!o&&(o=r._columnDataArray[t]={},t>r._lastNonNullColumn&&(r._lastNonNullColumn=t))):e>=0&&-1===t?(o=r._rowDataArray[e],n&&!o&&(o=r._rowDataArray[e]={},t>r._lastNonNullColumn&&(r._lastNonNullColumn=t))):-1===e&&-1===t&&(o=r._defaultDataNode,n&&!o&&(o=r._defaultDataNode={}));return o},getNodeByName:function(e,t){var n=this,r=n.dataTableByName[e];return t&&!r&&(r=n.dataTableByName[e]={}),r},_getExpr:function(e,t){var n=this.getNode(e,t);return n&&n._expr},_getWorkingExpr:function(e,t){var n=this.getNode(e,t);return n&&n._workingExpr},getExpr:function(e,t){return this._getExpr(e,t)},getArray:function(e,t){return this.__getArrayInfo(e,t)},__getArrayInfo:function(e,t){var n=this.getNode(e,t);return n&&n._arrayInfo},_getArrayInfo:function(e,t){var n=this.getWorkingNode(e,t);return n&&n._arrayInfo},getWorkingExpression:function(e,t){var n=this.getWorkingNode(e,t);return n&&n._workingExpr},getExpression:function(e,t){var n=this.getWorkingNode(e,t);return n&&n._expr},getWorkingExpressionByName:function(e){var t=this.getNodeByName(e);return t&&t._workingExpr},getExpressionByName:function(e){var t=this.getNodeByName(e);return t&&t._expr},clearAll:function(){var e=this;e.clear(-1,-1,-1,-1),e.dataTable={},e.dataTableByName={},e._rowDataArray=[],e._columnDataArray=[],e._defaultDataNode=ae},clear:function(e,t,n,r){this._clear(e,t,n,r)},addRows:function(e,t){var n=this,r=n.rC();if(!(e<0||e>r||t<0)){ue(n.dataTable,r,e,t),ue(n._rowDataArray,r,e,t);for(var o=0;o<t;o++)n.dataTable[e+o]&&(n.dataTable[e+o]={rs:"n"})}},deleteRows:function(e,t){var n=this,r=n.rC();e<0||e>=r||t<=0||(e+t>r&&(t=r-e),ce(n.dataTable,r,e,t),ce(n._rowDataArray,r,e,t))},addColumns:function(e,t){var n=this,r=n.rC(),o=n.cC();if(!(e<0||e>o||t<0)){for(var i=0;i<r;i++){var a=n.dataTable[i];a&&e<o&&ue(a,o,e,t)}ue(this._columnDataArray,o,e,t)}},deleteColumns:function(e,t){var n=this,r=n.rC(),o=n.cC();if(!(e<0||e>=o||t<0)){for(var i=0;i<r;i++){var a=this.dataTable[i];a&&e<o&&ce(a,o,e,t)}ce(this._columnDataArray,o,e,t)}},_setExpr:function(e,t,n){var r=this.getNode(e,t,!!n);r&&(r._expr=n)},_clearAllExpr:function(e,t){var n=this.getNode(e,t,!0);n&&(n._expr=se,n._workingExpr&&(n._workingExpr=se),n._arrayInfo&&(n._arrayInfo=se),n.isVolatile&&this._removeVolatile(n))},_copyExpr:function(e,t,n,r,o){var i=this.getNode(t,n);if(i&&i._expr){var a=e.getNode(r,o,!0);i._arrayInfo&&(a._arrayInfo=ie(r,o,i._arrayInfo.rowCount-(t-i._arrayInfo.row),i._arrayInfo.colCount-(n-i._arrayInfo.col))),a._expr=i._expr,i._workingExpr&&(a._workingExpr=i._workingExpr)}i&&i.isVolatile&&(a.isVolatile=!0)},_containsNode:function(e,t){var n=this.dataTable[e];return n&&n[t]},_setWorkingExpr:function(e,t,n){var r=this.getNode(e,t,!!n);r&&(r._workingExpr=n)},_setArrayInfo:function(e,t,n){var r=this.getNode(e,t,!!n);r&&(r._arrayInfo=n)},_getCalc:function(e,t){var n=this.getNode(e,t);return n&&n.calc},_setCalc:function(e,t,n){var r=this.getNode(e,t,!0);r&&(r.calc&&r.calc.isVolatile&&this._removeVolatile(r),r.calc=n,n&&(n.node=r))},_removeCalc:function(e,t,n){var r=this.getNode(e,t,!0);r&&r.calc&&(r.calc.isVolatile&&this._removeVolatile(r),this._service._removeDirty(r.calc,n),r.calc=se)},_setNode4Swap:function(e,t,n,r,o){var i=this;if(n>=0&&r>=0){var a=i.dataTable[n];a||(a=i.dataTable[n]={}),a[r]=o,o&&o.calc&&delete o.calc}else n>=0&&-1===r&&e>=0&&-1===t?i._rowDataArray[n]=o:r>=0&&-1===n&&t>=0&&-1===e&&(i._columnDataArray[r]=o)},_swapNode:function(e,t,n,r){var o=this,i=o.getNode(e,t),a=o.getNode(n,r);i?o._setNode4Swap(e,t,n,r,i):a&&o._setNode4Swap(e,t,n,r,ae),a?o._setNode4Swap(n,r,e,t,a):i&&o._setNode4Swap(n,r,e,t,ae)},_getAllVolatitles:function(){return this._volatitleCells},_setVolatile:function(e){e.isVolatile||(e.isVolatile=!0,this._volatitleCells.push(e))},_removeVolatile:function(e){e.isVolatile=void 0;var t=this;if(++t._removedVolatileCount>100){t._removedVolatileCount=0;for(var n=[],r=t._volatitleCells,o=0;o<length;o++)r[o].isVolatile&&n.push(r[o]);t._volatitleCells=n}},_clearCore:function(e,t){for(var n=0;n<e.length;n++){var r=e[n];r&&(1&t)>0&&(r._arrayInfo&&(r._arrayInfo=se),r._expr&&(r._expr=se),r._workingExpr&&(r._workingExpr=se))}},getCalcService:function(){return this._service},setCalcService:function(e){this._service=e},_getCalcServiceInternal:function(){return this._service},getSource:function(){return this._source},hasFormula:function(e,t){return e=e!==se?e:-1,t=t!==se?t:-1,!!this.getExpression(e,t)},setFormula:function(e,t,n,r,o,i){var a=this;n&&0===n.length&&(n=ae),!o&&a._intersectWithArrayFormula(e,t,1,1)&&a._throwArrayPartException();var s=a.getFormula(e,t);if(i||s!==n&&(""!==s||n)&&(s||""!==n)){var l=a._getCalcServiceInternal(),u=ae;if(l)try{u=r||(n?l.parse(a._source,n,e>=0?e:0,t>=0?t:0,!1,o,o):ae),a._setExpression(e,t,u,se,!1)}catch(e){if(!o)throw e}e>=0&&t>=0&&a._source.setFormula(e,t,n)}},getFormula:function(e,t,n){var r=this._getCalcServiceInternal();if(r){var o=this.getExpression(e,t);if(o){var i=this._getArrayInfo(e,t);return e=i?i.row:e,t=i?i.col:t,r.unparse(this._source,o,e,t,n)}}return ae},setFormulaByName:function(e,t,n){if(e){e=r(e);var o=this;t&&0===t.length&&(t=ae);var i=o.getFormulaByName(e);if(i!==t&&(""!==i||t)&&(i||""!==t)){var a=o._getCalcServiceInternal(),s=ae;if(a)try{s=t?a.parse(o._source,t,0,0,!1,n):ae,o._setExpressionByName(e,s,se,!1)}catch(e){if(!n)throw e}o._source.setFormula({name:e},t)}}},getFormulaByName:function(e){var t=this._getCalcServiceInternal();if(t&&e){var n=this.getExpressionByName(r(e));if(n)return t.unparse(this._source,n,0,0)}return ae},_throwArrayPartException:function(){throw re().Exp_ArrayFromulaPart},rC:function(){return Math.min(this._source.getRowCount())},cC:function(){return Math.min(this._source.getColumnCount())},setArrayFormula:function(e,t,n,r,o,i){var a=this;o&&0===o.length&&(o=ae),a._intersectWithArrayFormula(e,t,n,r)&&a._throwArrayPartException(),e=e<0?0:e,t=t<0?0:t;var s=a._getCalcServiceInternal();if(s&&(a._clear(e,t,n,r),o)){try{var l=o?s.parse(a._source,o,e,t,!1,i,i):ae}catch(e){if(!i)throw e;return}for(var u=e;u<e+n;u++)for(var c=t;c<t+r;c++)a._setExpression(u,c,l,ie(e,t,n,r),!1);e>=0&&t>=0&&a._source.setArrayFormula(e,t,n,r,s.unparse(a._source,l,e,t))}},getWorkingNode:function(e,t){var n,r=this,o=r._source;return e>=o.getRowCount()||t>=o.getColumnCount()?n:(e>=0&&t>=0?(n=r.getNode(e,t),n||(n=r.getNode(e,-1)),n||(n=r.getNode(-1,t))):n=e>=0&&-1===t?r.getNode(e,-1):-1===e&&t>=0?r.getNode(-1,t):r.getNode(-1,-1),n)},_setExpression:function(e,t,n,r,o){var i=this,a=i._getCalcServiceInternal();a._evaluator.asyncManager.endCalcCell();var s=r!==se&&null!==r,l=new O.EvaluateContext(i._source,ve(s?r.row:e,s?r.col:t),s),u=We(l,n,s,s?e-r.row:0,s?t-r.col:0);u=u===n?se:u;var c;if(r!==se&&(c=r),e>=0&&t>=0){if(o===se||o){var f=n?a.unparse(i._source,n,e>=0?e:0,t>=0?t:0):se;i._source.setFormula(e,t,f)}i._setCellExpression(e,t,n,u,c)}else e>=0&&-1===t?i._setRowExpression(e,n,u):-1===e&&t>=0&&i._setColumnExpression(t,n,u);a.autoCalculation&&!a.IsSuspended()&&a.recalculateAll(!1)},_setExpressionByName:function(e,t,n,r){var o=this,i=o._getCalcServiceInternal(),a=new O.EvaluateContext(o._source,ve(0,0),!1),s=We(a,t,!1,0,0);if(s=s===t?se:s,r===se||r){var l=t?i.unparse(o._source,t,0,0):se;o._source.setFormulaByName(e,l)}o._setNameExpression(e,t,s),i.autoCalculation&&!i.IsSuspended()&&i.recalculateAll(!1)},getRowExpression:function(e){return this.getExpression(e,-1)},getColumnExpression:function(e){return this.getExpression(-1,e)},_setNameExpression:function(e,t,n){var r=this,o=r._getNameIDCalc(e,!0);if(o){o._stopListening();var i=this.getNodeByName(e,!0);i._expr=t,n=t&&n?n:void 0,i._workingExpr=n,o._startListening(),r._service._addDirty(o,3)}},_setCellExpression:function(e,t,n,r,o){var i,a=this;(i=a._getCellCalc(e,t,!0))&&(i._stopListening(),a._setExpr(e,t,n),n?((r||a._getWorkingExpr(e,t))&&a._setWorkingExpr(e,t,r),(o||a._getArrayInfo(e,t))&&a._setArrayInfo(e,t,o)):(a._setWorkingExpr(e,t,se),a._setArrayInfo(e,t,se)),i._startListening(),a._service._addDirty(i,0))},_setRowExpression:function(e,t,n){var r=this,o=r._getRowCalc(e,!0);o&&(o._stopListening(),r._setExpr(e,-1,t),(n||r._getWorkingExpr(e,-1))&&r._setWorkingExpr(e,-1,n),o._startListening(),r._service._addDirty(o,1))},_setColumnExpression:function(e,t,n){var r=this,o=r._getColumnCalc(e,!0);o&&(o._stopListening(),r._setExpr(-1,e,t),(n||r._getWorkingExpr(-1,e))&&r._setWorkingExpr(-1,e,n),o._startListening(),r._service._addDirty(o,2))},_clear:function(e,t,n,r){for(var o,i,a,s=this,l=e<0?0:e,u=t<0?0:t,c=e<0?s.rC():n,f=t<0?s.cC():r,d=l+c-1,p=u+f-1,h=function(e,t){if(o=s._getWorkingExpr(e,t),i=s._getExpr(e,t),o||i){a=s.__getArrayInfo(e,t);var n=a?ie(a.row,a.col,a.rowCount,a.colCount):se;s._setExpression(e,t,ae,n,!0)}},m=l;m<=d&&m>=0;m++){t<0&&h(m,-1);for(var g=u;g<=p&&g>=0;g++)m===l&&e<0&&h(-1,g),h(m,g)}e<0&&t<0&&h(e,t)},_intersectWithArrayFormula:function(e,t,n,r){return this._getFormulaExps(e,t,n,r,!0,!0)},_getFormulaExps:function(e,t,n,r,o,i){for(var a,s,l=this,u=e<0?0:e,c=t<0?0:t,f=e<0?l.rC():n,d=t<0?l.cC():r,p=u+(0===f?1:f)-1,h=c+(0===d?1:d)-1,m=!1,g=[],_=[],v=l.dataTable,y=u;y<=p&&y>=0&&!(y>l._lastNonNullRow);y++)if(s=v[y])for(var b=c;b<=h&&b>=0&&!(b>l._lastNonNullColumn);b++)if(a=s[b]){var w,C=a._arrayInfo;if(C){if(C.row<u||C.row+C.rowCount-1>p||C.col<c||C.col+C.colCount-1>h){if(o)return!0;m=!0}if(y!==C.row&&y!==u)continue;g.push(ie(C.row,C.col,C.rowCount,C.colCount)),w=a._expr,_.push(w),b=C.col+C.colCount-1}else!i&&(w=a._expr)&&(g.push({row:y,col:b}),_.push(w))}return!o&&{hasPart:m,ranges:g,formulas:_}},_getNameIDCalc:function(e,t){var n=this,r=ae,o=n.getNodeByName(e,t);return o&&!(r=o.calc)&&t&&(r=new Le(n,e),o.calc=r,r.node=o),r},_getCellCalc:function(e,t,n){var r=this,o=ae;if(e>=0&&t>=0){var i=r.dataTable,a=i[e];if(!a){if(!n)return o;a=i[e]={},e>r._lastNonNullRow&&(r._lastNonNullRow=e)}var s=a[t];if(!s)return n&&(s=a[t]={},o=new De(r,e,t),s.calc=o,o.node=s,t>r._lastNonNullColumn&&(r._lastNonNullColumn=t)),o;o=s.calc,!o&&n&&(o=new De(r,e,t),s.calc=o,o.node=s,e>r._lastNonNullRow&&(r._lastNonNullRow=e),t>r._lastNonNullColumn&&(r._lastNonNullColumn=t))}return o},_getRowCalc:function(e,t){var n=this,r=ae;return e>=0&&!(r=n._getCalc(e,-1))&&t&&(r=new Pe(n,e),n._setCalc(e,-1,r),e>n._lastNonNullRow&&(n._lastNonNullRow=e)),r},_getColumnCalc:function(e,t){var n=this,r=ae;return e>=0&&!(r=n._getCalc(-1,e))&&t&&(r=new Ne(n,e),n._setCalc(-1,e,r),e>n._lastNonNullColumn&&(n._lastNonNullColumn=e)),r},_getRangeCalc:function(e){var t=this;return!t._rangeCalc&&e&&(t._rangeCalc=new He(t)),t._rangeCalc},_getNameCalc:function(e,t){var n=this,r=ae;return n._nameCalcs||(n._nameCalcs={}),r=n._nameCalcs[e],!r&&t&&(r=n._nameCalcs[e]=new Fe(n,e)),r},_addColumnsToDirty:function(e,t){for(var n=this,r=Math.min(n._lastNonNullColumn,e+t-1),o=e;-1!==o&&o<=r;o++)if(n.isDirty(-1,o)){var i=n._getColumnCalc(o,!0);n._service._addDirty(i,2)}},_addRowsToDirty:function(e,t){for(var n=this,r=Math.min(n._lastNonNullRow,e+t-1),o=e;-1!==o&&o<=r;o++)if(n.isDirty(o,-1)){var i=n._getRowCalc(o,!0);n._service._addDirty(i,1)}},_addCellsToDirty:function(e,t,n,r){for(var o=this,i=Math.min(o._lastNonNullRow,e+n-1),a=Math.min(o._lastNonNullColumn,t+r-1),s=e;s<=i;s++)for(var l=t;l<=a;l++)if(o._containsNode(s,l)){var u=o._getCellCalc(s,l,!0);o._service._addDirty(u,0)}o._addRowsToDirty(e,n),o._addColumnsToDirty(t,r);var c=o._getRangeCalc(!1);c&&c._addListenersToDirty(e,t,n,r)},_addVolatitlesToDirty:function(){for(var e,t,n=this,r=n._getAllVolatitles(),o=0;o<r.length;o++){var i=r[o];if(i&&i.isVolatile&&i instanceof De&&!n._service._isDirtyCell(i)){var a=n._getCellCalc(i.row,i.column,!0);n._service._addDirty(a,0),e=n._getRowCalc(i.row,!1),e&&!n._service._isDirtyRow(e)&&n._addRowsToDirty(i.row,1),t=n._getColumnCalc(i.column,!1),t&&!n._service._isDirtyRow(t)&&n._addColumnsToDirty(i.column,1)}}},_checkAndUpdateVolatitles:function(){for(var e,t,n=this,r=n._getAllVolatitles(),o=!0,i=5;o&&i;){o=!1,i--;for(var a=0;a<r.length;a++){var s=r[a];if(s&&s.isVolatile&&s instanceof De&&!n._service._isDirtyCell(s)&&n.recalculateCell(s.row,s.column)){o=!0;var l=n._getCellCalc(s.row,s.column,!0);n._service._addDirty(l,0),e=n._getRowCalc(s.row,!1),e&&!n._service._isDirtyRow(e)&&n._addRowsToDirty(s.row,1),t=n._getColumnCalc(s.column,!1),t&&!n._service._isDirtyRow(t)&&n._addColumnsToDirty(s.column,1)}}o&&n._service._recalculateImp(!0)}},isDirty:function(e,t){return!(!this._getCalc(e,t)&&!this._getExpr(e,t))},recalculateCell:function(e,t){var n=this,r=n._source,o=n.getWorkingExpression(e,t)||n.getExpression(e,t);if(o){var i,a,s,l,u=ve(e,t),c=r.getValue(e,t),f=!1,d=n._getArrayInfo(e,t);d&&(f=!0,i=d.row,a=d.col,s=d.rowCount,l=d.colCount),this._service._evaluator.asyncManager.startCalcCell(this._source,u);var p=n._service._evaluateParsedFormula(n._source,o,u,f,!0,d&&ye(i,a,s,l));if(!sheet.getFormatter(e,t)){for(var h=n._service._parser.parseToTokens(null,r._sheet.getFormula(e,t).split("")),m=null,g=0,_=h.length;g<_;g++){var v=h[g];if(0===v._type&&0===v._subType){m=v;break}}if(m){for(var y=m._stringValue,b=0,w=0,g=0;g<y.length;g++){var C=y[g].charCodeAt(0);C>=65&&C<=90?w=26*w+C-64:C>=48&&C<=57&&(b=10*b+C-48)}var S=sheet.getFormatter(b-1,w-1);S&&r.setAutoFormat(e,t,S)}}if(c===p)return;return!(c instanceof Date&&p instanceof Date&&c.valueOf()===p.valueOf())&&(r.setValue(e,t,p),this._service._evaluator.asyncManager.endCalcCell(this._source,u),!0)}return!1},recalculateNameID:function(e){var t=this,n=t._source,r=t.getWorkingExpressionByName(e)||t.getExpressionByName(e);if(r){var o=n.getValueByName(e),i=t._service._evaluateParsedFormula(t._source,r,{name:e},!1,!0);if(o===i)return;if(o instanceof Date&&i instanceof Date&&o.valueOf()===i.valueOf())return;n.setValueByName(e,i)}},_dealWithExpression:function(e,t,n,i,a,s){for(var l=this;12===i.type&&i.value;)i=i.value;for(;10===i.type&&i.value;)i=i.value;for(;12===i.type&&i.value;)i=i.value;if(13===i.type){var u=i.getRange(t,n,!0);if(u===ae)return;i=1===u.rowCount&&1===u.colCount?be(ae,ae,u.row,u.col,!1,!1):we(ae,ae,u.row,u.col,u.row+u.rowCount-1,u.col+u.colCount-1,!1,!1,!1,!1)}var c,f,d,p,h,m,g,_,v,y,b,w,C,S,x;if(a&&a!==i&&8===a.type){var T=r(a.value);S=a.source||l._source;var E=S.getCustomName(T);if(E)x=S.getCalcSourceModel();else if(x=l._service.getGlobalSourceModel()||S.getCalcSourceModel(),!(E=x.getSource().getCustomName(T))){var M=S.getCalcSourceModel()._getNameCalc(T,!0);M._processCellListener(e,s)}var A=x._getNameCalc(T,!0);A._processCellListener(e,s),a=null}if(1===i.type&&i.endSource)for(var k=i,R=k.source.getSources(k.endSource),I=0;I<R.length;I++){var O=we(R[I],ae,k.row,k.column,k.endRow,k.endColumn,k.rowRelative,k.columnRelative,k.endRowRelative,k.endColumnRelative);O.isFullRow=k.isFullRow,O.isFullColumn=k.isFullColumn,l._dealWithExpression(e,t,n,O,ae,s)}else if(1===i.type){if(S=i.source||l._source,!(x=S.getCalcSourceModel()))return;var D=i,P=D._getRangeType(),N=Te(i,t,n);if(d=N.row,h=N.col,g=N.rowCount,_=N.colCount,p=d+g-1,m=h+_-1,0===P){if(0<=t&&0<=n)if(o(c,f,g,_)){var F=x._getRangeCalc(!0);F._processCellListener(d,h,g,_,e,s)}else for(w=d;w<=p;w++)for(C=h;C<=m;C++)(v=x._getCellCalc(w,C,!0))&&v._processCellListener(e,s);else if(0<=t&&-1===n){for(w=d;w<=p;w++)for(C=h;C<=m;C++)D.columnRelative||D.endColumnRelative?(y=x._getRowCalc(w,!0))&&y._processRowListener2(e,-C,s):(v=x._getCellCalc(w,C,!0))&&v._processRowListener(e,s);for(w=d;w<=p;w++)for(C=h;C<=m;C++)D.rowRelative||D.endRowRelative?(b=x._getColumnCalc(C,!0))&&b._processColumnListener2(e,-w,s):(v=x._getCellCalc(w,C,!0))&&v._processColumnListener(e,s)}}else if(1===P){if(0<=t&&0<=n)for(w=d;w<=p;w++)(y=x._getRowCalc(w,!0))&&y._processCellListener(e,s);else if(0<=t&&-1===n);else if(-1===t&&0<=n)if(D.rowRelative||D.endRowRelative);else for(d=D.row,p=D.endRow,w=d;w<=p;w++)(y=x._getRowCalc(w,!0))&&y._processColumnListener(e,s)}else if(2===P)if(0<=t&&0<=n)for(C=h;C<=m;C++)(b=x._getColumnCalc(C,!0))&&b._processCellListener(e,s);else if(0<=t&&-1===n);else if(-1===t&&0<=n)for(C=h;C<=m;C++)(b=x._getColumnCalc(C,!0))&&b._processColumnListener(e,s)}else if(9===i.type)l._dealWithExpression(e,t,n,i.value,a&&9===a.type&&a.value,s),i.value2&&l._dealWithExpression(e,t,n,i.value2,a&&9===a.type&&a.value2,s);else if(8===i.type){if(S=i.source||l._source,T=r(i.value),E=S.getCustomName(T),E?x=S.getCalcSourceModel():(x=l._service.getGlobalSourceModel()||S.getCalcSourceModel(),(E=x.getSource().getCustomName(T))||(M=S.getCalcSourceModel()._getNameCalc(T,!0),M._processCellListener(e,s))),!(A=x._getNameCalc(T,!0)))return;A._processCellListener(e,s),l._dealWithExpression(e,t,n,E,ae,s)}else if(7===i.type){var L=i.function;if(L&&(L.isVolatile()&&(s?l._setVolatile(e):l._removeVolatile(e)),!L.precedentReference()))return;var H=i.arguments.length;for(I=0;I<H;I++)l._dealWithExpression(e,t,n,i.arguments[I],a&&7===a.type&&a.arguments[I],s)}else if(25===i.type||26===i.type){var V=i;S=i.source||l._source,x=S.getCalcSourceModel();var j=x._getNameIDCalc(V.value,!0);if(!j)return;j._processCellListener(e,s)}},_dealWithNameIDExpression:function(e,t){var n=this.getNodeByName(e);n&&(n._workingExpr||n._expr)&&this._dealWithExpression(this._getNameIDCalc(e),0,0,n._workingExpr||n._expr,n._expr,t)},_dealWithCellExpression:function(e,t,n,r,o){for(var i,a,s,l=this,u=e+n,c=t+r,f=e;f<u;f++)for(var d=t;d<c;d++)i=l._getWorkingExpr(f,d),a=l._getExpr(f,d),(i||a)&&(s=l.__getArrayInfo(f,d),s?l._dealWithExpression(l._getCellCalc(f,d),s.row,s.col,i||a,a,o):l._dealWithExpression(l._getCellCalc(f,d),f,d,i||a,a,o))},_dealWithColumnExpression:function(e,t,n){for(var r=e+t,o=e;-1!==o&&o<r;o++){var i=this.getColumnExpression(o);i&&this._dealWithExpression(this._getColumnCalc(o,!1),-1,o,i,i,n)}},_linkCellExpression:function(e,t,n,r){this._dealWithCellExpression(e,t,n,r,!0)},_unlinkCellExpression:function(e,t,n,r){this._dealWithCellExpression(e,t,n,r,!1)},_linkRowExpression:function(e,t){},_unlinkRowExpression:function(e,t){},_linkColumnExpression:function(e,t){this._dealWithColumnExpression(e,t,!0)},_unlinkColumnExpression:function(e,t){this._dealWithColumnExpression(e,t,!1)},_iterateEachCell:function(e,t,n,r,o,i){for(var a=e+n,s=t+r,l=e;l<a;l++)for(var u=t;u<s;u++){var c=this._getCellCalc(l,u,!1);c&&(o&&c._addListenersToAdjust(),i&&c._addListenersToDirty())}},_iterateEachRow:function(e,t,n,r){var o=this._rowDataArray;if(o)for(var i=e;-1!==i&&i<e+t&&i<o.length;i++){var a=o[i];if(a&&a.calc){var s=a.calc;n&&s._addListenersToAdjust(),r&&s._addListenersToDirty()}}},_iterateEachColumn:function(e,t,n,r){var o=this._columnDataArray;if(o)for(var i=e;-1!==i&&i<e+t&&i<o.length;i++){var a=o[i];if(a&&a.calc){var s=a.calc;n&&s._addListenersToAdjust(),r&&s._addListenersToDirty()}}},_addDependents:function(e,t,n,r,o,i){if(o||i){var a=this;if(0<=e&&0<=t)a._iterateEachCell(e,t,n,r,o,i),a._iterateEachRow(e,n,o,i),a._iterateEachColumn(t,r,o,i),a._rangeCalc&&(o&&a._rangeCalc._addListenersToAdjust(e,t,n,r),i&&a._rangeCalc._addListenersToDirty(e,t,n,r));else if(0<=e&&-1===t)a._iterateEachCell(e,0,n,a.cC(),o,i),a._iterateEachRow(e,n,o,i),a._rangeCalc&&(o&&a._rangeCalc._addListenersToAdjust(e,t,n,r),i&&a._rangeCalc._addListenersToDirty(e,t,n,r));else if(-1===e&&0<=t)a._iterateEachCell(0,t,a.rC(),r,o,i),a._iterateEachColumn(t,r,o,i),a._rangeCalc&&(o&&a._rangeCalc._addListenersToAdjust(e,t,n,r),i&&a._rangeCalc._addListenersToDirty(e,t,n,r));else if(-1===e&&-1===t){var s=a.rC(),l=a.cC();a._iterateEachCell(0,0,s,l,o,i),a._iterateEachRow(0,s,o,i),a._iterateEachColumn(0,l,o,i),a._rangeCalc&&(o&&a._rangeCalc._addListenersToAdjust(e,t,n,r),i&&a._rangeCalc._addListenersToDirty(e,t,n,r))}}},getAllNodes:function(){var e,t,n=[],r=this.dataTable,o=this._rowDataArray,i=this._columnDataArray,a=this._defaultDataNode;a&&n.push(a);for(t in o)n.push(o[t]);for(t in i)n.push(i[t]);for(var s in r){e=r[s];for(t in e)n.push(e[t])}return n},toJSON:function(e){this._source.toJSON(e,this.dataTable,this._lastNonNullRow,this._lastNonNullColumn)}};var Me="cellListeners",Ae="rowListeners",ke="columnListeners",Re="rowSliceListeners",Ie="columnSliceListeners",Oe=O.BaseCalc=function(){function e(e){this.cellListeners=[],this.rowListeners=[],this.columnListeners=[],this._sourceModel=e}return e}();Oe.prototype={hasListeners:function(){for(var e=this,t=e._listeners,n=0;n<t.length;n++){var r=e[t[n]];if(r&&r.length>0)return!0}return!1},_processCellListener:function(e,t){var n=this.cellListeners;if(t)n.push(e);else for(var r=0;r<n.length;r++)if(n[r]===e)return void n.splice(r,1)},_processRowListener:function(e,t){var n=this.rowListeners;if(t)n.push(e);else for(var r=0;r<n.length;r++)if(n[r]===e)return void n.splice(r,1)},_processColumnListener:function(e,t){var n=this.columnListeners;if(t)n.push(e);else for(var r=0;r<n.length;r++)if(n[r]===e)return void n.splice(r,1)},_addListenersToAdjust:function(){for(var e,t=this._listeners,n=0;n<t.length;n++){var r=this[t[n]];if(r)for(var o=r.length,i=0;i<o;i++)e=r[i],e._addToAdjust()}},_addListenersToDirty:function(){for(var e,t=this._listeners,n=0;n<t.length;n++){var r=this[t[n]];if(r)for(var o=r.length,i=0;i<o;i++)e=r[i],e._preDirty||e._nextDirty||e._addToDirty()}},_adjustDelayOfListeners:function(e){for(var t,n=this._listeners,r=e?1:-1,o=0;o<n.length;o++){var i=this[n[o]];if(i)for(var a=i.length,s=0;s<a;s++)t=i[s],t.delay+=r}},_addToAdjust:function(){},_addToDirty:function(){},_stopListening:function(){},_startListening:function(){}};var De=O.CellCalc=function(e){function t(t,n,r){e.call(this,t);var o=this;o.row=n,o.column=r,o.delay=0,o._listeners=[Me,Ae,ke]}return ee(t,e),t}(Oe);J(De.prototype,{_startListening:function(){var e=this;e._sourceModel._linkCellExpression(e.row,e.column,1,1)},_stopListening:function(){var e=this;e._sourceModel._unlinkCellExpression(e.row,e.column,1,1)},_addToAdjust:function(){this._sourceModel._getCalcServiceInternal()._getOperatorAdjustor()._addAdjust(this,0)},_addToDirty:function(){this._sourceModel._getCalcServiceInternal()._addDirty(this,0)}});var Pe=O.RowCalc=function(e){function t(t,n){e.call(this,t);var r=this;r.row=n,r._listeners=[Me,Ae,Re,ke]}return ee(t,e),t}(Oe);J(Pe.prototype,{incrementDelay2:function(e,t){},decrementDelay2:function(e,t){},_startListening:function(){this._sourceModel._linkRowExpression(this.row,1)},_stopListening:function(){this._sourceModel._unlinkRowExpression(this.row,1)},_processRowListener2:function(e,t,n){n?i(this,Re,{row:e,columnOffset:t,columnCount:1}):a(this,Re,{row:e,columnOffset:t,columnCount:1})},_addToAdjust:function(){this._sourceModel._getCalcServiceInternal()._getOperatorAdjustor()._addAdjust(this,1)},_addToDirty:function(){this._sourceModel._getCalcServiceInternal()._addDirty(this,1)}});var Ne=O.ColumnCalc=function(e){function t(t,n){e.call(this,t);var r=this;r.column=n,r._listeners=[Me,Ae,ke,Ie]}return ee(t,e),t}(Oe);J(Ne.prototype,{incrementDelay2:function(e,t){},decrementDelay2:function(e,t){},_startListening:function(){this._sourceModel._linkColumnExpression(this.column,1)},_stopListening:function(){this._sourceModel._unlinkColumnExpression(this.column,1)},_processColumnListener2:function(e,t,n){this._processColumnListener(e,n)},_addToAdjust:function(){this._sourceModel._getCalcServiceInternal()._getOperatorAdjustor()._addAdjust(this,2)},_addToDirty:function(){this._sourceModel._getCalcServiceInternal()._addDirty(this,2)}});var Fe=O.NameCalc=function(e){function t(t,n){e.call(this,t),this.name=n,this._listeners=[Me,Ae,ke]}return ee(t,e),t}(Oe);J(Fe.prototype,{updateListening:function(e,t){for(var n,r,o=this,i=o._listeners,a=0;a<i.length;a++){var s=o[i[a]];if(s)for(var l=s.length,u=s.slice(),c=0;c<l;c++)n=u[c],r=n.node,n._stopListening(),r&&(!r._arrayInfo||r._arrayInfo.row===n.row&&r._arrayInfo.col===n.column)&&n._sourceModel._setExpression(n.row,n.column,r._expr,r._arrayInfo,!0)}},updateListeningOnRemoved:function(){for(var e,t,n,r,o,i=this,a=i._listeners,s=i._sourceModel,l=s._getCalcServiceInternal(),u=0;u<a.length;u++){var c=i[a[u]];if(c)for(var f=c.length,d=0;d<f;d++){e=c[d],t=e._sourceModel,n=e.row,r=e.col,n=n===se?-1:n,r=r===se?-1:r,o=t.getExpr(n,r);var p=t._getArrayInfo(n,r);if(o){var h=l._getOperatorAdjustor().adjustFormulaOnRemoveName(s,o,i.name);h!==o&&t._setExpression(n,r,h,p,!0)}}}},_addToDirty:function(){for(var e,t=this._listeners,n=0;n<t.length;n++){var r=this[t[n]];if(r)for(var o=r.length,i=0;i<o;i++)e=r[i],e._addToDirty()}}});var Le=O.NameIDCalc=function(e){function t(t,n){e.call(this,t);var r=this;r.name=n,r.delay=0,r._listeners=[Me,Ae,ke]}return ee(t,e),t}(Oe);J(Le.prototype,{_startListening:function(){var e=this;e._sourceModel._dealWithNameIDExpression(e.name,!0)},_stopListening:function(){var e=this;e._sourceModel._dealWithNameIDExpression(e.name,!1)},_addToAdjust:function(){this._sourceModel._getCalcServiceInternal()._getOperatorAdjustor()._addAdjust(this,3)},_addToDirty:function(){this._sourceModel._getCalcServiceInternal()._addDirty(this,3)}});var He=O.RangeCalc=function(){function e(e){this._sourceModel=e,this._listeners=[Me,Ae,ke]}return e}();J(He.prototype,{processListener:function(e,t,n,r,o,i,a){var s,l=this,u=l[e],c=t+","+n+","+r+","+o;if(u||(l[e]=u={}),!(s=u[c])){if(!a)return;s=u[c]=[],s.row=t,s.column=n,s.rowCount=r,s.colCount=o}if(a){for(var f=0;f<s.length;f++)if(s[f]===i)return;s.push(i)}else for(f=0;f<s.length;f++)s[f]===i&&s.splice(f,1)},_processCellListener:function(e,t,n,r,o,i){this.processListener(Me,e,t,n,r,o,i)},_processRowListener:function(e,t,n,r,o,i,a,s,l){this.processListener(Ae,e,t,n,r,o,l)},_processColumnListener:function(e,t,n,r,o,i,a,s,l){this.processListener(ke,e,t,n,r,o,l)},_addListenersToAdjust:function(e,t,n,r){this.visit(0,e,t,n,r)},visit:function(e,t,n,r,o){for(var i,a,s=this._listeners,l=0;l<s.length;l++){var u=this[s[l]];if(u)for(a in u){var c=u[a],f=c.row,d=c.column,p=c.rowCount,h=c.colCount;if((-1===f||-1===t||f<t+r&&t<f+p)&&(-1===d||-1===n||d<n+o&&n<d+h))for(var m=c.length,g=0;g<m;g++)i=c[g],0===e?i._addToAdjust():i._addToDirty()}}},_addListenersToDirty:function(e,t,n,r){this.visit(1,e,t,n,r)},_adjustDelayOfListeners:function(e,t,n){for(var r,o=this._listeners,i=n?1:-1,a=0;a<o.length;a++){var s=this[o[a]];if(s)for(var l in s){var u=s[l];if(r=u,(-1===r.row||r.row<=e&&e<r.row+r.rowCount)&&(-1===r.col||r.col<=t&&t<r.col+r.colCount))for(var c=u.length,f=0;f<c;f++)u[f].delay+=i}}},_startListening:function(){},_stopListening:function(){}}),(O.CalcService=function(){function e(){var e=this;e._sourceModels={},e.autoCalculation=!0,e.maximumIterations=1e3,e.maximumChange=.01,e._parser=new O.Parser,e._evaluator=new O.Evaluator(e),e.useR1C1=!1,e._suspended=0,e._operatorAdjustor=O.CalcOperatorAdjustor&&new O.CalcOperatorAdjustor}return e}()).prototype={dispose:function(){var e=this;e._sourceModels={},e._globalSourceModel=ae},cloneFrom:function(e){var t=this;t.useR1C1=e.useR1C1,t._suspended=e._suspended,t._ignoreDirty=e._ignoreDirty},_getOperatorAdjustor:function(){return this._operatorAdjustor},getSourceModel:function(e){var t=this._sourceModels[e.id];return t||(t=this._sourceModels[e.id]=new Ee(this,e),e.setCalcSourceModel(t),e.setCalcService(this)),t},getGlobalSourceModel:function(e){return!this._globalSourceModel&&e&&(this._globalSourceModel=new Ee(this,e)),this._globalSourceModel},setSourceModel:function(e,t){this._sourceModels[e.id]=t,t.setCalcService(this)},getAllSouceModels:function(){var e=[],t=this._sourceModels;for(var n in t)e.push(t[n]);return e},removeSource:function(e){this._sourceModels[e.id]&&(this._operatorAdjustor._adjustFormulasOnRemoveSheet(e),delete this._sourceModels[e.id])},clearSource:function(){this._sourceModels={},this.clearDirties()},ignoreDirty:function(){return this._ignoreDirty},suspend:function(e){this._suspended++,this._ignoreDirty=!!e||e},resume:function(e){var t=this;t._suspended--,t._suspended<0&&(t._suspended=0),t.IsSuspended()||(t._parseCache=ae,t._ignoreDirty=!1,t.recalculateAll(e))},clearDirties:function(){for(var e,t,n=this,r=[n._head,n._headRows,n._headCols,n._headNamIDs],o=0;o<r.length;o++)for(e=r[o];e;)t=e._nextDirty,t?(e._nextDirty=t._preDirty=se,e=t):e=ae;n._head=n._tail=n._headRows=n._tailRows=n._headCols=n._tailCols=n._headNamIDs=n._tailNameIDs=ae},resumeWithoutCalc:function(){this._suspended=0,this.clearDirties()},IsSuspended:function(){return this._suspended>0},recalculate:function(e,t,n,r){var o=this.getSourceModel(e);-1===n?o._addCellsToDirty(t,0,1,o.cC()):-1===t?o._addCellsToDirty(0,n,o.rC(),1):o._addCellsToDirty(t,n,1,1),this.IsSuspended()||this.recalculateAll(!1,r)},recalculateByName:function(e,t){if(t){var n=this.getSourceModel(e),o=n._getNameIDCalc(r(t),!0);this._addDirty(o,3),this.IsSuspended()||this.recalculateAll(!1)}},recalcRange:function(e,t,n,r,o){var i=this.getSourceModel(e);-1===n?i._addCellsToDirty(t,0,r,i.cC()):-1===t?i._addCellsToDirty(0,n,i.rC(),o):i._addCellsToDirty(t,n,r,o),this.IsSuspended()||this.recalculateAll(!1)},recalculateAll:function(e,t){var n,r=this;if(!r.IsSuspended()){t||r._evaluator.startCache();var o=r._sourceModels;for(var i in o)if(n=o[i],n.getSource().startCalculation(),!1!==e){var a=n.cC(),s=n.rC();n._addColumnsToDirty(0,a),n._addRowsToDirty(0,s),n._addCellsToDirty(0,0,s,a)}else t||n._addVolatitlesToDirty();if(r._recalculateImp(),!t)for(i in o)n=o[i],n._checkAndUpdateVolatitles();for(i in o)n=o[i],n.getSource().endCalculation();t||r._evaluator.endCache()}},_cacheHeadDirtyColumns:function(e,t){for(var n=e.length,r=t;r;)e[n]=r,n++,r=r._nextDirty},_recalculateImp:function(e){void 0===e&&(e=!0);var t,n,r,o,i,a,s,l,u,c,f,d=this,p=ae,h=!1;if(e){var m=[];for(d._headCols&&d._cacheHeadDirtyColumns(m,d._headCols);d._headRows;){for(t=d._headRows._sourceModel,s=t.cC(),r=0;r<s;r++)d._addDirty(t._getCellCalc(d._headRows.row,r,!0),0);d._removeDirty(d._headRows,1)}for(;d._headCols;){if(t=d._headCols._sourceModel,(a=t.rC())>0)for(n=0;n<a;n++)d._addDirty(t._getCellCalc(n,d._headCols.column,!0),0);else d._headCols._addListenersToDirty();d._removeDirty(d._headCols,2)}for(l=d._head;l;l=l._nextDirty){for(t=l._sourceModel,o=l.row,i=l.column,u=t._getRowCalc(o,!1),c=t._getColumnCalc(i,!1),f=t._getRangeCalc(!1),l._addListenersToDirty(),u&&u._addListenersToDirty(),c&&c._addListenersToDirty(),f&&f._addListenersToDirty(o,i,1,1);d._headRows;){for(t=d._headRows._sourceModel,s=t.cC(),r=0;r<s;r++)d._addDirty(t._getCellCalc(d._headRows.row,r,!0),0);d._removeDirty(d._headRows,1)}for(;d._headCols;){for(var g=!1,_=0;_<m.length;_++)if(m[_]===d._headCols){g=!0;break}if(g)d._removeDirty(d._headCols,2);else{for(m[m.length]=d._headCols,t=d._headCols._sourceModel,a=t.rC(),n=0;n<a;n++)d._addDirty(t._getCellCalc(n,d._headCols.column,!0),0);d._removeDirty(d._headCols,2)}}}for(var v=d._headNamIDs;v;v=v._nextDirty)t=v._sourceModel,v._addListenersToDirty()}for(l=d._head;l;l=p){t=l._sourceModel;var y=t.rC(),b=t.cC();p=l._nextDirty,l.row<y&&l.column<b?(O.supportRowColumnFormula&&(c=t._getColumnCalc(l.column,!1))&&(c.delay=0),l.delay=0):d._removeDirty(l,0)}for(v=d._headNamIDs;v;v=v._nextDirty)v.delay=0;for(l=d._head;l;l=l._nextDirty)t=l._sourceModel,n=l.row,r=l.column,u=t._getRowCalc(n,!1),c=t._getColumnCalc(r,!1),f=t._getRangeCalc(!1),l._adjustDelayOfListeners(!0),u&&u._adjustDelayOfListeners(!0),c&&c._adjustDelayOfListeners(!0),f&&f._adjustDelayOfListeners(n,r,!0);for(v=d._headNamIDs;v;v=v._nextDirty)v._adjustDelayOfListeners(!0);do{for(h=!1,l=d._head;l;l=p)if(p=l._nextDirty,0===l.delay){if(t=l._sourceModel,n=l.row,r=l.column,u=t._getRowCalc(n,!1),(c=t._getColumnCalc(r,!1))&&c.delay)continue;f=t._getRangeCalc(!1),t.recalculateCell(n,r),d._removeDirty(l,0),l._adjustDelayOfListeners(!1),u&&u._adjustDelayOfListeners(!1),c&&c._adjustDelayOfListeners(!1),f&&f._adjustDelayOfListeners(n,r,!1),h=!0}for(v=d._headNamIDs;v;v=v._nextDirty)0===v.delay&&(t=v._sourceModel,t.recalculateNameID(v.name),d._removeDirty(v,3),v._adjustDelayOfListeners(!1),h=!0)}while(h);if(d._head){var w=!0;for(var C in d.sourceModeles)d._sourceModels[C].getSource().endCalculation();for(_=0;w&&_<d.maximumIterations;_++)for(w=!1,l=d._head;l;l=p){p=l._nextDirty;var S=l._sourceModel;ve(n,r),n=l.row,r=l.column;var x=S.getSource().getValue(n,r);S.recalculateCell(n,r);var T=S.getSource().getValue(n,r);d._iterationChange(x,T)>=d.maximumChange&&(w=!0)}for(l=d._head;l;l=p)p=l.nextDirty,l._nextDirty=se,p&&(p._preDirty=se);d._head=d._tail=se}},_iterationChange:function(e,t){var n=parseFloat(e),r=parseFloat(t);return le(r-n)},initParserContext:function(e){var t=this._parserContext;t||(this._parserContext=t=e.getParserContext(this.useR1C1))},getParserContext:function(e){var t=this,n=t._parserContext;return n||(e?t._parserContext=n=e.getParserContext(t.useR1C1):n=new O.ParserContext(ae,t.useR1C1,ve(0,0),ae)),n.setSource(e),n},parse:function(e,t,n,r,o,i,a){var s=this,l=s._parseCache,u=s.getParserContext(e);if(u.useR1C1=!a&&s.useR1C1,u.ignoreError=i,u.row=n,u.column=r,u.culture=o,l){u.useR1C1||(u.useR1C1=!0,t=s._parser.a1ToR1C1(u,t));var c=l[t];if(c)return c;var f=s._parser.parse(u,t);return l[t]=f,f}return s._parser.parse(u,t)},unparse:function(e,t,n,r,o,i){var a=this.getParserContext(e);a.useR1C1=this.useR1C1,a.row=n,a.column=r,a.culture=o,i&&(a._toStandard=!0,a.useR1C1=!1);var s=this._parser.unparse(a,t);return a._toStandard=!1,s},_isDirtyCell:function(e){return!!e._preDirty||e===this._head},_addDirty:function(e,t){var n,r,o=this;if(0===t)n=o._head,r=o._tail;else if(1===t)n=o._headRows,r=o._tailRows;else if(2===t)n=o._headCols,r=o._tailCols;else{if(3!==t)return;n=o._headNamIDs,r=o._tailNameIDs}e&&!e._preDirty&&e!==n&&(n?r._nextDirty=e:0===t?o._head=e:1===t?o._headRows=e:2===t?o._headCols=e:o._headNamIDs=e,e._preDirty=r,e._nextDirty=ae,0===t?o._tail=e:1===t?o._tailRows=e:2===t?o._tailCols=e:o._tailNameIDs=e)},_removeDirty:function(e,t){var n,r=this;if(0===t)n=r._head;else if(1===t)n=r._headRows;else if(2===t)n=r._headCols;else{if(3!==t)return;n=r._headNamIDs}if(e&&(e._preDirty||e===n)){var o=e._preDirty,i=e._nextDirty;o?o._nextDirty=i:0===t?r._head=i:1===t?r._headRows=i:2===t?r._headCols=i:r._headNamIDs=i,i?i._preDirty=o:0===t?r._tail=o:1===t?r._tailRows=o:2===t?r._tailCols=o:r._tailNameIDs=o,e._preDirty=ae,e._nextDirty=ae}},_isDirtyRow:function(e){return e._preDirty||e===this._headRows},isDirtyColumn:function(e){return e._preDirty||e===this._headCols},_evaluateParsedFormula:function(e,t,n,r,o,i){var a,s=n.row||0,l=n.col||0,u=i?i.row:s,f=i?i.col:l,d=e.getEvaluatorContext(n,r,i);if(a=this._evaluator.evaluateExpression(t,d,o,4===arguments.length&&r),r&&arguments.length<=5)return a;if(c._isReference(a)){var p=a.getRowCount(0),h=a.getColumnCount(0);if(1!==a.getRangeCount())return pe;try{var m=r?s-u:s-a.getRow(0),g=r?l-f:l-a.getColumn(0),_=ve(0,0);if(1===p&&1===h);else if(1===p&&h>1&&g>=0&&g<h)_.col=g;else if(p>1&&1===h&&m>=0&&m<p)_.row=m;else{if(!(r&&m<p&&g<h))return r?ge:pe;_.row=m,_.col=g}a=a.getValue(_,0)}catch(e){return pe}}else if(c._isArray(a))if(r){var v=a,y=v.getRowCount(),b=v.getColumnCount();if(1!==y&&s-u>=y||1!==b&&l-f>=b)return ge;a=a.getValue(1===y?0:s-u,1===b?0:l-f)}else a=a.getValueByIndex(0);return a===se||a===ae?!1===o?a:0:a},_getParserContext:function(e,t,n){var r=this,o=r._parserContext;return o||(r._parserContext=o=e.getParserContext(r.useR1C1)),o.useR1C1=r.useR1C1,o.row=t,o.column=n,o},evaluate:function(e,t,n,r){var o=this,i=o.parse(e,t,n,r);return o._evaluator.evaluateExpression(i,e.getEvaluatorContext(ve(n,r),!1),!1)}};var Ve=O._createErrorExpression=function(e,t,n){var r=new xe(5);return t&&(r.source=t),n&&(r.endSource=n),r.value=e,r},je=(O._referenceErrorExpr=Ve(he),O._createFunctionExpression=function(e,t){var n=new xe(7);return n.function=e,n.arguments=t,n.functionName=e.name,n}),Be=O._createOperatorExpression=function(e,t,n){var r=new xe(9);return r.operatorType=e,r.value=t,r.value2=n,r},Ue=O._createParenthesesExpression=function(e){var t=new xe(10);return t.value=e,t},We=O._mappingArray=function(e,t,n,r,o){var i=function(e,t,n,r,o){return{expr:e,acceptsArray:t,acceptsRef:n,index:r,context:o}},a=e.row,c=e.column,f=[],d=0,p=e.arrayIdentity?e.arrayIdentity.row:a,h=e.arrayIdentity?e.arrayIdentity.col:c;f[d]={expr:t,acceptsArray:!1,acceptsRef:!1,index:-1};for(var m,g,_,v,y,b=0,w=0,C=!1,S=r,x=o,T=!1;d>=0;){if(m=f[d--],g=m.acceptsArray,_=m.acceptsRef,t=m.expr,v=ae,t){if(7===t.type){var E,M=t,A=M.arguments.length;if(!M.function){if(!e){v=Ve(me);continue}if(!(E=e.getFunction(M.functionName))){v=Ve(me);continue}if(A<E.minArgs||A>E.maxArgs){v=Ve(pe);continue}M.function=E}E=M.function;var k=m.index,R=m.neeedExpendindexs;if(k<0?(m.noExpendCatchValue=T,m.arrayFormulaCatchValue=n,2===E.arrayArgumentEvaluateMode&&(T=!0),1===E.arrayArgumentEvaluateMode&&(n=!0),m.args=[]):(E.acceptsArray(k)?b--:C&&(R||(R=[],m.neeedExpendindexs=R),M.arguments[k],R.push(k)),m.args.push(y)),k===A-1){T=m.noExpendCatchValue,n=m.arrayFormulaCatchValue;var I=m.args,D=!1;if(I&&I.length>0)for(var P=0;P<I.length;P++)if(I[P]!==M.arguments[P]){D=!0;break}v=D?je(M.function,I):t,R&&R.length>0&&(v=s(v,R),C=!0)}else C=!1,k++,m.index=k,E.acceptsArray(k)&&b++,f[++d]=m,f[++d]={expr:M.arguments[k],acceptsArray:E.acceptsArray(k),acceptsRef:E.acceptsReference(k),index:-1}}else if(1===t.type&&t._isCell){if(w&&(t.rowRelative||t.columnRelative)){var N=t.source!==O.BangSource&&t.source||e.source,F=N.getRowCount(),L=N.getColumnCount(),H=t.rowRelative?(t.row+p)%Q%F:t.row,V=t.columnRelative?(t.column+h)%$%L:t.column;H=H<0?H+F:H,V=V<0?V+L:V,t=be(t.source,ae,H,V,!1,!1)}}else if(1===t.type||13===t.type){if(13===t.type){var j=t,B=j.getRange(a,c);if(!B){v=t,y=t;continue}t=we(j.source()===e.source?ae:j.source(),ae,B.row,B.col,B.row+B.rowCount-1,B.col+B.colCount-1)}var U=t.source!==O.BangSource&&t.source,W=t;if(w&&(W.rowRelative||W.columnRelative||W.endRowRelative||W.endColumnRelative)){N=U||e.source,F=N.getRowCount(),L=N.getColumnCount();var z=W.rowRelative?(W.row+p)%F:W.row,Y=W.columnRelative?(W.column+h)%L:W.column,G=W.endRowRelative?(W.endRow+p)%F:W.endRow,K=W.endColumnRelative?(W.endColumn+h)%L:W.endColumn;if(z=z<0?z+F:z,Y=Y<0?Y+L:Y,G=G<0?G+F:G,K=K<0?K+L:K,z>G){var X=z;z=G,G=X}Y>K&&(X=Y,Y=K,K=X),t.row===Z&&(z=G=Z),t.column===Z&&(Y=K=Z),t=we(U,t.endSource,z,Y,G,K,!1,!1,!1,!1)}_&&(g||!n)||a<0||c<0||(b>0&&!n||0===b||T?(B=W.getRange(a,c),n?!W.isFullColumn&&1!==B.rowCount&&S>=B.rowCount||!W.isFullRow&&1!==B.colCount&&x>=B.colCount?v=Ve(ge):(H=(W.isFullColumn?0:B.row)+(1===B.rowCount?0:S),V=(W.isFullRow?0:B.col)+(1===B.colCount?0:x),v=be(U,t.endSource,H,V,!1,!1)):B.rowCount>1&&B.colCount>1||B.rowCount>1&&!W.isFullColumn&&(a<B.row||a>=B.row+B.rowCount)||B.colCount>1&&!W.isFullRow&&(c<B.col||c>=B.col+B.colCount)?v=Ve(pe):(H=W.isFullColumn||B.rowCount>1?a:B.row,V=W.isFullRow||B.colCount>1?c:B.col,v=be(U,t.endSource,H,V,!1,!1))):C=!0)}else if(9===t.type){var q=t.operatorType>=15;-1===m.index?(m.index=t.value2?0:1,f[++d]=m,f[++d]=i(t.value,q,q,-1)):0===m.index?(y!==t.value&&(v=Be(t.operatorType,y,t.value2),m.expr=v),C&&(R=[],R.push(0),m.neeedExpendindexs=R,C=!1),m.index=1,f[++d]=m,f[++d]=i(t.value2,q,q,-1)):(v=t.value2&&y!==t.value2?Be(t.operatorType,t.value,y):t,R=m.neeedExpendindexs,C&&(R||(R=[]),R.push(1)),R&&(v=s(v,R),C=!0))}else if(10===t.type)-1===m.index?(m.index=0,f[++d]=m,f[++d]=i(t.value,g,_,-1)):t.value!==y&&(v=Ue(y));else if(8===t.type)if(1===m.index)w--,v=y,m.context&&(e=m.context);else{w++,f[++d]=i(t,!0,!0,1);var J,ee,te=e;t.source?(ee=t.source===O.BangSource?e.source:t.source,te=new O.EvaluateContext(ee),te.cloneFrom(e),J=ee.getCustomName(t.value)):(J=e.getName(t.value),e.source.getCustomName(t.value)||(te=new O.GloableEvaluateContext(e.source),te.cloneFrom(e))),J||(J=Ve(me)),e=te||e,f[++d]=i(J,!0,!0,-1,e)}else if(6===t.type){var ne=t;if(!g&&(b>0||n))C=!0;else if(!g&&0===b)if(S>=ne.value.RowCount&&ne.value.RowCount>1||x>=ne.value.colCount&&ne.value.colCount>1)v=Ve(ge);else try{1===ne.value.RowCount&&(S=0),1===ne.value.colCount&&(x=0);var re=ne.value.getValue(S,x);"string"==typeof re?v=l(re):"number"==typeof re&&(v=u(re));var oe=new O.Parser;v=oe.parse(e.source.getParserContext(e.useR1C1,ve(0,0)),ne.value.getValue(S,x).toString())}catch(e){v=Ve(ge)}}}else;v===ae?v=t:v!==t&&(D=!0),y=v}return v};c._isNumber=f,c._isError=d,c._isArray=p,c._isReference=h,c._toResult=m,c._toArray=g,c._convertValue=_,c._convertArray=v,c._isNaNOrInfinite=y,c._toInt=b,c._tryToInt=w,c._toDouble=C;var ze={JAN:1,FEB:2,MAR:3,APR:4,MAY:5,JUN:6,JUL:7,AUG:8,SEP:9,OCT:10,NOV:11,DEC:12};c._tryToDouble=S,c._tryToBool=x,c._toBool=T,c._toString=E,c._toDateTime=M,c._tryToDateTime=A,c.CalcConvertedError={},O.Convert=c;var Ye=function(){function e(){}return e._approxEqual=function(e,t){var n=16777216;return e===t||le(e-t)<le(e)/(n*n)},e.getArrayValue=function(e,t,n){return e?t<e.getRowCount()&&n<e.getColumnCount()?e.getValue(t,n):n>=e.getColumnCount()&&1===e.getColumnCount()&&t<e.getRowCount()?e.getValue(t,0):t>=e.getRowCount()&&1===e.getColumnCount()&&n<e.getColumnCount()?e.getValue(0,n):pe:pe},e.tryExtractToSingleValue=function(e){var t=!0;if(h(e)||p(e)){var n=g(e,0,!1,!0);n.isError?e=n[0]:1===n.rowCount&&1===n.colCount?e=n[0][0]:(e=n,t=!1)}return{value:e,success:t}},e}();O._Helper=Ye;var Ge=function(){function e(){}return e.getLength=function(e,t){return p(e)?e.getRowCount()*e.getColumnCount():h(e)?(t=t||0,e.getRowCount(t)*e.getColumnCount(t)):void 0},e.getRowCount=function(e,t){return p(e)?e.getRowCount():h(e)?(t=t||0,e.getRowCount(t)):void 0},e.getColumnCount=function(e,t){return p(e)?e.getColumnCount():h(e)?(t=t||0,e.getColumnCount(t)):void 0},e.getValueByIndex=function(e,t,n){if(p(e))return e.getValueByIndex(t);if(h(e)){n=n||0;var r=e.getColumnCount(n);return e.getValue(n,parseInt(t/r,10),t%r)}},e.getValue=function(e,t,n,r){return p(e)?e.getValue(t,n):h(e)?(r=r||0,e.getValue(r,t,n)):void 0},e}();O.CalcArrayHelper=Ge,function(e){e[e.normal=0]="normal",e[e.allwaysExpand=1]="allwaysExpand",e[e.neverExpand=2]="neverExpand"}(D.ArrayArgumentEvaluateMode||(D.ArrayArgumentEvaluateMode={}));var Ke=function(){function e(e,t,n,r){var o=this,i=arguments.length;o.name=e,o.minArgs=i<2?0:t,o.maxArgs=i<3?0:n,o._description=r,o.typeName=""}return e.prototype={description:function(){var e=this,t=re()._builtInFunctionsResource;return e._description?e._description:t&&t[e.name]},acceptsArray:function(e){return!1},acceptsReference:function(e){return!1},acceptsError:function(e){return!1},acceptsMissingArgument:function(e){return!1},isVolatile:function(){return!1},isContextSensitive:function(){return!1},isBranch:function(){return!1},findTestArgument:function(){return-1},findBranchArgument:function(e){return-1},expandRows:function(){return!0},expandColumns:function(){return!0},precedentReference:function(){return!0},returnReference:function(){return!1},evaluate:function(e){},evaluateWithContext:function(e,t){var n=this,r=t;return n.isContextSensitive()&&(r=t.slice(),r.unshift(e)),n.evaluate.apply(n,r)},toJSON:function(){var e={};for(var t in this)this.hasOwnProperty(t)&&(e[t]=this[t]);return e},fromJSON:function(e){if(e)for(var t in e)e[t]!==se&&(this[t]=e[t])}},e._create=function(e,t,n){var r=new D.Function(e,0,255);if(t&&"function"==typeof t&&(r.evaluate=t),n)for(var o in n)n.hasOwnProperty(o)&&"override"!==o&&(r[o]=n[o]);return r},e}();D.Function=Ke;var Xe=function(e){function t(t,n,r,o){e.call(this,t,n,r,o)}return ee(t,e),t}(Ke);J(Xe.prototype,{isContextSensitive:function(){return!0},evaluate:function(e,t){return this.evaluateAsync.apply(self,arguments)},evaluateAsync:function(e,t){self.evaluate.apply(self,arguments)},defaultValue:function(){return 0},evaluateMode:function(){return 0},evaluateWhenArgumentsIsSame:function(){return!0},interval:function(){return 1e4}}),D.AsyncFunction=Xe,D.AsyncFunctionEvaluateMode={onRecalculation:0,calculateOnce:1,onInterval:2},D._builtInFunctions={},D._customFunctions={},D.defineGlobalCustomFunction=k,D.findGlobalFunction=R,e.exports=O},function(e,t,n){function r(e){var t=e;return function(n){return 0===arguments.length?this._colorList[t]:(this._colorList[e]=s(n),this)}}var o=n(0),i=o._Types._isNullOrUndefined,a=o._ColorHelper,s=a._fromString,l=parseInt,u=n(3),c=n(7),f=u._util._defProperty,d=0,p=1,h=2,m=3,g=4,_=5,v=6,y=7,b=8,w=9,C=10,S=11,x=function(){function e(e,t,n,r,o,i,a,l,u,c,f,d,p){this._name=e,this._colorList=[];for(var h=1;h<13;h++)this._colorList.push(s(arguments[h]))}return e.prototype={constructor:e,name:function(e){return 0===arguments.length?this._name:(this._name=e,this)},background1:r(d),background2:r(p),textColor1:r(h),textColor2:r(m),accent1:r(g),accent2:r(_),accent3:r(v),accent4:r(y),accent5:r(b),accent6:r(w),hyperlink:r(C),followedHyperlink:r(S),getColor:function(e){if(e){var t,n=e.split(" ");if(n){var r=-1,o=n.length;if(o>1){if(!n[0])return e;t=n[0].toLowerCase(),"background"===t?r=l(n[1],10)-1:"text"===t?r=l(n[1],10)+1:"accent"===t&&(r=l(n[1],10)+3)}else 1===o&&(t=n[0].toLowerCase(),"hyperlink"===t?r=C:"followedhyperlink"===t&&(r=S));if(r>=0&&r<=11){if(o>2){var i=l(n[2],10)/100;return a._toString(a._applyTint(this._colorList[r],i))}return a._toString(this._colorList[r])}}}return e},toJSON:function(){var e=this,t=e._colorList;return{name:e._name,background1:t[d],background2:t[p],text1:t[h],text2:t[m],accent1:t[g],accent2:t[_],accent3:t[v],accent4:t[y],accent5:t[b],accent6:t[w],hyperlink:t[C],followedHyperlink:t[S]}},fromJSON:function(e,t){function n(e,t){i(t)||(r._colorList[e]={a:t.a,r:t.r,g:t.g,b:t.b})}if(e){var r=this;if(t){var o=e.name?e.name:e["_name"];i(o)||(r._name=o);var a=e.colorList?e.colorList:e["_colorList"],s=a[d],l=a[p],u=a[h],c=a[m],f=a[g],x=a[_],T=a[v],E=a[y],M=a[b],A=a[w],k=a[C],R=a[S]}else i(e.name)||(r._name=e.name),s=e.background1,l=e.background2,u=e.text1,c=e.text2,f=e.accent1,x=e.accent2,T=e.accent3,E=e.accent4,M=e.accent5,A=e.accent6,k=e.hyperlink,R=e.followedHyperlink;n(d,s),n(p,l),n(h,u),n(m,c),n(g,f),n(_,x),n(v,T),n(y,E),n(b,M),n(w,A),n(C,k),n(S,R)}},_compare:function(e){if(this.name()!==e.name())return!1;for(var t=["textColor1","textColor2","background1","background2","accent1","accent2","accent3","accent4","accent5","accent6","hyperlink","followedHyperlink"],n=0,r=t.length;n<r;n++){var o=t[n];if(!a._compare(this[o](),e[o]()))return!1}return!0}},e}(),T=function(){function e(e,t,n,r){var o=this;o.name(e),o.colors(t||new x(e)),o.headerFont(n),o.bodyFont(r)}return e.prototype={name:f("name"),colors:f("colors"),headerFont:f("headerFont"),bodyFont:f("bodyFont"),getColor:function(e){return this.colors().getColor(e)},getFont:function(e){return"Body"===e?this.bodyFont():"Headings"===e?this.headerFont():e},toJSON:function(){var t=this,n=t.name();return e._isBuiltInTheme(t)?n:{name:n,themeColor:t.colors()?t.colors().toJSON():void 0,headingFont:t.headerFont(),bodyFont:t.bodyFont()}}},e._isBuiltInTheme=function(e){var t=e.name();if(M[t]){var n=M[t];return e.bodyFont()===n.bodyFont()&&e.headerFont()===n.headerFont()&&e.colors()._compare(n.colors())}return!1},e}(),E=function(){function e(){}var t="#000000",n="#FFFFFF";return e.Default=new x("Default",n,"#EEECE1",t,"#1F497D","#4F81BD","#C0504D","#9BBB59","#8064A2","#4BACC6","#F79646","#0000FF","#800080"),e.Office2007=new x("Office2007",n,"#EEECE1",t,"#1F497D","#4F81BD","#C0504D","#9BBB59","#8064A2","#4BACC6","#F79646","#0000FF","#800080"),e.Office=new x("Office",n,"#E7E6E6",t,"#44546A","#5B9BD5","#ED7D31","#A5A5A5","#FFC000","#4472C4","#70AD47","#0563C1","#954F72"),e.Apex=new x("Apex",n,"#C9C2D1",t,"#69676D","#CEB966","#9CB084","#6BB1C9","#6585CF","#7E6BC9","#A379BB","#410082","#932968"),e.Aspect=new x("Aspect",n,"#E3DED1",t,"#323232","#F07F09","#9F2936","#1B587C","#4E8542","#604878","#C19859","#6B9F25","#B26B02"),e.Concourse=new x("Concourse",n,"#DEF5FA",t,"#464646","#2DA2BF","#DA1F28","#EB641B","#39639D","#474B78","#7D3C4A","#FF8119","#44B9E8"),e.Civic=new x("Civic",n,"#C5D1D7",t,"#646B86","#D16349","#CCB400","#8CADAE","#8C7B70","#8FB08C","#D19049","#00A3D6","#694F07"),e.Oriel=new x("Oriel",n,"#FFF39D",t,"#575F6D","#FE8637","#7598D9","#B32C16","#F5CD2D","#AEBAD5","#777C84","#D2611C","#3B435B"),e.Origin=new x("Origin",n,"#DDE9EC",t,"#464653","#727CA3","#9FB8CD","#D2DA7A","#FADA7A","#B88472","#8E736A","#B292CA","#6B5680"),e.Paper=new x("Paper",n,"#FEFAC9",t,"#444D26","#A5B592","#F3A447","#E7BC29","#D092A7","#9C85C0","#809EC2","#8E58B6","#7F6F6F"),e.Solstice=new x("Solstice",n,"#E7DEC9",t,"#4F271C","#3891A7","#FEB80A","#C32D2E","#84AA33","#964305","#475A8D","#8DC765","#AA8A14"),e.Technic=new x("Technic",n,"#D4D2D0",t,"#3B3B3B","#6EA0B0","#CCAF0A","#8D89A4","#748560","#9E9273","#7E848D","#00C8C3","#A116E0"),e.Trek=new x("Trek",n,"#FBEEC9",t,"#4E3B30","#F0A22E","#A5644E","#B58B80","#C3986D","#A19574","#C17529","#AD1F1F","#FFC42F"),e.Urban=new x("Urban",n,"#DEDEDE",t,"#424456","#53548A","#438086","#A04DA3","#C4652D","#8B5D3D","#5C92B5","#67AFBD","#C2A874"),e.Verve=new x("Verve",n,"#D2D2D2",t,"#666666","#FF388C","#E40059","#9C007F","#68007F","#005BD3","#00349E","#17BBFD","#FF79C2"),e.Equity=new x("Equity",n,"#E9E5DC",t,"#696464","#D34817","#9B2D1F","#A28E6A","#956251","#918485","#855D5D","#CC9900","#96A9A9"),e.Flow=new x("Flow",n,"#DBF5F9",t,"#04617B","#0F6FC6","#009DD9","#0BD0D9","#10CF9B","#7CCA62","#A5C249","#E2D700","#85DFD0"),e.Foundry=new x("Foundry",n,"#EAEBDE",t,"#676A55","#72A376","#B0CCB0","#A8CDD7","#C0BEAF","#CEC597","#E8B7B7","#DB5353","#903638"),e.Median=new x("Median",n,"#EBDDC3",t,"#775F55","#94B6D2","#DD8047","#A5AB81","#D8B25C","#7BA79D","#968C8C","#F7B615","#704404"),e.Metro=new x("Metro",n,"#D6ECFF",t,"#4E5B6F","#7FD13B","#EA157A","#FEB80A","#00ADDC","#738AC8","#1AB39F","#EB8803","#5F7791"),e.Module=new x("Module",n,"#D4D4D6",t,"#5A6378","#F0AD00","#60B5CC","#E66C7D","#6BB76D","#E88651","#C64847","#168BBA","#680000"),e.Opulent=new x("Opulent",n,"#F4E7ED",t,"#B13F9A","#B83D68","#AC66BB","#DE6C36","#F9B639","#CF6DA4","#FA8D3D","#FFDE66","#D490C5"),e}(),M={Default:new T("Default",E.Default,"Cambria","Calibri"),Office:new T("Office",E.Office,"Calibri Light",c.FONT_FAMILY),Office2007:new T("Office2007",E.Office2007,"Cambria","Calibri"),Apex:new T("Apex",E.Apex,"Lucida Sans","Book Antiqua"),Aspect:new T("Aspect",E.Aspect,"Verdana","Verdana"),Concourse:new T("Concourse",E.Concourse,"Lucida Sans Unicode","Lucida Sans Unicode"),Civic:new T("Civic",E.Civic,"Georgia","Georgia"),Oriel:new T("Oriel",E.Oriel,"Century Schoolbook","Century Schoolbook"),Origin:new T("Origin",E.Origin,"Bookman Old Style","Gill Sans MT"),Paper:new T("Paper",E.Paper,"Constantia","Constantia"),Solstice:new T("Solstice",E.Solstice,"Gill Sans MT","Gill Sans MT"),Technic:new T("Technic",E.Technic,"Franklin Gothic Book","Arial"),Trek:new T("Trek",E.Trek,"Franklin Gothic Medium","Franklin Gothic Book"),Urban:new T("Urban",E.Urban,"Trebuchet MS","Georgia"),Verve:new T("Verve",E.Verve,"Century Gothic","Century Gothic"),Equity:new T("Equity",E.Equity,"Franklin Gothic Book","Perpetua"),Flow:new T("Flow",E.Flow,"Calibri","Constantia"),Foundry:new T("Foundry",E.Foundry,"Rockwell","Rockwell"),Median:new T("Median",E.Median,"Tw Cen MT","Tw Cen MT"),Metro:new T("Metro",E.Metro,"Consolas","Corbel"),Module:new T("Module",E.Module,"Corbel","Corbel"),Opulent:new T("Opulent",E.Opulent,"Trebuchet MS","Trebuchet MS")};u.ColorScheme=x,u.ThemeColors=E,u.Theme=T,u.Themes=M,e.exports=u},function(e,n,r){function o(){return f._getResource(n.SR)()}function i(e){return e.getActiveSheet()}function a(e,t,n){var r,o,i=P._getCssClassThemeStyle("gc-vertical-scrollbar"+ce),a=j(i.zIndex)>2007?1:0,s=t-n;s%2==0?(r=s/2,o=r-a):(r=(s-a)/2,o=r),p(e).css({"box-sizing":le,border:ae,"border-color":ae,"border-left-style":ue,"border-left-width":a+re,"border-left-color":i.borderLeftColor,"background-color":i.backgroundColor,width:n,padding:"0px "+r+"px 0px "+o+re,margin:0})}function s(e,t,n){var r,o,i=P._getCssClassThemeStyle("gc-horizontal-scrollbar"+ce),a=j(i.zIndex)>2007?1:0,s=t-n;s%2==0?(r=s/2,o=r-a):(r=(s-a)/2,o=r),p(e).css({"box-sizing":le,border:ae,"border-color":ae,"border-top-style":ue,"border-top-width":a+re,"border-top-color":i.borderTopColor,"background-color":i.backgroundColor,height:n,padding:o+"px 0px "+r+"px 0px",margin:0})}function l(e,t,n){var r=P._getCssClassThemeStyle("gc-footer-corner"+ce);p(e).css({border:ae,padding:0,margin:0,width:t+re,height:n+re,"background-color":r.backgroundColor})}function u(e,t){var n=this;n.name="",n._isResizing=!1,n._availableSheetIndex=-1,n._activeSheetIndex=0,n._suspendSetFocus=!1,n.options=H(me,function(e,t,r){n._onOptionChanged(e,t,r)}),n._initOptions(t);var r=1;if(t){var o=t.sheetCount;typeof o===G&&(r=o)}n._host=e,n._init(r,e)}function c(e){this._wb=e}var n=r(2),f=r(0),d=r(40),p=r(4).GC$,h=r(3),m=r(17)._ImageLoader,g=r(47).Commands,_=r(51)._Scrollbar,v=r(52)._SheetTab,y=r(53)._SheetTab2007,b=r(8)._StyleHelper,w=r(45)._ClipboardHelper,C=r(7),S=d.UndoManager,x=d.CommandManager,T=p.each,E=p.extend,M=h._util,A=n._supportsCalc,k=h._DPIHelper,R=h.Events,I=h._DataValidatorCache,O=h._FocusHelper,D=h.Rect,P=h._ThemeStyleHelper,N=f._Types._isNullOrUndefined,F=h._util._createElement,L=h._util._defProperty,H=M._createOptions,V=t,j=parseInt,B=window,U=document,W=null,z=Math.round,Y=Math.min,G="number",K="mousedown",X="mouseup",q="scroll",J="resize",Z="focus",Q=".gcSpread",$=".gcSpreadInternal",ee=".gcScrollbar",te="div",ne="table",re="px",oe="gc-scroll-handle",ie="gc-scroll-bar",ae="none",se="absolute",le="content-box",ue="solid",ce=" ui-widget-header ui-state-default btn btn-default",fe="cultureChanged",de="workbook",pe="gcUIElement",he="gc-no-user-select";n.HorizontalPosition={left:0,center:1,right:2,nearest:3},n.VerticalPosition={top:0,center:1,bottom:2,nearest:3},n.ShowResizeTip={none:0,column:1,row:2,both:3},n.ShowScrollTip={none:0,horizontal:1,vertical:2,both:3},n.AutoFitType={cell:0,cellWithHeader:1},n.InvalidOperationType={setFormula:0,copyPaste:1,dragFill:2,dragDrop:3,changePartOfArrayFormula:4,changeSheetName:5},n.ResizeZeroIndicator={default:0,enhanced:1},n.CopyPasteHeaderOptions={noHeaders:0,rowHeaders:1,columnHeaders:2,allHeaders:3};var me={allowUserDragDrop:!0,allowUserDragFill:!0,allowUserZoom:!0,allowUserResize:!0,allowUndo:!0,allowSheetReorder:!0,defaultDragFillType:5,showDragFillSmartTag:!0,showHorizontalScrollbar:!0,showVerticalScrollbar:!0,scrollbarShowMax:!0,scrollbarMaxAlign:!1,tabStripVisible:!0,tabStripRatio:.5,tabEditable:!0,newTabVisible:!0,cutCopyIndicatorVisible:!0,cutCopyIndicatorBorderColor:"#217346",tabNavigationVisible:!0,backColor:"white",backgroundImage:W,backgroundImageLayout:0,showResizeTip:0,showDragDropTip:!0,showDragFillTip:!0,scrollIgnoreHidden:!1,highlightInvalidData:!1,showScrollTip:0,grayAreaBackColor:W,useTouchLayout:!1,hideSelection:!1,resizeZeroIndicator:1,allowUserEditFormula:!0,enableFormulaTextbox:!0,referenceStyle:0,autoFitType:0,allowCopyPasteExcelStyle:!0,allowExtendPasteRange:!1,copyPasteHeaderOptions:3,font:W};h._defineFeature(u),u._defaultOptions=me,u._defaultSheetCount=1,u._defaultActiveSheetIndex=0,u.prototype={constructor:u,commandManager:function(){return this._commandManager},undoManager:function(){return this._undoManager},_onOptionChanged:function(e,t,n){var r=this,o=i(r);switch(e){case"allowUndo":r._undoManager&&(r._undoManager._allowUndo=t);break;case"backColor":case"cutCopyIndicatorBorderColor":case"cutCopyIndicatorVisible":case"grayAreaBackColor":case"hideSelection":case"highlightInvalidData":case"resizeZeroIndicator":case"allowUserDragFill":o&&o._invalidate();break;case"backgroundImage":case"backgroundImageLayout":r._paintWorkbookBackgroundImage(),o&&o._invalidate();break;case"newTabVisible":case"tabNavigationVisible":var a=r._tab;a&&a.repaint();break;case"showHorizontalScrollbar":case"showVerticalScrollbar":case"useTouchLayout":case"tabStripVisible":r._doResize();break;case"tabStripRatio":r._doTabHSResize();break;case"scrollIgnoreHidden":case"scrollbarMaxAlign":case"scrollbarShowMax":o&&(o._needSyncHScrollbarSize=!0,o._needSyncVScrollbarSize=!0,o._invalidate());break;case"referenceStyle":var s=A&&r._getCalcServiceInternal();s&&(s.useR1C1=1===t,s._getOperatorAdjustor()._adjustFormulasOnChangeReferenceStyle(this))}},_init:function(e,t){var n=this;A&&n._initCalcService(),n._userEvents=[],n._userEventsElem=F("input"),n._eventSuspended=0,n._paintSuspended=0,n._floatingObjectClipboardHelper={fromSheet:W,isCutting:!1},n._containerDiv=W,n.sheets=[],n._namedStyles={},n._undoManager=new S(n,-1,n.options.allowUndo);var r=n._commandManager=new x(n);r.addListener("workbookUndo",function(e){var t=n._commandManager[e.command.cmd];t&&t.canUndo()&&n.undoManager()._addCommand(e.command,e._actionType)}),g._initWorkbookCommands(r),u._callFeatureHandler(n,"init");var o;for(o=0;o<e;o++){var i=n._createSheet(n._getDefaultSheetName(o));n.sheets.push(i),i._onAttached(n)}n.suspendPaint(),t&&n._setHost(t),n._clipboardHelper=new w(n),n.resumePaint()},_initOptions:function(e){var t=this.options,n=e||{};n=E(!0,{},me,n),T(n,function(e,n){t[e]=n})},_getContainerDiv:function(){var e=this;return!e._containerDiv&&e._host&&(e._containerDiv=F(te),p(e._containerDiv).css({position:"relative",left:0,top:0,height:0}),p(e._host).prepend(e._containerDiv)),e._containerDiv},_getDefaultSheetName:function(e){var t=this,n=t.getSheetCount();t._availableSheetIndex<n?t._availableSheetIndex=n:t._availableSheetIndex++,(N(e)||e<t._availableSheetIndex)&&(e=t._availableSheetIndex);var r,o=!1,i=t.sheets;do{r="工作表"+(e+1);for(var a=i.length,s=0;s<a;s++)if(s in i){var l=i[s];if(l._name===r){e++,o=!0;break}o&&(o=!1)}}while(o);return r},_createSheet:function(e){return new n.Worksheet(e)},_setHost:function(e){var t=this;if(e){t._host=e,V&&V(e).data(de,t),p(e).data(de,t).attr(pe,"gcSpread").addClass(he),B._gcGlobal._createDummyObjects(),U.addEventListener(fe,function(){t._onCultureChanged()});var n,r,o,a,s,l=F(ne),f=l.style,d="100%";for(l.cellSpacing=0,l.cellPadding=0,l.border=0,f.width=d,f.height=d,f.border=0,f.margin=0,n=0;n<2;n++){for(o=F("tr"),r=0;r<2;r++)a=F("td"),s=a.style,s.padding=0,s.border=0,o.appendChild(a);l.appendChild(o)}e.appendChild(l),t._vp=F(te),t._vp.id=e.id+"vp",p(l.rows[0].cells[0]).append(t._vp),t._scrollbarV=new _(!1);var h=t._scrollbarV._getScrollbar(),m=t._scrollbarVContainer=F(te);p(m).append(h),p(l.rows[0].cells[1]).append(m),p(h).bind(q+ee,function(e,n){var r=n.scrollEventType;e.data=t,1===n.scrollOrientation&&(0===r||1===r||2===r||3===r||5===r?c._vscrollDelegate(e,n):4===r&&c._vScrollStop(e))}).bind(K+ee,function(e){e.data=t,c._vScrollMouseDown(e)}).bind(X+ee,function(e){e.data=t,c._scrollMouseUp(e)});var g=F(ne),v=g.style;for(g.cellSpacing=0,g.cellPadding=0,g.border=0,v.border=0,v.margin=0,p(g).css("user-select",ae),o=F("tr"),r=0;r<2;r++)a=F("td"),s=a.style,s.padding=0,s.border=0,o.appendChild(a);g.appendChild(o),p(l.rows[1].cells[0]).append(g);var y,b;y=t._tabs=F(te),b=y.style,b.width=""+t._getActualTabStripRatio()*p(e).width()+re,b.height=""+t._getTabStripHeight()+re,b.fontSize="10pt",b.fontFamily="Arial",p(g.rows[0].cells[0]).append(y),t._scrollbarH=new _(!0);var w=t._scrollbarH._getScrollbar(),C=t._scrollbarHContainer=F(te);p(C).append(w),p(g.rows[0].cells[1]).append(C),p(w).bind(q+ee,function(e,n){var r=n.scrollEventType;e.data=t,0===n.scrollOrientation&&(0===r||1===r||2===r||3===r||5===r?c._hscrollDelegate(e,n):4===r&&c._hScrollStop(e))}).bind(K+ee,function(e){e.data=t,c._hScrollMouseDown(e)}).bind(X+ee,function(e){e.data=t,c._scrollMouseUp(e)}),t._footerCornerContainer=F(te),p(l.rows[1].cells[1]).append(t._footerCornerContainer),t._scrollService=new c(this),p(B).bind(J+Q,function(){t._doWindowResize()});var S=i(t);S&&S._setHost(t._vp),t._refreshScrollbarAndTabStrip(),t._doResize(),t._createFocusElementForTab(e),u._callFeatureHandler(t,"setHost",e)}},_createFocusElementForTab:function(e){var t=this,n="tabindex",r=j(p(e).attr(n),10)||0,o=F(te);p(o).css({position:se,overflow:"hidden"}).attr(pe,"gcSheetFocusElementForTab").attr(n,r).bind(Z,function(){t._ignoreFocusEvent||i(t)._setFocus(),t._ignoreFocusEvent=!1}),e.insertBefore(o,W),t._tabFocusElement=o},_focusTabFocusElement:function(){var e=this,t=e._tabFocusElement;t&&(e._ignoreFocusEvent=!0,t.focus())},_dispose:function(){var e,t=this,n=t._scrollbarH,r=t._scrollbarV,o=t.sheets;for(k._disposeSpread(t),p(B).unbind(J+Q),t._windowResizeTimer&&clearTimeout(t._windowResizeTimer),n&&n.dispose(),r&&r.dispose(),t._disposeUserEvents(),I._clear(),e=0;e<o.length;e++)o[e]._dispose(!0);o.splice(0,o.length);var i=t._clipboardHelper;i&&i._dispose();var a,s=t._host,l="class",c="unselectable";s&&(a=p(s),U.removeEventListener(fe,t._onCultureChanged),a.html("").removeAttr(pe).removeClass(he),a.attr(l)||a.removeAttr(l),a.attr(c)||a.removeAttr(c),a.data(de)&&a.data(de,W),V&&V(s).data(de)&&V(s).data(de,W)),t._scrollbarHContainer=W,t._scrollbarVContainer=W,t._undoManager=W,t._tab&&(t._tab._dispose(),t._tab=W),u._callFeatureHandler(t,"dispose"),t._tabFocusElement&&(p(t._tabFocusElement).unbind(Z),t._tabFocusElement=W),t._calcService&&(t._calcService.dispose(),t._calcService=W,t._spreadSource=W,t._spreadSourceModel=W),t._imageLoader=W,b._dispose()},_disposeUserEvents:function(){var e,t,n=this,r=n.sheets;for(p(n._userEventsElem).unbind(Q),e=0;e<r.length;e++)t=r[e],t._disposeUserEvents()},_refreshScrollbarAndTabStrip:function(){var e=this,t=j(P._getCssClassThemeStyle("").zIndex),n=t!==e._themeVersion,r=e._host,o=r.getAttribute("id")+"_tabStrip",i=e._tab;n&&(e._themeVersion=t);var u=e._getTabStripHeight(),c=e._getScrollbarSize(),f=e._getVScrollbarContainerWidth();i&&!n?i.repaint():(i&&i._dispose(),i=e._tab=t>2007?new v(o):new y(o),i._setOwner(e),i._setHost(e._tabs)),a(e._scrollbarVContainer,f,c),s(e._scrollbarHContainer,u,c),l(e._footerCornerContainer,f,u)},_doWindowResize:function(){var e=this,t=e._windowResizeTimer;t&&clearTimeout(t),e._windowResizeTimer=setTimeout(function(){k._updateDPI(),e._doResize(),e._windowResizeTimer=W},100)},_doResize:function(){var e=this;e._isResizing||(e._isResizing=!0,e._doResizeImp(),e._isResizing=!1)},_doResizeImp:function(){var e=this,t="display",n="block",r=e._getTabStripHeight(),o=e._getScrollbarSize(),a=e._getVScrollbarContainerWidth(),s=e._host;if(s){var l=e.options,u=l.showVerticalScrollbar,c=l.showHorizontalScrollbar,f=l.tabStripVisible,d=c||f,h=p(s),m=h.width(),g=h.height(),_=e._footerCornerContainer,v=e._scrollbarH,y=e._scrollbarV,b=e._vp.style,w=e._tabs.style;b.width=""+(m-(u?a:0))+re,p(e._scrollbarVContainer).css(t,u?n:ae),p(_).css("width",(u?a:0)+re),b.height=""+(g-(d?r:0))+re,p(e._scrollbarHContainer).css(t,d?n:ae),p(_).css("height",d?r:0+re),c?(p(v._getScrollbar()).show(),l.tabStripRatio=l.tabStripRatio):p(v._getScrollbar()).hide();var C=p(e._vp).width(),S=z(e._getActualTabStripRatio()*C);S===C&&(S=C-1),w.width=""+S+re,w.height=""+r+re,y._width(o),y._height(p(e._vp).height());var x=m-(f?S:0)-(u?a:0);v._width(x>0?x:1),v._height(o);var T=i(e);T&&(0===T._scrollTopRow&&(T._scrollTopRow=T._getFirstPageTopRow()),0===T._scrollLeftCol&&(T._scrollLeftCol=T._getFirstPageLeftColumn()),T._doResize()),e._resizeHScrollBar(),e._resizeVScrollBar(),T&&(T.invalidateLayout(),T.repaint()),f?p(e._tabs).show():p(e._tabs).hide(),e._tab&&e._tab._doResize();m===h.width()||e._haveLayoutFixing||(e._haveLayoutFixing=!0,setTimeout(function(){delete e._haveLayoutFixing,e._doResizeImp()},1))}},_resizeHScrollBar:function(){var e=this,t=i(e),n=e.options;if(t){var r,o=t.frozenColumnCount(),a=t.getColumnCount()-t.frozenTrailingColumnCount()-o,s=o,l=t._getSheetLayout(),u=0===a?s:s+a-1,c=t._scrollLeftCol,f=t._getLeftColWhenLastColShowComplete(l._viewportWidth,s,u);if(n.scrollbarMaxAlign&&(u=f),!n.scrollbarShowMax){var d=t._getLastNonNullRowAndCol(),p=d.lastNonNullCol,h=t._getLeftColWhenLastColShowComplete(l._viewportWidth,s,p);h===s&&++h>u&&(h=u),u=c>h?c<u?c:u:h}c>u&&(t._scrollLeftCol=u);var m=t._getScrollableColumn(t._scrollLeftCol);-1!==m&&m!==t._scrollLeftCol&&(t._scrollLeftCol=m),r=t._getPageValueH(),r<1&&(r=1);var g=e._scrollbarH;g&&(g._minimum(t._getVisibleColIndex(s)),g._maximum(t._getVisibleColIndex(u)),g._pageValue(r),g._refreshLayout(),g.value(t._getVisibleColIndex(t._scrollLeftCol)))}},_resizeVScrollBar:function(){var e=this,t=i(e),n=e.options;if(t){var r,o=t.frozenRowCount(),a=t.getRowCount()-t.frozenTrailingRowCount()-o,s=o,l=t._getSheetLayout(),u=0===a?s:s+a-1,c=t._scrollTopRow,f=t._getTopRowWhenLastRowShowComplete(l._viewportHeight,s,u);if(n.scrollbarMaxAlign&&(u=f),!n.scrollbarShowMax){var d=t._getLastNonNullRowAndCol(),p=d.lastNonNullRow,h=t._getTopRowWhenLastRowShowComplete(l._viewportHeight,s,p);h===s&&++h>u&&(h=u),u=c>h?c<u?c:u:h}c>u&&(t._scrollTopRow=u);var m=t._getScrollableRow(t._scrollTopRow);-1!==m&&m!==t._scrollTopRow&&(t._scrollTopRow=m),r=t._getPageValueV(),r<1&&(r=1);var g=e._scrollbarV;g&&(g._minimum(t._getVisibleRowIndex(s)),g._maximum(t._getVisibleRowIndex(u)),g._pageValue(r),g._refreshLayout(),g.value(t._getVisibleRowIndex(t._scrollTopRow)))}},_doTabHSResize:function(){var e=this,t=e._getTabStripHeight(),n=e._getScrollbarSize(),r=e._getVScrollbarContainerWidth(),o=e._host;if(o){var a=e.options,s=a.tabStripVisible,l=p(o),u=l.width(),c=e._scrollbarH,f=e._tabs.style,d=p(e._vp).width(),h=z(e._getActualTabStripRatio()*d);h===d&&(h=d-1),f.width=""+h+re,f.height=""+t+re;var m=u-(s?h:0)-(a.showVerticalScrollbar?r:0);c._width(m>0?m:1),c._height(n);var g=i(e);g&&0===g._scrollLeftCol&&(g._scrollLeftCol=g._getFirstPageLeftColumn()),e._resizeHScrollBar(),s?p(e._tabs).show():p(e._tabs).hide(),e._tab&&e._tab._doResize()}},suspendPaint:function(){var e=this,t=e._tab,n=e.sheets;e._paintSuspended++;for(var r=0;r<n.length;r++)n[r].suspendPaint();t&&t._suspendPaint()},resumePaint:function(){var e=this,t=e._tab,n=e.sheets;e._paintSuspended-=e._paintSuspended>0?1:0;for(var r=0;r<n.length;r++)n[r].resumePaint();t&&t._resumePaint()},isPaintSuspended:function(){return this._paintSuspended>0},_paintWorkbookBackgroundImage:function(){var e=this,t=e.options.backgroundImage,n=e.options.backgroundImageLayout,r=i(e);if(r&&t){var o,a=p(r._getCanvas());if(a.css({"background-image":"url('"+t+"')","background-repeat":"no-repeat"}),!N(n)){o=e._imageLoader,o||(o=e._imageLoader=new m(function(){e._imageLoader&&e._paintWorkbookBackgroundImage()}));try{if(o._getState(t)){var s=o._getImage(t),l=r._getBounds(),u=l.width,c=l.height;M._applyBackgroundImageLayout(r._getCanvas(),u,c,s.width,s.height,n)}else o._addImage(t)}catch(e){}}}},_changeSheetForFormulaAcrossSheet:function(e,t){void 0===t&&(t=!0);var n=this;n._tab._doSheetTabClickChange(n.getSheetIndex(e.name()),t)},startSheetIndex:function(e){var t=this,n=t._tab;return 0===arguments.length?n?n._firstTab:0:(n&&(n._tabVisible(e)||-1===(e=n._getNextVisibleIndex(e))&&(e=n._getPreVisibleIndex(e)),n._firstTab=e),t._doTabHSResize(),t)},_getActualTabStripRatio:function(){var e=this,t=e.options;if(t.showHorizontalScrollbar){var n=t.tabStripRatio;if(isNaN(n))return.5;var r=0,o=e._vp,i=e._tab;if(o&&i){var a=p(o).width();r=i._resizeBarWidth/a}return n<r?n=r:n>1&&(n=1),n}return 1},destroy:function(){p(B).unbind(J+Q),this._dispose()},repaint:function(){var e=this,t=e._tab;t&&t.repaint();var n=i(e);n&&n.repaint()},refresh:function(){var e=this;e._host&&(P._clearCache(),e._refreshScrollbarAndTabStrip(),e._doResize(),e.repaint())},getHost:function(){return this._host},invalidateLayout:function(){var e=i(this);e&&e.invalidateLayout()},addNamedStyle:function(e){this._addNamedStyleImp(e);var t=i(this);t&&t._invalidate()},_addNamedStyleImp:function(e){if(e){if(!e.name)throw new Error(o.Exp_EmptyNamedStyle);var t=e.name.toUpperCase();this._namedStyles[t]=e}},getNamedStyle:function(e){return this._getNamedStyleImp(e,!0)},_getNamedStyleImp:function(e,t){var n=this._namedStyles;if(n&&e){e=e.toUpperCase();var r=n[e];return r&&t&&this._clearStyleCache(),r}return W},_clearStyleCache:function(){for(var e=this.sheets,t=0;t<e.length;t++)e[t]._clearStyleCache()},removeNamedStyle:function(e){var t=this._namedStyles;if(t&&e&&(e=e.toUpperCase(),t.hasOwnProperty(e))){delete t[e],this._clearStyleCache();var n=i(this);n&&n._invalidate()}},getNamedStyles:function(){var e=[],t=this._namedStyles;return t&&T(t,function(t,n){e.push(n)}),this._clearStyleCache(),e},getActiveSheet:function(){return this.sheets&&this.sheets.length>0?this.sheets[this._activeSheetIndex]:W},setActiveSheet:function(e){this._setActiveSheetInternal(e,2)},_setActiveSheetInternal:function(e,t){for(var n=this.sheets,r=0;r<n.length;r++)n[r].name()===e&&this._setActiveSheetIndexImp(r,t)},getActiveSheetIndex:function(){return this._activeSheetIndex},setActiveSheetIndex:function(e){this._setActiveSheetIndexImp(e,2)},_setActiveSheetIndexImp:function(e,t,n){if(typeof e===G){var r=this;if(e!==r._activeSheetIndex){var o=r.sheets[e];if(o&&o.visible()){var a=M._device();if(a.ipad||a.iphone){var s=r._lastSetActiveSheetTime;if(s&&(new Date).valueOf()-s<300)return}var l=i(r);r._activeSheetIndex=e,o!==l&&(l&&l._dispose(!1),r._setActiveSheetImp(o,t,!1,n)),r._doResize(),(a.ipad||a.iphone)&&(r._lastSetActiveSheetTime=(new Date).valueOf())}}}},_setActiveSheetImp:function(e,t,n,r){n||e._setHost(this._vp);var o=O._getActiveElement(),i=o&&o.parent===this,a=2===t?i:1===t;O._setActiveElement(W),!this._suspendSetFocus&&a&&e._setFocus(r),e._syncHScrollbarPosition(),e._syncVScrollbarPosition()},addSheet:function(e,t){this._addSheetImp(e,2,t)},_addSheetImp:function(e,t,n){var r=this;n||(n=r._createSheet(r._getDefaultSheetName(e)));var a,s=r.sheets,l=s.length;if(n._name){for(a=0;a<l;a++)if(s[a]._name===n._name)throw o().Exp_NotSupported}else n._name=r._getDefaultSheetName(e);r._copyUserEvents(n);var u=i(r),c=r._activeSheetIndex,f=l-e,d=[];for(a=0;a<f&&l>0;a++)d.push(s.pop());for(s.push(n),n._onAttached(r);d.length>0;)s.push(d.pop());l=s.length,1===l?(r._vp&&n._setHost(r._vp),r._activeSheetIndex=0):(c<0&&r._tab&&(c=r._tab._getNextVisibleIndex(c)),r._activeSheetIndex=c);var p=i(r);p!==u&&(u&&u._dispose(!1),p&&r._setActiveSheetImp(p,t,1===l),r._doResize()),r._tab&&(r._tab._firstTab<0&&(r._tab._firstTab=r._activeSheetIndex),r._tab.repaint())},removeSheet:function(e){this._removeSheetImp(e,2)},_removeSheetImp:function(e,t){var n=this,r=n.sheets,a=n._calcService,s=n._tab,l=r.length;if(isNaN(e)||e<0||e>=l)throw new Error(o().Exp_IndexOutOfRange);var u=e<=n._activeSheetIndex||e===l-1,c=i(n);e<n._activeSheetIndex&&n._activeSheetIndex--;var f=r[e];if(f._disposeUserEvents(),r.splice(e,1),0===(l=r.length))n._activeSheetIndex=-1;else if(n._activeSheetIndex>=l)n._activeSheetIndex=s._getPreVisibleIndex(l);else{for(var d=n._activeSheetIndex;d<l;d++)if(r[d].visible()){n._activeSheetIndex=d;break}d>=l&&(n._activeSheetIndex=-1)}if(u){var p=r[n._activeSheetIndex];c!==p&&(c&&c._dispose(!1),p&&n._setActiveSheetImp(p,t,!1))}a&&a.removeSource(f._getSheetSource()),s&&(s._firstTab>=l?n.startSheetIndex(s._getPreVisibleIndex(l)):s._firstTab<0?n.startSheetIndex(s._getNextVisibleIndex(-1)):n._doResize())},clearSheets:function(){for(var e=this,t=e.sheets,n=e._calcService,r=e._tab,o=0;o<t.length;o++)t[o]._disposeUserEvents(),t[o]._dispose(!1);t.splice(0,t.length),n&&n.clearSource(),e._activeSheetIndex=-1,r&&(r._firstTab=-1,r.repaint()),I._clear()},getSheet:function(e){var t=this.sheets;return e>=0&&e<t.length?t[e]:W},getSheetFromName:function(e){for(var t=this.sheets,n=0;n<t.length;n++)if(t[n].name()===e)return t[n];return W},getSheetIndex:function(e){for(var t=this.sheets,n=0;n<t.length;n++)if(t[n].name()===e)return n;return W},getSheetCount:function(){return this.sheets.length},setSheetCount:function(e){this._setSheetCountImp(e,2)},_setSheetCountImp:function(e,t){var n=this;if(e<0)throw o().Exp_ArgumentOutOfRange;0===e&&n.clearSheets();var r,i=n.sheets.length;if(e<i)for(r=i-1;r>=e;r--)n._removeSheetImp(r,t);else if(e>i)for(r=i;r<e;r++)n._addSheetImp(r,t)},bind:function(e,t,n){var r=this,o=r.sheets;r._userEvents.push({type:e,data:t,fn:n}),p(r._userEventsElem).bind(e+Q,t,n);for(var i=0;i<o.length;i++){o[i].bind(e,t,n)}},unbind:function(e,t){for(var n=this,r=n.sheets,o=n._userEvents,i=0;i<o.length;i++){o[i].type===e&&o.splice(i,1)}p(n._userEventsElem).unbind(e+Q,t);for(var a=0;a<r.length;a++){r[a].unbind(e,t)}},unbindAll:function(){var e=this,t=e.sheets;e._userEvents.length=0,p(e._userEventsElem).unbind(Q);for(var n=0;n<t.length;n++){t[n].unbindAll()}},_bind:function(e,t,n){var r=this,o=r.sheets;r._userEvents.push({type:e,data:t,fn:n}),p(r._userEventsElem).bind(e+$,t,n);for(var i=0;i<o.length;i++){o[i]._bind(e,t,n)}},_unbind:function(e,t){for(var n=this,r=n.sheets,o=n._userEvents,i=0;i<o.length;i++){o[i].type===e&&o.splice(i,1)}p(n._userEventsElem).unbind(e+$,t);for(var a=0;a<r.length;a++){r[a]._unbind(e,t)}},_unbindAll:function(){var e=this,t=e.sheets;e._userEvents.length=0,p(e._userEventsElem).unbind($);for(var n=0;n<t.length;n++){t[n]._unbindAll()}},_trigger:function(e,t){0===this._eventSuspended&&p(this._userEventsElem).trigger(e,t)},_triggerButtonClicked:function(e,t,n,r){this._trigger(R.ButtonClicked,{sheet:e,sheetName:e._name,row:t,col:n,sheetArea:r})},_copyUserEvents:function(e){for(var t=this._userEvents,n=0;n<t.length;n++){var r=t[n];e.bind(r.type,r.data,r.fn)}},suspendEvent:function(){var e=this,t=e.sheets;e._eventSuspended++;for(var n=0;n<t.length;n++){t[n].suspendEvent()}},resumeEvent:function(){var e=this,t=e.sheets;--e._eventSuspended<0&&(e._eventSuspended=0);for(var n=0;n<t.length;n++){t[n].resumeEvent()}},focus:function(e){if(!1===e)O._setActiveElement(W);else{var t=i(this);t&&t._setFocus()}},nextControl:L("nextControl",W),previousControl:L("previousControl",W),_getScrollbarSize:function(){return this._themeVersion>2007?15:18},_getVScrollbarContainerWidth:function(){return this._themeVersion>2007?22:this._getScrollbarSize()},_getTabStripHeight:function(){return this._themeVersion>2007?28:this._getScrollbarSize()},_showTooltip:function(e,t,n,r){var o="auto",i=this;if(!i._tooltip){var a=F(te);p(a).addClass("gc-spread-toolTip ui-state-default ui-widget-content btn-default").css({position:se,font:"normal normal normal 9pt "+C.FONT_FAMILY}).width(o).height(o).appendTo(U.body),i._tooltip=a}i._refreshTooltip(e,t,n,r)},_refreshTooltip:function(e,t,n,r){var o=this,a=i(o);if(a){var s=o._tooltip;if(s){var l=p(s);e?(l.html(e),l.show()):l.hide();var u=a._getCanvasOffset();r&&(n-=u.top,t-=u.left);var c=a._getBounds();n=Y(n,c.y+c.height-l.outerHeight()),t=Y(t,c.x+c.width-l.outerWidth()),N(n)||l.css("top",n+u.top),N(t)||l.css("left",t+u.left)}}},_removeTooltip:function(){var e=this,t=e._tooltip;t&&(p(t).remove(),e._tooltip=W)},_onCultureChanged:function(){var e=this,t=e.sheets;h._CacheMgr._clearFormatCache(),e.invalidateLayout();for(var n=0,r=t.length;n<r;n++)for(var o=t[n],i=o.getRowCount(),a=o.getColumnCount(),s=0;s<i;s++)for(var l=0;l<a;l++){var c=o.getValue(s,l);if(c instanceof Date){var f=o.getStyle(s,l);f&&f._setActualAutoFormatter(c)}}e.repaint(),u._callFeatureHandler("onCultureChanged")},getTab:function(){return this._tab}},n.Workbook=u,E(c,{_hscrollDelegate:function(e,t){var n=e.data,r=i(n);if(r&&t){var o,a=t.newValue,s=t.oldValue,l=t.scrollEventType,u=j(a,10);u=r._getOriginalColIndex(u),s=t.oldValue=N(s)?0:j(s,10),r._needSyncHScrollbarSize=!1;var c=n.options.scrollbarShowMax;2===l||0===l?(2===l&&(u=r._getPrevPageLeftColumn()),o=r._getScrollableColumn(u,!0),-1!==o&&o!==u&&(u=o),c||(r._needSyncHScrollbarSize=!0,t.ignoreUpdatePosition=!0)):3!==l&&1!==l||(3===l&&(u=r._getPageRightColumn())===r._scrollLeftCol&&u++,c||(r._needSyncHScrollbarSize=!0,1===l&&a===s&&u++),-1!==(o=r._getScrollableColumn(u))&&o!==u&&(u=o));var f=r._getFirstPageLeftColumn(),d=r._getLastVisualScrollColumn();u<f&&(u=f),u>d&&(u=d);var p=r._getVisibleColIndex(u);a!==p&&(t.newValue=p),s!==p&&n._scrollService._doScroll(u,!0)}},_hScrollStop:function(e){var t=e.data,n=i(t);if(n){var r=t._scrollbarH,o=n._getOriginalColIndex(r.value()),a=n._getFirstPageLeftColumn(),s=n._getLastVisualScrollColumn(),l=n._formulaTextBox;o<a?r.value(n._getVisibleColIndex(a)):o>s&&r.value(n._getVisibleColIndex(s)),t._removeTooltip(),t.options.scrollbarShowMax||(t._scrollService.scrolling?n._needSyncHScrollbarSize=!0:t._resizeHScrollBar()),l&&l.focus()}},_hScrollMouseDown:function(e){var t=e.data;if(t){var n=i(t);if(n){n._setFocus();var r=t.options.showScrollTip;if(1===r||3===r){var o=p(e.srcElement||e.target),a=o.parent();(o&&o.hasClass(oe)||a&&a.hasClass(oe)||o&&o.hasClass(ie)||a&&a.hasClass(ie))&&(o||a)&&t._scrollService._showScrollTooltip(!1,e)}}}},_vscrollDelegate:function(e,t){var n=e.data,r=i(n);if(r&&t){var o,a=t.newValue,s=t.oldValue,l=t.scrollEventType,u=j(a,10);u=r._getOriginalRowIndex(u),s=t.oldValue=N(s)?0:j(s,10),r._needSyncVScrollbarSize=!1;var c=n.options.scrollbarShowMax;2===l||0===l?(2===l&&(u=r._getPrevPageTopRow()),o=r._getScrollableRow(u,!0),-1!==o&&o!==u&&(u=o),c||(r._needSyncVScrollbarSize=!0,t.ignoreUpdatePosition=!0)):3!==l&&1!==l||(3===l&&(u=r._getPageBottomRow())===r._scrollTopRow&&u++,c||(r._needSyncVScrollbarSize=!0,1===l&&a===s&&u++),-1!==(o=r._getScrollableRow(u))&&o!==u&&(u=o));var f=r._getFirstPageTopRow(),d=r._getLastVisualScrollRow();u<f&&(u=f),u>d&&(u=d);var p=r._getVisibleRowIndex(u);a!==p&&(t.newValue=p),s!==p&&n._scrollService._doScroll(u)}},_vScrollStop:function(e){var t=e.data,n=i(t);if(n){var r=t._scrollbarV,o=n._getOriginalRowIndex(r.value()),a=n._getFirstPageTopRow(),s=n._getLastVisualScrollRow(),l=n._formulaTextBox;o<a?r.value(n._getVisibleRowIndex(a)):o>s&&r.value(n._getVisibleRowIndex(s)),t._removeTooltip(),t.options.scrollbarShowMax||(t._scrollService.scrolling?n._needSyncVScrollbarSize=!0:t._resizeVScrollBar()),l&&l.focus()}},_vScrollMouseDown:function(e){var t=e.data;if(t){var n=i(t);if(n){n._setFocus();var r=t.options.showScrollTip;if(2===r||3===r){var o=p(e.srcElement||e.target);if(o){var a=o.parent();(o.hasClass(oe)||a&&a.hasClass(oe)||o.hasClass(ie)||a&&a.hasClass(ie))&&t._scrollService._showScrollTooltip(!0,e)}}}}},_scrollMouseUp:function(e){var t=e.data;t&&t._removeTooltip()}}),c.prototype={_doScroll:function(e,t){var n=this,r=i(n._wb);r&&(n._scrolling=!0,n._newTop=t?r._scrollTopRow:e,n._newLeft=t?e:r._scrollLeftCol,window.setTimeout(function(){n._scrollView()},0))},_scrollView:function(){var e=this;i(e._wb)&&e._scrolling&&(e._scrolling=!1,e._updateView())},_updateView:function(){var e=this;if(!e._painting){e._painting=!0;var t=e._wb,n=i(t);if(n){var r=t.options.showScrollTip,o=e._newTop,a=e._newLeft;o!==n._scrollTopRow?(e._vScrollTo(o),2!==r&&3!==r||t._refreshTooltip(e._getScrollTooltipContent(!0))):a!==n._scrollLeftCol&&(e._hScrollTo(a),1!==r&&3!==r||t._refreshTooltip(e._getScrollTooltipContent(!1)))}e._painting=!1}},_vScrollTo:function(e){var t=i(this._wb);if(t){var n=t._scrollTopRow;if(e===n)return;if(t._scrollTopRow=e,t._layoutSuspended>0)return void t._trigger(R.TopRowChanged,{sheet:t,sheetName:t._name,oldTopRow:n,newTopRow:e});var r,o,a,s,l=!1,u=2,c=t._bounds,f=t._getSheetLayout(),d=f._viewportY,p=f._viewportHeight,h=t._render,m=h._getCtx();if(e>n){var g,_,v=t._getRowLayout(1);if(v&&v.length>0&&(g=v.findRow(e)),g){var y=v.length-1;for(_=v[y];_.y+_.height>d+p;)y-=1,_=v[y];_.row>e&&(l=!0,r=c?c.x:f.x,o=g.y,a=f.width,s=_.y+_.height-g.y-u,h._copyScreen(r,o,a,s,r,d),t.invalidateLayout(),h._paintBody(m,new D(r,d+s,a,p-s)),h._paintAdornment(m,new D(r,d,a,p)))}}else{for(var b=0,w=e;w<n&&b<p;w++)b+=t._getZoomRowHeight(w);if(b<p){l=!0,r=c?c.x:f.x,o=d,a=f.width,s=p-b,t.frozenTrailingRowCount()>0&&(s-=1),h._copyScreen(r,o,a,s,r,o+b),t.invalidateLayout();var C=t.rowOutlines&&!t.rowOutlines._isEmpty()?1:0;h._paintBody(m,new D(r,o,a,b+u+C)),h._paintAdornment(m,new D(r,d,a,p))}}l||(t.invalidateLayout(),t.repaint()),t._trigger(R.TopRowChanged,{sheet:t,sheetName:t._name,oldTopRow:n,newTopRow:e});var S=t._eventHandler;S&&S._updateEditingEditor()}},_hScrollTo:function(e){var t=i(this._wb);if(t){var n=t._scrollLeftCol;if(e===n)return;if(t._scrollLeftCol=e,t._layoutSuspended>0)return void t._trigger(R.LeftColumnChanged,{sheet:t,sheetName:t._name,oldLeftCol:n,newLeftCol:e});var r,o,a,s,l=!1,u=2,c=t._bounds,f=t._getSheetLayout(),d=f._viewportX,p=f._viewportWidth,h=t._render,m=h._getCtx();if(e>n){var g,_,v=t._getColumnLayout(1);if(v&&v.length>0&&(g=v.findCol(e)),g){var y=v.length-1;for(_=v[y];_.x+_.width>d+p;)y-=1,_=v[y];_.col>e&&(l=!0,r=g.x,o=c?c.y:f.y,a=_.x+_.width-g.x-u,s=f.height,h._copyScreen(r,o,a,s,d,o),t.invalidateLayout(),h._paintBody(m,new D(d+a,o,p-a,s)),h._paintAdornment(m,new D(d,o,p,s)))}}else{for(var b=0,w=e;w<n&&b<p;w++)b+=t._getZoomColumnWidth(w);if(b<p){l=!0,r=d,o=c?c.y:f.y,a=p-b,s=f.height,t.frozenTrailingColumnCount()>0&&(a-=1),h._copyScreen(r,o,a,s,r+b,o),t.invalidateLayout();var C=t.columnOutlines&&!t.columnOutlines._isEmpty()?1:0;h._paintBody(m,new D(r,o,b+u+C,s)),h._paintAdornment(m,new D(d,o,p,s))}}l||(t.invalidateLayout(),t.repaint()),t._trigger(R.LeftColumnChanged,{sheet:t,sheetName:t._name,oldLeftCol:n,newLeftCol:e});var S=t._eventHandler;S&&S._updateEditingEditor()}},_doMouseWheel:function(e,t,n){var r=this,o=r._wb,a=i(o),s=!1,l=!1,u=o.options.scrollbarShowMax;if(a){if(e.ctrlKey){if(!o.options.allowUserZoom)return!0;var c=a._zoomFactor,f=c-.05*t;if(a.isEditing()&&!a.endEdit())return;a._commandManager().execute({cmd:"zoom",sheetName:a.name(),zoomFactor:f}),f=a._zoomFactor,c!==f&&a._trigger(R.UserZooming,{sheet:a,sheetName:a._name,oldZoomFactor:c,newZoomFactor:f})}else{n=n||0;var d=a._scrollTopRow,p=r._getNewTopRow(a,t);d!==p?(r._vScrollTo(p),a._syncVScrollbarPosition(),u||a._syncVScrollbarSize()):s=!0;var h=a._scrollLeftCol,m=r._getNewLeftCol(a,n);h!==m?(r._hScrollTo(m),a._syncHScrollbarPosition(),u||a._syncHScrollbarSize()):l=!0}var g=a._getCanvasOffset(),_=a.hitTest(e.pageX-g.left,e.pageY-g.top),v=a._currentTarget,y=v&&v.cellTypeHitInfo;y&&(y.cellRect=a.getCellRect(v.row,v.col));var b=a._eventHandler;b._updateCanvasCursor(_),b._setHoverCell(_)}return s&&l},_getNewTopRow:function(e,t){var n=e._scrollTopRow,r=e.frozenRowCount();r>0&&(0===n&&t>0?n=r:t<0&&n===r-t&&(n=0));var o=e._getScrollableRow(n+t,t<0);-1!==o?n=o:n+=t;var i=e._getFirstPageTopRow(),a=e._getLastVisualScrollRow();return e.getRowCount()-r-e.frozenTrailingRowCount()<=0||i===W?n=e._scrollTopRow:(n<i?n=i:n>a&&(n=a),n===W&&(n=-1)),n},_getNewLeftCol:function(e,t){var n=e._scrollLeftCol,r=e.frozenColumnCount();r>0&&(0===n&&t>0?n=r:t<0&&n===r-t&&(n=0));var o=e._getScrollableColumn(n+t,t<0);-1!==o?n=o:n+=t;var i=e._getFirstPageLeftColumn(),a=e._getLastVisualScrollColumn();return e.getColumnCount()-r-e.frozenTrailingColumnCount()<=0||i===W?n=e._scrollLeftCol:(n<i?n=i:n>a&&(n=a),n===W&&(n=-1)),n},_showScrollTooltip:function(e,t){var n,r,o=this,a=o._wb;i(a)&&(e?(n=t.pageY,r=t.pageX-100):(n=t.pageY-40,r=t.pageX-30),a._showTooltip(o._getScrollTooltipContent(e),r,n,!0))},_getScrollTooltipContent:function(e){var t,n=i(this._wb),r=n._scrollLeftCol+1;return n&&(e?t=o().Tip_Row+(n._scrollTopRow+1):(1!==n.options.colHeaderAutoText&&(r=n._indexToLetters(r)),t=o().Tip_Column+r)),t}},e.exports=n},function(e,t,n){function r(e){this._source=e}function o(e){this._init(e)}function i(e){var t=e&&e._bindingManager;t&&t._isCellBindingSource()&&e._trigger(C.ResetBinding,{sheet:e})}function a(e,t){var n=e&&e._bindingManager;return!(!n||!n._isCellBindingSource(t))&&(e.clearPendingChanges(),e._trigger(C.InitBinding,{sheet:e,data:t}),!0)}function s(e){return e._getColInfos()}function l(e,t,n,r){var o=3===arguments.length,i=e,a=i._dataSource,l={value:S,hasBinding:!1},u=!1;if(!a)return o?l:u;var c,f,d=i._sheet,p=i._dataSourceType;if(p===M){var h=d?d.getBindingPath(t,n):S;if(h){if(o)return{value:a.getValue(h),hasBinding:!0};a.setValue(h,r),u=!0}}else{if(t<0||e.getRowCount()<=t)return o?l:u;var m=d?d.getColumnCount():e.getColumnCount();if(n<0||m<=n)return o?l:u;if(d?(c=s(d)._getItems()[n])&&(f=c.name):e._fields&&(f=e._fields[n]),p){var g=E[p],_=c&&c.value,y=v(_)?_:S;if(o)return g.getValue(a,y,f,t,n);u=g.setValue(a,y,f,t,n,r)}}return o?l:u}function u(e){var t=S;return e&&(f(e)?t=M:_.each(E,function(n,r){if(r.isDataSource(e))return t=n,!1})),t}function c(e,t){return e&&t&&t!==M?E[t].getProperties(e):S}function f(e){return r&&e instanceof r}function d(e,t,n){if(e&&t)for(var r=t.split("."),o=r.length,i=0;i<o;i++){var a=r[i];if(!e)break;i===o-1?v(e[a])?e[a](n):e[a]=n:e=v(e[a])?e[a]():e[a]}}function p(e,t){if(!e||!t)return S;var n=t.split("."),r=n.length,o=0;do{var i=n[o];if(e=v(e[i])?e[i]():e[i],w(e))return S}while(++o<r);return e}function h(){}var m=n(1),g=n(0),_=m.GC$,v=_.isFunction,y=_.getType,b=_.isNumeric,w=g._Types._isNullOrUndefined,C=m.Events,t={},S=null,x=void 0,T="string",E=t._dataProviders={},M="cellBinding",A=function(){return g._getResource(t.SR)()};r.prototype={setValue:function(e,t){d(this._source,e,t)},getValue:function(e){return p(this._source,e)},getSource:function(){return this._source}},t.CellBindingSource=r,o.prototype={bind:function(e){var t=this,n=t._sheet,r=t._dataSource;if(r&&v(r.dispose)&&r.dispose(),t._unSubscribeHandlers(t._dataSourceSubscriptions),t._unSubscribeHandlers(t._dataItemSubscriptions),t._init(n),t._dataSource=e,e){var o=t._dataSourceType=u(e);if(!o)throw new Error(A().Exp_NotSupportedDataSource);if(t._dataItemType=t._getDataItemType(),n){var i=t._dataSourceSubscriptions,s=e.currentPosition;e.subscribe&&i.push(e.subscribe(t._dataChangedhandler,t)),s&&s.subscribe&&i.push(s.subscribe(t._currentPositionChangedhandler,t)),t._doDataItemChanged()}t._fields=c(e,o)}return a(n,e)},_doDataItemChanged:function(){var e=this,t=e._sheet,n=e._dataSource;if(t&&n){var r=e._dataSourceType;if(n){e._unSubscribeHandlers(e._dataItemSubscriptions);var o=S;if(r!==M){var i=t.getActiveRowIndex();n.currentPosition?(-1<=i&&i<n.count()&&n.currentPosition(i),o=n.currentItem()):o=e._getDataItem(i)}if(o){var a=function(){var t=e._sheet;t&&t.repaint()};for(var s in o)o[s]&&v(o[s].subscribe)&&e._dataItemSubscriptions.push(o[s].subscribe(a,S,S))}}}},_unSubscribeHandlers:function(e){if(e)for(var t=0;t<e.length;t++){var n=e[t];n&&v(n.dispose)&&n.dispose()}},getRowCount:function(){var e=this,t=e._dataSource,n=e._dataSourceType,r=0;return t&&n&&n!==M&&(r=E[n].getDataLength(t)),r},getColumnCount:function(){var e=this._fields;if(e)return e.length;var t=this._dataSource;if(t){var n=t[0],r=y(n);if("null"===r||r===T||"number"===r)return 1}return 0},getSource:function(){return this._dataSource},_getFields:function(){return this._fields},_getDataItem:function(e){var t=this._dataSource,n=this._dataSourceType,r=S;return t&&n&&n!==M&&(r=E[n].getDataItem(t,e)),r},_getDataItemType:function(){var e=this;if(!e._dataItemType)for(var t=e.getRowCount(),n=0;n<t;n++){var r=e._getDataItem(n);if(r){e._dataItemType=r.entityAspect&&r.entityType||r.constructor;break}}return e._dataItemType},getValue:function(e,t){return l(this,e,t)},setValue:function(e,t,n){return l(this,e,t,n)},_canAdd:function(){var e=E[this._dataSourceType];return e&&e.canAdd&&e.canAdd()},_canInsert:function(){var e=E[this._dataSourceType];return e&&e.canInsert&&e.canInsert()},_canRemove:function(){var e=E[this._dataSourceType];return e&&e.canRemove&&e.canRemove()},_addItems:function(e,t){var n=this,r=n._dataSource;if(r&&!(e>n.getRowCount())){var o=n._dataSourceType,i=n._getDataItemType();o&&o!==M&&(n._dataViewUpdating||(n._updatingDataView=!0,E[o].addItems(r,e,t,i),n._updatingDataView=!1))}},_removeItems:function(e,t){var n=this,r=n._dataSourceType,o=n.getRowCount(),i=n._dataSource;!i||e>=o||r&&r!==M&&(n._dataViewUpdating||(n._updatingDataView=!0,E[r].removeItems(i,e,t),n._updatingDataView=!1))},_isCellBindingSource:function(e){return f(e||this._dataSource)},_init:function(e){var t=this;t._dataSource=S,t._dataSourceType="",t._dataItemType=S,t._fields=S,t._dataItemSubscriptions=[],t._sheet=e,i(e)},_dataChangedhandler:function(e){var t=this,n=t._sheet;if(n&&!t._updatingDataView){if(e){if(t._dataViewUpdating=!0,!isNaN(e.length)&&(n.setRowCountCore(e.length),w(t._fields)&&0===s(n)._getItems().length)){t._fields=c(t._dataSource),n.setColumnCount(t.getColumnCount());var r=s(n),o=t._getFields();if(o)for(var i=0,a=o.length;i<a;i++)r._setItem(i,{name:o[i]})}t._dataViewUpdating=!1}n._invalidate()}},_currentPositionChangedhandler:function(){var e=this,t=e._sheet,n=e._dataSource;if(t&&n&&n.currentPosition){var r=n.currentPosition();t._activeRowIndex!==r&&(t._setActiveCellAndSelection(r,t._activeColIndex,x,x,2),t._invalidate())}},toJSON:function(){var e=this._dataSource;if(!e)return S;var t=this._dataSourceType;return e=t===M?e.getSource():E[t].toJSON(e),{type:t,source:e}},fromJSON:function(e){var t=e&&e.source;if(t){var n=e.type,o=t;o=n===M?new r(t):E[n].fromJSON(t),o&&this.bind(o)}}},t._BindingManager=o,t._setValueByPath=d,t._getValueByPath=p,h.prototype={isDataSource:function(e){return _.isArray(e)},getDataLength:function(e){return e.length},getDataItem:function(e,t){return e[t]},addItems:function(e,t,n,r){for(var o=0;o<n;o++){var i=S;r&&(i=r.createEntity?r.createEntity():new r),e.splice(t,0,i)}},removeItems:function(e,t,n){var r=this.getDataLength(e);t<r&&e.splice(t,Math.min(n,r-t))},getProperties:function(e){var t=e.length,n=S;if(t>0){n=[];var r=e[0];for(var o in r)v(r[o])||n.push(o)}return n},getValue:function(e,t,n,r,o){var i=S,a=!1,s=this.getDataItem(e,r);return w(s)||(t?(i=t(s),a=!0):n?(i=p(s,n),a=!0):(y(s)===T||b(s))&&0===o&&(i=s,a=!0)),{value:i,hasBinding:a}},setValue:function(e,t,n,r,o,i){var a=!1,s=this.getDataItem(e,r);return w(s)||(t?(t(s,i),a=!0):n?(d(s,n,i),a=!0):(y(s)===T||b(s))&&0===o&&(e[r]=i,a=!0)),a},fromJSON:function(e){return e},toJSON:function(e){return e}},E.defaultBindingSource=new h,e.exports=t},function(e,t,n){var r={};r.Spread=r.Spread||{},r.Spread=n(77),r.Spread.CalcEngine=n(5),r.Spread.CalcEngine.BasicFunctions=n(86),r.Spread.CalcEngine.AdvancedFunctions=n(87),r.Spread.Sheets=n(1),r.Spread.Sheets.CellTypes=n(107),r.Spread.Sheets.Bindings=n(57),r.Spread.Sheets.Search=n(114),r.Spread.Sheets.Outlines=n(115),r.Spread.Sheets.Touch=n(33),r.Spread.Sheets.FloatingObjects=n(62),r.Spread.Sheets.Sparklines=n(30),r.Spread.Sheets.Comments=n(120),r.Spread.Sheets.ConditionalFormatting=n(18),r.Spread.Sheets.Filter=n(66),r.Spread.Sheets.Tables=n(69),r.Spread.Sheets.Slicers=n(126),r.Spread.Sheets.DataValidation=n(129),r.Spread.Sheets.Fill=n(131),r.Spread.Sheets.FormulaTextBox=n(134),e.exports=r},function(e,t,n){function r(e){return!!e&&l._startsWith(e.toString(),"http")}function o(e){var t=e&&e.toString();return!/^0+\d*$/.test(t)&&t-parseFloat(t)+1>=0}function i(e){return!!(o(e)&&e.toString().length>15)}function a(e){var t=e.attrs||{};for(var n in t)if(n.match(/lock-/))return!0}function s(e){return!(!e.attrs||!e.attrs.lock)}var l=n(16);e.exports={isUrl:r,isBigNumber:i,isNumeric:o,hasCellLocks:a,hasSheetLock:s}},function(e,t,n){function r(e,t){this.x=e,this.y=t}function o(e,t,n,r){var o=this;o.x=e,o.y=t,o.width=n,o.height=r}function i(e,t){for(var n,r=e[0],o=r&&r.value?r.value:r,i=1,a=e.length;i<a;i++)r=e[i],n=r&&r.value?r.value:r,o=(t?o>n:o<n)?n:o;return o}function a(e,t,n,r,o,i,a){i&&(e.strokeStyle=i),a&&(e.lineWidth=a),e.beginPath(),e.moveTo(t,n),e.lineTo(r,o),e.stroke()}function s(e,t,n,r,o,i,s,l,u,c,f,d){t?a(e,n,r,o,i,f,d):a(e,s,l,u,c,f,d)}function l(e){return re._getBrightness(e)<127.5?Ie:Oe}function u(e,t,n,r,o,i,a){var s={};return a?(s.left=t+o+i,s.width=r-2*o,s.top=e+o,s.height=n-2*o):(s.left=e+o,s.width=n-2*o,s.top=t+o,s.height=r-2*o),s}function c(e,t){for(var n=0,r=0,o=e.length;r<o;r++)n+=t&&!t(e[r])?0:e[r];return n}function f(e,t,n,r){for(var o,i=[],a=0,s=0,l=e.length;a<l;a++)t?t(e[a])?i[s++]=n?n(e[a]):e[a]:i[s++]=0:(o=Te(e[a]),!xe(o)&&isFinite(o)&&(i[s++]=o));return r&&r(i),i}function d(e,t,n,r,o,i){var a=_e(t+r),s=_e(n+o);t=_e(t),n=_e(n),r=_e(a-t),o=_e(s-n),e.beginPath(),e.fillStyle=i,e.fillRect(t,n,r,o),e.fill()}function p(e,t,n){return e=me(e,t),e=ge(e,n)}function h(e,t,n,r,o){e.save(),e.rect(t,n,r,o),e.clip()}function m(e,t,n,r,o,i){var s,l=n+o/2,u=r+i/2,d=5,p=me(o,i)/2-d,h=-.5*de,m=l+p*he(h),_=u+p*pe(h),v=[],y=[];if(!(p<=0)){var b,w=f(t.values,function(e){return!ne(e)&&!xe(e)&&isFinite(e)},function(e){return be(e)},function(e){1===e.length&&(e[1]=1-e[0])}),C=w.length,S=g(C,t.colors),x=c(w);for(e.save(),b=0;b<C;b++)s=h+w[b]/x*2*de,e.beginPath(),e.moveTo(l,u),e.lineTo(m,_),e.arc(l,u,p,h,s,!1),e.lineTo(l,u),e.fillStyle=S[b],e.fill(),v.push(m),y.push(_),h=s,m=l+p*he(h),_=u+p*pe(h);for(b=0;b<C;b++)a(e,l,u,v[b],y[b],Ie);e.restore()}}function g(e,t){var n=[],r=t.length;if(e<=r)n=t.slice(0,e);else{0===r?(n.push("darkgray"),r=1):n=t.slice(0);var o,i,a=[],s=e-r+1;for(i=0;i<r;i++)a[i]=ie(n[i]);for(i=r;i<e;i++){o=a[i%r];for(var l in o)if(o.hasOwnProperty(l)){var u=o[l];o[l]=fe(u-u/s*(i/r))}o.a=255,n[i]=re._toString(o)}}return n}function _(e,t,n){this.x=e,this.y=t,this.value=n}function v(e,t,n,r,o,s){function l(t){if(t!==ue||typeof t===Ce){var n=p(t,d,c),r=0!==S?(d-n)/S:w/2,o=_e(v+r)-.5;a(e,g,o,g+b,o,De)}}e.save();var c,d,h,m,g,v,b,w,C,S,x=t.points,T=t.mini,E=t.maxi,M=t.line1,A=t.line2,k=t.colorPositive,R=t.colorNegative,I=5;x=f(x,function(e){return!ne(e)&&!xe(e)&&isFinite(e)}),k=ne(k)?"#787878":k,R=ne(R)?Ae:R;var O=i(x,!1);E=ne(E)?O:E,d=ge(E,O);var D=i(x,!0);T=ne(T)?D:T,c=me(T,D),c=c>0?0:c,d=d<0?0:d,h=0,h=h>d?d:h,h=h<c?c-1:h,m=x.length;var P=u(n,r,o,s,I);g=P.left,v=P.top,b=P.width,w=P.height,C=b/(m-1),S=(d-c)/w;for(var N,F,L,H,V,j,B=[],U=v+(d-h)/S,W=0;W<m;W++)N=x[W],V=g+C*W,j=v+(d-N)/S,0===W&&B.push(new _(V,U,h)),W>0&&N*x[W-1]<0&&(L=B[B.length-1])&&(H=y(L.x,L.y,V,j,U),B.push(new _(H,U,h))),B.push(new _(V,j,N)),W===m-1&&B.push(new _(V,U,h));e.beginPath();for(var z=0,Y=B.length;z<Y;z++)(F=B[z])&&(e.lineTo(F.x,F.y),L=B[z-1],F.value===h&&L&&(e.fillStyle=L.value>h?k:R,e.fill(),z!==Y-1&&(e.beginPath(),e.lineTo(F.x,F.y))));l(M),l(A),e.restore()}function y(e,t,n,r,o){return((t-o)*n+(o-r)*e)/(t-r)}function b(e,t,n,r,o,i){function a(t,n,r,o){C=t[n],E=C.x,M=C.y,C=t[n+1],A=C.x,k=C.y,R=se+(E-v)*ue/(y-v),O=se+(A-v)*ue/(y-v),I=le+(_-M)*ce/(_-g),D=le+(_-k)*ce/(_-g),$&&S(e,R,I,O,D,r,oe),Q&&(0===n&&o(R,I),o(O,D))}function s(e,t,n,r,o){var i=w(e,!0),a=w(e,!1);g=ne(W)?i.y:t,_=ne(z)?a.y:n,v=ne(B)?i.x:r,y=ne(U)?a.x:o,y=v>=y?v+1:y,_=g>=_?g+1:_}function l(t,n,r){e.beginPath(),e.arc(t-ie/2,n-ie/2,ie/2,0,2*de,!1),e.fillStyle=r,e.fill()}function c(t,n){e.beginPath(),e.strokeStyle=ee,e.arc(t-ie/2,n-ie/2,ie/2,0,2*de,!1),e.stroke()}function f(t,n){e.beginPath(),e.strokeStyle=re,e.strokeRect(t-ie/2,n-ie/2,ie,ie)}var p,m,g,_,v,y,b,C,T,E,M,A,k,R,I,O,D,P,N,F,L,H,V=t.points1,j=t.points2,B=t.minX,U=t.maxX,W=t.minY,z=t.maxY,Y=t.hLine,G=t.vLine,K=t.xMinZone,X=t.xMaxZone,q=t.yMinZone,J=t.yMaxZone,Z=t.tags,Q=t.drawSymbol,$=t.drawLines,ee=t.color1,re=t.color2,oe=t.dash,ie=4,ae=u(n,r,o,i,5),se=ae.left,le=ae.top,ue=ae.width,ce=ae.height;if(V&&!(V.length<=0)&&(p=x(V),!(p.length<=0||j&&j.length>0&&(m=x(j),m.length<=0)))){if(h(e,n,r,o,i),e.beginPath(),Q=!!ne(Q)||Q,ee=ne(ee)?Me:ee,re=ne(re)?Ae:re,s(p,W,z,B,U),!ne(K)&&!ne(X)&&!ne(q)&&!ne(J)&&v<=K&&K<=y&&v<=X&&X<=y&&g<=q&&q<=_&&g<=J&&J<=_){var fe=ge(v,K),pe=me(y,X),he=ge(g,q),ve=me(_,J);fe>=pe&&(pe=fe+1),he>=ve&&(ve=he+1),d(e,se+(fe-v)*ue/(y-v),le+(_-ve)*ce/(_-g),(pe-fe)*ue/(y-v),(ve-he)*ce/(_-g),Re)}for(P=-Ee,N=-Ee,F=Ee,L=Ee,b=0,T=p.length;b<T-1;b++)a(p,b,ee,c),Z&&(0===b&&(I>N&&(P=R,N=I),I<L&&(F=R,L=I)),D>N&&(P=O,N=D),D<L&&(F=O,L=D));if(j&&j.length>0)for(s(m,g,_,v,y),b=0,T=m.length;b<T-1;b++)a(m,b,re,f);Z&&(l(P,N,Ae),l(F,L,te.BLUE_COLOR)),ne(Y)||g<=Y&&Y<=_&&(H=_e(le+(_-Y)*ce/(_-g))-.5,S(e,se,H,se+ue,H,Ae)),ne(G)||v<=G&&G<=y&&(H=_e(se+(G-v)*ue/(y-v))-.5,S(e,H,le,H,le+ce,Ae)),e.restore()}}function w(e,t){for(var n,o=t?1:-1,i=t?me:ge,a=new r(o*Ee,o*Ee),s=e.length,l=0;l<s;l++)n=e[l],a.x=i(a.x,n.x),a.y=i(a.y,n.y);return a}function C(e,t,n,r){return n/r*(t-e)+e}function S(e,t,n,o,i,s,l){if(l){var u,c,f,d,p=ye(ve(o-t,2)+ve(i-n,2)),h=0,m=6,g=2,_=4,v=[];t<=o?(u=t,c=o,f=t,d=n):(u=o,c=t,f=o,d=i);var y=(i-n)/(o-t),b=n-y*t;v.push(new r(f,d));for(var w=[m,_,g,_];h<p;)for(var S=0,x=w.length;S<x;S++)(h+=w[S])<=p&&(f=C(u,c,h,p),d=y*f+b,v.push(new r(f,d)));for(var T=0,E=v.length;T<E-1;T+=2)a(e,v[T].x,v[T].y,v[T+1].x,v[T+1].y,s)}else a(e,t,n,o,i,s)}function x(e){var t,n,o=[];if((t=e.length)>0)if(n=e[0].length,t<n){if(t>=2)for(var i=0;i<n;i++)o.push(new r(e[0][i],e[1][i]))}else if(n>=2)for(var a=0;a<t;a++)o.push(new r(e[a][0],e[a][1]));return o}function T(e,t,n,r,i,a){function l(t,s,l,u,c){e.fillStyle=t;var f=C,d=S*(s/l);d>S&&(d=S);var p=v?new o(n+i*u,f-d,i*c,d):new o(f,r+a*u,d,a*c);e.fillRect(p.x,p.y,p.width,p.height)}var c=t.measure,f=t.target,d=t.maxi,p=t.good,h=t.bad,m=t.forecast,g=t.tickUnit,_=t.colorScheme,v=t.vertical,y=5;if(!(ne(d)||d<0)){c=ne(c)||c<0?0:c,p=ne(p)||p<0?0:p,h=ne(h)||h<0?0:h,f=ne(f)?0:f,m=ne(m)?0:m,g=ne(g)?0:g,_=ne(_)?"#A0A0A0":_;var b="#252525";c>d&&(c=d,b=Ae),p>d&&(p=d,b=Ae),h>d&&(h=d,b=Ae),f>d&&(f=0,b=Ae),m>d&&(m=d,b=Ae);var w=u(n,r,i,a,y,a-2*y,v),C=w.left,S=w.width;if(e.save(),l(oe(_,1.66),1,1,.2,.6),l(oe(_,1.33),p,d,.2,.6),l(_,h,d,.2,.6),l(b,c,d,.375,.25),m>0){var x=C,T=S*(m/d);T>S&&(T=S),s(e,v,n+.5*i,x,n+.5*i,x-T,x,r+.5*a,x+T,r+.5*a,"#3690BF",3)}if(f>0){var E=_e(C-(v?1:-1)*S*(f/d))-.5;s(e,v,n+.2*i,E,n+.8*i,E,E,r+.2*a,E,r+.8*a,Ae,1)}if(g>0)for(var M,A=fe(d/g),k=0;k<=A;k++)M=_e(C-S/d*g*(v?1:-1)*k)-.5,s(e,v,n,M,n+.05*i,M,M,r+a,M,r+.95*a,ke,1);e.restore()}}function E(e,t,n,r,o,a){var l=t.spreadData,c=t.showAverage,f=t.scaleStart,d=t.scaleEnd,p=t.style,m=t.colorScheme,g=t.vertical,_=5,v=l.length;if(!(v<=0)){var y=l[0].key,b=l[v-1].key;f=ne(f)?y:f,d=ne(d)?b:d,p=ne(p)?4:p,m=ne(m)?ke:m;var w=u(n,r,o,a,_,a-2*_,g),C=w.left,S=w.width,x=w.top,T=w.height;h(e,n,r,o,a),e.beginPath(),e.strokeStyle=m,e.fillStyle=m,e.lineWidth=2;for(var E,k,R,I=i(l,!1),O=0,D=l.length;O<D;O++){var P=l[O],N=P.key,F=P.value;if(E=C+(g?-1:1)*S*(N-f)/(d-f),g?(E=me(E,C),E=ge(E,C-S)):(E=ge(E,C),E=me(E,C+S)),E=_e(E),1===p){R=F/2*T/I,R=R<.5?.5:R;var L=x+T/2-R,H=x+T/2+R;s(e,g,L,E,H,E,E,L,E,H)}else if(4===p)R=F*T/I,R=R<1?1:R,s(e,g,x,E,x+R,E,E,x+T,E,x+T-R);else if(6===p)s(e,g,x,E,x+T,E,E,x,E,x+T);else{var V,j=2;3===p&&(V=M(F,T,j+1,P.randomNumbers));for(var B=1;B<=F;B++){switch(p){case 2:k=x+T/2-_-(F/2-B)*T/I;break;case 3:k=x+T-_-V[B-1];break;case 5:default:k=x+T-B*T/I}k=_e(k),e.beginPath(),e.fillRect(g?k:E,g?E:k,j,j)}}}if(c){var U=A(l);E=C-(g?1:-1)*S*(U-f)/(d-f),s(e,g,x-_,E,x+T+_,E,E,x-_,E,x+T+_,Ae)}e.restore()}}function M(e,t,n,r){for(var o=[],i=ge(100,10*e),a=0,s=[],l=0;o.length<e;){var u=fe(r[l++]*t);(a>i||k(u,s))&&(o.push(u),s.push([u-n,u+n])),a++}return o}function A(e){for(var t=0,n=0,r=0,o=e.length;r<o;r++){var i=e[r];n+=i.value,t+=i.key*i.value}return 0===n?0:t/n}function k(e,t){for(var n=0,r=t.length;n<r;n++){var o=t[n];if(o[0]<=e&&e<=o[1])return!1}return!0}function R(e,t,n,r,o,i,s){function f(t,n,r){if(n=n>g?g:n,!r||r(n)){n=n<0?0:n;var o,i=n/g*O;S?(o=_e(R-i)-.5,a(e,D,o,D+P,o,t)):(o=_e(R+i)-.5,a(e,o,D,o,D+P,t))}}var d,p=t.points,h=t.colorRange,m=t.labelRange,g=t.maximum,_=t.targetRed,v=t.targetGreen,y=t.targetBlue,b=t.targetYellow,w=t.color,C=t.highlightPosition,S=t.vertical,x=t.textOrientation,T=t.textSize,E=5;if(!(ne(p)||(d=p.length)<=0)){if(w=ne(w)?ke:w,ne(h)||h.length!==d||I(h)){h=[];for(var M=0;M<d;M++)h.push(oe(w,1+M/d))}var A=c(p,function(e){return e>0});g=ne(g)||g<A?A:g,x=ne(x)?0:x,T=ne(T)||T<=0?10:T,T=xe(T)?T:T*s.zoomFactor;var k=u(n,r,o,i,E,i-2*E,S),R=k.left,O=k.width,D=k.top,P=k.height;e.save();for(var N,F,L,H,V,j,B=R,U=0,W=d;U<W;U++)if(!((j=p[U])<=0)){N=j/g*O,S?(F=n+.15*o,H=.7*o,L=B-N,V=N):(F=B,H=N,L=r+.15*i,V=.7*i);var z=U+1===C?Ae:h[U];e.fillStyle=z,e.beginPath(),e.fillRect(F,L,H,V);var Y=m&&m[U];Y&&(e.save(),e.fillStyle=l(z),e.textBaseline=Be,e.textAlign=He,e.font=T+Ue,e.rect(F,L,H,V),e.clip(),e.beginPath(),1===x?(e.translate(F+H/2,L),e.rotate(Math.PI/2),e.fillText(Y,V/2,0)):e.fillText(Y,F+H/2,L+V/2),e.restore()),B+=(S?-1:1)*N}f(Ne,_,function(e){return e>0}),f(Pe,v),f(De,y),f("yellow",b),e.restore()}}function I(e){for(var t=0,n=e.length;t<n;t++)if(ne(e[t]))return!0;return!1}function O(e,t,n,r,o,i){a(e,N(t),N(n),N(r),N(o),ne(i)?Oe:i,1)}function D(e,t,n,r,o){var i=.4*r;t=N(t),n=N(n),e.beginPath(),e.moveTo(t,n);var a,s,l=i/2,u=ye(3)*i/2,c=i/ye(3);switch(o){case 0:a=[-l,0,l],s=[u,c,u];break;case 2:a=[-l,0,l],s=[-u,-c,-u];break;case 3:a=[u,c,u],s=[-l,0,l];break;case 1:a=[-u,-c,-u],s=[-l,0,l]}a.forEach(function(r,o){e.lineTo(N(t+r),N(n+s[o]))}),e.lineTo(t,n),e.closePath(),e.fillStyle=Ie,e.fill()}function P(e,t,n,i,a,s,l){var u,c,f,p,m,g,_=n.value,v=n.colorScheme,y=5,b=5,w=.7,C=!1;if(_=Te(_),!xe(_)){if(_>1?(_=1,C=!0):_<-1&&(_=-1,C=!0),v=ne(v)?"grey":v,t.save(),0===e){var S=s-2*y,x=l*w;if(_>=0)C&&(u=new r(i+y+S-b,a+l/2)),c=new o(i+y,a+l*(1-w)/2,S*_,x),f=new r(i+y,a+1),p=new r(i+y,a+l),m=1;else{var T=be(S*_);C&&(u=new r(i+y+b,a+l/2)),c=new o(i+s-y-T,a+l*(1-w)/2,T,x),f=new r(i+s-y,a+1),p=new r(i+s-y,a+l),m=3}g=l}else if(1===e){var E=l-2*y,M=s*w;if(_>=0){var A=E*_;c=new o(i+(1-w)/2*s,a+l-y-A,M,A),C&&(u=new r(i+s/2,a+l-y-A+b),m=0),f=new r(i+1,a+l-y),p=new r(i+s,a+l-y)}else _=be(_),c=new o(i+(1-w)/2*s,a+y,M,E*_),C&&(u=new r(i+s/2,a+y+E-b),m=2),f=new r(i+1,a+y),p=new r(i+s,a+y);g=s}t.beginPath(),d(t,c.x,c.y,c.width,c.height,v),h(t,c.x,c.y,c.width,c.height),u&&D(t,u.x,u.y,g,m),t.restore(),O(t,f.x,f.y,p.x,p.y),t.restore()}}function N(e){return _e(e)-.5}function F(e,t,n,r,o,i){P(0,e,t,n,r,o,i)}function L(e,t,n,r,o,i){P(1,e,t,n,r,o,i)}function H(e,t,n,r,o,i,a){function s(t,a,s,l,c,p,m,g,_,b,C,S,x,T){var E,M,k,R;if(I?(E=n+N*o,M=0===a?Y-G:Y,k=o*P,R=G,d(e,E,M,k,R,t)):(E=0===a?Y:Y-G,M=r+N*i,k=G,R=i*P,d(e,E,M,k,R,t)),w&&(h(e,E,M,k,R),I?D(e,n+o/2,f+s,y,c):D(e,f+l,r+i/2,y,p),e.restore()),A){var O,L=0;w&&(L=.4*y*ye(3)/2+F+2),e.save(),e.beginPath(),e.font=V+Ue,e.fillStyle=Oe,I?(e.textAlign=He,O=V+G+m,u(O,T,t,g,_,E,M,k,R,I),e.fillText(v,n+o/2,Y+x*(G-L))):(e.textBaseline=Be,O=e.measureText(v).width+G+b,u(O,T,t,C,S,E,M,k,R,I),e.fillText(v,Y+x*(L-G),r+i/2)),e.restore()}}function u(t,n,r,o,i,a,s,u,c,f){f?e.textBaseline=o:e.textAlign=o,t>0&&n<G&&(e.rect(a,s,u,c),e.clip(),f?e.textBaseline=i:e.textAlign=i,e.fillStyle=l(r))}function c(t,n,r,o,i,a,s,l,u,c){I?O(e,t,n,r,o,u):O(e,i,a,s,l,c)}var f,m,g,_,v,y,b,w,C=t.variance,S=t.reference,x=t.mini,T=t.maxi,E=t.mark,M=t.tickUnit,A=t.legend,k=t.colorPositive,R=t.colorNegative,I=t.vertical,P=.5,N=.5-P/2,F=5,L=Ae,H=Me,V=13*a.zoomFactor;if(C=Te(C),!xe(C)){if(R=ne(R)?Ne:R,k=ne(k)?Pe:k,M=ne(M)?0:M,T=ne(T)?1:T,x=ne(x)?-1:x,b=!ne(S),b||(S=0),I?(f=r+i-F,m=i-2*F,g=o-4*F,_=-1):(f=n+F,m=o-2*F,g=i-4*F,_=1),A){var j=Te(t.variance);if(!xe(j)){var B=j.toString(),U=B.substr(B.indexOf(".")+1).length;v=U>=2?(100*j).toFixed(U-2)+"%":(100*j).toFixed(0)+"%"}}C>T&&(C=T,w=!0),C<x&&(C=x,w=!0),S=p(S,T,x),w&&(y=p(g,60,15));var W=be(T-x),z=m/W,Y=f+_*be(x-S)*z,G=be(C-S)*z;G>be(W)*z&&(G=be(W+x)*z);var K=f+_*m;if(!(I&&Y<K||!I&&Y>K)){if(h(e,n,r,o,i),C>S?s(k,0,F-m,m-F,0,1,r-Y,je,Ve,Y-n-o,Fe,Le,-1,be(T-C)*z):(G>be(W)*z&&(G=be(W+x)*z,Y=f),s(R,1,-F,F,2,3,Y-r-i,Ve,je,n-Y,Le,Fe,1,be(x-C)*z)),b){var X=f+_*(Math.abs(x-S)*z);c(n,X,n+o,X,X,r,X,r+i)}if(M>0){e.beginPath();for(var q=W/M,J=0;J<=q;J++){var Z=f+m/q*J*_;c(n,Z,n+.1*o,Z,Z,r+.9*i,Z,r+i,H,H)}}if(!ne(E)&&x<=E&&E<=T){e.beginPath();var Q=f-(I?1:-1)*be(x-E)*z;c(n,Q,n+.33*o,Q,Q,r+.66*i,Q,r+i,L,L),e.fill()}e.restore()}}}function V(e,t,n,r,o,a){function l(t,n,r,o,i,a,s,l,u){x?d(e,n,r,o,i,t):d(e,a,s,l,u,t)}function p(t,n,r,o){s(e,x,Q+$*t,r,Q+$*n,r,r,Q+$*t,r,Q+$*n,o)}var m=t.points,g=t.boxPlotClass,_=t.showAverage,v=t.scaleStart,y=t.scaleEnd,b=t.acceptableStart,w=t.acceptableEnd,C=t.style,S=t.colorScheme,x=t.vertical,T=5,E=i(m,!1),M=i(m,!0);if(!(ne(m)||(m=f(m),m.length<=0))){g=g===ue||typeof g!==Se?ze:g.toLocaleLowerCase(),g!==ze&&g!==We&&g!==Ye&&g!==Ge&&g!==Ke&&(g=ze),v=Te(v),v=xe(v)?M:v,y=Te(y),y=xe(y)?E:y,b=Te(b),w=Te(w),S!==ue&&typeof S===Se||(S="#D2D2D2"),(C===ue||0!==C&&1!==C)&&(C=0);var A=Ae;v>M&&(S=A,v=M),y<E&&(S=A,y=E),h(e,n,r,o,a),e.lineWidth=2;for(var k=u(n,r,o,a,T,a-2*T,x),R=k.left,I=k.width,O=k.top,D=k.height,P=x?-1:1,N=t.perc02,F=t.perc09,L=t.perc10,H=t.perc90,V=t.perc91,j=t.perc98,B=t.q1,U=t.q3,W=U-B,z=M,Y=E,G=1.5*W,K=1.5*W,X=t.stDev,q=c(m)/ge(1,m.length),J=0,Z=0,Q=O+.1*D,$=.7*D,ee=be(y-v),te=0,re=m.length;te<re;te++){var oe=m[te];oe<B&&oe>=B-1.5*W&&oe-(B-1.5*W)<G&&(G=oe-(B-1.5*W),z=oe),oe>U&&oe<=U+1.5*W&&U+1.5*W-oe<K&&(K=U+1.5*W-oe,Y=oe);var ie=!1;J=R+P*(I*((oe-v)/ee)),g===Ye&&(oe<=B-1.5*W||oe>=U+1.5*W)&&(ie=!0,Z=oe<=B-3*W||oe>=U+3*W?0:1),g===We&&(oe<=N||oe>=j)&&(ie=!0,Z=1),g===Ke&&(oe<=q-2*X||oe>=q+2*X)&&(ie=!0,Z=oe<=q-3*X||oe>=q+3*X?0:1);var ae=Me;if(ie)if(1===C)1===Z?p(.2,.8,J,ae):p(.3,.7,J,ae);else{var se=.1*D;se<2&&(se=2),e.beginPath(),e.strokeStyle=ae;var le=O+.45*D,ce=J;e.arc(x?le:ce,x?ce:le,se/2,0,2*Math.PI),e.stroke()}}if((v>b||y<w)&&(S="#C0FF00"),b=ge(v,b),w=me(y,w),b>w)S=A;else if(b<w){var fe=R+P*(I*((b-v)/ee)),de=R+P*(I*((w-v)/ee)),pe=O+.9*D;s(e,x,pe,fe,pe,de,fe,pe,de,pe,ke)}var he,_e,ve,ye,we=R+P*(I*((B-v)/ee)),Ce=be(R+P*(I*((U-v)/ee))-we),Ee=t.median,Re=R+P*(I*((Ee-v)/ee));switch(g){case We:ve=N,ye=j;break;case Ye:ve=z,ye=Y;break;case Ke:we=R+P*(I*((q-X-v)/ee)),Ce=be(R+P*(I*((q+X-v)/ee))-we),Re=R+P*(I*((q-v)/ee));var Ie=q-2*X;ve=Ie>v?Ie:M,Ie=q+2*X,ye=Ie<y?Ie:E,_=!1;break;case ze:case Ge:default:ve=M,ye=E}he=R+P*(I*((ve-v)/ee)),_e=R+P*(I*((ye-v)/ee));var Oe=Me;if(1===C)l("#F2F2F2",Q,_e,$,he-_e,he,Q,_e-he,$);else{var De=O+.45*D;s(e,x,De,he,De,_e,he,De,_e,De,Oe)}if(l(S,Q,we-Ce,$,Ce,we,Q,Ce,$),s(e,x,Q,Re,Q+$,Re,Re,Q,Re,Q+$,Oe),0===C&&(s(e,x,Q+.3*$,_e,Q+.7*$,_e,_e,Q+.3*$,_e,Q+.7*$,Oe),s(e,x,Q+.3*$,he,Q+.7*$,he,he,Q+.3*$,he,Q+.7*$,Oe)),g===We||g===Ge){var Pe,Ne;g===We?(ve=F,ye=V):(ve=L,ye=H),Pe=R+P*(I*((ve-v)/ee)),Ne=R+P*(I*((ye-v)/ee)),p(.3,.7,Ne,Oe),p(.3,.7,Pe,Oe)}_&&(J=R+P*(I*((q-v)/ee)),p(.2,.8,J,A)),e.restore()}}function j(e,t,n,r,o){t=_e(t),n=_e(n),r=_e(r),o=_e(o),t===r&&(r-=.5,t=r),n===o&&(o-=.5,n=o),e.moveTo(t,n),e.lineTo(r,o)}function B(e,t,n,r,o,i,a,s,l,u,c){e.beginPath(),e.strokeStyle=n,t?j(e,r,o,i,a):j(e,s,l,u,c),e.stroke()}function U(e,t,n,r,o,i){function a(e,t,n,r,o){e.rect(t,n,r,o),e.clip()}var s=i.labelText,u=i.fontSize,c=i.startBox,f=i.endBox,d=i.boxColor,p=i.isInRightOrTopOfBox;e.save(),e.beginPath(),e.font=u+Ue;var h,m,g,_,v,y=1,b=Oe;if(i.vertical)_=He,p?(h=u+f-(c-n),h>0&&c-f-n<f?(v=Ve,b=l(d),g=c-f+y,a(e,t,c-f,r,f)):(v=je,g=c-f-y)):(h=u-(n+o-c),h>0&&n+o-c<f?(a(e,t,c-f,r,f),v=je,b=l(d),g=c-y):(v=Ve,g=c+y)),e.textAlign=_,e.textBaseline=v,e.fillStyle=b,e.fillText(s,t+r/2,g);else{v=Be;var w=e.measureText(s);p?(h=w.width+f-(t+r-c),h>0&&t+r-(c+f)<f?(a(e,c,n,f,o),_=Le,b=l(d),m=c+f-y):(_=Fe,m=c+f+y)):(h=w.width-(c-t),h>0&&c-t<f?(a(e,c,n,f,o),m=c+y,_=Fe,b=l(d)):(_=Le,m=c-y)),e.textAlign=_,e.textBaseline=v,e.fillStyle=b,e.fillText(s,m,n+o/2)}e.restore()}function W(e,t,n,r,o,i,a){var s=t.points,l=t.labels,c=t.pointIndex,f=t.minimum,p=t.maximum,m=t.colorPositive,g=t.colorNegative,_=t.vertical,v=5,y=13*a.zoomFactor;if(!ne(s)){var b=s.length;if(!(b<=0||(c=parseInt(c),xe(c)||c<=0||c>b))){l=ne(l)?[]:l,m!==ue&&typeof m===Se||(m="#8CBF64"),g!==ue&&typeof g===Se||(g="#D6604D");for(var w=m,C=oe(m,1.3),S=g,x=oe(g,1.3),T=1,E=0,M=0,A=0,k=0,R=[],I=0,O=0,D=s.length;O<D;O++){var P=s[O];R[T]=[];var N=R[T];xe(P)?(N[0]=0,N[1]=E,N[2]=0):(N[0]=be(P),E=P+E,N[1]=P>0?M:E,N[2]=P),N[3]=T,A=me(M,A),k=ge(M,k),T===b&&(I=A<0?-A:0,N[1]=P>0?0:P),M=P+M,T++}E-=P;var F,L;f=Te(f),xe(f)||f>0||f>A?(F=A,f=A):(F=f,I=-f),p=Te(p),xe(p)||p<0||p<k?L=k:(L=p,I=-f);var H=u(n,r,o,i,v,i-2*v,_),V=H.left,j=H.width,W=H.top,z=H.height,Y=_?-1:1,G=L-F,K=j/G;h(e,n,r,o,i),e.beginPath(),e.lineWidth=1;var X,q=R[c],J=q[2],Z=V+Y*(q[1]+I)*K,Q=q[0]*K;if(X=1===c||c===b?J>=0?w:S:J>=0?C:x,_?d(e,W,Z-Q,z,Q,X):d(e,Z,W,Q,z,X),_){if(1!==c)if(c!==b)B(e,J>0,Re,n,Z,W+z,Z,n,Z-Q,W+z,Z-Q);else{var $=V-(E+I)*K;B(e,!0,Re,n,$,W+z,$)}c!==b&&B(e,J>0,Re,W,Z-Q,n+o,Z-Q,W,Z,n+o,Z)}else{if(1!==c)if(c!==b)B(e,J>0,Re,Z,r,Z,W+z,Z+Q,r,Z+Q,W+z);else{var ee=V+(E+I)*K;B(e,!0,Re,ee,r,ee,W+z)}c!==b&&B(e,J>0,Re,Z+Q,W,Z+Q,r+i,Z,W,Z,r+i)}var te=l[c-1];l.length>0&&!ne(te)&&""!==te&&U(e,n,r,o,i,{labelText:te,vertical:_,isInRightOrTopOfBox:J>0,fontSize:y,startBox:Z,endBox:Q,boxColor:X}),B(e,_,Oe,n,V-I*K,n+o,V-I*K,V+I*K,r,V+I*K,r+i),e.restore()}}}function z(e,t,n,r,o,i,a){function s(e){return e=Te(e),e=xe(e)?0:e,e=e<0?0:e,e=e>1?1:e}var l=t.points,c=t.pointIndex,f=t.colorRange,p=t.target,m=t.target2,g=t.highlightPosition,_=t.label,v=t.vertical,y=5,b=13*a.zoomFactor;if(!ne(l)){var w=l.length;if(!(w<=0||(c=parseInt(c),xe(c)||c<=0||c>w))){f=ne(f)?[]:f,p=s(p),m=s(m),_=parseInt(_),_=xe(_)?0:_;for(var C=1,S=0,x=[],T=0,E=l.length;T<E;T++){var M=l[T];x[C]=[];var A=x[C];M<0||xe(M)||ne(M)?(A[0]=1===C?0:S,A[1]=0):(S+=M,A[0]=1===C?0:S-M,A[1]=M),C++}var k=u(n,r,o,i,y,i-2*y,v),R=k.left,I=k.width,O=k.top,D=k.height,P=v?-1:1,N=I/S;h(e,n,r,o,i),e.beginPath(),e.lineWidth=1;var F,L=x[c],H=L[1],V=R+P*L[0]*N,j=L[1]*N;F=c===g?Ae:0===f.length||typeof f[c-1]!==Se?Me:f[c-1],v?d(e,O,V-j,D,j,F):d(e,V,O,j,D,F);var W;1===_?W=(L[0]+H)/S*1e3:2===_&&(W=H/S*1e3);var z=_e(W)/10+"%";1!==_&&2!==_||""===z||U(e,n,r,o,i,{labelText:z,vertical:v,isInRightOrTopOfBox:(L[0]+L[1])*N<I/2,fontSize:b,startBox:V,endBox:j,boxColor:F});var Y=["#8CBF64","#EE5D5D"];[p,m].forEach(function(t,a){var s=we(R+P*I*t);B(e,v,Y[a],n,s,n+o,s,s,r,s,r+i)}),e.restore()}}}function Y(e,t){switch(t){case 2:return e%4==0&&e%100!=0||e%400==0?29:28;case 4:case 6:case 9:case 11:return 30;default:return 31}}function G(e,t,n){e<0&&(e=0),e>1&&(e=1);var r=ie(t),o=ie(n),i=r.a*(1-e)+o.a*e,a=r.r*(1-e)+o.r*e,s=r.g*(1-e)+o.g*e,l=r.b*(1-e)+o.b*e;return"rgba("+parseInt(a,10)+","+parseInt(s,10)+","+parseInt(l,10)+","+Te(i/255)+")"}function K(e,t,n){return e===t&&e===n?1:e<=t?0:e>=n?1:(e-t)/(n-t)}function X(e,t,n,r,o,i){var a=(i+o)/2;return o<=r&&r<=a?G(K(r,o,a),e,t):G(K(r,a,i),t,n)}function q(e){var t=Ee,n=-Ee;return e.forEach(function(e){e!==ue&&e!==ce&&(t>e&&(t=e),n<e&&(n=e))}),{min:t,max:n}}function J(e,t,n,r,o,i,a){if(r)e.forEach(function(e,o){0!==e&&e!==ue&&e!==ce&&(t[n+o]=r[o])});else{var s=q(e),l=s.min,u=s.max;e.forEach(function(e,r){0!==e&&e!==ue&&e!==ce&&(t[n+r]=X(o,i,a,e,l,u))})}}function Z(e,t,n,r,o,i){for(var a=t.year,s=t.month,l=t.values,u=t.emptyColor||"lightgray",c=t.startColor,f=t.middleColor,d=t.endColor,p="white",h=6,m=7,g=2,_=(o-(h+1)*g)/h,v=(i-(m+1)*g)/m,y=[],b=new Date(a,s-1,1).getDay(),w=0;w<h*m;w++)w<b?y[w]=p:w<b+Y(a,s)?y[w]=u:y[w]=p;J(l,y,b,t.colors,c,f,d),e.save(),e.rect(n,r,o,i),e.clip(),e.beginPath();for(var C=0,S=0;S<h;S++)for(var x=0;x<m;x++)e.fillStyle=y[C++],e.fillRect(n+S*_+(S+1)*g,r+x*v+(x+1)*g,_,v);e.restore()}function Q(e){for(var t=e.getFullYear(),n=e.getMonth(),r=e.getDate(),o=1;o<n+1;o++)r+=Y(t,o);return r}function $(e,t,n,r,o,i,a){for(var s=t.year,l=t.values,u=t.emptyColor||"lightgray",c=t.startColor,f=t.middleColor,d=t.endColor,p="white",h=7,m=parseInt(366/h)+2,g=[],_=new Date(s,0,1).getDay(),v=Q(new Date(s,11,31)),y=0;y<m*h;y++)g[y]=y<_?p:y<_+v?u:p;J(l,g,_,t.colors,c,f,d),e.save(),e.rect(n,r,o,i),e.clip();var b=a.zoomFactor,w=15*b,C=n+w,S=r,x=o-w,T=i;e.save(),e.translate(n+w/2,S+T),e.rotate(-Math.PI/2),e.font=13*b+Ue,e.fillStyle="black",e.textBaseline="middle",e.textAlign="center",e.fillText(s,T/2,0),e.restore();var E,M,A,k=2,R=(x-(m+1)*k)/m,I=(T-(h+1)*k)/h,O=0,D=[];for(M=0;M<m;M++)for(E=0;E<h;E++)A={x:C+M*R+(M+1)*k,y:S+E*I+(E+1)*k,w:R,h:I},D[O]=A,e.fillStyle=g[O++],e.fillRect(A.x,A.y,A.w,A.h);for(var P=[],N={},F=0;F<12;F++)N[F]=Q(new Date(s,F,1))-1+_;var L=N[11]+Y(s,12)-1;for(O=0,M=0;M<m;M++)for(E=0;E<h;E++){if(_<=O&&O<_+v){var H=new Date(s,0,O-_+1),V=H.getMonth(),j=N[V];A=D[O],j<=O&&O<7+j&&P.push({x1:A.x,y1:A.y-k/2,x2:A.x,y2:A.y+A.h+k/2}),O!==j&&0!==H.getDay()||P.push({x1:A.x-k/2,y1:A.y,x2:A.x+A.w+k/2+(O===j?k:0),y2:A.y}),L-7<O&&O<=L&&P.push({x1:A.x+A.w,y1:A.y-k/2,x2:A.x+A.w,y2:A.y+A.h+k/2}),O!==L&&6!==H.getDay()||P.push({x1:A.x-k/2-(O===L?k:0),y1:A.y+A.h,x2:A.x+A.w+k/2,y2:A.y+A.h})}O++}e.strokeStyle="black",e.lineWidth=2;for(var B=0;B<P.length;B++){var U=P[B];e.beginPath(),e.moveTo(U.x1,U.y1),e.lineTo(U.x2,U.y2),e.stroke()}e.restore()}var ee=n(0),te=n(7),ne=ee._Types._isNullOrUndefined,re=ee._ColorHelper,oe=re._getLighterColor,ie=re._fromString,ae=ee._ArrayHelper,se=ae._indexOf,t={},le=t.__invalidValuePlaceHolder={},ue=null,ce=void 0,fe=Math.floor,de=Math.PI,pe=Math.sin,he=Math.cos,me=Math.min,ge=Math.max,_e=Math.round,ve=Math.pow,ye=Math.sqrt,be=Math.abs,we=Math.ceil,Ce="undefined",Se="string",xe=isNaN,Te=parseFloat,Ee=Number.MAX_VALUE,Me="#969696",Ae="#CB0000",ke="#646464",Re="#DCDCDC",Ie="white",Oe="black",De="blue",Pe="green",Ne="red",Fe="left",Le="right",He="center",Ve="top",je="bottom",Be="middle",Ue="px Arial",We="7ns",ze="5ns",Ye="tukey",Ge="bowley",Ke="sigma3",Xe=function(){function e(){var e=this;e._minItemHeight=2,e._cachedMinDatetime=Ee,e._cachedMaxDatetime=-Ee,e._cachedMinValue=Ee,e._cachedMaxValue=-Ee}function t(e,t,n,r){var o=this;o.X=e,o.Y=t,o.Width=n,o.Height=r,o.Left=o.X,o.Right=o.Left+o.Width,o.Top=o.Y,o.Bottom=o.Y+o.Height}return e.prototype={constructor:e,paint:function(e,t,n,r,o,i){var a=this;a.options=t,a.setting=t.settings;var s=t.values,l=t.dateValues,u=t.zoomFactor;e.save(),e.rect(n,r,o,i),e.clip(),e.beginPath(),0===t.sparklineType&&a._paintLines(e,n,r,o,i,s,l,u),a._paintDataPoints(e,n,r,o,i,s,l,u),a._paintAxis(e,n,r,o,i,s,l,u),e.restore()},_getSpace:function(e){return 0===this.options.sparklineType?3+this._getLineWeight(e)+1:3},_getCachedIndexMaping:function(e,t){var n=this._cachedIndexMapping;if(n)return n;n=this._cachedIndexMapping=[];var r,o,i=e.length;if(this.options.displayDateAxis){var a=t.length,s=me(i,a),l=[];s>0&&(l=t.slice(0,s)),l.sort(function(e,t){return e===t?0:(e===le&&(e=0),t===le&&(t=0),e-t)});var u,c,f=l.length;for(r=0;r<f;r++)if(typeof(u=l[r])!==Ce&&u!==ue){for(c=se(t,u);ae._contains(n,c);)c=se(t,u,c+1);isNaN(u)||(o=e[c])!==ce&&o!==ue&&isNaN(o)&&o!==le||n.push(c)}}else for(r=0;r<i;r++)typeof(o=e[r])!==Ce&&o!==ue&&isNaN(o)&&o!==le||n.push(r);return n},_getValue:function(e,t){var n=t[e];return typeof n===Ce||n===ue?1===this.setting.options.displayEmptyCellsAs&&(n=0):n===le&&(n=0),n},_paintLines:function(e,t,n,r,o,i,a,s){var l,u,c,f=this,d=f._getCachedIndexMaping(i,a),p=d.length-1;p<0&&(p=0);var h,m,g,_,v,y,b,w=f.setting.options,C=f.linePos=[],S=w.displayEmptyCellsAs;for(l=0;l<p;l++)if(typeof(h=f._getValue(d[l],i))!==Ce&&h!==ue){if(g=l+1,typeof(m=f._getValue(d[g],i))===Ce||m===ue)if(1===S)m=0;else if(2===S)for(g=l+2;g<=p;g++)if(typeof(y=i[d[g]])!==Ce&&y!==ue){m=y;break}typeof m!==Ce&&m!==ue?(_=f._getDataPointPosition(d[l],{Width:r,Height:o},i,a,s),v=f._getDataPointPosition(d[g],{Width:r,Height:o},i,a,s),b=_.Width/2,u={X:_.X+b,Y:_.Y+b},c={X:v.X+b,Y:v.Y+b},C[l]={P1:u,P2:c}):l++}var x,T=C.length;if(T>0)for(e.strokeStyle=f.options.getColor(w.seriesColor),e.lineCap="round",e.lineWidth=f._getLineWeight(s),l=0;l<T;l++)(x=C[l])&&(e.beginPath(),u=x.P1,c=x.P2,e.moveTo(t+u.X,n+u.Y),e.lineTo(t+c.X,n+c.Y),e.stroke(),e.closePath())},_getDataPointColor:function(e,t,n){var r=this,o=r.options,i=r.setting.options,a=ue,s=r._getValue(e,t),l=r._getCachedIndexMaping(t,n),u=l.length,c=o.getColor.bind(r);if(typeof s!==Ce&&s!==ue){if(r._cachedMinValue!==Ee&&r._cachedMaxValue!==-Ee||r._getMaxMinValue(t),s===r._cachedMinValue&&i.showLow&&(a=c(i.lowMarkerColor)),typeof a!==Ce&&a!==ue||s===r._cachedMaxValue&&i.showHigh&&(a=c(i.highMarkerColor)),typeof a===Ce||a===ue)if(o.displayDateAxis){var f=se(l,e);0===f&&i.showFirst&&(a=c(i.firstMarkerColor))}else 0===e&&i.showFirst&&(a=c(i.firstMarkerColor));if(typeof a===Ce||a===ue)if(o.displayDateAxis){var d=se(l,e);d===u-1&&i.showLast&&(a=c(i.lastMarkerColor))}else e===u-1&&i.showLast&&(a=c(i.lastMarkerColor));if(typeof a!==Ce&&a!==ue||s<0&&i.showNegative&&(a=c(i.negativeColor)),typeof a===Ce||a===ue){var p=o.sparklineType;0===p?i.showMarkers&&(a=c(i.markersColor)):1===p?a=c(i.seriesColor):2===p&&(a=c(i.seriesColor))}}return a===ce||a===ue?"Transparent":a},_paintDataPoints:function(e,t,n,r,o,i,a,s){for(var l,u,c,f,d,p,h,m,g,_=this,v={Width:r,Height:o},y=_._getCachedIndexMaping(i,a),b=y.length,w=_.options.sparklineType,C=0;C<b;C++)l=y[C],u=_._getDataPointColor(l,i,a),c=_._getDataPointPosition(l,v,i,a,s),e.fillStyle!==u&&(e.fillStyle=u),0===w?(e.save(),f=t+c.X+c.Width/2,d=n+c.Y+c.Height/2,e.translate(f,d),e.rotate(45*de/180),e.fillRect(0-c.Width/2,0-c.Height/2,c.Width,c.Height),e.restore()):(p=t+c.X+c.Width/4,p=fe(p),h=n+c.Y,m=c.Width/2,g=c.Height,e.fillRect(p,h,m,g))},_paintAxis:function(e,t,n,r,o,i,a,s){var l=this,u=l.setting&&l.setting.options;if(u&&u.displayXAxis&&l._hasAxis(i,a)){var c={Width:r,Height:o},f=l._getSpace(s),d=c.Width-l._getSpace(s),p=fe(l._getAxisY(c,i,s))+.5,h=p,m=l.options.getColor(u.axisColor),g=s;g<1&&(g=1),e.strokeStyle!==m&&(e.strokeStyle=m),e.lineWidth!==g&&(e.lineWidth=g),e.beginPath(),e.moveTo(t+f,n+p),e.lineTo(t+d,n+h),e.stroke()}},_hasAxisNormal:function(e){var t=this._getActualMaxValue(e);if(t!==-Ee){var n=this._getActualMinValue(e);if(n!==Ee)return t===n||t*n<=0}return!0},_hasAxis:function(e,t){var n=this._hasAxisNormal(e);if(2!==this.options.sparklineType)return n;var r,o,i=this._getCachedIndexMaping(e,t),a=i.length;if(!n&&a>0)for(var s=0;s<a;s++)if(r=i[s],typeof(o=e[r])!==Ce&&o!==ue)return!0;return n},_getMinDatetime:function(e,t){var n=this._cachedMinDatetime;return(isNaN(n)||n===Ee)&&this._getMaxMindatetimes(e,t),this._cachedMinDatetime},_getMaxDatetime:function(e,t){var n=this._cachedMaxDatetime;return(isNaN(n)||n===-Ee)&&this._getMaxMindatetimes(e,t),this._cachedMaxDatetime},_getMaxMindatetimes:function(e,t){for(var n,r,o,i=this,a=new Date(0,0,0),s=Ee,l=i._getCachedIndexMaping(e,t),u=l.length,c=0;c<u;c++)n=l[c],r=t[n],isNaN(r)||(o=i._getValue(n,e))!==ue&&typeof o===Ce||isNaN(o)||typeof r!==Ce&&r!==ue&&(r>a&&(a=r),r<s&&(s=r));i._cachedMaxDatetime=a,i._cachedMinDatetime=s},_calcItemWidth:function(e,t,n,r){var o,i,a,s=this,l=s._getMinDatetime(t,n),u=s._getMaxDatetime(t,n),c=[],f=s._getCachedIndexMaping(t,n),d=f.length;for(o=0;o<d;o++)a=f[o],typeof(i=n[a])===Ce||i===ue||isNaN(i)||i&&c.push(i);c.sort(function(e,t){return e-t});var p=c.length;if(p>1&&l!==u){var h,m=Ee,g=0;for(o=1;o<p;o++)h=c[o],i=h-c[o-1],i<m&&i>0&&(m=i),g+=i;var _=(e.Width-s._getSpace(r)-s._getSpace(r))*m/g/2;return _<2&&(_=2),_}return(e.Width-s._getSpace(r)-s._getSpace(r))/2},_getItemWidth:function(e,t,n,r){var o=this;if(o.options.displayDateAxis)return o._calcItemWidth(e,t,n,r);var i=o._getCachedIndexMaping(t,n).length;return(e.Width-o._getSpace(r)-o._getSpace(r))/i},_getItemX:function(e,t,n,r,o){var i,a=this,s=a._getSpace(o);if(a.options.displayDateAxis){i=a._getItemWidth(e,n,r,o);var l=a._getMaxDatetime(n,r),u=a._getMinDatetime(n,r);if(l===u)return s+i/2;var c=r[t];if(!c)return 0;var f=e.Width-s-a._getSpace(o);f-=i;return s+fe((c-u)/(l-u)*f)}i=a._getItemWidth(e,n,r,o);var d=se(a._getCachedIndexMaping(n,r),t);return fe(s+i*d)},_getCanvasSize:function(e,t){var n=this,r=e.Width-n._getSpace(t)-n._getSpace(t);r=ge(r,0);var o=e.Height-n._getSpace(t)-n._getSpace(t);return o=ge(o,0),{Width:r,Height:o}},_getMaxMinValue:function(e){for(var t,n=this,r=e.length,o=0;o<r;o++)typeof(t=e[o])!==Ce&&t!==ue&&("number"!=typeof t&&(t=0),t<n._cachedMinValue&&(n._cachedMinValue=t),t>n._cachedMaxValue&&(n._cachedMaxValue=t))},_getActualMaxValue:function(e){var t=this;t._cachedMaxValue!==-Ee&&t._cachedMaxValue||t._getMaxMinValue(e);var n=t.setting.options,r=n.maxAxisType;return 0===r?t._cachedMaxValue:1===r?n.groupMaxValue:2===r?n.manualMax:t._cachedMaxValue},_getActualMinValue:function(e){var t=this;t._cachedMinValue!==Ee&&t._cachedMinValue||t._getMaxMinValue(e);var n=t.setting.options,r=n.minAxisType;return 0===r?t._cachedMinValue:1===r?n.groupMinValue:2===r?n.manualMin:void 0},_getItemHeightNormal:function(e,t,n,r){var o,i,a=this._getCanvasSize(e,r),s=this._getActualMaxValue(n),l=this._getActualMinValue(n),u=s-l;if(s===l){if(0===s)return 0;u=be(s)}return o=n[t],o||(o=0),i=a.Height/u,o*i},_getItemHeight:function(e,t,n,r){var o,i=this,a=i.options.sparklineType;if(0===a)return i._getItemHeightNormal(e,t,n,r);if(1===a){if((typeof(o=n[t])===Ce||o===ue)&&1===i.setting.options.displayEmptyCellsAs)return 0;var s=i._getItemHeightNormal(e,t,n,r);if(s>-i._minItemHeight&&s<i._minItemHeight){if(o>0)return s+i._minItemHeight;if(o<0)return s-i._minItemHeight}return s}if(2===a){if(typeof(o=n[t])===Ce||o===ue||0===o||isNaN(o))return 0;var l=i._getCanvasSize(e,r);return o>=0?l.Height/2:-l.Height/2}},_getAxisYNormal:function(e,t,n){var r=this,o=r._getCanvasSize(e,n),i=r._getActualMaxValue(t),a=r._getActualMinValue(t);if(i===-Ee||a===Ee)return e.Height/2;var s=i-a;if(i===a){if(0===i)return e.Height/2;s=i,i<0&&(i=0)}var l=o.Height/s;return r._getSpace(n)+i*l},_getAxisY:function(e,t,n){return 2===this.options.sparklineType?e.Height/2:this._getAxisYNormal(e,t,n)},_getItemVisibleHeightNormal:function(e,t,n,r){var o,i,a=this,s=a._getCanvasSize(e,r),l=a._getActualMaxValue(n),u=a._getActualMinValue(n),c=l-u;if(l===u){if(0===l)return 0;c=l}if(o=s.Height/c,i=a._getValue(t,n),typeof i!==Ce&&i!==ue||(i=0),l!==u&&l*u>0){return i>=0?(i-u)*o:(i-l)*o}return i*o},_getItemVisibleHeight:function(e,t,n,r){var o=this,i=o.options.sparklineType;if(0===i)return o._getItemVisibleHeightNormal(e,t,n,r);if(1===i){var a=o._getItemVisibleHeightNormal(e,t,n,r),s=o._minItemHeight;if(a>-s&&a<s){var l=o._getValue(t,n);if(typeof l!==Ce&&l!==ue||(l=0),0!==l)return l>0?a+s:a-s}return a}return 2===i?o._getItemHeight(e,t,n,r):void 0},_getDataPointPositionNormal:function(e,n,r,o,i){var a=this,s=a._getItemWidth(n,r,o,i),l=a._getItemX(n,e,r,o,i);s<0&&(s=0),(s=fe(s))%2==1&&(s+=1);var u=a._getItemHeight(n,e,r,i),c=a._getAxisY(n,r,i),f=a._getActualMaxValue(r),d=a._getActualMinValue(r),p=0;f<0&&d<0?p=ge(a._getSpace(i),c):(p=c,u>=0&&(p=c-u));var h=a._getItemVisibleHeight(n,e,r,i),m=new t(l,p,s,be(h));if(0!==u){var g=a._getSpace(i);if(m.Y<g&&m.Bottom<g+1)m.Height=fe(m.Height+1);else{var _=n.Height-a._getSpace(i);m.Bottom>_&&m.Y>_-1&&(m.Y=_-h,m.Height=h)}}return m},_getLineWeight:function(e){var t=this.setting.options.lineWeight*e;return t<1&&(t=1),t},_getDataPointPosition:function(e,n,r,o,i){var a=this,s=a._getLineWeight(i);++s<2&&(s=2);var l=a._getDataPointPositionNormal(e,n,r,o,i);if(0===a.options.sparklineType){l.X=l.X+(l.Width-s)/2;var u=a._getValue(e,r);typeof u!==Ce&&u!==ue?(u>=0?l.Y-=s/2:l.Y=l.Bottom-s/2,l.Width=s,l.Height=s):(l.Width=0,l.Height=0)}if(a.setting.options.rightToLeft){var c=l.X;l=new t(n.Width-c-l.Width,l.Y,l.Width,l.Height)}return l}},e}();t.SparklineRender=Xe,t.SparklineExRenders={PIESPARKLINE:m,AREASPARKLINE:v,SCATTERSPARKLINE:b,BULLETSPARKLINE:T,SPREADSPARKLINE:E,STACKEDSPARKLINE:R,HBARSPARKLINE:F,VBARSPARKLINE:L,VARISPARKLINE:H,BOXPLOTSPARKLINE:V,CASCADESPARKLINE:W,PARETOSPARKLINE:z,MONTHSPARKLINE:Z,YEARSPARKLINE:$},e.exports=t},function(e,t,n){var t=n(2),r=n(4).GC$,o=n(3),i=o._util._createElement,a=o._util,s=a._browser,l=a._cancelDefault,u=window._gcGlobal,c=document,f=function(){function e(e,t){var n=this;n._host=e,n._gcPopupClass="gc-popup",n._overlayClass="gc-overlay",t=t||0,n._defaultOverlayCSS={position:"fixed",width:"100%",height:"100%",margin:0,padding:0,top:0,left:0,border:"none",zIndex:t,backgroundColor:"rgba(0,0,0,0)"},n._defaultContainerCSS={position:"absolute",padding:0,margin:0,height:"auto",zIndex:t+1,outline:"none"},n._init()}return e.prototype={constructor:e,_init:function(){var e=this;e._hasTargetContainer(e._name)?e._container=r("#"+e._name):(e._name=e._generateName(),e._container=r(i("div")).addClass(e._gcPopupClass+" ui-widget").attr({id:e._name,tabIndex:-1}).css(e._defaultContainerCSS))},_generateName:function(){for(var e=0,t="gc-dialog";this._hasTargetContainer(t+e);)e++;return t+e},_getContainer:function(){if(this._container)return this._container},_getHost:function(){return this._host?this._host:c.body},_show:function(e){var t=this,n=t._container;t._hasOverlay()||t._createOverlay(),u._suspendEvent(),t._hasTargetContainer(t._name)||(r(t._getHost()).append(n),t._resetDialogPosition(),n.css("display","none")),n.show(e)},close:function(){var e=this;e._hasTargetContainer(e._name)&&e._container.remove(),r("."+e._gcPopupClass).isVisible()||e._closeOverlay(),u._resumeEvent()},_closeOverlay:function(){r("."+this._overlayClass).remove()},_resetDialogPosition:function(){var e=this._container,t=this._getHost();if(0!==e.length){var n=r(t).offset(),o=parseInt(e.css("left"))+n.left,i=parseInt(e.css("top"))+n.top,a=e.width(),s=e.height();if(!(isNaN(o)||isNaN(i)||isNaN(a)||isNaN(s))){var l=0,u=0,f=c.documentElement,d=f.clientWidth,p=f.clientHeight,h=e[0].getBoundingClientRect();h.left+a>d&&(u=h.left+a-d),h.top+s>p&&(l=h.top+s-p),(o<0||i<0||l>0||u>0)&&(o-=u,i-=l,o<0&&(o=0),i<0&&(i=0),e.css({left:o-n.left+"px",top:i-n.top+"px"}))}}},_hasTargetContainer:function(e){return r("#"+e).length>0},_createOverlay:function(){var e=this,t=r(i("div")).addClass(e._overlayClass);t.css(e._defaultOverlayCSS),r(e._host).append(t);var n=s&&s.mozilla,o=s&&s.qtMode;if(n||o)var a=(new Date).valueOf();t.bind("mousedown",function(t){if(n||o){if((new Date).valueOf()-a<100)return}e.close(),(n||o)&&e._delayCloseTimeout&&clearTimeout(e._delayCloseTimeout),l(t)}),"touchstart MSPointerDown pointerdown".split(" ").forEach(function(r){t.bind(r,function(t){n||o?e._delayCloseTimeout=setTimeout(function(){e.close()},100):e.close(),l(t)})})},_hasOverlay:function(){return r("."+this._overlayClass).length>0}},e}();t._BaseDialog=f,e.exports=t},function(e,t,n){e.exports=n(44),n(94)},function(e,t,n){function r(e){return e.columnRelative}function o(e){return e.endColumnRelative}function i(e){return e.rowRelative}function a(e){return e.endRowRelative}function s(e){return e._getCalcServiceInternal()}function l(e){return e.column}function u(){var e=this;if(e._calcReseted)return void(e._calcReseted=!1);e._functions={},e._nameInfos={},e._vpCalcSheetModel?e._vpCalcSheetModel.clearAll():e._vpSheetSource=new t.CalcEngine.SheetSource(e)}function c(e,t){var n,r,o,i,a=t._sourceModel,s=a.getSource();t.name?(i=t.name,n=a.getNodeByName(i)):(r=t.row,o=t.column,r=void 0===r?-1:r,o=void 0===o?-1:o,n=a.getNode(r,o));var l=n._expr,u=n._arrayInfo,c=e.unparse(s,l,r<0?0:r,o<0?0:o);u?a.setArrayFormula(u.row,u.col,u.rowCount,u.colCount,c):i?a.setFormulaByName(i,c):a.setFormula(r,o,c,null,!0,!0)}function f(e,t,n,s,u,c,p,m,g,_){var v=c-n,y=p-s,b=t._getSheetSource(),w=u._getSheetSource();if(9===_.type){var C=_.value,S=_.value2,x=f(e,t,n,s,u,c,p,m,g,C),T=S&&f(e,t,n,s,u,c,p,m,g,S);if(C!==x||S!==T)return h._createOperatorExpression(_.operatorType,x,T)}else if(7===_.type){for(var E,M=!1,A=[],k=0;k<_.arguments.length;k++){E=_.arguments[k];var R=f(e,t,n,s,u,c,p,m,g,E);M=M||E!==R,A.push(R)}if(M)return h._createFunctionExpression(_.function,A)}else if(1===_.type&&_._isCell){if((!_.source||_.source===b)&&!_.rowRelative&&_.row>=n&&_.row<n+m&&!_.columnRelative&&_.column>=s&&_.column<s+g)return h._createCellExpression(w,d,_.row+v,_.column+y)}else if(1===_.type){var I=!i(_)&&!r(_),O=!a(_)&&!o(_);if((!_.source||_.source===b)&&(I&&_.row>=n&&l(_)>=s||O&&_.endColumn<s+g&&_.endRow<n+m))return h._createRangeExpression(w,d,_.row+(I?v:0),l(_)+(I?y:0),_.endRow+(O?v:0),_.endColumn+(O?y:0),i(_),r(_),a(_),o(_))}else if(10===_.type){var D=_.value,P=f(e,t,n,s,u,c,p,m,g,D);if(D!==P)return h._createParenthesesExpression(P)}return _}var t=n(2),d=null,p=void 0,h=n(5),m=n(4).GC$,g=m.each,_=n(3),v=n(0),y=v._StringHelper._toUpperCase,b=function(){return v._getResource(t.SR)()},w=v._Types._isNullOrUndefined,C=parseInt;t.ReferenceStyle={a1:0,r1c1:1};var S=function(){function e(e,t,n,r){var o=this;o._name=e,o._baseRow=n,o._baseColumn=r,o._expr=t}return e.prototype={getName:function(){return this._name},getRow:function(){return this._baseRow},getColumn:function(){return this._baseColumn},getExpression:function(){return this._expr},_setExpression:function(e){this._expr=e}},e}();t.NameInfo=S;var x={resetCalc:function(){u.call(this),this._calcReseted=!0},recalcAll:function(e){var t=s(this);if(t){if(this.suspendPaint(),t.suspend(!0),e){var n,r=this.parent;n=r&&r.sheets||[this];for(var o=0;o<n.length;o++){var i=n[o],a=i._nameInfos,l=i._getSheetSource();if(a)for(var u in a){var f=a[u],d=f._expr,p=t.unparse(l,d,0,0);f._expr=t.parse(l,p,0,0)}for(var h=l.getCalcSourceModel(),m=h.getAllNodes(),g=0;g<m.length;g++){var _=m[g],v=_.calc;v&&_._expr&&c(t,v)}}}t.resume(!0),this.resumePaint()}},recalcRange:function(e,t,n,r){var o=s(this);o&&o.recalcRange(this._getSheetSource(),e,t,n,r)},recalcRows:function(e){var t=s(this);if(t&&!t.ignoreDirty()){t.suspend();for(var n=0;n<e.length;n++)t.recalculate(this._vpSheetSource,e[n],-1);t.resume(!1)}},_recalcCell:function(e,t,n){var r=s(this);r&&!r.ignoreDirty()&&r.recalculate(this._vpSheetSource,t,n)},getCalcService:function(){return this._calcService||(this._calcService=new h.CalcService,this._getSheetSource().setCalcService(this._calcService),this._calcService.initParserContext(this._getSheetSource())),this._calcService},_getCalcServiceInternal:function(){return this.getCalcService()},suspendCalcService:function(e){s(this)&&s(this).suspend(e)},resumeCalcService:function(e){s(this)&&s(this).resume(e)},_getSheetSource:function(e){return w(e)||3===e?this._vpSheetSource:d},_getCalcModel:function(){var e=this;return!e._vpCalcSheetModel&&e._vpSheetSource&&(e._vpCalcSheetModel=e._getCalcServiceInternal().getSourceModel(e._vpSheetSource)),e._vpCalcSheetModel},_hasPartArrayFormulas:function(e,t,n,r){return this._getCalcModel()&&this._getCalcModel()._getFormulaExps(e,t,n,r,!0,!0)},_getsArrayFormulas:function(e,t,n,r){return this._getCalcModel()&&this._getCalcModel()._getFormulaExps(e,t,n,r,!1,!0)},_checkArrayFormula:function(e,n,r,o,i){function a(e,t,n,r,o){var i=e._getsArrayFormulas(t,n,r,o),a=i&&i.formulas;return a&&a.length>0}return i=i===p||i,!(t._supportsCalc&&i&&this._hasPartArrayFormulas(e,n,r,o)||!i&&a(this,e,n,r,o))||(this._raiseInvalidOperation(4,b().Exp_ChangePartOfArray),!1)},addCustomFunction:function(e){this._addCustomFunctionCore(e),this.recalcAll()},_addCustomFunctionCore:function(e){if(!(e&&e instanceof h.Functions.Function))throw new Error(b().Exp_InvalidCustomFunction);this._functions[y(e.name)]=e},getCustomFunction:function(e){return e?this._functions[y(e)]:d},removeCustomFunction:function(e){e&&(delete this._functions[y(e)],this.recalcAll())},clearCustomFunctions:function(){this._functions={},this.recalcAll()},_findCustomFunction:function(e){if(!e||""===e)return d;var t=this,n=t.parent,r=t.getCustomFunction(e);return!r&&n&&n.getCustomFunction&&(r=n.getCustomFunction(e)),r},addCustomName:function(e,t,n,r){this._addCustomNameCore(e,t,n,r,!1)},getCustomName:function(e){return e?this._nameInfos[y(e)]:p},getCustomNames:function(){var e=[];return g(this._nameInfos,function(t,n){e.push(n)}),e},removeCustomName:function(e){if(e){var t=y(e);delete this._nameInfos[t];var n={};n[t]=t,this._updateCalc(n,!1)}},clearCustomNames:function(){var e=this,t=e._nameInfos;e._nameInfos={},this._updateCalc(t,!1)},createNameInfo:function(e,t,n,r){var o=this,i=s(o),a=o._getSheetSource();if(i&&a){var l=i.parse(a,t,n,r);return new S(e,l,n,r)}return d},_addCustomNameCore:function(e,t,n,r,o){if(!e||!t)throw new Error(b().Exp_InvalidCustomName);var i=this,a=s(i),l=i._getSheetSource();if(a&&l){var u;if(o)try{u=a.parse(l,t,n,r,!1,!1,!0)}catch(e){}else u=a.parse(l,t,n,r);i._nameInfos[y(e)]=new S(e,u,n,r);var c={};c[e]=e,this._updateCalc(c,!0)}},_updateCalc:function(e,t){var n=this._getCalcModel();if(n){for(var r in e){var o=n._getNameCalc(y(r));o&&(o.updateListening(!0,t),o._addToDirty())}this.recalcAll()}},_findCustomName:function(e){if(!e||""===e)return d;var t=this,n=t.parent,r=t.getCustomName(e);return!r&&n&&n.getCustomName&&(r=n.getCustomName(e)),r},setFormula:function(e,t,n){this._setFormulaCore(e,t,n,d,!1)},_setFormulaCore:function(e,t,n,r,o,i){var a=this;if(1!==i&&2!==i){if(w(i)&&(i=3),e<0||e>=a.getRowCount()||t<0||t>=a.getColumnCount())return void a._raiseInvalidOperation(0,b().Exp_IndexOutOfRange);var s=a.tables;if(3===i&&e>=0&&t>=0&&s){if(!s._setFormula(e,t,1,1,n))return}var l=a._getCalcModel(),u=a.conditionalFormats;if(l){var c=l.getFormula(e,t);l.setFormula(e,t,n,r,o),u&&u._clearCache(),a._raiseCellChanged("formula",e,t,i,c,n)}a._updateTableSlicer&&a._updateTableSlicer(e,t,1,1,i),a._invalidate()}},setArrayFormula:function(e,t,n,r,o){this._setArrayFormulaCore(e,t,n,r,o,!1)},_setArrayFormulaCore:function(e,t,n,r,o,i,a){var s=this;if(1!==a&&2!==a){if(w(a)&&(a=3),e<0||e+n>s.getRowCount()||t<0||t+r>s.getColumnCount())return void s._raiseInvalidOperation(0,b().Exp_IndexOutOfRange);if(s._getSpanModel().hasSpans(e,t,n,r))return void s._raiseInvalidOperation(0,b().Exp_ArrayFromulaSpan);var l=s.tables;if(3===a&&e>=0&&t>=0&&l){if(!l._setFormula(e,t,n,r,o))return}var u=s._getCalcModel(),c=s.conditionalFormats;if(u&&(s.suspendEvent(),u.setArrayFormula(e,t,n,r,o,i),s.resumeEvent(),c&&c._clearCache(),s._eventSuspended<1)){for(var f=[],d=e;d<e+n;d++)for(var p=t;p<t+r;p++)f.push({row:d,col:p});s._raiseRangeDataChanged(e,t,n,r,f,5,a,o)}s._invalidate()}},getFormula:function(e,t,n){var r=this._getCalcModel();return r?r.getFormula(e,t,n):d},getFormulaInformation:function(e,t){var n={},r=this._getCalcModel();if(r){var o=r.getExpr(e,t);if(o){var i=r.getArray(e,t);n.hasFormula=!0,i&&(n.baseRange=new _.Range(i.row,i.col,i.rowCount,i.colCount)),n.isArrayFormula=!!i,e=i?i.row:e,t=i?i.col:t,n.formula=this._calcService.unparse(this._vpSheetSource,o,e,t),n.hasFormula=!!n.formula}}return n},hasFormula:function(e,t){var n=this._getCalcModel();return!!n&&n.hasFormula(e,t)},_findFormulas:function(e,t,n,r){},_rebuildCalcNodes:function(){var e=this._getCalcModel();if(e)for(var t=0,n=e.rC(),r=e.cC();t<n;){for(var o=0;o<r;){var i=e._getCellCalc(t,o);i&&(i._stopListening(),i._startListening()),o++}t++}},clearFormula:function(e,t,n,r,o){var i=this;e<0&&(e=0,n=i.getRowCount()),t<0&&(t=0,r=i.getColumnCount());for(var a=0;a<n;a++)if(o(i,a+e))for(var s=0;s<r;s++)i.setFormula(a+e,s+t,d)},formulaFromJSON:function(e,t){if(e){var n=this,r=e.customFunctions;if(r)for(var o in r)if(r.hasOwnProperty(o)){var i=r[o],a=_.getTypeFromString(i.typeName);if(a){var s=new a;s.fromJSON(i,t),n._addCustomFunctionCore(s)}}var l=e.names;if(l){for(var u=0;u<l.length;u++){var c=l[u];n._addCustomNameCore(c.name,c.formula,c.row,c.col,!0)}n._rebuildCalcNodes()}var f=e.data;if(f){var p=f.dataTable;if(p)for(var h,m,g=n.getRowCount(),v=n.getColumnCount(),y=0;y<g;y++)if(h=p[y])for(var b=0;b<v;b++){m=h[b];var w=m&&m.formula;if(w){var S=m.arrayInfo;S?n._setArrayFormulaCore(y,b,C(S.rowCount,10),C(S.colCount,10),w,!0):n._setFormulaCore(y,b,w,d,!0)}}}}},_initCalc:function(e){var t=this,n=t._calcService;n&&!e||(t._calcService=e||new h.CalcService,t._getSheetSource().setCalcService(t._calcService),t._calcService.initParserContext(t._getSheetSource()),n&&e?e.setSourceModel(t._getSheetSource(),n.getSourceModel(t._vpSheetSource)):t._vpCalcSheetModel=t._calcService.getSourceModel(t._vpSheetSource))},_commitArrayFormula:function(){this._endEditImp(!1,1)}},T=n(6).Worksheet;m.extend(T.prototype,x),T.adjustCustomNameOnInsertRemove=function(e,t,n,r,o){var i,a,s,l=this;if(!e.parent||!e.parent.sheets)return void((i=e.getCustomNames())&&g(i,function(i,u){a=u.getExpression(),(s=l.adjustCustomNameExpOnInsertRemove(e,e,t,n,r,o,a))!==a&&u._setExpression(s)}));var u=e.parent.sheets,c=e.parent.getCustomNames();c&&g(c,function(i,u){a=u.getExpression(),(s=l.adjustCustomNameExpOnInsertRemove(null,e,t,n,r,o,a))!==a&&u._setExpression(s)});for(var f=0;f<u.length;f++)(i=u[f].getCustomNames())&&g(i,function(i,c){a=c.getExpression(),(s=l.adjustCustomNameExpOnInsertRemove(u[f],e,t,n,r,o,a))!==a&&c._setExpression(s)})},T.adjustCustomNameExpOnInsertRemove=function(e,t,n,r,o,i,a){var s=t._getSheetSource(),l=h._createErrorExpression(h.Errors.Reference,s);if(9===a.type){var u=a.value,c=a.value2,f=this.adjustCustomNameExpOnInsertRemove(e,t,n,r,o,i,u),p=c&&this.adjustCustomNameExpOnInsertRemove(e,t,n,r,o,i,c);if(u!==f||c!==p)return h._createOperatorExpression(a.operatorType,f,p)}else if(7===a.type){for(var m,g=!1,_=[],v=0;v<a.arguments.length;v++){m=a.arguments[v];var y=this.adjustCustomNameExpOnInsertRemove(e,t,n,r,o,i,m);g=g||m!==y,_.push(y)}if(g)return h._createFunctionExpression(a.function,_)}else if(1===a.type&&a._isCell){var b=a.source||e&&e._getSheetSource(),w=a.row,C=a.column,S=w,x=C;if(b&&b===s&&(i&&!a.rowRelative||!i&&!a.columnRelative)){if(i&&o)w+=w>=n?r:0;else if(!i&&o)C+=C>=n?r:0;else if(i&&!o){if(w>=n+r)w-=r;else if(w>=n)return l}else if(C>=n+r)C-=r;else if(C>=n)return l;if(w!==S||C!==x)return h._createCellExpression(s,d,w,C,a.rowRelative,a.columnRelative)}}else if(1===a.type){b=a.source||e&&e._getSheetSource();var T=a.row,E=a.column,M=a.endRow,A=a.endColumn,k=a.rowRelative,R=a.columnRelative,I=a.endRowRelative,O=a.endColumnRelative,D=T,P=E,N=M,F=A;if(b&&b===s){if(i&&o)T+=!k&&T>=n?r:0,M+=!I&&M>=n?r:0;else if(!i&&o)E+=!R&&E>=n?r:0,A+=!O&&A>=n?r:0;else if(i&&!o){if(!k&&T>=n&&!I&&M<n+r)return l;if(k&&I||M<n)return a;if(!k)if(T>=n+r)T-=r;else if(T<n);else{if(I)return l;T>n&&(T=n)}if(!I)if(M>=n+r)M-=r;else{if(k)return l;M<n+r&&(M=n-1)}}else{if(!R&&E>=n&&!O&&A<n+r)return l;if(R&&O||A<n)return a;if(!R)if(E>=n+r)E-=r;else if(E<n);else{if(O)return l;E>n&&(E=n)}if(!O)if(A>=n+r)A-=r;else{if(R)return l;A<n+r&&(A=n-1)}}if(E!==P||A!==F||T!==D||M!==N)return h._createRangeExpression(s,d,T,E,M,A,k,R,I,O)}}else if(10===a.type){var L=a.value,H=this.adjustCustomNameExpOnInsertRemove(e,t,n,r,o,i,L);if(L!==H)return h._createParenthesesExpression(H)}return a},T.adjustModelFormulasAfterSetSheetName=function(e){var t=s(e),n=t.getSourceModel(e._getSheetSource());if(n)for(var r=n.getAllNodes(),o=0;o<r.length;o++){var i=r[o],a=i.calc;if(a){i._expr&&c(t,a);for(var l,u=a._listeners,f=0;f<u.length;f++){var d=a[u[f]];if(d)for(var p=d.length,h=0;h<p;h++)l=d[h],l._sourceModel!==n&&c(t,l)}}}},T.getDataValidatorsBeforeSetSheetName=function(e){for(var t,n,r,o,i,a=s(e),l=e._getSheetSource(),u=0,c=0,f=[[],[]],d=_._DataValidatorCache._getAllValidators(),p=0;p<d.length;p++)if(t=d[p].validator,n=t.condition(),r=n.getFormulas(),i=[],r&&r.length>0){for(var h=0;h<r.length;h++){o=r[h];var m=a.parse(l,o,u,c);i.push(m)}f[0].push(n),f[1].push(i)}return f},T.adjustValidatorsAfterSetSheetName=function(e,t){for(var n=t[0].length,r=s(e),o=e._getSheetSource(),i=0,a=0,l=0;l<n;l++){for(var u=t[0][l],c=t[1][l],f=[],d=0;d<c.length;d++){var p=r.unparse(o,c[d],i,a);f.push(p)}u.setFormulas(f)}},T.copyFormula=function(e,t,n,r,o,i,a,s,l){h&&h.CalcOperatorAdjustor.copyFormula(e._getCalcModel(),t,n,r._getCalcModel(),o,i,a,s,l)},T.moveFormula=function(e,t,n,r,o,i,a,s){h&&h.CalcOperatorAdjustor.moveFormula(e,t,n,r,o,i,a,s)},T.adjustCustomNameOnMove=function(e,t,n,r,o,i,a,s){var l,u,c;if(!e.parent||!e.parent.sheets)return void((l=e.getCustomNames())&&g(l,function(l,d){u=d.getExpression(),(c=f(e,e,t,n,r,o,i,a,s,u))!==u&&d._setExpression(c)}));var d=e.parent.sheets,p=e.parent.getCustomNames();p&&g(p,function(l,d){u=d.getExpression(),(c=f(null,e,t,n,r,o,i,a,s,u))!==u&&d._setExpression(c)});for(var h=0;h<d.length;h++)(l=d[h].getCustomNames())&&g(l,function(l,p){u=p.getExpression(),(c=f(d[h],e,t,n,r,o,i,a,s,u))!==u&&p._setExpression(c)})},T._registerFeature("calc",{priority:1e3,init:u,dispose:function(e){!1!==e&&(this._vpSheetSource=d,this._calcService=d)},attach:function(e){var t=this;e instanceof n(24).Workbook?t._initCalc(e._calcService):t._initCalc()},onLayoutChanged:function(e){var n=this,r=e.changeType,o=e.row,i=e.rowCount,a=e.col,l=e.colCount,u=t._supportsCalc&&n._getCalcModel();u&&("addingRows"===r?n._checkArrayFormula(o,0,0,n.getColumnCount())?(s(u)._getOperatorAdjustor().onBeforeAddRemoveRows(u,o),T.adjustCustomNameOnInsertRemove(n,o,i,!0,!0),u.addRows(o,i)):e.canAdd=!1:"addRows"===r?s(u)._getOperatorAdjustor().onAfterAddRemoveRows(u,o,i,!0):"deletingRows"===r?n._checkArrayFormula(o,0,i,n.getColumnCount())?(s(u)._getOperatorAdjustor().onBeforeAddRemoveRows(u,o),T.adjustCustomNameOnInsertRemove(n,o,i,!1,!0),u.deleteRows(o,i)):e.canDelete=!1:"deleteRows"===r?s(u)._getOperatorAdjustor().onAfterAddRemoveRows(u,o,i,!1):"addingColumns"===r?n._checkArrayFormula(0,a,n.getRowCount(),0)?(s(u)._getOperatorAdjustor().onBeforeAddRemoveColumns(u,a),T.adjustCustomNameOnInsertRemove(n,a,l,!0,!1),u.addColumns(a,l)):e.canAdd=!1:"addColumns"===r?s(u)._getOperatorAdjustor().onAfterAddRemoveColumns(u,a,l,!0):"deletingColumns"===r?n._checkArrayFormula(0,a,n.getRowCount(),l)?(s(u)._getOperatorAdjustor().onBeforeAddRemoveColumns(u,a),T.adjustCustomNameOnInsertRemove(n,a,l,!1,!1),u.deleteColumns(a,l)):e.canDelete=!1:"deleteColumns"===r&&s(u)._getOperatorAdjustor().onAfterAddRemoveColumns(u,a,l,!1))},toJson:function(e){var t=this,n=t._functions;m.isEmptyObject(n)||(e.customFunctions=n);var r=[],o=t.getCustomNames(),i=s(t);o&&i&&(g(o,function(e,n){var o=n.getName(),a=n.getRow(),s=n.getColumn(),l=n.getExpression(),u=i.unparse(t._getSheetSource(),l,a,s,!1,!0);r.push({name:o,formula:u,row:a,col:s})}),r.length>0&&(e.names=r));var a=t._vpCalcSheetModel;a&&a.toJSON(e)},fromJson:function(e,t,n){var r=this;r.clearCustomFunctions(),r.clearCustomNames(),n&&r.formulaFromJSON(e,t)}}),e.exports=t},function(e,t,n){function r(){return c._getResource(t.SR)()}function o(e,t,n){e._trigger(v.ActiveSheetChanged,{oldSheet:t,newSheet:n})}function i(e,t,n){e._trigger(v.FormulatextboxActiveSheetChanged,{oldSheet:t,newSheet:n})}function a(e,t){e._trigger(v.ActiveSheetChanging,t)}function s(e,t){e._trigger(v.FormulatextboxActiveSheetChanging,t)}function l(e,t,n){e._trigger(v.SheetTabClick,{sheet:t,sheetName:t?t._name:E,sheetTabIndex:C(n)?-1:n})}function u(e){var t=this;t._workbook=E,t._activeIndex=0,t._firstTab=0,t._activePos=70,t._hoverNavButton=-1,t._hoverTab=-1,t._font="",t._tabSizes=[],t._targetTabIndex=-1,t._sourceTabIndex=-1,t._reorderSpeedTimeout=E,t._paintSuspended=0,t._setBounds(new b(0,0,200,28)),t._name=e}var t=n(2),c=n(0),f=n(4).GC$,d=n(3),p=n(8)._StyleHelper,h=c._ColorHelper,m=d._util,g=m._getLinearGradientColors,_=d._DPIHelper,v=d.Events,y=d._FocusHelper,b=d.Rect,w=d._ThemeStyleHelper,C=c._Types._isNullOrUndefined,S=d._util._createElement,x=t._CanvasHelper,T=document,E=null,M=Math.max,A=Math.min,k=Math.pow,R="px",I="none",O=".gcTab",D="mousedown"+O,P="mousemove"+O,N="mouseup"+O,F="mouseout"+O,L="dblclick"+O,H=".spliter",V="mousemove"+H,j="mouseup"+H,B=".tabNameEditor",U="keydown"+B,W="focus"+B,z="blur"+B,Y="canvas",G="2d",K="resizeBar",X="navButton",q="tab",J="newTab",Z="black",Q="white",$=4;d._defineFeature(u),u.prototype={_setHost:function(e){var t=this;t._canvas&&t._dispose(!0);var n=S(Y);_._adjustDevicePixel(n,t._workbook),n.setAttribute("id",t._name),t._tabIndicator=t._getTabIndicator(),e.appendChild(t._tabIndicator[0]),e.appendChild(n),t._canvas=n,f(n).bind(D,function(e){return t._doMouseDown(e)}).bind(P,function(e){return t._doMouseMove(e)}).bind(N,function(e){return t._doMouseUp(e)}).bind(F,function(e){return t._doMouseOut(e)}).bind(L,function(e){return t._doMouseDbClick(e)}),t._doResize(),u._callFeatureHandler(t,"setHost")},_setOwner:function(e){var t=this,n=e.options.font;t._workbook=e,e&&n&&n.length>0&&(t._font=n)},_getBounds:function(){var e=this._bounds;return new b(e.x,e.y,e.width,e.height)},_setBounds:function(e){var t=this._bounds=new b(0,0,0,0);t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height},_getNewTabSize:function(){return this._newTabSize},_getTabEndPosition:function(){var e=this._getBounds();return e.x+e.width-this._resizeBarWidth},_getTabStartPosition:function(){return 0},_doResize:function(){var e=this,t=e._getCanvas();if(t&&t.parentNode){var n=f(t.parentNode);if(0!==n.width()&&0!==n.height()){var r=M(n.width(),0),o=M(n.height(),0);t.style.display=I,t.width=r,t.height=o,t.style.display="",t.style.width=r+R,t.style.height=o+R,r=t.clientWidth||t.width,o=t.clientHeight||t.height;var i=e._getBounds();e._setBounds(new b(i.x,i.y,r,o)),_._setSize(t,r,o),e.repaint()}}},_isCoverSheetTab:function(){return!1},_getCoverPosition:function(){return 0},_getInputTopPosition:function(){return 0},_getTabIndicatorEdgeElement:function(){return""},_getBasicWidth:function(){return 0},_getTabIndicator:function(){var e="transparent";return f(S("div")).css({position:"absolute","border-style":"solid","border-color":Z,"border-width":$+R,display:"none",width:0,"border-bottom":0,"border-left-color":e,"border-right-color":e})},_dispose:function(e){var t,n=this,r=n._canvas;r&&(t=r.parentNode,f(r).unbind(D).unbind(P).unbind(N).unbind(L).unbind(F),t&&t.removeChild(r)),f(n._tabIndicator).remove(),u._callFeatureHandler(n,"dispose"),e||(n._workbook=E)},hitTest:function(e,t){return{element:""}},_doMouseDown:function(e){var t,n=this,r={e:e,r:E};if(u._callFeatureHandler(n,"preProcessMouseDown",r),t=r.r,!C(t))return t;var o=f(n._getCanvas()).offset(),i=e.pageX-o.left,a=e.pageY-o.top,s=n._workbook.getActiveSheet();n._tabNameEditor&&n._endSheetTabEditing(s,!1);var l=n.hitTest(i,a),c=l.element;return 0===e.button&&(c===K?(n._resizeTab=!0,n._activeX=e.pageX,n._handleDocumentMouseMove()):c===X?n._doNavButtonClick(l.index):c===q?(n._doSheetTabClick(l.index,l.position),n._initTabReorder(e,l)):c===J&&n._doNewTabClick(l.position),s=n._workbook.getActiveSheet(),s&&s._eventHandler&&!s.isEditing()&&s._setFocus()),n._isMouseDownInTab=!1,!1},_doMouseMove:function(e){var t,n=this,r={e:e,r:E};if(u._callFeatureHandler(n,"preProcessMouseMove",r),t=r.r,!C(t))return t;var o=n._canvas.style,i="default",a="w-resize";if(n._tabStartPos&&!n._reorderSheet&&Math.sqrt(k(n._tabStartPos.x-e.pageX,2)+k(n._tabStartPos.y-e.pageY,2))>10&&(n._reorderSheet=!0),n._resizeTab){o.cursor=a;var s=e.pageX-n._activeX,l=n._workbook._vp.clientWidth,c=n._workbook;c.options.tabStripRatio=c._getActualTabStripRatio()+s/l;var d=n._resizeBarWidth/l,p=1;c._getActualTabStripRatio()<d?(c.options.tabStripRatio=d,n._activeX=n._resizeBarWidth):c._getActualTabStripRatio()>=p?(c.options.tabStripRatio=p,n._activeX=l):n._activeX=e.pageX,c._doTabHSResize()}else if(n._reorderSheet)n._showTabTip(e.pageX,e.pageY),n._setTabIndicator(e);else{n._hoverNavButton=-1,n._hoverTab=-1;var h=f(n._getCanvas()).offset(),m=e.pageX-h.left,g=e.pageY-h.top,_=n.hitTest(m,g),v=_.element;if(""===v)return o.cursor=i,n.repaint(),!1;v===K?o.cursor=a:(o.cursor=i,v===X?n._hoverNavButton=_.index:v===q?n._hoverTab=_.index:v===J&&(n._hoverTab=-2)),n.repaint()}return!1},_doMouseUp:function(e){var t,n=this,r={e:e,r:E};return u._callFeatureHandler(n,"preProcessMouseUp",r),t=r.r,C(t)?(n._resizeTab&&(n._resizeTab=!1,n._workbook._doTabHSResize()),n._clearSpeedTimeout(),n._reorderSheet&&(n._reorderSheet=!1,n._tabTip.remove(),n._reorderTab(),n._tabIndicator.hide()),n._tabStartPos=E,n._clearRepeatDown(),n._unhandleDocumentMouseMove(),!n._isMouseDownInTab||(n._isMouseDownInTab=!1,!1)):t},_doMouseOut:function(e){var t,n=this,r={e:e,r:E};if(u._callFeatureHandler(n,"preProcessMouseOut",r),t=r.r,!C(t))return t;n._clearRepeatDown();var o=n._hoverNavButton;n._hoverNavButton=-1;var i=n._hoverTab;return n._hoverTab=-1,n._hoverNavButton===o&&n._hoverTab===i||n.repaint(),!1},_handleDocumentMouseMove:function(){var e=this;if(!e._isCapture){f(T).bind(V,function(t){e._doMouseMove(t)}).bind(j,function(t){e._doMouseUp(t)});var t=e._workbook.getActiveSheet();t&&(t._continueMouseUpBubble=!0),e._isCapture=!0}},_unhandleDocumentMouseMove:function(){if(this._isCapture){this._isCapture=!1,f(T).unbind(V).unbind(j);var e=this._workbook.getActiveSheet();e&&delete e._continueMouseUpBubble}},_doNavButtonClick:function(e,t){var n=this;n._clearRepeatDown();var r=n._getVisibleTabs();if(!(r.length<=0)){var o=200;e%=4,0===e?n._navigateToFirst(r):1===e?(t||(n._repeatDown=setTimeout(function(){n._doNavButtonClick(1)},o)),n._navigateToPrevious(r)):2===e?(t||(n._repeatDown=setTimeout(function(){n._doNavButtonClick(2)},o)),n._navigateToNext(r)):3===e&&n._navigateToLast(r)}},_doSheetTabClick:function(e,t){var n=this,r=n._workbook;n._activeIndex=e,n._activePos=t,r.suspendPaint();var o=r.getActiveSheet(),i=r.getSheet(e);if(i&&i.isEditing()&&i!==o){var a=o._formulaTextBox&&o._formulaTextBox._isSelectMode;if(!i._endEditImp(void 0,void 0,a))return}l(r,i,e),n._doSheetTabClickChange(e),r.resumePaint(),n.repaint()},_doNewTabClick:function(e){var t=this,n=t._workbook,r=n.getActiveSheet();if(!(t.disableNewTab||t._canCreateNewTab&&!t._canCreateNewTab(r))){l(n,E,E,-1);var i=n.sheets.length,s=n._createSheet(n._getDefaultSheetName(i));n._addSheetImp(i,1,s),t._activeIndex=i,t._activePos=e;var u={oldSheet:r,newSheet:s,cancel:!1};if(a(n,u),!1===u.cancel){for(n._setActiveSheetIndexImp(i,1),o(n,r,s);t._activeIndex>t._firstTab&&(t._isCoverSheetTab()||t._firstTab<t._getNextVisibleIndex(-1));)t._tabVisible(t._firstTab)&&(t._activePos-=t._tabSizes[t._firstTab]),t._firstTab++;t.repaint()}}},_doSheetTabClickChange:function(e,t){void 0===t&&(t=!0);var n=this,r=n._workbook,l=r.getSheet(e),u=r.getActiveSheet(),c=!1;if(u._formulaTextBox&&u._formulaTextBox._isSelectMode&&(c=!0),e!==r._activeSheetIndex){var f={oldSheet:u,newSheet:l,needTriggerSheetChange:!0};s(r,f);var d={oldSheet:u,newSheet:l,cancel:!1};if(f.needTriggerSheetChange&&a(r,d),!1===d.cancel){r._setActiveSheetIndexImp(e,1,c),i(r,u,l),f.needTriggerSheetChange&&o(r,u,l);var p=n._getNextVisibleIndex(n._firstTab);n._activeIndex>n._firstTab&&n._activePos+n._tabSizes[n._activeIndex]>n._getCoverPosition()&&-1!==p&&(n._firstTab=p)}}n._activeIndex<n._firstTab&&(n._firstTab=n._getPreVisibleIndex(n._firstTab))},_doMouseDbClickImp:function(e,t){var n=this,r=n._workbook;if(n.hitTest(e,t).element===q){var o=n._activeIndex,i=r.sheets[o];if(r._trigger(v.SheetTabDoubleClick,{sheet:i,sheetName:i._name,sheetTabIndex:o}),!r.options.tabEditable)return!1;var a=y._getActiveElement();if(a&&a.endEdit&&!a.endEdit())return;y._setActiveElement(E);var s=n._tabSizes[o],l=f(n._getCanvas()).offset(),u=r._getContainerDiv(),c=f(u).offset(),d=S("input"),p=d.style;d.type="text",d.value=i._name,d.setAttribute("contentEditable","true"),d.setAttribute("autocomplete","off"),p.position="absolute",p.margin=0,p.padding=0,p.margin=0,p.left=l.left-c.left+n._activePos+n._tabLeftPadding+R,p.top=l.top-c.top+n._getInputTopPosition()+R,p.width=s-n._tabLeftPadding-n._tabRightPadding+2+R,p.backgroundColor=Q,p.borderWidth="0px",p.outline=I,f(d).appendTo(u),n._tabNameEditor=d,f(d).addClass("gc-sheetTabEditor").bind(U,function(e){return 13===e.keyCode?(n._endSheetTabEditing(i,!1),!1):27===e.keyCode?(n._endSheetTabEditing(i,!0),!1):void 0}).bind(W,function(){d.selectionStart=0,d.selectionEnd=d.value.length}).bind(z,function(){n._endSheetTabEditing(i,!1)}),d.focus()}return!1},_doMouseDbClick:function(e){var t,n=this,r={e:e,r:E};if(u._callFeatureHandler(n,"preProcessMouseDbClick",r),t=r.r,!C(t))return t;var o=f(n._getCanvas()).offset(),i=e.pageX-o.left,a=e.pageY-o.top;return n._doMouseDbClickImp(i,a)},_endSheetTabEditing:function(e,t){var n=this,o=n._tabNameEditor;if(o){f(o).unbind(U).unbind(W).unbind(z);var i=o.value;if(!1===t){var a=e.name();if(i!==a)if(!C(i)&&""!==i&&n._isValidSheetName(i)){var s={sheet:e,oldValue:a,newValue:i,cancel:!1};if(e._trigger(v.SheetNameChanging,s),s&&!1===s.cancel){e._commandManager().execute({cmd:"renameSheet",sheetName:a,name:i});var l={sheet:e,oldValue:a,newValue:i};e._trigger(v.SheetNameChanged,l)}}else e._trigger(v.InvalidOperation,{sheet:e,sheetName:e.name(),invalidType:5,message:r().Exp_SheetNameInvalid})}o.parentNode.removeChild(o),delete n._tabNameEditor}},_isValidSheetName:function(e){if(!e)return!1;for(var t,n=0;n<e.length;n++)if("*"===(t=e.charAt(n))||":"===t||"["===t||"]"===t||"?"===t||"\\"===t||"/"===t)return!1;for(var r=this._workbook.sheets,o=r.length,i=0;i<o;i++)if(e===r[i]._name)return!1;return!0},_allowSheetReorder:function(){return this._workbook.options.allowSheetReorder},_initTabReorder:function(e,t){var n=this;n._allowSheetReorder()?(n._sourceTabIndex=t.index,n._tabTip=n._getTabTip(n._sourceTabIndex),n._tabStartPos=new d.Point(e.pageX,e.pageY),n._handleDocumentMouseMove()):n._reorderSheet=!1},_getTabTip:function(e){var t=this._workbook.sheets;if(!(e>=t.length||e<0)){var n=t[e]._name;n||(n="sheet");var r=f(S("span")).text(n).css({position:"absolute",cursor:"default","border-radius":"5px",opacity:".7"});return r.addClass("ui-widget-header gc-tab-tip-span btn-primary"),r}},_clearRepeatDown:function(){var e=this._repeatDown;e&&(clearTimeout(e),this._repeatDown=E)},_showTabTip:function(e,t){var n=this,r=n._tabTip;r&&0===f(".gc-tab-tip-span").length&&(r.appendTo(T.body),r.hide());var o=r.width(),i=r.height();r.css({left:e-o/2,top:t-i/2}),r.show()},_setTabIndicator:function(e){var t=this,n=f(t._getCanvas()),r=n.position(),o=n.offset(),i=e.pageX-o.left,a=e.pageY-o.top,s=t.hitTest(i,a),l=s.element,u=t._getBounds(),c=t._getTabStartPosition(),d=t._workbook.sheets.length,p=100,h=u.x+t._getCoverPosition(),m=t._tabIndicator;i>h?t._reorderSpeedTimeout===E&&t._targetTabIndex<d&&(t._reorderSpeedTimeout=setInterval(function(){t._navigateToNext(t._getVisibleTabs()),t._targetTabIndex===d?(t._clearSpeedTimeout(),m.css({left:r.left+t._getLastTabPos()-$,top:r.top-$}),m.show()):(t._targetTabIndex++,m.hide())},p)):i<c?t._reorderSpeedTimeout===E&&t._targetTabIndex>0&&(t._reorderSpeedTimeout=setInterval(function(){t._navigateToPrevious(t._getVisibleTabs()),0===t._targetTabIndex?(t._clearSpeedTimeout(),m.css({left:r.left+c-$,top:r.top-$}),m.show()):(t._targetTabIndex--,m.hide())},p)):(t._clearSpeedTimeout(),l!==q&&l!==t._getTabIndicatorEdgeElement()||(l!==q||C(s.index)?t._targetTabIndex=t._workbook.sheets.length:t._targetTabIndex=s.index,m.css({left:r.left+s.position-$,top:r.top-$}),m.show()))},_getLastTabPos:function(){for(var e=this,t=e._tabSizes,n=e._getVisibleTabs(),r=e._getVisibleTabIndex(e._firstTab,n),o=0,i=e._getTabStartPosition()+e._firstTabSpace,a=r;a<n.length;a++)o=n[a],i+=t[o],i+=e._tabSpace;return i},_clearSpeedTimeout:function(){var e=this._reorderSpeedTimeout;e&&(clearInterval(e),this._reorderSpeedTimeout=E)},_reorderTab:function(){var e=this,t=e._workbook,n=e._targetTabIndex,r=e._sourceTabIndex,o=-1;if(-1!==n&&-1!==r&&r!==n&&r!==n-1&&e._tabIndicator.isVisible()){var i,a=t.sheets,s=a[r];if(r>n){for(i=r;i>n;i--)a[i]=a[i-1];a[n]=s,o=n}else if(r<n-1){for(i=r;i<n-1;i++)a[i]=a[i+1];a[n-1]=s,o=n-1}t._activeSheetIndex=o,e._doResize()}},_getVisibleTabs:function(){var e,t=[];for(e=0;e<this._workbook.sheets.length;e++)this._tabVisible(e)&&t.push(e);return t},_navigateToFirst:function(e){e.length>0&&this._firstTab!==e[0]&&this._workbook.startSheetIndex(e[0])},_navigateToPrevious:function(e){if(e.length>0){var t=this;if(t._firstTab>e[0]){var n=t._getPreVisibleIndex(t._firstTab);-1!==n&&t._workbook.startSheetIndex(n)}}},_navigateToNext:function(e){if(e.length>0){var t=this;t._firstTab<e[e.length-1]&&-1!==t._reCalculateFirstTabIndex(e)&&t._workbook.startSheetIndex(t._getNextVisibleIndex(t._firstTab))}},_navigateToLast:function(e){if(e.length>0&&this._firstTab<e[e.length-1]){var t=this._reCalculateFirstTabIndex(e);-1!==t&&this._workbook.startSheetIndex(t)}},_reCalculateFirstTabIndex:function(e){if(e.length>0){var t,n,r=this,o=r._getCoverPosition(),i=0,a=r._tabSizes,s=r._getBasicWidth(),l=r._getVisibleTabIndex(r._firstTab,e);for(-1===l&&(l=0),t=e.length-1;t>=l;t--){n=e[t],i+=a[n],t!==e.length-1&&(i+=r._tabSpace);var u=s+i;if(0!==t&&(u+=r._firstTabSpace),u>o){var c;return c=t+1<e.length?e[t+1]:e[e.length-1],r._firstTab<c?c:-1}}}return-1},_getPreVisibleIndex:function(e){var t;for(t=e-1;t>=0;t--)if(this._tabVisible(t))return t;return-1},_getNextVisibleIndex:function(e){var t,n=this._workbook.sheets.length;for(t=e+1;t<n;t++)if(this._tabVisible(t))return t;return-1},_getVisibleTabIndex:function(e,t){var n;for(n=0;n<=t.length-1;n++)if(e===t[n])return n;return-1},_tabVisible:function(e){var t=this._workbook.sheets[e];return t&&t.visible()},_suspendPaint:function(){this._paintSuspended++},_resumePaint:function(){var e=this;--e._paintSuspended<=0&&(e._paintSuspended=0,e.repaint())},repaint:function(e){var t=this._getCanvas();t&&t.getContext&&this._paint(t.getContext(G),e)},_paint:function(e,t){var n=this;if(!(n._paintSuspended>0)){var r=n._getBounds(),o=n._canvas;if(t){if(t.x>=r.x+r.width)return;if(t.y>=r.y+r.height)return;if(t.x+t.width>r.width&&(t.width=r.width-t.x,t.width<=0))return;if(t.y+t.height>r.height&&(t.height=r.height-t.y,t.height<=0))return;if(t.width<=0||t.height<=0)return}var i,a=n.buffer;if(a&&(!a||a.width===o.width&&a.height===o.height)&&(a||a.width===r.width&&a.height===r.height)||(a&&_._disposeCanvasForSpread(n._workbook,a),n.buffer=a=S(Y),_._adjustDevicePixel(a,n._workbook),_._setSize(a,r.width,r.height)),!(r.width<=0||r.height<=0||t&&(t.width<=0||t.height<=0))){i=n.buffer.getContext(G),i.clearRect(0,0,r.width,r.height),x._translate(i,-r.x,-r.y),n._paintTabs(i,t),x._translate(i,r.x,r.y);var s,l,u=r.x>=0?0:-r.x,c=r.y>=0?0:-r.y,f=u,d=c;t&&(f=r.x+t.x,d=r.y+t.y,r=new b(f,d,t.width,t.height)),u=r.x>=0?r.x:0,c=r.y>=0?r.y:0;var p=E,h=_._getScaleX(o),m=_._getScaleY(o);o&&1!==h&&(f*=h,d*=m,r.x*=h,r.y*=m,r.width*=h,r.height*=m);try{o?t?(s=M(r.width-f,0),l=M(r.height-d,0)):(s=A(r.width-f,M(o.width-r.x,3)),l=A(r.height-d,M(o.height-r.y,3))):(f=t.x,d=t.y,s=t.width,l=t.height),o?(x._scaleTo(e,1,1),e.drawImage(n.buffer,f,d,s,l,u,c,s,l),x._scaleTo(e,h,m)):(i=n.buffer.getContext(G),p=i.getImageData(f,d,s,l))}catch(e){return}!o&&p&&r.width>0&&r.height>0&&e.putImageData(p,u,c)}}},_paintTabs:function(e,t){var n=this,r=n._workbook;if(e&&r){var o=n._getBounds();e.save(),e.font=n._font,t?e.rect(t.x,t.y,t.width,t.height):e.rect(o.x,o.y,o.width,o.height),e.clip(),e.beginPath();var i=60,a=n._getTabStartPosition(),s=a;e.save(),e.font=p._setStringFont(e.font,"bold"),n._tabSizes=[];var l,u=r.sheets;for(l=0;l<u.length;l++)i=Math.round(e.measureText(u[l]._name).width)+n._tabRightPadding+n._tabLeftPadding,i+=u[l].options.isLockedByUser?12:0,n._tabSizes.push(i);e.restore();var c=[],f=n._firstTab;if(f>0&&n._getPreVisibleIndex(f)>=0&&(s+=n._firstTabSpace),f>=0)for(l=f;l<u.length;l++){var d=u[l].visible();if(i=n._tabSizes[l],s>o.x+o.width)break;c.push({i:l,x:s,w:i,t:u[l]._name,visible:d,isLockedByUser:u[l].options.isLockedByUser}),d&&(s+=i+n._tabSpace)}n._paintBackground(e,o),n._paintNewSheetTab(e,o,s,a),n._paintTab(e,o,c,f,a),n._workbook&&n._workbook.options.tabNavigationVisible&&n._paintNavigationButtons(e,o,a),n._paintResizeBar(e,o),e.beginPath(),e.restore()}},_paintBackground:function(e,t){},_paintNewSheetTab:function(e,t,n,r){},_paintTab:function(e,t,n,r,o){var i=this,a=i._workbook,s=a.sheets,l=i._hoverTab;i._activeIndex=a.getActiveSheetIndex();var u=i._activeIndex;if(s.length>0){e.save(),e.beginPath();var c=t.x+i._getCoverPosition();e.rect(o,0,c-o,t.height),e.clip();for(var f=n.length-1;f>=0;f--){var d=n[f];d.i!==u&&d.visible&&i._drawTab(e,d.x,0,d.w,t.height,5,!1,d.i===l,d.t,d.isLockedByUser)}var p=n[u-r];u>=r&&u<s.length&&p&&p.visible&&i._drawTab(e,p.x,0,p.w,t.height,5,!0,!1,p.t,p.isLockedByUser),e.restore(),e.save(),e.beginPath(),r>0&&i._getPreVisibleIndex(r)>=0&&i._paintTabBeforeFirstTab(e,t,r,o),e.restore()}},_paintTabBeforeFirstTab:function(e,t,n,r){},_paintNavigationButtons:function(e,t,n){},_paintResizeBar:function(e,t){},_drawNavButton:function(e,t,n,r,o,i,a,s,l,u){},_drawTab:function(e,t,n,r,o,i,a,s,l){},_getCanvas:function(){return this._canvas},_getTabStripBackColor:function(e,t){var n=e.createLinearGradient(t.x,t.y,t.width,t.height),r=w._getVisualStateThemeStyle(0,"gc-tabStripBackground"),o=r&&r.backgroundImage,i=r&&r.backgroundColor;if(o&&-1!==o.indexOf("linear-gradient"))for(var a=g(o),s=0,l=a.length;s<l;s++){var u=a[s];n.addColorStop(u.point,u.color)}else i&&(n.addColorStop(0,"#DDDDDD"),n.addColorStop(1,i));return n},_getTabBackColor:function(e,t,n,r){var o=this,i=o._getBounds(),a=e.createLinearGradient(i.x+.7*i.height,i.y+0,.7*i.height,i.height),s=o._workbook.getSheetFromName(n);""===n&&o._firstTab>0&&(s=o._workbook.getSheet(o._firstTab-1));var l=s&&s.options.sheetTabColor;if(l){var u="rgba(0, 0, 0, 0)";e.fillStyle=u,e.fillStyle=d._ThemeContext._getColor(s,l);var c=e.fillStyle;c!==u&&(t?(a.addColorStop(0,Q),a.addColorStop(.45,"#F1F6FD"),a.addColorStop(.9,c),a.addColorStop(1,Q)):a=c)}else if(r){var f=r&&r.backgroundImage,p=r&&r.backgroundColor;if(f&&-1!==f.indexOf("linear-gradient"))for(var h=g(f),m=0,_=h.length;m<_;m++){var v=h[m];a.addColorStop(v.point,v.color)}else p&&a.addColorStop(0,p)}return a},_getTabForeColor:function(e,t){var n=Z;return e&&(n=e.color),t&&h._getBrightness(t)<127.5&&(n=Q),n}},t._SheetTabBase=u,e.exports=t},function(e,t,n){var t=n(117);t.SR={},t.SR.en=n(61),e.exports=t},function(e,t,n){function r(e){var t=e._floatingObjectRenderManagers;if(t){var n,r,o,i;for(n=0,o=t.length;n<o;n++){var a=t[n];if(a){for(r=0,i=a.length;r<i;r++){var s=a[r];s&&s._dispose()}a.length=0}}t.length=0,e._floatingObjectRenderManagers=j}var l=e._floatingObjectModel;l&&l._dispose()}function o(e,t,n){e._all().forEach(function(e){e._onRowsAdded(t,n)})}function i(e,t,n){var r,o,i=[];for(e._all().forEach(function(r){l(t,-1,t+n-1,e.sheet().getColumnCount(),r)&&(r.dynamicMove()||r.dynamicSize())?i.push(r):r._onRowsRemoved(t,n)}),r=0,o=i.length;r<o;r++)e._remove(i[r].name())}function a(e,t,n){e._all().forEach(function(e){e._onColumnsAdded(t,n)})}function s(e,t,n){var r,o,i=[];for(e._all().forEach(function(r){l(-1,t,e.sheet().getRowCount(),t+n-1,r)&&(r.dynamicMove()||r.dynamicSize())?i.push(r):r._onColumnsRemoved(t,n)}),r=0,o=i.length;r<o;r++)e._remove(i[r].name())}function l(e,t,n,r,o){var i=o[ue](),a=o[fe](),s=o[he](),l=o[ge]();return e<=i&&t<=a&&n>=s&&r>=l}function u(e,t){var n=this;return t||(t={}),V.each(e,function(e,r){var o=n[r],i=o.call(n);o.isDefault(i)||(t[r]=i)}),t}function c(e,t){if(t){var n=this;V.each(e,function(e,r){t[r]!==B&&n[r].call(n,t[r],!1)})}}function f(e){var t=e;return function(e){var n=this,r=n.sheet();t===it&&(n._needRefresh=!0),r&&r._invalidate(),n.onPropertyChanged(t,e)}}function d(e){var t=e;return function(e){var n=this,r=n.sheet();r&&(h(n),r._invalidate()),n.onPropertyChanged(t,e)}}function p(e){var t=e;return function(e){var n=this,r=n.sheet();r&&r._invalidate(),n.onPropertyChanged(t,e)}}function h(e){function t(t,r,o,i,a){var s=0,l=t.call(e);return s=r.call(e,n,0,l),m.call(e,t,o,i,!0,a),s+=o.call(e)}var n=e.sheet();if(n){var r=t(e[ue],g,e[ce],n.getRowHeight,ce),o=t(e[fe],_,e[de],n.getColumnWidth,de);e.x()===o&&e.y()===r||(e.x(o,!1),e.y(r,!1),e.onPropertyChanged("location",new E(o,r,e[ae](),e[se]())))}}function m(e,t,n,r,o){var i=this,a=t.call(i),s=n.call(i.sheet(),e.call(i),3),l=i._cacheOffset;s>0&&s--,a>s?(l[o]||(l[o]=a),t.call(i,s)):l[o]&&(l[o]<s?(t.call(i,l[o]),l[o]=B):(r&&s<l[o]||!r&&a<l[o])&&t.call(i,s))}function g(e,t,n,r){for(var o=0,i=t;i<n&&!((o+=e.getRowHeight(i,3))>r);i++);return o}function _(e,t,n,r){for(var o=0,i=t;i<n&&!((o+=e.getColumnWidth(i,3))>r);i++);return o}function v(e){function t(t,n,r,o,i){var a=b(e,t,n),s=a.index;o.call(e,a.offset,!1),-1===a.offset&&(s+=1,o.call(e,0),s===i&&(s=i-1)),r.call(e,s,!1)}var n=e.sheet();n&&(t(!0,e.y(),e[ue],e[ce],n.getRowCount()),t(!1,e.x(),e[fe],e[de],n.getColumnCount()))}function y(e){function t(t,n,r,o){var i=b(e,t,n);r.call(e,i.index,!1),o.call(e,i.offset,!1)}e.sheet()&&(t(!0,e.y()+e[se](),e[he],e[me]),t(!1,e.x()+e[ae](),e[ge],e[_e]))}function b(e,t,n){var r=0,o=0,i=e.sheet(),a=t?i.getRowCount():i.getColumnCount(),s=0;for(s=0;s<a;s++){var l=t?i.getRowHeight(s,3):i.getColumnWidth(s,3);if(r+=l,(o=r-n)>0){o=o>0?l-o:-1;break}if(0===o){o=0,s+=1;break}}return s>=a&&(s=a-1,o=0),{offset:o,index:s}}function w(e,t){this._sheet=e,this._typeName=t}function C(e){function t(t,r,o,i,a,s,l){var u=0,c=t.call(e),f=r.call(e);(u=o.call(e,n,c,f),0===u+i.call(n,f,3)&&e.isVisible()&&(e.isVisible(!1),e._isFOColumnsOrRowsVisible=!1),c===f)?(m.call(e,r,s,i,!1,l),u=e[me]()-e[ce]()):(i.call(n,c,3)>0&&(u-=a.call(e)),m.call(e,r,s,i,!1,l),u+=s.call(e));return u}var n=e.sheet();if(n){!1===e._isFOColumnsOrRowsVisible&&(e.isVisible(!0),e._isFOColumnsOrRowsVisible=!0);var r=t(e[ue],e[he],g,n.getRowHeight,e[ce],e[me],me),o=t(e[fe],e[ge],_,n.getColumnWidth,e[de],e[_e],_e);o<0&&(o=0),r<0&&(r=0),e[ae]()!==o&&(e[ae](o,!1),e.onPropertyChanged(ae,o)),e[se]()!==r&&(e[se](r,!1),e.onPropertyChanged(se,r))}}var S=n(1),x=n(0),T=n(63),E=S.Rect,M=S.Point,A=S.Events,k=S._ThemeContext,R=x._Types._isType,I=S._util,O=I._defProperty,D=I._createElement,P=I._getDistance,N=T._NamedObjectArray,F=document,L=x._hasOwnProperty,H=function(){return x._getResource(e.exports.SR)()},V=S.GC$,j=null,B=void 0,U=Math.ceil,W=Math.floor,z=Math.max,Y=Math.min,G=Math.abs,K="div",X="on",q="z-index",J="move",Z="unselectable",Q=1,$="border",ee=9007199254740992,te="floatingObjects",ne=".gcFloatingObject",re="name",oe="x",ie="y",ae="width",se="height",le="start",ue=le+"Row",ce=le+"RowOffset",fe=le+"Column",de=le+"ColumnOffset",pe="end",he=pe+"Row",me=pe+"RowOffset",ge=pe+"Column",_e=pe+"ColumnOffset",ve="isSelected",ye="isLocked",be="isVisible",we="canPrint",Ce="dynamicSize",Se="dynamicMove",xe="fixedPosition",Te="allowResize",Ee="allowMove",Me=700,Ae=701,ke="position",Re="absolute",Ie="background",Oe="gc-no-user-select",De="gc-floatingobject-selected",Pe="gc-floatingobject-unselected",Ne="gc-floatingobject-resize-indicator-select",Fe="gc-floatingobject-resize-indicator-unSelect",Le="gc-floatingobject-content-container",He="gc-floatingobject-container",Ve="gc-floatingobject-moving-container",je="gc-floatingobject-moving-div",Be=".gc-floatingobject-resize-indicator",Ue="gc-floatingobject-resize-indicator",We="gc-floatingobject-absolute",ze="gc-floatingobject-top",Ye="gc-floatingobject-middle",Ge="gcfloatingobject-bottom",Ke="gc-floatingobject-left",Xe="gc-floatingobject-center",qe="gc-floatingobject-right",Je="div."+Ue,Ze=Je+"."+ze+"."+Ke,Qe=Je+"."+Ye+"."+Ke,$e=Je+"."+Ge+"."+Ke,et=Je+"."+ze+"."+Xe,tt=Je+"."+Ge+"."+Xe,nt=Je+"."+ze+"."+qe,rt=Je+"."+Ye+"."+qe,ot=Je+"."+Ge+"."+qe,it="content",at="gc-no-user-select",st="100%",lt="gc-floatingobject-background-cover";(function(){var e=this;e._unSelectAllFloatingObjects=function(){var e=this._floatingObjectModel;e&&e._all().forEach(function(e){e.isSelected(!1)})},e._refreshObjectsAboveSheet=function(){var e=this,t=e._floatingObjectModel;t&&(t.isNeedToUpdateLayout=!0)},e._getFloatingObjectClipboardHelper=function(){var e=this,t=e.parent,n=e._floatingObjectClipboardHelper,r=t&&t._floatingObjectClipboardHelper;return n||(n=e._floatingObjectClipboardHelper=r||{fromSheet:j,isCutting:!1}),n},e._clearFloatingObjectClipboardHelper=function(){var e=this,t=e._getFloatingObjectClipboardHelper(),n=t&&t.fromSheet;n&&(n._clipboardFloatingObjectData=j),t.fromSheet=j,t.isCutting=!1},e._canSelectFloatingObject=function(e){var t=this.options;return!(!t.canMoveImage||"1"!==e.typeName)||(!t.isProtected||!e.isLocked()||t.protectionOptions.allowEditObjects)},e._canEditFloatingObject=function(e){var t=this.options;return!(!t.canMoveImage||"1"!==e.typeName)||(!t.isProtected||!e.isLocked()||t.protectionOptions.allowEditObjects)},e.isPasteFloatingObject=function(){var e=this,t=e._getFloatingObjectClipboardHelper().fromSheet,n=this._clipboardFloatingObjectData;return!n&&t&&(n=t._clipboardFloatingObjectData),n&&!n.isEmpty()}}).call(S.Worksheet.prototype);var ut={init:function(){var e=this;e._floatingObjectModel=new ft(e),e.pictures=new w(e,"1"),e.floatingObjects=new w(e,"0")},dispose:function(){var e=this;r(e),V(e._getCanvas()).unbind("mousedown.fos")},setHost:function(e){if(e){var t=this,n=".fos";e.bind("mousedown"+n,function(){t._unSelectAllFloatingObjects()}),t.bind(A.TableFiltered+n,function(){t._refreshObjectsAboveSheet()}),t.bind(A.RangeFiltered+n,function(){t._refreshObjectsAboveSheet()})}},onLayoutChanged:function(e){var t=e.changeType,n=e.row,r=e.rowCount,l=e.col,u=e.colCount,c=this._floatingObjectModel;c&&("addRows"===t?o(c,n,r):"deleteRows"===t?i(c,n,r):"addColumns"===t?a(c,l,u):"deleteColumns"===t&&s(c,l,u))},paint:function(e){var t=this,n=e.clipRect;t._paintFloatingObject||(t._getFloatingObjectRenderManager=function(e,n){t._floatingObjectRenderManagers||(t._floatingObjectRenderManagers=[]),t._floatingObjectRenderManagers[e]||(t._floatingObjectRenderManagers[e]=[]);var r=t._floatingObjectRenderManagers[e][n];return r||(t._floatingObjectRenderManagers[e][n]=new ht(t)),r=t._floatingObjectRenderManagers[e][n]},t._paintFloatingObject=function(e,t){var n=this;if(!n._hoverCell&&n._floatingObjectModel){var r=n._getSheetLayout();t!==j&&void 0!==t||(t=n._zoomFactor);for(var o=0;o<=2;o++)for(var i=0;i<=2;i++)if(r._viewportRect(o,i)){var a=n._getFloatingObjectRenderManager(o,i);a&&a._render(o,i,t)}}}),t._paintFloatingObject(n)},lastNonNullRowAndCol:function(){var e=0,t=0,n=this._floatingObjectModel;return n&&n._all().forEach(function(n){n&&(n[he]()>e&&(e=n[he]()),n[ge]()>t&&(t=n[ge]()))}),{lastNonNullRow:e,lastNonNullCol:t}},toJson:function(e){var t=this._floatingObjectModel.toJSON();t.length>0&&(e.floatingObjects=t)},fromJson:function(e,t){var n=this;n._floatingObjectModel=new ft(n);var r=e&&e.floatingObjectArray,o=t?r&&r.floatingObjects:e.floatingObjects;o&&n._floatingObjectModel.fromJSON(o,t)},preProcessMouseDown:function(){this._unSelectAllFloatingObjects()},processKeyDown:function(e){var t=this._floatingObjectModel;if(t){var n,r=t._all(),o=r.length;for(n=0;n<o;n++){if(r[n].isSelected())return void(e.r=!0)}}}};S.Worksheet._registerFeature(te,ut);var ct={init:function(){S.Commands._initFloatingObjectsDefaultCommands(this.commandManager())}};S.Workbook._registerFeature(te,ct),V.extend(w.prototype,{add:function(e,t,n,r,o,i){var a,s=this;return"1"===s._typeName?a=new mt.Picture(e,t,n,r,o,i):"0"===s._typeName&&(a=e),s._sheet._floatingObjectModel._add(a),a},get:function(e){return this._sheet._floatingObjectModel._get(e)},remove:function(e){this._sheet._floatingObjectModel._remove(e)},clear:function(){return this._sheet._floatingObjectModel._clear(this._typeName)},all:function(){return this._sheet._floatingObjectModel._all(this._typeName)},zIndex:function(e,t){return this._sheet._floatingObjectModel._zIndex(e,t)}});var ft=function(){function e(e){var n=this;n.sheet(e),t(n),n._storage={}}function t(e){var t=e.sheet();t&&(V(F.body).bind("scroll"+ne,function(){var e=t.parent.getActiveSheet();e._floatingObjectModel&&t._paintFloatingObject(e._getBounds())}),t._bind(A.ColumnChanged+ne,function(t,r){var o=r.propertyName;o!==ae&&o!==be||n(e)}),t._bind(A.RowChanged+ne,function(t,r){var o=r.propertyName;o!==se&&o!==be||n(e)}),t._bind(A.ColumnWidthChanged+ne,function(){n(e)}),t._bind(A.RowHeightChanged+ne,function(){n(e)}))}function n(e){var t=e.sheet();e.isNeedToUpdateLayout=!0,t._paintFloatingObject&&t._paintFloatingObject(t._getBounds())}function r(e,t){if(e._storage[t])throw new Error(H().Exp_FloatingObjectHasSameNameError)}var o={sheet:O("sheet",B),_add:function(e){var t=this,n=t.sheet();n.suspendPaint();var o=e.name();if(!o)throw new Error(H().Exp_FloatingObjectNameEmptyError);r(t,o),e.sheet(n),t._storage[o]=e,n.resumePaint()},_get:function(e){return this._storage[e]},_remove:function(e,t){var n=this;if(e){var r=n.sheet(),o=n._get(e);if(r.suspendPaint(),t){var i={sheet:r,sheetName:r._name,floatingObject:o,cancel:!1};r._trigger(A.FloatingObjectRemoving,i),i&&!1===i.cancel&&(delete n._storage[e],r._trigger(A.FloatingObjectRemoved,{sheet:r,sheetName:r._name,floatingObject:o}))}else delete n._storage[e];return r.resumePaint(),!0}return!1},_rename:function(e,t){var n=this,o=n.sheet();if(o.suspendPaint(),!t)throw new Error(H().Exp_FloatingObjectNameEmptyError);r(n,t);var i=n._storage[e];delete n._storage[e],n._storage[t]=i,o.resumePaint()},_clear:function(e){var t=this,n=t.sheet();n.suspendPaint(),V.each(this._storage,function(n,r){e&&e!==r.typeName||t._remove(r.name())}),n.resumePaint()},_all:function(e){var t=[];return V.each(this._storage,function(n,r){e&&e!==r.typeName||t.push(r)}),t},_zIndex:function(e,t){var n=this.sheet(),r=n._floatingObjectRenderManagers;if(r)for(var o=0,i=r.length;o<i;o++){var a=r[o];if(a)for(var s=0,l=a.length;s<l;s++){var u=a[s];if(u){if(isNaN(t)){var c=u._zIndex(e);if(-1===c)continue;return c}u._zIndex(e,t)}}}if(isNaN(t))return-1},toJSON:function(){var e=[];return this._all().forEach(function(t){t instanceof dt&&t._needSaveJsonToFloatingObjects()&&e.push(t.toJSON())}),e},fromJSON:function(e,t){var n=this;if(e&&0!==e.length)for(var r=0;r<e.length;r++){var o=e[r],i=j;if(o){var a,s=o.floatingObjectType,l=I._isDefined(s)?s+"":o.typeName;a="0"===l?dt:"1"===l?mt.Picture:S.getTypeFromString(l),a&&(i=new a,i.fromJSON(o,t),n._add(i))}}},_dispose:function(){V(F.body).unbind("scroll"+ne);var e=this.sheet();e&&(e._unbind(A.ColumnChanged+ne),e._unbind(A.RowChanged+ne),e._unbind(A.ColumnWidthChanged+ne),e._unbind(A.RowHeightChanged+ne))},hitTest:function(e,t){var n=this.sheet(),r=n._getSheetLayout(),o=n._zoomFactor,i=j;return r&&V.each(this._storage,function(a,s){if(n._canSelectFloatingObject(s)){var l=s.position().x*o+r._headerX+r._rowHeaderWidth,u=s.position().y*o+r._headerY+r._colHeaderHeight,c=s[ae](),f=s[se]();return e>=l&&e<l+c&&t>=u&&t<u+f?(i={x:e,y:t,floatingObject:s},!1):void 0}}),i},_generateFloatingObjectName:function(){for(var e="FloatingObject",t=1,n=e+t;this._get(n);)t++,n=e+t;return n}};return V.extend(e.prototype,o),e}(),dt=function(){function e(e,t,n,r,o){var i=this;i._cacheOffset={startRowOffset:B,startColumnOffset:B,endRowOffset:B,endColumnOffset:B},i._isFOColumnsOrRowsVisible=!0,i.typeName="0",i.name(e),i.x(t||0,!1),i.y(n||0,!1),i[ae](r||0,!1),i[se](o||0,!1),i._host=[],i._needRefresh=!1}function t(e){return function(t){this.onPropertyChanged(e,t)}}function n(e,t){return function(n){var r=this,o=r.sheet();o&&(t&&i(r),a(r),b(r),o._invalidate()),r.onPropertyChanged(e,n)}}function r(e,t,n,r){var o=this,i=e.call(o),a=t.call(o);n<=i?o.dynamicMove()&&(e.call(o,i+r),t.call(o,a+r)):n>i&&n<a&&o.dynamicSize()&&t.call(o,a+r)}function o(e,t,n,r,o,i,a){var s=this,l=e.call(s),u=n.call(s);if(o<=l){if(a<l)s.dynamicMove()&&(e.call(s,l-i),n.call(s,u-i));else if(a<u){var c=a-l+1,f=u-l+1-c;s.dynamicMove()&&(e.call(s,o),t.call(s,0)),s.dynamicSize()&&n.call(s,o+f-1)}}else o<=u&&(a<u?s.dynamicSize()&&n.call(s,u-i):s.dynamicSize()&&(n.call(s,o),r.call(s,0)))}function i(e){var t=l(e,e[se]()),n=m(e,e[ae]());e[ae]()>n&&e[ae](n,!1),e[se]()>t&&e[se](t,!1)}function a(e){var t=e.x()+e[ae](),n=m(e,t);t>n&&e.x(z(0,n-e[ae]()),!1),e.x()<0&&e.x(0,!1);var r=e.y()+e[se](),o=l(e,r);r>o&&e.y(z(0,o-e[se]()),!1),e.y()<0&&e.y(0,!1)}function s(e){i(e),a(e);var t=e[ue](),n=e[fe]();t&&n?h(e):v(e);var r=e[he](),o=e[ge]();r&&o?C(e):y(e)}function l(e,t){var n=e.sheet();return n?g(n,0,n.getRowCount(),t):ee}function m(e,t){var n=e.sheet();return n?_(n,0,n.getColumnCount(),t):ee}function b(e){v(e),y(e)}var w=[re,oe,ie,ae,se,we,ve,ye,be,Se,Ce,xe,Te,Ee],x=[["sheet",j,function(){s(this)}],[re,B,function(e){var t=this;if("string"!=typeof e||""===e)throw new Error(H().Exp_FloatingObjectNameEmptyError);t.sheet()&&t.sheet()._floatingObjectModel._add(t),t.onPropertyChanged("name",e)},function(){var e=this;return e.sheet()&&e.sheet()._floatingObjectModel._remove(e.name()),!0}],[oe,0,n(oe,!1)],[ie,0,n(ie,!1)],[se,0,n(se,!0)],[ae,0,n(ae,!0)],[ue,B,d(ue)],[ce,0,d(ce)],[fe,B,d(fe)],[de,0,d(de)],[he,B,p(he)],[me,0,p(me)],[ge,B,p(ge)],[_e,0,p(_e)],[ve,!1,f(ve)],[ye,!0,t(ye)],[we,!0,t(we)],[be,!0,f(be)],[Se,!0,function(e,n){t(Se).call(this,e,n)},function(e){return"boolean"==typeof e&&(e||this.dynamicSize(!1,!1),!this.fixedPosition())}],[Ce,!0,function(e,n){t(Ce).call(this,e,n)},function(e){return"boolean"==typeof e&&this.dynamicMove()&&!this.fixedPosition()}],[xe,!1,function(e){var t=this;e&&(t.dynamicMove(!1,!1),t.dynamicSize(!1,!1)),t.onPropertyChanged(xe,e)}],[Te,!0,f(Te)],[Ee,!0,f(Ee)]],T={constructor:e,position:function(e){var t=this,n=t.sheet();return 0===arguments.length?new M(t.x(),t.y()):(R(e,M)&&(t.x()===e.x&&t.y()===e.y||(t.x(e.x,!1),t.y(e.y,!1),a(t),b(t),n&&n._invalidate(),t.onPropertyChanged("position",e))),t)},content:O(it,j,f(it)),cloneContent:function(){var e=this.content();if(e){var t;if(e.cloneNode)t=e.cloneNode(!0);else{var n=D(K);n.innerHTML=e.outerHTML,t=n.firstChild}return V(t).removeAttr("id")[0]}return j},refreshContent:function(e){var t=this;if(t._needRefresh&&e){var n=V(e);n.empty();var r=t.cloneContent(),o=st,i=st,a="",s="";r&&r.style&&(a=r.style.width,s=r.style.height),""!==a&&(o=a),""!==s&&(i=s),r!==j?(V(r).css({width:o,height:i}).addClass(lt).addClass(Oe).attr(Z,X).appendTo(e),n.css(Ie,"")):n.css(Ie,"#044062"),t._needRefresh=!1}},toJSON:function(){var e=this,t=u.call(e,w);return t.typeName=e.typeName,t[it]=V(D(K)).append(e.cloneContent()).html(),t},fromJSON:function(e,t){if(e){var n=this;if(n._loading=!0,c.call(this,w,e,t),b(n),e.content){var r=D(K);r.innerHTML=e.content,n.content(V(r.firstChild)[0])}n._loading=B}},clone:function(){var t=this,n=S.getTypeFromString(t.typeName),r=n?new n:new e,o=JSON.stringify(t.toJSON());return r.fromJSON(JSON.parse(o)),r.content(t.cloneContent()),r},onPropertyChanged:function(e,t){var n=this;if(!n._loading){var r=n.sheet();n._trigger({sheet:r,sheetName:r?r._name:"",floatingObject:n,propertyName:e})}},_trigger:function(e){var t=this.sheet();if(t&&(t._trigger(A.FloatingObjectChanged,e),e.propertyName===ve)){var n={sheet:e.sheet,sheetName:e.sheetName,floatingObject:e.floatingObject};t._trigger(A.FloatingObjectSelectionChanged,n)}},_onRowsAdded:function(e,t){var n=this;e=U(e),t=U(t),r.call(n,n[ue],n[he],e,t)},_onRowsRemoved:function(e,t){var n=this,r=e+t-1;o.call(n,n[ue],n[ce],n[he],n[me],e,t,r)},_onColumnsAdded:function(e,t){var n=this;e=U(e),t=U(t),r.call(n,n[fe],n[ge],e,t)},_onColumnsRemoved:function(e,t){var n=this;e=U(e),t=U(t);var r=e+t-1;o.call(n,n[fe],n[de],n[ge],n[_e],e,t,r)},getHost:function(){return this._host.concat()},_addContainer:function(e){var t=this._host;e&&t.indexOf(e)<0&&t.push(e)},_removeContainer:function(e){var t=this._host,n=t.indexOf(e);n>=0&&t.splice(n,1)},_createContentContainer:function(){var e=D(K);V(e).addClass(at).addClass(Le).attr(Z,X).css(ke,Re);var t=this.cloneContent(),n=st,r=st,o="",i="",a=t&&t.style;return a&&(o=a.width,i=a.height),""!==o&&(n=o),""!==i&&(r=i),t!==j&&V(t).css({width:n,height:r}).addClass(lt).addClass(at).attr(Z,X).appendTo(e),this._addContainer(e),e},_needSaveJsonToFloatingObjects:function(){return!0}};return V.each(x,function(e,t){T[t[0]]=O(t[0],t[1],t[2],t[3])}),e.prototype=T,e}(),pt=function(){function e(e,t){this._srcCache="";var n=this;n._floatingObject=e,n.name=e?e.name():"",n._sheet=t,n._isMouseCapture=!1,n._isResizeIndicatorDisplayed=!1}function t(e,t,n){var r,o=e[U],i=e[ee],a=0,s=1;return n&&(a=o,s=-1),r=t.x-e[N]-a,e[H]+r*i/o*s}function n(e,n,r){var o,i,a,s,l,u=e._resizeInfo;switch(n){case ve:l=t(u,r),o=Y(u[N]+u[U],r.x),i=Y(u[H]+u[ee],l),a=G(r.x-u[N]-u[U]),s=Math.ceil(a*u[ee]/u[U]);break;case ye:o=u[N],i=Y(u[H]+u[ee],r.y),a=u[U],s=G(r.y-u[H]-u[ee]);break;case be:l=t(u,r,!0),o=Y(u[N],r.x),i=Y(u[H]+u[ee],l),a=G(r.x-u[N]),s=Math.ceil(a*u[ee]/u[U]);break;case Ce:o=Y(u[N]+u[U],r.x),i=u[H],a=G(r.x-u[N]-u[U]),s=u[ee];break;case Se:o=Y(u[N],r.x),i=u[H],a=G(r.x-u[N]),s=u[ee];break;case Te:o=Y(u[N]+u[U],r.x),i=Y(u[H],r.y),a=G(r.x-u[N]-u[U]),s=Math.floor(a*u[ee]/u[U]);break;case Ee:o=u[N],i=Y(u[H],r.y),a=u[U],s=G(r.y-u[H]);break;case Je:o=Y(u[N],r.x),i=Y(u[H],r.y),a=G(r.x-u[N]),s=Math.floor(a*u[ee]/u[U])}return new E(o,i,a,s)}function r(e){var t=V(e),n=t.position();return new E(n.left,n.top,t[ae](),t[se]())}function o(e,t,n,r,o,i){V(e).css([_e,de,ae,se],[[r-1],[n-1],o,i]).addClass(je).appendTo(t)}function i(e,t){if(!e._layout)return j;var n={inMoving:!1};return V(t.target).attr("resizeDirection")||(n.inMoving=!0),n}function a(e){var t,n,r,o,i,a=e,s=a._sheet,l=a._rowViewportIndex,u=a._columnViewportIndex,c=s.frozenTrailingRowCount(),f=s.frozenTrailingColumnCount(),d=s._getSheetLayout(),p=d._viewportRect(l,u),h=a._floatingObject,m=h[ue](),g=h[fe](),_=h[he](),v=h[ge](),y=s.frozenRowCount(),b=s.frozenColumnCount(),w=s.getRowCount(3)-c-1,C=s.getColumnCount(3)-f-1;return l===Q?(y>0&&(t=s.getViewportTopRow(l),(m<y||t===y)&&(p.y-=d._frozenHeight,p[se]+=d._frozenHeight)),c>0&&(n=s.getViewportBottomRow(l),_>w&&n===w&&(p[se]+=d._frozenTrailingHeight))):l===Q-1?(t=s.getViewportTopRow(l+1),(_>=t||t===y)&&(i=d._viewportRect(l+1,u),p[se]+=i[se])):l===Q+1&&(n=s.getViewportBottomRow(l-1),(m<=n||n===w)&&(i=d._viewportRect(l-1,u),p.y=i.y,p[se]+=i[se])),u===Q?(b>0&&(r=s.getViewportLeftColumn(u),(g<b||r===b)&&(p.x-=d._frozenWidth,p[ae]+=d._frozenWidth)),s.frozenTrailingColumnCount()>0&&(o=s.getViewportRightColumn(u),(v>C||o===C)&&(p[ae]+=d._frozenTrailingWidth))):u===Q-1?(r=s.getViewportLeftColumn(u+1),(v>=r||r===b)&&(i=d._viewportRect(l,u+1),p[ae]+=i[ae])):u===Q+1&&(o=s.getViewportRightColumn(u-1),(g<=o||o===C)&&(i=d._viewportRect(l,u-1),p.x=i.x,p[ae]+=i[ae])),p}function s(e,t,n,o,i){var a=r(e);V(e).css([_e,de,ae,se],[a.y+n,a.x+t,a[ae]+o,a[se]+i])}function l(e){var t=e;if(t._mouseDownHittestInfo){var o,i=t._mousePosition,l=a(t),u=t._moveResizeDiv,c=t._resizeInfo,f=c.direction;i=new M(i.x-l.x,i.y-l.y),o=n(t,f,i),c.endX=o.x,c.endY=o.y,c.endWidth=o[ae],c.endHeight=o[se];var d=r(u),p=o.y-d.y,h=o.x-d.x,m=o[ae]-d[ae],g=o[se]-d[se];s(u,h,p,m,g);var _=t._attachedMoveResizeDivDict;for(var v in _)if(L(_,v)){var y=_[v];s(y.moveResizeDiv,h,p,m,g)}}}function u(e,t){var n=e._sheet;if(n)return n._mouseWheelDelegate(t),!1}function c(e){var t=e,n=t._sheet,r=t._moveInfo;if(r){var o=P(n,r[ie],n.getViewportTopRow(t._rowViewportIndex),!0),i=P(n,r[ce],n.getViewportLeftColumn(t._columnViewportIndex),!1),a=r[re]-r[N]+(r[re]>r[N]?i:-1*i),s=r[oe]-r[H]+(r[oe]>r[H]?o:-1*o);if(0===a&&0===s)return;var l=[];l.push(t._floatingObject.name());var u=t._attachedMoveResizeDivDict;for(var c in u)L(u,c)&&l.push(c);n._commandManager().execute({cmd:"dragCopyFloatingObjects",sheetName:n.name(),floatingObjects:l,offsetX:a,offsetY:s})}}function f(e){var t=e,n=t._sheet,r=t._moveInfo,o=n._zoomFactor;if(r){var i=P(n,r[ie],n.getViewportTopRow(t._rowViewportIndex),!0),a=P(n,r[ce],n.getViewportLeftColumn(t._columnViewportIndex),!1),s=r[re]-r[N]+(r[re]>r[N]?a:-1*a),l=r[oe]-r[H]+(r[oe]>r[H]?i:-1*i);s/=o,l/=o;var u=[];u.push(t._floatingObject.name());var c=t._attachedMoveResizeDivDict;for(var f in c)L(c,f)&&u.push(f);n._commandManager().execute({cmd:"moveFloatingObjects",sheetName:n.name(),floatingObjects:u,offsetX:s,offsetY:l})}}function d(e){var t=e,n=t._sheet,r=n._zoomFactor,o=t._floatingObject,i=t._resizeInfo;if(i){var a=P(n,i[ie],n.getViewportTopRow(t._rowViewportIndex),!0),s=P(n,i[ce],n.getViewportLeftColumn(t._columnViewportIndex),!1),l=i[re]-i[N]+(i[re]>i[N]?s:-1*s);l/=r;var u=i[oe]-i[H]+(i[oe]>i[H]?a:-1*a);u/=r;var c=(i.endWidth+s)/r-o[ae](),f=(i.endHeight+a)/r-o[se](),d=[];d.push(o.name());var p=t._attachedMoveResizeDivDict;for(var h in p)L(p,h)&&d.push(h);n._commandManager().execute({cmd:"resizeFloatingObjects",sheetName:n.name(),floatingObjects:d,offsetX:l,offsetY:u,offsetWidth:c,offsetHeight:f})}}function p(e,t,n){var r=e,o=r._moveResizeDiv;if(o){var i=n.x-t.x,a=n.y-t.y;h(o,i,a);var s=r._attachedMoveResizeDivDict;for(var l in s)if(L(s,l)){var u=s[l];h(u.moveResizeDiv,i,a)}}}function h(e,t,n){var r=V(e),o=V(e).position();r.css([_e,de],[o[_e]+n,o[de]+t])}function m(e){var t=e,n=t._moveInfo;if(n){var r=t._floatingObject,o=t._sheet,i=o._getSheetLayout(),a=i[ae]-i._rowHeaderWidth-i._headerX,s=i[se]-i._colHeaderHeight-i._headerY,l=n.startX,u=n.startY,c=r.position().x,f=r.position().y,d=r[ae](),p=r[se]();c+n.endX-l<0&&(n.endX=l-c),f+n.endY-u<0&&(n.endY=u-f),c+d+n.endX-l>a&&(n.endX=a+l-c-d),f+p+n.endY-u>s&&(n.endY=s+u-f-p),n.startTopRow=o.getViewportTopRow(t._rowViewportIndex),n.startLeftColumn=o.getViewportLeftColumn(t._columnViewportIndex)}}function g(e){var t=e,n=t._resizeInfo;if(n){var r=t._sheet,o=r._getSheetLayout(),i=o[ae]-o._rowHeaderWidth-o._headerX,a=o[se]-o._colHeaderHeight-o._headerY,s=new E(n.endX,n.endY,n.endWidth,n.endHeight);s=s.getIntersect(0,0,i,a),n.endX=s.x,n.endY=s.y,n.endWidth=s[ae],n.endHeight=s[se],n.startTopRow=r.getViewportTopRow(t._rowViewportIndex),n.startLeftColumn=r.getViewportLeftColumn(t._columnViewportIndex)}}function _(t){var n=D(K),r=V(n),o=t;o._renderManager._reduceZIndex(),r.addClass(He).addClass(Oe).attr(Z,X).css(q,Me).bind("mousedown",function(e){o._doMouseDown(e)}).bind(st,function(e){o._doMouseMove(e)}).bind(lt,function(e){o._doMouseUp(e)}),n.addEventListener("mousewheel",function(e){u(o,e)},!1),n.addEventListener("DOMMouseScroll",function(e){u(o,e)},!1);var i=V(D(K)).addClass(Ue+" "+ze+" "+Ke+" "+We),a=V(D(K)).addClass(Ue+" "+ze+" "+Xe+" "+We),s=V(D(K)).addClass(Ue+" "+ze+" "+qe+" "+We),l=V(D(K)).addClass(Ue+" "+Ye+" "+Ke+" "+We),c=V(D(K)).addClass(Ue+" "+Ye+" "+qe+" "+We),f=V(D(K)).addClass(Ue+" "+Ge+" "+Ke+" "+We),d=V(D(K)).addClass(Ue+" "+Ge+" "+Xe+" "+We),p=V(D(K)).addClass(Ue+" "+Ge+" "+qe+" "+We);return r.append(i).append(a).append(s).append(l).append(c).append(f).append(d).append(p),e._callFeatureHandler(o,"init",n),n}function v(e){var t=e,n=t._floatingObjectContainerDiv&&t._layout;if(n&&!t._moveResizeDiv){var r=t._moveResizeContainerDiv=D(K);t._moveResizeDiv=D(K),t._attachedMoveResizeDivDict={},t._renderManager._renders.each(function(e){var r=e._floatingObject;if(r&&r.name()!==t._floatingObject.name()&&r.isSelected()&&!t._attachedMoveResizeDivDict[r.name()]){var o=e._layout;t._attachedMoveResizeDivDict[r.name()]={offsetX:o.x-n.x,offsetY:o.y-n.y,height:o[se],width:o[ae],moveResizeDiv:D(K)}}});var i=a(t);V(r).css([q,_e,de,ae,se,Ie],[Ae,i.y,i.x,i[ae],i[se],"rgba(255,255,255,0.01)"]).addClass(Ve).bind(st,function(e){t._doMouseMove(e)}).bind(lt,function(e){t._doMouseUp(e)});var s=n.y-i.y,l=n.x-i.x;o(t._moveResizeDiv,r,l,s,n[ae],n[se]);var u=t._attachedMoveResizeDivDict;for(var c in u)if(L(u,c)){var f=u[c];o(f.moveResizeDiv,t._moveResizeContainerDiv,l+f.offsetX,s+f.offsetY,f[ae],f[se])}t._containerDiv&&V(t._containerDiv).append(t._moveResizeContainerDiv)}}function y(e){var t=e;t._isMouseCapture||(V(F).bind(st+ne,function(e){t._doMouseMove(e)}).bind(lt+ne,function(e){t._doMouseUp(e)}),t._isMouseCapture=!0)}function b(e){var t=e;t._isMouseCapture&&(t._isMouseCapture=!1,V(F).unbind(st+ne).unbind(lt+ne))}function w(t,n){V(Be,n).removeClass(Fe);var o=t,i=r(o._floatingObjectContainerDiv),a=o._floatingObjectContentDiv,s=o._floatingObject;o._borderDiv&&(a=o._borderDiv);var l=e._resizeIndicatorSize,u=r(a),c=u.x,f=u.y,d=i[se]-u.y-u[se],p=i[ae]-u.x-u[ae],h=0,m=l+2,g=W(l/2+1);if("function"==typeof s.borderWidth){var _=s.borderWidth(),v=s.borderStyle();s._isBorderStyleWork(v)||(_=0),_>=g&&(h=_-g),d=i[se]-f-u[se]-_,p=i[ae]-c-u[ae]-_,c+=_,f+=_}c>0?(C(o,f>0,Ze,h,h,B,B,"nw"+it,ve),C(o,i[se]>0,Qe,h,(u[se]-m)/2+f,B,B,"w"+it,Ce),C(o,d>0,$e,h,B,B,h,"ne"+it,Te)):(x(o,Ze),x(o,Qe),x(o,$e)),C(o,f>0,et,(u[ae]-m)/2+c,h,B,B,"n"+it,ye),C(o,d>0,tt,(u[ae]-m)/2+c,B,B,h,"n"+it,Ee),p>0?(C(o,f>0,nt,B,h,h,B,"sw"+it,be),C(o,i[se]>0,rt,B,(u[se]-m)/2+f,h,B,"w"+it,Se),C(o,d>0,ot,B,B,h,h,"se"+it,Je)):(x(o,nt),x(o,rt),x(o,ot)),o._isResizeIndicatorDisplayed=!0}function C(t,n,r,o,i,a,s,l,u){var c=t,f=V(r,c._floatingObjectContainerDiv);if(n){var d=e._resizeIndicatorSize;f.css([de,_e,me,xe,ae,se,at],[o,i,a,s,d,d,l]).addClass(Ne).attr("resizeDirection",u)}else x(c,r)}function x(e,t){V(t,e._floatingObjectContainerDiv).removeClass(Ne).addClass(Fe)}function T(e,t){V(Be,t).removeClass(Ne).addClass(Fe),e._isResizeIndicatorDisplayed=!1}function R(e){var t=e,n=t._floatingObject,r=n.src(),o=n.pictureStretch(),i=k._getColor(n.sheet(),n.backColor()),a=t._floatingObjectContentDiv;if(r&&a){var s=V(a);if(t._srcCache!==r&&(t._srcCache=r,s.css([Ie+"-image",Ie+"-repeat"],["url('"+r+"')","no-repeat"])),s.css(Ie+"-color",i),o!==j&&o!==B&&n._isImageLoaded){var l=n.getOriginalWidth(),u=n.getOriginalHeight(),c=s[ae](),f=s[se]();I._applyBackgroundImageLayout(a,c,f,l,u,o)}}}function O(t,n,r){var o=t._borderDiv,i=t._floatingObject,a=i.borderWidth(),s=i.borderStyle(),l=k._getColor(i.sheet(),i.borderColor()),u=i.borderRadius(),c=0,f=W(e._resizeIndicatorSize/2+1);i._isBorderStyleWork(s)||(a=0),a<f&&(c=f-a);var d=c,p=c,h=c,m=c;f=z(a,f),n.x<0?d+=n.x-f:(n.x<f?d+=n.x-f:d+=0,m=r[ae]-d-n[ae]-2-2*a),n.y<0?p+=n.y-f:(n.y<f?p+=n.y-f:p+=0,h=r[se]-p-n[se]-2-2*a),V(o).css([ke,de,_e,xe,me,$+"-width",$+"-style",$+"-color",$+"-radius"],[Re,d,p,h,m,a,s,l,u])}var N=le+"X",H=le+"Y",U=le+"Width",ee=le+"Height",te="end",re=te+"X",oe=te+"Y",ie=le+"TopRow",ce=le+"LeftColumn",de="left",pe="center",me="right",_e="top",ve=_e+de,ye=_e+pe,be=_e+me,we="middle",Ce=we+de,Se=we+me,xe="bottom",Te=xe+de,Ee=xe+pe,Je=xe+me,it="-resize",at="cursor",st="mousemove",lt="mouseup";return S._defineFeature(e),e.prototype={_doMouseDown:function(t){var n=this,o=n._sheet,a=n._floatingObject,s=o.comments,l=n._rowViewportIndex,u=n._columnViewportIndex;if(o._canEditFloatingObject(a)&&o.endEdit()){var c={e:t,r:j};if(e._callFeatureHandler(n,"preProcessMouseDown",c),!c.r){if(0===t.button||2===t.button){var f=a.isSelected();if(t.ctrlKey||t.shiftKey?a.isSelected(!f):f||(o._unSelectAllFloatingObjects(),a.isSelected(!0)),f||S._FocusHelper._setActiveElement(o),s&&s._clearActiveComment(),o._saveAndClearSheetSelections(),2===t.button)return;var d=o._eventHandler,p=o._getCanvasOffset(),h=new M(t.pageX-p.left,t.pageY-p.top),m=i(n,t);if(!a.allowMove()&&(!a.allowResize()||m.inMoving))return;if(n._mousePosition=h,n._isMouseLeftButtonDown=!0,n._mouseDownHittestInfo=m,m.inMoving){var g={};g.startTopRow=o.getViewportTopRow(l),g.startLeftColumn=o.getViewportLeftColumn(u),g.startX=h.x,g.startY=h.y,n._moveInfo=g}else{v(n);var _={},b=r(n._moveResizeDiv);_.startX=b.x,_.startY=b.y,_.startWidth=b[ae],_.startHeight=b[se],_.startTopRow=o.getViewportTopRow(l),_.startLeftColumn=o.getViewportLeftColumn(u),_.cursor=t.target.style.cursor,_.direction=V(t.target).attr("resizeDirection"),n._resizeInfo=_}y(n);var w=o.hitTest(h.x,h.y);d._startHitInfo={_scrollRowViewportIndex:w.rowViewportIndex,_scrollColViewportIndex:w.colViewportIndex,_hitTestType:w.hitTestType},d._mousePosition=h,d._startScroll(),d._isFloatingObjectWorking=!0}return!1}}},_doMouseMove:function(t){var n=this,r=n._sheet,o=n._floatingObjectContainerDiv,i=n._moveResizeContainerDiv;if(r._canEditFloatingObject(n._floatingObject)){var a={e:t,r:j};if(e._callFeatureHandler(n,"preProcessMouseMove",a),!a.r){if(r._isMouseDownInSheet)return o&&V(o).css(at,"default"),!0;var s=r._eventHandler,u=r._getCanvasOffset(),c=new M(t.pageX-u.left,t.pageY-u.top);return n._isMouseLeftButtonDown&&(n._mouseDownHittestInfo.inMoving?(n._isMoving=!0,v(n),p(n,n._mousePosition,c),V(i).css(at,J)):n._floatingObject.allowResize()&&(n._isResizing=!0,l(n),V(i).css(at,n._resizeInfo[at])),(n._isMoving||n._isResizing)&&(n._mousePosition=c,s._mousePosition=c,s._continueScroll(),V(F.body).addClass(Oe).attr(Z,X))),!1}}},_doMouseUp:function(t){var n=this,r=n._sheet,o=r._eventHandler,i=n._floatingObject,a=n._floatingObjectContainerDiv,s=n._mouseDownHittestInfo;if(r._canEditFloatingObject(i)){var l={e:t,r:j};if(e._callFeatureHandler(n,"preProcessMouseUp",l),!l.r){if(r._isMouseDownInSheet)return V(a).css(at,J),!0;o._isFloatingObjectWorking=!1,o._stopScroll();var u=r._getCanvasOffset(),p=new M(t.pageX-u.left,t.pageY-u.top),h=n._moveInfo;if(h&&(h.endX=p.x,h.endY=p.y),s){var _=i.fixedPosition();s.inMoving&&n._isMoving?(_&&m(n),t.ctrlKey?c(n):f(n)):n._isResizing&&(_&&g(n),d(n)),V(F.body).removeClass(Oe)}return n._resetStatusOnMouseUp(),!1}}},_resetStatusOnMouseUp:function(){var e=this;e._resizeInfo=j,e._moveInfo=j,e._attachedMoveResizeDivDict=j,V(e._moveResizeContainerDiv).remove(),e._moveResizeDiv=j,e._isMouseLeftButtonDown=!1,b(e),e._isMoving=!1,e._isResizing=!1},_floatingObject:function(){return this._floatingObject},_render:function(e,t){var n=this,r=n._floatingObject,o=n._sheet;if(r){var i=!1;n._rect=e;var a=n._floatingObjectContainerDiv;if(!a){a=n._floatingObjectContainerDiv=_(n);var s=o.parent;if(s){var l=n._containerDiv=s._getContainerDiv();l&&V(l).append(a)}}var u=n._floatingObjectContentDiv;u||(u=n._floatingObjectContentDiv=r._createContentContainer(),"function"==typeof r.borderWidth?(n._borderDiv=D(K),V(n._borderDiv).addClass(Oe+" "+Le).attr(Z,X),a.appendChild(n._borderDiv),n._borderDiv.appendChild(u)):(0===r.name().indexOf("collab")&&(u.className+=" collab-container",a.className+=" collab-container"),a.appendChild(u),i=!0)),n._borderDiv&&(O(n,t,e),t.x=0,t.y=0);var c=V(u);if(V(a).css([_e,de,ae,se],[e.y,e.x,e[ae],e[se]]),c.css([_e,de,ae,se,at],[t.y,t.x,t[ae],t[se],J]),r.refreshContent&&r.refreshContent(u),n._borderDiv&&R(n),r.isSelected()?(c.removeClass(Pe).addClass(De),r.allowResize()?w(n,a):n._isResizeIndicatorDisplayed&&T(n,a)):(c.removeClass(De).addClass(Pe),T(n,a)),i){var f=u.firstChild;o._trigger(A.FloatingObjectLoaded,{sheet:o,sheetName:o._name,floatingObject:r,element:f})}}},_zIndex:function(e){var t=this._floatingObjectContainerDiv;if(t)if(isNaN(e)){var n=parseInt(t.style.zIndex);if(!isNaN(n))return n}else t.style.zIndex=e;if(isNaN(e))return-1},_dispose:function(){var t=this,n=t._floatingObject,r=t._floatingObjectContainerDiv,o=t._moveResizeContainerDiv,i=t._floatingObjectContentDiv;e._callFeatureHandler(t,"dispose"),i&&n._removeContainer&&n._removeContainer(i),r&&(V(r).remove(),t._floatingObjectContainerDiv=j),o&&(V(o).remove(),t._moveResizeContainerDiv=j)}},e._resizeIndicatorSize=7,e}(),ht=function(){function e(e){this._sheet=e,this._renders=new N}function t(e){e._all().forEach(function(e){e.dynamicMove()?h(e):v(e),e.dynamicSize()?C(e):y(e)})}function n(e,t,n){var r=e._sheet,o=r._getViewportColumnLayout(n),i=0,a=0,s=0,l=0;if(o&&o.length>0){var u=o[0],c=o[o.length-1];i=u.x,s=c.x+c[ae]-i}var f=r._getViewportRowLayout(t);if(f&&f.length>0){var d=f[0],p=f[f.length-1];a=d.y,l=p.y+p[se]-a}return r._getSheetLayout()._viewportRect(t,n).getIntersect(i,a,s,l)||new E(0,0,0,0)}function r(e,n,r,o){var i=e,a=i._sheet,s=new N,l=a._floatingObjectModel;l.isNeedToUpdateLayout&&(t(l),l.isNeedToUpdateLayout=!1);var u=a._getSheetLayout(),c=a._cachePool,f=a._getViewportColumnLayout(r),d=a._getViewportRowLayout(n);if(f.length<=0||d.length<=0)return s;var p=f[0],h=f[f.length-1],m=d[0],g=d[d.length-1];return l._all().forEach(function(e){if(e&&e.isVisible()){var t,n;if(e.fixedPosition()){var r=e.position();t=r.x*o+u._frozenX,n=r.y*o+u._frozenY}else{t=0;var i=e[fe](),a=f.findCol(i);if(a)t=a.x;else if(i<p.col){t=p.x;for(var l=p.col-1;l>=i;l--)t-=c._getZoomColWidth(l)}else{t=h.x+h[ae];for(var _=h.col+1;_<=i;_++)t+=c._getZoomColWidth(_)}t+=e[de]()*o,n=0;var v=e[ue](),y=d.findRow(v);if(y)n=y.y;else if(v<m.row){n=m.y;for(var b=m.row-1;b>=v;b--)n-=c._getZoomRowHeight(b)}else{n=g.y+g[se];for(var w=g.row+1;w<=v;w++)n+=c._getZoomRowHeight(w)}n+=e[ce]()*o}var C=W(e[ae]()*o),S=W(e[se]()*o);s.push({name:e.name(),x:t,y:n,width:C,height:S})}}),s}return e.prototype={_dispose:function(){var e=this._renders;e.each(function(e){e._dispose()}),e.empty()},_render:function(e,t,o){if(!(e<0||t<0)){var i=this,a=i._sheet,s=i._renders,l=a._floatingObjectModel,u=r(i,e,t,o),c=[];s.each(function(e){u.find(e.name)||c.push(e)});var f,d;for(f=0,d=c.length;f<d;f++){var p=c[f];p._renderManager=j,s.remove(p.name),p._dispose()}var h=a.parent&&a.parent.options.useTouchLayout;pt._resizeIndicatorSize=h?11:7,u.each(function(r){var o=l._get(r.name),u=W(pt._resizeIndicatorSize/2+1);if(o&&"function"==typeof o.borderWidth){var c=o.borderWidth(),f=o.borderStyle();o._isBorderStyleWork(f)||(c=0),c>u&&(u=c)}var d=n(i,e,t),p=1,h=r.x-u-p,m=r.y-u-p,g=r[ae]+2*u+2*p,_=r[se]+2*u+2*p,v=z(d.y,m),y=z(d.x,h),b=_,w=g,C=u,S=u,x=-1*u-p;C=m-v+C,S=h-y+S,C<=0?(b+=C,b+=x):C<u&&C>0&&(b-=u-C),S<=0?(w+=S,w+=x):S<u&&S>0&&(w-=u-S);var T=s.find(r.name);T||(T=new pt(l._get(r.name),a),T._renderManager=i,s.push(T)),T._layout=r,T._rowViewportIndex=e,T._columnViewportIndex=t;var M=new E(d.x,d.y,d[ae],d[se]);T._render(new E(y,v,w,b).getIntersectRect(M)||new E(y,v,0,0),new E(S,C,r[ae],r[se]))})}},_zIndex:function(e,t){var n=this._renders.find(e);return n?n._zIndex(t):isNaN(t)?-1:void 0},_reduceZIndex:function(){this._renders.each(function(e){var t=e._zIndex();-1!==t&&e._zIndex(t-1)})}},e}(),mt={FloatingObject:dt,FloatingObjectCollection:w,_FloatingObjectRender:pt,_propertyRefreshCallback:f,_fromJsonFn:c,_toJsonFn:u};V.extend(mt,T),e.exports=mt},function(e,t,n){function r(e,t){return new g.Point(e,t)}function o(e,t,n,r){return new g.Rect(e,t,n,r)}function i(e){return e.height}function a(e){return e.width}function s(e,t){var n=e.options;return!n.isProtected||n.protectionOptions.allowEditObjects||t&&!t.locked()}function l(e,t,n,r,o){var i,a=this,s=a.comments;if(e&&s)for(var l=s.all(),u=0;u<l.length;u++){i=l[u];var c=i._rowIndex,f=i._colIndex;c===t&&f===n||c>=t&&c<t+r&&f>=n&&f<n+o&&s.remove(c,f)}if(i=s.get(t,n)){var d=s._getCommentView(i);d&&d._updateAbsoluteLocationAndLayout()}}function u(){var e=this,t=e._commentRender();t&&t._renderCommentFloatPanel(e)}function c(e,t,n){var r=this,o=r._commentRender();o&&o._renderCommentCellAdorner(e,t,n)}function f(e,t){var n=-1,r=-1;if(t&&t.rowViewportIndex>=0&&t.colViewportIndex>=0&&(n=t.row,r=t.col),e.parent){if(n<0||r<0)return;var o=e.comments.get(n,r);e.comments&&e.comments._hoverShow(o)}}function d(e,t){return e&&e.getRowHeight(t)}function p(e,t){return e&&e.getColumnWidth(t)}function h(e,t){return e&&e.getViewportLeftColumn(t)}function m(e,t){return e&&e.getViewportTopRow(t)}var g=n(1),_=g.Commands,v=g.Worksheet,y=null,b=void 0,w=Math.max,C=Math.min,S=Math.floor,x=Math.atan2,T=Math.abs,E="default",M=g.GC$,A=M.extend,k=g._util._createElement,R=n(0),I=R._ArrayHelper,O="comment",D=g._FocusHelper,P=g._DPIHelper,N=g._util,F=g.Events,L=N._cancelDefault,H=N._getDistance,V=parseFloat,j=R._StringHelper,B=g._CanvasHelper,U=document,W="mouse",z="move",Y=W+"down",G=W+z,K=W+"up",X=W+"wheel",q="DOMMouseScroll",J="left",Z="top",Q="right",$="bottom",ee="width",te="height",ne="position",re="absolute",oe="overflow",ie="visible",ae="z-index",se="hidden",le="box-sizing",ue="content-box",ce="padding",fe="px",de="div",pe=".comment",he=".floatBlockCanvas",me=".hostContainer",ge=".lineCanvasContainer",_e=".host",ve=".editor",ye="gc-spread-",be="className",we="cursor",Ce="text",Se=701,xe=898,Te="gc-no-user-select",Ee=" ",Me="unselectable",Ae="on",ke="comment_editor",Re="comment_indicator",Ie="font-family",Oe="font-style",De="font-size",Pe="font-weight",Ne="color",Fe="background-"+Ne,Le=Ce+"-align",He=Ce+"-decoration",Ve="textArea",je=".lineCanvas",Be=".commentDocument",Ue="-resize",We="line-height";A(v.prototype,{_paintComment:function(e){var t=this,n=t._commentRender();if(!t._hoverCell)for(var r,o=t._getSheetLayout(),s=0;s<=2;s++)for(var l=0;l<=2;l++)if((r=o._viewportRect(s,l))&&0!==a(r)&&0!==i(r)&&(!e||r.intersectRect(e))){var u=t.comments;n&&u&&n._renderComment(u)}}}),g.CellRange.prototype.comment=function(e){var t=this,n=t.sheet,r=t.row,o=t.col;return 0===arguments.length?n.comments.get(r,o):(e instanceof Qe&&n.comments._addInternal(r,o,e),t)};var ze=function(e,t){var n=t.comments;e.bind(Y+pe,function(){n._clearActiveComment()}).bind(X+pe,function(e){Ye(t,e)}).bind(G+pe,function(e){Ye(t,e)})},Ye=function(e,t){var n=e._getCanvasOffset(),r=e.hitTest(t.pageX-n.left,t.pageY-n.top);r&&f(e,r)},Ge=function(e){e.unbind(Y+pe).unbind(X+pe).unbind(G+pe)},Ke={init:function(){var e=this;e.comments=new et(e),e._commentRender=function(){var t=e.parent;if(t)return t._commentRenderCache||(t._commentRenderCache=new tt(t._getContainerDiv())),t._commentRenderCache._sheet=e,e.parent._commentRenderCache}},dispose:function(){var e=this.comments;if(e){e.all().forEach(function(t){e._hide(t)})}Ge(M(this._getCanvas()))},setHost:function(e){if(e){var t=this,n=".comment";t.bind(F.TopRowChanged+n,function(){t.comments._updateCommentsLayoutWhenSheetScroll()}),t.bind(F.LeftColumnChanged+n,function(){t.comments._updateCommentsLayoutWhenSheetScroll()}),ze(e,t)}},onLayoutChanged:function(e){var t=this,n=t.comments,r=e.changeType,o=e.row,i=e.rowCount,a=e.col,s=e.colCount;"addRows"===r?n._onRowsAdded(o,i):"deletingRows"===r?n._onRowsRemoved(o,i):"addColumns"===r?n._onColumnsAdded(a,s):"deletingColumns"===r?n._onColumnsRemoved(a,s):3===e.sheetArea&&("clear"===r?4==(4&e.type)&&n.clear(new g.Range(o,a,i,s)):"addSpan"===r?l.call(t,!0,o,a,i,s):"removeSpan"===r&&l.call(t,!1,o,a))},paint:function(e){this.comments._isEmpty()||(u.call(this),this._paintComment(e.clipRect))},paintCell:function(e){e.isPrinting||3!==e.sheetArea||c.call(this,e.ctx,e.sheetArea,e.cell)},toJson:function(e){var t=this.comments;e.comments=t.toJSON()},fromJson:function(e,t){if(e){var n=t?e.commentManager:e.comments;n&&this.comments.fromJSON(n,t)}},lastNonNullRowAndCol:function(){var e=0,t=0,n=this.comments;if(n){var r=n._commentViewList;if(r&&r.length>0)for(var o=0,i=r.length;o<i;o++){var a=r[o];a&&a._comment&&(a._endRow>e&&(e=a._endRow),a._endColumn>t&&(t=a._endColumn))}}return{lastNonNullRow:e,lastNonNullCol:t}},clearSelection:function(){var e=this.comments;e&&e._clearActiveComment()},processKeyDown:function(e){var t=this,n=t.comments&&t.comments._getActiveComment();n&&t._eventHandler._allowEnterEditing(e.e)&&(n.commentState(2),e.r=!0)}};v._registerFeature("comments",Ke);var Xe={init:function(){_._initCommentDefaultCommands(this.commandManager())}};g.Workbook._registerFeature("comments",Xe),F.CommentChanged="CommentChanged";var qe={active:1,edit:2,normal:3},Je={alwaysShown:1,hoverShown:2},Ze=function(){function e(e,t,n,r){var o=this;arguments.length<=1?o[Z]=o[Q]=o[$]=o[J]=e||0:(o[Z]=e,o[Q]=t,o[$]=n,o[J]=r)}return e.prototype={constructor:e,clone:function(){var t=this;return new e(t[Z],t[Q],t[$],t[J])},toString:function(){var e=this,t="";return[Z,Q,$,J].forEach(function(n){t+=e[n]+fe+Ee}),t.trim()}},e}(),Qe=function(){function e(e){var t=this;t._rowIndex=-1,t._colIndex=-1,t.text(e||""),t.zIndex(xe)}function t(e,t,r){return o.push(e),g._util._defProperty(e,t,n(e),r)}function n(e){var t=e;return function(){var e=this,n=e._sheet;n&&(n._layoutSuspended<=0&&n._paintComment(),n._trigger(F.CommentChanged,{sheet:n,sheetName:n?n._name:"",comment:e,propertyName:t}))}}var o=[],i=[[Ce,""],["location",r(9,-18)],[ee,160,function(e){return e>0}],[te,100,function(e){return e>0}],["fontFamily","Arial"],["fontStyle","normal"],["fontSize","9pt",function(e){return/^\d+pt$/.test(e)&&parseInt(e)>0}],["fontWeight","normal"],["textDecoration",0],["foreColor","black"],["locked",!0],["lockText",!0],["horizontalAlign",0],["autoSize",!1],["dynamicSize",!0,function(e){return"boolean"==typeof e&&this.dynamicMove()}],["dynamicMove",!0,function(e){return e||this.dynamicSize(!1),!0}],["backColor","#FFFFE1"],["opacity",1,function(e){return e>=0&&e<=1}],["borderWidth",1,function(e){return e>=1}],["borderStyle","solid"],["borderColor","black"],["padding"],["showShadow",!1],["displayMode",2],["commentState",3],["zIndex",-1],["ignoreDefaultLocation",!1]],a={clone:function(){var t=this,n=new e;return o.forEach(function(e){var r=t[e]();t[e].isDefault(r)||n[e](r&&r.clone?r.clone():r)}),n._sheet=t._sheet,n._rowIndex=t._rowIndex,n._colIndex=t._colIndex,n},toJSON:function(){var e=this,t={rowIndex:e._rowIndex,colIndex:e._colIndex};return o.forEach(function(n){var r=e[n]();e[n].isDefault(r)||(t[n]=r&&r.clone?r.clone():r)}),t},fromJSON:function(e){if(e){var t=this;o.forEach(function(n){var r=e[n];r!==b&&("location"===n?t.location(new g.Point(r.x,r.y),!1):"padding"===n?t.padding(new Ze(r.top,r.right,r.bottom,r.left),!1):t[n](r,!1))}),e.rowIndex!==b&&(t._rowIndex=e.rowIndex),e.colIndex!==b&&(t._colIndex=e.colIndex)}}};return i.forEach(function(e){a[e[0]]=t(e[0],e[1],e[2])}),A(e.prototype,a),e}(),$e=function(){function e(e,t){var n=this,o=e&&e._sheet;n._rowViewportIndex=1,n._columnViewportIndex=1,n._comment=e,n._updateCommentViewportIndex(),n._zoomFactor=o._zoomFactor,n._commentManager=t,n._editor=t._editorDom,n._init();var i=n._getAdjustedCommentRect(n._getAbsoluteLocation(),e.width(),e.height());n._absoluteLocation=r(i.x,i.y),n._updateStartCoordinate(),n._updateEndCoordinate()}function t(e,t,n,r,i){var a=o(t,n,r,r);a.cursor=i,e.push(a)}function n(e,t,n,r){M(e._floatBlockCanvas).css(t,n),M(e._hostContainer).css(t,r)}return g._defineFeature(e),e.prototype={constructor:e,_init:function(){var t=this,n=t._comment._sheet;t._floatBlockCanvasClassName=ye+"floatBlockCanvas",t._hostContainerClassName=ye+"host-container",t._hostClassName=ye+"host",t._lineCanvasClassName=ye+"lineCanvas",t._floatBlockCanvasContainer=k(de),M(t._floatBlockCanvasContainer).addClass(ye+"floatBlockCanvas-container").css([ne,oe,le],[re,se,ue]),t._floatBlockCanvas=k("canvas"),P._adjustDevicePixel(t._floatBlockCanvas,null,n),M(t._floatBlockCanvas).addClass(t._floatBlockCanvasClassName).css([J,Z,ne],[0,0,re]),t._hostContainer=k(de),M(t._hostContainer).addClass(t._hostContainerClassName).css([ne,le,oe],[re,ue,se]),t._host=k(de),M(t._host).addClass(t._hostClassName+Ee+Te).css([J,Z,ee,te,ne,"word-wrap","word-break","white-space",oe,le,Me,We],[0,0,"100%","100%",re,"break-word","normal","pre-wrap",se,ue,Ae,"normal"]),M(t._hostContainer).append(t._host),M(t._floatBlockCanvasContainer).append(t._floatBlockCanvas).append(t._hostContainer),t._lineCanvasContainer=k(de),M(t._lineCanvasContainer).addClass(ye+"lineCanvas-container").css([ne,oe,"pointer-events"],[re,se,"none"]),t._lineCanvas=k("canvas"),P._adjustDevicePixel(t._lineCanvas,y,n),M(t._lineCanvas).addClass(t._lineCanvasClassName).css([J,Q,ne],[0,0,re]),M(t._lineCanvasContainer).append(t._lineCanvas),t._resizeHitRects=[],t._hostMargin=7,t._isMoving=!1,t._isResizing=!1,e._callFeatureHandler(t,"init",[t._floatBlockCanvas,t._host])},_open:function(){var e=this,t=e._comment._sheet;e._commentLayoutPanel||t&&(e._commentLayoutPanel=t._commentRender()._commentLayoutPanel),e._commentLayoutPanel&&(e._commentLayoutPanel.appendChild(e._lineCanvasContainer),e._attachLineCanvasEventHandler(),e._commentLayoutPanel.appendChild(e._floatBlockCanvasContainer),e._attachEventHandler(e._floatBlockCanvas,he),e._attachEventHandler(e._hostContainer,me),e._isEditing()?e._attachEditorEventHandler():e._attachHostEventHandler(),e._absoluteLocation=e._getAbsoluteLocation(),e._updateLayout())},_close:function(){var e=this;e._floatBlockCanvasContainer&&e._lineCanvasContainer&&e._commentLayoutPanel&&(e._detachEventHandler(e._floatBlockCanvas,he),e._detachEventHandler(e._hostContainer,me),e._detachHostEventHandler(),e._detachLineCanvasEventHandler(),e._detachEditorEventHandler(),M(e._floatBlockCanvasContainer).remove(),M(e._lineCanvasContainer).remove())},_getActualWidth:function(){return this._comment.width()*this._zoomFactor},_getActualHeight:function(){return this._comment.height()*this._zoomFactor},_getAbsoluteLocation:function(){var e=this,t=e._comment;return t!==e._commentManager._hoverShowComment||3!==t.commentState()||t.ignoreDefaultLocation()?e._convertToAbsoluteLocation(t.location()):t._hoverLocation=e._convertToAbsoluteLocation(r(9,-18))},_convertToAbsoluteLocation:function(e){var t=this,n=t._comment,o=n&&n._sheet,s=t._zoomFactor,l=r(0,0);if(o){var u=t._getCellRect(o,n._rowIndex,n._colIndex,t._rowViewportIndex,t._columnViewportIndex);if(u.x!==y&&void 0!==u.x&&u.y!==y&&void 0!==u.y&&a(u)&&i(u)){var c=o._getSheetLayout();l.x=u.x+a(u)+e.x*s-c._rowHeaderWidth,l.y=u.y+e.y*s-c._colHeaderHeight}}return l},_getCellRect:function(e,t,n,r,i){var a,s,l=this,u=o(0,0,0,0),c=e._getSheetLayout(),f=m(e,r),g=h(e,i),_=l._zoomFactor;a=H(e,g,n,!1),s=H(e,f,t,!0),u.y=t>=f?s:-s,u.x=n>=g?a:-a;var v=e.getSpan(t,n);v!==b&&v!==y?(u.height=H(e,t,t+v.rowCount,!0),u.width=H(e,n,n+v.colCount,!1)):(u[te]=d(e,t)*_,u[ee]=p(e,n)*_),u.x+=c._rowHeaderWidth,u.y+=c._colHeaderHeight;var w=c._frozenWidth,C=c._frozenHeight;return 1===r?u.y+=C:2===r&&(u.y+=C+c._viewportHeight),1===i?u.x+=w:2===i&&(u.x+=w+c._viewportWidth),u},_convertToRelativeLocation:function(e){var t=this,n=t._comment,o=n&&n._sheet,s=t._zoomFactor,l=r(0,0);if(o){var u=t._getCellRect(o,n._rowIndex,n._colIndex,t._rowViewportIndex,t._columnViewportIndex);if(u.x!==y&&u.x!==b&&u.y!==y&&u.y!==b&&a(u)&&i(u)){var c=o._getSheetLayout();l.x=(e.x-(u.x+a(u)-c._rowHeaderWidth))/s,l.y=(e.y-(u.y-c._colHeaderHeight))/s}}return l},_updateLayoutWhenLocationChanged:function(){var e=this;e._absoluteLocation=e._getAbsoluteLocation(),e._updateStartCoordinate(),e._updateEndCoordinate(),e._updateLayout()},_updateLayoutWhenWidthHeightChanged:function(){var e=this;e._absoluteLocation=e._getAbsoluteLocation(),e._updateEndCoordinate()},_updateLayoutWhenRowColumnChanged:function(){var e=this,t=e._comment;if(t.dynamicMove())t.dynamicSize()?e._updateSizeAndLocationByCoordinate():(e._updateLocationByCoordinate(),e._updateEndCoordinate());else{e._updateStartCoordinate(),e._updateEndCoordinate();var n=e._convertToRelativeLocation(e._absoluteLocation===t._hoverLocation?e._getAbsoluteLocation():e._absoluteLocation);t.location(n)}},_updateAbsoluteLocationAndLayout:function(){var e=this;e._absoluteLocation=e._getAbsoluteLocation(),e._updateLayout()},_updateLocationByCoordinate:function(){var e=this,t=e._comment,n=e._getLocationByCoordinate();e._absoluteLocation=n,t.location(e._convertToRelativeLocation(n),!1),e._updateLayout()},_getLocationByCoordinate:function(){for(var e=this,t=e._comment,n=t&&t._sheet,o=e._zoomFactor,i=h(n,e._columnViewportIndex),a=m(n,e._rowViewportIndex),s=0,l=0;l<e._columnViewportIndex;l++)s+=n.getViewportWidth(l);var u=H(n,i,e._startColumn,!1);i<e._startColumn?s+=u:s-=u;var c=p(n,e._startColumn);c<e._startColumnOffset&&(e._startColumnOffset=c),s+=e._startColumnOffset*o;for(var f=0,g=0;g<e._columnViewportIndex;g++)f+=n.getViewportHeight(g);var _=H(n,a,e._startRow,!0);a<e._startRow?f+=_:f-=_;var v=d(n,e._startRow);return v<e._startRowOffset&&(e._startRowOffset=v),f+=e._startRowOffset*o,r(s,f)},_updateSizeByCoordinate:function(){var e=this,t=e._comment,n=t&&t._sheet,r=H(n,e._startColumn,e._endColumn,!1),o=p(n,e._startColumn);o<e._startColumnOffset&&(e._startColumnOffset=o);var i=p(n,e._endColumn);i<e._endColumnOffset&&(e._endColumnOffset=i),r=r-e._startColumnOffset+e._endColumnOffset;var a=H(n,e._startRow,e._endRow,!0),s=d(n,e._startRow);s<e._startRowOffset&&(e._startRowOffset=s);var l=d(n,e._endRow);l<e._endRowOffset&&(e._endRowOffset=l),a=a-e._startRowOffset+e._endRowOffset,t.width(r),t.height(a)},_updateSizeAndLocationByCoordinate:function(){var e=this;e._updateSizeByCoordinate(),e._updateLocationByCoordinate()},_updateStartCoordinate:function(){var e=this,t=e._comment,n=t&&t._sheet,o=e._zoomFactor;if(e._absoluteLocation){var i,a=h(n,e._columnViewportIndex),s=m(n,e._rowViewportIndex);0===e._columnViewportIndex?i=e._absoluteLocation.x:1===e._columnViewportIndex?i=e._absoluteLocation.x-n.getViewportWidth(0):2===e._columnViewportIndex&&(i=e._absoluteLocation.x-(n.getViewportWidth(0)+n.getViewportWidth(1)));var l;0===e._rowViewportIndex?l=e._absoluteLocation.y:1===e._rowViewportIndex?l=e._absoluteLocation.y-n.getViewportHeight(0):2===e._rowViewportIndex&&(l=e._absoluteLocation.y-(n.getViewportHeight(0)+n.getViewportHeight(1)));for(var u=r(i,l),c=0,f=0,g=a;g<n.getColumnCount();g++){var _=p(n,g)*o;if(!(c+_<u.x)){e._startColumn=g,e._startColumnOffset=(u.x-c)/o;break}c+=_}for(var v=s;v<n.getRowCount();v++){var y=d(n,v)*o;if(!(f+y<u.y)){e._startRow=v,e._startRowOffset=(u.y-f)/o;break}f+=y}}},_updateEndCoordinate:function(){var e=this,t=e._comment,n=t&&t._sheet,o=e._zoomFactor;if(e._absoluteLocation){var i,a=h(n,e._columnViewportIndex),s=m(n,e._rowViewportIndex);0===e._columnViewportIndex?i=e._absoluteLocation.x+e._getActualWidth():1===e._columnViewportIndex?i=e._absoluteLocation.x+e._getActualWidth()-n.getViewportWidth(0):2===e._columnViewportIndex&&(i=e._absoluteLocation.x+e._getActualWidth()-(n.getViewportWidth(0)+n.getViewportWidth(1)));var l;0===e._rowViewportIndex?l=e._absoluteLocation.y+e._getActualHeight():1===e._rowViewportIndex?l=e._absoluteLocation.y+e._getActualHeight()-n.getViewportHeight(0):2===e._rowViewportIndex&&(l=e._absoluteLocation.y+e._getActualHeight()-(n.getViewportHeight(0)+n.getViewportHeight(1)));for(var u=r(i,l),c=0,f=0,g=a;g<n.getColumnCount();g++){var _=p(n,g)*o;if(!(c+_<u.x)){e._endColumn=g,e._endColumnOffset=(u.x-c)/o;break}c+=_}for(var v=s;v<n.getRowCount();v++){var y=d(n,v)*o;if(!(f+y<u.y)){e._endRow=v,e._endRowOffset=(u.y-f)/o;break}f+=y}}},_onRowsAdded:function(e,t){var n=this,r=n._comment;e<=n._startRow?r.dynamicMove()&&(n._startRow+=t,n._endRow+=t):e>n._startRow&&e<=n._endRow&&r.dynamicSize()&&(n._endRow+=t),n._updateSizeAndLocationByCoordinate()},_onColumnsAdded:function(e,t){var n=this,r=n._comment;e<=n._startColumn?r.dynamicMove()&&(n._startColumn+=t,n._endColumn+=t):e>n._startColumn&&e<=n._endColumn&&r.dynamicSize()&&(n._endColumn+=t),n._updateSizeAndLocationByCoordinate()},_onRowsRemoved:function(e,t){var n=this,r=n._comment,o=e+t-1;e<n._startRow?o<n._startRow?r.dynamicMove()&&(n._startRow-=t,n._endRow-=t):o<n._endRow&&r.dynamicMove()&&(r.dynamicSize()?n._endRow-=t:n._endRow-=n._startRow-e+1,n._startRow=e,n._startRowOffset=0):e<=n._endRow&&(o<n._endRow?r.dynamicSize()&&(n._endRow-=t):r.dynamicSize()&&(n._endRow=e,n._endRowOffset=0)),n._updateSizeAndLocationByCoordinate()},_onColumnsRemoved:function(e,t){var n=this,r=n._comment,o=e+t-1;e<n._startColumn?o<n._startColumn?r.dynamicMove()&&(n._startColumn-=t,n._endColumn-=t):o<n._endColumn&&r.dynamicMove()&&(r.dynamicSize()?n._endColumn-=t:n._endColumn-=n._startColumn-e+1,n._startColumn=e,n._startColumnOffset=0):e<=n._endColumn&&(o<n._endColumn?r.dynamicSize()&&(n._endColumn-=t):r.dynamicSize()&&(n._endColumn=e,n._endColumnOffset=0)),n._updateSizeAndLocationByCoordinate()},_updateLayout:function(){var e=this,t=e._comment,n=t._sheet;e._isOpened()&&(e._zoomFactor!==n._zoomFactor?(e._zoomFactor=n._zoomFactor,e._absoluteLocation=e._getLocationByCoordinate()):(e._zoomFactor=n._zoomFactor,e._absoluteLocation!==t._hoverLocation||1!==t.displayMode()&&2!==t.commentState()||(e._absoluteLocation=e._getAbsoluteLocation())),e._updateCommentViewportIndex(),e._updateIndicatorSize(),e._formatComment(),e._updateLineContainerLayout(),e._updateAdornerLayout(),N._browser.chrome&&e._offsetCommentLayoutInChrome())},_updateIndicatorSize:function(){var e=this,t=e._comment._sheet,n=t.parent&&t.parent.options.useTouchLayout;e._hostMargin=n?11:7},_updateCommentViewportIndex:function(){var e=this,t=e._comment,n=t._sheet;e._rowViewportIndex=n._getRowViewportIndex(t._rowIndex),e._columnViewportIndex=n._getColumnViewportIndex(t._colIndex)},_formatComment:function(){var e=this,t=e._comment,n=2===t.commentState()?e._editor:e._host;e._formatCommentState(),e._formatCommentStyle(n),e._formatCommentText(n),e._formatCommentRect(n),e._formatCommentProtection()},_formatCommentText:function(e){var t=this,n=t._comment;e===t._host&&(e.innerHTML=j._escapeHtml(n.text()))},_formatCommentRect:function(e){var t=this,r=t._comment,o=2===r.commentState()||1===r.displayMode()?t._getAbsoluteLocation():t._absoluteLocation,s=t._zoomFactor;if(o){var l;l=t._isResizing?t._getAdjustedCommentRect(o,r.width(),r.height()):t._getAdjustedCommentRect(o),t._adjustCommentRect(l);var u=a(l)*s,c=i(l)*s,f=l.x,d=l.y,p=f+u,h=d+c,m=t._hostMargin,g=t._getViewportRect(t._rowViewportIndex,t._columnViewportIndex);f<g.x?(n(t,J,f-g.x,f+m-g.x),u+=f-g.x,f=g.x):(n(t,J,0,m),p>g.x+a(g)&&(u+=g.x+a(g)-1-p)),u=C(a(g)-1,u),d<g.y?(n(t,Z,d-g.y,d+m-g.y),c+=d-g.y,d=g.y):(n(t,Z,0,m),h>g.y+i(g)&&(c+=g.y+i(g)-1-h)),c=C(i(g)-1,c),M(t._floatBlockCanvasContainer).css({left:f,top:d,width:u,height:c});var _=u,v=c;P._setSize(t._floatBlockCanvas,_,v);var y=w(0,_-2*(m+r.borderWidth())),b=w(0,v-2*(m+r.borderWidth()));M(t._hostContainer).css({width:y,height:b});var S=y,x=b,T=r.padding();T&&(S-=Math.ceil(V(T.left)+V(T.right)),x-=Math.ceil(V(T.top)+V(T.bottom))),M(e).css({width:w(0,S),height:w(0,x)})}},_adjustCommentRect:function(e){var t=this,n=t._comment,o=t._absoluteLocation;if(e.x!==o.x||e.y!==o.y||a(e)!==n.width()||i(e)!==n.height()){var s=t._convertToRelativeLocation(r(e.x,e.y)),l=a(e),u=i(e),c=n.location();s.x===c.x&&s.y===c.y||n.location(s,!1),l!==n.width()&&n.width(l,!1),u!==n.height()&&n.height(u,!1),n.dynamicMove()&&(t._absoluteLocation=r(e.x,e.y))}},_formatCommentProtection:function(){var e=this,t=e._comment;s(t&&t._sheet)?(e._attachEventHandler(e._floatBlockCanvas,he),e._attachEventHandler(e._hostContainer,me),e._attachLineCanvasEventHandler(),e._attachHostEventHandler(),e._attachEditorEventHandler()):(t.locked()?(e._detachEventHandler(e._floatBlockCanvas,he),e._attachMouseWheelEvent(e._floatBlockCanvas),e._detachEventHandler(e._hostContainer,me),e._attachMouseWheelEvent(e._hostContainer),e._floatBlockCanvas.style.cursor=E,e._hostContainer.style.cursor=E):(e._attachEventHandler(e._floatBlockCanvas,he),e._attachEventHandler(e._hostContainer,me)),t.lockText()?(e._detachHostEventHandler(),e._attachMouseWheelEvent(e._host),e._detachEditorEventHandler(),e._attachMouseWheelEvent(e._editor),(t.locked()||1!==t.commentState())&&t.commentState(3),e._host.style.cursor=t.locked()?E:z):(e._attachHostEventHandler(),e._attachEditorEventHandler()),e._attachLineCanvasEventHandler())},_formatCommentState:function(){var e=this,t=e._comment,n=e._commentManager,r=t&&t._sheet;switch(t.commentState()){case 1:n._setActiveComment(t),e._isEditing()&&e._detachEditor(),r.getSelections().length>0&&r._saveAndClearSheetSelections(),D._setActiveElement(r);break;case 2:n._setActiveComment(t),e._isEditing()||e._attachEditor(),r.getSelections().length>0&&r._saveAndClearSheetSelections(),D._setActiveElement(y);break;case 3:t===n._getActiveComment()&&(n._clearActiveComment(),0===r.getSelections().length&&r._loadAndSetSheetSelections())}},_formatCommentStyle:function(e){function t(e,t,n){if(!n)return e;var r=R._ColorHelper,o=r._fromString(e);return o.a=t,r._toString(o)}var n=this,r=n._comment,o=M(e);o.css("font-family",r.fontFamily()).css("font-style",r.fontStyle()).css("font-size",parseInt(r.fontSize())*n._zoomFactor+"pt").css("font-weight",r.fontWeight()),o.css("text-decoration",g._StyleHelper._composeTextDecoration(r.textDecoration()));var i={0:"left",1:"center",2:"right",3:"general"};o.css("text-align",i[r.horizontalAlign()]),r.padding()?o.css(ce,r.padding().toString()):o.css(ce,"0px"),o.css("background-color",t(r.backColor(),r.opacity(),e===n._host)).css("color",r.foreColor()),M(n._hostContainer).css("border-width",r.borderWidth()).css("border-style",r.borderStyle()).css("border-color",r.borderColor());var a=n._commentManager._getCommentActualZIndex(r);M(n._lineCanvasContainer).css(ae,a),M(n._floatBlockCanvasContainer).css(ae,a)},_offsetCommentLayoutInChrome:function(){var e=this,t=this._comment._sheet,n=M(e._hostContainer);if(t&&n){var r=t._getCanvasOffset(),o=r.left-Math.floor(r.left)>=.5?.5:0,i=r.top-Math.floor(r.top)>=.5?.5:0;n.css(J,V(n.css(J))+o),n.css(Z,V(n.css(Z))+i)}},_updateLineContainerLayout:function(){var e=this,t=e._comment,n=t._sheet,o=e._getCellRect(n,t._rowIndex,t._colIndex,e._rowViewportIndex,e._columnViewportIndex),s=n._getSheetLayout(),l=o.x+a(o)-s._rowHeaderWidth,u=o.y-s._colHeaderHeight,c=r(l,u),f=y,d=M(e._floatBlockCanvasContainer).position(),p=M(e._hostContainer).position(),h=M(e._hostContainer);f=d.left+p.left>c.x?r(d.left+p.left,d.top+p.top):d.top+p.top+h.height()<c.y?r(d.left+p.left+h.width(),d.top+p.top+h.height()):r(d.left+p.left+h.width(),d.top+p.top);var m=e._hostMargin,g=T(c.x-f.x)+2*m,_=T(c.y-f.y)+2*m,v=C(c.x,f.x)-m,b=C(c.y,f.y)-m,w=v+g,S=b+_,x=e._getViewportRect(e._rowViewportIndex,e._columnViewportIndex);v<x.x&&(g-=x.x-v,v=x.x),w>x.x+a(x)&&(g-=w-(x.x+a(x))),g=C(a(x),g),b<x.y&&(_-=x.y-b,b=x.y),S>x.y+i(x)&&(_-=S-(x.y+i(x))),_=C(i(x),_),M(e._lineCanvasContainer).css(J,v).css(Z,b).css(ee,g).css(te,_),P._setSize(e._lineCanvas,g,_),c.x=c.x-v,c.y=c.y-b,f.x=f.x-v,f.y=f.y-b,e._drawLine(c,f)},_drawLine:function(e,t){var n=this;n._lineCtx||(n._lineCtx=n._lineCanvas.getContext("2d"));var r=n._lineCtx,o=n._comment.borderColor();r.strokeStyle=o,r.clearRect(0,0,P._getLogicWidth(n._lineCanvas),P._getLogicHeight(n._lineCanvas)),r.beginPath(),r.moveTo(e.x,e.y),r.lineTo(t.x,t.y),r.stroke(),r.save(),B._translate(r,e.x,e.y),r.fillStyle=o,r.beginPath();var i=x(t.y-e.y,t.x-e.x);r.rotate(i),r.moveTo(0,0),r.lineTo(7,-4),r.lineTo(7,4),r.lineTo(0,0),r.fill(),B._translate(r,-e.x,-e.y),r.closePath(),r.restore()},_updateAdornerLayout:function(){var e=this,t=e._comment,n=t._sheet;e._adornerDrawState=e._comment.commentState(),e._adornerCtx||(e._adornerCtx=e._floatBlockCanvas.getContext("2d"));var r=e._adornerCtx,o=P._getLogicWidth(e._floatBlockCanvas),i=P._getLogicHeight(e._floatBlockCanvas),a=M(e._hostContainer).outerWidth(),l=M(e._hostContainer).outerHeight(),u=e._hostMargin;if(r.clearRect(0,0,o,i),e._comment.showShadow()){e._drawStateAdorner(r,o,i);var c=2*(u+2);r.clearRect(u,u,o-c,i-c),e._drawShadowAdorner(r,u,a,l)}s(n,t)&&e._drawResizeIndicators(r,u,o,i,a,l),r.restore()},_drawShadowAdorner:function(e,t,n,r){e.fillRect(t+2,r+t,n,2),e.fillRect(n+t,t+2,2,r)},_drawStateAdorner:function(e,t,n){var r,o;switch(this._adornerDrawState){case 1:for(e.beginPath(),o=0;o<n;o++)for(r=o%2==0?1:3;r<t;)e.moveTo(r,o),e.lineTo(r+1,o+1),r+=4;e.stroke(),e.closePath();break;case 2:e.beginPath(),r=0,o=0;for(var i=4;r<t+n;)e.moveTo(r+i,0),e.lineTo(0,o+i),r+=i,o+=i;e.stroke(),e.closePath()}},_drawResizeIndicators:function(e,n,r,o,s,l){var u=this,c=u._resizeHitRects;1!==u._adornerDrawState&&2!==u._adornerDrawState||(c.splice(0,c.length),t(c,0,0,n,"nw"+Ue),t(c,r-n,0,n,"ne"+Ue),t(c,0,o-n,n,"sw"+Ue),t(c,r-n,o-n,n,"se"+Ue),l>=3*n?(t(c,0,S(o/2-n/2),n,"w"+Ue),t(c,r-n,S(o/2-n/2),n,"e"+Ue)):(c.push(y),c.push(y)),s>=3*n?(t(c,S(r/2-n/2),0,n,"n"+Ue),t(c,S(r/2-n/2),o-n,n,"s"+Ue)):(c.push(y),c.push(y)),e.restore(),e.fillStyle="white",e.strokeStyle="#939393",e.linewidth=1,B._translate(e,.5,.5),M.each(c,function(){if(u){var t=this,n=t.x,r=t.y,o=a(t),s=i(t);e.beginPath(),e.fillRect(n,r,o-1,s-1),e.strokeRect(n,r,o-1,s-1),e.stroke(),e.closePath()}}),B._translate(e,-.5,-.5))},_drawMoveResizeContainer:function(){var e=this,t=e._getViewportRect(e._rowViewportIndex,e._columnViewportIndex);e._moveResizeContainerDom?M(e._moveResizeContainerDom).remove():e._moveResizeContainerDom=k(de);var n=M(e._moveResizeContainerDom),r=M(e._hostContainer);n.addClass("gc-spread-moveResizeContainer").css([ne,J,Z,ee,te,"border"],[re,e._absoluteLocation.x+e._hostMargin-t.x,e._absoluteLocation.y+e._hostMargin-t.y,r.outerWidth()-2,r.outerHeight()-2,"gray solid thin"]),e._moveResizePanelDom?M(e._moveResizePanelDom).remove():e._moveResizePanelDom=k(de);var o=M(e._moveResizePanelDom);o.bind("mousemove",function(t){e._doMouseMove(t)}).bind(K,function(t){e._doMouseUp(t)}).css([ne,oe,Z,J,ee,te,"background",ae],[re,se,t.y,t.x,a(t),i(t),"rgba(255,255,255,0.01)",901]),o.append(e._moveResizeContainerDom),e._commentLayoutPanel&&e._commentLayoutPanel.appendChild(e._moveResizePanelDom)},_doMoveResizeContainer:function(e){var t=this,n=t._hostMargin,o=t._zoomFactor,s=t._commentManager,l=s._mouseCapture;if(l._capture){var u=t._getViewportScrollOffset(),c=e.pageX/o-l.x+u.x,f=e.pageY/o-l.y+u.y;if(0===c&&0===f)return;var d,p=t._getViewportRect(t._rowViewportIndex,t._columnViewportIndex),h=M(t._moveResizeContainerDom);if(l._resizeDirct<0){var m=l._cachedRect.x+c,g=l._cachedRect.y+f;d=t._convertToAbsoluteLocation(r(m,g)),h.css([J,Z],[d.x+n-p.x,d.y+n-p.y])}else{var _=t._getResizeRect(c,f,l._resizeDirct);d=t._convertToAbsoluteLocation(r(_.x,_.y)),h.css([J,Z,ee,te],[d.x+n-p.x,d.y+n-p.y,a(_)*o-2*n-2,i(_)*o-2*n-2])}}},_attachEditor:function(){var e=this,t=e._comment;if(!e._isEditing()){var n=e._commentManager._editorDom;M(e._host).remove(),e._detachHostEventHandler(),M(n).remove(),M(e._hostContainer).append(n),e._setDomStyle(n),e._formatCommentRect(n),M(n).focus(),n.selectionStart=n.value.length,e._attachEditorEventHandler(),2!==t.commentState()&&t.commentState(2)}},_detachEditor:function(){var t=this,n=t._comment,r=n._sheet;if(t._isEditing()){var o=t._commentManager._editorDom;M(o).remove(),t._detachEditorEventHandler(),M(t._hostContainer).append(t._host),t._setDomStyle(t._host),t._attachHostEventHandler(),e._callFeatureHandler(t,"detachEditor",t._host),2===n.commentState()&&n.commentState(3),M(o).val()!==n.text()&&r._commandManager().execute({cmd:"changeComment",sheetName:r.name(),comment:n,oldValue:n.text(),newValue:M(o).val(),propertyName:Ce})}},_getViewportHeight:function(e){var t=this,n=t._comment._sheet,r=-1;return 0===e||2===e?r=n.getViewportHeight(e):1===e&&(r=H(n,n.getViewportBottomRow(0)+1,m(n,2)+1,!0)),r},_getViewportWidth:function(e){var t=this,n=t._comment._sheet,r=-1;return 0===e||2===e?r=n.getViewportWidth(e):1===e&&(r=H(n,n.getViewportRightColumn(0)+1,h(n,2)+1,!1)),r},_getViewportRect:function(e,t){var n=this,r=n._comment._sheet,i=r._getSheetLayout(),a=i._viewportRect(e,t);return 0===e&&0===t||0===e&&2===t||2===e&&0===t||2===e&&2===t?a=o(0,0,i._frozenWidth+i._viewportWidth+i._frozenTrailingWidth,i._frozenHeight+i._viewportHeight+i._frozenTrailingHeight):0===e&&1===t||2===e&&1===t?a=o(i._frozenWidth,0,i._viewportWidth,i._frozenHeight+i._viewportHeight+i._frozenTrailingHeight):1===e&&0===t||1===e&&2===t?a=o(0,i._frozenHeight,i._frozenWidth+i._viewportWidth+i._frozenTrailingWidth,i._viewportHeight):1===e&&1===t&&(a=o(i._frozenWidth,i._frozenHeight,i._viewportWidth,i._viewportHeight)),a},_setDomStyle:function(e){var t=this,n=t._comment,r=M(e);e!==t._editor&&e!==t._host||(e===t._editor?e.value=n.text():e.innerHTML=j._escapeHtml(n.text()),r.css([Ie,Oe,De,Pe,Ne,Fe,Le,He],[n.fontFamily(),n.fontStyle(),n.fontSize(),n.fontWeight(),n.foreColor(),n.backColor(),n.horizontalAlign(),n.textDecoration()]),n.padding()?r.css(ce,n.padding().toString()):r.css(ce,"0px"))},_isOpened:function(){return this._floatBlockCanvasContainer&&this._floatBlockCanvasContainer.parentNode},_isEditing:function(){var e=this;return e._isOpened()&&e._comment===e._commentManager._getActiveComment()&&M(e._hostContainer).find(Ve).length>0},_getCommentRect:function(){var e=this,t=e._comment._sheet,n=y;if(e._isOpened()){var r=t._getSheetLayout();n=o(e._absoluteLocation.x+r._headerX+r._rowHeaderWidth,e._absoluteLocation.y+r._headerY+r._colHeaderHeight,e._getActualWidth(),e._getActualHeight())}return n},_getCommentEditorRect:function(){var e=this,t=e._comment,n=e._zoomFactor;if(e._isOpened()){var r=e._getCommentRect();if(r){var s,l,u,c,f=(e._hostMargin+t.borderWidth())*n,d=f;return s=r.x+f,l=r.y+d,u=a(r)-2*f,c=i(r)-2*d,o(s,l,u,c)}}return y},_setCursorState:function(e){var t=this,n=t._comment,r=n._sheet,o=e.target,i=t._commentManager._mouseCapture,a=o.style,l=E;if(i._capture)o[be]!==t._hostClassName&&o[be]!==t._floatBlockCanvasClassName&&o[be]!==t._lineCanvasClassName&&o[be]!==ye+"floatPanel"||(l=i._resizeDirct>=0?"crosshair":z);else if(o[be]===t._hostClassName)!s(r)&&n.lockText()?n.locked()||(l=z):l=Ce;else if((o[be]===t._floatBlockCanvasClassName||o[be]===t._hostContainerClassName)&&s(r,n)){var u=t._getResizeDirection(e);l=u>=0&&u<t._resizeHitRects.length?t._resizeHitRects[u].cursor:z}a[we]=l},_doMouseDownToEdit:function(t){var n=this,r=n._comment,o=r&&r._sheet;if(o.endEdit()){o._unSelectAllFloatingObjects&&o._unSelectAllFloatingObjects();var i={e:t,r:y};if(e._callFeatureHandler(n,"preProcessMouseDownEdit",i),!i.r)return n._commentManager._setActiveComment(r),r.commentState(2),n._doMouseUp(t),L(t)}},_doMouseDownToDragOrResize:function(t){var n=this,i=n._comment,a=i&&i._sheet,l=n._zoomFactor,u=n._commentManager,c=u._mouseCapture;if(a.endEdit()){a._unSelectAllFloatingObjects&&a._unSelectAllFloatingObjects();var f={e:t,r:y};if(e._callFeatureHandler(n,"preProcessMouseDownDragResize",f),!f.r){c.x=t.pageX/l,c.y=t.pageY/l,c._cachedRect=o(i.location().x,i.location().y,i.width(),i.height()),c._resizeDirct=n._getResizeDirection(t),n._handleDocumentMouseMove(),c._capture=!0,n._setCursorState(t),u._setActiveComment(i),i.commentState(1),s(a,i)&&(n._moveInfo={},n._moveInfo._startTopRow=m(a,n._rowViewportIndex),n._moveInfo._startLeftColumn=h(a,n._columnViewportIndex),n._drawMoveResizeContainer(),c._resizeDirct<0?n._isMoving=!0:n._isResizing=!0);var d=a._eventHandler,p=a._getCanvasOffset(),g=r(t.pageX-p.left,t.pageY-p.top),_=a.hitTest(g.x,g.y);d._startHitInfo={_scrollRowViewportIndex:_.rowViewportIndex,_scrollColViewportIndex:_.colViewportIndex,_hitTestType:_.hitTestType},d._mousePosition=g,d._startScroll(),d._isCommentWorking=!0,t.stopPropagation()}}},_getAdjustedCommentRect:function(e,t,n){var r,s,l=this,u=l._comment,c=u&&u._sheet,f=l._hostMargin,d=l._zoomFactor,g=l._columnViewportIndex,_=l._rowViewportIndex,v=l._getViewportRect(_,g);1===arguments.length?(r=l._getActualWidth(),s=l._getActualHeight()):3===arguments.length&&(r=t*d,s=n*d);var y,b,w,C,S=e.x,x=e.y,E=c._getSheetLayout(),M=l._getCellRect(c,0,0,_,g),A=e.x+(0-(M.x-E._rowHeaderWidth))+r-f,k=e.y+(0-(M.y-E._colHeaderHeight))+s-f;if(0===g)y=0-f,w=a(E)-E._rowHeaderWidth;else if(1===g){var R=H(c,c.getViewportRightColumn(0)+1,h(c,1),!1);y=v.x-f-R;var I=l._getViewportWidth(2);w=I}else 2===g&&(y=0-f,w=0);if(S<y&&(l._isResizing?r-=y-S:A+=y-S,S=y),1!==g&&2!==g||(w+=H(c,0,c.getColumnCount(),!1,A)),A>w)if(l._isResizing)r-=A-w;else if(l._isMoving)S-=A-w;else{var O=l._commentManager._hoverShowComment&&!u.ignoreDefaultLocation()?9:u.location().x,D=2*T(O)+p(c,u._colIndex)+u.width(),P=S-D;if(P>y)S=P;else if(S<w)r-=A-w;else{P=S-D;var N=A-D;N>y?P<y?(r-=y-P,S=y):S=P:(P=S-(A-w),P<y?(r-=y-P,S=y):S=P)}}if(0===_)b=0-f,C=i(E)-E._colHeaderHeight;else if(1===_){var F=H(c,c.getViewportBottomRow(0)+1,m(c,1),!0);b=v.y-f-F;var L=l._getViewportHeight(2);C=L}else 2===_&&(b=0-f,C=0);if(x<b&&(l._isResizing?s-=b-x:k+=b-x,x=b),1!==_&&2!==_||(C+=H(c,0,c.getRowCount(),!0,k)),k>C)if(l._isResizing)s-=k-C;else if(l._isMoving)x-=k-C;else if(k>C){var V=k-C,j=x-V;j<b?(s-=b-j,x=b):x=j}return o(S,x,r/d,s/d)},_getViewportScrollOffset:function(){var e,t,n=this,o=n._comment._sheet,i=n._moveInfo,a=i._startTopRow,s=i._startLeftColumn,l=m(o,n._rowViewportIndex),u=h(o,n._columnViewportIndex),c=H(o,a,l,!0),f=H(o,s,u,!1);return e=s<u?f:-f,t=a<l?c:-c,r(e,t)},_doMoveResizeComment:function(e){var t=this,n=t._comment,o=n&&n._sheet,s=t._zoomFactor,l=t._commentManager,u=l._mouseCapture,c=_.ChangeComment;if(u._capture){var f=t._getViewportScrollOffset(),d=e.pageX/s-u.x+f.x,p=e.pageY/s-u.y+f.y;if(0===d&&0===p)return;var h,m,g;if(u._resizeDirct<0){var v=u._cachedRect.x+d,y=u._cachedRect.y+p;h=t._convertToAbsoluteLocation(r(v,y)),m=t._getAdjustedCommentRect(h),g=t._convertToRelativeLocation(r(m.x,m.y)),g.x===n.location().x&&g.x===n.location().y||o._commandManager().execute({cmd:"changeComment",sheetName:o.name(),comment:n,oldValue:n.location().clone(),newValue:g,propertyName:"location"})}else{n.autoSize(!1);var b=t._getResizeRect(d,p,u._resizeDirct);h=t._convertToAbsoluteLocation(r(b.x,b.y)),m=t._getAdjustedCommentRect(h,a(b),i(b)),g=t._convertToRelativeLocation(r(m.x,m.y));var w=[];g.x===n.location().x&&g.y===n.location().y||w.push(new c(o,{cmd:"changeComment",sheetName:o.name(),comment:n,oldValue:n.location().clone(),newValue:g,propertyName:"location"})),a(m)!==n.width()&&w.push(new c(o,{cmd:"changeComment",sheetName:o.name(),comment:n,oldValue:n.width(),newValue:m.width,propertyName:ee})),i(m)!==n.height()&&w.push(new c(o,{cmd:"changeComment",sheetName:o.name(),comment:n,oldValue:n.height(),newValue:m.height,propertyName:te})),w.length>0&&o._commandManager().execute({cmd:"changeCommentTransaction",sheetName:o.name(),commands:w})}}},_doMouseMove:function(t){var n=this,o=n._comment._sheet;if(this._setCursorState(t),!(o.getSelections()&&o.getSelections().length>0)){var i={e:t,r:y};if(e._callFeatureHandler(n,"preProcessMouseMove",i),!i.r){var a=n._commentManager,s=t.target,l=o._eventHandler,u=o._getCanvasOffset(),c=r(t.pageX-u.left,t.pageY-u.top);return s&&a._mouseCapture._capture&&(n._moveResizeContainerDom&&n._doMoveResizeContainer(t),1===n._rowViewportIndex&&(l._mousePosition.y=c.y),1===n._columnViewportIndex&&(l._mousePosition.x=c.x),l._continueScroll()),L(t)}}},_doMouseUp:function(t){var n=this,r=n._comment._sheet;if(!(r.getSelections()&&r.getSelections().length>0)){var o={e:t,r:y};if(e._callFeatureHandler(n,"preProcessMouseUp",o),!o.r){var i=t.target,a=n._commentManager,s=r._eventHandler;return s._isCommentWorking=!1,s._stopScroll(),i&&(n._doMoveResizeComment(t),n._moveResizePanelDom&&(M(n._moveResizePanelDom).remove(),n._moveResizePanelDom=null,n._isMoving=!1,n._isResizing=!1),n._unhandleDocumentMouseMove(),a._mouseCapture._capture=!1,n._setCursorState(t)),L(t)}}},_getResizeDirection:function(e){var t=this,n=t._resizeHitRects;if(n.length>0&&(1===t._adornerDrawState||2===t._adornerDrawState))for(var r=e.target,o=e.pageX-M(r).offset().left,i=e.pageY-M(r).offset().top,a=0;a<n.length;a++){var s=n[a];if(s&&s.contains(o,i))return a}return-1},_getResizeRect:function(e,t,n){var r=this,i=-1,a=-1;switch(n){case 0:i=0,a=0;break;case 1:i=2,a=0;break;case 2:i=0,a=2;break;case 3:i=2,a=2;break;case 4:i=0,a=1;break;case 5:i=2,a=1;break;case 6:i=1,a=0;break;case 7:i=1,a=2}var s=r._getHorizontalInfo(e,i),l=r._getVerticalInfo(t,a);return o(s.x,l.y,s.w,l.h)},_getHorizontalInfo:function(e,t){var n=this,r=2*n._hostMargin,o=n._commentManager._mouseCapture,i=a(o._cachedRect)-r;0===t?i-=e:2===t&&(i+=e);var s=o._cachedRect.x;i>=0?0===t&&(s+=e):0===t?s+=a(o._cachedRect)-r:2===t&&(s+=i);var l=a(o._cachedRect);return 1!==t&&(l=T(i)+r),{x:s,w:l}},_getVerticalInfo:function(e,t){var n=this,r=2*n._hostMargin,o=n._commentManager._mouseCapture,a=i(o._cachedRect)-r;0===t?a-=e:2===t&&(a+=e);var s=o._cachedRect.y;a>=0?0===t&&(s+=e):0===t?s=i(o._cachedRect)-r:2===t&&(s+=a);var l=i(o._cachedRect);return 1!==t&&(l=T(a)+r),{y:s,h:l}},_attachMouseWheelEvent:function(e){var t=this,n=t._comment._sheet;if(e){var r=b;switch(e){case t._floatBlockCanvas:r=he;break;case t._hostContainer:r=me;break;case t._lineCanvasContainer:r=ge;break;case t._host:r=_e;break;case t._editor:r=ve}if(r){M(e).unbind(X+r).unbind(q+r);var o=function(e){n._mouseWheelDelegate(e),L(e)};M(e).bind(X+r,o).bind(q+r,o)}}},_attachEventHandler:function(e,t){var n=this,r=n._comment,o=r&&r&&r._sheet;n._detachEventHandler(e,t);var i=function(e){o&&o._mouseWheelDelegate(e)};M(e).bind(Y+t,function(e){n._doMouseDownToDragOrResize(e)}).bind(G+t,function(e){n._doMouseMove(e)}).bind(K+t,function(e){n._doMouseUp(e)}).bind(X+t,i).bind(q+t,i)},_detachEventHandler:function(e,t){M(e).unbind(t)},_attachLineCanvasEventHandler:function(){var e=this,t=e._comment,n=t&&t._sheet,r=e._commentManager;if(e._detachLineCanvasEventHandler(),n){var o=n._getCanvasOffset(),i=function(e){n._mouseWheelDelegate(e)};M(e._lineCanvas).bind(Y+je,function(t){var i=n.comments.hitTest(t.pageX-o.left,t.pageY-o.top);if(i){var a=i.comment,s=r._getCommentView(a);i.area===ke?s._doMouseDownToEdit(t):i.area===Re&&s._doMouseDownToDragOrResize(t),M(s._floatBlockCanvasContainer).css(ae,parseInt(M(e._lineCanvasContainer).css(ae)+1))}else n._mouseDownDelegate(t)}).bind(G+je,function(t){var i=n.comments.hitTest(t.pageX-o.left,t.pageY-o.top),a=e._lineCanvas.style;if(i){var s=i.comment;r._getCommentView(s)._doMouseMove(t),i.area===ke?a.cursor=Ce:i.area===Re&&(a.cursor=z)}else{n._mouseMoveDelegate(t),e._commentManager._hoverShow(y);var l=n._getCanvas();l&&(a.cursor=l.style.cursor)}}).bind(K+je,function(e){var t=n.comments.hitTest(e.pageX-o.left,e.pageY-o.top);if(t){var i=t.comment;r._getCommentView(i)._doMouseUp(e)}else n._mouseUpDelegate(e)}).bind("dblclick"+je,function(e){n._dblClickDelegate(e)}).bind(X+je,i).bind(q+je,i)}},_detachLineCanvasEventHandler:function(){M(this._lineCanvas).unbind(je)},_attachHostEventHandler:function(){var e=this,t=e._comment,n=t&&t._sheet;if(2!==t.commentState()&&e._host){e._detachHostEventHandler();var r=function(e){n&&n._mouseWheelDelegate(e)};M(e._host).bind(Y+_e,function(t){e._doMouseDownToEdit(t)}).bind(G+_e,function(t){e._doMouseMove(t)}).bind(K+_e,function(t){e._doMouseUp(t)}).bind(X+_e,r).bind(q+_e,r)}},_detachHostEventHandler:function(){var e=this;2!==e._comment.commentState()&&e._host&&M(e._host).unbind(_e)},_attachEditorEventHandler:function(){var e=this,t=e._comment,n=t&&t._sheet,r=e._editor;if(2===t.commentState()&&r){this._detachEditorEventHandler();var o=function(e){n&&n._mouseWheelDelegate(e)};M(r).bind(Y+ve,function(e){e.stopPropagation()}).bind(G+ve,function(e){e.stopPropagation()}).bind(K+ve,function(e){e.stopPropagation()}).bind(X+ve,o).bind(q+ve,o).bind("input"+ve,function(){t.autoSize()&&e._doAutosize()}).bind("keydown"+ve,function(e){27!==e.keyCode&&9!==e.keyCode||(t.commentState(1),L(e),D._setActiveElement(n))})}},_doAutosize:function(){var e,t,n=this,r=n._comment,o=r&&r._sheet;2===r.commentState()?(e=n._editor,t=e.value.split("\n")):(e=n._host,t=j._unescapeHtml(e.innerHTML).split("\n"));var i,a,s=M(e).height(),l=M(e).width(),u=0,c=e.style,f="";c.font?(u=o._getFontHeight(c.font),f+=c.font):(r.fontStyle()&&(f+=Ee+r.fontStyle()),r.fontWeight()&&(f+=Ee+r.fontWeight()),r.fontSize()&&(f+=Ee+r.fontSize()),r.fontFamily()&&(f+=Ee+r.fontFamily()),u=o._getFontHeight(f));var d=u,p=5;if(t&&t.length>0){i=w(t.length*u,d);for(var h=0,m=0;m<t.length;m++){var g=o._getStringWidth(t[m],f);h<g&&(h=g)}a=w(h,p)}else i=d,a=p;M(e).css(te,i).css(ee,a),2===r.commentState()&&r.text(e.value),n._isAutosizing=!0;var _=i-s;0!==_&&r.height(r.height()+_);var v=a-l;0!==v&&r.width(r.width()+v),n._isAutosizing=!1},_detachEditorEventHandler:function(){var e=this,t=e._comment,n=e._editor;2===t.commentState()&&n&&M(n).unbind(ve)},_handleDocumentMouseMove:function(){var e=this,t=e._commentManager._mouseCapture;t._capture||(M(U).bind(G+Be,function(t){e._doMouseMove(t)}).bind(K+Be,function(t){e._doMouseUp(t)}),t._capture=!0)},_unhandleDocumentMouseMove:function(){var e=this._commentManager._mouseCapture;e._capture&&(e._capture=!1,M(U).unbind(Be))}},e}(),et=function(){function e(e){var t=this;t._sheet=e,t._mouseCapture={_capture:!1,x:0,y:0,_cachedRect:y,_resizeDirct:-1},t._editorDom=y,t._hoverShowComment=y,t._activeComment=y,t._commentList=[],t._commentViewList=[],t._createEditDom(),t._bindEventsOnSheet()}return e.prototype={constructor:e,add:function(e,t,n){var r=this,o=r._sheet,i=o.getSpan(e,t);if(i&&(i.row!==e||i.col!==t))return y;var a=r.get(e,t),s="string"==typeof n?new Qe(n):n;return r._addInternal(e,t,s),o._raiseCellChanged("comment",e,t,3,a,s),s},_addInternal:function(e,t,n,r){var o=this,i=o._sheet,a=o._commentList;if(o._removeInternal(e,t),n){n._rowIndex=e,n._colIndex=t,n._sheet=i,r||a.forEach(function(e){e.zIndex(e.zIndex()-1)}),a.push(n);i._getModel().setValueForKey(e,t,O,n),i._invalidate()}},get:function(e,t){return this._sheet._getModel().getValueForKey(e,t,O)||y},remove:function(e,t){var n=this,r=n._removeInternal(e,t),o=n._sheet;r&&(o._raiseCellChanged(O,e,t,3,r,b),o._invalidate())},_removeInternal:function(e,t){var n=this,r=n._sheet,o=n.get(e,t);if(o){n._hide(o),I._remove(n._commentList,o),I._remove(n._commentViewList,n._getCommentView(o));r._getModel().setValueForKey(e,t,O,b)}return o},clear:function(e){var t=this,n=t._sheet,r=t._commentList;n.suspendPaint();for(var o=r.length-1;o>=0;o--){var i=r[o],a=i._rowIndex,s=i._colIndex;(!e||a>=e.row&&a<e.row+e.rowCount&&s>=e.col&&s<e.col+e.colCount)&&t.remove(a,s)}n.resumePaint()},all:function(){return this._commentList.concat()},getOuterContainer:function(e){var t=this._getCommentView(e);return t?t._floatBlockCanvasContainer:y},_createEditDom:function(){var e=k(Ve);M(e).addClass("gc-comment-editor").css(J,0).css(Z,0).css(ne,re).css("margin",0).css(ce,0).css("word-wrap","break-word").css("word-break","normal").css(oe,se).css("resize","none").css("outline","none").css("border","0px").css(le,ue).css(We,"normal").attr("autocomplete","off").attr("gcUIElement","gcEditingInput"),this._editorDom=e},_bindEventsOnSheet:function(){var e=this,t=e._sheet;t&&(t._bind(F.ColumnChanged,function(t,n){var r=n.propertyName;r!==ee&&"isVisible"!==r||e._updateCommentsLayoutWhenRowColumnChanged()}),t._bind(F.RowChanged,function(t,n){var r=n.propertyName;r!==te&&"isVisible"!==r||e._updateCommentsLayoutWhenRowColumnChanged()}),t._bind(F.ColumnWidthChanged,function(){e._updateCommentsLayoutWhenRowColumnChanged()}),t._bind(F.RowHeightChanged,function(){e._updateCommentsLayoutWhenRowColumnChanged()}),t._bind(F.CommentChanged,function(t,n){if(n){var r=n.propertyName,o=n.comment,i=e._getCommentView(o);if(i){var a=["autoSize","text","fontFamily","fontStyle","fontSize","fontWeight","padding"];"location"===r?i._updateLayoutWhenLocationChanged():r===ee||r===te?i._updateLayoutWhenWidthHeightChanged():a.indexOf(r)>=0&&o.autoSize()&&!i._isAutosizing&&i._doAutosize()}}}))},_getCommentView:function(e){var t=this,n=t._commentViewList;if(e)for(var r=0;r<n.length;r++){var o=n[r];if(o._comment===e)return o}return y},_isEmpty:function(){return 0===this._commentList.length},_getTopCommentZIndex:function(){var e=this,t=e._commentList;if(t.length>0){for(var n=t[0].zIndex(),r=1;r<t.length;r++){var o=t[r];n<o.zIndex()&&(n=o.zIndex())}return n}return 0},_onRowsAdded:function(e,t){for(var n=this,r=n._commentList,o=n._commentViewList,i=0;i<r.length;i++){var a=r[i];e<=a._rowIndex&&(a._rowIndex+=t)}for(var s=0;s<o.length;s++){var l=o[s];l._isOpened()&&l._onRowsAdded(e,t)}},_onColumnsAdded:function(e,t){for(var n=this,r=n._commentList,o=n._commentViewList,i=0;i<r.length;i++){var a=r[i];e<=a._colIndex&&(a._colIndex+=t)}for(var s=0;s<o.length;s++){var l=o[s];l._isOpened()&&l._onColumnsAdded(e,t)}},_onRowsRemoved:function(e,t){var n,r,o=this,i=o._commentList,a=o._commentViewList;for(n=i.length-1;n>=0;n--){r=i[n];var s=r._rowIndex,l=r._colIndex;s>=e&&s<e+t&&o.remove(s,l)}for(n=0;n<i.length;n++)r=i[n],e<r._rowIndex&&(r._rowIndex-=t);for(n=0;n<a.length;n++){var u=a[n];u._isOpened()&&u._onRowsRemoved(e,t)}},_onColumnsRemoved:function(e,t){var n,r,o=this,i=o._commentList,a=o._commentViewList;for(n=i.length-1;n>=0;n--){r=i[n];var s=r._rowIndex,l=r._colIndex;l>=e&&l<e+t&&o.remove(s,l)}for(n=0;n<i.length;n++)r=i[n],e<r._colIndex&&(r._colIndex-=t);for(n=0;n<a.length;n++){var u=a[n];u._isOpened()&&u._onColumnsRemoved(e,t)}},_getActiveComment:function(){return this._activeComment},_setActiveComment:function(e){var t=this;e&&e!==t._activeComment&&(t._clearActiveComment(),t._activeComment=e)},_clearActiveComment:function(){var e=this,t=e._activeComment;if(t){var n=e._getCommentView(t);!n||n._isMoving||n._isResizing||(n._isEditing()&&n._detachEditor(),t.commentState(3),e._activeComment=y)}},_show:function(e){var t=this,n=t._getCommentView(e),r=!1;n||(r=!0,n=new $e(e,t),t._commentViewList.push(n)),n._open(),r&&e.autoSize()&&!n._isAutosizing&&n._doAutosize()},_hoverShow:function(e){var t=this,n=t._activeComment;if(n)if(1===n.displayMode()){if(2===n.commentState())return}else if(2===n.commentState()||1===n.commentState())return;e!==t._hoverShowComment&&(t._hoverShowComment&&t._hide(t._hoverShowComment),e&&2===e.displayMode()?t._mouseCapture._capture||e._timeout||(t._hoverShowComment=e,e._timeout=setTimeout(function(){t._show(e)},200)):t._hoverShowComment=y)},_hide:function(e){var t=this,n=t._getCommentView(e);n&&n._isOpened()&&(n._close(),e===t._activeComment&&t._sheet._loadAndSetSheetSelections()),clearTimeout(e._timeout),delete e._timeout},_showCommentLayoutPanel:function(){M(this._sheet._commentRender()._commentLayoutPanel).show()},_hideCommentLayoutPanel:function(){M(this._sheet._commentRender()._commentLayoutPanel).hide()},_isHitComment:function(e,t,n){var r=this._getCommentView(e);if(r){var o=r._getCommentRect();if(o)return o.contains(t,n)}return!1},_isHitCommentEditor:function(e,t,n){var r=this._getCommentView(e);if(r){var o=r._getCommentEditorRect();if(o)return o.contains(t,n)}return!1},hitTest:function(e,t){for(var n=this,r=y,o=0;o<n._commentList.length;o++){var i=n._commentList[o];s(n._sheet,i)&&(n._isHitComment(i,e,t)&&(r?i.zIndex()>r.zIndex()&&(r=i):r=i))}return r?{x:e,y:t,comment:r,area:n._isHitCommentEditor(r,e,t)?ke:Re}:y},_getCommentActualZIndex:function(e){var t=this,n=t._getTopCommentZIndex();return e===t._hoverShowComment?n+2:e===t._activeComment?n+1:e.zIndex()},_updateCommentsLayoutWhenRowColumnChanged:function(){this._commentViewList.forEach(function(e){e._updateLayoutWhenRowColumnChanged()})},_updateCommentsLayoutWhenSheetScroll:function(){this._commentViewList.forEach(function(e){e._updateAbsoluteLocationAndLayout()})},fromJSON:function(e,t){var n=this;if(e&&0!==e.length)for(var r=0;r<e.length;r++){var o=e[r],i=new Qe;i.fromJSON(o,t),3!==i.commentState()&&(n._activeComment=i),n._sheet.comments._addInternal(i._rowIndex,i._colIndex,i,!0)}},toJSON:function(){var e=this._commentList;if(!e||0===e.length)return b;for(var t=[],n=0;n<e.length;n++)t.push(e[n].toJSON());return 0===t.length?b:t}},e}(),tt=function(){function e(e){var t=this;t._sheet=y,t._showWhenTouchMoveOrScroll=!0,t._commentLayoutPanel=t._createCommentLayoutPanel(),e.appendChild(t._commentLayoutPanel)}return e.prototype={constructor:e,_createCommentLayoutPanel:function(){var e=k(de);return M(e).addClass("gc-comment-layoutPanel"+Ee+Te).css([ne,J,Z,te,ee,oe,ae,Me],[re,0,0,0,0,ie,Se,Ae]),e},_renderCommentFloatPanel:function(e){var t=this;if(!e.comments._isEmpty()){var n=e._getSheetLayout();if(M(t._commentLayoutPanel).css(J,n.x+n._rowHeaderWidth).css(Z,n.y+n._colHeaderHeight),t._sheet!==e){var r;if(t._sheet&&(r=t._sheet.comments)){var o=r._getActiveComment();o&&2===o.commentState()&&o.commentState(1)}t._sheet=e}}},_renderCommentCellAdorner:function(e,t,n){var r=n.row,o=n.col,s=n.x,l=n.y,u=a(n),c=i(n),f=this;if(3===t&&f._sheet){if(f._sheet.comments.get(r,o)){var d=6;e&&u>0&&c>0&&(e.save(),e.rect(s,l,u,c),e.clip(),e.fillStyle="red",e.beginPath(),e.moveTo(s+u-d,l),e.lineTo(s+u,l),e.lineTo(s+u,l+d),e.lineTo(s+u-d,l),e.fill(),e.restore())}}},_renderComment:function(e){if(!this._showWhenTouchMoveOrScroll)return void e._hideCommentLayoutPanel();e._showCommentLayoutPanel();for(var t=this._sheet,n=e.all(),r=0;r<n.length;r++){var o=n[r],i=e._getCommentView(o);this._canShowComment(e,o)?(1===o.displayMode()&&o===e._hoverShowComment&&(e._hoverShowComment=y),i&&i._isOpened()?i._updateLayout():e._show(o)):i&&i._isOpened()&&e._hide(o)}var a=e._getActiveComment();if(a){var s=e._getCommentView(a);s&&s._isOpened()&&t.getSelections().length>0&&t._selectionModel.clear()}},_canShowComment:function(e,t){var n=e._sheet;if(n&&p(n,t._colIndex)&&d(n,t._rowIndex))switch(t.displayMode()){case 1:return!0;case 2:if(3!==t.commentState())return e&&t!==e._hoverShowComment&&(e._hoverShowComment=t),!0;if(t===e._hoverShowComment)return!0}return!1}},e}();e.exports={CommentState:qe,DisplayMode:Je,Padding:Ze,Comment:Qe,_CommentView:$e}},function(e,t,n){function r(e){return"string"!=typeof e&&g._isNumber(e)}function o(e){if(!e)return!1;var t=/^[0-9]+(\.[0-9]+)+$/;return e="string"!=typeof e?e.toString():e,t.test(e)}function i(e,t){return e instanceof Date?I:r(e)?k:t?R+e.toString().split(".").length:R}function a(e,t){if(i(e)===R){var n=e.split(".");return n[n.length-1]=+n[n.length-1]+t,n.join(".")}return e+t}function s(e){var t=[e];return t.rowCount=1,t.colCount=T(e),t}function l(e){return e}function u(e,t,n,r,o){var i,a=s(t),u=s(n),c=s([r]);i=o?p._trendSerial(a,u,c,!0,l,_,_,_):e?p._trend(a,u,c,!0,l,_,_,_):p._growth(a,u,c,!0,_,_,_);var f=i&&i[0][0];return typeof f===k&&T(f.toString())>=13?+f.toPrecision(13):f}function c(e){var t=this;t._indexes=[],t._innerValues=[],t._type=_,t._startIndex=w(e)?-1:e}function f(e){this._sheet=e}var d=n(1),p=n(0),h=n(5),m=n(73),g=p._Types,_=null,v=void 0,y=Math.floor,b=d._createRange,w=g._isNullOrUndefined,C=g._toDouble,S=p._ArrayHelper,x=S._insert,T=S._getLength,E=p._DateTimeHelper,M=E._toOADate,A=E._fromOADate,k="number",R="serialNumber",I="date",O=function(){return p._getResource(m.SR)()};m.AutoFillType={copyCells:0,fillSeries:1,fillFormattingOnly:2,fillWithoutFormatting:3,clearValues:4,auto:5},m.FillDirection={left:0,right:1,up:2,down:3},m.FillSeries={column:0,row:1},m.FillType={direction:0,linear:1,growth:2,date:3,auto:4},m.FillDateUnit={day:0,weekday:1,month:2,year:3},c.prototype={_dataCount:function(){return T(this._innerValues)},_values:function(){var e,t,n=this,r=[],o=n._innerValues;for(e=0;e<T(o);e++)t=o[e],r.push("object"===n._type?n._toDateTime(t):t);return r},_indexes2:function(){var e=this,t=e._indexes;if(T(t)>0){var n,r=e._startIndex,o=[];for(-1===r&&(r=t[0]),n=0;n<T(t);n++)o[n]=t[n]-r+1;return o}return _},_values2:function(){var e=this._innerValues;return T(e)?e:_},_insert:function(e,t,n){if(!r(n))throw new Error(O().Exp_NumberOnly);var o=this;w(o._type)&&(o._type=i(n)),o._type!==R&&(n=C(n)),x(o._indexes,e,t),x(o._innerValues,e,n)},_add:function(e,t){var n=this;w(n._type)&&(n._type=i(t)),n._type!==R&&(t=C(t)),n._indexes.push(e),n._innerValues.push(t)},_toActualValue:function(e){return this._type===I?this._toDateTime(e):e},_toDateTime:function(e){var t=_;if(e instanceof Date)t=e;else if(h)try{t=h.Convert._toDateTime(e)}catch(n){t=e}return t}},f.prototype={_fillLinearOrGrowth:function(e,t,n,r,o){var i=this,a=e?1:2;w(r)&&w(o)?i._seriesFillRange(t,n,a):i._seriesFillRange(t,n,a,r,o,_)},_seriesFillRange:function(e,t,n,r,o,i){var a=this,s=a._sheet,l=s._getActualRange(e),u=l.row,c=l.col,f=l.rowCount,d=l.colCount;if(s._getSpanModel().hasSpans(u,c,f,d))throw new Error(O().Exp_RangeContainsMergedCell);var p,h,m,g,_,v=arguments.length>3,y=0,b=1===t,w=b?d:f,C=b?u:c,S=b?u+f:c+d,x=v?1:w,E=this._sheet._eventHandler._dragFillStartRange,M=E.row===u&&E.rowCount===f&&E.col>c||E.col===c&&E.colCount===d&&E.row>u;for(p=C;p<S;p++){var A=M&&v?c+d-1:c,k=M&&v?u+f-1:u,R=b?a._getSeriesSource(p,A,1,x,t):a._getSeriesSource(k,p,x,1,t);if(R&&R._dataCount())for(g=R._indexes[0],v?(_=M?R._innerValues[T(R._innerValues)-1]:R._innerValues[0],h=a._calcSeriesData(M,_,w,n,r,o,i),M&&(y=w-T(h),g=R._indexes[T(R._indexes)-1])):h=a._calcSeriesTrendData(R,w,n),m=0;m<T(h);m++){var I=R._toActualValue(h[m]);b?a._copyCell(s,p,g,p,c+y+m,I,n):a._copyCell(s,g,p,u+y+m,p,I,n)}}},_getSeriesSource:function(e,t,n,o,i){for(var a,s=_,l=this._sheet,u=1===i,f=u?t+o-1:e+n-1,d=u?t:e;f>=d;)a=u?l.getValue(e,f):l.getValue(f,t),r(a)&&(s||(s=new c(d)),s._insert(0,f,a)),f--;return s},_calcSeriesData:function(e,t,n,r,o,i,a){var s,l=[],u=t,c=o>=0,f=w(i);for(s=0;s<n;s++){var d=u>=i,p=u<=i;e&&(f||c&&d||!c&&p)?(l.unshift(u),1===r?u-=o:2===r?u/=o:3!==r||w(a)||(u=this._getNextDateValue(!0,a,t,u,o,s+1))):!e&&(f||c&&p||!c&&d)&&(l.push(u),1===r?u+=o:2===r?u*=o:3!==r||w(a)||(u=this._getNextDateValue(!1,a,t,u,o,s+1)))}return l},_calcSeriesTrendData:function(e,t,n){var r,o=[],i=1===n;if(i||2===n){for(1===e._dataCount()&&e._add(e._indexes[0]+1,i?e._toActualValue(e._innerValues[0]+1):e._values()[0]),r=0;r<t;r++)o.push(u(!!i,e._values2(),e._indexes2(),r+1));return o}return _},_fillAuto:function(e,t,n,r){var o=this,i=o._sheet,a=i._getSpanModel(),s=i._getActualRange(e),l=s.row,u=s.col,c=s.rowCount,f=s.colCount,d=i._getActualRange(i._eventHandler._dragFillStartRange),p=d.row,h=d.col;if(a.hasPartSpans(p,h,d.rowCount,d.colCount)||a.hasPartSpans(l,u,c,f))throw new Error(O().Exp_ChangeMergedCell);return o._autoFillRange(d,c,f,t,n,!(l<p||u<h),r)},_autoFillRange:function(e,t,n,r,o,i,a){var s,l,u,c,f=this,d=i?1:-1,p=e.row,h=e.col,m=e.rowCount,g=e.colCount;if(1===r){if(s=y(n/g),l=n%g,!o)for(c=1;c<s;c++)u=b(p,h+c*d*g,m,g),f._copyRange(e,u,r,4,o,v,v,v,v,a);if(o&&s>1&&0===l&&(s-=1,l=g),s>0&&l>0)return u=i?b(p,h+s*g,m,l):b(p,h-s*g+g-l,m,l),f._copyRange(e,u,r,4,o,i,_,i?0:g-l,v,a)}else{if(s=y(t/m),l=t%m,!o)for(c=1;c<s;c++)u=b(p+c*d*m,h,m,g),f._copyRange(e,u,r,4,o,_,_,_,!0,a);if(o&&s>1&&0===l&&(s-=1,l=m),s>0&&l>0)return u=i?b(p+s*m,h,l,g):b(p-s*m+m-l,h,l,g),f._copyRange(e,u,r,4,o,i,i?0:m-l,_,!0,a)}},_copyRange:function(e,t,n,a,s,l,u,f,d,p){var h,m,g,v,y,b=this,w=b._sheet,C=1===n,S=C?e.row:e.col,x=C?e.col:e.row,T=C?t.row:t.col,E=C?t.col:t.row,M=C?e.rowCount:e.colCount,A=C?e.colCount:e.rowCount,k=C?t.colCount:t.rowCount;for(v=0;v<M;v++){for(var R=_,I=_,O=0,D=S+v,P=T+v,N=D,F=P,L=(C?f:u)||0,H=C?0:L,V=C?_:d;O<A;){var j=x+O,B=E+O-L,U=_,W=j,z=B;if(C||(D=[j,j=N][0],P=[B,B=F][0]),g=w._getSpanModel().find(D,j),h=w.getFormula&&w.getFormula(D,j),h&&""!==h||(U=w.getValue(D,j)),4!==a||!r(U)&&!o(U)||(R||(R=new c),m=i(U,!0),I||(I=m),I!==m))if(U&&R&&R._dataCount()){if(y=b._autoFillTrendValues(C,e,t,N,F,R,s,l,H,V,p),s&&y)return y;R=_,I=_}else{if(!g||g&&(C?g.row:g.col)===N){var Y=z===E+k-1;if(s){if(g&&Y||!g&&(Y&&l||!l&&z===E))return U}else z<E+k&&z>=E&&(C||!C&&!(d&&w._isRowFilterOut&&w._isRowFilterOut(z)))&&b._copyCell(w,D,j,P,B,U,a,p)}g?O+=C?g.colCount:g.rowCount:O++}else R._add(W,U),g?O+=C?g.colCount:g.rowCount:O++}if(R&&R._dataCount()&&(y=b._autoFillTrendValues(C,e,t,N,F,R,s,l,H,V,p),s&&y))return y}return _},_copyCell:function(e,t,n,r,o,i,a,s){var l,u,c=e._getSpanModel();d._supportsCalc&&(e.hasFormula(t,n)||e.hasFormula(r,o))&&(e.setFormula(r,o,_),0!==a&&4!==a||(l=e._getCalcModel(),e.getFormula(t,n)&&h.CalcOperatorAdjustor.copyFormula(l,t,n,l,r,o,1,1))),e.setValue(r,o,i);var f=64;s&&(f|=128),e.copyTo(t,n,r,o,1,1,f),c.isEmpty()||(e.removeSpan(r,o,3),(u=c.find(t,n))&&t===u.row&&n===u.col&&e._addSpanImp(r,o,u.rowCount,u.colCount,3))},_autoFillTrendValues:function(e,t,n,r,o,i,s,l,c,f,d){var p,h,m,g,v=this,y=v._sheet,b=e?n.col:n.row,w=e?t.col:t.row,C=e?n.colCount:n.rowCount,S=e?t.colCount:t.rowCount;c=c||0;var x=i._dataCount(),T=(b-w-c)/S,E=v._isArithmeticProgression(i._indexes,i._innerValues);if(E){for(m=[],h=0;h<x;h++)m[h]=h+1;p=x}else g=i._indexes[0],p=i._indexes[x-1]-g+1,1===x&&i._add(i._indexes[0]+1,i._toActualValue(a(i._innerValues[0],1))),m=i._indexes2();for(h=0;h<p;h++){var M=u(!0,i._values2(),m,p*T+h+1,i._type===R),A=b+C-1,k=E?i._indexes[h]:g+h,I=k+T*S;if(s){if(E&&(l&&I===A||!l&&I===b)||!E&&I+c===A)return i._toActualValue(M)}else I<b+C&&I>=b&&(e?v._copyCell(y,r,k,o,I,i._toActualValue(M),4,d):f&&y._isRowFilterOut&&y._isRowFilterOut(I)||v._copyCell(y,k,r,I,o,i._toActualValue(M),4,d))}return _},_isArithmeticProgression:function(e,t){var n=T(t);if(n<=1||T(e)!==n)return!1;var r,o=e[1]-e[0],i=t[1]-t[0];for(r=2;r<n;r++)if(e[r]-e[r-1]!==o||t[r]-t[r-1]!==i)return!1;return!0},_fillAutoByDirection:function(e,t){var n,r=this,o=this._sheet,i=o.getSpans(),a=o._getActualRange(e),s=a.row,l=a.col,u=a.rowCount,c=a.colCount;n=0===t?b(s,l+c-1,u,1):1===t?b(s,l,u,1):2===t?b(s+u-1,l,1,c):b(s,l,1,c),(n=o._cellRangeInflate(i,n))&&r._directionFillRange(n,s,l,u,c,t)},_directionFillRange:function(e,t,n,r,o,i){var a,s,l,u,c,f,d,p,h=this,m=e.row,g=e.col,_=e.rowCount,v=e.colCount,w=h._sheet._getSpanModel();if(0===i?(p=w.hasSpans(t,n,r,o-v),f=0,d=-1*v,l=o,u=v,c=1):1===i?(p=w.hasSpans(t,n+v,r,o-v),f=0,d=v,l=o,u=v,c=1):2===i?(p=w.hasSpans(t,n,r-_,o),f=-1*_,d=0,l=r,u=_,c=0):(p=w.hasSpans(t+_,n,r-_,o),f=_,d=0,l=r,u=_,c=0),p)throw new Error(O().Exp_TargetContainsMergedCells);if(l%u!=0)throw new Error(O().Exp_MergedCellsIdentical);for(a=y(l/u),s=1;s<a;s++)h._copyRange(e,b(m+s*f,g+s*d,_,v),c,0)},_getNextDateValue:function(e,t,n,r,o,i){var a=e?-1:1,s=y(i*o),l=Math.abs(o),u=A(t>1?n:r);if(0===t)u.setDate(u.getDate()+a*o);else if(1===t)for(;l>0;)u.setDate(u.getDate()+a*(o>0?1:-1)),6!==u.getDay()&&0!==u.getDay()&&l--;else 2===t?u.setMonth(u.getMonth()+a*s):u.setFullYear(u.getFullYear()+a*s);return M(u)}},m._FillImp=f,e.exports=m},function(e,t,n){var r=n(11),o=n(16),i=n(38),a=n(20).CultureManager,s=n(14)._isNullOrUndefined,l=o._padZeroLeft,u=null,c=parseInt,f=!1,d=!0,p=Math.floor,h=Math.abs,m=function(){return r._getResource(r.SR)()},g={},_=function(){function e(e,t,n){var r,o,i,a,s,l=f;for(s=n,s.slice(1).forEach(function(e){e&&(l=!0)}),l||(s=s.concat(t._getDateTimePattern())),r=1,o=s.length;r<o;r++)if((a=s[r])&&(l=d,i=b(e,a,t)))return i;return u}function t(e,r,o){function i(){return f||g?f:(f=C.test(r),g=d,f)}function a(e,t){if(_)return _[t];switch(t){case 0:return e.getFullYear();case 1:return e.getMonth();case 2:return e.getDate()}}var s=o.DateTimeFormat,u=s.Calendar.convert;if(!r||!r.length)return o&&o.name.length?u?t(e,s.fullDateTimePattern,o):e.toLocaleString():e.toString();var c,f,g,_,y=s.eras,b="s"===r,w="",C=/([^d]|^)(d|dd)([^d]|$)/g,S=0,x=v();!b&&u&&(_=u.fromGregorian(e));for(var T=-2,E=-2,M={_value:""},A=0;;A++){var k=x.lastIndex,R=x.exec(r),I=r.slice(k,R?R.index:r.length);if(M._value="",S+=n(I,M),w+=M._value,!R)break;if(S%2!=1){var O=e.getFullYear(),D=e.getDay(),P=e.getHours(),N=e.getMinutes(),F=e.getSeconds(),L=e.getMilliseconds(),H=e.getTimezoneOffset();switch(R[0]){case"dddd":w+=s.dayNames[D];break;case"ddd":w+=s.abbreviatedDayNames[D];break;case"dd":case"DD":f=d,w+=l(a(e,2),2);break;case"d":f=d,w+=a(e,2);break;case"MMMM":w+=s.monthGenitiveNames&&i()?s.monthGenitiveNames[a(e,1)]:s.monthNames[a(e,1)];break;case"MMM":w+=s.abbreviatedMonthGenitiveNames&&i()?s.abbreviatedMonthGenitiveNames[a(e,1)]:s.abbreviatedMonthNames[a(e,1)];break;case"MM":w+=l(a(e,1)+1,2);break;case"M":w+=a(e,1)+1;break;case"yyyy":case"YYYY":case"yyy":w+=T>=0?y._formatEraPart("ee",e):l(_?_[0]:O,4);break;case"yy":w+=T>=0?y._formatEraPart("ee",e):l((_?_[0]:O)%100,2);break;case"y":w+=T>=0?y._formatEraPart("e",e):((_?_[0]:O)%100).toString();break;case"hh":c=P%12,0===c&&(c=12),w+=l(c,2);break;case"h":c=P%12,0===c&&(c=12),w+=c;break;case"HH":w+=l(P,2);break;case"H":w+=P.toString();break;case"mm":w+=l(N,2);break;case"m":w+=N.toString();break;case"ss":w+=l(F,2);break;case"s":w+=F.toString();break;case"tt":w+=P<12?s.amDesignator:s.pmDesignator;break;case"t":w+=(P<12?s.amDesignator:s.pmDesignator).charAt(0);break;case"f":w+=l(L,3).charAt(0);break;case"ff":w+=l(L,3).substr(0,2);break;case"fff":w+=l(L,3);break;case"z":c=H/60,w+=(c<=0?"+":"-")+p(h(c));break;case"zz":c=H/60,w+=(c<=0?"+":"-")+l(p(h(c)),2);break;case"zzz":c=H/60,w+=(c<=0?"+":"-")+l(p(h(c)),2)+":"+l(h(H%60),2);break;case"g":case"gg":case"ggg":if(!y)break;if(T===A-1){T=A;break}w+=y._formatEraPart(R[0],e),T=A;break;case"e":case"ee":if(!y){w+=l(_?_[0]:O,4);break}if(E===A-1){E=A;break}w+=y._formatEraPart(R[0],e),E=A;break;case"/":w+=s.dateSeparator;break;case"[h]":case"[hh]":case"[H]":case"[HH]":case"[mm]":case"[ss]":w+=R[0];break;default:throw new Error(m().Exp_InvalidDateFormat)}}else w+=R[0]}return w.toString()}function n(e,t){for(var n=0,r=f,o=0,i=e.length;o<i;o++){var a=e.charAt(o);switch(a){case'"':r?t._value+="'":n++,r=f;break;case"\\":r&&(t._value+="\\"),r=!r;break;default:t._value+=a,r=f}}return n}function r(e,t){var n=new Date,r=e.DateTimeFormat.eras;if(r&&t<100){var o=r._getEraDate(n)._eraYear;t+=o-o%100,t>e.DateTimeFormat.Calendar.TwoDigitYearMax&&(t-=100)}return t}function v(){return/\/|dddd|ddd|dd|DD|d|MMMM|MMM|MM|M|yyyy|YYYY|yyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|zzz|zz|z|ggg|gg|g|ee|e|\[H\]|\[HH\]|\[h\]|\[hh\]|\[mm\]|\[ss\]/g}function y(e,t){if(e._parseRegExp){if(e._parseRegExp[t])return e._parseRegExp[t]}else e._parseRegExp={};var r=t;r=r.replace("%M","M"),r=r.replace(/([\^\$\.\*\+\?\|\[\]\(\)\{\}])/g,"\\\\$1");for(var o,a="^",s={_value:""},l=[],c=0,f=0,d=v();(o=d.exec(r))!==u;){s._value="";var p=r.slice(c,o.index);if(c=d.lastIndex,f+=n(p,s),a+=s._value,f%2!=1){switch(o[0]){case"dddd":case"ddd":case"MMMM":case"MMM":case"gggg":case"ggg":case"gg":case"g":a+="(\\D+)";break;case"tt":case"t":a+="(\\D*)";break;case"dd":case"d":case"MM":case"M":case"yy":case"y":case"eee":case"ee":case"e":case"HH":case"H":case"hh":case"h":case"mm":case"m":case"ss":case"s":a+="(\\d\\d?)";break;case"yyy":case"yyyy":a+="(\\d{2}|\\d{4})";break;case"fff":a+="(\\d{3})";break;case"ff":a+="(\\d{2})";break;case"f":a+="(\\d)";break;case"zzz":a+="([+-]?\\d\\d?:\\d{2})";break;case"zz":case"z":a+="([+-]?\\d\\d?)";break;case"/":a+="(\\"+e.dateSeparator+")";break;default:throw new Error(m().Exp_InvalidDateFormat)}i._add(l,o[0])}else a+=o[0]}s._value="",n(r.slice(c),s),a+=s._value,a+="$";var h=a.toString().replace(/\s+/g,"\\s+"),g={_regExp:h,_groups:l,_exp:new RegExp(h)};return e._parseRegExp[t]=g,g}function b(e,t,n){e=e.trim();var i=n.DateTimeFormat,a=y(i,t),s=a._exp.exec(e);if(s===u)return u;for(var l,d=a._groups,p=u,h=u,m=u,g=u,_=u,v=0,b=0,w=0,C=0,S=u,x=f,T=0,E=d.length;T<E;T++){var M=s[T+1];if(M)switch(d[T]){case"dd":case"d":if((g=c(M,10))<1||g>31)return u;break;case"MMMM":if((m=n._getMonthIndex(M))<0||m>11)return u;break;case"MMM":if((m=n._getAbbrMonthIndex(M))<0||m>11)return u;break;case"M":case"MM":case"%M":if((m=c(M,10)-1)<0||m>11)return u;break;case"e":case"ee":if((h=r(n,c(M,10)))<0||h>9999)return u;break;case"y":case"yy":case"yyy":case"yyyy":if((h=c(M,10))<0||h>9999)return u;break;case"h":case"hh":case"H":case"HH":if((v=c(M,10))<0)return u;break;case"m":case"mm":if((b=c(M,10))<0||b>59)return u;break;case"s":case"ss":if((w=c(M,10))<0||w>59)return u;break;case"tt":case"t":var A=M.toUpperCase();if(!(x=A===i.pmDesignator.toUpperCase())&&A!==i.amDesignator.toUpperCase())return u;break;case"f":if((C=100*c(M,10))<0||C>999)return u;break;case"ff":if((C=10*c(M,10))<0||C>999)return u;break;case"fff":if((C=c(M,10))<0||C>999)return u;break;case"dddd":if((_=n._getDayIndex(M))<0||_>6)return u;break;case"ddd":if((_=n._getAbbrDayIndex(M))<0||_>6)return u;break;case"zzz":var k=M.split(/:/);if(2!==k.length)return u;if((l=c(k[0],10))<-12||l>13)return u;var R=c(k[1],10);if(R<0||R>59)return u;S=60*l+(o._startsWith(M,"-")?-R:R);break;case"z":case"zz":if((l=c(M,10))<-12||l>13)return u;S=60*l;break;case"g":case"gg":case"ggg":var I=M;if(!I||!i.eras)return u;if((p=i.eras._parseEraPart(d[T],I))<0)return u}}var O,D=/^(\d|\d\d):/.test(e),P=D?new Date(1899,11,30):new Date,N=i.Calendar.convert;if(N&&(O=N.fromGregorian(P)),N||(O=[P.getFullYear(),P.getMonth(),P.getDate()]),h===u?h=O[0]:h<100&&(i.eras?h=i.eras._getYearFromEra(p||0,h):h+=h>=30?1900:2e3),m===u&&(m=O[1]),g===u&&(g=O[2]),N){if((P=N.toGregorian(h,m,g))===u)return u}else{if(P.setFullYear(h,m,g),P.getDate()!==g)return u;if(_!==u&&P.getDay()!==_)return u}if(x&&v<12&&(v+=12),P.setHours(v,b,w,C),S!==u){var F=P.getMinutes()-(S+P.getTimezoneOffset());P.setHours(P.getHours()+F/60,F%60)}return P}return{_customCultureFormat:function(e,n,r){return r||(r=a._getCultureInfo()),t(e,n,r)},_localeFormat:function(e,n,r){return t(e,n,r||a._getCultureInfo())},_parseLocale:function(t,n,r){var o,i;return n||r||void 0===(i=g[t])?(o=n?[t,n]:[t],i=e(t,r||a._getCultureInfo(),o),n||r||(g[t]=i),i?new Date(i):i):i?new Date(i):i},_parseInvariant:function(t,n){return e(t,a._getCultureInfo("invariant"),[t,n])},_parseExact:b,_fromOADate:function(e){var t=e-25569,n=new Date(864e5*t),r=t>=0?1:-1,o=n.getTimezoneOffset(),i=(864e5*e*1440+r-3181192704e6+864e5*o)/1440,a=new Date(i),s=o>=0?1:-1,l=new Date(i+36e5*s),u=l.getTimezoneOffset();if(o!==u){var c=new Date(i+60*(u-o)*1e3);if(o>u){if(-1===s||u===a.getTimezoneOffset())return c}else if(o<u&&(1===s||u===a.getTimezoneOffset()))return c}return a},_toOADate:function(e){return s(e)?0:("number"==typeof e&&(e=new Date(e)),(1440*e.getTime()+3181192704e6-864e5*e.getTimezoneOffset())/124416e6)},_DT:function(e){var t=u,n=d;if(s(e))t=this._fromOADate(0);else if(e instanceof Date)t=new Date(e);else if("string"==typeof e){var r=this._parseLocale(e);r||isNaN(e)||(r=_._fromOADate(parseFloat(e)))||(n=f),t=r}else"number"==typeof e?t=this._fromOADate(e):n=f;if(n)return t;throw m().Exp_InvalidCast}}}();e.exports=_},function(e,t){var n=null,r=void 0,o=function(){function e(){}return e._insert=function(e,t,n){e.splice(t,0,n)},e._add=function(e,t){e.push(t)},e._contains=function(e,t){return e.indexOf(t)>-1},e._remove=function(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)},e._removeByIndex=function(e,t){return e=e.slice(0,t).concat(e.slice(t+1))},e._indexOf=function(e,t,n){return e.indexOf(t,n)},e._clear=function(e,t,r){if(!(t<0))for(var o=0,i=0;o<r&&i<e.length;i++)e[t+i]=n,o++},e._nextNonEmptyIndex=function(e,t){t<0&&(t=-1);for(var o=t+1,i=o;i<e.length;i++)if(e[i]!==r&&e[i]!==n)return i;return-1},e._getLength=function(e){return e&&e.length},e}();e.exports=o},function(e,t){e.exports={Exp_InvalidDateFormat:"Invalid date format pattern",Exp_InvalidExponentFormat:"invalid exponent format",Exp_InvalidSemicolons:"invalid format: too many semicolons",Exp_InvalidNumberGroupSize:"NumberGroupSize must be between 1 and 9.",Exp_BadFormatSpecifier:"Bad Format Specifier",Exp_InvalidNumberFormat:"Invalid number format pattern",Exp_InvalidCast:"InvalidCastException",Exp_Separator:"numberDecimalSeparator, listSeparator and arrayListSeparator should be different in cluture info."}},function(e,t,n){function r(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}var t={};r(t,n(80)),r(t,n(81)),e.exports=t},function(e,t){e.exports={Exp_TokenIsNull:"token is null",Exp_InvalidBackslash:"the '\\' cannot be evaluated",Exp_FormatIllegal:"format is illegal.",Exp_ValueIsNull:"value is null",Exp_DuplicatedDescriptor:"The type of descriptor was added.",Exp_TokenIllegal:"token is illegal.",Exp_ValueIllegal:"value is illegal.",Exp_InvalidCast:"InvalidCastException"}},function(e,t){function n(e){return e&&e.text!==_}function r(e,t){if(e===v||e===_)return!1;if(m(e)===y)t.value=e;else if(m(e)===w)t.value=e?1:0;else if(e instanceof Date)t.value=T._toOADate(e);else{if(m(e)!==b)return!1;if(e=e.trim(),0===g(e))return!1;var n=!1;if("%"===e.charAt(g(e)-1)&&(n=!0,e=e.substr(0,g(e)-1)),g(e)>=2&&"0"===e[0]&&"x"===e[1])return!1;var r=Number(e).valueOf();if(isNaN(r)||!isFinite(r)){if(r=new Date(e),isNaN(r))return!1;r=T._toOADate(r)}n&&(r/=100),t.value=r}return!0}function o(e){for(var t,n=e._inPreview,r=n?e._filteredPreviewRowMap:e._filteredRowMap=[],o=e._filteredInfoByRangeSet,i=e._filteredInfoSet,a=n?e._filteredPreviewRowIndexes:e._filteredRowIndexes=[],s=e._filteredColumns,l=e._filteredPreviewColumnSet,u=e._filteredPreviewByRangColumnSet,c=g(e.data),f=0;f<c;f++){for(var d=!1,p=0;p<g(s);p++){var h=s[p];if((!n||h!==e._previewCol)&&(i[h]?(t=e.getExclusiveRowIndex(e.columnNames[h],f),d=!i[h][t]):o[h]&&(d=!o[h][f]),d))break}!d&&n&&(l?(t=e.getExclusiveRowIndex(e.columnNames[h],f),d=!l[t]):u&&(d=!u[f])),d||(r[f]=!0)}for(p=0;p<g(r);p++)r[p]&&a.push(p)}function i(e){var t=e._columnsSet={};e._columnDataCache=[],e._exclusiveDataCache=[],e._exclusiveToFullMap=[],e._fullToExclusivelMap=[];for(var n=e.columnNames,r=0;r<g(n);r++)t[(n[r]+"").toUpperCase()]=r}function a(e,t){var r=e._columnDataCache,o=e._exclusiveDataCache,i=e._exclusiveDataIndex,a=e._exclusiveToFullMap,s=e._fullToExclusivelMap,l=e.data,u=s[t]=[];e._sortedColumnDataCache=[],r[t]=[],o[t]=[],i[t]={},a[t]=[];for(var c=0;c<g(l);c++){var f=l[c][t],d=n(f)?f.text.trim():f;if(r[t].push(d),void 0===u[c]){var p=[c];o[t].push(d),a[t].push(p);var h=g(a[t])-1;i[t][d]=h,u[c]=h;for(var m=c+1;m<g(l);m++){var _=l[m][t],v=n(_)?_.text.trim():_;void 0===u[m]&&T.isEquals(v,d)&&(p.push(m),u[m]=h)}}}}function s(e,t,r){var o=e._data2SortedMapping,i=e.getColumnIndex(t),a=[];if(!i)return a;var s=e._inPreview?e._filteredPreviewByRangColumn:e._filteredInfoByRange[i],l=e._filteredRowMap;if(!s)return a;o[i]||e._sortOneCol(i);for(var u=[],c=o[i],f=0;f<g(c);f++){var d=e.data[f][i],p=n(d)?d.value:d;u[c[f]]=p}var h=e._sorted2DataMapping[i];for(f=0;f<g(s);f++){for(var m=s[f],_=!1,v=e._getStartEndIndex(u,m),y=v.start;y<=v.end;y++)if(l[h[y]]){_=!0;break}_!==r&&a.push(m)}return a}function l(e,t){var n=[];if(e.getColumnIndex(t)>=0){for(var r=g(e.getData(t)),o=e._inPreview?e._filteredPreviewRowMap:e._filteredRowMap,i=0;i<r;i++)if(!o[i]){var a=e.getExclusiveRowIndex(t,i);-1===n.indexOf(a)&&n.push(a)}return n}}function u(e,t){var n=[],r=e.getColumnIndex(t);if(r>=0)for(var o=e._inPreview&&r===e._previewCol?e._filteredPreviewColumnSet||e._filteredPreviewByRangColumnSet:e._filteredInfoSet[r]||e._filteredInfoByRangeSet[r],i=!!e._filteredInfoByRangeSet[r],a=g(i?e.getData(t):e.getExclusiveData(t)),s=0;s<a;s++)if(o&&!o[s]){var l=i?e.getExclusiveRowIndex(t,s):s;-1===n.indexOf(l)&&n.push(l)}return n}function c(e,t){for(var n=[],r=e.columnNames,o=0,i=g(r);o<i;o++)if(r[o]!==t)for(var a=u(e,r[o]),s=0;s<g(a);s++)for(var l=e.getRowIndexes(r[o],a[s]),c=0;c<g(l);c++)-1===n.indexOf(l[c])&&n.push(l[c]);for(o=0,i=g(e.data);o<i;o++)-1!==n.indexOf(o)?n.splice(n.indexOf(o),1):n.push(o);var f=g(e.getExclusiveData(t)),d=[];for(o=0;o<f;o++)d.push(o);for(o=0,i=g(n);o<i;o++){var p=e.getExclusiveRowIndex(t,n[o]);-1!==d.indexOf(p)&&d.splice(d.indexOf(p),1)}return d}function f(e,t,r,i){var a=e.getColumnIndex(t),s=e._data2SortedMapping;s[a]||e._sortOneCol(a);for(var l=[],u=s[a],c=0;c<g(u);c++){var f=e.data[c][a],d=n(f)?f.value:f;l[u[c]]=d}var p={};for(c=0;c<g(r);c++)for(var h=e._getStartEndIndex(l,r[c]),m=0;m<g(u);m++)u[m]>=h.start&&u[m]<=h.end&&(p[m]=!0);i?(e._filteredPreviewByRangColumnSet=p,e._filteredPreviewByRangColumn=r):(e._filteredInfoByRange[a]=r,e._filteredInfoByRangeSet[a]=p,delete e._filteredInfoSet[a],delete e._filteredInfoIndexes[a]),o(e)}function d(e,t,n,r){for(var i=e.getColumnIndex(t),a={},s=0;s<g(n);s++)a[n[s]]=!0;r?e._filteredPreviewColumnSet=a:(e._filteredInfoSet[i]=a,e._filteredInfoIndexes[i]=n,delete e._filteredInfoByRange[i],delete e._filteredInfoByRangeSet[i]),o(e)}function p(e,t){e._inPreview=!1,e._filteredPreviewColumnSet={},e._filteredPreviewRowIndexes=[],e._filteredPreviewRowMap=[],e._filteredPreviewByRangColumnSet=[],t&&e.onFiltered()}function h(e){return e===v||e===_}function m(e){return typeof e}function g(e){return e?e.length:0}var _=void 0,v=null,y="number",b="string",w="boolean",C={all:0,byCurrentColumn:1,byOtherColumns:2},S={average:1,count:2,counta:3,max:4,min:5,product:6,stdev:7,stdevp:8,sum:9,vars:10,varp:11},x=function(){function e(e,t){var n=this;n._columnsSet={},n._columnDataCache=[],n._exclusiveDataCache=[],n._exclusiveDataIndex=[],n._exclusiveToFullMap=[],n._fullToExclusivelMap=[],n._filteredInfoSet=[],n._filteredInfoIndexes=[],n._filteredInfoByRangeSet=[],n._filteredInfoByRange=[],n._filteredRowMap=[],n._filteredRowIndexes=[],n._filteredColumns=[],n._filteredPreviewRowIndexes=[],n._filteredPreviewRowMap=[],n._inPreview=!1,n._listeners=[],n._suspendCount=0,n._sortedColumnDataCache=[],n._sorted2DataMapping=[],n._data2SortedMapping=[],n._setDataSource(e,t);for(var r=0;r<g(n.data);r++)n._filteredRowMap[r]=!0,n._filteredRowIndexes.push(r)}return e.prototype={constructor:e,inPreview:function(){return this._inPreview},_setDataSource:function(e,t){var n=this;n.data=e,n.columnNames=t,i(n)},onDataChanged:function(e){for(var t=this,r=new Array(g(t.columnNames)),i=t._filteredInfoIndexes,s=t._exclusiveDataCache,l=t._filteredInfoSet,u=t._columnDataCache,c=0;c<g(e);c++){var f=e[c],d=f.data,p=f.row,h=t.getColumnIndex(f.columnName);t.data[p][h]=d;var m=n(d)?d.text:d;u[h]&&(u[h][p]=m),r[h]=!0}for(var _=0;_<g(r);_++)if(r[_]){var v=i[_];i[_]=v?[]:void 0,l[_]=v?{}:void 0;var y=[];for(c=0;v&&c<g(v);c++)y.push(s[_][v[c]]);for(a(t,_),c=0;c<g(y);c++){var b=t._exclusiveDataIndex[_][y[c]];i[_].push(b),l[_][b]=!0}}o(t),t._notifyListeners(e,"onDataChanged")},_notifyListeners:function(){var e=arguments,t=e[g(e)-1];e.length-=1;for(var n=this._listeners||[],r=0;r<g(n);r++){var o=n[r];o[t]&&o[t].apply(o,e)}},onColumnNameChanged:function(e,t){var n=this,r=n._columnsSet,o=n.getColumnIndex(e);o<0||(n.columnNames[o]=t,delete r[e.toUpperCase()],r[t.toUpperCase()]=o,n._notifyListeners(e,t,"onColumnNameChanged"))},onRowsAdded:function(e,t,n){var r=this,o=g(r.columnNames),i=r.data,a=r._columnDataCache,s=r._exclusiveDataCache,l=r._exclusiveToFullMap,u=r._fullToExclusivelMap,c=r._filteredInfoSet,f=r._filteredInfoIndexes,d=r._filteredRowMap,p=r._filteredRowIndexes,h=r._filteredColumns;r._sortedColumnDataCache=[];for(var m=0;m<t;m++)i.splice(e,0,new Array(o));for(var y=0;y<o;y++){for(m=0;m<t;m++)a[y]&&a[y].splice(e,0,_);var b,w=s[y];if(w){for(var C=v,S=0;S<g(w);S++){for(var x=l[y][S],E=0;E<g(x);E++)x[E]>=e&&(x[E]+=t);T.isEquals(w[S],v)&&(C=x,b=S)}C||(C=[],w.push(v),b=g(w)-1,r._exclusiveDataIndex[y][v]=b,l[y].push(C),c[y]&&-1===h.indexOf(y)&&(c[y][b]=!0,f[y].push(b)));for(var M=e;M<e+t;M++)C.push(M);for(var A=e;A<e+t;A++)u[y].splice(A,0,b)}}var k=!0;for(m=0;m<g(h);m++){y=h[m];var R=u[y][e];!0!==c[y][R]&&(k=!1)}for(m=0;m<g(p);m++)p[m]>=e&&(p[m]+=t);for(A=g(i)-1;A>=e+t;A--)d[A]=d[A-t];var I=g(h)>0;for(A=e;A<e+t;A++)k&&p.push(A),d[A]=!I;n||r._notifyListeners(e,t,!0,"onRowsChanged")},onRowsRemoved:function(e,t){this._onRowsRemovedCore(e,t,!0)},_onRowsRemovedCore:function(e,t,n){var r=this,i=r._filteredInfoIndexes,s=r._exclusiveDataCache,l=r._filteredInfoSet,u=r.data,c=g(r.columnNames),f=r._columnDataCache;u.splice(e,t);for(var d=0;d<c;d++){f[d]&&f[d].splice(e,t);var p=i[d],h=[];if(p&&n){for(var m=0;m<g(p);m++){for(var _=r.getRowIndexes(r.columnNames[d],p[m]),v=!0,y=0;y<g(_);y++)if(_[y]<e||_[y]>=e+t){v=!1;break}v||h.push(s[d][p[m]])}i[d]=[],l[d]={}}if(a(r,d),p&&n)for(m=0;m<g(h);m++){var b=r._exclusiveDataIndex[d][h[m]];i[d].push(b),l[d][b]=!0}}n&&o(r),r._notifyListeners(e,t,!1,"onRowsChanged")},onColumnsRemoved:function(e,t){for(var n=this,r=n.data,o=[],i=e;i<e+t;i++)o.push(n.columnNames[i]);var a=n._filteredColumns;for(i=0;i<g(o);i++){var s=o[i],l=n.getColumnIndex(s);-1!==a.indexOf(l)&&n.doUnfilter(s)}var u=n._filteredInfoSet||n._filteredInfoByRangeSet,c=n._filteredInfoIndexes||n._filteredInfoByRange,f=n._columnsSet;for(i=0;i<g(r);i++)r[i].splice(e,t);n._sortedColumnDataCache=[],n.columnNames.splice(e,t),n._columnDataCache.splice(e,t),n._exclusiveDataCache.splice(e,t),n._exclusiveDataIndex.splice(e,t),n._exclusiveToFullMap.splice(e,t),n._fullToExclusivelMap.splice(e,t),u.splice(e,t),c.splice(e,t);for(var d in f)f[d]>=e+t&&(f[d]-=t);for(i=0;i<g(o);i++){s=o[i],delete f[s.toUpperCase()],e=n.getColumnIndex(s);var p=a.indexOf(e);-1!==p&&a.splice(p,1),n._notifyListeners(o[i],"onColumnRemoved")}},_getSortedColumnDataCache:function(){return this._sortedColumnDataCache},_getSorted2DataMapping:function(){return this._sorted2DataMapping},_sortOneCol:function(e){var t=this,r=t.data;t._columnDataCache[e]||a(t,e);for(var o=g(r),i=[],s=0;s<o;s++){var l=r[s][e],u=n(l)?l.value:l;i.push(u)}for(var c=T.quickSort(i),f=t._sortedColumnDataCache[e]=[],d=t._sorted2DataMapping[e]=[],p=t._data2SortedMapping[e]=[],h=0;h<g(c);h++){var m=c[h];f.push(m.value),d.push(m.index),p[m.index]=h}},getColumnIndex:function(e){var t=this._columnsSet[e.toUpperCase()];return void 0===t?-1:t},getFilteredRowIndexes:function(){var e=this;return e._inPreview?e._filteredPreviewRowIndexes:e._filteredRowIndexes},getFilteredOutRowIndexes:function(){for(var e=this,t=g(e.data),n=e._inPreview?e._filteredPreviewRowMap:e._filteredRowMap,r=[],o=0;o<t;o++)n[o]||r.push(o);return r},getData:function(e,t){var n=this,r=n._columnDataCache,o=n.getColumnIndex(e);if(o>=0){if(t){n._sortedColumnDataCache[o]||n._sortOneCol(o);for(var i=r[o],s=n._sortedColumnDataCache[o],l=n._getStartEndIndex(s,t),u=l.start,c=l.end,f=[],d=u;d<=c;d++)f.push(i[n._sorted2DataMapping[o][d]]);return f}return r[o]||a(n,o),r[o]}return[]},aggregateData:function(e,t,n){var o,i,a=this,s=a.getColumnIndex(e);if(s<0)return _;a._sortedColumnDataCache[s]||a._sortOneCol(s);var l=a._sortedColumnDataCache[s],u=g(l),c=a._getStartEndIndex(l,n);if(o=c.start,i=c.end,5===t)return o>=u?_:l[o];if(4===t)return i<0?_:l[i];if(3===t)return i<o?0:i-o+1;for(var f=6===t?1:0,d=0,p=0,h=o;h<=i;h++){var m=l[h];if(m!==v||m!==_){var y={value:v};3===t?f++:r(m,y)&&(m=y.value,1===t?(f+=m,d++):2===t?f++:9===t?f+=m:6===t?f*=m:7!==t&&8!==t&&10!==t&&11!==t||(f+=m,d+=m*m,p++))}}return 1===t?f/=d:7===t||10===t?(f=(p*d-f*f)/(p*(p-1)),f=7===t?Math.sqrt(f):f):8!==t&&11!==t||(f=(p*d-f*f)/(p*p),f=8===t?Math.sqrt(f):f),f},_getStartEndIndex:function(e,t){var n,r,o=g(e);if(t){if(t.min===-1/0)n=0;else for(var i=0;i<o;i++){var a=e[i];if(T.isEquals(t.min,a)||T.isGreaterThan(a,t.min)){n=i;break}}if(n===_&&(n=o),r===1/0)r=o-1;else{for(i=o-1;i>=0;i--)if(a=e[i],T.isEquals(a,t.max)||T.isGreaterThan(t.max,a)){r=i;break}r===_&&(r=-1)}}else n=0,r=o-1;return{start:n,end:r}},getExclusiveData:function(e){var t=this,n=t._exclusiveDataCache,r=t.getColumnIndex(e);return r>=0?(n[r]||a(t,r),n[r]):[]},getRowIndexes:function(e,t){var n=this,r=n.getColumnIndex(e);return r>=0?(n._fullToExclusivelMap[r]||a(n,r),n._exclusiveToFullMap[r][t]):[]},getExclusiveRowIndex:function(e,t){var n=this,r=n._fullToExclusivelMap,o=n.getColumnIndex(e);return o>=0?(r[o]||a(n,o),r[o][t]):-1},getFilteredIndexes:function(e){var t=[],n={};return this._getFilteredExclusiveIndexes(e,t,n),t},_getFilteredExclusiveIndexes:function(e,t,n){for(var r=this,o=r._inPreview?r._filteredPreviewRowIndexes:r._filteredRowIndexes,i=0;i<g(o);i++){var a=o[i],s=r.getExclusiveRowIndex(e,a);n[s]?n[s]++:(n[s]=1,t.push(s))}},getFilteredRanges:function(e){return s(this,e,!1)},getFilteredOutRanges:function(e){return s(this,e,!0)},getFilteredOutIndexes:function(e,t){var n=this;return 0===t?l(n,e):1===t?u(n,e):c(n,e)},attachListener:function(e){this._listeners.push(e)},detachListener:function(e){for(var t=this._listeners||[],n=0;n<g(t);n++)if(t[n]===e){t.splice(n,1);break}},suspendFilteredEvents:function(){this._suspendCount++},resumeFilteredEvents:function(){var e=this;0===--e._suspendCount&&e.onFiltered()},doFilter:function(e,t,n){this._doFilterInternal(e,t,n),this.onFiltered()},_doFilterInternal:function(e,t,n){var r=this,o=r._filteredColumns,i=r.getColumnIndex(e);i<0||(n?(r._inPreview=!0,r._previewCol=i):r._inPreview&&p(r,!1),o.indexOf(i)<0&&o.push(i),t.ranges?f(r,e,t.ranges,n):d(r,e,t.exclusiveRowIndexes,n))},clearPreview:function(){p(this,!0)},doUnfilter:function(e){this._doUnfilterInternal(e),this.onFiltered()},_doUnfilterInternal:function(e){var t=this;t._inPreview&&p(t,!1);var n=t.getColumnIndex(e);if(!(n<0)){delete t._filteredInfoByRange[n],delete t._filteredInfoByRangeSet[n],delete t._filteredInfoSet[n],delete t._filteredInfoIndexes[n],o(t);var r=t._filteredColumns.indexOf(n);r>=0&&t._filteredColumns.splice(r,1)}},onFiltered:function(){var e=this;0===e._suspendCount&&e._notifyListeners({rowIndexes:e.getFilteredRowIndexes(),isPreview:e._inPreview},"onFiltered")},getListener:function(){return this._listeners}},e}(),T=function(){function e(){}return e.quickSort=function(e){var t,n=g(e),r=[];for(t=0;t<n;t++)r[t]={index:t,value:e[t]};return this.quickSortImp(r)},e.quickSortImp=function(e){if(g(e)<=1)return e;for(var t=this,n=Math.floor(g(e)/2),r=e[n],o=[],i=[],a=[],s=0;s<g(e);s++){var l=t.sortCompare(e[s].value,r.value);l<0?o.push(e[s]):l>0?i.push(e[s]):a.push(e[s])}return t.quickSortImp(o).concat(a,t.quickSortImp(i))},e.isEquals=function(e,t){return!(!h(e)&&""!==e||!h(t)&&""!==t)||(e instanceof Date&&t instanceof Date?e.valueOf()===t.valueOf():m(e)===b&&m(t)===b?e.toLowerCase()===t.toLowerCase():e===t)},e._toOADate=function(e){return h(e)?0:(m(e)===y&&(e=new Date(e)),(1440*e.getTime()+3181192704e6-864e5*e.getTimezoneOffset())/124416e6)},e.isGreaterThan=function(e,t){var n=m(e),r=m(t);return n===w?e=e?1:0:e instanceof Date&&(e=this._toOADate(e)),r===w?t=t?1:0:t instanceof Date&&(t=this._toOADate(t)),n===r||n!==y&&r!==y?n===b&&r===b?e.toLowerCase()>t.toLowerCase():e>t:m(t)===y},e.sortCompare=function(e,t){var n,r,o=this,i=!0;return n=h(e)||""===e||m(e)===y&&isNaN(e),r=h(t)||""===t||m(t)===y&&isNaN(t),n&&r?0:n?1:r?-1:o.isEquals(e,t)?0:o.isGreaterThan(e,t)?i?1:-1:i?-1:1},e}();e.exports={FilteredOutDataType:C,SlicerAggregateType:S,GeneralSlicerData:x,_SortHelper:T}},function(e,t){function n(e,t){return{description:e,parameters:t}}function r(e,t){return{name:e,repeatable:t}}e.exports={Exp_InvalidCast:"InvalidCastException",Exp_FormulaInvalidChar:"The formula you typed contains an invalid char: '{0}' at index on {1}",Exp_FormulaInvalid:"The formula you typed is invlid",Exp_InvalidFunctionName:"Invalid function name",Exp_InvalidOverrideFunction:"Cannot override built-in function",Exp_InvalidArray:"Invalid array",Exp_OverrideNotAllowed:"Attempt to override function while override is not allowed",Exp_NoSyntax:"no syntax '{0}' to match the syntax '{1}'.",Exp_IsValid:"'{0}' is invalid.",Exp_InvalidParameters:"Invalid function parameters at {0}.",Exp_InvalidArrayColumns:"The length of array columns are unequal at {0}.",Exp_ExprIsNull:"The argument 'expr' is null",Exp_InvalidNull:"InvalidNullException",Exp_InvalidOperation:"InvalidOperationException",Exp_ArgumentNull:"ArgumentNullException",Exp_CriteriaIsNull:"criteria is null",Exp_Format:"Format",Exp_ArrayFromulaPart:"You cannot change part of an array.",Exp_NotSupported:"NotSupportException",_builtInFunctionsResource:{ABS:n("This function calculates the absolute value of the specified value.",[r("value")]),ACCRINT:n("This function calculates the accrued interest for a security that pays periodic interest.",[r("issue"),r("first"),r("settle"),r("rate"),r("par"),r("frequency"),r("basis")]),ACCRINTM:n("This function calculates the accrued interest at maturity for a security that pays periodic interest.",[r("issue"),r("maturity"),r("rate"),r("par"),r("basis")]),ACOS:n("This function calculates the arccosine, that is, the angle whose cosine is the specified value.",[r("value")]),ACOSH:n("This function calculates the inverse hyperbolic cosine of the specified value.",[r("value")]),ADDRESS:n("This function uses the row and column numbers to create a cell address in text.",[r("row"),r("column"),r("absnum"),r("a1style"),r("sheettext")]),AMORDEGRC:n("This function returns the depreciation for an accounting period, taking into consideration prorated depreciation, and applies a depreciation coefficient in the calculation based on the life of the assets.",[r("cost"),r("datepurchased"),r("firstperiod"),r("salvage"),r("period"),r("drate"),r("basis")]),AMORLINC:n("This function calculates the depreciation for an accounting period, taking into account prorated depreciation.",[r("cost"),r("datepurchased"),r("firstperiod"),r("salvage"),r("period"),r("drate"),r("basis")]),AND:n("Check whether all arguments are True, and returns True if all arguments are True.",[r("logical1"),r("logical2")]),ASIN:n("This function calculates the arcsine, that is, the angle whose sine is the specified value.",[r("value")]),ASINH:n("This function calculates the inverse hyperbolic sine of a number.",[r("value")]),ATAN:n("This function calculates the arctangent, that is, the angle whose tangent is the specified value.",[r("value")]),ATAN2:n("This function calculates the arctangent of the specified x- and y-coordinates.",[r("x"),r("y")]),ATANH:n("This function calculates the inverse hyperbolic tangent of a number.",[r("value")]),AVEDEV:n("This function calculates the average of the absolute deviations of the specified values from their mean.",[r("value1"),r("value2",!0)]),AVERAGE:n("This function calculates the average of the specified numeric values.",[r("value1"),r("value2",!0)]),AVERAGEA:n("This function calculates the average of the specified values, including text or logical values as well as numeric values.",[r("value1"),r("value2",!0)]),AVERAGEIF:n("This function calculates the average of the specified numeric values provided that they meet the specified criteria.",[r("value1"),r("value2",!0),r("condition")]),AVERAGEIFS:n("This function calculates the average of all cells that meet multiple specified criteria.",[r("value1"),r("condition1"),r("value2",!0),r("condition2...")]),BESSELI:n("This function calculates the modified Bessel function of the first kind evaluated for purely imaginary arguments.",[r("value"),r("order")]),BESSELJ:n("This function calculates the Bessel function of the first kind.",[r("value"),r("order")]),BESSELK:n("This function calculates the modified Bessel function of the second kind evaluated for purely imaginary arguments.",[r("value"),r("order")]),BESSELY:n("This function calculates the Bessel function of the second kind.",[r("value"),r("order")]),BETADIST:n("This function calculates the cumulative beta distribution function.",[r("x"),r("alpha"),r("beta"),r("lower"),r("upper")]),BETAINV:n("This function calculates the inverse of the cumulative beta distribution function.",[r("prob"),r("alpha"),r("beta"),r("lower"),r("upper")]),BIN2DEC:n("This function converts a binary number to a decimal number",[r("number")]),BIN2HEX:n("This function converts a binary number to a hexadecimal number.",[r("number"),r("places")]),BIN2OCT:n("This function converts a binary number to an octal number.",[r("number"),r("places")]),BINOMDIST:n("This function calculates the individual term binomial distribution probability.",[r("x"),r("n"),r("p"),r("cumulative")]),CEILING:n("This function rounds a number up to the nearest multiple of a specified value.",[r("value"),r("signif")]),CHAR:n("This function returns the character specified by a number.",[r("value")]),CHIDIST:n("This function calculates the one-tailed probability of the chi-squared distribution.",[r("value"),r("deg")]),CHIINV:n("This function calculates the inverse of the one-tailed probability of the chi-squared distribution",[r("prob"),r("deg")]),CHITEST:n("This function calculates the test for independence from the chi-squared distribution.",[r("obs_array"),r("exp_array")]),CHOOSE:n("This function returns a value from a list of values.",[r("index"),r("value1"),r("value2",!0)]),CLEAN:n("This function removes all non-printable characters from text.",[r("text")]),CODE:n("This function returns a numeric code to represent the first character in a text string. The returned code corresponds to the Windows character set (ANSI).",[r("text")]),COLUMN:n("This function returns the column number of a reference.",[r("reference")]),COLUMNS:n("This function returns the number of columns in an array.",[r("array")]),COMBIN:n("This function calculates the number of possible combinations for a specified number of items.",[r("k"),r("n")]),COMPLEX:n("This function converts real and imaginary coefficients into a complex number.",[r("realcoeff"),r("imagcoeff"),r("suffix")]),CONCATENATE:n("This function combines multiple text strings or numbers into one text string.",[r("text1"),r("text2"),r("....")]),CONFIDENCE:n("This function returns confidence interval for a population mean.",[r("alpha"),r("stdev"),r("size")]),CONVERT:n("This function converts a number from one measurement system to its equivalent in another measurement system.",[r("number"),r("from-unit"),r("to-unit")]),CORREL:n("This function returns the correlation coefficient of the two sets of data.",[r("array1"),r("array2")]),COS:n("This function returns the cosine of the specified angle.",[r("angle")]),COSH:n("This function returns the hyperbolic cosine of the specified value.",[r("value")]),COUNT:n("This function returns the number of cells that contain numbers.",[r("value1"),r("value2",!0)]),COUNTA:n("This function returns the number of number of cells that contain numbers, text, or logical values.",[r("value1"),r("value2",!0)]),COUNTBLANK:n("This function returns the number of empty (or blank) cells in a range of cells on a sheet.",[r("cellrange")]),COUNTIF:n("This function returns the number of cells that meet a certain condition",[r("cellrange"),r("condition")]),COUNTIFS:n("This function returns the number of cells that meet multiple conditions.",[r("cellrange"),r("condition")]),COUPDAYBS:n("This function calculates the number of days from the beginning of the coupon period to the settlement date.",[r("settlement"),r("maturity"),r("frequency"),r("basis")]),COUPDAYS:n("This function returns the number of days in the coupon period that contains the settlement date.",[r("settlement"),r("maturity"),r("frequency"),r("basis")]),COUPDAYSNC:n("This function calculates the number of days from the settlement date to the next coupon date.",[r("settlement"),r("maturity"),r("frequency"),r("basis")]),COUPNCD:n("This function returns a date number of the next coupon date after the settlement date.",[r("settlement"),r("maturity"),r("frequency"),r("basi")]),COUPNUM:n("This function returns the number of coupons due between the settlement date and maturity date.",[r("settlement"),r("maturity"),r("frequency"),r("basis")]),COUPPCD:n("This function returns a date number of the previous coupon date before the settlement date.",[r("settlement"),r("maturity"),r("frequency"),r("basis")]),COVAR:n("This function returns the covariance, which is the average of the products of deviations for each data point pair in two sets of numbers.",[r("array1"),r("array2")]),CRITBINOM:n("This function returns the criterion binomial, the smallest value for which the cumulative binomial distribution is greater than or equal to a criterion value.",[r("n"),r("p"),r("alpha")]),CUMIPMT:n("This function returns the cumulative interest paid on a loan between the starting and ending periods.",[r("rate"),r("nper"),r("pval"),r("startperiod"),r("endperiod"),r("paytype")]),CUMPRINC:n("This function returns the cumulative principal paid on a loan between the start and end periods.",[r("rate"),r("nper"),r("pval"),r("startperiod"),r("endperiod"),r("paytype")]),DATE:n("This function returns the DateTime object for a particular date, specified by the year, month, and day.",[r("year"),r("month"),r("day")]),DATEDIF:n("This function returns the number of days, months, or years between two dates.",[r("date1"),r("date2"),r("outputcode")]),DATEVALUE:n("This function returns a DateTime object of the specified date.",[r("date_string")]),DAVERAGE:n("This function calculates the average of values in a column of a list or database that match the specified conditions.",[r("database"),r(" field"),r(" criteria")]),DAY:n("This function returns the day number of the month (integer 1 to 31) that corresponds to the specified date.",[r("date")]),DAYS360:n("This function returns the number of days between two dates based on a 360-day year.",[r("startdate"),r("enddate"),r("method")]),DB:n("This function calculates the depreciation of an asset for a specified period using the fixed‑declining balance method",[r("cost"),r("salvage"),r("life"),r("period"),r("month")]),DCOUNT:n("This function counts the cells that contain numbers in a column of a list or database that match the specified conditions",[r("database"),r(" field"),r(" criteria")]),DCOUNTA:n("This function counts the non-blank cells in a column of a list or database that match the specified conditions",[r("database"),r(" field"),r(" criteria")]),DDB:n("This function calculates the depreciation of an asset for a specified period using the double-declining balance method or another method you specify.",[r("cost"),r("salvage"),r("life"),r("period"),r("factor")]),DEC2BIN:n("This function converts a decimal number to a binary number.",[r("number"),r("places")]),DEC2HEX:n("This function converts a decimal number to a hexadecimal number",[r("number"),r("places")]),DEC2OCT:n("This function converts a decimal number to an octal number",[r("number"),r("places")]),DEGREES:n("This function converts the specified value from radians to degrees",[r("angle")]),DELTA:n("This function identifies whether two values are equal. Returns 1 if they are equal; returns 0 otherwise.",[r("value1"),r("value2")]),DEVSQ:n("This function calculates the sum of the squares of deviations of data points (or of an array of data points) from their sample mean.",[r("value1"),r("value2",!0)]),DGET:n("This function extracts a single value from a column of a list or database that matches the specified conditions.",[r("database"),r(" field"),r(" criteria")]),DISC:n("This function calculates the discount rate for a security.",[r("settle"),r("mature"),r("pricep"),r("redeem"),r("basis")]),DMAX:n("This function returns the largest number in a column of a list or database that matches the specified conditions.",[r("database"),r(" field"),r(" criteria")]),DMIN:n("This function returns the smallest number in a column of a list or database that matches the specified conditions.",[r("database"),r(" field"),r(" criteria")]),DOLLAR:n("This function converts a number to text using currency format, with the decimals rounded to the specified place.",[r("value"),r("digits")]),DOLLARDE:n("This function converts a fraction dollar price to a decimal dollar price.",[r("fractionaldollar"),r("fraction")]),DOLLARFR:n("This function converts a decimal number dollar price to a fraction dollar price.",[r("decimaldollar"),r("fraction")]),DPRODUCT:n("This function multiplies the values in a column of a list or database that match the specified conditions.",[r("database"),r(" field"),r(" criteria")]),DSTDEV:n("This function estimates the standard deviation of a population based on a sample by using the numbers in a column of a list or database that match the specified conditions.",[r("database"),r(" field"),r(" criteria")]),DSTDEVP:n("This function calculates the standard deviation of a population based on the entire population using the numbers in a column of a list or database that match the specified conditions.",[r("database"),r(" field"),r(" criteria")]),DSUM:n("This function adds the numbers in a column of a list or database that match the specified conditions.",[r("database"),r(" field"),r(" criteria")]),DURATION:n("This function returns the Macaulay duration for an assumed par value of $100.",[r("settlement"),r("maturity"),r("coupon"),r("yield"),r("frequency"),r("basis")]),DVAR:n("This function estimates the variance of a population based on a sample by using the numbers in a column of a list or database that match the specified conditions.",[r("database"),r(" field"),r(" criteria")]),DVARP:n("This function calculates the variance of a population based on the entire population by using the numbers in a column of a list or database that match the specified conditions.",[r("database"),r(" field"),r(" criteria")]),EDATE:n("This function calculates the date that is the indicated number of months before or after a specified date.",[r("startdate"),r("months")]),EFFECT:n("This function calculates the effective annual interest rate for a given nominal annual interest rate and the number of compounding periods per year.",[r("nomrate"),r("comper")]),EOMONTH:n("This function calculates the date for the last day of the month (end of month) that is the indicated number of months before or after the starting date.",[r("startdate"),r("months")]),ERF:n("This function calculates the error function integrated between a lower and an upper limit.",[r("limit"),r("upperlimit")]),ERFC:n("This function calculates the complementary error function integrated between a lower limit and infinity.",[r("lowerlimit")]),"ERROR.TYPE":n("This function returns a number corresponding to one of the error values.",[r("errorvalue")]),EURO:n("This function returns the equivalent of one Euro based on the ISO currency code.",[r("code")]),EUROCONVERT:n("This function converts currency from a Euro member currency (including Euros) to another Euro member currency (including Euros).",[r("currency"),r("source"),r("target"),r("fullprecision"),r("triangulation")]),EVEN:n("This function rounds the specified value up to the nearest even integer.",[r("value")]),EXACT:n("This function returns true if two strings are the same; otherwise, false.",[r("text1"),r("text2")]),EXP:n("This function returns e raised to the power of the specified value.",[r("value")]),EXPONDIST:n("This function returns the exponential distribution or the probability density.",[r("value"),r("lambda"),r("cumulative")]),FACT:n("This function calculates the factorial of the specified number.",[r("number")]),FACTDOUBLE:n("This function calculates the double factorial of the specified number.",[r("number")]),FALSE:n("This function returns the value for logical FALSE.",[]),FDIST:n("This function calculates the F probability distribution, to see degrees of diversity between two sets of data.",[r("value"),r("degnum"),r("degden")]),FIND:n("This function finds one text value within another and returns the text value’s position in the text you searched.",[r("findtext"),r("intext"),r("start")]),FINV:n("This function returns the inverse of the F probability distribution.",[r("p"),r("degnum"),r("degden")]),FISHER:n("This function returns the Fisher transformation for a specified value.",[r("value")]),FISHERINV:n("This function returns the inverse of the Fisher transformation for a specified value.",[r("value")]),FIXED:n("This function rounds a number to the specified number of decimal places, formats the number in decimal format using a period and commas (if so specified), and returns the result as text.",[r("num"),r("digits"),r("notcomma")]),FLOOR:n("This function rounds a number down to the nearest multiple of a specified value.",[r("value"),r("signif")]),FORECAST:n("This function calculates a future value using existing values.",[r("value"),r("Yarray"),r("Xarray")]),FREQUENCY:n("This function calculates how often values occur within a range of values. This function returns a vertical array of numbers.",[r("dataarray"),r("binarray")]),FTEST:n("This function returns the result of an F-test, which returns the one-tailed probability that the variances in two arrays are not significantly different.",[r("array1"),r("array2")]),FV:n("This function returns the future value of an investment based on a present value, periodic payments, and a specified interest rate.",[r("rate"),r("numper"),r("paymt"),r("pval"),r("type")]),FVSCHEDULE:n("This function returns the future value of an initial principal after applying a series of compound interest rates. Calculate future value of an investment with a variable or adjustable rate.",[r("principal"),r("schedule")]),GAMMADIST:n("This function returns the gamma distribution.",[r("x"),r("alpha"),r("beta"),r("cumulative")]),GAMMAINV:n("This function returns the inverse of the gamma cumulative distribution.",[r("p"),r("alpha"),r("beta")]),GAMMALN:n("This function returns the natural logarithm of the Gamma function, G(x).",[r("value")]),GCD:n("This function returns the greatest common divisor of two numbers.",[r("number1"),r("number2")]),GEOMEAN:n("This function returns the geometric mean of a set of positive data.",[r("value1"),r("value2",!0)]),GESTEP:n("This function, greater than or equal to step, returns an indication of whether a number is equal to a threshold.",[r("number"),r("step")]),GROWTH:n("This function calculates predicted exponential growth. This function returns the y values for a series of new x values that are specified by using existing x and y values.",[r("y"),r("x"),r("newx"),r("constant")]),HARMEAN:n("This function returns the harmonic mean of a data set.",[r("value1"),r("value2",!0)]),HEX2BIN:n("This function converts a hexadecimal number to a binary number.",[r("number"),r(" places")]),HEX2DEC:n("This function converts a hexadecimal number to a decimal number.",[r("number")]),HEX2OCT:n("This function converts a hexadecimal number to an octal number.",[r("number"),r(" places")]),HLOOKUP:n("This function searches for a value in the top row and then returns a value in the same column from a specified row.",[r("value"),r("array"),r("row"),r("approx")]),HOUR:n("This function returns the hour that corresponds to a specified time.",[r("time")]),HYPGEOMDIST:n("This function returns the hypergeometric distribution.",[r("x"),r("n"),r("M"),r("N")]),IF:n("This function performs a comparison and returns one of two provided values based on that comparison.",[r("valueTest"),r("valueTrue"),r("valueFalse")]),IFERROR:n("This function evaluates a formula and returns a value you provide if there is an error or the formula result.",[r("value"),r("error")]),IMABS:n("This function returns the absolute value or modulus of a complex number.",[r("complexnum")]),IMAGINARY:n("This function returns the imaginary coefficient of a complex number.",[r("complexnum")]),IMARGUMENT:n("This function returns the argument theta, which is an angle expressed in radians.",[r("complexnum")]),IMCONJUGATE:n("This function returns the complex conjugate of a complex number.",[r("complexnum")]),IMCOS:n("This function returns the cosine of a complex number.",[r("complexnum")]),IMDIV:n("This function returns the quotient of two complex numbers.",[r("complexnum"),r("complexdenom")]),IMEXP:n("This function returns the exponential of a complex number.",[r("complexnum")]),IMLN:n("This function returns the natural logarithm of a complex number.",[r("complexnum")]),IMLOG2:n("This function returns the base-2 logarithm of a complex number.",[r("complexnum")]),IMLOG10:n("This function returns the common logarithm of a complex number.",[r("complexnum")]),IMPOWER:n("This function returns a complex number raised to a power.",[r("complexnum"),r("powernum")]),IMPRODUCT:n("This function returns the product of up to 29 complex numbers in the x+yi or x+yj text format.",[r("complexnum1"),r("complexnum2",!0)]),IMREAL:n("This function returns the real coefficient of a complex number in the x+yi or x+yj text format.",[r("complexnum")]),IMSIN:n("This function returns the sine of a complex number in the x+yi or x+yj text format.",[r("complexnum")]),IMSQRT:n("This function returns the square root of a complex number in the x+yi or x+yj text format.",[r("complexnum")]),IMSUB:n("This function returns the difference of two complex numbers in the x+yi or x+yj text format.",[r("complexnum1"),r("complexnum2")]),IMSUM:n("This function returns the sum of two or more complex numbers in the x+yi or x+yj text format.",[r("complexnum1"),r("complexnum2",!0)]),INDEX:n("This function returns a value or the reference to a value from within an array or range.",[r("return"),r("row"),r("col"),r("area")]),INDIRECT:n("This function returns the reference specified by a text string. References are immediately evaluated to display their contents.",[r("ref_text"),r("a1_style")]),INT:n("This function rounds a specified number down to the nearest integer.",[r("value")]),INTERCEPT:n("This function returns the coordinates of a point at which a line intersects the y-axis, by using existing x values and y values.",[r("dependent"),r("independent")]),INTRATE:n("This function calculates the interest rate for a fully invested security.",[r("settle"),r("mature"),r("invest"),r("redeem"),r("basis")]),IPMT:n("This function calculates the payment of interest on a loan.",[r("rate"),r("per"),r("nper"),r("pval"),r("fval"),r("type")]),IRR:n("This function returns the internal rate of return for a series of cash flows represented by the numbers in an array.",[r("arrayvals"),r("estimate")]),ISBLANK:n("This function tests whether a value, an expression, or contents of a referenced cell is empty.",[r("cellreference")]),ISERR:n("This function, Is Error Other Than Not Available, tests whether a value, an expression, or contents of a referenced cell has an error other than not available (#N/A).",[r("cellreference")]),ISERROR:n("This function, Is Error of Any Kind, tests whether a value, an expression, or contents of a referenced cell has an error of any kind.",[r("cellreference")]),ISEVEN:n("This function, Is Number Even, tests whether a value, an expression, or contents of a referenced cell is even.",[r("cellreference")]),ISLOGICAL:n("This function tests whether a value, an expression, or contents of a referenced cell is a logical (Boolean) value.",[r("cellreference")]),ISNA:n("This function, Is Not Available, tests whether a value, an expression, or contents of a referenced cell has the not available (#N/A) error value.",[r("cellreference")]),ISNONTEXT:n("This function tests whether a value, an expression, or contents of a referenced cell has any data type other than text.",[r("cellreference")]),ISNUMBER:n("This function tests whether a value, an expression, or contents of a referenced cell has numeric data.",[r("cellreference")]),ISODD:n("This function, Is Number Odd, tests whether a value, an expression, or contents of a referenced cell has numeric data.",[r("cellreference")]),ISPMT:n("This function calculates the interest paid during a specific period of an investment.",[r("rate"),r("per"),r("nper"),r("pv")]),ISREF:n("This function, Is Reference, tests whether a value, an expression, or contents of a referenced cell is a reference to another cell.",[r("cellreference")]),ISTEXT:n("This function tests whether a value, an expression, or contents of a referenced cell has text data.",[r("cellreference")]),KURT:n("This function returns the kurtosis of a data set.",[r("value1"),r("value2"),r("value3"),r("value4",!0)]),LARGE:n("This function returns the nth largest value in a data set, where n is specified.",[r("array"),r("n")]),LCM:n("This function returns the least common multiple of two numbers.",[r("number1"),r("number2")]),LEFT:n("This function returns the specified leftmost characters from a text value.",[r("mytext"),r("num_chars")]),LEN:n("This function returns the length of, the number of characters in, a text string.",[r("value")]),LINEST:n("This function calculates the statistics for a line.",[r("y"),r("x"),r("constant"),r("stats")]),LN:n("This function returns the natural logarithm of the specified number.",[r("value")]),LOG:n("This function returns the logarithm base Y of a number X.",[r("number"),r("base")]),LOG10:n("This function returns the logarithm base 10 of the number given.",[r("value")]),LOGEST:n("This function calculates an exponential curve that fits the data and returns an array of values that describes the curve.",[r("y"),r("x"),r("constant"),r("stats")]),LOGINV:n("This function returns the inverse of the lognormal cumulative distribution function of x, where LN(x) is normally distributed with the specified mean and standard deviation.",[r("prob"),r("mean"),r("stdev")]),LOGNORMDIST:n("This function returns the cumulative natural log normal distribution of x, where LN(x) is normally distributed with the specified mean and standard deviation. Analyze data that has been logarithmically transformed with this function.",[r("x"),r("mean"),r("stdev")]),LOOKUP:n("This function searches for a value and returns a value from the same location in a second area.",[r("lookupvalue"),r("lookupvector"),r("resultvector")]),LOWER:n("This function converts text to lower case letters.",[r("string")]),MATCH:n("This function returns the relative position of a specified item in a range.",[r("value1"),r("array"),r("type")]),MAX:n("This function returns the maximum value, the greatest value, of all the values in the arguments.",[r("value1"),r("value2",!0)]),MAXA:n("This function returns the largest value in a list of arguments, including text and logical values.",[r("value1"),r("value2",!0)]),MDETERM:n("This function returns the matrix determinant of an array.",[r("array")]),MDURATION:n("This function calculates the modified Macaulay duration of a security with an assumed par value of $100.",[r("settlement"),r("maturity"),r("coupon"),r("yield"),r("frequency"),r("basis")]),MEDIAN:n("This function returns the median, the number in the middle of the provided set of numbers; that is, half the numbers have values that are greater than the median, and half have values that are less than the median.",[r("value1"),r("value2",!0)]),MID:n("This function returns the requested number of characters from a text string starting at the position you specify.",[r("text"),r("start_num"),r("num_chars")]),MIN:n("This function returns the minimum value, the least value, of all the values in the arguments.",[r("value1"),r("value2",!0)]),MINA:n("This function returns the minimum value in a list of arguments, including text and logical values.",[r("value1"),r("value2",!0)]),MINUTE:n("This function returns the minute corresponding to a specified time.",[r("time")]),MINVERSE:n("This function returns the inverse matrix for the matrix stored in an array.",[r("array")]),MIRR:n("This function returns the modified internal rate of return for a series of periodic cash flows.",[r("arrayvals"),r("payment_int"),r("income_int")]),MMULT:n("This function returns the matrix product for two arrays.",[r("array1"),r("array2")]),MOD:n("This function returns the remainder of a division operation.",[r("dividend"),r("divisor")]),MODE:n("This function returns the most frequently occurring value in a set of data.",[r("value1"),r("value2",!0)]),MONTH:n("This function returns the month corresponding to the specified date value.",[r("date")]),MROUND:n("This function returns a number rounded to the desired multiple.",[r("number"),r("multiple")]),MULTINOMIAL:n("This function calculates the ratio of the factorial of a sum of values to the product of factorials.",[r("value1"),r("value2",!0)]),N:n("This function returns a value converted to a number.",[r("value")]),NA:n("This function returns the error value #N/A that means not available.",[]),NEGBINOMDIST:n("This function returns the negative binomial distribution.",[r("x"),r("r"),r("p")]),NETWORKDAYS:n("This function returns the total number of complete working days between the start and end dates.",[r("startdate"),r("enddate"),r("holidays")]),NOMINAL:n("This function returns the nominal annual interest rate for a given effective rate and number of compounding periods per year.",[r("effrate"),r("comper")]),NORMDIST:n("This function returns the normal cumulative distribution for the specified mean and standard deviation.",[r("x"),r("mean"),r("stdev"),r("cumulative")]),NORMINV:n("This function returns the inverse of the normal cumulative distribution for the given mean and standard deviation.",[r("prob"),r("mean"),r("stdev")]),NORMSDIST:n("This function returns the standard normal cumulative distribution function.",[r("value")]),NORMSINV:n("This function returns the inverse of the standard normal cumulative distribution. The distribution has a mean of zero and a standard deviation of one.",[r("prob")]),NOT:n("This function reverses the logical value of its argument.",[r("value")]),NOW:n("This function returns the current date and time.",[]),NPER:n("This function returns the number of periods for an investment based on a present value, future value, periodic payments, and a specified interest rate.",[r("rate"),r("paymt"),r("pval"),r("fval"),r("type")]),NPV:n("This function calculates the net present value of an investment by using a discount rate and a series of future payments and income.",[r("discount"),r("value1"),r("value2",!0)]),OCT2BIN:n("This function converts an octal number to a binary number.",[r("number"),r("places")]),OCT2DEC:n("This function converts an octal number to a decimal number.",[r("number")]),OCT2HEX:n("This function converts an octal number to a hexadecimal number.",[r("number"),r("places")]),ODD:n("This function rounds the specified value up to the nearest odd integer.",[r("value")]),ODDFPRICE:n("This function calculates the price per $100 face value of a security with an odd first period.",[r("settle"),r("maturity"),r("issue"),r("first"),r("rate"),r("yield"),r("redeem"),r("freq"),r("basis")]),ODDFYIELD:n("This function calculates the yield of a security with an odd first period.",[r("settle"),r("maturity"),r("issue"),r("first"),r("rate"),r("price"),r("redeem"),r("freq"),r("basis")]),ODDLPRICE:n("This function calculates the price per $100 face value of a security with an odd last coupon period.",[r("settle"),r("maturity"),r("last"),r("rate"),r("yield"),r("redeem"),r("freq"),r("basis")]),ODDLYIELD:n("This function calculates the yield of a security with an odd last period.",[r("settle"),r("maturity"),r("last"),r("rate"),r("price"),r("redeem"),r("freq"),r("basis")]),OFFSET:n("This function returns a reference to a range. The range is a specified number of rows and columns from a cell or range of cells. The function returns a single cell or a range of cells.",[r("reference"),r("rows"),r("cols"),r("height"),r("width")]),OR:n("This function calculates logical OR. It returns TRUE if any of its arguments are true; otherwise, returns FALSE if all arguments are false.",[r("argument1"),r("argument2...")]),PEARSON:n("This function returns the Pearson product moment correlation coefficient, a dimensionless index between -1.0 to 1.0 inclusive indicative of the linear relationship of two data sets.",[r("array_ind"),r("array_dep")]),PERCENTILE:n("This function returns the nth percentile of values in a range.",[r("array"),r("n")]),PERCENTRANK:n("This function returns the rank of a value in a data set as a percentage of the data set.",[r("array"),r("n"),r("sigdig")]),PERMUT:n("This function returns the number of possible permutations for a specified number of items.",[r("k"),r("n")]),PI:n("This function returns PI as 3.1415926536.",[]),PMT:n("This function returns the payment amount for a loan given the present value, specified interest rate, and number of terms.",[r("rate"),r("nper"),r("pval"),r("fval"),r("type")]),POISSON:n("This function returns the Poisson distribution.",[r("nevents"),r("mean"),r("cumulative")]),POWER:n("This function raises the specified number to the specified power.",[r("number"),r("power")]),PPMT:n("This function returns the amount of payment of principal for a loan given the present value, specified interest rate, and number of terms.",[r("rate"),r("per"),r("nper"),r("pval"),r("fval"),r("type")]),PRICE:n("This function calculates the price per $100 face value of a periodic interest security",[r("settlement"),r("maturity"),r("rate"),r("yield"),r("redeem"),r("frequency"),r("basis")]),PRICEDISC:n("This function returns the price per $100 face value of a discounted security.",[r("settle"),r("mature"),r("discount"),r("redeem"),r("basis")]),PRICEMAT:n("This function returns the price at maturity per $100 face value of a security that pays interest.",[r("settle"),r("mature"),r("issue"),r("rate"),r("yield"),r("basis")]),PROB:n("This function returns the probability that values in a range are between two limits.",[r("array"),r("probs"),r("lower"),r("upper")]),PRODUCT:n("This function multiplies all the arguments and returns the product.",[r("value1"),r("value2",!0)]),PROPER:n("This function capitalizes the first letter in each word of a text string.",[r("text")]),PV:n("This function returns the present value of an investment based on the interest rate, number and amount of periodic payments, and future value. The present value is the total amount that a series of future payments is worth now.",[r("rate"),r("numper"),r("paymt"),r("fval"),r("type")]),QUARTILE:n("This function returns which quartile (which quarter or 25 percent) of a data set a value is.",[r("array"),r("quart")]),QUOTIENT:n("This function returns the integer portion of a division. Use this to ignore the remainder of a division.",[r("numerator"),r("denominator")]),RADIANS:n("This function converts the specified number from degrees to radians.",[r("value")]),RAND:n("This function returns an evenly distributed random number between 0 and 1.",[]),RANDBETWEEN:n("This function returns a random number between the numbers you specify.",[r("lower"),r("upper")]),RANK:n("This function returns the rank of a number in a set of numbers. If you were to sort the set, the rank of the number would be its position in the list.",[r("number"),r("array"),r("order")]),RATE:n("This function returns the interest rate per period of an annuity.",[r("nper"),r("pmt"),r("pval"),r("fval"),r("type"),r("guess")]),RECEIVED:n("This function returns the amount received at maturity for a fully invested security.",[r("settle"),r("mature"),r("invest"),r("discount"),r("basis")]),REPLACE:n("This function replaces part of a text string with a different text string.",[r("old_text"),r("start_char"),r("num_chars"),r("new_text")]),REPT:n("This function repeats text a specified number of times.",[r("text"),r("number")]),RIGHT:n("This function returns the specified rightmost characters from a text value.",[r("text"),r("num_chars")]),ROMAN:n("This function converts an Arabic numeral to a Roman numeral text equivalent.",[r("number"),r("style")]),ROUND:n("This function rounds the specified value to the nearest number, using the specified number of decimal places.",[r("value"),r("places")]),ROUNDDOWN:n("This function rounds the specified number down to the nearest number, using the specified number of decimal places.",[r("value"),r("places")]),ROUNDUP:n("This function rounds the specified number up to the nearest number, using the specified number of decimal places.",[r("value"),r("places")]),ROW:n("This function returns the number of a row from a reference.",[r("reference")]),ROWS:n("This function returns the number of rows in an array.",[r("array")]),RSQ:n("This function returns the square of the Pearson product moment correlation coefficient (R‑squared) through data points in known y’s and known x’s.",[r("array_dep"),r("array_ind")]),SEARCH:n("This function finds one text string in another text string and returns the index of the starting position of the found text.",[r("string1"),r("string2")]),SECOND:n("This function returns the seconds (0 to 59) value for a specified time.",[r("time")]),SERIESSUM:n("This function returns the sum of a power series.",[r("x"),r("n"),r("m"),r("coeff")]),SIGN:n("This function returns the sign of a number or expression.",[r("cellreference")]),SIN:n("This function returns the sine of the specified angle.",[r("angle")]),SINH:n("This function returns the hyperbolic sine of the specified number.",[r("value")]),SKEW:n("This function returns the skewness of a distribution.",[r("number1"),r("number2",!0)]),SLN:n("This function returns the straight-line depreciation of an asset for one period.",[r("cost"),r("salvage"),r("life")]),SLOPE:n("This function calculates the slope of a linear regression.",[r("array_dep"),r("array_ind")]),SMALL:n("This function returns the nth smallest value in a data set, where n is specified.",[r("array"),r("n")]),SQRT:n("This function returns the positive square root of the specified number.",[r("value")]),SQRTPI:n("This function returns the positive square root of a multiple of pi (p).",[r("multiple")]),STANDARDIZE:n("This function returns a normalized value from a distribution characterized by mean and standard deviation.",[r("x"),r("mean"),r("stdev")]),STDEVA:n("This function returns the standard deviation for a set of numbers, text, or logical values.",[r("value1"),r("value2",!0)]),STDEVP:n("This function returns the standard deviation for an entire specified population (of numeric values).",[r("value1"),r("value2",!0)]),STDEVPA:n("This function returns the standard deviation for an entire specified population, including text or logical values as well as numeric values.",[r("value1"),r("value2",!0)]),STEYX:n("This function returns the standard error of the predicted y value for each x. The standard error is a measure of the amount of error in the prediction of y for a value of x.",[r("array_dep"),r("array_ind")]),SUBSTITUTE:n("This function substitutes a new string for specified characters in an existing string.",[r("text"),r("old_piece"),r("new_piece"),r("instance")]),SUBTOTAL:n("This function calculates a subtotal of a list of numbers using a specified built-in function.",[r("functioncode"),r("value1"),r("value2",!0)]),SUM:n("This function returns the sum of cells or range of cells.",[r("value1"),r("value2",!0)]),SUMIF:n("This function adds the cells using a given criteria.",[r("array"),r("condition"),r("sumrange")]),SUMIFS:n("This function adds the cells in a range using multiple criteria.",[r("array"),r("conditionarray"),r("condition",!0)]),SUMPRODUCT:n("This function returns the sum of products of cells. Multiplies corresponding components in the given arrays, and returns the sum of those products.",[r("array1"),r("array2",!0)]),SUMSQ:n("This function returns the sum of the squares of the arguments.",[r("value1"),r("value2",!0)]),SUMX2MY2:n("This function returns the sum of the difference of the squares of corresponding values in two arrays.",[r("array_x"),r("array_y")]),SUMX2PY2:n("This function returns the sum of the sum of squares of corresponding values in two arrays.",[r("array_x"),r("array_y")]),SUMXMY2:n("This function returns the sum of the square of the differences of corresponding values in two arrays.",[r("array_x"),r("array_y")]),SYD:n("This function returns the sum-of-years’ digits depreciation of an asset for a specified period.",[r("cost"),r("salvage"),r("life"),r("period")]),T:n("This function returns the text in a specified cell.",[r("value")]),TAN:n("This function returns the tangent of the specified angle.",[r("angle")]),TANH:n("This function returns the hyperbolic tangent of the specified number.",[r("value")]),TBILLEQ:n("This function returns the equivalent yield for a Treasury bill (or T-bill)",[r("settle"),r("mature"),r("discount")]),TBILLPRICE:n("This function returns the price per $100 face value for a Treasury bill (or T-bill).",[r("settle"),r("mature"),r("discount")]),TBILLYIELD:n("This function returns the yield for a Treasury bill (or T-bill).",[r("settle"),r("mature"),r("priceper")]),TDIST:n("This function returns the probability for the t-distribution.",[r("x"),r("deg"),r("tails")]),TEXT:n("This function formats a number and converts it to text.",[r("value"),r("text")]),TIME:n("This function returns the TimeSpan object for a specified time.",[r("hour"),r("minutes"),r("seconds")]),TIMEVALUE:n("This function returns the TimeSpan object of the time represented by a text string.",[r("time_string")]),TINV:n("This function returns the t-value of the student's t-distribution as a function of the probability and the degrees of freedom.",[r("prog"),r("deg")]),TODAY:n("This function returns the date and time of the current date.",[]),TRANSPOSE:n("This function returns a vertical range of cells as a horizontal range or a horizontal range of cells as a vertical range.",[r("array")]),TREND:n("This function returns values along a linear trend. This function fits a straight line to the arrays known x and y values. Trend returns the y values along that line for the array of specified new x values.",[r("y"),r("x"),r("newx"),r("constant")]),TRIM:n("This function removes extra spaces from a string and leaves single spaces between words.",[r("text")]),TRIMMEAN:n("This function returns the mean of a subset of data excluding the top and bottom data.",[r("array"),r("percent")]),TRUE:n("This function returns the value for logical TRUE.",[]),TRUNC:n("This function removes the specified fractional part of the specified number.",[r("value"),r("precision")]),TTEST:n("This function returns the probability associated with a t-test.",[r("array1"),r("array2"),r("tails"),r("type")]),TYPE:n("This function returns the type of value.",[r("value")]),UPPER:n("This function converts text to uppercase letters.",[r("string")]),VALUE:n("This function converts a text string that is a number to a numeric value.",[r("text")]),VAR:n("This function returns the variance based on a sample of a population, which uses only numeric values.",[r("value1"),r("value2",!0)]),VARA:n("This function returns the variance based on a sample of a population, which includes numeric, logical, or text values.",[r("value1"),r("value2",!0)]),VARP:n("This function returns variance based on the entire population, which uses only numeric values.",[r("value1"),r("value2",!0)]),VARPA:n("This function returns variance based on the entire population, which includes numeric, logical, or text values.",[r("value1"),r("value2",!0)]),VDB:n("This function returns the depreciation of an asset for any period you specify using the variable declining balance method.",[r("cost"),r("salvage"),r("life"),r("start"),r("end"),r("factor"),r("switchnot")]),VLOOKUP:n("This function searches for a value in the leftmost column and returns a value in the same row from a column you specify.",[r("value"),r("array"),r("colindex"),r("approx")]),WEEKDAY:n("This function returns the number corresponding to the day of the week for a specified date.",[r("date"),r("type")]),WEEKNUM:n("This function returns a number that indicates the week of the year numerically.",[r("date"),r("weektype")]),WEIBULL:n("This function returns the two-parameter Weibull distribution, often used in reliability analysis.",[r("x"),r("alpha"),r("beta"),r("cumulative")]),WORKDAY:n("This function returns the number of working days before or after the starting date.",[r("startdate"),r("numdays"),r("holidays")]),XIRR:n("This function calculates the internal rate of return for a schedule of cash flows that may not be periodic.",[r("values"),r("dates"),r("guess")]),XNPV:n("This function calculates the net present value for a schedule of cash flows that may not be periodic.",[r("rate"),r("values"),r("dates")]),YEAR:n("This function returns the year as an integer for a specified date.",[r("date")]),YEARFRAC:n("This function returns the fraction of the year represented by the number of whole days between the start and end dates.",[r("startdate"),r("enddate"),r("basis")]),YIELD:n("This function calculates the yield on a security that pays periodic interest.",[r("settle"),r("maturity"),r("rate"),r("price"),r("redeem"),r("frequency"),r("basis")]),YIELDDISC:n("This function calculates the annual yield for a discounted security.",[r("settle"),r("maturity"),r("price"),r("redeem"),r("basis")]),YIELDMAT:n("This function calculates the annual yield of a security that pays interest at maturity.",[r("settle"),r("maturity"),r("issue"),r("issrate"),r("price"),r("basis")]),ZTEST:n("This function returns the significance value of a z-test. The z-test generates a standard score for x with respect to the set of data and returns the two-tailed probability for the normal distribution.",[r("array"),r("x"),r("sigma")]),HBARSPARKLINE:n("This function returns a data set used for representing a Hbar sparkline",[r("value"),r("colorScheme")]),VBARSPARKLINE:n("This function returns a data set used for representing a Vbar sparkline",[r("value"),r("colorScheme")]),VARISPARKLINE:n("This function returns a data set used for representing a variance sparkline",[r("variance"),r("reference"),r("mini"),r("maxi"),r("mark"),r("tickunit"),r("legend"),r("colorPositive"),r("colorNegative"),r("vertical")]),PIESPARKLINE:n("This function returns a data set used for representing a pie sparkline",[r("range|percentage"),r("color",!0)]),AREASPARKLINE:n("This function returns a data set used for representing a area sparkline",[r("points"),r("mini"),r("maxi"),r("line1"),r("line2"),r("colorPositive"),r("colorNegative")]),SCATTERSPARKLINE:n("This function returns a data set used for representing a scatter sparkline",[r("points1"),r("points2"),r("minX"),r("maxX"),r("minY"),r("maxY"),r("hLine"),r("vLine"),r("xMinZone"),r("xMaxZone"),r("yMinZone"),r("yMaxZone"),r("tags"),r("drawSymbol"),r("drawLines"),r("color1"),r("color2"),r("dash")]),LINESPARKLINE:n("This function returns a data set used for representing a line sparkline",[r("data"),r("dataOrientation"),r("dateAxisData"),r("dateAxisOrientation"),r("setting")]),COLUMNSPARKLINE:n("This function returns a data set used for representing a column sparkline",[r("data"),r("dataOrientation"),r("dateAxisData"),r("dateAxisOrientation"),r("setting")]),WINLOSSSPARKLINE:n("This function returns a data set used for representing a win/loss sparkline",[r("data"),r("dataOrientation"),r("dateAxisData"),r("dateAxisOrientation"),r("setting")]),BULLETSPARKLINE:n("This function returns a data set used for representing a bullet sparkline",[r("measure"),r("target"),r("maxi"),r("good"),r("bad"),r("forecast"),r("tickunit"),r("colorScheme"),r("vertical")]),SPREADSPARKLINE:n("This function returns a data set used for representing a spread sparkline",[r("points"),r("showAverage"),r("scaleStart"),r("scaleEnd"),r("style"),r("colorScheme"),r("vertical")]),STACKEDSPARKLINE:n("This function returns a data set used for representing a stacked sparkline",[r("points"),r("colorRange"),r("labelRange"),r("maximum"),r("targetRed"),r("targetGreen"),r("targetBlue"),r("tragetYellow"),r("color"),r("highlightPosition"),r("vertical"),r("textOrientation"),r("textSize")]),BOXPLOTSPARKLINE:n("This function returns a data set used for representing a boxplot sparkline",[r("points"),r("boxPlotClass"),r("showAverage"),r("scaleStart"),r("scaleEnd"),r("acceptableStart"),r("acceptableEnd"),r("colorScheme"),r("style"),r("vertical")]),CASCADESPARKLINE:n("This function returns a data set used for representing a cascade sparkline",[r("pointsRange"),r("pointIndex"),r("labelsRange"),r("minimum"),r("maximum"),r("colorPositive"),r("colorNegative"),r("vertical")]),PARETOSPARKLINE:n("This function returns a data set used for representing a pareto sparkline",[r("points"),r("pointIndex"),r("colorRange"),r("target"),r("target2"),r("highlightPosition"),r("label"),r("vertical")]),MONTHSPARKLINE:n("This function returns a data set used for representing a month sparkline",[r("year"),r("month"),r("dataRange"),r("emptyColor"),r("startColor"),r("middleColor"),r("endColor")]),YEARSPARKLINE:n("This function returns a data set used for representing a year sparkline",[r("year"),r("dataRange"),r("emptyColor"),r("startColor"),r("middleColor"),r("endColor")]),"CEILING.PRECISE":n("This function rounds a number up to the nearest integer or to the nearest multiple of a specified value.",[r("number"),r("signif")]),"COVARIANCE.S":n("This function returns the sample covariance, which is the average of the products of deviations for each data point pair in two sets of numbers.",[r("array1"),r("array2")]),"FLOOR.PRECISE":n("This function rounds a number down to the nearest integer or to the nearest multiple of a specified value.",[r("number"),r("signif")]),"PERCENTILE.EXC":n("This function returns the nth percentile of values in a range.",[r("array"),r("n")]),"QUARTILE.EXC":n("This function returns which quartile (which quarter or 25 percent) of a data set a value is.",[r("array"),r("quart")]),"RANK.AVG":n("This function returns the rank of a number in a set of numbers. If some values have the same rank, it will return the average rank.",[r("number"),r("array"),r("order")]),"MODE.MULT":n("This function returns the most frequently occurring vertical array or the most frequently occurring value in a set of data.",[r("number1"),r("number2",!0)]),"STDEV.P":n("This function returns the standard deviation for an entire specified population (of numeric values).",[r("value1"),r("value2",!0)]),"VAR.P":n("This function returns variance based on the entire population, which uses only numeric values.",[r("value1"),r("value2",!0)]),"COVARIANCE.P":n("This function returns the covariance, which is the average of the products of deviations for each data point pair in two sets of numbers.",[r("array1"),r("array2")]),"MODE.SNGL":n("This function returns the most frequently occurring value in a set of data.",[r("value1"),r("value2",!0)]),"PERCENTILE.INC":n("This function returns the nth percentile of values in a range.",[r("array"),r("n")]),"QUARTILE.INC":n("This function returns which quartile (which quarter or 25 percent) of a data set a value is.",[r("array"),r("quart")]),"RANK.EQ":n("This function returns the rank of a number in a set of numbers. If you were to sort the set, the rank of the number would be its position in the list.",[r("number"),r("array"),r("order")]),STDEV:n("This function returns standard deviation is estimated based on a sample.",[r("number1"),r("number2",!0)]),"STDEV.S":n("This function returns standard deviation is estimated based on a sample.",[r("number1"),r("number2",!0)]),"VAR.S":n("This function returns the variance based on a sample of a population, which uses only numeric values.",[r("value1"),r("value2",!0)]),"BETA.INV":n("This function calculates the inverse of the cumulative beta distribution function.",[r("prob"),r("alpha"),r("beta"),r("lower"),r("upper")]),"BINOM.DIST":n("This function calculates the individual term binomial distribution probability.",[r("x"),r("n"),r("p"),r("cumulative")]),"BINOM.INV":n("This function returns the criterion binomial, the smallest value for which the cumulative binomial distribution is greater than or equal to a criterion value.",[r("n"),r("p"),r("alpha")]),"CHISQ.DIST.RT":n("This function calculates the one-tailed probability of the chi-squared distribution.",[r("value"),r("deg")]),"CHISQ.INV.RT":n("This function calculates the inverse of the one-tailed probability of the chi-squared distribution.",[r("prob"),r("deg")]),"CHISQ.TEST":n("This function calculates the test for independence from the chi-squared distribution.",[r("obs_array"),r("exp_array")]),"CONFIDENCE.NORM":n("This function returns confidence interval for a population mean.",[r("alpha"),r("stdev"),r("size")]),"EXPON.DIST":n("This function returns the exponential distribution or the probability density.",[r("value"),r("lambda"),r("cumulative")]),"F.DIST.RT":n("This function calculates the F probability distribution, to see degrees of diversity between two sets of data.",[r("value"),r("degnum"),r("degden")]),"F.INV.RT":n("This function returns the inverse of the F probability distribution.",[r("p"),r("degnum"),r("degden")]),"F.TEST":n("This function returns the result of an F-test, which returns the one-tailed probability that the variances in two arrays are not significantly different.",[r("array1"),r("array2")]),"GAMMA.DIST":n("This function returns the gamma distribution.",[r("x"),r("alpha"),r("beta"),r("cumulative")]),"GAMMA.INV":n("This function returns the inverse of the gamma cumulative distribution.",[r("p"),r("alpha"),r("beta")]),"LOGNORM.INV":n("This function returns the inverse of the lognormal cumulative distribution function of x, where LN(x) is normally distributed with the specified mean and standard deviation.",[r("prob"),r("mean"),r("stdev")]),"NORM.DIST":n("This function returns the normal cumulative distribution for the specified mean and standard deviation.",[r("x"),r("mean"),r("stdev"),r("cumulative")]),"NORM.INV":n("This function returns the inverse of the normal cumulative distribution for the given mean and standard deviation.",[r("prob"),r("mean"),r("stdev")]),"NORM.S.INV":n("This function returns the inverse of the standard normal cumulative distribution. The distribution has a mean of zero and a standard deviation of one.",[r("prob")]),"PERCENTRANK.INC":n("This function returns the rank of a value in a data set as a percentage of the data set.",[r("array"),r("n"),r("signif")]),"POISSON.DIST":n("This function returns the Poisson distribution.",[r("nevents"),r("mean"),r("cumulative")]),"T.INV.2T":n("This function returns the t-value of the student's t-distribution as a function of the probability and the degrees of freedom.",[r("prog"),r("deg")]),"T.TEST":n("This function returns the probability associated with a t-test.",[r("array1"),r("array2"),r("tails"),r("type")]),"WEIBULL.DIST":n("This function returns the two-parameter Weibull distribution, often used in reliability analysis.",[r("x"),r("alpha"),r("beta"),r("cumulative")]),"Z.TEST":n("This function returns the significance value of a z-test. The z-test generates a standard score for x with respect to the set of data and returns the two-tailed probability for the normal distribution.",[r("array"),r("x"),r("sigma")]),"T.DIST.RT":n("This function returns the right-tailed t-distribution.",[r("x"),r("deg")]),"T.DIST.2T":n("This function returns the two-tailed t-distribution.",[r("x"),r("deg")]),"ISO.CEILING":n("This function returns a number up to the nearest integer or to the nearest multiple of significance, regardless of sign of significance.",[r("number"),r("signif")]),"BETA.DIST":n("This function returns the beta distribution.",[r("x"),r("alpha"),r("beta"),r("cumulative"),r("lower"),r("upper")]),"GAMMALN.PRECISE":n("This function returns the natural logarithm of the gamma function.",[r("value")]),"ERF.PRECISE":n("This function returns the error function.",[r("lowerlimit")]),"ERFC.PRECISE":n("This function returns the complementary ERF function.",[r("lowerlimit")]),"PERCENTRANK.EXC":n("This function returns the percentage rank(0..1, exclusive) of a value in a data set.",[r("array"),r("n"),r("signif")]),"HYPGEOM.DIST":n("This function returns the hypergeometric distribution.",[r("x"),r("n"),r("M"),r("N"),r("cumulative")]),"LOGNORM.DIST":n("This function returns the log normal distribution of x.",[r("x"),r("mean"),r("stdev"),r("cumulative")]),"NEGBINOM.DIST":n("This function returns the negative binomial distribution.",[r("x"),r("r"),r("p"),r("cumulative")]),"NORM.S.DIST":n("This function returns the standard normal distribution.",[r("z"),r("cumulative")]),"T.DIST":n("This function returns the t-distribution.",[r("x"),r("deg"),r("cumulative")]),"F.DIST":n("This function returns the F probability distribution.",[r("x"),r("degnum"),r("degden"),r("cumulative")]),"CHISQ.DIST":n("This function returns the chi-squared distribution.",[r("x"),r("deg"),r("cumulative")]),"F.INV":n("This function returns the inverse of the F probability distribution.",[r("probability"),r("degnum"),r("degden")]),"T.INV":n("This function returns the left-tailed inverse of the t-distribution.",[r("probability"),r("deg")]),"CHISQ.INV":n("This function returns the inverse of left-tailed probability of the chi-squared distribution.",[r("probability"),r("deg")]),"CONFIDENCE.T":n("This function returns the confidence interval for a Student's t distribution.",[r("alpha"),r("stdev"),r("size")]),"NETWORKDAYS.INTL":n("This function returns the number of workdays between two dates using arguments to indicate holidays and weekend days.",[r("startdate"),r("enddate"),r("weekend"),r("holidays")]),"WORKDAY.INTL":n("This function returns the serial number of the date before or after a number of workdays with custom weekend parameters. These parameters indicate weekend days and holidays.",[r("startdate"),r("numdays"),r("weekend"),r("holidays")]),REFRESH:n("This function decides how to re-calculate the formula. Can use the evaluateMode argument to specific the formula re-calculate on the reference value changed, evaluate once or re-calculate on interval.",[r("formula"),r("evaluateMode"),r("interval")])}}},function(e,t,n){function r(e,t,n,r){var o=this,i=o._sparklineGroupManager;o._getModel().setValueForKey(e,t,D,r),r&&i.add(r.group()),o._raiseCellChanged("sparkline",e,t,3,n,r)}function o(e,t){this._groups=[],this._sheet=e,this.evaluator=t}function i(e,t,n){return n?e>n.row+n.rowCount-1?n:e>n.row?C(n.row,n.col,n.rowCount+t,n.colCount):C(n.row+t,n.col,n.rowCount,n.colCount):k}function a(e,t,n){return n?e>n.col+n.colCount-1?n:e>n.col?C(n.row,n.col,n.rowCount,n.colCount+t):C(n.row,n.col+t,n.rowCount,n.colCount):k}function s(e,t,n,r){for(var o=0;o<e.length;o++){var s=e[o],l=s._innerList;if(s.displayDateAxis){var u,c=s.dateAxisData();u=r?i(t,n,c):a(t,n,c),s.dateAxisData(u)}for(var f=0;f<l.length;f++){var d,p=l[f],h=p.data();r?(t<=p.row&&(p.row+=n),d=i(t,n,h)):(t<=p.column&&(p.column+=n),d=a(t,n,h)),p.data(d)}}}function l(e,t,n){var r=c(n.col,n.col+n.colCount-1,e,e+t-1);return r?C(n.row,r.start,n.rowCount,r.end-r.start+1):k}function u(e,t,n){var r=c(n.row,n.row+n.rowCount-1,e,e+t-1);return r?C(r.start,n.col,r.end-r.start+1,n.colCount):k}function c(e,t,n,r){var o,i,a=-1;if(r<e){var s=r-n+1;return a=e-s,o=t-s,{start:a,end:o}}if(n>t)return a=e,o=t,{start:a,end:o};if(n<=e){var l=t-e+1,u=0;for(i=e;i<=r&&i<=t;i++)u++;return a=n,o=a+l-u-1,{start:a,end:o}}var c=0;for(i=e;i<=t;i++)-1===a&&(i<n||i>r)&&(a=i),(i<n||i>r)&&c++;return-1!==a&&c>0?(o=a+c-1,{start:a,end:o}):k}function f(e,t,n,r){for(var o=0;o<e.length;o++){var i=e[o];if(i.displayDateAxis){var a,s=i.dateAxisData();if(a=r?u(t,n,s):l(t,n,s),S(a)){i.clear(),T(e,i);continue}i.dateAxisData(a)}var c=[];c=c.concat(i._innerList);for(var f=0;f<c.length;f++){var d=c[f],p=r?d.row:d.column;if(p>=t&&p<t+n)i.remove(d);else{t<=p&&(r?d.row-=n:d.column-=n);var h,m=d.data();h=r?u(t,n,m):l(t,n,m),S(h)?i.remove(d):d.data(h)}}i.count()<=0&&T(e,i)}}function d(e){var t=this;t.options={};for(var n in H)H.hasOwnProperty(n)&&(t.options[n]=e&&e[n]?e[n]:H[n]);t._worksheet=k}function p(e,t){var n=this;n.displayDateAxis=!1,n._sparklineGroupManager=k,n._innerList=[],n._axisReference=k,n._axisOrientation=1,n.setting=t,n.sparklineType=e}function h(e,t,n,r,o,i){var a=this;a.row=e,a.column=t,a._dataOrientation=r,a._data=n,a._group=new p(o,i),a._group.add(a)}var m=n(1),g=n(0),_=n(28),t={},v=m.GC$,y=v.isEmptyObject,b=m.Worksheet,w=m._SheetModel,C=m._createRange,S=g._Types._isNullOrUndefined,x=g._ArrayHelper,T=x._remove,E=x._contains,M=_.__invalidValuePlaceHolder,A=_.SparklineRender,k=null,R=void 0,I=Math.max,O=Number.MAX_VALUE,D="sparkline",P={init:function(){var e=this;e._sparklineGroupManager=new o(e,e)},dispose:function(e){!1!==e&&(this._sparklineGroupManager=k)},onLayoutChanged:function(e){var t=e.changeType,n=e.row,r=e.rowCount,o=e.col,i=e.colCount,a=this._sparklineGroupManager;if("addRows"===t)a._onRowsAdded(n,r);else if("deleteRows"===t)a._onRowsRemoved(n,r);else if("addColumns"===t)a._onColumnsAdded(o,i);else if("deleteColumns"===t)a._onColumnsRemoved(o,i);else if("clear"===t){var s=e.type;3===e.sheetArea&&16==(16&s)&&a.clear(n,o,r,i)}},toJson:function(e){e.sparklineGroups=this._sparklineGroupManager.toJSON()},fromJson:function(e,t){var n=this,r=n._sparklineGroupManager,o=e.sparklineGroupManager,i=t?o&&o.groups:e.sparklineGroups;if(i){r.fromJSON(i,t);for(var a,s,l=r.groups(),u=n._getModel(),c=0;c<l.length;c++){a=l[c]._innerList;for(var f=0;f<a.length;f++)s=a[f],u.setValueForKey(s.row,s.column,D,s)}}}};b._registerFeature("sparkline",P);var N={getSparkline:function(e,t){return this._sparklineGroupManager?this._getModel().getValueForKey(e,t,D):k},setSparkline:function(e,t,n,o,i,a,s,l){var u=this;if(!u._sparklineGroupManager)return k;var c=new h(e,t,n,o,i,a);s&&!S(l)&&(c.dateAxisData(s),c.dateAxisOrientation(l),c.group().displayDateAxis=!0);var f=u.getSparkline(e,t);return u.removeSparkline(e,t),r.call(u,e,t,f,c),u._invalidate(),c},removeSparkline:function(e,t){var n=this,o=n._sparklineGroupManager;if(o){var i=n.getSparkline(e,t);if(i){var a=i.group();a.remove(i),a.count()<=0&&o.remove(a),r.call(n,e,t,i,k)}n._invalidate()}},groupSparkline:function(e){var t=this._sparklineGroupManager;if(!t)return k;for(var n=k,r=0;r<e.length;r++){var o=e[r];if(o)if(n){var i=o.group();i.remove(o),n.add(o),i.count()<=0&&t.remove(i)}else n=o.group()}return this._invalidate(),n},ungroupSparkline:function(e){var t=this,n=t._sparklineGroupManager;if(n&&e){var r=[];r=r.concat(e._innerList);for(var o=0;o<r.length;o++){var i=r[o];if(i){e.remove(i);var a=e.clone();a.add(i),n.add(a)}}n.remove(e),t._invalidate()}}};v.extend(b.prototype,N),o.prototype={constructor:o,groups:function(e){if(0===arguments.length)return this._groups;this._groups=e},add:function(e){this.groups().push(e),e._sparklineGroupManager=this,e._adjustGroupMaxMinValue()},remove:function(e){T(this.groups(),e)},contains:function(e){return E(this.groups(),e)},count:function(){return this.groups().length},_onRowsAdded:function(e,t){s(this._groups,e,t,!0)},_onColumnsAdded:function(e,t){s(this._groups,e,t,!1)},_onRowsRemoved:function(e,t){f(this._groups,e,t,!0)},_onColumnsRemoved:function(e,t){f(this._groups,e,t,!1)},clear:function(e,t,n,r){var o=this;if(0===arguments.length){for(var i=o._groups,a=0;a<i.length;a++){var s=i[a];s&&(s.SparklineGroupManager=k)}o._groups=[]}else for(var l=e;l<e+n;l++)for(var u=t;u<t+r;u++){var c=o._find(l,u);if(c){var f=c.group();f.remove(c),0===f.count()&&o.remove(f)}}},_find:function(e,t){for(var n=this._groups,r=0;r<n.length;r++)for(var o=n[r],i=0;i<o.count();i++){var a=o[i];if(a&&a.row===e&&a.column===t)return a}return k},_copy:function(e,t,n,r,o,i,a){var s=this,l=s._sheet;if(l){var u,c,f=new w(o,i,k),d=n-e,p=r-t,h=l.getRowCount(),m=l.getColumnCount(),g=l._getModel();for(u=0;u<o;u++)if(!(a&&l._isRowFilterOut&&l._isRowFilterOut(n+u)))for(c=0;c<i;c++){var _=l.getSparkline(e+u,t+c);if(_){var v=_.clone();v.row=n+u,v.column=r+c;var y=v.dateAxisData();S(y)||s._canOffset(y,d,p,h,m)&&v.dateAxisData(y.offset(p,d));var b=v.data();S(b)||s._canOffset(b,d,p,h,m)&&v.data(b.offset(p,d)),s.add(v.group()),f.setValue(u,c,v)}}for(u=0;u<o;u++)if(!(a&&l._isRowFilterOut&&l._isRowFilterOut(n+u)))for(c=0;c<i;c++)g.setValueForKey(n+u,r+c,D,f.getValue(u,c))}},_canOffset:function(e,t,n,r,o){var i=this._getExpressionRange(e);if(i){var a=I(i.row,0),s=I(i.col,0),l=i.row<0?r:i.rowCount,u=i.col<0?o:i.colCount;return!(a+t<0||s+n<0||a+l+t>r||s+u+n>o)}return!1},_move:function(e,t,n,r,o,i){var a=this._sheet;if(a){this._moveDataRange(e,t,n,r,o,i);var s,l,u=a._getModel(),c=new w(o,i,k);for(s=0;s<o;s++)for(l=0;l<i;l++){var f=a.getSparkline(e+s,t+l);f&&(f.row=n+s,f.column=r+l,c.setValue(s,l,f)),u.setValueForKey(e+s,t+l,D,k)}for(s=0;s<o;s++)for(l=0;l<i;l++)u.setValueForKey(n+s,r+l,D,c.getValue(s,l))}},_moveDataRange:function(e,t,n,r,o,i){for(var a=this,s=C(e,t,o,i),l=n-e,u=r-t,c=a._groups,f=0;f<c.length;f++)for(var d=c[f],p=d._innerList,h=0;h<p.length;h++){var m=p[h];if(m){var g=m.dateAxisData(),_=a._getExpressionRange(g);_&&s.containsRange(_)&&s.contains(m.row,m.column)&&m.dateAxisData(g.offset(u,l));var v=m.data(),y=a._getExpressionRange(v);y&&s.containsRange(y)&&s.contains(m.row,m.column)&&m.data(v.offset(u,l))}}},_getExpressionRange:function(e){return e},_exCopy:function(e,t,n,r,o,i,a,s){var l=this,u=l._sheet;if(u){if(e===u)return void l._copy(t,n,r,o,i,a);for(var c=r-t,f=o-n,d=u._getModel(),p=u.getRowCount(),h=u.getColumnCount(),m=0;m<i;m++)if(!(s&&u._isRowFilterOut&&u._isRowFilterOut(r+m)))for(var g=0;g<a;g++){var _=e.getSparkline(t+m,n+g);if(_){var v=_.clone();v.row=r+m,v.column=o+g;var y=v.dateAxisData();S(y)||l._canOffset(y,c,f,p,h)&&v.dateAxisData(y.offset(f,c));var b=v.data();S(b)||l._canOffset(b,c,f,p,h)&&v.data(b.offset(f,c)),l.add(v.group()),d.setValueForKey(r+m,o+g,D,v)}else d.setValueForKey(r+m,o+g,D,k)}}},_exMove:function(e,t,n,r,o,i,a){var s=this,l=s._sheet;if(l){if(e===l)return void s._move(t,n,r,o,i,a);var u=e._getModel(),c=l._getModel();s._exMoveDataRange(e,t,n,r,o,i,a);for(var f=0;f<i;f++)for(var d=0;d<a;d++){var p=e.getSparkline(t+f,n+d);if(p){p.row=r+f,p.column=o+d;var h=p.group(),m=h.clone();h.remove(p),h.count()<=0&&e._sparklineGroupManager.remove(h),m.add(p),s.add(m),c.setValueForKey(r+f,o+d,D,p)}else c.setValueForKey(r+f,o+d,D,k);u.setValueForKey(t+f,n+d,D,k)}}},_exMoveDataRange:function(e,t,n,r,o,i,a){var s=this,l=s._sheet;if(e&&l){if(e===l)return void s._moveDataRange(t,n,r,o,i,a);for(var u=C(t,n,i,a),c=r-t,f=o-n,d=e._sparklineGroupManager._groups,p=0;p<d.length;p++)for(var h=d[p],m=0;m<h._innerList.length;m++){var g=h._innerList[m];if(g){var _=g.dateAxisData(),v=s._getExpressionRange(_);v&&u.containsRange(v)&&u.contains(g.row,g.column)&&g.dateAxisData(_.offset(f,c));var y=g.data(),b=s._getExpressionRange(y);b&&u.containsRange(b)&&u.contains(g.row,g.column)&&g.data(y.offset(f,c))}}}},toJSON:function(){for(var e=this._groups,t=[],n=0;e&&n<e.length;n++)t.push(e[n].toJSON());return 0===t.length?R:t},fromJSON:function(e,t){for(var n=0;e&&n<e.length;n++){var r=e[n],o=new p;o.fromJSON(r,t),this.add(o)}}},t.EmptyValueStyle={gaps:0,zero:1,connect:2},t.SparklineAxisMinMax={individual:0,group:1,custom:2};var F=g._ColorHelper._toString(255,149,179,215),L=g._ColorHelper._toString(255,36,64,98),H={axisColor:"black",firstMarkerColor:F,highMarkerColor:"Blue",lastMarkerColor:F,lowMarkerColor:"Blue",markersColor:L,negativeColor:"Brown",seriesColor:L,displayEmptyCellsAs:0,rightToLeft:!1,displayHidden:!1,displayXAxis:!1,showFirst:!1,showHigh:!1,showLast:!1,showLow:!1,showNegative:!1,showMarkers:!1,manualMax:0,manualMin:0,maxAxisType:0,minAxisType:0,lineWeight:1};d.prototype={constructor:d,clone:function(){return new d(this.options)},toJSON:function(){var e=this,t=e.options,n={};for(var r in t)H[r]!==t[r]&&(n[r]=t[r]);return y(n)?R:n}},t.SparklineSetting=d,t.SparklineType={line:0,column:1,winloss:2},t.DataOrientation={vertical:0,horizontal:1},p.prototype={constructor:p,add:function(e){var t=this;e&&(t._innerList.push(e),e.group(t),t._adjustGroupMaxMinValue(),t.onGroupChanged())},clear:function(){this._innerList=[]},remove:function(e){var t=this,n=t._innerList;return T(n,e),e.onSparklineChanged(),e._group=t.clone(),t._adjustGroupMaxMinValue(),t.onGroupChanged(),n},contains:function(e){return E(this._innerList,e)},onGroupChanged:function(){var e=this._innerList;if(e)for(var t=0;t<e.length;t++){var n=e[t];n&&n.onSparklineChanged()}},clone:function(){var e=this,t=e.setting?e.setting.clone():k,n=new p(e.sparklineType,t);return n.displayDateAxis=e.displayDateAxis,n._axisReference=e._axisReference,n._axisOrientation=e._axisOrientation,n},dateAxisData:function(e){var t=this;if(0===arguments.length)return t._axisReference;var n=t._axisReference;t._axisReference=e,n!==e&&t.onGroupChanged()},dateAxisOrientation:function(e){var t=this;if(0===arguments.length)return t._axisOrientation;var n=t._axisOrientation;t._axisOrientation=e,n!==e&&t.onGroupChanged()},count:function(){return this._innerList.length},_adjustGroupMaxMinValue:function(){var e=this,t=e.setting,n=e._innerList;if(t){var r=t.options;r.groupMaxValue=-O,r.groupMinValue=O;var o=1===r.maxAxisType,i=1===r.minAxisType;if(o||i)for(var a=0;a<n.length;a++){var s=n[a],l=e._getMaxMinValues(s),u=l.min,c=l.max;o&&r.groupMaxValue<c&&(r.groupMaxValue=c),i&&r.groupMinValue>u&&(r.groupMinValue=u)}}},_getMaxMinValues:function(e){var t=-O,n=O,r=e.data();if(r)for(var o=e._provideValues(r,e.dataOrientation(),!1),i=0;i<o.length;i++){var a=o[i];if(a===M&&(a=0),"number"==typeof a){var s=a;t=t<s?s:t,n=n>s?s:n}}return{min:n,max:t}},toJSON:function(){function e(e,t){var n=!1;return"setting"===e||"axisReference"===e?n=t===k:"displayDateAxis"===e?n=!1===t:"axisOrientation"===e?n=1===t:"sparklines"===e&&(n=0===t.length),n}var t=this,n={setting:t.setting?t.setting.toJSON():k,displayDateAxis:t.displayDateAxis,sparklineType:t.sparklineType,axisReference:t._axisReference,axisOrientation:t._axisOrientation,sparklines:t._innerList.map(function(e){return e.toJSON()})},r={};for(var o in n)if(n.hasOwnProperty(o)){var i=n[o];e(o,i)||(r[o]=i)}return y(r)?R:r},fromJSON:function(e,t){if(e){var n=this,r=e.displayDateAxis,o=e.sparklineType,i=e.axisReference,a=e.axisOrientation,s=e.sparklines;if(n.setting=new d(e.setting),S(r)||(n.displayDateAxis=r),S(o)||(n.sparklineType=o),S(i)||(n._axisReference=i),S(a)||(n._axisOrientation=a),s){n._innerList=[];for(var l=0,u=s.length;l<u;l++){var c=new h;c.fromJSON(s[l],t),n.add(c)}}}}},t.SparklineGroup=p,h.prototype={constructor:h,group:function(e){var t=this;if(0===arguments.length){var n=t._group;return n||(n=new p,n.add(t),t._group=n),n}var r=t._group;return e!==r&&(r&&r.remove(t),t._group=e,e&&(e.contains(t)||e.add(t)),t.onSparklineChanged()),t},sparklineType:function(e){var t=this;if(0===arguments.length)return t.group().sparklineType;var n=t.group();return n.sparklineType!==e&&(n.sparklineType=e,t.onSparklineChanged()),t},onSparklineChanged:function(){var e=this,t=e._getWorksheet();t&&t._trigger(m.Events.SparklineChanged,{sheet:t,sheetName:t._name,sparkline:e})},setting:function(e){var t=this,n=t.group();return 0===arguments.length?n.setting:(n.setting=e,t)},data:function(e){var t=this;return 0===arguments.length?t._data:(t._data!==e&&(t._data=e,t.onSparklineChanged()),t)},dataOrientation:function(e){var t=this;return 0===arguments.length?t._dataOrientation:(t._dataOrientation!==e&&(t._dataOrientation=e,t.onSparklineChanged()),t)},dateAxisData:function(e){var t=this,n=t.group();return 0===arguments.length?n.dateAxisData():(n.dateAxisData(e),t)},dateAxisOrientation:function(e){var t=this,n=t.group();return 0===arguments.length?n.dateAxisOrientation():(n.dateAxisOrientation(e),t)},displayDateAxis:function(e){var t=this,n=t.group();return 0===arguments.length?n.displayDateAxis:(n.displayDateAxis=e,t)},clone:function(){var e=this,t=new h;return t.row=e.row,t.column=e.column,t.data(e.data()),t.dataOrientation(e.dataOrientation()),t.group(e.group().clone()),t},paintSparkline:function(e,t,n,r,o){var i=this,a=i._getWorksheet(),s={sparklineType:i.sparklineType(),displayDateAxis:i.displayDateAxis(),zoomFactor:a._zoomFactor,values:i._provideValues(i.data(),i.dataOrientation()),dateValues:i._provideValues(i.dateAxisData(),i.dateAxisOrientation(),!0),settings:i.setting(),getColor:function(e){if(a&&e){var t=m._ThemeContext._getColor(a,e);if(t)return t}return e}};(new A).paint(e,s,t,n,r,o)},_provideValues:function(e,t,n){var r=this,o=r._getWorksheet(),i=r.setting().options.displayHidden;return h._provideValuesImp(R,o,i,e,t,n)},_getWorksheet:function(){var e=this.group(),t=e&&e._sparklineGroupManager;return t?t._sheet:k},toJSON:function(){var e=this;return{row:e.row,col:e.column,orientation:e._dataOrientation,data:e._data}},fromJSON:function(e){if(e){var t=this,n=e.row,r=e.col,o=e.orientation,i=e.data;if(S(n)||(t.row=n),S(r)||(t.column=r),S(o)||(t._dataOrientation=o),i){var a=i;t._data=C(a.row,a.col,a.rowCount,a.colCount)}}}},h._provideValuesImp=function(e,t,n,r,o,i){var a="number",s=[],l=1===o;if(t&&r)for(var u=0,c=l?r.colCount:r.rowCount;u<c;u++){var f=l?0:u,d=l?u:0,p=e?e[f][d]:t.getValue(r.row+f,r.col+d);!n&&(t.getRowHeight(r.row+f)<=0||t.getColumnWidth(r.col+d)<=0)?p=NaN:S(p)||(i?p=typeof p===a?g._DateTimeHelper._fromOADate(p):Date.parse(p):typeof p!==a&&(p=M)),s.push(p)}return s},t.Sparkline=h,e.exports=t},function(e,t,n){function r(e){var t=this;t._fromSheet=M,t._ranges=M,t._isCutting=!1,t._owner=e,t._element=t._createElement()}function o(e,t,n,r){if(!t.containsRange(e))return!0;for(var o=0;o<n.length;o++)if(e.row<=n[o]&&n[o]<e.row+e.rowCount)return!0;for(o=0;o<r.length;o++)if(e.col<=r[o]&&r[o]<e.col+e.colCount)return!0;return!1}function i(e,t){for(var n=[],r=0;r<e.rows.length;r++)for(var o=e.rows[r],i=n[r]||(n[r]=[]),a=0,s=0;a<o.cells.length;a++){for(var l=o.cells[a];i[s];)s++;var u=i[s]={};if(t){var c=_(l);u.style=c}u.text=l.innerText,u.rowSpan=l.rowSpan,u.colSpan=l.colSpan;for(var f=0;f<l.rowSpan;f++)for(var d=0;d<l.colSpan;d++)if(0!==f||0!==d){var p=n[r+f]||(n[r+f]=[]);p[s+d]={style:c,text:"",rowSpan:1,colSpan:1}}s+=l.colSpan}return n}function a(e){var t=[];if(e){var n=e.getElementsByTagName("table");if(n.length>0)for(var r=i(n[0],!1),o=0,a=r.length;o<a;o++){for(var s=r[o],l=0,u=s.length;l<u;l++){var c=s[l]?s[l].text:"";c.indexOf("\n")>=0&&(c='"'+c+'"'),t.push(c.trim()),l<u-1&&t.push("\t")}o<a-1&&t.push("\r\n")}else t.push(e.innerText)}return t.join("")}function s(e){var t=[];if(e){for(var n='"',r=!1,o=0;o<e.length;o++){var i=e[o];i===n?(r=!r,t.push(n)):r||"\n"!==i?t.push(i):t.push("\r\n")}return t.join("")}return""}function l(e){return{0:"left",1:"center",2:"right"}[e]}function u(e){return{0:"top",1:"middle",2:"bottom"}[e]}function c(e){return"1px "+{0:"none",1:"solid",2:"solid",3:"dashed",4:"dotted",5:"solid",6:"double",7:"dotted",8:"dashed",9:"dashed",10:"dashed",11:"dashed",12:"dashed",13:"dashed"}[e.style]+" "+e.color}function f(e){return{left:0,center:1,right:2}[e]}function d(e){return{top:0,middle:1,bottom:2}[e]}function p(e,t,n){return new T(e,{none:0,solid:n,dashed:8,dotted:4,double:6}[t])}function h(e){return{underline:1,"line-through":2,none:0}[e]}function m(e){return 0===y._ColorHelper._fromString(e).a}function g(e){var t=y._ColorHelper._fromString(e);return 0!==t.a&&0===t.r&&0===t.g&&0===t.b}function _(e){var t=e.getElementsByTagName("font")[0],n=getComputedStyle(e),r=new E,o=n.backgroundColor;o&&!m(o)&&(r.backColor=o);var i=n.color;if(t&&(i=t.color),i&&!g(i)&&(r.foreColor=i),t)r.font=w._buildFontString(getComputedStyle(t));else{var a=w._buildFontString(n);a&&(r.font=a)}var s=n.verticalAlign;s&&(r.vAlign=d(s));var l=n.textAlign;l&&(r.hAlign=f(l));var u=n.borderLeftStyle;"none"!==u&&(r.borderLeft=p(n.borderLeftColor,u,parseInt(n.borderLeftWidth)));var c=n.borderRightStyle;"none"!==c&&(r.borderRight=p(n.borderRightColor,c,parseInt(n.borderRightWidth)));var _=n.borderTopStyle;"none"!==_&&(r.borderTop=p(n.borderTopColor,_,parseInt(n.borderTopWidth)));var v=n.borderBottomStyle;"none"!==v&&(r.borderBottom=p(n.borderBottomColor,v,parseInt(n.borderBottomWidth)));var y=h(n.textDecoration);return e.getElementsByTagName("u").length>0&&(y|=h("underline")),e.getElementsByTagName("s").length>0&&(y|=h("line-through")),0!==y&&(r.textDecoration=y),r}var t=n(2),v=n(3),y=n(0),b=n(9),w=n(8)._StyleHelper,C=v._util._browser,S=y._Types._isNullOrUndefined,x=y._ArrayHelper._contains,T=b.LineBorder,E=b.Style,M=null;r.prototype={_createElement:function(){var e=document.createElement("div");e.style.position="fixed",e.style.top="0px",e.style.left="0px",e.style.width="0px",e.style.height="0px",e.style.overflow="hidden";var t=document.createElement("div");t.setAttribute("contenteditable","true"),t.setAttribute("gcUIElement","gcSheetClipboard"),t.setAttribute("tabindex",-1),t.style.position="absolute",t.style.overflow="hidden",t.style.background="white",t.style.webkitUserSelect="text",t.style.minHeight="20px",e.appendChild(t);var n=this,r=n._owner.getHost();return r&&r.appendChild(e),C.msie||C.edge||(n._pasteHandler=function(e){var t=n._owner.getActiveSheet(),r=e.clipboardData;if(r){var o=r.getData("text/html"),i=n._getMeasureContainer();i.innerHTML=o;var l;l=o?a(i):s(r.getData("text/plain")),i.innerHTML="",t._doClipboardPaste(l,o)}},t.addEventListener("paste",n._pasteHandler)),t},_dispose:function(){var e=this,t=e._element;if(t){C.msie||C.edge||t.removeEventListener("paste",e._pasteHandler);var n=t.parent;if(n){var r=n.parent;r&&r.removeChild(n)}e._element=M}var o=e._measureContainer;if(o){var i=o.parent;i&&i.removeChild(o),e._measureContainer=M}},_setClipboardHtml:function(e){this._element.innerHTML=e},_focus:function(){this._element.focus()},_select:function(){document.execCommand("selectAll")},_getClipboardHtml:function(){var e=this._element;if(e){var t=e.getElementsByTagName("table");if(t.length>0)return t[0].outerHTML}return""},_getClipboardText:function(){return a(this._element)},_getRangeHtml:function(e,t,n,r,i,a,s,f){var d=e._getActualRange(v._createRange(t,r,n,i));t=d.row,r=d.col,n=d.rowCount,i=d.colCount;var p=[];p.push("<table>");for(var h=0;h<n;h++){var m=t+h;if(!x(s,m)){p.push("<tr>");for(var g=0;g<i;g++){var _=r+g;if(!x(f,_)){if(a){var y=e.getSpan(m,_);if(y&&o(y,d,s,f)&&(y=M),y&&(y.row!==m||y.col!==_))continue}if(p.push("<td"),a){y&&(y.rowCount>1&&p.push(" rowSpan="+y.rowCount),y.colCount>1&&p.push(" colSpan="+y.colCount));var b=e.getActualStyle(m,_);p.push(' style="');var w=b.backColor;w&&p.push("background-color: "+w+";");var T=b.foreColor;T&&p.push("color: "+T+";");var E=b.font;E&&p.push("font: "+E.replace(/"/g,"'")+";");var A=b.vAlign;S(A)||p.push("vertical-align: "+u(A)+";");var k=b.hAlign;if(!S(k)){var R=l(k);R&&p.push("text-align: "+R+";")}var I=b.borderLeft;I&&p.push("border-left: "+c(I)+";");var O=b.borderRight;O&&p.push("border-right: "+c(O)+";");var D=b.borderTop;D&&p.push("border-top: "+c(D)+";");var P=b.borderBottom;P&&p.push("border-bottom: "+c(P)+";"),p.push('"')}if(p.push(">"),a){var N=b.textDecoration,F=2==(2&N),L=1==(1&N);F&&p.push("<s>"),L&&p.push("<u>")}var H=e.getText(m,_);H||(C.chrome?H=" ":C.safari&&(H="&nbsp;")),p.push(H),a&&(L&&p.push("</u>"),F&&p.push("</s>")),p.push("</td>")}}p.push("</tr>")}}return p.push("</table>"),p.join("")},_getMeasureContainer:function(){var e=this;if(!e._measureContainer){var t=document.createElement("div"),n=e._owner.getHost();n&&n.appendChild(t),e._measureContainer=t}return e._measureContainer},_setRangeHtml:function(e,t,n,r){var o=this._getMeasureContainer();o.innerHTML=e;var a=o.getElementsByTagName("table");if(a.length>0)for(var s=i(a[0],!0),l=0;l<s.length;l++)for(var u=s[l],c=n+l,f=0;f<u.length;f++){var d=u[f];if(d){var p=r+f;t.setStyle(c,p,d.style);var h=d.rowSpan,m=d.colSpan;if(h>1||m>1){var g=t.getSpan(c,p);g?(g.row=c,g.col=p,g.rowCount=h,g.colCount=m):t.addSpan(c,p,h,m)}}}o.innerHTML=""}},t._ClipboardHelper=r,e.exports=t},function(e,t,n){function r(e,t){var n=t+1;return e<0?e%n+n:e>t?e%n:e}function o(e){return new J(e)}function i(e,t,n,r,o,i,a){return 3===a||n>=0&&r>=0||1===a&&n>=0||2===a&&r>=0}function a(e,t,n,r){var o=j,i={_row:o,_col:o,_rowRelative:!0,_columnRelative:!0,_success:!1,_endIndex:0},a=t?l(e,n,r,0):s(e,0);if(a._isRow?(i._row=a._elementIndex,i._rowRelative=a._isRelative):(i._col=a._elementIndex,i._columnRelative=a._isRelative),i._endIndex=a._endIndex,i._success=a._success,!a._success||a._endIndex>=e.length)return i;if(!t&&a._isRow||t&&!a._isRow)return{_success:!1};var u=e[i._endIndex];if((t||!G(u)&&"$"!==u)&&(!t||"C"!==u&&"c"!==u))return{_success:!1};var c=t?l(e,n,r,i._endIndex):s(e,i._endIndex);return i._endIndex=c._endIndex,!c._success||!t&&!c._isRow||t&&c._isRow||i._endIndex<e.length?(i._success=!1,i):(t?(i._col=c._elementIndex,i._columnRelative=c._isRelative):(i._row=c._elementIndex,i._rowRelative=c._isRelative),i._success=!0,i)}function s(e,t){var n=j,r={_endIndex:t,_elementIndex:n,_isRow:!0,_isRelative:!0,_success:!1},o=e.length;if(t>=o)return r;if("$"===e[t]&&(r._isRelative=!1,t++),t>=o)return r;var i,a=t,s=e[a];if(G(s)&&"0"!==s){for(r._isRow=!0;a<o&&G(s);)++a<o&&(s=e[a]);if((i=parseInt(e.slice(t,a).join(""),10))<=H)return r._elementIndex=i-1,r._endIndex=a,r._success=!0,r}else if(K(s)){for(r._isRow=!1;a<o&&K(s);)++a<o&&(s=e[a]);var l=e.slice(t,a).join("");if(l.length>3)return r;l=l.toUpperCase(),i=0;for(var u=l.length-1,c=u;c>=0;c--)i+=(l.charCodeAt(c)-65+1)*B[u-c];if(i<=V)return r._elementIndex=i-1,r._endIndex=a,r._success=!0,r}return r}function l(e,t,n,r){var o=j,i={endIndex:r,elementIndex:o,isRow:!0,isRelative:!1,success:!1},a=e.length;if(r>=a)return i;var s,l=r,u=e[l];if("R"===u||"r"===u)i._isRow=!0,s=t;else{if("C"!==u&&"c"!==u)return i;i._isRow=!1,s=n}if(r++,l++,r>=a)return i._endIndex=r,i._elementIndex=s,i._isRelative=!0,i._success=!0,i;if(u=e[l],"["===u&&(r++,l++,i._isRelative=!0),r>=a)return i;var c=!1;if(u=e[l],i._isRelative&&"-"===u&&(r++,l++,c=!0),r>=a)return i;if(u=e[l],!G(u))return i._isRelative?i:(i._endIndex=r,i._elementIndex=s,i._isRelative=!0,i._success=!0,i);for(;l<a&&G(u);)++l<a&&(u=e[l]);var f=parseInt(e.slice(r,l).join(""),10);if(i._isRelative){if(l>=a||"]"!==e[l])return i;l++}return f<(i._isRow?H:V)?(i._isRelative?(f=c?-f:f,i._elementIndex=f+s):i._elementIndex=f-1,i._endIndex=l,i._success=!0,i):void 0}function u(e,t,n,r){var o=e.row,i=e.column;if(n.source===P.BangSource)r.push("!");else{if(n.source instanceof P.ErrorSource||n.endSource&&n.endSource instanceof P.ErrorSource)return void r.push("#REF!");n.source&&d(e,r,n.source,n.endSource)}8===n.type?r.push(n.value):n.value&&n._error?r.push(n.value.toString()):n._isCell?c(e.useR1C1,o,i,n.row,n.column,n.rowRelative,n.columnRelative,r):f(e.useR1C1,o,i,n.row,n.column,n.endRow,n.endColumn,n.rowRelative,n.columnRelative,n.endRowRelative,n.endColumnRelative,r,n._getRangeType())}function c(e,t,n,o,a,s,l,u,c){c=c||0;var f=H-1;(0===c||1===c)&&o>-f&&o<=2*f&&(o+=s?t:0,o=r(o,f));var d=V-1;if((0===c||2===c)&&a>-d&&a<=2*d&&(a+=l?n:0,a=r(a,d)),!i(t,n,o,a,s,l,c))return void u.push(P.Errors.Reference.toString());if(e){if(u.push("R"),o>=0&&(t!==o||!s)&&(s?u.push("["+(o-t)+"]"):(o++,u.push(o+""))),a<0)return;if(u.push("C"),n===a&&l||(l?u.push("["+(a-n)+"]"):(a++,u.push(a+""))),s&&o<0||!s&&o<=0)return}else{if(a>=0){l||u.push("$");for(var p=a,h=1,m=B.length;h<m;h++){var g=B[m-h];a=parseInt(p/g,10),p%=g,0!==a&&u.push(String.fromCharCode(a+65-1))}u.push(String.fromCharCode(p+65))}if(o<0)return;o++,s||u.push("$"),u.push(o+"")}}function f(e,t,n,r,o,i,a,s,l,u,f,d,p){p=p||0,c(e,t,n,r,o,s,l,d,p);var h=j;(!e||r!==i||o!==a||i!==h&&a!==h)&&(i===h&&a===h||(d.push(":"),c(e,t,n,i,a,u,f,d,p)))}function d(e,t,n,r){if(e.getExternalSourceToken){if(n!==P.BangSource){var o=p(e,e.getExternalSourceToken(n).split(""),r&&e.getExternalSourceToken(r).split(""));t.push.apply(t,o)}t.push("!")}}function p(e,t,n){if(!t||0===t.length)return[];var r=t;if(!h(t,!1)||n&&!h(n,!1)){if(!h(t,!0)||n&&!h(n,!0))return[];r=["'"];for(var o=0;o<t.length;o++)"'"===t[o]&&r.push("'"),r.push(t[o]);if(n)for(r.push(":"),o=0;o<n.length;o++)"'"===n[o]&&r.push("'"),r.push(n[o]);r.push("'")}if(n)for(r.push(":"),o=0;o<n.length;o++)r.push(n[o]);return r}function h(e,t){if(!e||0===e.length)return!0;if(!t&&P.isDigit(e[0]))return!1;if(!t){var n=m(e);if(n._success&&n._endIndex===e.length)return!1}for(var r,o=0;o<e.length;o++)if(r=e[o],t){if("*"===r||":"===r||"["===r||"]"===r||"?"===r||"\\"===r||"/"===r)return!1}else if(" "===r||"'"===r||"["===r||"]"===r||"?"===r||"\\"===r||"%"===r||'"'===r||"("===r||")"===r||P.operaterTypesMap[r])return!1;return!0}function m(e){var t=a(e,!1,0,0);return t._success||(t=a(e,!0,0,0)),t}function g(e,t,n){var r=n,o=0,i=t[o],a=M(e,t,o,i),s=a._table;s||A(),r._baseTable=s,o=a._charIndex,i=a._currentChar,o++,i=t[o];for(var l=o;" "===i;)o++,i=t[o];"@"!==i&&"["!==i&&(o=l,i=t[o]);for(var u=1,c=!1,f=!1,d=t.length;0!==u&&o<d;)if("["===i&&(u++,o++,i=t[o]),"#"===i){c&&u<=1&&A(),a=E(t,o,i,u);var p=a._portion;o=a._charIndex,i=a._currentChar,u=a._lbracketLever,c?2===r._referencePortions&&3===p||2===p&&3===r._referencePortions?r._referencePortions=6:3===r._referencePortions&&8===p||3===p&&8===r._referencePortions?r._referencePortions=12:A():r._referencePortions=p,c=!0}else if("@"===i){for((u>1||c)&&A(),c=!0,r._referencePortions=1,o++,i=t[o];" "===i;)o++,i=t[o];","===i&&A()}else{for(var h=o;"]"!==i&&"["!==i;)if("'"===i&&o++,","===i){o++,i=t[o];for(var m=o;" "===i;)o++,i=t[o];if("["===i){o=m,i=",";break}}else o++,i=t[o];if(o>h&&((f||"["===i&&u>1)&&A(),a=v(r,t,o,i,u,h),o=a._charIndex,i=a._currentChar,u=a._lbracketLever,f=!0),"]"===i){if(0===--u)break;o>=t.length&&A(),o++,i=t[o]}","===i&&(o++,i=t[o])}c||(r._referencePortions=16),f||(r._columnReferenceStartInTable=0,r._columnReferenceEndInTable=r._baseTable.endColumn()-r._baseTable.startColumn(),r._referenceColumnSpecifier=1)}function _(e,t,n){return e.slice(t,n).join("")}function v(e,t,n,r,o,i){var a=e,s=[],l="",u=!1,c=!1;if(o>1){if(u=!0,o--,s=t.slice(i,n),n++,":"===(r=t[n])){n++,r=t[n],c="["===r;var f=T(t,n,r,o);l=f._columnEndString,n=f._charIndex,r=f._currentChar,o=f._lbracketLever}}else if("["===r){c=!0;var d=n-1;for(r=t[d];" "===r;)d--,r=t[d];":"!==r&&A(),s=t.slice(i,d),u||(s=y(s)),r=t[n],f=T(t,n,r,o),l=f._columnEndString,n=f._charIndex,r=f._currentChar,o=f._lbracketLever}else{a._referencePortions!==U&&16!==a._referencePortions||(u=!0);var p=t.slice(i,n);d=p.indexOf(":"),d>0?(s=p.slice(0,d),l=p.slice(d+1),"["!==l[0]&&A()):s=p}var h,m=w(a,s,u);if(l?(h=w(a,l,c),a._referenceColumnSpecifier=4):(h=m,a._referenceColumnSpecifier=2),m>h){var g=m;m=h,h=g}if(a._columnReferenceStartInTable=m,a._columnReferenceEndInTable=h,++n<t.length)for(r=t[n];" "===r;)n++,r=t[n];return{_charIndex:n,_currentChar:r,_lbracketLever:o}}function y(e){for(var t=e.length-1;t>=0&&" "===e[t];)t--;for(;t>=0&&" "!==e[t];)t--;return t>=0?e.substr(t+1,e.length-t-1):e}function b(e){for(var t=0,n=e.length,r=0;t<n&&" "===e[t];)t++;for(r=t,t=n-1;t>r&&" "===e[t];)t++;return t>=r?e.slice(r,t+1):e}function w(e,t,n){if(t&&C(t,n)){for(var r=[],o=0,i=t.length;o<i;o++)"'"===t[o]&&o<i-1&&"'"!==t[o+1]||r.push(t[o]);t=r;var a=e._baseTable.getColumnIndexInTable(t.join(""));return a<0&&A(),a}return-1}function C(e,t){if(t)return!0;var n="";n=e[0];var r=n;if("#"===n||" "===n||"@"===n||" "===n||","===n||":"===n||"["===n||"]"===n)return!1;for(var o=1;o<e.length;o++){if(" "===(n=e[o])||","===n||":"===n||"["===n&&"'"!==r||"]"===n&&"'"!==r||"@"===n&&"'"!==r||"#"===n&&"'"!==r)return!1;r=n}return!0}function S(e){var t="",n=[];t=e[0];for(var r=0;r<e.length;r++)t=e[r],"["!==t&&"]"!==t&&"@"!==t&&"#"!==t&&"'"!==t||n.push("'"),n.push(t);return n}function x(e){var t="";if("#"===(t=e[0])||" "===t||"@"===t||" "===t||","===t||":"===t||"["===t||"]"===t)return!0;for(var n=1;n<e.length;n++)if(" "===(t=e[n])||","===t||":"===t||"["===t||"]"===t||"@"===t||"#"===t)return!0;return!1}function T(e,t,n,r){var o=!1;if("["===n)for(o=!0,r++,t++,n=e[t];" "===n;)t++,n=e[t];for(var i=t;"]"!==n&&(","!==n||r>1);)"'"===n&&t++,t++,n=e[t];t<=i&&A();var a=e.slice(i,t);return r>1&&r--,o||(a=b(a)),{_columnEndString:a,_charIndex:t,_currentChar:n,_lbracketLever:r}}function E(e,t,n,r){for(var o=14,i=t;"]"!==n;)"'"===n&&t++,t++,n=e[t];for(var a=_(e,i,t).toLowerCase().trim(),s=!1,l=0;l<z.length;l++){if(a===z[l]){o=ee[a],s=!0;break}}if(s||A(),++t>=e.length)r--;else{for(n=e[t];" "===n;)t++,n=e[t];if(","===n){for(r<=1&&A(),t++,n=e[t];" "===n;)t++,n=e[t];for("["===n&&(r++,t++,n=e[t]);" "===n;)t++,n=e[t]}r>1&&r--}return{_portion:o,_charIndex:t,_currentChar:n,_lbracketLever:r}}function M(e,t,n,r){for(var o=W,i=0,a=t.length;"["!==r&&n<a;)n++,r=t[n];if((i=n)>0){var s=_(t,0,i);o=e.getTableByName(s)}else o=e.getTableByIndex(e.row,e.column);return{_table:o,_charIndex:n,_currentChar:r}}function A(){throw N._getResource(P.SR)().Exp_FormulaInvalid}function k(e,t,n){switch(e){case 1:return n?"[#This Row]":"@";case 2:return t?"[#Headers]":"#Headers";case 3:return t?"[#Data]":"#Data";case 8:return t?"[#Totals]":"#Totals";case 6:return"[#Headers], [#Data]";case 12:return"[#Data], [#Totals]"}return t?"[#All]":"#All"}function R(e,t){var n;e.unshift(new X("=",1,0,0,0));for(var r,o=e.length-1;o>0;o--)e[o]._index===e[o-1]._index&&e[o]._stringValue===e[o-1]._stringValue&&(e=e.splice(o,1));for(var i=0;i<e.length-1;i++)r=I(e[i]),e[i+1]._index-e[i]._index-r>0&&(n=new X(t.slice(e[i]._index+r,e[i+1]._index),7,e[i]._index+r),e.splice(i+1,0,n));r=I(e[i]),e.length>0&&t.length>e[i]._index+r&&(n=new X(t.slice(e[i]._index+r,t.length),7,e[i]._index+r),e.splice(i+1,0,n));for(var a=0;a<e.length;a++){var s=e[a]._stringValue.trim();"("===s||"{"===s?(e[a]._type=1,e[a]._subType=1):")"===s||"}"===s?(e[a]._type=1,e[a]._subType=2):3===e[a]._subType&&(e[a]._stringValue='"'+e[a]._stringValue+'"')}return e}function I(e){return 1===e._type&&"ARRAY"===e._stringValue?1:0===e._type&&3===e._subType?e._stringValue.length+2:0===e._type&&12===e._subType?e._stringValue.length+3:e._stringValue.length}function O(e,t,n){if(e&&t){var r=t.getName(),o=e[r];o||(o=e[r]=[],e.sheets||(e.sheets=[]),e.sheets.push(r)),o.push(n)}}function D(e,t,n,r,o,i){if(e){for(;10===e.type;)e=e.value;var a;if(12===e.type){e=e.value}if(e.type>=2&&e.type<=6);else if(1===e.type)a=e.getRange(o,i),!r.source||e.source&&e.source!==r.source||t.push(a),O(n,e.source||r.source,a);else if(13===e.type)a=e.getRange(o,i),e.source()===r.source&&a&&t.push(a),O(n,e.source()||r.source,a);else if(8===e.type){var s=W;e.source?e.source._getCalcServiceInternal()&&(s=new P.EvaluateContext(e.source,!1,P._createCellIdentity(o,i))):s=r,D(s.getName(e.value),t,n,s,o,i)}else if(9===e.type)D(e.value,t,n,r,o,i),e.value2&&D(e.value2,t,n,r,o,i);else if(7===e.type)for(var l=0;l<e.arguments.length;l++)D(e.arguments[l],t,n,r,o,i)}}var P=n(5),N=n(0),F=N._Types._inherit,L=N._Types._extend,H=P.maxRowCount=1048576,V=P.maxColumnCount=16384,j=P.BAND_INDEX_CONST,B=[1,26,676],U=void 0,W=null,z=["#all","#data","#headers","#totals","#this row"],Y=P.Expression,G=P.isNumber,K=P._isLetter,X=P.FormulaToken,q=P.Errors.Reference,J=P.ErrorSource=function(e){function t(t){e.call(this,W),this._sheetName=t}return F(t,e),t}(P.CalcSource);L(J.prototype,{startCalculation:function(){},endCalculation:function(){},getValue:function(){return q},getReference:function(){new P.CalcReference(self,[P._createCellIdentity(0,0)]).getValue=function(){return q}},referenceToArray:function(){var e=[q];return e.isError=!0,e},getName:function(){return this._sheetName},setValue:function(){}});var Z=P.SheetReferenceResolver=function(e){this._sheet=e,this.priority=8e3};F(Z,P.TokenResolver),L(Z.prototype,{resolveToken:function(e,t,n,r){var i,s,l,u=e.useR1C1,c=e.row,f=e.column,d=n.length,p=n[r],h=p._stringValue,m=function(){!e.ignoreError&&A();var t=new P.Expression(8);return t.value=h,t};if(0===p._type&&0===p._subType&&r<d-2&&":"===n[r+1]._stringValue&&12===n[r+2]._subType&&n[r+2]._stringValue.indexOf(":")<0||0===p._type&&12===p._subType){var g,_;if(h)if(h.indexOf(":")>0){var v=h.indexOf(":");g=h.substring(1,v-1),_=h.substring(v+1,h.length-2)}else g=h,"'"===g.charAt(0)&&(g=g.substring(1,g.length-1)),0===p._subType&&(_=n[r+2]._stringValue);else;if(s=h?e.getExternalSource("",g):P.BangSource,s=s||o(g),r++,_&&(l=e.getExternalSource("",_),l=l||o(_),r+=2),!(p=n[r]))return m();h=p._stringValue}var y=r===d-1?W:n[r+1],b=function(e,t,n,r,o){return 0===t._type&&0===t._subType||!r&&0===t._type&&4===t._subType&&(!o||n<e.length-2&&":"===e[n+1]._stringValue&&0===e[n+2]._type&&4===e[n+2]._subType)};if(b(n,p,r,u,!0)){var w=a(p._value,u,c,f);if(!w._success&&!s)return!1;if(p._subType=7,w._success){var C=w._row,S=w._col,x=w._rowRelative,T=w._columnRelative;if(r<d-2&&5===y._type&&":"===y._stringValue&&(y=n[r+2],b(n,y,r+2,u,!1))){var E=a(y._value,u,c,f);if(E._success&&C===j==(E._row===j)&&S===j==(E._col===j))return c=C===j?0:c,f=S===j?0:f,{index:r+3,expr:P._createRangeExpression(s,l,C-(x?c:0),S-(T?f:0),E._row-(E._rowRelative?c:0),E._col-(E._columnRelative?f:0),x,T,E._rowRelative,E._columnRelative)}}return C===j||S===j?u?(C-=C!==j&&x?c:0,S-=S!==j&&T?f:0,{index:r+3,expr:P._createRangeExpression(s,l,C,S,C,S,x,T,x,T)}):s&&m()||!1:{index:r+1,expr:P._createCellExpression(s,l,C-(x?c:0),S-(T?f:0),x,T)}}i=new Y(8),i.value=p._stringValue}else{if(6!==p._subType)return!!s&&m();i=new P.Expression(5),i.value=P.CalcError.parse(p._stringValue)}return s&&(i.source=s),l&&(i.endSource=l),{index:r+1,expr:i}},unparse:function(e,t,n,r){return!(!n||1!==n.type&&8!==n.type)&&(u(e,t,n,r),!0)}}),P.StructReferencePortions={ThisRow:1,Headers:2,Data:3,Totals:8,HeadersAndData:6,DataAndTotals:12,All:14,NotSpecific:16},P.StructReferenceColumnSpecifier={All:1,NotSpecific:1,SingleColumn:2,ColumnRange:4};var Q=function(){var e=new Y(13);return e.tableName=function(){return this._baseTable.tableName()},e.baseTable=function(){return this._baseTable},e._updateCatch=function(){this._catchedTableStartColumn=this._baseTable.startColumn()},e.columnReferenceStart=function(){return this._columnReferenceStartInTable+this._baseTable.startColumn()},e.columnReferenceEnd=function(){return this._columnReferenceEndInTable+this._baseTable.startColumn()},e.referencePortions=function(){return this._referencePortions},e.referenceColumnSpecifier=function(){return this._referenceColumnSpecifier},e.source=function(){return this._baseTable.source()},e.getRange=function(e,t,n){var r=this,o=r._baseTable;r._updateCatch();var i,a,s,l,u,c,f=o.startRow(),d=o.endRow(),p=o.hasTotalsRow(),h=o.hasHeadersRow();switch(r._referencePortions){case 3:case 16:i=h?f+1:f,s=p?d-1:d;break;case 2:if(h)i=f,s=f;else{if(!n)return W;i=f-1,s=f-1}break;case 8:if(p)i=d,s=d;else{if(!n)return W;i=d+1,s=d+1}break;case 1:i=e,s=e;break;case 6:i=f+(n&&!h?-1:0),s=p?d-1:d;break;case 12:i=h?f+1:f,s=d+(n&&!p?1:0);break;case 14:default:i=f+(n&&!h?-1:0),s=d+(n&&!p?1:0)}return a=r.columnReferenceStart(),l=r.columnReferenceEnd(),s<i||!n&&i<f||!n&&s>d?W:(u=s-i+1,c=l-a+1,P._createRangeIdentity(i,a,u,c))},e.offsetWhenInsertRemoveColumn=function(e,t,n){var r=this,o=r._catchedTableStartColumn;if(e<o||e===o&&n||e>r._columnReferenceEndInTable+o)return r;t=n?t:-t;var i=e-o,a=Q();return a._baseTable=r._baseTable,a._columnReferenceEndInTable=r._columnReferenceEndInTable+t,a._columnReferenceStartInTable=r._columnReferenceStartInTable,e<=o+r._columnReferenceStartInTable&&(a._columnReferenceStartInTable+=t,a._columnReferenceStartInTable<i&&(a._columnReferenceStartInTable=i)),a._referenceColumnSpecifier=r._referenceColumnSpecifier,a._referencePortions=r._referencePortions,a._columnReferenceEndInTable<a._columnReferenceStartInTable?P._referenceErrorExpr:a},e.offsetWhenCopy=function(e,t){var n=this,r=Q();if(r._baseTable=n._baseTable,r._columnReferenceEndInTable=n._columnReferenceEndInTable,r._columnReferenceStartInTable=n._columnReferenceStartInTable,2===n._referenceColumnSpecifier&&t){var o=n._baseTable.endColumn()-n._baseTable.startColumn()+1;t%=o,r._columnReferenceStartInTable+=t,r._columnReferenceStartInTable<0&&(r._columnReferenceStartInTable+=o),r._columnReferenceEndInTable=r._columnReferenceStartInTable}return r._referenceColumnSpecifier=n._referenceColumnSpecifier,r._referencePortions=n._referencePortions,r},e.offset=function(){var e=this,t=Q();return t._baseTable=e._baseTable,t._referencePortions=e._referencePortions,t._columnReferenceStartInTable=e._columnReferenceStartInTable,t._columnReferenceEndInTable=e._columnReferenceEndInTable,t._referenceColumnSpecifier=e._referenceColumnSpecifier,t},e},$=P.StructureReferenceResolver=function(e){P.TokenResolver.call(this),this._sheet=e,this.priority=7900};F($,P.TokenResolver),L($.prototype,{resolveToken:function(e,t,n,r){var o=n[r];if(0===o._type&&0===o._subType)if(o=o._stringValue,"]"===o.charAt(o.length-1))try{var i=Q();return g(e,o.split(""),i),i}catch(e){}else{var a=this._sheet.tables,s=a&&a.findByName(o);if(s)return $.create(s)}return W},unparse:function(e,t,n,r){if(n){if(13!==n.type)return!1;var o=n;if(16===o._referencePortions&&1===o._referenceColumnSpecifier)return r.push(o._baseTable.tableName()),void(e._toStandard&&r.push("[]"));if(e.source===o._baseTable.source()&&e.row>=o._baseTable.startRow()&&e.column>=o._baseTable.startColumn()&&e.row<=o._baseTable.endRow()&&e.column<=o._baseTable.endColumn()&&!e._toStandard||r.push(o._baseTable.tableName()),r.push("["),16!==o._referencePortions){var i=k(o._referencePortions,1!==o._referenceColumnSpecifier,e._toStandard);r.push(i)}if(1!==o._referenceColumnSpecifier){1===o._referencePortions&&!e._toStandard||16===o._referencePortions||r.push(", ");var a=o._baseTable.getColumnName(o._columnReferenceStartInTable);if(a=S(a.split("")).join(""),4===o._referenceColumnSpecifier){var s=o._baseTable.getColumnName(o._columnReferenceEndInTable);s=S(s.split("")).join(""),r.push("[",a,"]:[",s,"]")}else 1===o._referencePortions&&!e._toStandard&&!x(a)||16===o._referencePortions?r.push(a):r.push("[",a,"]")}return r.push("]"),!0}}}),$.create=function(e,t,n,r,o){void 0===t&&(t=16),void 0===n&&(n=1),r=r||0,void 0===o&&(o=e.endColumn()-e.startColumn());var i=Q();return i._baseTable=e,i._referencePortions=t,i._columnReferenceStartInTable=r,i._columnReferenceEndInTable=o,i._referenceColumnSpecifier=n,i};var ee={"#all":14,"#data":3,"#headers":2,"#totals":8,"#this row":1},te=P.Parser.prototype;te.parseReferenceExpressionInfos=function(e,t,n,r,o){var i=this;i.setParserOption(o);var a=[],s=e.split("");try{var l=t._getSheetSource().getParserContext(t._getCalcServiceInternal().useR1C1,P._createCellIdentity(n,r),W);a=i.parseToTokens(l,s,!1)}catch(e){}return a=R(a,s),this.getExpressToken(a,s,t,n,r)},te.getExpressToken=function(e,t,r,o,i){var a,s=U,l=r._getSheetSource(),u=r._getCalcServiceInternal();if(u){a=new(n(26).Spread.Sheets.CalcEngine.SheetParserContext)(r,u.useR1C1,P._createCellIdentity(o,i)),s=new P.EvaluateContext(l,P._createCellIdentity(o,i),!1)}else a=new P.ParserContext(W,!1,P._createCellIdentity(0));a.ignoreError=!0;for(var c=[],f=0;f<e.length;f++)try{var d=e[f];if("["===d._stringValue||"#"===d._value[0]||3===d._subType){c.push({text:d._stringValue,type:d._type,subType:d._subType,canDrag:!1,ranges:d.ranges,value:d._stringValue});continue}var p=[];if(f=this.buildExpressionInfo(a,e,f,p),p.length>0)for(var h=0;h<p.length;h++){var m=p[h];if(m instanceof X)c.push({text:m._stringValue,type:m._type,subType:m._subType,canDrag:b,ranges:[],value:m._stringValue});else if(m._expr){var g=m._expr,_=t.slice(m._index,m._endIndex+1).join(""),v=[],y={},b=!0,w=g.getRange&&g.getRange(o,i);if(8===g.type){if(b=!1,s){var C=s.getName(g.value);D(C,v,y,s,o,i)}}else if(13===g.type)b=!1,g.source()===l&&w?v.push(w):v=null,O(y,g.source(),w);else if(1===g.type)if(g.endSource){var S=g.source,x=g.endSource,T=S.getSources(x);for(h=0;h<T.length;h++){if(T[h]===l){v.push(w);break}O(y,T[h],w)}}else O(y,g.source||l,w),g.source&&g.source!==l||v.push(w);else v=null;v&&v.length>0?c.push({text:_,type:0,subType:7,canDrag:b,ranges:v,value:_,sheetRanges:y}):c.push({text:_,type:d._type,subType:d._subType,canDrag:b,ranges:v,value:_,sheetRanges:y})}}else c.push({text:d._stringValue,type:d._type,subType:d._subType,canDrag:!1,ranges:d.ranges,value:d._stringValue})}catch(e){c.push({text:d._stringValue,type:d._type,subType:d._subType,canDrag:!1,ranges:d.ranges,value:d._stringValue})}return c},te.buildExpressionInfo=function(e,t,n,r){var o=t[n];if(!o||"function"==typeof o||0!==o._type)return n;var i=[],a=this.resolveToken(e,t,i,n)-1,s=i[0];if(1!==s.type&&13!==s.type&&8!==s.type)return n;var l=t[a],u={_index:o._index,_endIndex:l._endIndex,_expr:s};return r.push(u),a}},function(e,t,n){function r(e,t){return e.getRowCount(t)}function o(e,t){return e.getColumnCount(t)}function i(e){return e.rowCount}function a(e){return e.colCount}function s(e){var t=e.parent;return t&&t.options.allowExtendPasteRange}function l(e){var t=e.parent;return t&&t.options.allowCopyPasteExcelStyle}function u(e){var t=e.parent;return t&&t.options.copyPasteHeaderOptions}function c(){return ye._getResource(t.SR)()}function f(e,t,n,r){throw new Error(ke._format(c().Exp_InvalidAndSpace,[e,t,n,r]))}function d(e){e.suspendPaint()}function p(e){e.resumePaint()}function h(e){e.suspendEvent()}function m(e){e.resumeEvent()}function g(e){var n=this;n._rowHeader=1==(1&e),n._columnHeader=2==(2&e),n._unFormatted=8==(8&e),n._formula=t._supportsCalc&&16==(16&e),n._expandRows=!0,n._expandColumns=!0}function _(e,t,n,r){if(Me(e)||""===e)return Xe;(Me(t)||""===t)&&(t="\r\n");var o="\n";(Me(n)||""===n)&&(n="\t"),(Me(r)||""===r)&&(r='"'),Re(e,t)||(e+=t);for(var i,a=[],s=[],l="",u=!1,c=r.length,f=t.length,d=o.length,p=n.length,h=e.length,m=0;m<h;m++)if(l+=e[m],(i=l.length)>=c&&r===l.substr(i-c,c))if(u&&h>=m+1+c&&r===e.substr(m+1,c))m+=c;else if(u)l=l.substr(0,i-c),u=!1;else{var g=l;0===g.indexOf(r)&&(l=l.substr(0,i-c),u=!0)}else!u&&i>=p&&n===l.substr(i-p,p)?(l=l.substr(0,i-p),s.push(l.toString()),l=""):!u&&i>=f&&t===l.substr(i-f,f)?(l=l.substr(0,i-f),s.push(l.toString()),a.push(s),s=[],l=""):!u&&i>=d&&o===l.substr(i-d,d)?(l=l.substr(0,i-d),s.push(l.toString()),a.push(s),s=[],l=""):u&&h>=m+1+p&&n===e.substr(m+1,p)&&","!==n&&(m+=c);if(u){if(s.length>0){for(var _=0;_<a.length&&a[_]!==s;_++);_>=a.length&&a.push(s)}var v=l.toString();v&&(v=v.replace(new RegExp(n,"g"),""),Re(v,t)&&(v=v.substr(0,v.length-f)),0===a.length&&a.push([v]))}if(0===a.length){var y=e;Re(e,t)&&(y=y.substr(0,y.length-f)),a.push([y])}return a}function v(e,t,n,i,a){var s=i.length,l=C(i);if(0!==s&&0!==l){var u=new g(a);u._unFormatted=!1,e&&(o(e,2)<=0&&(u._rowHeader=!1),r(e,1)<=0&&(u._columnHeader=!1));var c=u._rowHeader?o(e,2):0,f=u._columnHeader?r(e,1):0,d=0;l-=c,l<=0&&(l=0),s-=f,s<=0&&(d=0),s-=d,s<=0&&(s=0),u._expandRows&&t+s>r(e)&&e.setRowCount(t+s),u._expandColumns&&n+l>o(e)&&e.setColumnCount(n+l);for(var p=0,h=0;p<i.length;p++,h++){var m=i[p];m.length<=0||(f>0&&p<f?y(e,m,h,n,l,1,u):s>0&&h<r(e)&&(p===f&&(h=t),y(e,m,h,0,c,2,u),m.splice(0,c),y(e,m,h,n,l,3,u)))}}}function y(e,t,n,r,i,a,s){for(var l=0,u=r;l<t.length;l++,u++)i>0&&u<o(e,a)&&w(e,a,n,u,t[l],s)}function b(e,t,n,r){var o=new Ee;o.text(r),o._value=r,e.getCell(t,n).cellType(o).value(r)}function w(e,t,n,r,o,i){var a=o,s=Xe;if(!1===i._unFormatted){var l={value:Xe};a=Ue._parseText2Value(Xe,o,!i._unFormatted,l),s=l.value}if(Me(a))e.setValue(n,r,a,t);else if(""!==o)if(i._formula&&"="===o[0])try{e.setFormula(n,r,o.substr(1))}catch(i){e.setText(n,r,o,t)}else if(Te.isUrl(o)){var u=e.getCellType(n,r,t),c=u&&"8"===u.typeName;c||(u=new Ee),u.text(o),e.getCell(n,r).cellType(u).value(o)}else{var f=e._getStyleProperty(n,r,"formatter",t);if(!1===i._unFormatted&&s)if(f)"@"===f.toString()&&(a=o.toString());else{s.isAuto=!0,e.getCell(n,r,t)._setStyleProperty("_autoFormatter",s);var d=o,u=e.getCellType(n,r,t),p=s.formatString();if(u&&"7"===u.typeName){var h={sheet:e,row:n,col:r,sheetArea:t};d=u.parse(o,p,h),a=Me(d)?o:d}}else f&&e.getCell(n,r,t).formatter(Xe);e.setValue(n,r,a,t)}else e.setValue(n,r,Xe,t)}function C(e){for(var t=0,n=0;n<(e&&e.length);n++){var r=e[n];t=Ze(r.length,t)}return t}function S(e,t,n,i,a,s,l,u){if(!e)throw new Error(c().Exp_SheetIsNull);if((t<-1||t>=r(e))&&f("row",t,"-1",r(e)-1),(n<-1||n>=o(e))&&f("column",n,"-1",o(e)-1),!Me(i)&&""!==i){-1===t&&(t=0),-1===n&&(n=0);var d=_(i,a,s,l);d&&d.length>0&&(e._tempParsedText=d,v(e,t,n,d,u))}}function x(e,t,n,i,a,s,l,u,d,p,h,m,g){if(!e)throw new Error(c().Exp_SheetIsNull);(t<-1||t>=r(e))&&f("row",t,"-1",r(e)-1),(n<-1||t+n>r(e))&&f("rowCount",n,"-1",r(e)-t),(i<-1||i>=o(e))&&f("column",i,"-1",o(e)-1),(a<-1||i+a>o(e))&&f("columnCount",a,"-1",o(e)-i);var _=-1,v=-1;-1===t&&-1===i&&-1===n&&-1===a?(t=0,i=0,_=r(e)-1,v=o(e)-1):(-1===t&&(t=0),-1===i&&(i=0),-1===n&&(n=r(e)-t),-1===a&&(a=o(e)-i),_=t+n-1,v=i+a-1),(Me(s)||""===s)&&(s="\r\n"),(Me(l)||""===l)&&(l="\t"),(Me(u)||""===u)&&(u='"');for(var y="",b=t;b<=_;b++)if(!p||!Ae(p,b)){for(var w=!0,C=i;C<=v;C++)if(!h||!Ae(h,C)){w||(y+=l),w=!1;var S="",x=e.getText(b,C);Me(x)||(S=x,m||(S=S.replace(new RegExp(u,"g"),u+u))),g&&!S&&(S=" "),m?y+=S.replace(/\n/g,We.mozilla?"":" "):d||-1!==S.indexOf(u)||-1!==S.indexOf(l)||-1!==S.indexOf(s)||-1!==S.indexOf("\n")?y+=u+S+u:y+=S}y+=s}return y.toString()}function T(e,t,n,r){var o=Xe,i=_(e,t,n,r);if(i){for(var a=i.length,s=C(i),l=[],u=0;u<a;u++){l[u]=[];for(var c=0;c<s;c++)c<i[u].length?l[u][c]=i[u][c]:l[u][c]=Xe}o=l}return o}function E(e,t){return e.sheets?e.getSheetFromName(t.sheetName):e}function M(e,t,n,r){var o=E(e,n),i=new t(o,n,r);return r?i.undo(o):i.execute(o)}function A(e){var t=e;return function(e,n){var r=E(e,n);return tt._navigateNoWrap(r,t)}}function k(e,t){var n=e,r=t;return function(e,t){var o=E(e,t);return tt._alterSelection(o,n,r)}}function R(e,t){var n=e.parent;if(n){var r,o,i=n.getSheetCount();r=o=n.getActiveSheetIndex(),t?o<i-1&&o++:o>0&&o--,r!==o&&(n._setActiveSheetIndexImp(o,1),n.repaint())}}function I(e,t){e._isTabNavigation=!0,e._isNavigateInSelection?e._moveActiveCellInSelection(t):e._moveActiveCell(t,!0),e._isTabNavigation=!1}function O(e,t){if(!e.endEdit())return!1;var n=e._eventHandler;n._clearRepeatKeyDownTimeout(),n._resetMetaKeyState(),Ce._FocusHelper._setActiveElement(Xe);var r=!1,o=e.parent;if(o){var i=t.call(o);i&&i.focus?(i.focus(),r=!0):o._focusTabFocusElement()}return{ignoreCancelDefault:!r}}function D(e,t,n){var r=this;r.row=e,r.column=t,r.value=n}function P(e,t,n){var r=this;r._sheet=e,r._range=t,r._dataType=n,r._cellsData=[],r._changedCells=[],r._initCellsData()}function N(){}function F(e){var t=e;return function(e,n,r){var o=this;if(0===arguments.length)return o._ps?o._ps[t]:qe;o._ps||(o._ps={}),o._ps[t]||(o._ps[t]=[]),o._ps[t].push(new D(e,n,r))}}function L(e){return e&&e.length>0}function H(e,t){var n=this;n._rowCount=e,n._columnCount=t,n._spanSaved=!1}function V(e,t){var n=t,r=e;return function(e,t){var o=this;if(1===arguments.length){var i=o._ps[r]?o._ps[r][e]:Xe;return Ye(i)?i:n}Ye(t)||(o._ps[r]||(o._ps[r]=[]),o._ps[r][e]=t)}}function j(e){var t=e;return function(){var e=this._ps[t];return e&&e.length>0}}function B(e){var t=this;t._columnCount=e,t._levels={},t._collapsed={},t._rangeGroupSaved=!1,t._ps={}}function U(e){var t=this;t._rowCount=e,t._levels={},t._collapsed={},t._rangeGroupSaved=!1,t._ps={}}function W(e,n,r,o,i,a,s,l){var u,c;for(u=0;u<i;u++)for(c=0;c<a;c++){if(3===n){var f;t._supportsCalc&&(2&s)>0&&e.getFormulaInformation&&(f=e.getFormulaInformation(r+u,o+c),f.hasFormula?f.isArrayFormula?f.baseRange.row===r+u&&f.baseRange.col===o+c&&l._arrayFormulas(f):l._formulas(u,c,f.formula):l._formulas(u,c,Xe))}if((1&s)>0){var d=e.getValue(r+u,o+c,n);l._values(u,c,d)}if((64&s)>0&&l._styles(u,c,e._getStyleObject(r+u,o+c,n)),(128&s)>0&&l._tags(u,c,e.getTag(r+u,o+c,n)),3===n){if((16&s)>0&&e.getSparkline){var p=e.getSparkline(r+u,o+c),h=Xe;p&&(h=p.data()),p&&h?l._sparklines(u,c,p.clone()):l._sparklines(u,c,Xe)}var m=e.comments;(4&s)>0&&m&&l._comments(u,c,m.get(r+u,o+c)),(256&s)>0&&l._bindingPaths(u,c,e.getBindingPath&&e.getBindingPath(r+u,o+c,n))}}}function z(){}function Y(e,t){d(e),t||h(e)}function G(e,t){t||m(e),p(e)}function K(){}function X(e,t){var n=this;K.call(n),n._sheet=e,n._command=t,t._oldSizes=t._oldSizes||[],t._oldVisibles=t._oldVisibles||[]}function q(e,t){var n=this;K.call(n),n._sheet=e,n._command=t,t._oldSizes=t._oldSizes||[]}function J(e,t){var n=this,r=e.parent;K.call(n),n._sheet=e,n._command=t,n._sheetArea=t.rowHeader?2:3,Ye(t.autoFitType)||(t.autoFitType=r?r.options.autoFitType:0),t._oldSizes=t._oldSizes||[]}function Z(e,t){var n=this,r=e.parent;K.call(n),n._sheet=e,n._command=t,n._sheetArea=t.columnHeader?1:3,Ye(t.autoFitType)||(t.autoFitType=r?r.options.autoFitType:0),t._oldSizes=t._oldSizes||[]}function Q(e,n){var r=this;if(K.call(r),r._command=n,n._oldValueCache=n._oldValueCache||{},n._oldValueIsFormulaCache=n._oldValueIsFormulaCache||{},r._sheet=e,t._supportsCalc&&n.ranges&&1===n.endEditType){var o=e._getActualRange(n.ranges[0]);if(n.ranges[0]=o,1===i(o)&&1===a(o)){var s=e._getsArrayFormulas(o.row,o.col,1,1);s&&s.ranges&&s.ranges.length>0&&(n.ranges=[s.ranges[0]])}}}function $(e,t){e._setNameCore(t);var n=e.parent,r=n&&n._tab;r&&r.repaint()}function ee(e,t){var n=this;K.call(n),n._sheet=e,n._command=t}function te(e,t){var n=this;K.call(n),n._sheet=e,n._command=t}function ne(e,t){return!(!0===e.isEditing()&&!e.endEdit())&&(e.suspendPaint(),e.zoom(t),e.resumePaint(),!0)}function re(e,t){this.value=e,this.formulaInfo=t}function oe(e,t){var n=this;K.call(n),n._sheet=e,n._command=t}function ie(e,t,n){var r=this;if(K.call(r),r._sheet=e,r._command=t,!n){t._cachedActions=[];var o=t.ranges;if(o&&o.length>0)for(var i=0;i<o.length;i++)t._cachedActions[i]=new oe(e,{clearRange:o[i]})}}function ae(e){z._undoTableInfo(e.sheet,e.data,e.range)}function se(e){z._undoRowsInfo(e.sheet,e.data,e.row)}function le(e){z._undoColumnsInfo(e.sheet,e.data,e.col)}function ue(e){z._undoCellsInfo(e.sheet,e.data,e.row,e.col,e.sheetArea)}function ce(e,t){return t&&t.undo?(t.undo.call(e,t),1):0}function fe(e,t,n,o){var i=new H(r(e,1),n),a=new B(n);z._saveColumnHeaderInfo(e,i,a,t,o);var s={};return s.headerCells={sheet:e,data:i,row:0,col:t,undo:ue,sheetArea:1},s.columns={sheet:e,data:a,col:t,undo:le},s}function de(e,t,n,r,o,i){var a=new H(r,o);return z._saveViewportInfo(e,a,t,n,i),{sheet:e,data:a,row:t,col:n,undo:ue,sheetArea:3}}function pe(e,t,n,r,o){var i=[],a=new Ve(t,n,r,o);return z._saveTableInfo(e,i,a),{sheet:e,data:i,range:a,undo:ae}}function he(e,t,n,r){var i=new H(n,o(e,2)),a=new tt._CopyMoveRowsInfo(n);z._saveRowHeaderInfo(e,i,a,t,r);var s={};return s.headerCells={sheet:e,data:i,row:t,col:0,undo:ue,sheetArea:2},s.rows={sheet:e,data:a,row:t,undo:se},s}function me(e){var t=e.sheet;t.setRowCount(e.rowCount),t.setColumnCount(e.colCount)}function ge(e){return{sheet:e,rowCount:e.getRowCount(),colCount:e.getColumnCount(),undo:me}}function _e(e,t){var n=this;K.call(n),n._sheet=e,n._command=t}function ve(e,t,n){var r=this;if(K.call(r),r._sheet=e,r._command=t,!n){var o=e,i=t.fromSheet;if(!o)throw new Error(c().Exp_DestSheetIsNull);var a=t,s=a.pastedRanges;if(s&&s.length>0){t._cachedActions=[];var l=a.fromRanges||[a.fromRange],u=l.length,f=a.isCutting,d=a.clipboardText,p=a.clipboardHtml,h=a.pasteOption,m={},g=s[0];if(!f&&i&&i._isValidMultiCopyRanges(l,m)&&g.equals(i._getPastedRangeForMultiCopy(l,g))){var _=m.inSameRow,v=m.inSameCol;_?l=l.sort(function(e,t){return e.col-t.col}):v&&(l=l.sort(function(e,t){return e.row-t.row}));for(var y=g.row,b=g.col,w=0;w<u;w++){var C=l[w],S=C.rowCount,x=C.colCount,T={sourceRange:C,targetRange:Ce._createRange(y,b,S,x),isCutting:f,clipboardText:d,clipboardHtml:p,includeFilteredOutRow:!0};t._cachedActions[w]=new _e(e,{fromSheet:i,toSheet:o,pasteExtent:T,pasteOption:h}),_?b+=x:v&&(y+=S)}t._isMultiToSingle=!0}else for(var E=0;E<s.length;E++){var M={sourceRange:l[0],targetRange:s[E],isCutting:f,clipboardText:d,clipboardHtml:p};t._cachedActions[E]=new _e(e,{fromSheet:i,toSheet:o,pasteExtent:M,pasteOption:h})}}}}var t=n(2),ye=n(0),be=n(6).Worksheet,we=n(9).Style,Ce=n(3),Se=n(4).GC$,xe=n(48).staticMembers,Te=n(27),Ee=n(49).HyperLink,Me=ye._Types._isNullOrUndefined,Ae=ye._ArrayHelper._contains,ke=ye._StringHelper,Re=ke._endsWith,Ie=Ce.Events,Oe=Ie.CellChanged,De=Ie.ColumnWidthChanging,Pe=Ie.ColumnWidthChanged,Ne=Ie.RowHeightChanging,Fe=Ie.RowHeightChanged,Le=Ie.AutoFitRowHeightChanging,He=Ie.AutoFitRowHeightChanged,Ve=Ce.Range,je=Ce.Rect,Be=Ce._CacheMgr,Ue=Ce._util,We=Ue._browser,ze=Ue._defProperty,Ye=Ue._isDefined,Ge=Se.extend,Ke=Se.inherit,Xe=null,qe=void 0,Je=Math.min,Ze=Math.max,Qe=Math.floor,$e=Number.MAX_VALUE,et=isNaN;t.ClipboardPasteOptions={all:0,values:1,formatting:2,formulas:3},t.CopyToOptions={value:1,formula:2,comment:4,outline:8,sparkline:16,span:32,style:64,tag:128,bindingPath:256,conditionalFormat:512,all:1023},Ge(be.prototype,{autoFitColumn:function(e){0<=e&&e<o(this)&&this._commandManager().execute({cmd:"autoFitColumn",sheetName:this.name(),columns:[{col:e}],rowHeader:!1})},autoFitRow:function(e){0<=e&&e<r(this)&&this._commandManager().execute({cmd:"autoFitRow",sheetName:this.name(),rows:[{row:e}],columnHeader:!1})},setCsv:function(e,t,n,r,o,i){var a=this;d(a),h(a),S(a,e,t,n,r,o,'"',i),m(a),p(a)},getCsv:function(e,t,n,r,o,i){return x(this,e,n,t,r,o,i,'"',!0)},copyTo:function(e,t,n,r,o,i,a){this._copyToCore(e,t,n,r,o,i,a)},copyToWithoutCellType:function(e,t,n,r,o,i,a){this._copyToCore(e,t,n,r,o,i,a,!1,!0)},parseText:_,_copyToCore:function(e,t,n,r,o,i,a,s,l){var u=this;d(u),h(u),xe.copyTo(u,e,t,u,n,r,o,i,a,s,0,l),m(u),p(u)},moveTo:function(e,n,r,o,i,a,s){var l=this;(!(t._supportsCalc&&s&t.CopyToOptions.formula)||l._checkArrayFormula(e,n,i,a,!0)&&l._checkArrayFormula(r,o,i,a,!0))&&(d(l),h(l),xe.moveTo(l,e,n,l,r,o,i,a,s),m(l),p(l))},_clipboardCopy:function(e,t,n){var r=this,o=r._getCopyRange(e);if(o){var s=r._getIgnoredRowsCols(e),u="\t",c="\r\n",f='"',d=r._eventHandler,p=x(r,o.row,i(o),o.col,a(o),c,u,f,!1,s.rows,s.cols),h=r._getClipboardHelper();h._fromSheet=r,h._ranges=e,h._isCutting=t;var m=h._getRangeHtml(r,o.row,i(o),o.col,a(o),l(r),s.rows,s.cols);r._clearFloatingObjectClipboardHelper&&r._clearFloatingObjectClipboardHelper();try{var g={sheet:r,sheetName:r._name,isCutting:t,copyData:{text:p,html:m},cancel:!1};r._trigger(Ie.ClipboardChanging,g),g&&!1===g.cancel?(d&&!n&&d._switchFocusForClipboard(m),r._trigger(Ie.ClipboardChanged,{isCutting:t,sheet:r,sheetName:r._name,copyData:{text:p,html:m}}),setTimeout(function(){!d||n||r._disposed||d._switchBackFocusAfterClipboard()},500)):(h._fromSheet=Xe,h._ranges=Xe)}catch(e){}return{copyText:p,copyHtml:m}}},_checkPastedRange:function(e,t,n,r,o,i){var a=c().Exp_PasteSourceCellsLocked;if(i.pastedInternal=!1,i.pastedRange=Xe,!(e||o&&""!==o))return!1;var s=this,l=s,u=s._getIgnoredRowsCols(t);if(s._isPastedInternal(e,s._getCopyRange(t),l,o,u.rows,u.cols)||!o){if(i.pastedInternal=!0,r&&e.options.isProtected&&e._isAnyCellInRangesLocked(t))return s._raiseInvalidOperation(1,a),!1;i.pastedRange=s._getPastedRange(e,t,l,n,r)}else i.pastedRange=s._getPastedRangefromText(n,o);return s._checkPasteRangeImp(e,t,n,r,i)},_checkPasteRangeImp:function(e,t,n,s,l){var u=c().Exp_InvalidCopyPasteSize,f=c().Exp_PasteDestinationCellsLocked,d=c().Exp_PasteChangeMergeCell,p=c().Exp_ChangePartOfArray,h=this,m=h,g=l.pastedRange;if(!g)return h._raiseInvalidOperation(1,u),!1;if(!m._canChange(g.row,g.col,i(g),a(g),f,p))return!1;if(l.pastedInternal){var _=t.length;if(1===_){var v=t[0];if(s&&!e._canChange(v.row,v.col,i(v),a(v),f,p))return!1;if(e._hasPartSpans(v.row,v.col,i(v),a(v)))return h._raiseInvalidOperation(1,d),!1;var y=g.row<0?r(m):i(g),b=g.col<0?o(m):a(g),w=v.row<0?r(e):i(v),C=v.col<0?o(e):a(v);if(y>w||b>C){var S=n.row,x=n.col;n.row<0&&w<r(m)&&(S=0),n.col<0&&C<o(m)&&(x=0),y%w==0&&1===b?(b=C,g=l.pastedRange=new Ve(S,x,y,b)):1===y&&b%C==0?(y=w,g=l.pastedRange=new Ve(S,x,y,b)):y%w==0&&b%C==0||(y=w,b=C,g=l.pastedRange=new Ve(S,x,y,b));for(var T=Qe(y/w),E=Qe(b/C),M=0;M<T;M++)for(var A=0;A<E;A++)if(!h._isSingleCellToSpanCell(v,g)&&m._hasPartSpans(S<0?-1:S+M*w,x<0?-1:x+A*C,S<0?-1:w,x<0?-1:C))return h._raiseInvalidOperation(1,d),!1}else if(!h._isSingleCellToSpanCell(v,g)&&m._hasPartSpans(g.row,g.col,i(g),a(g)))return h._raiseInvalidOperation(1,d),!1}else if(_>1){for(var k=0;k<_;k++){var R=t[k];if(e._hasPartSpans(R.row,R.col,i(R),a(R)))return h._raiseInvalidOperation(1,d),!1}if(m._hasPartSpans(g.row,g.col,i(g),a(g)))return h._raiseInvalidOperation(1,d),!1}}else{if(m._hasPartSpans(g.row,g.col,i(g),a(g)))return h._raiseInvalidOperation(1,d),!1;if(!m._isValidPasteRange(g.row,g.col,i(g),a(g)))return h._raiseInvalidOperation(1,u),!1}return!0},_isSingleCellToSpanCell:function(e,t){if(e&&1===i(e)&&1===a(e)){var n=this.getSpan(t.row,t.col);if(n&&n.equals(t))return!0}return!1},_isPastedInternal:function(e,t,n,r,o,s){if(e&&t&&n){var l=x(e,t.row,i(t),t.col,a(t),"\r\n","\t",'"',!1,o,s,!0,We.safari),u=l===r;return u||(u=l===r+"\r\n",!u&&We.chrome&&(u=l===r+"\t\r\n"),u||!We.safari&&!We.chrome||(u=l.replace(/\s/g,"")===r.replace(/\s/g,""))),u}return!1},_getPastedRange:function(e,t,n,s,l){var u=this,c=t.length;if(1===c){var f=t[0],d=f.row<0?0:f.row,p=f.col<0?0:f.col,h=f.row<0?r(e):i(f),m=f.col<0?o(e):a(f),g=s.row<0?0:s.row,_=s.col<0?0:s.col,v=s.row<0?r(n):i(s),y=s.col<0?o(n):a(s);if(l?(v=h,y=m):v%h==0&&1===y?y=m:1===v&&y%m==0?v=h:v%h==0&&y%m==0||(v=h,y=m),!u._isValidRange(d,p,h,m,r(e),o(e)))return Xe;if(!n._isValidPasteRange(g,_,v,y))return Xe;var b=new Ve(g,_,v,y);if(!l&&e._name===n._name)if(b.contains(d,p,h,m)){if((d-g)%h!=0||(p-_)%m!=0)return Xe}else if(b.intersect(d,p,h,m)&&(v>h||y>m))return Xe;return-1===s.row&&(g=-1,v=-1),-1===s.col&&(_=-1,y=-1),new Ve(g,_,v,y)}return c>1?u._getPastedRangeForMultiCopy(t,s):Xe},_getPastedRangeForMultiCopy:function(e,t){if(e.length>1){var n=e[0],r=e[1],o=n.rowCount,i=n.colCount;if(n.row===r.row&&o===r.rowCount){var a=0;return e.forEach(function(e){a+=e.colCount}),Ce._createRange(t.row,t.col,o,a)}if(n.col===r.col&&i===r.colCount){var s=0;return e.forEach(function(e){s+=e.rowCount}),Ce._createRange(t.row,t.col,s,i)}}return Xe},_getPastedRangefromText:function(e,t){var n=Xe,r=T(t,"\r\n","\t",'"');if(r){var o=e.row<0?0:e.row,i=e.col<0?0:e.col,a=r.length,s=C(r);a>0&&s>0&&(n=new Ve(o,i,a,s))}return n},_clearClipboard:function(){var e=this._getClipboardHelper();e&&(e._fromSheet=Xe,e._ranges=Xe,e._isCutting=!1)},_clipboardPaste:function(e,n,s,l,f,d,p,h,m){if(e&&s._name===e._name&&s.parent&&!Ae(s.parent.sheets,e))return void e._clearClipboard();var g,_,v,y,b,w,C=_e._convertPasteOption(h);if(e&&n){if(0!=(2&C)&&f&&t._supportsCalc&&(e._hasPartArrayFormulas(n.row,n.col,i(n),a(n))||s._hasPartArrayFormulas(l.row,l.col,i(l),a(l))))throw c().Exp_ChangePartOfArray;if(f)xe.moveTo(e,n.row,n.col,s,l.row,l.col,i(n),a(n),C),e._clearClipboard();else{var S=l.row<0?r(s):i(l),x=l.col<0?o(s):a(l);if(v=n.row<0?r(e):i(n),y=n.col<0?o(e):a(n),S>v||x>y){g=l.row,_=l.col,l.row<0&&v<r(s)&&(g=0),l.col<0&&y<o(s)&&(_=0),S%v==0&&1===x?x=y:1===S&&x%y==0?S=v:S%v==0&&x%y==0||(S=v,x=y);var T=Qe(S/v),E=Qe(x/y);t._supportsCalc&&(e.suspendCalcService(),s.suspendCalcService());try{for(b=0;b<T;b++)for(w=0;w<E;w++)xe.copyTo(e,n.row,n.col,s,g<0?-1:g+b*v,_<0?-1:_+w*y,g<0?-1:v,_<0?-1:y,C,m,u(e))}finally{t._supportsCalc&&(e.resumeCalcService(!1),s.resumeCalcService(!1))}}else xe.copyTo(e,n.row,n.col,s,l.row,l.col,i(n),a(n),C,m,u(e))}}else{g=l.row,_=l.col,v=i(l),y=a(l);var M=s._getSpanModel(),A=[];M.each(g,_,v,y,function(e){e&&A.push(e)});for(var k=0,R=A.length;k<R;k++)M.remove(A[k]);if(t._supportsCalc&&(1&C)>0&&s.clearFormula(g,_,v,y,function(e,t){return!e._isRowFilterOut||!e._isRowFilterOut(t)}),d&&""!==d){if(p){var I=s._getClipboardHelper();I&&I._setRangeHtml(p,s,g,_)}s.setCsv(g,_,d,"\r\n","\t",16)}else for(b=0;b<v;b++)for(w=0;w<y;w++)s.setValue(g+b,_+w,Xe)}},_doCut:function(e){if(!this.isEditing()){var t=this.getSelections();if(t&&1===t.length)return this._clipboardCopy(t,!0,e)}return Xe},_isValidMultiCopyRanges:function(e,t){if(e){var n=e.length;if(n>1){for(var r=0;r<n;r++)for(var o=e[r],i=r+1;i<n;i++){var a=e[i];if(o.intersect(a.row,a.col,a.rowCount,a.colCount))return!1}var s,l=e[0];for(r=1;r<n&&(s=e[r],l.row===s.row&&l.rowCount===s.rowCount);r++);if(r>=n)return t&&(t.inSameRow=!0),!0;for(r=1;r<n&&(s=e[r],l.col===s.col&&l.colCount===s.colCount);r++);if(r>=n)return t&&(t.inSameCol=!0),!0}}return!1},_getCopyRange:function(e){if(e){var t=e.length;if(1===t)return e[0];if(t>1){var n=e[0],r=e[t-1];if(n.row===r.row&&n.rowCount===r.rowCount){for(var o=0;o<t;o++){var i=e[o];i.col<n.col&&(n=i),i.col>r.col&&(r=i)}return Ce._createRange(n.row,n.col,n.rowCount,r.col+r.colCount-n.col)}if(n.col===r.col&&n.colCount===r.colCount){for(o=0;o<t;o++)i=e[o],i.row<n.row&&(n=i),i.row>r.row&&(r=i);return Ce._createRange(n.row,n.col,r.row+r.rowCount-n.row,n.colCount)}}}return Xe},_getIgnoredRowsCols:function(e){var t=[],n=[];if(e){var r=e.length;if(r>1){var o=e[0],i=e[r-1],a=o.row===i.row&&o.rowCount===i.rowCount,s=o.col===i.col&&o.colCount===i.colCount;if(a||s){e.sort(a?function(e,t){return e.col-t.col}:function(e,t){return e.row-t.row});for(var l=1;l<r;l++)for(var u=e[l-1],c=e[l],f=a?u.col+u.colCount:u.row+u.rowCount,d=a?c.col:c.row,p=a?n:t,h=f;h<d;h++)p.push(h)}}}return{rows:t,cols:n}},_doCopy:function(e){var t=this;if(!t.isEditing()){var n=t.getSelections();if(n&&1===n.length){var r=n[0];if(-1!==r.row&&t._hasRowFilterOut&&t._hasRowFilterOut()){for(var o=[],i=-1,a=0;a<r.rowCount;a++){var s=r.row+a;t._isRowFilterOut(s)?-1!==i&&(o.push(Ce._createRange(i,r.col,s-i,r.colCount)),i=-1):-1===i&&(i=s)}-1!==i&&o.push(Ce._createRange(i,r.col,r.row+r.rowCount-i,r.colCount)),n=o}return t._clipboardCopy(n,!1,e)}if(t._isValidMultiCopyRanges(n))return t._clipboardCopy(n,!1,e)}return Xe},_doPaste:function(e,t){var n,r,o,i=this,a=i._eventHandler;if(!i.isEditing()){e&&(n=e.pasteText,r=e.pasteHtml,o=e.callback),a&&!n&&a._switchFocusForClipboard("");(!(t&&86===t.keyCode)||We.msie||We.edge)&&setTimeout(function(){if(!i._disposed){var e=n||"",t=r||"";if(a&&!n){var s=i._getClipboardHelper();s&&(e=s._getClipboardText(),t=s._getClipboardHtml()),a._switchBackFocusAfterClipboard()}(We.msie||We.edge||n||!e)&&(i._doClipboardPaste(e,t),o&&o())}},100)}},_doClipboardPaste:function(e,t){var n=this,r=n._getPasteInfo(e);r&&(r.cmd="clipboardPaste",r.sheetName=n.name(),l(n)&&(r.clipboardHtml=t),n._commandManager().execute(r))},_getPasteInfo:function(e){var t=this,n=c().Exp_InvalidPastedArea,r=t._getClipboardHelper(),o=r._fromSheet,i=r._ranges,a=r._isCutting;a&&o&&i&&o.options.isProtected&&o._isAnyCellInRangesLocked(i)&&(a=!1);var s,l={pastedRange:Xe,pastedInternal:!1},u=[],f=t.getSelections();if(f.length>1)for(var d=0;d<f.length;d++){if(s=f[d],!t._checkPastedRange(o,[i[0]],s,a,e,l))return;if(s.containsRange(l.pastedRange)&&!s.equals(l.pastedRange))return void t._raiseInvalidOperation(1,n);u.push(l.pastedRange)}else{if(s=f.length>0?f[0]:t._getSpanModel().get(t._activeRowIndex,t._activeColIndex),!t._checkPastedRange(o,i,s,a,e,l))return;u.push(l.pastedRange)}var p=t._cutCopyIndicatorManager;p&&p._isPastedInternal(l.pastedInternal),l.pastedInternal||(o=Xe,i=Xe,a=!1);var h=t.options.clipBoardOptions;if(i&&1===i.length)for(var m=0;m<u.length;m++){var g=u[m];t._isSingleCellToSpanCell(i[0],g)&&(g.rowCount=1,g.colCount=1)}return{fromSheet:o,fromRanges:i,isCutting:a,pasteOption:h,pastedRanges:u,clipboardText:e}},_isValidPasteRange:function(e,t,n,i,a){var l=this,u=r(l),c=o(l);return s(l)?-1<=e&&(a||e<u)&&-1<=t&&(a||t<c):l._isValidRange(e,t,n,i,u,c)},_isAnyCellInRangesLocked:function(e){for(var t=0;t<e.length;t++)if(this._isAnyCellInRangeLocked(e[t]))return!0;return!1},_moveActiveCell:function(e,t,n,r){var o=this,i={sheet:o,sheetName:o._name,row:o._activeRowIndex,col:o._activeColIndex,cancel:!1};if(o._trigger(Ie.LeaveCell,i),(!i||!0!==i.cancel)&&(!o.endEdit||o.endEdit())){var a=o._activeRowIndex,s=o._activeColIndex;Me(n)&&(n=o._activeRowIndex),Me(r)&&(r=o._activeColIndex),3===e?o._moveActiveCellLeft(n,r,t):4===e?o._moveActiveCellRight(n,r,t):1===e?o._moveActiveCellUp(n,r,t):2===e?o._moveActiveCellDown(n,r,t):5===e?o._moveActiveCellFirst():6===e&&o._moveActiveCellLast(),o._moveActiveCellEnd(e,a,s)}},_moveActiveCellInSelection:function(e){var t=this,n={sheet:t,sheetName:t._name,row:t._activeRowIndex,col:t._activeColIndex,cancel:!1};if(t._trigger(Ie.LeaveCell,n),(!n||!0!==n.cancel)&&t.endEdit()){var r=t._activeRowIndex,o=t._activeColIndex;3===e?t._moveActiveCellLeftInSelection(t._activeRowIndex,t._activeColIndex):4===e&&t._moveActiveCellRightInSelection(t._activeRowIndex,t._activeColIndex),t._moveActiveCellEnd(e,r,o)}},_moveActiveCellEnd:function(e,t,n){var r=this,o=r._eventHandler,s=r._selectionModel,l=s.toArray(),u=!1;if(!r._isNavigateInSelection){var c=r._getActualRange(r._getActiveSelectedRange());(s.length>1||i(c)>1||a(c)>1)&&(u=!0),r._clearSelectionImp()}var f=r._activeRowIndex,d=r._activeColIndex,p=r._getSpanModel().get(f,d);if(r._activeRowCount=i(p),r._activeColCount=a(p),!r._isNavigateInSelection){var h=r._getExtendedRange(f,d),m=r.selectionPolicy(),g=r.selectionUnit();0===m?s.clear():1===m&&s.clear(),1===g?(h.col=-1,h.colCount=-1):2===g&&(h.row=-1,h.rowCount=-1),r._replaceActiveSelectedRange(h.row,h.col,i(h),a(h),!1);var _=s.toArray();o._notEqualSelecions(l,_)&&(r._raiseSelectionChanging(l,_),r._raiseSelectionChanged(l))}if(r._scrollByMoveCell(f,d),t!==f){var v=r._bindingManager;v&&v._doDataItemChanged()}var y=r._render;if(u){var b=r._getSheetLayout(),w=b._headerX,C=b._headerY,S=b.width-w,x=b.height-C;y._copyDoubleBuffer(w,C,S,x),y.repaint(new je(w,C,S,b._colHeaderHeight)),y.repaint(new je(w,C,b._rowHeaderWidth,x)),y._paintAdornment(y._getCtx())}else{var T=r._getSpanModel().get(t,n),E=i(T),M=a(T);y._repaintSelection(new Ve(f,d,r._activeRowCount,r._activeColCount).union(new Ve(t,n,E,M)))}var A={sheet:r,sheetName:r._name,row:f,col:d};r._trigger(Ie.EnterCell,A),r._trigger(Ie.FormulatextboxEnterCell,A),o._updateValidationUI&&o._updateValidationUI(f,d)},_validationError:function(e,t){var n=this,r=n.getDataValidator&&n.getDataValidator(e,t),o={sheet:n,sheetName:n._name,row:e,col:t,validator:r,validationResult:0};return n._trigger(Ie.ValidationError,o),o.validationResult}});var tt=t.Commands={};tt._navigateNoWrap=function(e,t){return!!e&&(2!==e._editorStatus&&(e._moveActiveCell(t,!1),!0))},tt._navigateNoWrapFrom=function(e,t,n,r){return!!e&&(2!==e._editorStatus&&(e._moveActiveCell(t,!1,n,r),!0))},tt._alterSelection=function(e,t,n){return!!e&&(2!==e._editorStatus&&(!(e.endEdit&&!e.endEdit())&&(e._changeActiveSelectedRange(t,n),!0)))};var nt="navigationLeft",rt="navigationRight",ot="navigationUp",it="navigationDown",at="navigationHome2",st="navigationEnd2",lt="navigationTop",ut="navigationBottom",ct="navigationHome",ft="navigationFirst",dt="navigationEnd",pt="navigationLast",ht="moveToNextCell",mt="moveToPreviousCell",gt="navigationPageUp",_t="navigationPageDown",vt="navigationPreviousSheet",yt="navigationNextSheet",bt="clear",wt="clearAndEditing",Ct="commitInputNavigationDown",St="commitInputNavigationUp",xt="cancelInput",Tt="commitArrayFormula",Et="selectionLeft",Mt="selectionRight",At="selectionUp",kt="selectionDown",Rt="selectionHome",It="selectionEnd",Ot="selectionPageUp",Dt="selectionPageDown",Pt="selectionTop",Nt="selectionBottom",Ft="selectionFirst",Lt="selectionLast",Ht="copy",Vt="cut",jt="paste",Bt="undo",Ut="redo",Wt="resizeColumn",zt="resizeRow",Yt="autoFitColumn",Gt="autoFitRow",Kt="editCell",Xt="renameSheet",qt="zoom",Jt="clearValues",Zt="clipboardPaste",Qt="selectNextControl",$t="selectPreviousControl",en="moveToNextCellThenControl",tn="moveToPreviousCellThenControl",nn="changeFormulaReference";tt._getWorksheet=E,tt._executeCommand=M,tt._initWorkbookCommands=function(e){var t=Ue._isMacOS(),n=!t,r=t;e.register(nt,tt[nt],37,!1,!1,!1,!1),e.register(rt,tt[rt],39,!1,!1,!1,!1),e.register(ot,tt[ot],38,!1,!1,!1,!1),e.register(it,tt[it],40,!1,!1,!1,!1),e.register(at,tt[at],37,n,!1,!1,r),e.register(st,tt[st],39,n,!1,!1,r),e.register(lt,tt[lt],38,n,!1,!1,r),e.register(ut,tt[ut],40,n,!1,!1,r),e.register(ct,tt[ct],36,!1,!1,!1,!1),e.register(ft,tt[ft],36,!0,!1,!1,!1),e.register(dt,tt[dt],35,!1,!1,!1,!1),e.register(pt,tt[pt],35,!0,!1,!1,!1),e.register(ht,tt[ht],9,!1,!1,!1,!1),e.register(mt,tt[mt],9,!1,!0,!1,!1),e.register(gt,tt[gt],33,!1,!1,!1,!1),e.register(_t,tt[_t],34,!1,!1,!1,!1),e.register(vt,tt[vt],33,n,!1,!1,r),e.register(yt,tt[yt],34,n,!1,!1,r),e.register(bt,tt[bt],46,!1,!1,!1,!1),e.register(wt,tt[wt],8,!1,!1,!1,!1),e.register(Ct,tt[Ct],13,!1,!1,!1,!1),e.register(St,tt[St],13,!1,!0,!1,!1),e.register(xt,tt[xt],27,!1,!1,!1,!1),e.register(Tt,tt[Tt],13,!0,!0,!1,!1),e.register(Et,tt[Et],37,!1,!0,!1,!1),e.register(Mt,tt[Mt],39,!1,!0,!1,!1),e.register(At,tt[At],38,!1,!0,!1,!1),e.register(kt,tt[kt],40,!1,!0,!1,!1),e.register(Rt,tt[Rt],36,!1,!0,!1,!1),e.register(It,tt[It],35,!1,!0,!1,!1),e.register(Ot,tt[Ot],33,!1,!0,!1,!1),e.register(Dt,tt[Dt],34,!1,!0,!1,!1),e.register(Rt,tt[Rt],37,n,!0,!1,r),e.register(It,tt[It],39,n,!0,!1,r),e.register(Pt,tt[Pt],38,n,!0,!1,r),e.register(Nt,tt[Nt],40,n,!0,!1,r),e.register(Ft,tt[Ft],36,!0,!0,!1,!1),e.register(Lt,tt[Lt],35,!0,!0,!1,!1),e.register(Ht,tt[Ht],67,n,!1,!1,r),e.register(Vt,tt[Vt],88,n,!1,!1,r),e.register(jt,tt[jt],86,n,!1,!1,r),e.register(Bt,tt[Bt],90,n,!1,!1,r),e.register(Ut,tt[Ut],89,n,!1,!1,r),e.register(Qt,tt[Qt]),e.register($t,tt[$t]),e.register(en,tt[en]),e.register(tn,tt[tn]),e.register(nn,tt[nn]),e.register(Wt,tt[Wt]),e.register(zt,tt[zt]),e.register(Yt,tt[Yt]),e.register(Gt,tt[Gt]),e.register(Kt,tt[Kt]),e.register(Xt,tt[Xt]),e.register(qt,tt[qt]),e.register(Jt,tt[Jt]),e.register(Zt,tt[Zt])},tt[nt]={canUndo:!1,execute:A(3)},tt[rt]={canUndo:!1,execute:A(4)},tt[ot]={canUndo:!1,execute:A(1)},tt[it]={canUndo:!1,execute:A(2)},tt[Tt]={canUndo:!1,execute:function(e,t){var n=E(e,t),r=tt._FormulatextboxCommands;return r&&(n=r._commitArrayFormula(n)),n._commitArrayFormula&&n._commitArrayFormula(),!0}},tt[Ct]={canUndo:!1,execute:function(e,t){var n=E(e,t),r=tt._FormulatextboxCommands;return r&&(n=r._commitInputNavigationDown(n)),n._moveActiveCell(2,!1),!0}},tt[St]={canUndo:!1,execute:function(e,t){var n=E(e,t),r=tt._FormulatextboxCommands;return r&&(n=r._commitInputNavigationUp(n)),n._moveActiveCell(1,!1),!0}},tt[ct]={canUndo:!1,execute:function(e,t){var n=E(e,t);return tt._navigateNoWrapFrom(n,4,Xe,n.frozenColumnCount()-1)}},tt[at]={canUndo:!1,execute:function(e,t){var n=E(e,t);return tt._navigateNoWrapFrom(n,4,Xe,-1)}},tt[dt]={canUndo:!1,execute:function(e,t){var n=E(e,t);return tt._navigateNoWrapFrom(n,3,Xe,o(n)-n.frozenTrailingColumnCount())}},tt[st]={canUndo:!1,execute:function(e,t){var n=E(e,t);return tt._navigateNoWrapFrom(n,3,Xe,o(n))}},tt[lt]={canUndo:!1,execute:function(e,t){var n=E(e,t);return tt._navigateNoWrapFrom(n,2,-1,Xe)}},tt[ut]={canUndo:!1,execute:function(e,t){var n=E(e,t);return tt._navigateNoWrapFrom(n,1,r(n),Xe)}},tt[gt]={canUndo:!1,execute:function(e,t){var n=E(e,t);if(!n||2===n._editorStatus)return!1;var r=n._getPrevPageTopRow();if(r===Xe||r===n._scrollTopRow)return!0;var o=n._getRowLayout(1,3),i=n._getNextVisualRow(n._activeRowIndex-o.length);i<r&&(i=r);var a=tt._FormulatextboxCommands;if(a){var s=a._navigationPageUp(n,i,r);if(s.r)return!0;n=s.sheet}return!!n.endEdit()&&(n._canSelect(i,n.getActiveColumnIndex())&&(n._setActiveCellCore(i,Xe),n._leadingCellRow=i,n._moveActiveCell()),n._setTopRow(r),!0)}},tt[_t]={canUndo:!1,execute:function(e,t){var n=E(e,t);if(!n||2===n._editorStatus)return!1;var r=n._getNextPageTopRow();if(r===Xe||r===n._scrollTopRow)return!0;var o=n._getRowLayout(1,3),i=n._getPrevVisualRow(n._activeRowIndex+o.length);i<r&&(i=r);var a=tt._FormulatextboxCommands;if(a){var s=a._navigationPageDown(n,i,r);if(s.r)return!0;n=s.sheet}return!!n.endEdit()&&(n._canSelect(i,n.getActiveColumnIndex())&&(n._setActiveCellCore(i,Xe),n._leadingCellRow=i,n._moveActiveCell()),n._setTopRow(r),!0)}},tt[yt]={canUndo:!1,execute:function(e,t){R(E(e,t),!0)}},tt[vt]={canUndo:!1,execute:function(e,t){R(E(e,t),!1)}},tt[ft]={canUndo:!1,execute:function(e,t){var n=E(e,t);if(!n||2===n._editorStatus)return!1;var r=tt._FormulatextboxCommands;if(r){var o=r._navigationFirst(n);if(o.r)return!0;n=o.sheet}return n._moveActiveCell(5,!1,n._activeRowIndex,n._activeColIndex),!0}},tt[pt]={canUndo:!1,execute:function(e,t){var n=E(e,t);if(!n||2===n._editorStatus)return!1;var r=tt._FormulatextboxCommands;if(r){var o=r._navigationLast(n);if(o.r)return!0;n=o.sheet}return n._moveActiveCell(6,!1,n._activeRowIndex,n._activeColIndex),!0}},tt[Qt]={canUndo:!1,execute:function(e,t){var n=E(e,t);return!!n.parent&&O(n,n.parent.nextControl)}},tt[$t]={canUndo:!1,execute:function(e,t){var n=E(e,t);return!!n.parent&&O(n,n.parent.previousControl)}},tt[ht]={canUndo:!1,execute:function(e,t){var n=E(e,t),r=tt._FormulatextboxCommands;return r&&(n=r._moveToNextCell(n)),I(n,4),!0}},tt[mt]={canUndo:!1,execute:function(e,t){var n=E(e,t),r=tt._FormulatextboxCommands;return r&&(n=r._moveToPreviousCell(n)),I(n,3),!0}},tt[en]={canUndo:!1,execute:function(e,t){var n=E(e,t),r=n._leadingCellRow,o=n.getActiveColumnIndex();n._isTabNavigation=!0;var i=n._getMoveRightCell(n.getActiveRowIndex(),o,!0,r);return n._isTabNavigation=!1,!i||(i.leadingCellRow<r||i.leadingCellRow===r&&o>i.col)?tt[Qt].execute(e,t):tt[ht].execute(e,t)}},tt[tn]={canUndo:!1,execute:function(e,t){var n=E(e,t),r=n._leadingCellRow,o=n.getActiveColumnIndex();n._isTabNavigation=!0;var i=n._getMoveLeftCell(n.getActiveRowIndex(),o,!0,r);return n._isTabNavigation=!1,!i||(i.leadingCellRow>r||i.leadingCellRow===r&&o<i.col)?tt[$t].execute(e,t):tt[mt].execute(e,t)}},tt[xt]={canUndo:!1,execute:function(e,t){var n=E(e,t),r=tt._FormulatextboxCommands;if(r&&r._cancelInput(n),n.isEditing()){var o=n.getValue(n._activeRowIndex,n._activeColIndex,3);return!!n.endEdit(!0)&&(n.setValue(n._activeRowIndex,n._activeColIndex,o,3,!0),!0)}var i=n.parent,a=i&&i.sheets;if(a)for(var s=0,l=a.length;s<l;s++){var u=a[s];u&&u._cutCopyIndicatorManager&&u._cutCopyIndicatorManager._cancelIndicator()}}},tt[bt]={canUndo:!1,execute:function(e,t){var n=E(e,t);if(!n.isEditing()){var r=n.getSelections();n._commandManager().execute({cmd:Jt,sheetName:n.name(),ranges:r})}}},tt[wt]={canUndo:!1,execute:function(e,t){var n=E(e,t);return!n.isEditing()&&(Ue._isMacOS()?(tt[bt].call(n),!0):(n.startEdit(!0,""),!0))}},tt[Ht]={canUndo:!1,execute:function(e,t,n,r){if(r&&r.target&&"gcAttachedFormulaTextBox"===r.target.getAttribute("gcuielement"))return{ignoreCancelDefault:!0};var o=E(e,t),i=t.copyData=o._doCopy(t.ignoreClipboard);return t.callback&&t.callback(),!i||qe}},tt[Vt]={canUndo:!1,execute:function(e,t){var n=E(e,t),r=t.cutData=n._doCut(t.ignoreClipboard);return t.callback&&t.callback(),!r||qe}},tt[jt]={canUndo:!1,execute:function(e,t,n,r){E(e,t)._doPaste(t,r)}},tt[Et]={canUndo:!1,execute:k(37)},tt[Mt]={canUndo:!1,execute:k(39)},tt[At]={canUndo:!1,execute:k(38)},tt[kt]={canUndo:!1,execute:k(40)},tt[Rt]={canUndo:!1,execute:k(37,!0)},tt[It]={canUndo:!1,execute:k(39,!0)},tt[Ot]={canUndo:!1,execute:k(33)},tt[Dt]={canUndo:!1,execute:k(34)},tt[Pt]={canUndo:!1,execute:k(38,!0)},tt[Nt]={canUndo:!1,execute:k(40,!0)},tt[Ft]={canUndo:!1,execute:k(36,!0)},tt[Lt]={canUndo:!1,execute:k(35,!0)},tt[nn]={canUndo:!1,execute:function(e,t){var n=E(e,t),r=n&&n._eventHandler;if(r){d(n);try{r._changeFormulaReference&&r._changeFormulaReference()}finally{p(n)}}}},tt[Bt]={canUndo:!1,execute:function(e,t){var n=e;if(n){var r=n.undoManager();r&&r.canUndo()&&r.undo()}}},tt[Ut]={canUndo:!1,execute:function(e,t){var n=e;if(n){var r=n.undoManager();r&&r.canRedo()&&r.redo()}}},tt[Wt]={canUndo:!0,execute:function(e,t,n){return M(e,X,t,n)}},tt[zt]={canUndo:!0,execute:function(e,t,n){return M(e,q,t,n)}},tt[Yt]={canUndo:!0,execute:function(e,t,n){return M(e,J,t,n)}},tt[Gt]={canUndo:!0,execute:function(e,t,n){return M(e,Z,t,n)}},tt[Kt]={canUndo:!0,execute:function(e,t,n){return M(e,Q,t,n)}},tt[Xt]={canUndo:!0,execute:function(e,t,n){return M(e,ee,t,n)}},tt[qt]={canUndo:!0,execute:function(e,t,n){return M(e,te,t,n)}},tt[Jt]={canUndo:!0,execute:function(e,t,n){return M(e,ie,t,n)}},tt[Zt]={canUndo:!0,execute:function(e,t,n){return M(e,ve,t,n)}};var rn={256:"bindingPath",4:"comment",2:"formula",16:"sparkline",64:"style",128:"tag",1:"value"};Ge(P.prototype,{_initCellsData:function(){var e=this,n=e._range,s=e._sheet;if(s&&n){var l=e._dataType,u=n.row,c=n.col,f=i(n),d=a(n),p=e._cellsData,h=!1;-1===u&&(h=!0,u=0,f=r(s)),-1===c&&(h=!0,c=0,d=o(s));var m,g,_=[];if((64&l)>0)for(var v=0;v<d;v++)_[v]=s._getStyleObject(-1,v)||Xe;for(var y=0;y<f;y++){var b=u+y;(64&l)>0&&(m=s._getStyleObject(b,-1)||Xe);for(var w=0;w<d;w++){var C,S=c+w;if(t._supportsCalc&&(2&l)>0&&s.getFormulaInformation&&(C=s.getFormulaInformation(b,S),C.hasFormula))if(C.isArrayFormula){var x=C.baseRange;if(x.row===b&&x.col===S)for(var T=x.row,E=x.row+i(x);T<E;T++)for(var M=x.col,A=x.col+a(x);M<A;M++)e._setCellData(p,T-u,M-c,C,2)}else e._setCellData(p,y,w,C.formula,2);if(!((1&l)>0)||C&&C.hasFormula||e._setCellData(p,y,w,s.getValue(b,S,3),1),(16&l)>0&&s.getSparkline){var k=s.getSparkline(b,S),R=Xe;k&&(R=k.data()),k&&R&&e._setCellData(p,y,w,k,16)}if((64&l)>0){var I;h?I=s.getActualStyle(b,S,3):(g=s._getStyleObject(b,S)||Xe,I=s._getCompositeStyle(b,S,3,g,m,_[w]));var O=qe;I&&I.toJSON&&(O=JSON.stringify(I.toJSON(3,!0))),e._setCellData(p,y,w,O,64)}var D=s.comments;(4&l)>0&&D&&e._setCellData(p,y,w,D.get(b,S),4),(128&l)>0&&e._setCellData(p,y,w,s.getTag(b,S,3),128),(256&l)>0&&e._setCellData(p,y,w,s.getBindingPath&&s.getBindingPath(b,S,3),256)}}}},_getCellsData:function(){return this._cellsData},_setCellData:function(e,t,n,r,o){!Me(r)&&e&&(e[t]===qe&&(e[t]=[]),e[t][n]===qe&&(e[t][n]={}),e[t][n][rn[o]]=r)},_mergeCellsHasDiffData:function(e){if(e)for(var t=this,n=t._cellsData,r=0,o=e.length;r<o;r++){var i=e[r];if(i)for(var a=0,s=i.length;a<s;a++){var l=i[a];if(l){n[r]||(n[r]=[]);var u=n[r][a];u?t._isDataEqual(l,u)&&(n[r][a]=qe):n[r][a]=l}}}},_isDataEqual:function(e,t){var n=this._dataType,r=[];256&n&&r.push(rn[256]),4&n&&r.push(rn[4]),2&n&&r.push(rn[2]),16&n&&r.push(rn[16]),64&n&&r.push(rn[64]),128&n&&r.push(rn[128]),1&n&&r.push(rn[1]);for(var o=0,i=r.length;o<i;o++){var a=r[o];if(e[a]!==t[a])return!1}return!0},_getChangedCells:function(){var e=this,t=e._range.row,n=e._range.col,r=e._cellsData,o=e._changedCells;if(o&&o.length>0)return o;o=[],t=-1===t?0:t,n=-1===n?0:n;for(var i=0,a=r.length;i<a;i++){var s=r[i];if(s)for(var l=0,u=s.length;l<u;l++)s[l]&&o.push({row:i+t,col:l+n})}return e._changedCells=o,o}}),tt._ChangedCells=P,Ge(N.prototype,{_defaultStyle:ze("a"),_defaultColumnWidth:ze("b"),_defaultRowHeight:ze("c"),_tag:ze("d"),_columnHeaderDefaultStyle:ze("e"),_columnHeaderDefaultRowHeight:ze("f"),_rowHeaderDefaultStyle:ze("g"),_rowHeaderDefaultColumnWidth:ze("h")}),Ge(H.prototype,{_values:F("a"),_formulas:F("b"),_arrayFormulas:function(e){var t=this;if(0===arguments.length)return t._afs;t._afs||(t._afs=[]),Ye(e)&&t._afs.push(e)},_sparklines:F("c"),_styles:F("d"),_comments:F("e"),_tags:F("f"),_bindingPaths:F("g"),_spans:function(e){var t=this;if(0===arguments.length)return t._sps;t._sps||(t._sps=[]),t._sps.push(e)},_isValueOrFormulaSaved:function(){return this._isValueSaved()||this._isFormulaSaved()||this._isArrayFormulaSaved()},_isValueSaved:function(){return L(this._values())},_isFormulaSaved:function(){return L(this._formulas())},_isArrayFormulaSaved:function(){return L(this._arrayFormulas())},_isSparklineSaved:function(){return L(this._sparklines())},_isStyleSaved:function(){return L(this._styles())},_isCommentSaved:function(){return L(this._comments())},_isTagSaved:function(){return L(this._tags())},_isSpanSaved:function(){return this._spanSaved},_isBindingPathSaved:function(){return L(this._bindingPaths())}}),tt._CopyMoveCellsInfo=H,Ge(B.prototype,{_width:V("a",0),_visible:V("b",!0),_resizable:V("c",!0),_tag:V("d",qe),_viewportColumnStyle:V("e",Xe),_headerColumnStyle:V("f",Xe),_saveRangeGroup:function(e,t,n){var r=this;r._levels[e]!==Xe?r._levels[e]=t<0?Xe:t:t>=0&&(r._levels[e]=t),r._collapsed[e]!==Xe?r._collapsed[e]=n||Xe:n&&(r._collapsed[e]=n),r._rangeGroupSaved=!0},_getRangeGroup:function(e,t){var n=this;t.level=-1,t.collapsed=!1,n._levels[e]!==Xe&&(t.level=n._levels[e]),n._collapsed[e]!==Xe&&(t.collapsed=n._collapsed[e])},_bindingField:V("g",qe),_isWidthSaved:j("a"),_isVisibleSaved:j("b"),_isResizableSaved:j("c"),_isTagSaved:j("d"),_isViewportColumnStyleSaved:j("e"),_isHeaderColumnStyleSaved:j("f"),_isRangeGroupSaved:function(){return this._rangeGroupSaved},_isBindingFieldSaved:j("g")}),Ge(U.prototype,{_height:V("a",0),_visible:V("b",!0),_resizable:V("c",!0),_tag:V("d",qe),_viewportRowStyle:V("e",Xe),_headerRowStyle:V("f",Xe),_saveRangeGroup:function(e,t,n){var r=this;r._levels[e]!==Xe?r._levels[e]=t<0?Xe:t:t>=0&&(r._levels[e]=t),r._collapsed[e]!==Xe?r._collapsed[e]=n||Xe:n&&(r._collapsed[e]=n),r._rangeGroupSaved=!0},_getRangeGroup:function(e,t){var n=this;t.level=-1,t.collapsed=!1,n._levels[e]!==Xe&&(t.level=n._levels[e]),n._collapsed[e]!==Xe&&(t.collapsed=n._collapsed[e])},_isHeightSaved:j("a"),_isVisibleSaved:j("b"),_isResizableSaved:j("c"),_isTagSaved:j("d"),_isViewportRowStyleSaved:j("e"),_isHeaderRowStyleSaved:j("f"),_isRangeGroupSaved:function(){return this._rangeGroupSaved}}),tt._CopyMoveRowsInfo=U,z._saveSheetInfo=function(e,t,n){var r=e.defaults;(64&n)>0&&(t._defaultStyle(e.getDefaultStyle()),t._columnHeaderDefaultStyle(e.getDefaultStyle(1)),t._rowHeaderDefaultStyle(e.getDefaultStyle(2))),(128&n)>0&&t._tag(e.tag()),t._defaultColumnWidth(r.colWidth),t._defaultRowHeight(r.rowHeight),t._columnHeaderDefaultRowHeight(r.colHeaderRowHeight),t._rowHeaderDefaultColumnWidth(r.rowHeaderColWidth)},z._saveColumnHeaderInfo=function(e,t,n,r,o){var i=t._rowCount,a=t._columnCount;W(e,1,0,r,i,a,o,t);var s,l;if((1&o)>0)for(s=0;s<a;s++)(l=e.getDataColumnName&&e.getDataColumnName(r+s))&&n._bindingField(s,l);(32&o)>0&&(t._spanSaved=!0,e._getSpanModel(1).each(0,r,i,a,function(e){t._spans(e)}));var u=e.columnOutlines;for(a=n._columnCount,s=0;s<a;s++)n._width(s,e._getActualColumnWidth(r+s)),n._visible(s,e.getColumnVisible(r+s)),n._resizable(s,e.getColumnResizable(r+s)),(128&o)>0&&n._tag(s,e.getTag(-1,r+s)),(64&o)>0&&(n._viewportColumnStyle(s,e._getStyleObject(-1,r+s,3)),n._headerColumnStyle(s,e._getStyleObject(-1,r+s,1))),(8&o)>0&&u&&!u._isEmpty()&&n._saveRangeGroup(s,u.getLevel(r+s),u.getCollapsed(r+s))},z._saveRowHeaderInfo=function(e,t,n,r,o){if(!((1023&o)<=0)){var i=t._rowCount,a=t._columnCount;W(e,2,r,0,i,a,o,t),(32&o)>0&&(t._spanSaved=!0,e._getSpanModel(2).each(r,0,i,a,function(e){t._spans(e)}));var s=e.rowOutlines;i=n._rowCount;for(var l=0;l<i;l++)n._height(l,e._getActualRowHeight(r+l)),n._visible(l,e.getRowVisible(r+l)),n._resizable(l,e.getRowResizable(r+l)),(128&o)>0&&n._tag(l,e.getTag(r+l,-1)),(64&o)>0&&(n._viewportRowStyle(l,e._getStyleObject(r+l,-1,3)),n._headerRowStyle(l,e._getStyleObject(r+l,-1,2))),(8&o)>0&&s&&!s._isEmpty()&&n._saveRangeGroup(l,s.getLevel(r+l),s.getCollapsed(r+l))}},z._saveViewportInfo=function(e,t,n,r,o){if(!((1023&o)<=0)){var i=t._rowCount,a=t._columnCount;W(e,3,n,r,i,a,o,t),(32&o)>0&&(t._spanSaved=!0,e._getSpanModel().each(n,r,i,a,function(e){t._spans(e)}))}},z._saveTableInfo=function(e,t,n){if(e.tables){var r=e.tables.all();if(r)for(var o=0,i=r.length;o<i;o++){var a=r[o];if(n.containsRange(a.range())){var s=a.clone();s._copyDataSource(a),t.push(s)}}}},z._undoCellsInfo=function(e,n,r,o,s){var l,u,c,f,d,p,g=n._rowCount,_=n._columnCount,v=e.comments;t._supportsCalc&&e.suspendCalcService(),h(e);try{for(var y=0;y<g;y++)for(var b=0;b<_;b++)n._isBindingPathSaved()&&e.setBindingPath&&e.setBindingPath(r+y,o+b,Xe,s),n._isFormulaSaved()&&3===s&&e.setFormula(r+y,o+b,Xe),n._isSparklineSaved()&&3===s&&e.removeSparkline(r+y,o+b),n._isValueSaved()&&e.setValue(r+y,o+b,Xe,s),n._isStyleSaved()&&e._setStyleObject(r+y,o+b,Xe,s),n._isCommentSaved()&&v&&v.remove(r+y,o+b),n._isTagSaved()&&e.setTag(r+y,o+b,Xe,s);if(n._isBindingPathSaved()&&e.setBindingPath){var w=n._bindingPaths();for(l=0;l<w.length;l++){var C=w[l];e.setBindingPath(r+C.row,o+C.column,C.value,s)}}if(n._isValueSaved()){var S=n._values();for(l=0;l<S.length;l++){var x=S[l];e.setValue(r+x.row,o+x.column,x.value,s)}}if(n._isFormulaSaved()&&3===s){var T=n._formulas();for(l=0;l<T.length;l++)f=T[l],e.setFormula(r+f.row,o+f.column,f.value)}if(n._isSparklineSaved()&&3===s)for(var E=n._sparklines(),M=0;M<E.length;M++){var A=E[M],k=A.value;k?k.dateAxisData()?e.setSparkline(r+A.row,o+A.column,k.data(),k.dataOrientation(),k.sparklineType(),k.setting(),k.dateAxisData(),k.dateAxisOrientation()):e.setSparkline(r+A.row,o+A.column,k.data(),k.dataOrientation(),k.sparklineType(),k.setting()):e.removeSparkline(r+A.row,o+A.column)}if(n._isStyleSaved()){var R=n._styles();for(l=0;l<R.length;l++){var I=R[l];e._setStyleObject(r+I.row,o+I.column,I.value,s)}}if(n._isCommentSaved()&&v){var O=n._comments();for(l=0;l<O.length;l++){var D=O[l],P=D.value;v._addInternal(r+D.row,o+D.column,P)}}if(n._isTagSaved())for(var N=n._tags(),F=N.length,L=0;L<F;L++){var H=N[L];e.setTag(r+H.row,o+H.column,H.value,s)}if(t._supportsCalc&&n._isArrayFormulaSaved()&&3===s){var V=e._getsArrayFormulas(r,o,g,_);if(V&&V.length>0)for(d=V.getLength(0),p=0;p<d;p++)c=V[p][0],e.setArrayFormula(c.row,c.col,i(c),a(c),Xe);if((V=n._arrayFormulas())&&V.length>0)for(d=V.length,p=0;p<d;p++){var j=V[p],B=j.baseRange;e.setArrayFormula(B.row,B.col,i(B),a(B),j.formula)}}}finally{t._supportsCalc&&e.resumeCalcService(!1),m(e)}if(n._isSpanSaved()){var U=e._getSpanModel(s);if(U&&U.length>0){var W=[];for(U.each(r,o,g,_,function(e){e&&W.push(e)}),l=0;l<W.length;l++)u=W[l],U.remove(u)}if(U){var z=n._spans();if(z)for(l=0;l<z.length;l++)u=z[l],U.addSpan(u)}}},z._undoColumnsInfo=function(e,t,n){var r,o=t._columnCount;if(t._isBindingFieldSaved()&&e.bindColumn){var i={fieldName:Xe};for(r=0;r<o;r++)t.getBindingField(r,i)&&e.bindColumn(n+r,i.fieldName)}for(r=0;r<o;r++)t._isWidthSaved()&&e.setColumnWidth(n+r,t._width(r),3),t._isVisibleSaved()&&e.setColumnVisible(n+r,t._visible(r),3),t._isResizableSaved()&&e.setColumnResizable(n+r,t._resizable(r),3),t._isTagSaved()&&e.setTag(-1,n+r,t._tag(r),3),t._isViewportColumnStyleSaved()&&e._setStyleObject(-1,n+r,t._viewportColumnStyle(r),3),t._isHeaderColumnStyleSaved()&&e._setStyleObject(-1,n+r,t._headerColumnStyle(r),1);if(t._isRangeGroupSaved()){var a=e.columnOutlines;if(a){var s={level:Xe,collapsed:Xe};for(r=0;r<o;r++)t._getRangeGroup(r,s),a._setLevel(n+r,s.level),a.setCollapsed(n+r,s.collapsed)}}},z._undoRowsInfo=function(e,t,n){var r,o=t._rowCount;for(r=0;r<o;r++)t._isHeightSaved()&&e.setRowHeight(n+r,t._height(r),3),t._isVisibleSaved()&&e.setRowVisible(n+r,t._visible(r),3),t._isResizableSaved()&&e.setRowResizable(n+r,t._resizable(r),3),t._isTagSaved()&&e.setTag(n+r,-1,t._tag(r),3),t._isViewportRowStyleSaved()&&e._setStyleObject(n+r,-1,t._viewportRowStyle(r),3),t._isHeaderRowStyleSaved()&&e._setStyleObject(n+r,-1,t._headerRowStyle(r),2);if(t._isRangeGroupSaved()){var i=e.rowOutlines;if(i){var a={level:Xe,collapsed:Xe};for(r=0;r<o;r++)t._getRangeGroup(r,a),i._setLevel(n+r,a.level),i.setCollapsed(n+r,a.collapsed)}}},z._undoSheetInfo=function(e,t){var n=t._defaultStyle(),r=e.defaults;Ye(n)&&e.setDefaultStyle(n),n=t._defaultColumnWidth(),Ye(n)&&(r.colWidth=n),n=t._defaultRowHeight(),Ye(n)&&(r.rowHeight=n),n=t._tag(),Ye(n)&&e.tag(n),n=t._columnHeaderDefaultStyle(),Ye(n)&&e.setDefaultStyle(n,1),n=t._columnHeaderDefaultRowHeight(),Ye(n)&&(r.colHeaderRowHeight=n),n=t._rowHeaderDefaultStyle(),Ye(n)&&e.setDefaultStyle(n,2),n=t._rowHeaderDefaultColumnWidth(),Ye(n)&&(r.rowHeaderColWidth=n)},z._undoTableInfo=function(e,t,n){var r=e.tables;if(r){var o,i,a=t.length;if(a>0)for(o=0;o<a;o++)i=t[o],r._addInternal(i);else{var s=r.all();if(s)for(o=s.length-1;o>=0;o--)i=s[o],n.containsRange(i.range())&&r._removeInternal(i)}}},z._getValues=function(e,t,n,i,a){t<0&&(t=0,i=r(e)),n<0&&(n=0,a=o(e));for(var s=[],l=0;l<i;l++)for(var u=0;u<a;u++){var c=e.getValue(t+l,n+u);c!==qe&&c!==Xe&&s.push(new D(l,u,c))}return s},z._raiseRangeDataChanged=function(e,t,n,i,a,s,l){e&&(t<0&&(t=0,i=r(e)),n<0&&(n=0,a=o(e)),e._raiseRangeDataChanged(t,n,i,a,s,l))},z._clearFormula=function(e,t,n,r,o){var i=e._getCalcModel();i&&i.clear(t,n,r,o)},tt._CopyMoveHelper=z,K.prototype={constructor:K,execute:function(){},canExecute:function(){return!0},canUndo:function(){return!0},saveState:function(){},undo:function(){return!0},_beforeAction:Y,_afterAction:G},tt.ActionBase=K,Ke(X,K),Ge(X.prototype,{_doAction:function(e){var t=this,n=!1;if(e?t.canUndo():t.canExecute()){var r=t._command,i=t._sheet,a=r.columns,s=r.rowHeader,l=a&&a.length,u=$e;if(i&&l>0){var c=t._getColList(a),f={sheet:i,sheetName:i._name,colList:c,header:s,cancel:!1};if(i._trigger(De,f),f&&!0===f.cancel)return n;r._canUndo=!0,e||t.saveState(),Y(i);try{for(var d=2,p=3,h=s?o(i,d):o(i,p),m=i._scrollLeftCol,g=m,_=i.frozenColumnCount(),v=m-1;v>=_&&!(i.getColumnVisible(v)&&i._getZoomColumnWidth(v)>0);v--)i.getColumnResizable(v)&&(g=v);for(var y=u,b=r.size,w=0;w<l;w++)for(var C=a[w],S=C.firstCol,x=C.lastCol,T=S;T<=x;T++)0<=T&&T<h&&(e&&(b=r._oldSizes[w][T-S]),s&&i.getColumnResizable(T,d)&&b!==i._getActualColumnWidth(T,d)?(i.setColumnWidth(T,b,d),n=!0):!s&&i.getColumnResizable(T,p)&&b!==i._getActualColumnWidth(T,p)&&(i.setColumnWidth(T,b,p),n=!0),y=Je(T,y));y!==u&&y<=m&&g!==m&&(i._scrollLeftCol=g)}finally{G(i,!1,!0)}i._trigger(Pe,{sheet:i,sheetName:i._name,colList:c,header:r.rowHeader}),i._syncHScrollbarPosition()}}return n},execute:function(){return this._doAction(!1)},saveState:function(){var e=this,t=e._command,n=[],r=e._sheet,i=t.columns,a=i&&i.length;if(r&&a>0)for(var s=t.rowHeader,l=s?2:3,u=o(r,l),c=s?r.defaults.rowHeaderColWidth:r.defaults.colWidth,f=0;f<a;f++){var d,p,h=i[f],m=h.firstCol,g=h.lastCol;n[f]=[];for(var _=m;_<=g;_++)d=_-m,0<=_&&_<u?(p=r.getColumnWidth(_,l),p=et(p)||p===Xe?c:Qe(p),n[f][d]=p):n[f][d]=-1}t._oldSizes=n},undo:function(){return this._doAction(!0)},_getColList:function(e){for(var t=[],n=0,r=e.length;n<r;n++)for(var o=e[n],i=o.firstCol,a=o.lastCol,s=i;s<=a;s++)t.push(s);return t},canUndo:function(){return this._command._canUndo}}),Ke(q,K),Ge(q.prototype,{_doAction:function(e){var t=this,n=!1;if(e?t.canUndo():t.canExecute()){var o=t._sheet,i=t._command,a=i.rows,s=a&&a.length,l=$e;if(o&&s>0){var u=t._getRowList(a),c={sheet:o,sheetName:o._name,rowList:u,header:i.columnHeader,cancel:!1};if(o._trigger(Ne,c),c&&!0===c.cancel)return n;i._canUndo=!0,e||t.saveState(),Y(o);try{for(var f=3,d=1,p=i.columnHeader,h=p?r(o,d):r(o,f),m=o._scrollTopRow,g=m,_=o.frozenRowCount(),v=m-1;v>=_&&!(o.getRowVisible(v)&&o._getZoomRowHeight(v)>0);v--)o.getRowResizable(v)&&(g=v);for(var y=l,b=i.size,w=0;w<s;w++)for(var C=a[w],S=C.firstRow,x=C.lastRow,T=S;T<=x;T++)0<=T&&T<h&&(e&&(b=i._oldSizes[w][T-S]),p&&o.getRowResizable(T,d)&&b!==o._getActualRowHeight(T,d)?(o.setRowHeight(T,b,d),n=!0):!p&&o.getRowResizable(T,f)&&b!==o._getActualRowHeight(T,f)&&(null==o._getActualAutoFitRowHeight(T)&&o.autoFitRow(T),o.setRowHeight(T,b,f),n=!0),y=Je(T,y));y!==l&&y<=m&&g!==m&&(o._scrollTopRow=g)}finally{G(o,!1,!0)}o._trigger(Fe,{sheet:o,sheetName:o._name,rowList:u,header:i.columnHeader}),o._syncVScrollbarPosition()}}return n},execute:function(){return this._doAction(!1)},saveState:function(){var e=this,t=e._command,n=[],o=e._sheet,i=t.rows,a=i&&i.length;if(o&&a>0)for(var s=t.columnHeader,l=s?1:3,u=r(o,l),c=s?o.defaults.colHeaderRowHeight:o.defaults.rowHeight,f=0;f<a;f++){var d,p,h=i[f],m=h.firstRow,g=h.lastRow;n[f]=[];for(var _=m;_<=g;_++)d=_-m,0<=_&&_<u?(p=o.getRowHeight(_,3),p=et(p)||p===Xe?c:Qe(p),n[f][d]=p):n[f][d]=-1}t._oldSizes=n},undo:function(){return this._doAction(!0)},_getRowList:function(e){for(var t=[],n=0,r=e.length;n<r;n++)for(var o=e[n],i=o.firstRow,a=o.lastRow,s=i;s<=a;s++)t.push(s);return t},canUndo:function(){return this._command._canUndo}}),Ke(J,K),Ge(J.prototype,{canExecute:function(){var e=this._command;return this._sheet&&e.columns&&e.columns.length>0},_doAction:function(e){var t=this,n=!1;if(e?t.canUndo():t.canExecute()){var i=t._command,a=t._sheet,s=t._sheetArea,l=t._getColList(i.columns),u=2===s,c={sheet:a,sheetName:a.name(),colList:l,header:u,cancel:!1};if(a._trigger(De,c),c&&!0===c.cancel)return n;i._canUndo=!0,e||t.saveState();var f,d,p,h=o(a,s),m=h-1,g=0;for(d=0,p=i.columns.length;d<p;d++)f=i.columns[d].col,m=m>f?f:m,g=g<f?f:g;Be._startCache(a,0,m,r(a)-1,g),Y(a);try{var _;for(d=0,p=i.columns.length;d<p;d++){var v=i.columns[d].col;0<=v&&v<h&&a.getColumnResizable(v,s)&&(_=e?i._oldSizes[d]:t._getColumnAutoFitValue(v))!==a.getColumnWidth(v,s)&&(a.setColumnWidth(v,_,s),n=!0)}}finally{Be._clearCache(),G(a,!1,!0)}a._trigger(Pe,{sheet:a,sheetName:a._name,colList:l,header:u})}return n},execute:function(){return this._doAction(!1)},saveState:function(){var e=this,t=e._command,n=Xe,r=e._sheet,i=e._sheetArea;if(r&&t.columns&&t.columns.length>0){var a=o(r,i);n=[t.columns.length];for(var s=0,l=t.columns.length;s<l;s++){var u=t.columns[s];0<=u.col&&u.col<a?n[s]=r.getColumnWidth(u.col,i):n[s]=-1}}t._oldSizes=n},undo:function(){return this._doAction(!0)},_getColList:function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n];t.push(r.col)}return t},_getColumnAutoFitValue:function(e){return Ue._getColumnAutoFitValue(e,this._sheet,this._sheetArea,this._command.autoFitType)},canUndo:function(){return this._command._canUndo}}),Ke(Z,K),Ge(Z.prototype,{canExecute:function(){var e=this._command;return this._sheet&&e.rows&&e.rows.length>0},_doAction:function(e){var t=this,n=!1;if(e?t.canUndo():t.canExecute()){var o=t._command,i=t._sheet,a=t._getRowList(o.rows),s=t._sheetArea,l=1===t._sheetArea,u={sheet:i,sheetName:i._name,rowList:a,header:l,cancel:!1};if(i._trigger(Ne,u),i._trigger(Le,u),u&&!0===u.cancel)return n;o._canUndo=!0,e||t.saveState(),Y(i);try{for(var c,f=r(i,s),d=0,p=o.rows.length;d<p;d++){var h=o.rows[d].row;0<=h&&h<f&&i.getRowResizable(h,s)&&(c=e?o._oldSizes[d]:t._getRowAutoFitValue(h))!==i.getAutoFitRowHeight(h,s)&&(i.setAutoFitRowHeight(h,c,s),n=!0)}}finally{G(i,!1,!0)}i._trigger(He,u)}return n},execute:function(){return this._doAction(!1)},saveState:function(){var e=this,t=e._command,n=Xe,o=e._sheet,i=e._sheetArea;if(o&&t.rows&&t.rows.length>0){n=[t.rows.length];for(var a=r(o,i),s=0,l=t.rows.length;s<l;s++){var u=t.rows[s];0<=u.row&&u.row<a?n[s]=o.getRowHeight(u.row,i):n[s]=-1}}t._oldSizes=n},undo:function(){return this._doAction(!0)},_getRowList:function(e){for(var t=[],n=0,r=e.length;n<r;n++){var o=e[n];t.push(o.row)}return t},_getRowAutoFitValue:function(e){return Ue._getRowAutoFitValue(e,this._sheet,this._sheetArea,this._command.autoFitType)},canUndo:function(){return this._command._canUndo}}),Ke(Q,K);var on=".cellEditAction";Ge(Q.prototype,{canExecute:function(){var e=this,t=e._sheet,n=e._command,r=n.ranges,o=n.row,s=n.col;if(r)for(var l=0;l<r.length;l++){var u=r[l];if(!t._canChange(u.row,u.col,i(u),a(u)))return!1}else if(!t._canChange(o,s,1,1))return!1;return!0},saveState:function(){var e=this,n=e._sheet,r=e._command;e._iteration(function(o,i){var a=t._supportsCalc&&n.getFormulaInformation(o,i),s=e._positionToString(o,i);a&&a.hasFormula?!a.isArrayFormula||a.baseRange.row===o&&a.baseRange.col===i?(r._oldValueCache[s]=a.formula,r._oldValueIsFormulaCache[s]=a):r._oldValueIsFormulaCache[s]=!1:r._oldValueCache[s]=n.getValue(e._command.row,e._command.col)})},_iteration:function(e){var t=this,n=t._command,r=n.ranges;if(r)for(var o=0;o<r.length;o++)for(var s=r[o],l=s.row;l<s.row+i(s);l++)for(var u=s.col;u<s.col+a(s);u++)e(l,u);else e(n.row,n.col)},undo:function(){var e=this;if(e.canUndo()){var n=e._sheet,r=e._command;Y(n,!0);try{n._bind(Oe+on,function(e,t){"value"===t.propertyName&&n._raiseValueChanged(t.row,t.col,t.oldValue,t.newValue)}),e._iteration(function(o,s){var l=e._positionToString(o,s),u=!!t._supportsCalc&&r._oldValueIsFormulaCache[l];u?u.isArrayFormula?n.setArrayFormula(o,s,i(u.baseRange),a(u.baseRange),u.formula):n.setFormula(o,s,r._oldValueCache[l]):(u=t._supportsCalc?n.getFormulaInformation(o,s):Xe,u&&(u.isArrayFormula?n.setArrayFormula(o,s,i(u.baseRange),a(u.baseRange),Xe):n.setFormula(o,s,Xe)),n.setValue(o,s,r._oldValueCache[l]))})}catch(e){return!1}finally{n._unbind(Oe+on),G(n,!0)}var o=n._getSheetLayout(),s=new je(o._frozenX,o._frozenY,o.width-o._frozenX,o.height-o._frozenY);return n.repaint(s),!0}return!1},execute:function(){var e=this,t=!1;if(e.canExecute()){e.saveState();var n=e._sheet;Y(n,!0);try{n._bind(Oe+on,function(e,t){"value"===t.propertyName&&n._raiseValueChanged(t.row,t.col,t.oldValue,t.newValue)}),e._command.applyResult=e._applyEditing(),t=!0}finally{n._unbind(Oe+on),G(n,!0)}var r=n._getSheetLayout(),o=new je(r._frozenX,r._frozenY,r.width-r._frozenX,r.height-r._frozenY);n.repaint(o)}return t},_positionToString:function(e,t){return e+"_"+t},_validateEditingValue:function(){var e=this,n=0,r=e._sheet,o=e._command,i=o.row,a=o.col,s=o.newValue,l=!o.hasOwnProperty("autoFormat")||o.autoFormat;if(t._supportsCalc&&s&&s.length>0&&"="===s[0]){if(r.getDataValidator&&r.getDataValidator(i,a)){var u=s.substring(1);if(""!==u&&u!==r.getFormula(i,a)){var c=r._getCalcServiceInternal();if(c){var f=c.parse(r._getSheetSource(),u,i>=0?i:0,a>=0?a:0,!0);if(f){var d=c._evaluateParsedFormula(r._getSheetSource(),f,{row:i,col:a});r.isValid&&!r.isValid(i,a,d)&&(n=r._validationError(i,a))}}}}}else{var p=e._getValueFromEditing(i,a,s,l);!r.isValid||r.isValid(i,a,p)||(n=r._validationError(i,a),r._eventHandler._forceCancelSelectiong=!0)}return n},_rangeToCells:function(e,t){for(var n=e.row,r=e.col,o=e.rowCount,i=e.colCount,a=[],s=n;s<n+o;s++)for(var l=r;l<r+i;l++)a.push({row:s,col:l});return a},_applyEditing:function(){var e=this,r=e._sheet,o=e._command,s=o.ranges,l=o.endEditType,u=o.newValue,c=e._validateEditingValue(),f=s&&1===l;if(1===c||2===c)return c;var d,p=function(e){return/^=/.test(e)?e=e.replace(/([^=\(\)\[\]\{\}\-+*\/%']+)!/g,function(e,t){return t=t.replace(/^\s+|\s+$/g,""),/^'[^']+'$/.test(t)?t+"!":"'"+t+"'!"}):e},h=!o.hasOwnProperty("autoFormat")||o.autoFormat,m=n(5),g=t._supportsCalc&&m&&m.Parser;if(f){var _=e._rangeToCells(s[0]);r._trigger(Ie.FormulatextboxEditing,{sheet:r,command:o,range:s[0],changedCells:_})}if(g){var v=r.parent,y=v&&v.options.allowUserEditFormula,w=o.row;w=w>=0?w:0;var C=o.col;C=C>=0?C:0;var S,x,T=r._getCalcServiceInternal();if(y&&T&&u&&u.length>0&&"="===u[0]){u=p(u);try{if(f)return x=o.ranges[0],r.setArrayFormula(x.row,x.col,i(x),a(x),u.substring(1)),c;S=T.parse(r._getSheetSource(),u.substring(1),w,C,!0)}catch(e){throw r._raiseInvalidOperation(0,"string"==typeof e?e:e.message),e}}else f&&(x=o.ranges[0],r.getRange(x.row,x.col,i(x),a(x),3).clear(1))}if(!S){var E=!1;/^('=)/gi.test(u)&&(u=u.substring(1),E=!0),(Me(d)||E)&&(d=e._getValueFromEditing(w,C,u,h))}return e._iteration(function(e,n){if(S)try{var o=u.substring(1).toUpperCase(),i={sheet:r,sheetName:r._name,row:e,col:n,formula:o,cancel:!1,ranges:t.CalcEngine.formulaToRanges(r,u)};if(r._trigger(Ie.UserFormulaEnter,i),!0===i.cancel)return;r._setFormulaCore(e,n,T.unparse(r._getSheetSource(),S,e,n),S),r._trigger(Ie.UserFormulaEntered,{sheet:r,sheetName:r._name,row:e,col:n,formula:o})}catch(e){throw r._raiseInvalidOperation(0,"string"==typeof e?e:e.message),e}else{try{r.hasFormula&&r.hasFormula(e,n)&&r.setFormula(e,n,Xe)}catch(e){throw r._raiseInvalidOperation(0,"string"==typeof e?e:e.message),e}try{d instanceof Date&&Te.isNumeric(u)?r.setValue(e,n,u):Te.isUrl(u)?b(r,e,n,u):r._setValueInternal(e,n,d)}catch(t){r.setValue(e,n,u)}}}),c},canUndo:function(){return 0===this._command.applyResult},_getValueFromEditing:function(e,t,n,r){var o=this,i=o._sheet,a=i.getActualStyle(e,t),s={},l=Ue._parseText2Value(a,n,r,s),u=s.value;if(r&&u){var c=Xe;if(r&&u&&(l!==Xe&&"General"!==u.formatString()||!a._autoFormatter)&&(u.isAuto=!0,c=u),c){var f=i._getStyleObject(e,t),d="string"==typeof f;if(!f||d){var p=new we;d&&(p.parentName=f),f=p}f._autoFormatter=c,i.setStyle(e,t,f)}}return l}}),Ke(ee,K),Ge(ee.prototype,{canUndo:function(){return!!this._command._oldName},canExecute:function(){var e=this,t=e._command;return e._sheet&&t.name&&t.name!==t._oldName},execute:function(){var e=this,t=e._sheet,n=e._command,r=n.name,o=!1;return e.canExecute()&&t&&r&&r!==n._oldName&&(e.saveState(),$(t,r),o=!0,n.sheetName=r),o},saveState:function(){this._sheet&&(this._command._oldName=this._sheet.name())},undo:function(){var e=this;if(e.canUndo()){var t=e._sheet;if(t)return $(t,e._command._oldName),e._command.sheetName=e._command._oldName,!0}return!1}}),Ke(te,K),Ge(te.prototype,{canExecute:function(){var e=this;return e._sheet&&e._sheet.parent.options.allowUserZoom&&e._sheet._zoomFactor!==e._command.zoomFactor},execute:function(){var e=this,t=e._command,n=!1;return e.canExecute()&&(e.saveState(),n=ne(e._sheet,t.zoomFactor)),n},saveState:function(){this._sheet&&(this._command.oldZoomFactor=this._sheet._zoomFactor)},undo:function(){var e=this._sheet;if(this.canUndo())return e&&ne(e,this._command.oldZoomFactor)}}),Ke(oe,K);var an=".clearRangeAction";Ge(oe.prototype,{execute:function(){var e=this;if(e.canExecute()){e.saveState();var t=e._sheet;if(t){var n=t._getActualRange(e._command.clearRange),r=n.row,o=n.col,s=i(n),l=a(n);if(l>0&&s>0)try{t._bind(Oe+an,function(e,n){"value"===n.propertyName&&t._raiseValueChanged(n.row,n.col,n.oldValue,n.newValue)}),Y(t),t.getRange(r,o,s,l,3).clear(1),G(t);var u=e._command._changedCells;z._raiseRangeDataChanged(t,r,o,s,l,u?u._getChangedCells():[],2)}finally{t._unbind(Oe+an)}}}},canExecute:function(){var e=this._command.clearRange;return this._sheet._canChange(e.row,e.col,i(e),a(e))},canUndo:function(){return!!this._command._cachedValues},saveState:function(){var e=this,n=e._sheet,r=e._command.clearRange,s=e._command._cachedFilteredColumns=[];if(n){var l=e._command._cachedTables=[];if(n.tables){var u=n.tables.all();if(u&&u.length>0)for(var c=0;c<u.length;c++){var f=u[c];r.containsRange(f.range())&&l.push(f)}}var d,p,h;if(n.rowFilter&&(d=n.rowFilter())&&d.range&&d.isFiltered()){p=d.range.row;var m=i(d.range);if(d.filterButtonVisible&&d.filterButtonVisible()&&(p=d.range.row-1,m=i(d.range)+1,p<0&&(p=-1,m=-1)),(-1===r.row||r.row<=p&&p+m<=r.row+i(r))&&(-1===r.col||r.col<=d.range.col&&d.range.col+a(d.range)<=r.col+a(r))){h=d.range.col<0?0:d.range.col;for(var g=a(d.range)<0?o(n):a(d.range),_=0;_<g;_++)d.isFiltered(h+_)&&s.push(h+_)}}var v=n._getActualRange(r);if(a(v)>0&&i(v)>0)for(var y=e._command._cachedValues=[v.row+i(v)],b=0;b<i(v);b++){y[v.row+b]=[v.col+a(v)];for(var w=0;w<a(v);w++){p=v.row+b,h=v.col+w;var C=t._supportsCalc&&n.getFormulaInformation(p,h);if(C&&C.hasFormula)!C.isArrayFormula||C.baseRange.row===p&&C.baseRange.col===h?y[p][h]=new re(C.formula,C):y[p][h]=-1;else{var S=n.getValue(p,h);S!==qe&&S!==Xe&&(y[p][h]=new re(S,qe))}}}n.isDirtySuspended()||(e._command._changedCells=new P(n,n._getActualRange(r),3))}},undo:function(){var e=this,n=e._sheet;if(e.canUndo()&&n){var r,o=!1,s=e._command._cachedTables;if(s&&s.length>0){var l=s,u=l.length,c=n.tables;for(r=0;r<u;r++){var f=l[r],d=f.range();c._checkCanAddTable(n,f.name(),d.row,d.col,i(d),a(d))&&c._addInternal(f)}}var p=n._getActualRange(e._command.clearRange),h=e._command._cachedValues;if(h&&a(p)>0&&i(p)>0){Y(n);try{n._bind(Oe+an,function(e,t){"value"===t.propertyName&&n._raiseValueChanged(t.row,t.col,t.oldValue,t.newValue)});var m=i(p),g=a(p);for(r=0;r<m;r++)for(var _=0;_<g;_++){var v=p.row+r,y=p.col+_,b=h[v][y];if(-1!==b)if(b)if(b.formulaInfo){var w=b.formulaInfo;w&&w.isArrayFormula?n.setArrayFormula(v,y,i(w.baseRange),a(w.baseRange),w.formula):n.setFormula(v,y,b.value)}else t._supportsCalc&&n.setFormula(v,y,Xe),n.setValue(v,y,b.value);else t._supportsCalc&&n.setFormula(v,y,Xe),n.setValue(v,y,Xe)}o=!0}finally{G(n),n._unbind(Oe+an)}}if(o){var C=e._command._changedCells;z._raiseRangeDataChanged(n,p.row,p.col,i(p),a(p),C?C._getChangedCells():[],2)}var S,x=e._command._cachedFilteredColumns;if(n.rowFilter&&(S=n.rowFilter())&&x&&x.length>0)for(r=0;r<x.length;r++){var T=x[r];S.filter(T)}if(o)return n.repaint(),!0}return!1}}),Ke(ie,K),Ge(ie.prototype,{canExecute:function(){var e=this._command._cachedActions;if(e){for(var t=0;t<e.length;t++){if(!e[t].canExecute())return!1}return!0}return!1},execute:function(){var e=this;if(e.canExecute()){var t=e._command._cachedActions,n=e._sheet;if(e.saveState(),t){Y(n,!0);for(var r=0;r<t.length;r++){t[r].execute()}return G(n,!0),!0}}return!1},canUndo:function(){var e=this._command._cachedActions;if(e){for(var t=0;t<e.length;t++){if(!e[t].canUndo())return!1}return!0}return!1},saveState:function(){var e=this._command._cachedActions;if(e)for(var t=0;t<e.length;t++){var n=e[t];n.saveState()}},undo:function(){var e=this,t=e._command._cachedActions;if(e.canUndo()){for(var n=e._sheet,r=t.length-1;r>=0;r--){var o=t[r];Y(n,!0);var i=o.undo();if(G(n,!0),!i)return!1}return!0}return!1}}),tt._ClearValueUndoAction=ie,tt._performUndo=ce,tt._saveColumnHeaderInfo=fe,tt._saveViewportInfoForDragDrop=de,tt._saveTableInfo=pe,tt._saveRowHeaderInfo=he,Ke(_e,K),Ge(_e.prototype,{canExecute:function(){var e=this,t=e._sheet,n=e._command.pasteExtent,r=n.targetRange,o=n.sourceRange;return t._canChange(r.row,r.col,i(r),a(r))&&(!n.isCutting||t._canChange(o.row,o.col,i(o),a(o)))},saveState:function(){var e,t=this,n=t._command.pasteExtent,l=t._command._state={},u=n.isCutting,c=_e._convertPasteOption(t._command.pasteOption),f=n.sourceRange,d=n.targetRange,p=t._command.fromSheet,h=t._command.toSheet;if(p&&f&&u){var m=f.row<0?0:f.row,g=f.col<0?0:f.col,_=f.row<0?r(p):i(f),v=f.col<0?o(p):a(f);if(f.row<0&&f.col<0&&d.row<0&&d.col<0&&p._name!==h._name){var y=new N;z._saveSheetInfo(p,y,c),l._savedFromSheetInfo=y}f.row<0&&(e=fe(p,g,v,c),l._savedFromColumnHeaderCells=e.headerCells,l._savedFromColumns=e.columns),f.col<0&&(e=he(p,m,_,c),l._savedFromRowHeaderCells=e.headerCells,l._savedFromRows=e.rows),l._savedFromViewportCells=de(p,m,g,_,v,c),l._savedFromTables=pe(t._sheet,m,g,_,v),p.isDirtySuspended()||(l._savedFromBeforePastedChangedCells=new P(p,f,c))}var b=d.row<0?0:d.row,w=d.col<0?0:d.col,C=d.row<0?r(h):i(d),S=d.col<0?o(h):a(d);if(p&&f){if(f.row<0&&f.col<0&&d.row<0&&d.col<0&&p._name!==h._name){var x=new N;z._saveSheetInfo(h,x,c),l._savedToSheetInfo=x}f.row<0&&(e=fe(h,w,S,c),l._savedToColumnHeaderCells=e.headerCells,l._savedToColumns=e.columns),f.col<0&&(e=he(h,b,C,c),l._savedToRowHeaderCells=e.headerCells,l._savedToRows=e.rows)}l._savedToViewportCells=de(h,b,w,C,S,c),l._savedToTables=pe(t._sheet,b,w,C,S),h.isDirtySuspended()||(l._savedToBeforePastedChangedCells=new P(h,d,c)),s(h)&&(l._savedToRowCountColCount=ge(h))},_pasteRange:function(){return this._command.pasteExtent.targetRange},execute:function(){var e=this;if(e.canExecute()){var t=e._command.fromSheet,n=e._command.toSheet,l=e._command.pasteExtent,u=e._command.pasteOption,c=l.sourceRange,f=l.targetRange;if(t&&c&&!t._isValidRange(c.row,c.col,i(c),a(c),r(t),o(t)))return;if(!(n&&f&&n._isValidPasteRange(f.row,f.col,i(f),a(f),!0)))return;e.saveState(),d(e._sheet),h(n),t&&h(t);try{if(s(n)){var g=-1,_=-1;-1!==f.row?g=f.row+i(f):-1===c.row&&(g=r(t)),g>r(n)&&n.setRowCount(g),-1!==f.col?_=f.col+a(f):-1===c.col&&(_=o(t)),_>o(n)&&n.setColumnCount(_)}c&&Be._startCache(t,c.row,c.col,c.row+i(c)-1,c.col+a(c)-1),n._clipboardPaste(t,c,n,f,l.isCutting,l.clipboardText,l.clipboardHtml,u,!l.includeFilteredOutRow)}finally{m(n),t&&m(t),p(e._sheet);var v=e._command._state;if(e._sheet){var y=v._savedFromViewportCells,b=_e._convertPasteOption(u);if(l.isCutting&&y&&t&&y.data&&y.data._isValueOrFormulaSaved()){var w=[];if(!t.isDirtySuspended()){var C=new P(t,c,b);C._mergeCellsHasDiffData(v._savedFromBeforePastedChangedCells._getCellsData()),v._savedFromAfterPastedChangedCells=C,w=C._getChangedCells()}z._raiseRangeDataChanged(t,c.row,c.col,i(c),a(c),w,3)}var S=v._savedToViewportCells;if(S&&n&&S.data&&S.data._isValueOrFormulaSaved()){var x=[];if(!n.isDirtySuspended()){var T=new P(n,f,b);T._mergeCellsHasDiffData(v._savedToBeforePastedChangedCells._getCellsData()),v._savedToAfterPastedChangedCells=T,x=T._getChangedCells()}z._raiseRangeDataChanged(n,f.row,f.col,i(f),a(f),x,3)}}c&&Be._clearCache()}}},undo:function(){var e=this,n=0;if(e.canUndo()){var l=e._command.fromSheet,u=e._command.toSheet,c=e._command.pasteExtent,f=c.sourceRange,h=c.targetRange;if(!u||!h)return!1;if(!u._isValidRange(h.row,h.col,i(h),a(h),r(u),o(u)))return!1;if(l&&f){if(!l._isValidRange(f.row,f.col,i(f),a(f),r(l),o(l)))return!1;if(l&&l._name===u._name&&u.parent&&!Ae(u.parent.sheets,l))return!1}var m=e._command._state;d(e._sheet);try{var g=Xe,_=Xe,v=h.row<0?0:h.row,y=h.col<0?0:h.col,b=h.row<0?r(u):i(h),w=h.col<0?o(u):a(h),C=m._savedToViewportCells;C&&C.data&&C.data._isValueOrFormulaSaved()&&(g=z._getValues(u,v,y,b,w)),t._supportsCalc&&z._clearFormula(u,v,y,b,w),n+=ce(e,m._savedToTables),m._savedToSheetInfo&&(z._undoSheetInfo(u,m._savedToSheetInfo),n++),n+=ce(e,m._savedToColumnHeaderCells),n+=ce(e,m._savedToColumns),n+=ce(e,C),n+=ce(e,m._savedToRowHeaderCells),n+=ce(e,m._savedToRows),s(u)&&(n+=ce(e,m._savedToRowCountColCount));var S=0,x=0,T=0,E=0;if(l&&f){S=f.row<0?0:f.row,x=f.col<0?0:f.col,T=f.row<0?r(l):i(f),E=f.col<0?o(l):a(f);var M=m._savedFromViewportCells;M&&M.data&&M.data._isValueOrFormulaSaved()&&(_=z._getValues(l,S,x,T,E)),n+=ce(e,m._savedFromTables),n+=ce(e,m._savedFromColumnHeaderCells),n+=ce(e,m._savedFromColumns),n+=ce(e,M),n+=ce(e,m._savedFromRowHeaderCells),n+=ce(e,m._savedFromRows)}if(n&&e._sheet){if(g&&u){var A=m._savedToAfterPastedChangedCells;z._raiseRangeDataChanged(u,v,y,b,w,A?A._getChangedCells():[],3)}if(_&&l){var k=m._savedFromAfterPastedChangedCells;z._raiseRangeDataChanged(l,S,x,T,E,k?k._getChangedCells():[],3)}}}finally{p(e._sheet)}}return n>0}}),_e._convertPasteOption=function(e){var t=0;return 0!==e&&1!==e||(t|=1),0!==e&&2!==e||(t|=64,t|=32),0!==e&&3!==e||(t|=2),0===e&&(t|=32,t|=16,t|=256,t|=4,t|=512,t|=128),e>3&&(t=e),t},Ke(ve,K),Ge(ve.prototype,{execute:function(){var e=this,t=e._command,n=t._cachedActions,r=!1;if(e.canExecute()&&n){var o=e._sheet;Y(o,!0);try{for(var i=0;i<n.length;i++){var a=n[i];if(o){var s=a._command.pasteExtent,l={sheet:o,sheetName:o.name(),cellRange:a._pasteRange(),pasteOption:a._command.pasteOption,pasteData:{text:s.clipboardText,html:s.clipboardHtml},cancel:!1,fromSheet:t.fromSheet};o._trigger(Ie.ClipboardPasting,l),l.cancel||(a.execute(),delete l.cancel,l.parsedPastedData=o._tempParsedText,o._tempParsedText=null,o._trigger(Ie.ClipboardPasted,l))}else a.execute()}e._refreshSelection(),r=!0}finally{G(o,!0)}}return r},_refreshSelection:function(){var e=this,t=e._command,n=t._cachedActions,r=e._sheet;if(r&&n){var o=r.getSelections();if(r._clearSelectionImp(),t._isMultiToSingle){var s=t.pastedRanges[0];r.addSelection(s.row,s.col,i(s),a(s))}else if(n.length>1)for(var l=0;l<n.length;l++){var u=n[l],c=u._pasteRange();r.addSelection(c.row,c.col,i(c),a(c))}else if(n.length>0){var f=n[0]._pasteRange();r.addSelection(f.row,f.col,i(f),a(f)),f.contains(r._activeRowIndex,r._activeColIndex)||r._setActiveCellCore(f.row,f.col)}r._raiseSelectionChanging(o,r.getSelections())&&r._raiseSelectionChanged()}},canExecute:function(){var e=this._command._cachedActions;if(e){for(var t=0;t<e.length;t++){if(!e[t].canExecute())return!1}return!0}return!1},canUndo:function(){var e=this._command._cachedActions;if(e){for(var t=0;t<e.length;t++){if(!e[t].canUndo())return!1}return!0}return!1},saveState:function(){var e=this._command._cachedActions;if(e)for(var t=0;t<e.length;t++){var n=e[t];n.saveState()}},undo:function(){var e=this,t=e._command._cachedActions;if(e.canUndo()&&t){var n=e._sheet,r=!0;Y(n,!0);try{for(var o=t.length-1;o>=0;o--){var i=t[o];r=r&&i.undo()}}finally{G(n,!0)}return r}return!1}}),e.exports=t},function(e,t,n){function r(){return H._getResource(t.SR)()}function o(e,t){return e.getRowCount(t)}function i(e,t){return e.getColumnCount(t)}function a(e,t){return e._getSpanModel(t)}function s(e,t,n){return e._getActualColumnWidth(t,n)}function l(e,t,n){return e._getActualRowHeight(t,n)}function u(e,t,n,r){e.setColumnWidth(t,n,r)}function c(e,t,n,r){e.setRowHeight(t,n,r)}function f(e,t,n,r){return e.getActualStyle(t,n,r)}function d(e,t){return e.getDefaultStyle(t)}function p(e,t,n){e.setDefaultStyle(t,n)}function h(e,t,n,r,o){e._setStyleWithoutLocked(t,n,r,o)}function m(e,t,n,o){throw new Error(H._StringHelper._format(r().Exp_InvalidAndSpace,[e,t,n,o]))}function g(e,t,n){return t&&n._isRowFilterOut&&n._isRowFilterOut(e)}function _(e,t,n,a,s,l,u,c,f){if(!e)throw new Error(r().Exp_SrcIsNull);if(!a)throw new Error(r().Exp_DestIsNull);var d=o(e),p=i(e),h=o(a),g=i(a);(t<-1||t>=d)&&m("from row index",t,"-1",d-1),(n<-1||n>=p)&&m("from column index",n,"-1",p-1),(s<-1||s>=h)&&m("to row index",s,"-1",h-1),(l<-1||l>=g)&&m("to column index",l,"-1",g-1);var _=n;n<0&&(_=0,(e!==a||f)&&(c=p));var v=l<0?0:l;(c<1||_+c>p||v+c>g)&&m("column count",c,"1",Y(p-_,g-v));var y=t;t<0&&(y=0,(e!==a||f)&&(u=d));var b=s<0?0:s;(u<1||y+u>d||b+u>h)&&m("row count",u,"1",Y(d-y,h-b))}function v(e){if(!e)return e;if("number"==typeof e||"string"==typeof e||"boolean"==typeof e||U(e))return e;if(e.clone)return e.clone();if(e instanceof Date)return new Date(e);var t,n,r;t=e instanceof Object?new e.constructor:new e.constructor(e.valueOf());for(n in e)e.hasOwnProperty(n)&&(r=e[n],e.hasOwnProperty(n)&&t[n]!==r&&(t[n]="object"==typeof r?v(r):r));return t.toString=e.toString,t.valueOf=e.valueOf,t}function y(e,t,n,r,o,i,a,s){var l,u,c,f,d,p,h,m,g=b(e),_=b(r),v=[];if(g)for(l=0;l<g.length;l++)c=g[l],f=c.row,d=c.col,p=c.rowCount,h=c.colCount,-1===t?n<=d&&d+h<=n+s&&v.push(B(f,i+d-n,p,h)):-1===n?t<=f&&f+p<=t+a&&v.push(B(o+f-t,d,p,h)):t<=f&&f<t+a&&n<=d&&d<n+s&&v.push(B(o+f-t,i+d-n,p,h));if(_)for(l=0;l<_.length;l++){c=_[l],f=c.row,d=c.col;var y=d>=i&&d<i+s,w=f>=o&&f<o+a;if(-1===t?y:-1===n?w:w&&y)for(u=0;u<r.length;u++)if(m=r[u],m.row===f&&m.col===d){r.splice(u,1);break}}for(l=0;r&&l<v.length;l++)r.push(v[l])}function b(e){return e&&e.length>0?e.slice(0):W}function w(e,t,n,r,o,i,a,s,l){var u=e.conditionalFormats,c=r.conditionalFormats;u&&c&&(u._copyRules(t,n,c,o,i,a,s),l&&u._onRulesMoved(t,n,a,s))}function C(e,t,n,r,a,s,l,u,c){t<0&&(t=0,l=Y(o(e),o(r))),a<0&&(a=0),n<0&&(n=0,u=Y(i(e),i(r))),s<0&&(s=0);var f,d=!(e===r&&e._name===r._name);d?(f=r._sparklineGroupManager)&&(c?f.count()>0&&f._exMove(e,t,n,a,s,l,u):f._exCopy(e,t,n,a,s,l,u)):(f=e._sparklineGroupManager)&&(c?f.count()>0&&f._move(t,n,a,s,l,u):f._copy(t,n,a,s,l,u))}function S(e,t,n,r,o,a){t<0&&(t=0,o=Y(i(e),i(n))),r<0&&(r=0);var s=e.columnOutlines,l=n.columnOutlines;e===n&&e._name===n._name?s&&s._moveOrCopy(t,r,o,a):s&&l&&l._exMoveOrCopy(s,t,r,o,a)}function x(e,t,n,r,i,a){t<0&&(t=0,i=Y(o(e),o(n))),r<0&&(r=0);var s=!(e===n&&e._name===n._name),l=e.rowOutlines,u=n.rowOutlines;s?l&&u&&u._exMoveOrCopy(l,t,r,i,a):l&&l._moveOrCopy(t,r,i,a)}function T(e,t,n,r,o,i,s,l,u,c){var f=!(e===r&&e._name===r._name),d=a(e,c);f?(y(d,t,n,a(r,c),o,i,s,l),u&&d&&d.clear(t,n,s,l)):d&&(u?d.move(t,n,o,i,s,l):d.copy(t,n,o,i,s,l))}function E(e,t,n,r,a,s,l,u,c){var f=t,d=n;f<0&&(f=0,l=Y(o(e),o(r))),a<0&&(a=0),d<0&&(d=0,u=Y(i(e),i(r))),s<0&&(s=0),t<0&&T(e,-1,d,r,-1,s,-1,u,c,1),n<0&&T(e,f,-1,r,a,-1,l,-1,c,2),T(e,f,d,r,a,s,l,u,c)}function M(e,t,n,r,a,d,p){t<0&&(t=0,a=Y(i(e),i(n))),r<0&&(r=0);for(var m=1,g=0;g<a;g++){var _=s(e,g+t);U(_)||(p&&u(e,g+t,e.defaults.colWidth),u(n,g+r,_));var v=e.getColumnVisible(g+t);if(U(v)||(p&&e.setColumnVisible(g+t,!0),n.setColumnVisible(g+r,v)),(64&d)>0){var y=f(e,-1,g+t);y?(h(n,-1,g+r,y.clone()),p&&h(e,-1,g+t,W)):h(n,-1,g+r,W),y=f(e,-1,g+t,m),y?(h(n,-1,g+r,y.clone(),m),p&&h(e,-1,g+t,W,m)):h(n,-1,g+r,W,m)}}for(var b=Y(o(e,m),o(n,m)),w=0;w<b;w++){var C=l(e,w,m);U(C)||(p&&c(e,w,e.defaults.colHeaderRowHeight,m),c(n,w,C,m))}}function A(e,t,n,r,a,d,p,m){t<0&&(t=0,a=Y(o(e),o(n))),r<0&&(r=0);for(var _=2,v=0;v<a;v++)if(m||!g(r+v,p,n)){var y=l(e,v+t);U(y)||(m&&c(e,v+t,e.defaults.rowHeight),c(n,v+r,y));var b=e.getRowVisible(v+t);if(U(b)||(m&&e.setRowVisible(v+t,!0),n.setRowVisible(v+r,b)),(64&d)>0){var w=f(e,v+t,-1);w?(h(n,v+r,-1,w.clone()),m&&h(e,v+t,-1,W)):h(n,v+r,-1,W),w=f(e,v+t,-1,_),w?(h(n,v+r,-1,w.clone(),_),m&&h(e,v+t,-1,W,_)):h(n,v+r,-1,W,_)}}for(var C=Y(i(e,_),i(n,_)),S=0;S<C;S++){var x=s(e,S,_);U(x)||(m&&u(e,S,e.defaults.rowHeaderColWidth,_),u(n,S,x,_))}}function k(e,t,n,r){if(e!==t||e._name!==t._name){if((64&n)>0){var o=d(e);p(t,r?o:o.clone()),o=d(e,1),p(t,r?o:o.clone(),1),o=d(e,2),p(t,r?o:o.clone(),2),r&&(p(e,W),p(e,W,1),p(e,W,2))}var i=t.defaults,a=e.defaults;i.colWidth=a.colWidth,i.rowHeight=a.rowHeight,i.rowHeaderColWidth=a.rowHeaderColWidth,r&&(a.colWidth=62,a.rowHeight=20,a.rowHeaderColWidth=40)}}function R(e,t,n,r,a,s,l,u,c,f,d,p){var h,m,_,y,b,w,C=!(e===r&&e._name===r._name);if(2==(2&f)&&t<0){var S=n,x=s;if(h=Y(o(e,1),o(r,1)),m=u,n<0&&(S=0,m=i(e)),s<0&&(x=0),C)for(_=0;_<h;_++)for(y=0;y<m;y++)w=d(e,_,S+y,1),p(r,_,x+y,v(w),1);else{for(b=new V(h,m,W),_=0;_<h;_++)for(y=0;y<m;y++)w=d(e,_,S+y,1),U(w)||b.setValue(_,y,v(w));for(_=0;_<h;_++)for(y=0;y<m;y++)p(r,_,x+y,b.getValue(_,y),1)}}if(1==(1&f)&&n<0){var T=t,E=a;if(h=l,m=Y(i(e,2),i(r,2)),t<0&&(T=0,h=o(e)),a<0&&(E=0),C)for(_=0;_<h;_++)for(y=0;y<m;y++)w=d(e,T+_,y,2),p(r,E+_,y,v(w),2);else{for(b=new V(h,m,W),_=0;_<h;_++)for(y=0;y<m;y++)w=d(e,T+_,y,2),U(w)||b.setValue(_,y,v(w));for(_=0;_<h;_++)for(y=0;y<m;y++)p(r,E+_,y,b.getValue(_,y),2)}}var M=t,A=n,k=a,R=s,I=l,O=u;if(t<0&&(M=0,I=Y(o(e),o(r))),n<0&&(A=0,O=Y(i(e),i(r))),a<0&&(k=0),s<0&&(R=0),C){for(_=0;_<I;_++)if(!g(k+_,c,r))for(y=0;y<O;y++)w=d(e,M+_,A+y,3),p(r,k+_,R+y,v(w),3)}else{b=new V(I,O,W);try{for(_=0;_<I;_++)for(y=0;y<O;y++)w=d(e,M+_,A+y,3),U(w)||b.setValue(_,y,v(w));for(_=0;_<I;_++)if(!g(k+_,c,r))for(y=0;y<O;y++)p(r,k+_,R+y,b.getValue(_,y),3)}catch(e){}}}function I(e,t,n,r,o,i,a,s,l,u,c){R(e,t,n,r,o,i,a,s,l,u,function(e,t,n,r){var o,i=3===r;return o=i?e.getValue(t,n,r):e._getModel(r).getValue(t,n),c&&(i?e._setValueInternal(t,n,W,r,!1):e._getModel(r).setValue(t,n,W)),o},function(e,t,n,r,o){U(r)?e._setValueInternal(t,n,W,o,!1):e._setValueInternal(t,n,r,o,!1)})}function O(e,t,n,r,o,i,a,s,l,u,c,f){function d(e,t,n){for(var r=e._getActualRange(t),o=r.row,i=r.col,a=r.rowCount,s=r.colCount,l=0;l<a;l++)for(var u=n[o+l]=n[o+l]||{},c=0;c<s;c++)u[i+c]=!0}var p={};if(e.tables)for(var m,g=B(t,n,a,s),_=B(o,i,a,s),v=e.tables.all(),y=0,b=v.length;y<b;y++)m=v[y].range(),g.containsRange(m)?d(e,m,p):m.containsRange(g)&&m.containsRange(_)&&d(e,g,p);R(e,t,n,r,o,i,a,s,l,u,function(e,t,n,r){var o=(3===r||U(r))&&p[t]&&p[t][n],i=e._getCompositeStyle(t,n,r,z,z,z,z,o);return c&&h(e,t,n,W,r),f&&delete i.cellType,i},function(e,t,n,r,o){h(e,t,n,r,o)})}function D(e,t,n,r,o,i,a,s,l,u){R(e,t,n,r,o,i,a,s,l,0,function(e,t,n){var r=e.comments,o=r&&r.get(t,n);return o&&u&&r.remove(t,n),o},function(e,t,n,r){var o=e.comments;o&&o._addInternal(t,n,r)})}function P(e,t,n,r,o,i,a,s,l,u,c){R(e,t,n,r,o,i,a,s,l,u,function(e,t,n,r){var o=e.getTag(t,n,r);return o&&c&&e.setTag(t,n,z),o},function(e,t,n,o,i){o&&delete o.locked,r.setTag(t,n,o,i)})}function N(e,t,n,r,o,i,a,s,l,u){var c=[];return R(e,t,n,r,o,i,a,s,l,0,function(r,o,i){var a=r.getBindingPath&&r.getBindingPath(o,i);return a&&c.push({row:o-G(0,t),col:i-G(0,n),value:r.getValue(o,i)}),u&&e.setBindingPath&&e.setBindingPath(o,i,W),a},function(e,t,n,r){e.setBindingPath&&e.setBindingPath(t,n,r)}),c}function F(e,n,r,a,s,l,u,c,f,d,p,h,m){if(_(e,n,r,a,s,l,u,c,h),(64&f)>0&&O(e,n,r,a,s,l,u,c,d,p,h,m),(1&f)>0&&(2&f)>0){var v,y=e.tables;y&&(v=y._onCopyOrMoving(B(G(0,n),G(0,r),n<0?Y(o(e),o(a)):u,r<0?Y(i(e),i(a)):c),h))}var b=t._supportsCalc;b&&(e.suspendCalcService(),a.suspendCalcService());var T=W;(256&f)>0&&(T=N(e,n,r,a,s,l,u,c,d,h));try{if((1&f)>0&&(I(e,n,r,a,s,l,u,c,d,p,h),t._supportsCalc&&0==(2&f)&&a.clearFormula(s,l,u,c,function(e,t){return!d||!e._isRowFilterOut||!e._isRowFilterOut(t)}),(256&f)>0))for(var R=T.length,F=s<0?0:s,L=l<0?0:l,H=0;H<R;H++){var V=T[H];!h&&g(F+V.row,d,a)||a.setValue(F+V.row,L+V.col,V.value)}var U=a.tables;(1&f)>0&&(2&f)>0&&U&&U._onCopyOrMoved(v,G(0,n),G(0,r),G(0,s),G(0,l),h),t._supportsCalc&&(h?(j.adjustCustomNameOnMove(e,n,r,a,s,l,u,c),(2&f)>0&&j.moveFormula(e,n,r,a,s,l,u,c)):(2&f)>0&&j.copyFormula(e,n,r,a,s,l,u,c,d),(1&f)>0&&(2&f)>0&&U&&U._syncFormulaInTables(v))}finally{b&&(e.resumeCalcService(!1),a.resumeCalcService(!1))}if((512&f)>0&&w(e,n,r,a,s,l,u,c,h),(4&f)>0&&D(e,n,r,a,s,l,u,c,d,h),(128&f)>0&&P(e,n,r,a,s,l,u,c,d,p,h),(16&f)>0&&C(e,n,r,a,s,l,u,c,h),(8&f)>0&&(n<0&&S(e,r,a,l,c,h),r<0&&x(e,n,a,s,u,h)),(32&f)>0&&(h||1!==u||1!==c)&&E(e,n,r,a,s,l,u,c,h),n<0&&s<=0&&M(e,r,a,l,c,f,h),r<0&&l<=0&&A(e,n,a,s,u,f,d,h),n<0&&s<=0&&r<0&&l<=0&&k(e,a,f,h),h&&n<0){var z=r,K=c;r<0&&(z=0,K=Y(i(e),i(a)));for(var X=0;X<K;X++)e.getDataColumnName&&e.getDataColumnName(z+X)&&e._getColInfos().reset(z+X)}}var t=n(2),L=n(3),H=n(0),V=n(13)._SheetModel,j=t._supportsCalc&&n(31).Worksheet,B=L._createRange,U=H._Types._isNullOrUndefined,W=null,z=void 0,Y=Math.min,G=Math.max;t.staticMembers={copyTo:function(e,t,n,r,o,i,a,s,l,u,c,f){F(e,t,n,r,o,i,a,s,l,u,c,!1,f)},moveTo:function(e,t,n,r,o,i,a,s,l){F(e,t,n,r,o,i,a,s,l,z,3,!0)}},e.exports=t},function(e,t,n){function r(e,t){e.removeChild(t)}function o(){var e=this;w.call(e),e.typeName="8",e._id=o._getUniqueId(),y(J,function(t,n){e["_"+t]=n})}function i(e){return["_blank","_self","_parent","_top"][e]}function a(e,t,n,r,o){var i=0,a=0,s=e.width,l=e.height;return 1===r?i+=x(0,(s-t)/2):2===r&&(i+=x(0,s-t)),1===o?a+=x(0,(l-n)/2):2===o&&(a+=x(0,l-n)),{x:i,y:a}}function s(e,t,n,r,i,s){var l=o._getEditorElement(s),u=v(l.firstChild),c=l.firstChild.firstChild;if(c){var f=v(c);f.text(e||""),r&&f.css(D,r)}var d=u.width(),p=u.height(),h={x:0,y:0,width:d,height:p};if(i){var m=a(i,d,p,t,n);h.x=m.x,h.y=m.y}return h}function l(e,t,n){var r=e.cellStyle,o=e.cellRect,i=t._render,a=e.x,l=e.y;if(n||(n=t.getValue(e.row,e.col,e.sheetArea)+""),!n)return!1;n=n.replace(/\s+/g," ");var u=r&&r.font?r.font:i._getDefaultFont();t._zoomFactor>1&&(u=i._getZoomFont(u));var c=s(n,r.hAlign,r.vAlign,u,o,t),f=o.x+c.x,d=T(o.x+c.x+c.width,o.x+o.width),p=o.y+c.y,h=T(o.y+c.y+c.height,o.y+o.height);return f<=a&&a<d&&p<=l&&l<h}function u(e,t,n,r,o){var i=r&&r.sheet;if(i){var a=i._render,l=t.font||a._getDefaultFont();n>1&&(l=a._getZoomFont(l));var u=s(e,t.hAlign,t.vAlign,l,S,i);return o?u.width:u.height}return 0}var c=(n(1),n(0)),f=n(3),d=f.util,p=d._createElement,h=c._Types._isNullOrUndefined,m=d._browser,g=m.mozilla,_=f.Rect,v=n(4).GC$,y=v.each,b=n(12).CellTypes,w=b.Base,C=n(50).CellTypes.Text,S=null,x=Math.max,T=Math.min,E=Math.floor,M=window.open,A="click",k="keydown",R="position",I="absolute",O="margin",D="font",P="left",N="top",F="gcUIElement",L="none",H="padding",V="hidden",j="overflow",B="border",U="outline",W="box-sizing",z="color",Y="background-color",G="content-box",K="default",X="white",q="div";b.HyperLinkTargetType={blank:0,self:1,parent:2,top:3},v.inherit(o,w);var J={link:"",linkColor:"#0066cc",visitedLinkColor:"#3399ff",text:"",value:"",linkToolTip:"",target:0},Z={paintValue:function(e,t,n,r,o,i,s,l){var u=this;if(!u._actived&&e){var c=u.getText(t,l)+"";if(c){c=c.replace(/\s+/g," ");var f=!1,d=l.sheet._getModel().getNode(l.row,l.col),p=d&&d.hyperlinkInfo;p&&(u._id===p.id?f=p.visited:delete d.hyperlinkInfo),e.save(),e.beginPath();var h;h=f?u._visitedLinkColor:u._linkColor,h&&e.fillStyle!==h&&(e.fillStyle=h);var v=s.font;v&&e.font!==v&&(e.font=v);var y=s.hAlign,b=s.vAlign,w=e.measureText(c).width,C=l.lineHeight,S=a(new _(n,r,o,i),w,C,y,b),T={x:n,y:r,width:o,height:i};(S.x+w>T.width||S.y+C>T.height)&&(e.rect(T.x,T.y,T.width,T.height),e.clip(),e.beginPath());var M=1,A=P,k=s.textIndent||0,R=0;k>0&&(R=8*k+1),M+=R,1===y?w<o-3&&(M=o/2,A="center"):2===y&&w<o-3&&(M=o-1,A="right"),e.textAlign!==A&&(e.textAlign=A);var I=1,O="alphabetic",D=l.fontInfo.fontSize,N=D>8?E((D-8)/5+2):1,F=C/2-D/2+N-1;I+=C-F,1===b?C<i&&(I=g?i/2+1:m.msie?i/2+.5:i/2,E(I)!==I&&(I+=.5),I+=C/2-F):2===b&&(I=i-2.5-F),e.textBaseline!==O&&(e.textBaseline=O),e.fillText(c,n+M,r+I);var L=s.textDecoration;L&&u._renderTextDecoration(e,L,n+M,r+I,w,D,N);var H=n+S.x,V=H+w;2!==y&&(H+=1,V+=1),0!==y&&3!==y||(H+=Math.max(M-1,0),V+=Math.max(M,0));var j=r+S.y+C;2===s.vAlign&&(j-=.5),j-=x(0,Math.round(C/9)-1),E(j)===j&&(j+=.5);var B=j;e.beginPath();var U=u._linkColor;f&&(U=u._visitedLinkColor),U&&e.strokeStyle!==U&&(e.strokeStyle=U),e.lineWidth=1,e.moveTo(H,j),e.lineTo(V,B),e.stroke(),e.restore()}}},getText:function(e,t){return this._text||e},createEditorElement:function(e){var t=e&&e.sheet&&e.sheet.parent&&e.sheet.parent._host,n=d._getPreferredZIndex(t)+1e3;v(this._cellWrapperElement).css("white-space","nowrap").css("z-index",n).attr(F,"gcEditor").attr("tabindex",1);var r=i(this._target),o=p("a");return v(o).css(O,0).css(U,L).css("display","block").css(j,V).attr("target",r).appendTo(v(this._contentContainer)).css("text-decoration",L),o},_triggerButtonClicked:function(e,t,n,r){if(!e._startEditByKeydown){var o=e.parent;o&&o._triggerButtonClicked(e,t,n,r)}},activateEditor:function(e,t,n,r){if(e&&n){var o=r&&r.sheet;v(e.parentNode.parentNode).bind(k,function(e){8!==e.keyCode||e.ctrlKey||e.shiftKey||e.altKey||d._cancelDefault(e)});var i=this,a=e;if(a){var s=v(a);s.bind(A,function(){if(s.css(z,i._visitedLinkColor),o){var e=o._activeRowIndex,t=o._activeColIndex;o._getModel().getNode(e,t,!0).hyperlinkInfo={id:i._id,visited:!0},i._triggerButtonClicked(o,e,t,r.sheetArea)}return!1})}var l=p(q);v(l).css(O,0).css(R,I).css(j,V).css(W,G).attr(F,"gcEditingInput").css(B,L).css(Y,"transparent");var u=o&&o._getHost();u&&u.insertBefore(l,S),i._clip=l,i._actived=!0}},deactivateEditor:function(e,t){var n=t&&t.sheet,o=this;if(o._clip){var i=n&&n._getHost();i&&r(i,this._clip)}if(e){v(e.parentNode.parentNode).unbind(k);var a=e;a&&v(a).unbind(A)}C.prototype.deactivateEditor.call(o,e,t),o._actived=!1,n&&n.repaint()},updateEditor:function(e,t,n,r){if(e&&n){var o=this,i=o._link,s=r&&r.sheet,l=s&&s._render,u=e;if(u){var c=v(u);i&&c.attr("href",i);var f=o._text||i;f&&c.text(f),c.attr("title",o._linkToolTip);var d=!1,p=s?s._getModel().getNode(s._activeRowIndex,s._activeColIndex):S;p&&p.hyperlinkInfo&&(o._id===p.hyperlinkInfo.id?d=p.hyperlinkInfo.visited:delete p.hyperlinkInfo),d?c.css(z,o._visitedLinkColor):c.css(z,o._linkColor);var h=t.font;!h&&l&&(h=l._getDefaultFont()),l&&s._zoomFactor>1&&(h=l._getZoomFont(h)),h&&c.css(D,h)}if(t&&s){var m=v(e.parentNode),g=a(n,m.width(),m.height(),t.hAlign,t.vAlign);m.css(N,parseInt(m.css(N))+g.y).css(P,parseInt(m.css(P))+g.x),o._clip&&(v(o._clip).css(N,n.y).css(P,n.x).height(n.height).width(n.width).css("border-color",t.backColor||X),c.css("width",n.width)),t.textDecoration&&o._setTextDecoration(m,t.textDecoration)}}},getEditorValue:function(e,t){return this._link},setEditorValue:function(e,t,n){this._link=t},getHitInfo:function(e,t,n,r,o){if(o){var i=o.sheetArea;if((h(i)||3===i)&&n&&r)return{x:e,y:t,row:o.row,col:o.col,cellStyle:n,cellRect:r,sheetArea:i,isFocusAware:!0,sheet:o.sheet}}return S},processMouseDown:function(e){var t=e&&e.sheet,n=this;t&&!t.isEditing()&&(l(e,t,n._text||n._link)?(e.isReservedLocation=!0,n._isMouseDownLink=!0):e.isReservedLocation=!1)},processMouseUp:function(e){var t=e&&e.sheet;if(t&&!t.isEditing()){var n=this;if(l(e,t,n._text||n._link)){if(e.isReservedLocation=!0,n._isMouseDownLink){var r=e.row,o=e.col,a=e.sheetArea,s=t.getValue(r,o,a),u=i(n._target);s&&M(s,u);var c=t._getModel(a).getNode(r,o,!0);c.hyperlinkInfo={id:n._id,visited:!0},t.repaint(e.cellRect),n._triggerButtonClicked(t,r,o,a)}}else e.isReservedLocation=!1;n._isMouseDownLink=!1}},processMouseMove:function(e){var t=e.row,n=e.col,r=e.sheet,o=this;if(r&&(!r.isEditing()||r.getActiveRowIndex()!==t||r.getActiveColumnIndex()!==n)){var i=r._getCanvas();if(l(e,r,o._text||o._link)){e.isReservedLocation=!0,o._showLinkToolTip(r,e);var a=r.getValue(t,n,e.sheetArea);a&&i&&(i.style.cursor=a?"pointer":"text")}else e.isReservedLocation=!1,o._hideLinkToolTip(r),i&&(i.style.cursor=K)}},processMouseLeave:function(e){var t=e.sheet,n=this;if(n._isMouseDownLink=!1,n._hideLinkToolTip(t),t){var r=t._getCanvas();r&&(r.style.cursor=K)}},_showLinkToolTip:function(e,t){var n=this;if(n._linkToolTip){var r=n._getLinkToolTipElement(),o=v(r);o.text(n._linkToolTip);var i=e._eventHandler._getCanvasPosition(),a=i.left+t.x,s=i.top+t.y+20;if(0===o.parent().length){var l=e&&e._getHost();l&&l.insertBefore(r,S),o.css(N,s).css(P,a)}}},_hideLinkToolTip:function(e){var t=this;if(t._linkToolTipElement){var n=e&&e._getHost();n&&t._linkToolTipElement.parentElement===n&&r(n,t._linkToolTipElement),t._linkToolTipElement=S}},_getLinkToolTipElement:function(){var e=this;if(!e._linkToolTipElement){var t=p(q);v(t).css(R,I).css(O,0).css(H,2).css(B,"1px #c0c0c0 solid").css("box-shadow","1px 2px 5px rgba(0,0,0,0.4)").css(W,G).css(Y,X).css(D,"9pt Arial"),e._linkToolTipElement=t}return e._linkToolTipElement},isReservedKey:function(e,t){return 32===e.keyCode&&!e.ctrlKey&&!e.shiftKey&&!e.altKey},processKeyUp:function(e,t){var n=t.sheet,r=this;if(!n)return!1;var o=t.row,a=t.col,s=t.sheetArea,l=n.getValue(o,a,s),u=i(r._target);return l&&(l=l.toString(),M(l,u)),n._getModel(s).getNode(o,a,!0).hyperlinkInfo={id:r._id,visited:!0},n.repaint(n.getCellRect(o,a)),r._triggerButtonClicked(n,o,a,s),!0},getAutoFitWidth:function(e,t,n,r,o){return u(this._text||e,n,r,o,!0)},getAutoFitHeight:function(e,t,n,r,o){return u(this._text||e,n,r,o)},isImeAware:function(e){return!1},toJSON:function(){var e,t=this,n={typeName:t.typeName};return y(J,function(r,o){"link"!==r&&(e=t["_"+r])!==o&&(n[r]=e)}),n},fromJSON:function(e){var t=this;y(J,function(n){var r=e[n];h(r)||(t["_"+n]=r)})}};y(J,function(e){Z[e]=function(t){if("link"!==e)return 0===arguments.length?this["_"+e]:(this["_"+e]=t,this)}}),v.extend(o.prototype,Z),o._getUniqueId=function(){var e=this;return h(e._id)&&(e._id=0),"id_"+e._id++},o._getEditorElement=function(e){var t=this;if(!t._editorElement){var n=o.prototype._createCellTypeElement({sheet:e}),r=n.style,i="-10000px";document.body.insertBefore(n,S),r.visibility=V,r.top=i,r.left=i,t._editorElement=n}return t._editorElement},b.HyperLink=o,b._typeDict[8]=o,e.exports=b},function(e,t,n){function r(){S.call(this),this.allowOverflow=!0,this.typeName="1"}function o(e,t){var n=e.srcElement||e.target;if(n&&"gcEditingInput"===n.getAttribute(A)&&13===e.keyCode&&(e.ctrlKey||e.altKey)){var r=n.selectionStart,o=n.value,a=o.substr(0,r),s=o.substr(r,o.length-r);n.value=a+"\n"+s,n.selectionStart=r+1,n.selectionEnd=r+1;var l=m._getActiveElement();if(l instanceof i){var u=l.getCellType(l._activeRowIndex,l._activeColIndex);u&&u.updateEditor(l._editor,B,B,t)}return y(e),!0}return!1}var i=n(6).Worksheet,a=n(4).GC$,s=n(3),l=n(12).CellTypes,u=n(0),t=n(2),c=t.CellTypes||(t.CellTypes={}),f=s._util._createElement,d=u._Types._isNullOrUndefined,p=s._WordWrapHelper,h=s.Events.EditChange,m=s._FocusHelper,g=s._util,_=g._browser,v=_.msie,y=g._cancelDefault,b=g._getHAlignByValueType,w=g._formatValue2Text,C=g._getPreferredZIndex,S=l.Base,x=l.Context,T="left",E="right",M="center",A="gcUIElement",k="none",R=".gcEditingInput",I="width",O="height",D="text-align",P="hidden",N="word-wrap",F="overflow",L="normal",H="break-word",V="overflow-y",j="scroll",B=null,U=Math.ceil,W=Math.min,z=Math.max;a.inherit(r,S),a.extend(r.prototype,{getText:function(e,t){return e},paintValue:function(e,t,n,r,o,i,a,s){var l=this;t=l.getText(t,s);var u,c={value:B};if(u=l.format(t,a.formatter||a._autoFormatter,c),a.watermark&&!u&&0!==a.labelOptions.visibility)return void l.paintText(e,a.watermark,n,r,o,i,a,s,a.watermark,c,.337);u&&l.paintText(e,t,n,r,o,i,a,s,u,c)},createEditorElement:function(e){var t=e&&e.sheet&&e.sheet.parent&&e.sheet.parent._host,n=C(t)+1e3;a(this._cellWrapperElement).css("z-index",n);var r=a(f("textarea"));return r.css({font:"normal 11pt calibri",outline:k,resize:k,border:k,padding:"1px",display:"block","min-height":"0px","box-sizing":"content-box"}).css(N,"normal").attr({tabindex:-1,autocomplete:"off"}).css(F,P).attr(A,"gcEditingInput"),e.sheet.options.addReadonlyForMobile&&r.attr("readonly","readonly"),r[0]},getEditorValue:function(e,t){if(e){var n=e.value;if(!d(n)&&n.length>0)return n}return B},setEditorValue:function(e,t,n,r,o){if(e){var i=(!v||parseFloat(_.version)<11)&&n&&n.sheet&&n.sheet._startEditByKeydown,a=e.value,s=e._oldValue;if(i&&g._browser.safari&&229===r._keydownCode&&a&&a.length&&a.replace(s,"")?(r._needSelectInput=!1,e.value=" "===a?"":a.charAt(a.length-1)):e.value=d(t)||i?"":t,o&&g._browser.safari)return;e.selectionStart=e.selectionEnd=e.value.length}},focus:function(e,t){this.isImeAware()&&e?(e.focus(),e.selectionStart=e.value.length):e.parentNode.focus()},_formatEditorValue:function(e,t,n,r){var o=e&&r&&r.sheet;return w(t,n,o)},activateEditor:function(e,t,n,r){var i=e&&r&&r.sheet;if(i){var s=this,l=e;if(l){var u=a(l);s._editingElement=l,u.bind("keydown"+R,function(a){var u=a.keyCode,c=a.ctrlKey,f=a.altKey,d=a.shiftKey;if(229===u||0===u||s._isImeInputing||s._updateEditorImp(e,t,n,a,r,!0),!o(a,r)){var p=0===l.selectionStart&&37===u&&!c&&!d&&!f,h=l.selectionStart===l.value.length&&39===u&&!c&&!d&&!f;l.selectionStart===l.selectionEnd&&(p||h)&&2===i._editorStatus&&y(a)}}),u.bind("keyup"+R,function(o){var a=o.keyCode,l=o.ctrlKey,u=o.altKey;46!==a&&8!==a&&(90!==a&&89!==a||!l||u)||s._updateEditorImp(e,t,n,o,r),(13!==a&&9!==a||l||u)&&i._trigger(h,{sheet:i,sheetName:i._name,row:i._activeRowIndex,col:i._activeColIndex,editingText:s.getEditorValue(e,r)})}),u.bind("paste"+R,function(o){s._pasteInputSizingToken=setTimeout(function(){s._updateEditorImp(e,t,n,o,r),s._pasteInputSizingToken&&(clearTimeout(s._pasteInputSizingToken),delete s._pasteInputSizingToken)},10)}),u.bind("mousedown"+R,function(){1===i._editorStatus&&(i._editorStatus=2,i._raiseEditorStatusChanged(1,2))}),u.bind("compositionstart"+R,function(){s._isImeInputing=!0,s._oldValueBeforeImeInputting=u.val()}),u.bind("compositionupdate"+R,function(o){s._updateEditorImp(e,t,n,o||B,r,!0)}),u.bind("compositionend"+R,function(o){s._updateEditorImp(e,t,n,o||B,r),s._isImeInputing=!1})}}},deactivateEditor:function(e,t){e&&a(e).unbind(R),this._editingElement=B},getEditingElement:function(){return this._editingElement},_updateEditorImp:function(e,t,n,r,o,i){var s=o&&o.sheet,l=this,u=e;if(u&&s){var c=a(u),f=s._render;if(s.isEditing()){var h,m,g,_,y,w,C=B,S=T,A=B,k=x._getPositionOffset;if(t&&(y=k(t,0),_=k(t,1),w=k(t,2),g=k(t,3),C=b(t.hAlign,e._originalValue),1===C?S=M:2===C&&(S=E),c.css(D,S),t.backColor&&c.css("background-color",t.backColor),t.foreColor&&c.css("color",t.foreColor),A=t.font||f._getDefaultFont(),A&&(s._zoomFactor>1&&(A=f._getZoomFont(A)),c.css("font",A)),t.textDecoration&&l._setTextDecoration(c,t.textDecoration)),n){var R=s._getSheetLayout();h=parseInt(c.css("padding-left"),10)+parseInt(c.css("padding-right"),10),m=parseInt(c.css("padding-top"),10)+parseInt(c.css("padding-bottom"),10);var Y=n.width;n.x+n.width>R.width&&(Y=R.width-n.x),c.css(I,Y-h).css(O,n.height-m),d(C)||0===C?u.maxWidth=R.width-n.x-h-_:1===C?u.maxWidth=2*z(0,W(R.width-n.x-n.width-h,n.x-R._rowHeaderWidth-h))+n.width:2===C&&(u.maxWidth=n.x+n.width-R._rowHeaderWidth-h-_),u.maxHeight=R.height-n.y-m-w,u.minWidth=parseInt(u.style.width,10),u.minHeight=parseInt(u.style.height,10)}try{i=i&&r&&r.keyCode&&s._eventHandler._allowEnterEditing(r)&&0===u.selectionStart&&u.selectionEnd===u.value.length,i=i||o&&o.sheet&&o.sheet._startEditByKeydown}catch(e){}var G=i?"":u.value;(A=u.style.font)||(A=f._getZoomFont(f._getDefaultFont()));var K=s._getFontHeight(A);if(!i&&r){if(s._eventHandler._allowEnterEditing(r)){var X=u.selectionStart,q=G.substr(0,X),J=G.substr(X,G.length-X);G=q+String.fromCharCode(r.keyCode)+J}l._isImeInputing&&(G=v?c.val():l._oldValueBeforeImeInputting+r.data)}var Z=[];Z=t&&t.wordWrap?p._getWrapInfo(G,c.width(),A):G.split(/\r\n|\r|\n/);var Q,$,ee,te=Z.length;if(u.minWidth=W(u.minWidth,u.maxWidth),u.minHeight=W(u.minHeight,u.maxHeight),t&&t.wordWrap||te>0){var ne=te*K;if(t&&t.wordWrap)c.css(N,H).css(F,P);else{var re=0,oe=[];for(Q=0;Q<te;Q++){var ie=Z[Q];$=s._getStringWidth(ie,A),oe.push($),re=z(re,$)}if(re<=u.minWidth)c.css(I,u.minWidth).css(N,L).css(F,P);else if(re>u.minWidth&&re<=u.maxWidth)c.css(I,re).css(N,L).css(F,P);else if(re>u.maxWidth)for(c.css(I,u.maxWidth).css(N,H).css(F,P),ne=0,Q=0;Q<oe.length;Q++)$=oe[Q],$<=u.maxWidth?ne+=K:$>u.maxWidth&&(ee=U($/u.maxWidth),ne+=K*ee)}ne<=u.minHeight?c.css(O,u.minHeight):ne>u.minHeight&&ne<=u.maxHeight?c.css(O,ne):ne>u.maxHeight&&c.css(O,u.maxHeight).css(V,j)}else{var ae=s._getStringWidth(G,A);if(ae>u.minWidth&&ae<=u.maxWidth)c.css(I,ae).css(O,u.minHeight).css(N,L).css(F,P);else if(ae<=u.minWidth)c.css(I,u.minWidth).css(O,u.minHeight).css(N,L).css(F,P);else if(ae>u.maxWidth){c.css(I,u.maxWidth).css(N,H),ee=U(ae/u.maxWidth);var se=K*ee;se<=u.minHeight?c.css(O,u.minHeight).css(F,P):se<=u.maxHeight?c.css(O,se).css(F,P):se>u.maxHeight&&c.css(O,u.maxHeight).css(V,j)}}C=c.css(D);var le=c.width()-u.minWidth;d(C)||C===T||(C===M?c.css(T,u.originalLeft-le/2):C===E&&c.css(T,u.originalLeft-le));var ue=c.height()+m+y+w,ce=h+g+_;c.css(V)===j?l.updateEditorContainer(u,{width:u.offsetWidth+ce,height:i?0:ue},t):l.updateEditorContainer(u,{width:c.width()+ce,height:ue},t)}}},updateEditor:function(e,t,n,r){if(this._updateEditorImp(e,t,n,B,r),v&&e){var o=a(e),i=o.width();o.width(i+1).width(i)}},updateImeMode:function(e,t,n){this.isImeAware()&&e&&x._setImeMode(e,t)},isReservedKey:function(e,t){var n=e.srcElement||e.target,r=e.keyCode,o=e.ctrlKey,i=e.altKey,a=e.metaKey;return!!(n&&t&&t.isEditing&&"gcEditingInput"===n.getAttribute(A))&&(13===r&&(o&&!e.shiftKey||i)||90===r&&o&&!i||89===r&&o&&!i||67===r&&(o||a)&&!i||88===r&&(o||a)&&!i)},isImeAware:function(e){return!0}}),c.Text=r,c._typeDict[1]=r,e.exports=t},function(e,t,n){function r(e){e.preventDefault?e.preventDefault():e.returnValue=!1}var t=n(2),o=n(4).GC$,i=n(3),a=n(0)._Types._isNullOrUndefined,s=null,l=i._util,u=l._browser,c=l._cancelDefault,f=i._util._createElement,d=i._util._defProperty,p=document,h=Math.round,m=Math.ceil,g="gc-scroll-container",_="gc-scroll-corner-all",v="gc-scroll-arrow",y="gc-scrollbar-wrapper",b="gc-scroll-bar",w="gc-scroll-arrowUp",C="gc-scroll-arrowDown",S="gc-scroll-arrowLeft",x="gc-scroll-arrowRight",T="gc-scrollbar-vertical",E="gc-scrollbar-horizontal",M="gc-no-user-select",A="width",k="height",R="gc-scrollbar-stateActive ui-state-active",I="left",O="right",D="top",P="bottom",N="margin-left",F="position",L="border",H="padding",V="margin",j="overflow",B="display",U="outline",W="borderWidth",z="boxSizing",Y="margin-top",G=".gcScrollbar",K="mousedown"+G,X="mouseup"+G,q="mousemove"+G,J="mouseover"+G,Z="mouseout"+G,Q="mousewheel",$="DOMMouseScroll",ee="scroll"+G,te=function(){function e(e,t){var n=this;n._showHorizontalScrollbar=!0,n._showVerticalScrollbar=!0,n._defaultScrollbarSize=18,n._$superPanel=e&&o(e),n._$content=t&&o(t),n._refreshLayout(!0)}return e.prototype={constructor:e,_horizontalSmallChange:d("horizontalSmallChange",10),_verticalSmallChange:d("verticalSmallChange",10),_refreshLayout:function(e){function t(){return o._createElement("div",[F,I,D,L,H,V],["absolute",0,0,"none",0,0])}function n(e,t){var n=t?l._horizontalScrollbar:l._verticalScrollbar;if(!n){var r=new ne(t),i=o._createElement("div");t?(l._$horizontalBarContainer=i,l._horizontalScrollbar=r,i.css([F,I,P,L,H,V],["absolute",0,0,"none",0,0])):(l._$verticalBarContainer=i,l._verticalScrollbar=r,i.css([F,O,D,L,H,V],["absolute",0,0,"none",0,0]));var a=(t?l._horizontalScrollbar:l._verticalScrollbar)._getScrollbar();return i.append(a),e.append(i),r}return n}function r(e,t,n,r,i,a){a?(l._$horizontalBarContainer.css([A,k],[t,r]),e._width(t),e._height(r)):(l._$verticalBarContainer.css([A,k],[r,t]),e._width(r),e._height(t)),e._minimum(0),e._maximum(i-t),e._pageValue(t),e._smallChange(a?l._horizontalSmallChange():l._verticalSmallChange()),e._largeChange(t),e._refreshLayout(),o(e._getScrollbar()).bind(ee,function(e,t){n.css(a?I:D,0-t.newValue)}),a?l._$horizontalBarContainer.show():l._$verticalBarContainer.show()}function i(e){l._$contentWrapper||(l._$contentWrapper=t(),l._$contentWrapper.css([j,B],["hidden","inline-block"]),e.append(l._$contentWrapper))}function a(e){l._$tempContentWrapper||(l._$tempContentWrapper=o._createElement("div",F,"relative",s,e))}var l=this;if(l._$superPanel&&l._$content){var c=l._defaultScrollbarSize,f=l._$content.width(),d=l._$content.height(),p=l._$superPanel.width(),g=l._$superPanel.height(),_=p-c,v=g-c,y=!1;l._$container||(l._$container=t(),l._$container.css([F,j],["relative","hidden"]),y=!0),l._$container.css([A,k],[p,g]),i(l._$container),a(l._$contentWrapper),e&&l._$tempContentWrapper.append(l._$content).css([D,I],[0,0]),u.chrome&&(f=h(f),d=h(d),p=m(p),g=m(g));var b=l._isNeedScrollbars(f,d,p,g),w=b._isNeedVScroll,C=b._isNeedHScroll;if(C){w||(_+=c);r(n(l._$container,!0),_,l._$tempContentWrapper,c,f,!0)}else l._$horizontalBarContainer&&l._$horizontalBarContainer.hide();if(w){C||(v+=c);r(n(l._$container,!1),v,l._$tempContentWrapper,c,d,!1)}else l._$verticalBarContainer&&l._$verticalBarContainer.hide();C||w||(_+=c,v+=c),l._showHorizontalScrollbar=C,l._showVerticalScrollbar=w,l._pageWidth=_,l._pageHeight=v,l._$contentWrapper.css([A,k],[_,v]),y&&(l._$superPanel.append(l._$container),l._initEvent())}},_scrollChildIntoView:function(e){var t=this,n=t._getScrollOffset(e),r=n._left,o=n._top;!a(r)&&t._horizontalScrollbar&&t._hScrollTo(r),!a(o)&&t._verticalScrollbar&&t._vScrollTo(o)},_hScrollTo:function(e){var t=this;t._horizontalScrollbar.value(e);var n=t._pageWidth,r=t._$content.width();e>=0&&e<=r-n&&t._$tempContentWrapper.css(I,0-e)},_vScrollTo:function(e){var t=this;t._verticalScrollbar.value(e);var n=t._pageHeight,r=t._$content.height();e>=0&&e<=r-n&&t._$tempContentWrapper.css(D,0-e)},_isNeedScrollbars:function(e,t,n,r){var o=this._defaultScrollbarSize,i=n-o,a=r-o,s={_isNeedHScroll:!1,_isNeedVScroll:!1};return e>n&&(s._isNeedHScroll=!0,s._isNeedVScroll=t>a),t>r&&(s._isNeedVScroll=!0,s._isNeedHScroll=e>i),s},_getScrollOffset:function(e){var t,n,r,i,a,l,u,c=o(e),f=this._$contentWrapper,d=this._$tempContentWrapper,p={_left:s,_top:s};return e?(t=c.offset(),n=d.offset(),r=f.offset(),t.leftWidth=t.left+c.outerWidth(),t.topHeight=t.top+c.outerHeight(),r.leftWidth=r.left+f.outerWidth(),r.topHeight=r.top+f.outerHeight(),i=t.left-n.left,t.left<r.left?p._left=i:t.leftWidth>r.leftWidth&&(a=t.leftWidth-n.left-f.innerWidth(),p._left=i<a?i:a),l=t.top-n.top,t.top<r.top?p._top=l:t.topHeight>r.topHeight&&(u=t.topHeight-n.top-f.innerHeight(),p._top=l<u?l:u),p):p},_initEvent:function(){var e=this;this._$tempContentWrapper&&(e._mousewheelHandler=function(t){e._contentContainerMousewheel(t)},e._$tempContentWrapper.bind(Q,e._mousewheelHandler),e._$tempContentWrapper.bind($,e._mousewheelHandler))},_contentContainerMousewheel:function(e){var t=this;a(e.wheelDelta)&&a(e.detail)&&(e.wheelDelta=e.originalEvent.wheelDelta,e.detail=e.originalEvent.detail);var n=e.detail?e.detail:e.wheelDelta/-40,r=n,o=t._verticalScrollbar,i=parseInt(t._$tempContentWrapper.css(D)),s=t._pageHeight,l=t._$content.height();l<s&&(l=s),isNaN(i)&&(i=0);var u=i-r*t._verticalSmallChange();u>=0&&(u=0),u<0&&0-u>l-s&&(u=0-(l-s)),u!==i&&(t._$tempContentWrapper.css(D,u),t._showVerticalScrollbar&&o.value(0-u)),c(e)}},e}();t._ScrollablePanel=te;var ne=function(){function e(e,t,n,r,o,i,a){var l=this;l._isMousedownInScrollbar=!1,l._isMousedownInArrowButton=!1,l._scrollTimeOutArrow=s,l._scrollTimeOutContainer=s,l._initialDelay=300,l._trackClickPepeatFreq=70,l._isHorizontalScroll=e,l._width("number"==typeof t?t:0),l._height("number"==typeof n?n:0),l._pageValue("number"==typeof r?r:0),l._maximum("number"==typeof o?o:0),l._minimum("number"==typeof i?i:0),l._scrollType="number"==typeof a?a:1,l._isMouseCapture=!1,l._scrollPosition=0,l._value=l._minimum(),l._refreshLayout()}return i._defineFeature(e),e.prototype={constructor:e,_getScrollbar:function(){return this._scrollContainerDiv},_smallChange:d("smallChange",1),_largeChange:d("largeChange",10),_pageValue:d("pageValue",10,function(e){e<=0&&this._pageValue(1)}),_maximum:d("maximum",100,function(e){e<=0&&this._maximum(0)}),_minimum:d("minimum",0,function(e){e<=0&&this._minimum(0)}),value:function(e){var t=this;if(0===arguments.length)return t._value;if("number"==typeof e&&e<=t._maximum()&&e>=t._minimum()){t._value=e;var n=(e-t._minimum())*t._scrollUnit;t.scrollTo(n,!0)}return t},_width:d("width",0),_height:d("height",0),_refreshLayout:function(){function e(){a._scrollContainerDiv=f("div"),a._$scrollContainerDiv=o(a._scrollContainerDiv),a._$scrollContainerDiv.css([F,I,D,j,U,L,H,V],["relative",0,0,"hidden","none","none",0,0]).addClass(g+" "+_+" "+m)}function t(e){a._$arrowStartDiv=o._createElement("div",[F,B,W,H,V,z],["absolute","inline-block","1px",0,0,"content-box"],v+" "+ee,e),a._$arrowStartSpan=o._createElement("span",[B,L,H,V],["block","none",0,0],J+" "+te,a._$arrowStartDiv)}function n(e){a._$scrollbarWrapperDiv=o._createElement("div",[F,B,z,L,H,V],["absolute","inline-block","content-box","none",0,0],y+" "+y,e)}function r(e){a._$scrollbarDiv=o._createElement("div",[F,W,H,V,z],["absolute","1px",0,0,"content-box"],b+" "+M+" "+ne,e),a._$scrollbarSpan=o._createElement("span",[B,L,H,V],["block","none",0,0],Q+" "+re,a._$scrollbarDiv)}function i(e){a._$arrowEndDiv=o._createElement("div",[F,B,W,H,V,z],["absolute","inline-block","1px",0,0,"content-box"],v+" "+oe,e),a._$arrowEndSpan=o._createElement("span",[B,L,H,V],["block","none",0,0],Z+" "+ie,a._$arrowEndDiv)}var a=this,s=a._height(),l=a._width(),u=0,c=0,d=!1,p=2,m="ui-widget ui-corner-all",R=s,G=l-2*s,K=R,X=I,q=O,J=S,Z=x,Q=E,$=N,ee="ui-state-default ui-corner-bl btn btn-default",te="ui-icon ui-icon-triangle-1-w",ne="gc-scroll-handle ui-state-default ui-corner-all ui-draggable btn btn-default",re="ui-icon ui-icon-grip-solid-vertical",oe="ui-state-default ui-corner-br btn btn-default",ie="ui-icon ui-icon-triangle-1-e";a._scrollSize=G,a._isHorizontalScroll||(R=l,G=R,K=s-2*l,X=D,q=P,J=w,Z=C,Q=T,$=Y,ee="ui-state-default ui-corner-tr btn btn-default",te="ui-icon ui-icon-triangle-1-n",ne="gc-scroll-handle ui-state-default ui-corner-all ui-draggable btn btn-default",re="ui-icon ui-icon-grip-solid-horizontal",oe="ui-state-default ui-corner-br btn btn-default",ie="ui-icon ui-icon-triangle-1-s",a._scrollSize=K);var ae=a._scrollSize,se=a._maximum()-a._minimum();a._scrollbarSize=a._pageValue()*ae/(se+a._pageValue()),a._scrollbarSize>ae&&(a._scrollbarSize=ae),a._scrollbarSize<10&&(a._scrollbarSize=10);var le=a._scrollbarSize;a._scrollUnit=0===se?1:(ae-le)/se,a._isHorizontalScroll?(u=le,c=R):(u=R,c=le),a._$scrollContainerDiv||(d=!0,e()),a._$arrowStartDiv||t(a._$scrollContainerDiv),a._$scrollbarWrapperDiv||n(a._$scrollContainerDiv),a._$scrollbarDiv||r(a._$scrollbarWrapperDiv),a._$arrowEndDiv||i(a._$scrollContainerDiv),a._$scrollContainerDiv.css([A,k],[l,s]),a._$arrowStartDiv.css([X,A,k],[0,R-p,R-p]),a._$arrowStartSpan.css([A,k],["100%","100%"]),a._$scrollbarWrapperDiv.css([X,A,k],[R,G,K]),a._$scrollbarDiv.css([X,A,k],[a._scrollPosition,h(u-p),h(c-p)]),a._$scrollbarSpan.css([A,k,$],[R-p,R-p,Math.floor((a._scrollbarSize-R)/2)]),a._$arrowEndDiv.css([q,A,k],[0,R-p,R-p]),a._$arrowEndSpan.css([A,k],["100%","100%"]),d&&a._initEvents()},_initEvents:function(){function t(e,t){e.bind(K,function(e){n._arrowMousedown(e,t)}).bind(X,function(e){n._arrowMouseup(e,t)}).bind(J,function(e){n._arrowMouseover(e,t)}).bind(Z,function(e){n._arrowMouseout(e,t)})}var n=this;t(n._$arrowStartDiv,!0),t(n._$arrowEndDiv,!1),n._$scrollbarDiv.bind(K,function(e){n._scrollbarMousedown(e)}).bind(q,function(e){n._scrollbarMousemove(e)}).bind(X,function(e){n._scrollbarMouseup(e)}).bind(J,function(e){n._scrollbarMouseover(e)}).bind(Z,function(e){n._scrollbarMouseout(e)}),n._$scrollbarWrapperDiv.bind(K,function(e){if(u&&u.mozilla){var t=(new Date).valueOf(),r=n._lastMouseDownTime;if(n._lastMouseDownTime=t,r&&t-r<100)return}n._scrollbarContainerMousedown(e)}).bind(X,function(e){n._scrollbarContainerMouseup(e)}),n._mousewheelHandler=function(e){n._scrollContainerMousewheel(e)},n._$scrollContainerDiv.bind(Q,n._mousewheelHandler),n._$scrollContainerDiv.bind($,n._mousewheelHandler),e._callFeatureHandler(n,"initEvents",n._scrollContainerDiv)},dispose:function(){function t(e){e&&e.unbind(G)}var n=this;t(n._$arrowEndDiv),t(n._$scrollbarDiv),t(n._$arrowStartDiv),t(n._$scrollbarWrapperDiv),n._$scrollContainerDiv&&(n._mousewheelHandler&&(n._$scrollContainerDiv.unbind(Q,n._mousewheelHandler),n._$scrollContainerDiv.unbind($,n._mousewheelHandler)),e._callFeatureHandler(n,"dispose",n._scrollContainerDiv),n._$scrollContainerDiv.unbind(G).remove())},_handleDocumentMouseMove:function(){var e=this;e._isMouseCapture||(o(p).bind(q,function(t){e._scrollbarMousemove(t)}).bind(X,function(t){e._scrollbarMouseup(t)}),e._isMouseCapture=!0)},_unhandleDocumentMouseMove:function(){this._isMouseCapture&&(this._isMouseCapture=!1,o(p).unbind(q).unbind(X))},_arrowMousedown:function(e,t){var n=0,o=this,i=!0;if(o._isMousedownInArrowButton=!0,null===o._scrollTimeOutArrow){t?(o._$arrowStartDiv.addClass(R),n=0-o._smallChange(),o._scrollEventType=0):(o._$arrowEndDiv.addClass(R),n=o._smallChange(),o._scrollEventType=1);var a=function(){o.scrollTo(o._scrollPosition+n*o._scrollUnit,!1),1===o._scrollType&&(o._scrollTimeOutArrow=setTimeout(a,i?o._initialDelay:o._trackClickPepeatFreq)),i=!1};a(),r(e)}},_arrowMouseup:function(e,t){var n=this;(t?n._$arrowStartDiv:n._$arrowEndDiv).removeClass(R),n._endArrowScroll(),r(e)},_arrowMouseover:function(e,t){var n=this;(t?n._$arrowStartDiv:n._$arrowEndDiv).addClass("gc-scroll-arrow-hover ui-state-hover"),r(e)},_arrowMouseout:function(e,t){var n=this;(t?n._$arrowStartDiv:n._$arrowEndDiv).removeClass("gc-scroll-arrow-hover gc-scrollbar-stateActive ui-state-hover ui-state-active"),n._endArrowScroll(),r(e)},_scrollbarMousedown:function(e){var t=this;if(0===e.button){t._isMousedownInScrollbar=!0,t._oldPosition={x:e.pageX,y:e.pageY},t._handleDocumentMouseMove(),t._$scrollbarDiv.addClass(R);var n=t._$scrollbarDiv.offset(),o=t._$scrollbarDiv.outerWidth(!0),i=t._$scrollbarDiv.outerHeight(!0),a=t._$scrollbarWrapperDiv.offset(),s=t._$scrollbarWrapperDiv.outerWidth(!0),l=t._$scrollbarWrapperDiv.outerHeight(!0);t._edgePosition={isBeyondEdge:!1,startEdgePosition:{x:a.left+e.pageX-n.left,y:a.top+e.pageY-n.top},endEdgePosition:{x:a.left+s-(o-e.pageX+n.left),y:a.top+l-(i-e.pageY+n.top)}}}r(e)},_scrollbarMousemove:function(e){var t=this;t._isMousedownInScrollbar&&(t._currentPosition={x:e.pageX,y:e.pageY},t._scrollbarDrag(),t._oldPosition=t._currentPosition,o(p.body).attr("unselectable","on").addClass(M)),r(e)},_scrollbarMouseup:function(e){var t=this;t._isMousedownInScrollbar=!1,t._scrollEventType=4,t._edgePosition=null,t._$scrollContainerDiv.trigger(ee,{newValue:t._value,oldValue:t._value,scrollOrientation:t._isHorizontalScroll?0:1,scrollEventType:t._scrollEventType});var n=t._value,i=(n-t._minimum())*t._scrollUnit,a="left";t._isHorizontalScroll||(a="top"),t._scrollPosition=i,t._$scrollbarDiv.css(a,i),t._unhandleDocumentMouseMove(),o(p.body).removeClass(M),o(p.body).attr("unselectable")&&o(p.body).removeAttr("unselectable"),t._$scrollbarDiv.removeClass(R),t._scrollEventType=6,t._$scrollContainerDiv.trigger(ee,{newValue:t._value,oldValue:t._value,scrollOrientation:t._isHorizontalScroll?0:1,scrollEventType:t._scrollEventType}),r(e)},_scrollbarMouseover:function(e){this._$scrollbarDiv.addClass("gc-scrollbar-stateHover ui-state-hover"),r(e)},_scrollbarMouseout:function(e){this._$scrollbarDiv.removeClass("gc-scrollbar-stateHover ui-state-hover"),r(e)},_scrollContainerMousewheel:function(e){var t=this;a(e.wheelDelta)&&a(e.detail)&&(e.wheelDelta=e.originalEvent.wheelDelta,e.detail=e.originalEvent.detail);var n=e.detail?e.detail:e.wheelDelta/-40,o=n/3*t._smallChange()*t._scrollUnit;t._scrollEventType=o>=0?1:0,t.scrollTo(t._scrollPosition+o,!1),t._scrollEventType=6;var i={newValue:t._value,oldValue:t._value,scrollOrientation:t._isHorizontalScroll?0:1,scrollEventType:t._scrollEventType};t._$scrollContainerDiv.trigger(ee,i),r(e)},_scrollbarContainerMousedown:function(e){var t=this,n=!0,o=e.pageX,i=e.pageY,a=0,s=t._$scrollbarWrapperDiv.offset(),l=t._largeChange();if(null===t._scrollTimeOutContainer){a=t._isHorizontalScroll?o-s.left-t._scrollPosition:i-s.top-t._scrollPosition;var u=function(){var e=t._$scrollbarWrapperDiv.offset(),r=0,s=t._scrollPosition;if((r=t._isHorizontalScroll?o-e.left-s:i-e.top-s)*a<0||r>=0&&r<t._scrollbarSize)return void t._endContainerScroll();if(a<0)t._scrollEventType=2,t.scrollTo(s-l*t._scrollUnit,!1);else{if(!(a>0))return void t._endContainerScroll();t._scrollEventType=3,t.scrollTo(s+l*t._scrollUnit,!1)}1===t._scrollType&&(t._scrollTimeOutContainer=setTimeout(u,n?t._initialDelay:t._trackClickPepeatFreq)),n=!1};u(),r(e)}},_scrollbarContainerMouseup:function(e){this._endContainerScroll(),r(e)},_endContainerScroll:function(){var e=this;e._scrollTimeOutContainer&&clearTimeout(e._scrollTimeOutContainer),e._scrollTimeOutContainer=s,e._scrollEventType=6;var t={newValue:e._value,oldValue:e._value,scrollOrientation:e._isHorizontalScroll?0:1,scrollEventType:e._scrollEventType};e._$scrollContainerDiv.trigger(ee,t)},_endArrowScroll:function(){var e=this;if(e._isMousedownInArrowButton){e._isMousedownInArrowButton=!1,e._scrollTimeOutArrow&&clearTimeout(e._scrollTimeOutArrow),e._scrollTimeOutArrow=s,e._scrollEventType=6;var t={newValue:e._value,oldValue:e._value,scrollOrientation:e._isHorizontalScroll?0:1,scrollEventType:e._scrollEventType};e._$scrollContainerDiv.trigger(ee,t)}},_scrollbarDrag:function(){function e(e){return o._isHorizontalScroll?e.x:e.y}function t(e,t){o._isHorizontalScroll?e.x=t:e.y=t}var n,r,o=this,i=o._scrollPosition,a=o._currentPosition,s=o._edgePosition,l=e(a),u=e(o._oldPosition);if(s&&s.isBeyondEdge){var c=e(s.startEdgePosition),f=e(s.endEdgePosition);if(n=l<c,r=l>f,n||r)return;u<c&&t(o._oldPosition,c),u>f&&t(o._oldPosition,f)}var d=l-u,p=i+d;p!==i&&(o._scrollEventType=5,o.scrollTo(p,!1))},scrollTo:function(e,t){var n=this,r=D,o=n._scrollSize-n._scrollbarSize;n._isHorizontalScroll&&(r=I);var i=!1;e>o&&(e=o,i=!0),e<0&&(e=0,i=!0),n._edgePosition&&(n._edgePosition.isBeyondEdge=i);var a=h(e/n._scrollUnit)+n._minimum(),s=n._value,l=!1;if(!t){var u={newValue:a,oldValue:s,scrollOrientation:n._isHorizontalScroll?0:1,scrollEventType:n._scrollEventType};n._$scrollContainerDiv.trigger(ee,u),l=u.ignoreUpdatePosition,u.newValue>n._maximum()&&(u.newValue=n._maximum()),a=u.newValue}n._value=a,5!==n._scrollEventType&&(e=(a-n._minimum())*n._scrollUnit),n._scrollPosition=e,l||n._$scrollbarDiv.css(r,e)}},e}();t._Scrollbar=ne,e.exports=t},function(e,t,n){function r(e){l.call(this,e);var t=this;t._tabLeftPadding=13,t._tabRightPadding=12,t._tabSpace=0,t._resizeBarWidth=30,t._itemWidth=28,t._moreTabWidth=28,t._newTabSize=28,t._firstTabSpace=0,t._font="10pt Segoe UI"}var t=n(2),o=n(0)._ColorHelper,i=n(4).GC$,a=n(3),s=n(8)._StyleHelper,l=n(32)._SheetTabBase,u=n(7),c=o._invertColor,f=o._fromString,d=a._ThemeStyleHelper,p=null,h="navButton";i.inherit(r,l),i.extend(r.prototype,{_getNavigationButtonWidth:function(){var e=this._workbook;return e&&e.options.tabNavigationVisible?this._itemWidth:0},_getNavigationButtonHeight:function(){var e=this._workbook;return e&&e.options.tabNavigationVisible?e._getTabStripHeight():0},_getFirstMoreTabWidth:function(){return this._moreTabWidth},_getSecondMoreTabWidth:function(){return this._hideNewTabSecondMoreTab?0:this._moreTabWidth},_getNewTabSize:function(){return this._hideNewTabSecondMoreTab?0:this._newTabSize},_getTabEndPosition:function(){for(var e=this,t=e._workbook.sheets,n=e._getTabStartPosition(),r=e._tabSizes,o=e._getBounds(),i=o.x+o.width-e._resizeBarWidth-e._getNewTabSize()-e._getSecondMoreTabWidth(),a=e._firstTab,s=t.length;a<s;a++)if(t[a].visible()&&(n+=r[a]),n>i){n=i;break}return n},_getTabStartPosition:function(){var e=this;return 2*e._getNavigationButtonWidth()+e._getFirstMoreTabWidth()+e._getNavigationMarginLeft()},_getNavigationMarginLeft:function(){var e=this,t=e._workbook;return t&&t.options.tabNavigationVisible?e._resizeBarWidth/2:0},hitTest:function(e,t){var n=this,r=n._getFirstMoreTabWidth(),o=n._getSecondMoreTabWidth(),i=n._getBounds();if(i.x+i.width-n._resizeBarWidth<e&&e<i.x+i.width&&n._workbook.options.showHorizontalScrollbar)return{element:"resizeBar"};var a,s,l,u=-1,c=n._resizeBarWidth/2,f=n._getNavigationButtonWidth();for(s=1,l=3,a=s;a<l;a++){if(c<e&&e<c+f){u=a;break}c+=f}if(-1!==u)return{element:h,index:a};if((c=n._getTabStartPosition())-r<=e&&e<c)return{element:h,index:5,position:c};var d=0,p=i.x+i.width-n._resizeBarWidth-n._getNewTabSize()-o,m=n._workbook.sheets,g=n._tabSizes;if(n._firstTab>-1)for(a=n._firstTab;a<m.length&&a<g.length;a++)if(m[a].visible()){if(d=g[a],e<p&&c<e&&e<c+d+n._tabSpace)return{element:"tab",index:a,position:c};c+=d+n._tabSpace}return c>p&&(c=p),c<e&&e<c+o?{element:h,index:6,position:c}:(c+=o,n._workbook.options.newTabVisible&&c<e&&e<c+n._getNewTabSize()?{element:"newTab",position:c}:{element:""})},_isCoverSheetTab:function(){var e=this;return e._activePos+e._tabSizes[e._activeIndex]>e._getCoverPosition()},_getCoverPosition:function(){var e=this;return e._getBounds().width-e._resizeBarWidth-e._getNewTabSize()-e._getSecondMoreTabWidth()},_getInputTopPosition:function(){return 6},_getTabIndicatorEdgeElement:function(){return h},_getBasicWidth:function(){return this._getTabStartPosition()},_paintBackground:function(e,t){e.save(),e.beginPath();var n=d._getVisualStateThemeStyle(0,"gc-tabStripBackground");this._backgroundColor=f(n.backgroundColor),e.fillStyle=n.backgroundColor,e.fillRect(t.x,t.y,t.width,t.height),e.beginPath(),e.strokeStyle=n.borderTopColor,e.moveTo(t.x,t.y+.5),e.lineTo(t.x+t.width,t.y+.5),e.stroke(),e.restore()},_paintNewSheetTab:function(e,t,n,r){var o=this,i=o._workbook.options.newTabVisible,a=o._itemWidth,s=o._getSecondMoreTabWidth();n+=s,o._newTabSize=i?a:0;var l=t.x+t.width-o._resizeBarWidth-o._getNewTabSize();if(n>l){n=l;var u=l-s;u<r&&(u=r,n=u+a),o._drawMoreTab(e,u,0,s,t.height)}i&&o._drawNewSheetTab(e,n,0,a,t.height,-2===o._hoverTab)},_paintTabBeforeFirstTab:function(e,t,n,r){var o=this._getFirstMoreTabWidth();this._drawMoreTab(e,r-o,0,o,t.height)},_paintNavigationButtons:function(e,t,n){var r=this,o=5,i=r._getNavigationButtonWidth(),a=r._getNavigationButtonHeight(),s=r._resizeBarWidth/2+i/2,l=a/2,u=r._hoverNavButton;r._drawNavButton(e,s,l,s+o,l+o,s+o,l-o,!0,p,1===u),s+=i,r._drawNavButton(e,s,l,s-o,l+o,s-o,l-o,!1,p,2===u)},_paintResizeBar:function(e,t){var n,r,o=this,i=o._resizeBarWidth,a=d._getVisualStateThemeStyle(0,"gc-tabStripResizeBarInner");o._workbook.options.showHorizontalScrollbar&&(e.beginPath(),e.rect(t.x+t.width-i,0,i,t.height),e.clip(),o._paintBackground(e,o._getBounds()),n=t.x+t.width-i/2,r=t.y+t.height/2,e.fillStyle=a.color,e.fillRect(n,r,2,2),e.fillRect(n,r-4,2,2),e.fillRect(n,r+4,2,2))},_drawTab:function(e,t,n,r,o,i,a,l,c,f){var p=this,h=0;l&&(h=4),a&&(h=3);var m=d._getVisualStateThemeStyle(h,"gc-tab-"+d._getString(h)),g=d._getVisualStateThemeStyle(0,"gc-tab-"+d._getString(0));e.save();var _=4,v=3;a&&(e.fillStyle="white",e.fillRect(t,n,r,o-_));var y=p._getTabBackColor(e,a,c,m);e.fillStyle=y,e.fillRect(t+v,n+v,r-2*v+1,o-2*v),e.beginPath(),e.lineWidth=1,e.strokeStyle=g&&g.borderLeftColor,a?(e.moveTo(t+.5,n),e.lineTo(t+.5,n+o-_),e.moveTo(t+r+.5,n),e.lineTo(t+r+.5,n+o-_)):(e.moveTo(t+.5,n+_),e.lineTo(t+.5,n+o-_),e.moveTo(t+r+.5,n+_),e.lineTo(t+r+.5,n+o-_)),e.stroke(),a&&(e.beginPath(),e.strokeStyle=m&&m.borderBottomColor,e.lineWidth=2,e.moveTo(t,n+o-_),e.lineTo(t+r+1,n+o-_),e.stroke()),e.textBaseline="top";var b;"string"==typeof y&&(b=y),e.fillStyle=p._getTabForeColor(m,b),e.font=s._setStringFont('13px "'+u.FONT_FAMILY+'"');var w=p._tabLeftPadding;f&&(e.drawImage(p._workbook.options.lockImage,t+p._tabLeftPadding-2,n+6,9,12),w+=12),e.textBaseline="middle",e.fillText(c,t+w,n+o/2-1),e.restore()},_drawNavButton:function(e,t,n,r,o,i,a,s,l,u){e.save();var c=this,f=1;u&&(f=4),s?(t-=2,r-=2,i-=2,-1===c._getPreVisibleIndex(c._firstTab)&&(f=0)):(t+=2,r+=2,i+=2,-1===c._reCalculateFirstTabIndex(c._getVisibleTabs())&&(f=0));var p=d._getVisualStateThemeStyle(f,"gc-navButton-"+d._getString(f));e.strokeStyle=this._getVisibleForeColor(p.borderTopColor),e.beginPath();var h=1;t>r&&(h=-1),e.moveTo(t-.5,n),e.lineTo(t-.5,n+1),e.moveTo(t+h-.5,n-1),e.lineTo(t+h-.5,n+2),e.moveTo(t+2*h-.5,n-2),e.lineTo(t+2*h-.5,n+3),e.moveTo(t+3*h-.5,n-3),e.lineTo(t+3*h-.5,n+4),e.stroke(),e.restore()},_drawNewSheetTab:function(e,t,n,r,o,i){e.save(),e.beginPath();var a=(o-14)/2,s=1;i&&(s=4);var l=d._getVisualStateThemeStyle(s,"gc-tabStripNewTab-"+d._getString(s));e.lineWidth=1.5,e.strokeStyle=this._getVisibleForeColor(l.borderTopColor),e.arc(t+r/2,n+o/2,a,0,2*Math.PI),e.stroke(),e.beginPath(),e.lineWidth=2,e.moveTo(t+r/2-4,n+o/2),e.lineTo(t+r/2+4,n+o/2),e.moveTo(t+r/2,n+o/2-4),e.lineTo(t+r/2,n+o/2+4),e.stroke(),e.restore()},_drawMoreTab:function(e,t,n,r,o){e.save(),e.beginPath();var i=1,a=this._hoverNavButton;5!==a&&6!==a||(i=4);var s=d._getVisualStateThemeStyle(i,"gc-navMoreButton-"+d._getString(i));e.fillStyle=this._getVisibleForeColor(s.borderTopColor),e.fillRect(t+r/2,n+o/2,2,2),e.fillRect(t+r/2-4,n+o/2,2,2),e.fillRect(t+r/2+4,n+o/2,2,2),e.restore()},_getVisibleForeColor:function(e){var t=f(e),n=this._backgroundColor;return t.a<=.01?c(n):o._isTwoColorSimilar(n,t)?c(t):e}}),t._SheetTab=r,e.exports=t},function(e,t,n){function r(){return i._getResource(t.SR)()}function o(e){l.call(this,e);var t=this;t._tabLeftPadding=12,t._tabRightPadding=8,t._tabSpace=3,t._resizeBarWidth=12,t._newTabSize=48,t._firstTabSpace=5,t._font="10pt Arial"}var t=n(2),i=n(0),a=n(3),s=n(4).GC$,l=n(32)._SheetTabBase,u=a._ThemeStyleHelper,c=a._util._getLinearGradientColors,f=null,d=Math.min,p="#92A5C7",h="tab",m="newTab";s.inherit(o,l),s.extend(o.prototype,{_getNavigationButtonWidth:function(){var e=this._workbook,t=e&&e.options;return t&&t.tabNavigationVisible?e._getScrollbarSize()*(t.useTouchLayout?2:1):0},_getNavigationButtonHeight:function(){var e=this._workbook;return e&&e.options.tabNavigationVisible?e._getScrollbarSize():0},_getTabStartPosition:function(){return 4*this._getNavigationButtonWidth()+this._getTabMarginLeft()},_getTabMarginLeft:function(){var e=this,t=e._workbook;return t&&t.options.tabNavigationVisible?2:0},hitTest:function(e,t){var n=this,r=n._workbook,o=r.options,i=n._getBounds();if(i.x+i.width-n._resizeBarWidth<e&&e<i.x+i.width&&o.showHorizontalScrollbar)return{element:"resizeBar"};var a,s,l,u=-1,c=0,f=n._getNavigationButtonWidth();for(s=0,l=4,a=s;a<l;a++){if(c<e&&e<c+f){u=a;break}c+=f}if(-1!==u)return{element:"navButton",index:a};c=n._getTabStartPosition();var d=n._getPreVisibleIndex(n._firstTab),p=n._tabSpace,g=n._firstTabSpace;if(-1!==d){if(c<e&&e<c+g+p)return{element:h,index:d,position:c};c+=g}var _=0,v=r.sheets,y=n._tabSizes;if(n._firstTab>-1)for(a=n._firstTab;a<v.length&&a<y.length;a++)if(v[a].visible()){if(_=y[a],c<e&&e<c+_+p)return{element:h,index:a,position:c};c+=_+p}return o.newTabVisible&&e>c&&e<c+n._getNewTabSize()?{element:m,position:c}:{element:""}},_isCoverSheetTab:function(){var e=this;return e._activePos+e._tabSizes[e._activeIndex]+e._getNewTabSize()>e._getCoverPosition()},_getCoverPosition:function(){return this._getBounds().width-this._resizeBarWidth},_getInputTopPosition:function(){return 1},_getTabIndicatorEdgeElement:function(){return m},_getBasicWidth:function(){var e=this,t=e._getBounds().height,n=e._getTabStartPosition()+t;return e._workbook.options.newTabVisible&&(n+=e._getNewTabSize(),n+=e._tabSpace),n},_paintBackground:function(e,t){e.save(),e.beginPath();var n=e.createLinearGradient(t.x,t.y,t.width,t.height),r=u._getVisualStateThemeStyle(0,"gc-tabStripBackground"),o=r&&r.backgroundImage,i=r&&r.backgroundColor;if(o&&-1!==o.indexOf("linear-gradient"))for(var a=c(o),s=0,l=a.length;s<l;s++){var f=a[s];n.addColorStop(f.point,f.color)}else i&&(n.addColorStop(0,"#DDDDDD"),n.addColorStop(1,i));e.fillStyle=n,e.fillRect(t.x,t.y,t.width,t.height),e.restore()},_paintNewSheetTab:function(e,t,n,o){var i=this,a=i._workbook,s=r().NewTab;a.options.newTabVisible&&(i._newTabSize=e.measureText(s).width+i._tabLeftPadding,i._drawTab(e,n,0,i._getNewTabSize(),t.height,5,!1,-2===i._hoverTab,s))},_paintTabBeforeFirstTab:function(e,t,n,r){var o=this,i=n-1,a=o._tabSizes[i];o._drawTab(e,r+o._firstTabSpace-a-o._tabSpace,0,a,t.height,5,o._activeIndex===i,o._hoverTab===i,"")},_paintNavigationButtons:function(e,t,n){var r=this;e.fillStyle=p,e.fillRect(t.x,t.y,n-1,t.height);var o=5,i=r._getNavigationButtonWidth(),a=r._getNavigationButtonHeight(),s=i/2,l=a/2,u=r._hoverNavButton;r._drawNavButton(e,s,l,s+o,l+o,s+o,l-o,!0,s-o,0===u),s+=i,r._drawNavButton(e,s,l,s+o,l+o,s+o,l-o,!0,f,1===u),s+=i,r._drawNavButton(e,s,l,s-o,l+o,s-o,l-o,!1,f,2===u),s+=i,r._drawNavButton(e,s,l,s-o,l+o,s-o,l-o,!1,s+4,3===u)},_paintResizeBar:function(e,t){var n,r=this,o=r._workbook,i=r._resizeBarWidth,a=u._getVisualStateThemeStyle,s=a(4,"gc-tabStripResizeBarInner"),l=a(0,"gc-tabStripResizeBarOuter");o.options.showHorizontalScrollbar&&(n=t.x+t.width-i,e.fillStyle=l.backgroundColor,e.fillRect(n,t.y,i,t.height),e.fillStyle=s.backgroundColor,e.fillRect(n+1,t.y+1,i-2,t.height-2),e.fillStyle=s.color,e.fillRect(n+i/2-1,t.y+4,2,t.height-8))},_drawTab:function(e,t,n,r,o,i,a,s,l){e.save(),e.beginPath(),e.moveTo(t,n),e.lineTo(t,n+o-i),e.arcTo(t,n+o,t+r,n+o,i),e.lineTo(t+r,n+o),e.lineTo(t+r+o,n),a||e.lineTo(t,n);var c=this,f=0;(a||s)&&(f=4);var d=u._getVisualStateThemeStyle(f,"gc-tab-"+u._getString(f)),h=c._getTabBackColor(e,a||s,l,d);e.fillStyle=h,e.fill(),e.strokeStyle=p,e.stroke(),e.textBaseline="top";var m;"string"==typeof h&&(m=h),e.fillStyle=c._getTabForeColor(d,m);var g=c._tabLeftPadding;e.textBaseline="middle",e.fillText(l,t+g,n+o/2),e.restore()},_drawNavButton:function(e,t,n,r,o,i,a,s,l,p){e.save();var h=this,m=h._getBounds(),g=h._getNavigationButtonWidth(),_=u._getVisualStateThemeStyle,v=_(4,"gc-navButton-hover"),y=_(0,"gc-navButton-normal"),b=y&&y.backgroundColor;if(p)e.fillStyle=v.backgroundColor,e.fillRect(t-g/2+2,m.y+2,g-4,m.height-4);else{var w=y&&y.backgroundImage;if(w&&-1!==w.indexOf("linear-gradient")){for(var C=e.createLinearGradient(m.x+.7*m.height,m.y+0,.7*m.height,m.height),S=c(w),x=0,T=S.length;x<T;x++){var E=S[x];C.addColorStop(E.point,E.color)}e.fillStyle=C}else b&&(e.fillStyle=b);e.fillRect(t-g/2,m.y+1,g,m.height-2)}e.fillStyle=p?v.color:y.color,void 0!==l&&l!==f&&e.fillRect(l,d(o,a),1,Math.max(o,a)-d(o,a)),s?(t-=2,r-=2,i-=2):(t+=2,r+=2,i+=2),e.beginPath(),e.moveTo(t,n),e.lineTo(r,o),e.lineTo(i,a),e.lineTo(t,n),e.fill(),e.restore()}}),t._SheetTab2007=o,e.exports=t},function(e,t,n){function r(e,t,n,r,o,i){switch(i!==l&&i!==u||(i=1),i){case 1:return new g(e,t,n,r,o,1);case 2:return new g(e,t,n,r,o,2);case 5:return new g(e,t,n,r,o,3);case 3:return new _(e,t,n,r,o,1,[3,1]);case 9:return new _(e,t,n,r,o,1,[8,2,2,2]);case 4:return new _(e,t,n,r,o,1,[2,2]);case 11:return new _(e,t,n,r,o,1,[9,3,3,3,3,3]);case 13:return new v(e,t,n,r,o,e!==n,[11,1,5,1],[10,2,4,2]);case 10:return new _(e,t,n,r,o,2,[9,3,3,3]);case 12:return new _(e,t,n,r,o,2,[9,3,3,3,3,3]);case 8:return new _(e,t,n,r,o,2,[9,3]);case 7:return new _(e,t,n,r,o,1,[1]);case 6:return new y(e,t,n,r,o,e!==n)}return u}var t=n(2),o=n(9).LineBorder,i=n(4).GC$,a=n(0),s=a._ColorHelper,l=void 0,u=null,c=Math.sqrt,f=Math.pow,d=Math.min,p=i.inherit,h=i.isEmptyObject,m=function(){function e(){}return e.prototype={constructor:e,_adjust:function(e){var t=this;0===e._orientation?(e._offsetEnd&&(t._x2+=e._offsetEnd),e._offsetStart&&(t._x1+=e._offsetStart)):(e._offsetEnd&&(t._y2+=e._offsetEnd),e._offsetStart&&(t._y1+=e._offsetStart))},_paint:function(e){var t=this._color||"#9eb6ce",n=this._lineWidth,r=e.lineWidth,o=e.strokeStyle;e.beginPath(),r===n&&o===t||(r!==n&&(e.lineWidth=n),o!==t&&(e.strokeStyle=t)),this._paintLine(e),e.stroke()},_paintLine:function(e){var t=this;e.moveTo(t._x1,t._y1),e.lineTo(t._x2,t._y2)}},e}(),g=function(e){function t(t,n,r,o,i,a){e.call(this),a%2||(t!==r?(n-=.5,o-=.5):(t-=.5,r-=.5));var s=this;s._x1=t,s._y1=n,s._x2=r,s._y2=o,s._color=i,s._lineWidth=a}return p(t,e),t}(m),_=function(e){function t(t,n,r,o,i,a,s){e.call(this),a%2||(t!==r?(n-=.5,o-=.5):(t-=.5,r-=.5));var l=this;l._x1=t,l._y1=n,l._x2=r,l._y2=o,l._color=i,l._lineWidth=a,l._pattern=s}return p(t,e),t.prototype._paintLine=function(e){var n=this;t._render(e,n._x1,n._y1,n._x2,n._y2,n._pattern)},t._render=function(e,t,n,r,o,i){var a=c(f(r-t,2)+f(o-n,2)),s={x:(r-t)/a,y:(o-n)/a},l=0,u=0;for(i=i&&i.length?i:[4,4];l<a;){var p=d(i[u++%i.length],a-l),h=u%2;l+=p,h&&e.moveTo(t,n),t+=p*s.x,n+=p*s.y,h&&e.lineTo(t,n)}},t}(m),v=function(e){function t(t,n,r,o,i,a,s,l){e.call(this),a?(t-=1,r-=1):(n-=1,o-=1);var u=this;u._x1=t,u._y1=n,u._x2=r,u._y2=o,u._color=i,u._horizontal=a,u._lineWidth=1,u._pattern1=s,u._pattern2=l}return p(t,e),t.prototype._paintLine=function(e){var t=this,n=t._horizontal?0:1,r=t._horizontal?1:0;_._render(e,t._x1-n,t._y1-r,t._x2-n,t._y2-r,t._pattern1),_._render(e,t._x1,t._y1,t._x2,t._y2,t._pattern2)},t}(m),y=function(e){function t(t,n,r,o,i,a){e.call(this);var s=a?0:1,l=a?1:0,u=this;u._line1=new g(t-s,n-l,r-s,o-l,i,1),u._line2=new g(t+s,n+l,r+s,o+l,i,1),u._color=i,u._horizontal=a,u._lineWidth=1}return p(t,e),t.prototype._paintLine=function(e){this._line1._paintLine(e),this._line2._paintLine(e)},t.prototype._adjust=function(e){var t=this;e._lineSide?1===e._lineSide?t._line1._adjust(e):2===e._lineSide&&t._line2._adjust(e):(t._line1._adjust(e),t._line2._adjust(e))},t}(m),b=function(){function e(){}return e._compareLineStyle=function(t,n){if(!t)return n?-1:0;if(!n)return 1;var r=e._styleWeightCache,o=r[t.style]-r[n.style];return 0===o?n.level-t.level:o},e._getDrawingThickness=function(e){if(e){if(e.isGridLine)return 1;if(e.style)return o._width(e.style)}return 0},e._isDoubleLine=function(e){return e&&6===e.style},e._isSlantedLine=function(e){return e&&13===e.style},e._getMaxLine=function(t,n){return t?n?e._compareLineStyle(t.style,n.style)>=0?t:n:t:n},e._adjustLine=function(e,t){e&&e.line&&e.line._adjust(t)},e._compareLine=function(t,n){return t===n?0:t?n?t.isGridLine?n.isGridLine?0:-1:n.isGridLine?1:e._compareLineStyle(t.style,n.style):1:-1},e._isDoubleLineItem=function(e){return e&&e.style&&6===e.style.style},e._isAllowExtend=function(e,t,n,r){if(e.style&&6===e.style.style)return!0;var o=0;return o+=t&&t.style&&6===t.style.style?1:0,o+=n&&n.style&&6===n.style.style?1:0,(o+=r&&r.style&&6===r.style.style?1:0)<2},e._layout4CrossRoad=function(e,t,n,r,o,i){var a={_orientation:i?1:0,_offsetStart:0,_offsetEnd:0},s=this._compareLine(e,n),l=this._compareLine(e,r);s>=0&&l>=0?0===s&&0===l?-1!==o&&1===o&&(a._offsetEnd-=o):-1===o?a._offsetStart-=o:1===o&&(a._offsetEnd-=2*o):l>=0?(a._lineSide=2,a._offsetStart+=o):s>=0&&(a._lineSide=1,a._offsetStart+=o),this._adjustLine(e,a)},e._layout4TurnRoad=function(t,n,r,o,i,a,s,l,u){var c={_orientation:l?1:0,_lineSide:u?2:1,_offsetStart:0,_offsetEnd:0},f={_orientation:l?1:0,_lineSide:u?1:2,_offsetStart:0,_offsetEnd:0},d=1===a?o:i,p=1===s?r:n;if(this._isDoubleLineItem(p)){var h=this._compareLine(t,d);if(0===h){var m=this._compareLine(t,p);0===m?1===s&&(f._offsetEnd-=s):m>0&&(-1===s?f._offsetStart-=2*s:1===s&&(f._offsetEnd-=2*s))}else if(h>0){var g=this._compareLine(t,p);0===g?1===s&&(f._offsetEnd-=s):g>0&&(-1===s?f._offsetStart-=2*s:1===s&&(f._offsetEnd-=2*s))}else{var _=this._compareLine(t,p);0===_?-1===s?c._offsetStart+=2*s:1===s&&(c._offsetEnd+=2*s):_>0&&(-1===s?c._offsetStart-=3*s:1===s&&(c._offsetEnd-=3*s))}}else this._compareLine(t,d)>=0?-1===s?f._offsetStart-=2*s:1===s&&(f._offsetEnd-=2*s):-1===s?c._offsetStart+=2*s:1===s&&(c._offsetEnd+=2*s);var v=1===a?2:1,y=1===v?o:i,b=!1,w=0;if(!b&&this._isDoubleLineItem(y)&&this._compareLine(y,t)>0){b=!0;var C=e._getDrawingThickness(y);this._compareLine(y,d)>0?C>0&&(w=1===s&&this._isDoubleLineItem(r)?C>=2?2:1:-1===s&&this._isDoubleLineItem(n)?C>=3?2:1:3===C?3:2):w=3===C?3:2}b||this._isDoubleLineItem(p)||!(p&&!p.isGridLine||y&&!y.isGridLine)||(b=!0,w=-1===s?2:1),b&&(-1===s?(c._offsetStart+=s*w,f._offsetStart+=s*w):1===s&&(c._offsetEnd+=s*w,f._offsetEnd+=s*w)),(c._offsetStart||c._offsetEnd)&&this._adjustLine(t,c),(f._offsetStart||f._offsetEnd)&&this._adjustLine(t,f)},e._layout4TRoad=function(e,t,n,r,o,i){if(this._compareLine(e,n)>=0&&this._compareLine(e,r)>=0){var a={_orientation:i?1:0,_offsetStart:0,_offsetEnd:0};-1===o?(a._offsetStart-=2*o,this._isDoubleLineItem(e)&&this._compareLine(t,e)>0&&(a._offsetStart-=1)):1===o&&(a._offsetEnd-=2*o,this._isDoubleLineItem(e)&&this._compareLine(t,e)>0&&(a._offsetEnd+=1)),this._adjustLine(e,a)}},e._layout4Connected=function(t,n,r,o,i,a){if(this._isDoubleLineItem(t)){var s=this._getMaxLine(r,o);if(s&&!s.isGridLine){var l=e._getDrawingThickness(s);if(l>0){var u={_orientation:a?1:0,_offsetStart:0,_offsetEnd:0};-1===i?u._offsetStart+=l*i:u._offsetEnd+=l*i,(u._offsetStart||u._offsetEnd)&&this._adjustLine(t,u)}}}},e._calcLayoutHorizontal=function(t,n,r,o,i,a,s){var l,u,c=e;if(n||r||o){var f=c._getMaxLine(r,o);c._isAllowExtend(t,n,r,o)?(u=c._compareLine(f,t))>0?(l=c._getDrawingThickness(f),c._isDoubleLineItem(t)&&(c._isDoubleLineItem(r)||c._isDoubleLineItem(o)||c._isDoubleLineItem(n))||3===l&&c._adjustLine(t,{_orientation:0,_offsetStart:1})):f&&u<0?(u=c._compareLine(t,n))>0?(l=c._getDrawingThickness(f),3===l||2===l?c._adjustLine(t,{_orientation:0,_offsetStart:-2}):1===l&&c._adjustLine(t,{_orientation:0,_offsetStart:-1})):0!==u&&c._compareLine(n,f)>0&&3===(l=c._getDrawingThickness(f))&&c._adjustLine(t,{_orientation:0,_offsetStart:1}):0===u&&(!n||c._compareLine(t,n)>0)&&(l=c._getDrawingThickness(f),3===l||2===l?c._adjustLine(t,{_orientation:0,_offsetStart:-2}):1===l&&c._adjustLine(t,{_orientation:0,_offsetStart:-1})):c._adjustLine(t,{_orientation:0,_offsetStart:1})}if(i||a||s){var d=c._getMaxLine(a,s);c._isAllowExtend(t,i,a,s)?(u=c._compareLine(d,t))>0?(l=c._getDrawingThickness(d),c._isDoubleLineItem(t)&&(c._isDoubleLineItem(a)||c._isDoubleLineItem(s)||c._isDoubleLineItem(i))||(3===l?c._adjustLine(t,{_orientation:0,_offsetEnd:-2}):2!==l&&1!==l||c._adjustLine(t,{_orientation:0,_offsetEnd:-1}))):u<0?(u=c._compareLine(t,i))>0?3===(l=c._getDrawingThickness(d))&&c._adjustLine(t,{_orientation:0,_offsetEnd:1}):0!==u&&c._adjustLine(t,{_orientation:0,_offsetEnd:-1}):0===u&&((u=c._compareLine(t,i))>0?3===(l=c._getDrawingThickness(d))&&c._adjustLine(t,{_orientation:0,_offsetEnd:1}):0!==u&&c._adjustLine(t,{_orientation:0,_offsetEnd:-1})):c._adjustLine(t,{_orientation:0,_offsetEnd:-2})}},e._calcLayoutVertical=function(t,n,r,o,i,a,s){var l,c,f=e;if(n||r||o){var d=f._getMaxLine(r,o);f._isAllowExtend(t,n,r,o)?(c=f._compareLine(d,t))>0?(l=f._getDrawingThickness(d),f._isDoubleLineItem(t)&&(f._isDoubleLineItem(r)||f._isDoubleLineItem(o)||f._isDoubleLineItem(n))||3===l&&f._adjustLine(t,{_orientation:1,_offsetStart:1})):c<0?(c=f._compareLine(t,n))>0?(l=f._getDrawingThickness(d),3===l||2===l?f._adjustLine(t,{_orientation:1,_offsetStart:-2}):1===l&&f._adjustLine(t,{_orientation:1,_offsetStart:-1})):0!==c&&f._compareLine(n,d)>0&&3===(l=f._getDrawingThickness(d))&&f._adjustLine(t,{_orientation:1,_offsetStart:1}):0===c&&f._compareLine(t,n)>0&&(l=f._getDrawingThickness(d),3===l||2===l?f._adjustLine(t,{_orientation:1,_offsetStart:-2}):1===l&&f._adjustLine(t,{_orientation:1,_offsetStart:-1})):f._adjustLine(t,{_orientation:1,_offsetStart:1})}if(i||a||s){var p=f._getMaxLine(a,s);f._isAllowExtend(t,i,a,s)?(c=f._compareLine(t,p))<0?(l=f._getDrawingThickness(p),f._isDoubleLineItem(t)&&(f._isDoubleLineItem(a)||f._isDoubleLineItem(s)||f._isDoubleLineItem(i))||(3===l||2===l?f._adjustLine(t,{_orientation:1,_offsetEnd:-2}):1===l&&f._adjustLine(t,{_orientation:1,_offsetEnd:-1}))):p!==u&&c>0?(c=f._compareLine(t,i))>0?3===(l=f._getDrawingThickness(p))&&f._adjustLine(t,{_orientation:1,_offsetEnd:1}):0!==c&&f._adjustLine(t,{_orientation:1,_offsetEnd:-1}):0===c&&((c=f._compareLine(t,i))>0?3===(l=f._getDrawingThickness(p))&&f._adjustLine(t,{_orientation:1,_offsetEnd:1}):0!==c&&f._adjustLine(t,{_orientation:1,_offsetEnd:-1})):f._adjustLine(t,{_orientation:1,_offsetEnd:-2})}},e._calcDoubleLayout=function(t,n,r,o,i,a,s,l){var u=e;l?this._calcLayoutVertical(t,n,r,o,i,a,s):this._calcLayoutHorizontal(t,n,r,o,i,a,s);var c=u._isDoubleLineItem(r),f=u._isDoubleLineItem(o),d=u._isDoubleLineItem(n);c&&f&&d?u._layout4CrossRoad(t,n,r,o,-1,l):c&&!f?u._layout4TurnRoad(t,n,i,r,o,1,-1,l,!0):!c&&f?u._layout4TurnRoad(t,n,i,r,o,2,-1,l,!1):c&&f&&!d?u._layout4TRoad(t,n,r,o,-1,l):d&&u._layout4Connected(t,n,r,o,-1,l),c=u._isDoubleLineItem(a),f=u._isDoubleLineItem(s);var p=u._isDoubleLineItem(i);c&&f&&p?u._layout4CrossRoad(t,i,a,s,1,l):c&&!f?u._layout4TurnRoad(t,n,i,a,s,1,1,l,!0):!c&&f?u._layout4TurnRoad(t,n,i,a,s,2,1,l,!1):c&&f&&!p?u._layout4TRoad(t,i,a,s,1,l):p&&u._layout4Connected(t,i,a,s,1,l)},e._styleWeightCache=[0,101,199,100,100,300,90,100,198,100,198,100,198,198],e}(),w=function(){function e(e,t,n,r){var o=this;o._isInitialized=!1,o._isMerged=!1,o._sheet=e,o._sheetArea=r,o._rowViewportIndex=t,o._colViewportIndex=n}return e.prototype={constructor:e,_initialize:function(){var e=this;e._spanCells=[],e._rowIndecies=[],e._colIndecies=[],e._overflowedCells=[],e._adjustingRanges=[],e._hGridLine={},e._vGridLine={},e._hBorders={},e._vBorders={};var t=e._sheet,n=e._sheetArea,r=e._colViewportIndex,o=e._rowViewportIndex,i=t._getRowLayout(o,n),a=t._getColumnLayout(r,n);if(i&&i.length>0&&a&&a.length>0){for(var s,l=e._rowIndecies,u=i.length,c=0;c<u;c++)s=i[c],s.height>0&&l.push(s.row);l.push(l[l.length-1]+1);for(var f,d=e._colIndecies,p=a.length,h=0;h<p;h++)f=a[h],f.width>0&&d.push(f.col);d.push(d[d.length-1]+1)}e._isInitialized=!0},_addCellOverlfowLayout:function(e,t){if(t){var n={_row:e,_startCol:t.startColumn,_endCol:t.endColumn};this._overflowedCells.push(n)}},_addCellLines:function(e,t,n,r,o,i,a,s){var l=this;if(l._isInitialized||l._initialize(),s)l._spanCells.push(s);else{var u,c,f,d,p;a&&(u=a.borderLeft,c=a.borderTop,f=a.borderRight,d=a.borderBottom,p=a.backColor),!p||u||f||c||d||l._adjustingRanges.push({r:e,c:t,rc:1,cc:1}),l._addCellLineImp(e,t,n,r,o,i,u,c,f,d,p)}},_addCellLineImp:function(e,t,n,r,o,i,a,s,l,u,c,f,d){var p=this,h=!1,m=!1,g=!1,_=!1;s&&(h=p._addCellLineSide(e,t,n,r-.5,n+o,r-.5,s,p._hBorders)),a&&(m=p._addCellLineSide(e,t,n-.5,r,n-.5,r+i,a,p._vBorders)),u&&(g=p._addCellLineSide(e+1,t,n,r+i-.5,n+o,r+i-.5,u,p._hBorders)),l&&(_=p._addCellLineSide(e,t+1,n+o-.5,r,n+o-.5,r+i,l,p._vBorders));var v=(p._sheet,!g&&!f),y=!_&&!d;(v||y)&&p._addGridLine(e,t,n,r,o,i,v,y,c),h&&p._removeLineItem(e-1,t,p._hGridLine),m&&p._removeLineItem(e,t-1,p._vGridLine)},_addCellLineSide:function(e,t,n,o,i,a,s,l){if(s){var c=this._queryLineItem(e,t,l,!0);return c?6!==c.style.style&&(6===s.style||b._compareLineStyle(s,c.style)>0)&&(c.line=r(n,o,i,a,s.color,s.style),c.style=s):(c=this._queryLineItem(e,t,l),c.line=r(n,o,i,a,s.color,s.style),c.style=s),c.line!==u}return!1},_addGridLine:function(e,t,n,o,i,a,s,l,u){var c=this,f=3===c._sheetArea,d=c._sheet.options.gridline;if(f&&d){var p=this._getGridLineColor(d.color,u);if(s&&(d.showHorizontalGridline||!f)){var h=c._queryLineItem(e,t,c._hGridLine);h.isGridLine=!0,h.line=r(n,o+a-.5,n+i,o+a-.5,p)}if(l&&(d.showVerticalGridline||!f)){var m=c._queryLineItem(e,t,c._vGridLine);m.isGridLine=!0,m.line=r(n+i-.5,o,n+i-.5,o+a,p)}}},_getGridLineColor:function(e,t){if(t){var n=s._fromString(t),r={a:255};["r","g","b"].forEach(function(e){r[e]=Math.floor(n[e]*(n.a/255)*.85)}),e=s._toString(r)}return e},_adjustLineItem:function(e,t,n,r){var o=this._queryLineItem(e,t,n,!0);if(o){var i=o;i&&i.line&&i.line._adjust({_orientation:r?0:1,_offsetEnd:-1})}},_removeLineItem:function(e,t,n){if(e>=0&&t>=0){var r=n[e];if(r){r[t]&&delete r[t]}}},_queryLineItem:function(e,t,n,r){if(-1===e||-1===t)return u;var o=n[e];if(!o){if(r)return u;n[e]=o={}}var i=o[t];if(!i){if(r)return u;o[t]=i={}}return i},_processOverflowCells:function(){for(var e=this,t=e._overflowedCells,n=t.length,r=e._vBorders,o=e._vGridLine,i=0;i<n;i++)for(var a,s=t[i],l=s._row,u=s._startCol,c=s._endCol,f=u;f<c;f++)a=e._queryLineItem(l,f+1,r,!0),a?e._removeLineItem(l,f+1,r):(a=e._queryLineItem(l,f,o,!0))&&e._removeLineItem(l,f,o)},_processSpans:function(){var e,t=this._spanCells,n=t.length;if(n>0)for(var r=0;r<n;r++)e=t[r],this._processSpanCell(e)},_processSpanCell:function(e){var t,n,r,o,i,a,s,l,c,f,d,p,h,m,g=this,_=e.row,v=e.col,y=e.x,b=e.y,w=g._sheet.getActualStyle(_,v,g._sheetArea),C=w?w.backColor:u,S=y,x=b;if(1===e.rowCount)for(a=_,l=g._sheet._getZoomRowHeight(a,g._sheetArea),i=0;i<e.colCount;i++)f=0===i,p=i===e.colCount-1,s=v+i,c=g._sheet._getZoomColumnWidth(s,g._sheetArea),m=g._sheet.getActualStyle(a,s,g._sheetArea),m?(t=m.borderLeft,n=m.borderTop,r=m.borderRight,o=m.borderBottom):t=n=r=o=u,f?g._addCellLineImp(a,s,S,x,c,l,t,n,u,o,C,!1,!0):p?g._addCellLineImp(a,s,S,x,c,l,u,n,r,o,C):g._addCellLineImp(a,s,S,x,c,l,u,n,u,o,C,!1,!0),S+=c;else if(1===e.colCount)for(s=v,c=g._sheet._getZoomColumnWidth(s,g._sheetArea),i=0;i<e.rowCount;i++)d=0===i,h=i===e.rowCount-1,a=_+i,l=g._sheet._getZoomRowHeight(a,g._sheetArea),m=g._sheet.getActualStyle(a,s,g._sheetArea),m?(t=m.borderLeft,n=m.borderTop,r=m.borderRight,o=m.borderBottom):t=n=r=o=u,d?g._addCellLineImp(a,s,S,x,c,l,t,n,r,u,C,!0,!1):h?g._addCellLineImp(a,s,S,x,c,l,t,u,r,o,C):g._addCellLineImp(a,s,S,x,c,l,t,u,r,u,C,!0,!1),x+=l;else for(i=0;i<e.rowCount;i++){a=_+i,d=0===i,h=i===e.rowCount-1,l=g._sheet._getZoomRowHeight(a,g._sheetArea);for(var T=0;T<e.colCount;T++)s=v+T,f=0===T,p=T===e.colCount-1,c=g._sheet._getZoomColumnWidth(s,g._sheetArea),m=g._sheet.getActualStyle(a,s,g._sheetArea),m?(t=m.borderLeft,n=m.borderTop,r=m.borderRight,o=m.borderBottom):t=n=r=o=u,d?f?g._addCellLineImp(a,s,S,x,c,l,t,n,u,u,C,!0,!0):p?g._addCellLineImp(a,s,S,x,c,l,u,n,r,u,C,!0,!1):g._addCellLineImp(a,s,S,x,c,l,u,n,u,u,C,!0,!0):h?f?g._addCellLineImp(a,s,S,x,c,l,t,u,u,o,C,!1,!0):p?g._addCellLineImp(a,s,S,x,c,l,u,u,r,o,C):g._addCellLineImp(a,s,S,x,c,l,u,u,u,o,C,!1,!0):f?g._addCellLineImp(a,s,S,x,c,l,t,u,u,u,C,!0,!0):p&&g._addCellLineImp(a,s,S,x,c,l,u,u,r,u,C,!0,!1),S+=c;S=y,x+=l}!C||t||r||n||o||g._adjustingRanges.push({r:_,c:v,rc:e.rowCount,cc:e.colCount})},_adjust:function(){var e=this,t=!1,n=!1;h(e._vBorders)||(t=!0),h(e._hBorders)||(n=!0),(t||n)&&e._adjustBorders(),e._adjustingRanges.length>0&&e._adjustGridlines()},_adjustGridlines:function(){for(var e=this,t=e._adjustingRanges,n=t.length,r=0;r<n;r++){var o=t[r],i=o.r,a=o.c,s=i,l=i-1,u=a-1,c=a;o.rc>1&&(s+=o.rc-1),o.cc>1&&(c+=o.cc-1);for(var f=!1,d=!1,p=0;p<n;p++){var h=t[p];if(h.c===c+1&&h.r===i&&(d=!0),h.r===s+1&&h.c===a&&(f=!0),f&&d)break;if(h.r>i+1&&h.c>a+1)break}f||e._adjustLineItem(s,u,e._hGridLine,!0),d||e._adjustLineItem(l,c,e._vGridLine,!1)}},_adjustBorders:function(){var e,t,n,r,o,i,a,s,l,c,f,d,p,h,m,g,_=this,v=_._rowIndecies,y=_._colIndecies,w=v.length,C=y.length,S={},x={};for(e=0;e<w;e++)for(n=v[e],t=0;t<C;t++){r=y[t],m=0,g=0;var T=_._queryLineItem(n,r,_._vBorders,!0);T?m++:T=_._queryLineItem(n,r-1,_._vGridLine,!0);var E=_._queryLineItem(n,r,_._hBorders,!0);E?g++:E=_._queryLineItem(n-1,r,_._hGridLine,!0),(T||E)&&(o=0===e?u:_._getLineItem(v[e-1],r,!0,x),o&&o.line&&!o.isGridLine&&(m++,g++),i=0===t?u:_._getLineItem(n,y[t-1],!1,S),i&&i.line&&!i.isGridLine&&(m++,g++),T&&(a=_._getLineItem(n,r,!1,S),a&&a.line&&!a.isGridLine&&m++,e!==w-1&&(l=_._getLineItem(v[e+1],r,!0,x))&&l.line&&!l.isGridLine&&m++,0!==t&&e!==w-1&&(c=_._getLineItem(v[e+1],y[t-1],!1,S))&&c.line&&!c.isGridLine&&m++,e!==w-1&&(f=_._getLineItem(v[e+1],r,!1,S))&&f.line&&!f.isGridLine&&m++,m>0&&(b._isDoubleLine(T.style)?b._calcDoubleLayout(T,o,i,a,l,c,f,!0):b._isSlantedLine(T.style)||b._calcLayoutVertical(T,o,i,a,l,c,f))),E&&(s=_._getLineItem(n,r,!0,x),s&&s.line&&!s.isGridLine&&g++,t!==C-1&&(d=_._getLineItem(n,y[t+1],!1,S))&&d.line&&!d.isGridLine&&g++,0!==e&&t!==C-1&&(p=_._getLineItem(v[e-1],y[t+1],!0,x))&&p.line&&!p.isGridLine&&g++,t!==C-1&&(h=_._getLineItem(n,y[t+1],!0,x))&&h.line&&!h.isGridLine&&g++,g>0&&(b._isDoubleLine(E.style)?b._calcDoubleLayout(E,i,o,s,d,p,h,!1):b._isSlantedLine(E.style)||b._calcLayoutHorizontal(E,i,o,s,d,p,h))))}},_getLineItem:function(e,t,n,r){var o=r[e];o||(o=r[e]={});var i=o[t];return i===l&&(i=o[t]=this._getLineItemImp(e,t,n)),i},_getLineItemImp:function(e,t,n){if(e===l||e<0||t===l||t<0)return u;var r=this,o=n?r._vBorders:r._hBorders,i=r._queryLineItem(e,t,o,!0);if(i)return i;if(o=n?r._vGridLine:r._hGridLine,n){if(--t<0)return u}else if(--e<0)return u;return(i=r._queryLineItem(e,t,o,!0))||u},paint:function(e,t){var n=this;n._isInitialized&&(n._isMerged||(n._processSpans(),n._processOverflowCells(),n._adjust(),n._isMerged=!0),e.save(),e.beginPath(),n._paint(e,t),e.closePath(),e.stroke(),e.restore())},_paint:function(e){this._paintGridLine(e),this._paintBorderLines(e)},_paintGridLine:function(e){var t=this;t._paintLines(e,t._hGridLine),t._paintLines(e,t._vGridLine)},_paintBorderLines:function(e){var t=this;t._paintLines(e,t._hBorders),t._paintLines(e,t._vBorders)},_paintLines:function(e,t){var n,r,o,i;for(n in t)if(t[n]){o=t[n];for(r in o)o[r]&&(i=o[r].line)&&i._paint(e)}}},e}();t._createLine=r,t._Borders=w,e.exports=t},function(e,t,n){function r(e,t,n){for(var r=e[n-t];r.index<n;)r=e[r.index-t];return r.index}function o(e,t){return e instanceof Date&&t instanceof Date?_(e)===_(t):typeof e===b&&typeof t===b?e.toLowerCase()===t.toLowerCase():e===t}function i(e,t){e instanceof Date&&(e=_(e)),t instanceof Date&&(t=_(t));var n=typeof e,r=typeof t,o=n===b,i=r===b,a=r===w;return n===r||n!==w&&!a?!(n!==y||!i)||(!o||r!==y)&&(o&&i?e.toLowerCase()>t.toLowerCase():e>t):a}function a(e,t){var n=0,r=e.sortInfo,a=e.byRows,s=e.index,l=t.index;if(r)for(var u=0;u<r.length;u++){if(r[u]){var c=r[u].ascending,f=r[u].index;if(0<=f){var d=e.sheet.getValue(a?s:f,a?f:s),p=t.sheet.getValue(a?l:f,a?f:l),h=v(d)||""===d||typeof d===w&&isNaN(d),m=v(p)||""===p||typeof p===w&&isNaN(p);h||m?h&&m?n=0:h&&!m?n=1:!h&&m&&(n=-1):n=o(d,p)?0:i(d,p)?c?1:-1:c?-1:1}}if(0!==n)break}return n}function s(e){var t=e.length;if(t<=1)return e;for(var n=Math.floor(t/2),r=e[n],o=[],i=[],l=[],u=0;u<t;u++){var c=a(e[u],r);c<0?o.push(e[u]):c>0?i.push(e[u]):l.push(e[u])}return s(o).concat(l,s(i))}function l(e,t,n,r,o,i,a){var l,u,c=i?r:o,f=i?t:n,d=[];for(l=0;l<c;l++)d[l]={sheet:e,index:f+l,byRows:i,sortInfo:a};if(i){var p=[];for(u=d.length-1;u>=0;u--){var h=d[u];e._isRowFilterOut&&e._isRowFilterOut(h.index)&&(d.splice(u,1),p.push({_index:u,_value:h}))}}if(d=s(d),i)for(u=p.length-1;u>=0;u--){var m=p[u];d.splice(m._index,0,m._value)}return d}function u(e,t,n){var r=e._getCellCalc(t,n,!1);r&&r.hasListeners()&&r._addListenersToAdjust()}function c(e,t,r){var o=n(5),i=o.CalcOperatorAdjustor,a=i._copyExpression(e._getExpr(t,r),t,r,0,0);e._setExpr(t,r,a);var s=e._getCellCalc(t,r,!!a);s&&s._startListening()}function f(e,t){var n=e.length;if(n<=1)return e;for(var r=Math.floor(n/2),o=e[r],i=[],a=[],s=[],l=0;l<n;l++){var u=d(e[l],o,t);u<0?i.push(e[l]):u>0?a.push(e[l]):s.push(e[l])}return f(i,t).concat(s,f(a,t))}function d(e,t,n){var r=0,a=e.value,s=t.value,l=v(a)||""===a||typeof a===w&&isNaN(a),u=v(s)||""===s||typeof s===w&&isNaN(s);return l||u?l&&u?r=0:l&&!u?r=1:!l&&u&&(r=-1):r=o(a,s)?0:i(a,s)?n?1:-1:n?-1:1,r}var t=n(2),p=n(0),h=n(4).GC$,m=n(3),g=n(6).Worksheet,_=p._DateTimeHelper._toOADate,v=p._Types._isNullOrUndefined,y="boolean",b="string",w="number";h.extend(g.prototype,{sortRange:function(e,n,o,i,a,s){var f=this,d=f.getRowCount(),p=f.getColumnCount();if(!t._supportsCalc||f._checkArrayFormula(e,0,o,p,!1)){var h=f.getSpans(new m.Range(e,n,o,i));if(h&&h.length>0)return f._raiseInvalidOperation(10,""),!1;var g,_,v=f.tables;if(v&&(g=v._findByRange(e,n,o,i),_=1===g.length&&g[0].dataRange().equals(m._createRange(e,n,o,i)),!(g.length<=0||_)))return!1;var y=f._bindingManager,b=y&&y._dataSource||_&&g[0]&&g[0]._getDataSource();if(-1===e&&(e=0),-1===o&&(o=d),-1===n&&(n=0),-1===i&&(i=p),e<0||e>=d||n<0||n>=p||o<0||e+o>d||i<0||n+i>p||!s)return!1;f.suspendPaint(),f.suspendEvent(),t._supportsCalc&&f.suspendCalcService();try{var w=[],C=l(f,e,n,o,i,a,s);if(C){var S,x,T,E,M,A,k,R,I,O,D,P=f._getModel(),N=t._supportsCalc&&f._getCalcModel(),F=t._supportsCalc&&f._getSheetSource(),L=f.comments,H=function(e,t,n){e&&(e._rowIndex=t,e._colIndex=n)},V=a?e:n,j=a?e+o:n+i,B=a?n:e,U=a?n+i:e+o;for(O=V;O<j;O++)if(I=r(C,V,O),O!==I)for(a?(S=O,T=I):(x=O,E=I),D=B;D<U;D++)a?(x=D,E=D):(S=D,T=D),M=f.getValue(S,x),A=f.getValue(T,E),L&&(k=L.get(S,x),R=L.get(T,E)),N&&F&&(u(N,S,x),u(N,T,E),N._swapNode(S,x,T,E),c(N,S,x),c(N,T,E)),P.swapNode(S,x,T,E),L&&(H(R,S,x),H(k,T,x)),b&&(f.setValue(S,x,A),f.setValue(T,E,M)),w.push({row:S,col:x}),w.push({row:T,col:E});if(N)for(var W=e;W<e+o;W++)for(var z=n;z<n+i;z++){var Y=N.getExpression(W,z);Y&&N._setExpression(W,z,Y,void 0)}return!0}return!1}finally{t._supportsCalc&&f.resumeCalcService(!1),f.resumeEvent(),f.resumePaint(),f._raiseRangeDataChanged(e,n,o,i,w,4)}}},_canDoSort:function(){var e=this.options;return!e.isProtected||e.protectionOptions.allowSort}}),e.exports={quickSortImpForCellValues:f}},function(e,t){e.exports={Exp_NotSupported:"NotSupportException",Exp_PasteExtentIsNull:"pasteExtent is null",Exp_InvalidPastedArea:"The pasted area should have the same size as the copy or cut area.",Exp_ChangePartOfArray:"Cannot change part of an array.",Exp_InvalidAndSpace:"Invalid {0}: {1} (must be between {2} and {3}).",Exp_SrcIsNull:"The argument 'src' is null",Exp_DestIsNull:"The argument 'dest' is null",Exp_InvalidCustomFunction:"invalid custom function",Exp_InvalidCustomName:"invalid custom name",Exp_IndexOutOfRange:"Index is out of range!",Exp_InvalidRange:"Invalid range",Exp_ArgumentOutOfRange:"ArgumentOutOfRange",Exp_PasteSourceCellsLocked:"Source sheet's cells are locked.",Exp_InvalidCopyPasteSize:"The copy and paste areas are not the same size.",Exp_PasteDestinationCellsLocked:"The cell you are trying to change is protected and therefore read-only.",Exp_PasteChangeMergeCell:"Cannot change part of a merged cell.",Tip_Row:"Row: ",Tip_Column:"Column: ",Tip_Height:"Height: {0} pixels",Tip_Width:"Width: {0} pixels",NewTab:"New...",Exp_EmptyNamedStyle:"The name of named style cannot be empty or null",Exp_SheetNameInvalid:"The sheet name can not be blank or contains these characters : *, :, [, ], ?, \\, /",Exp_ArrayFromulaSpan:"Array formulas are not valid in merged cells.",Exp_DestSheetIsNull:"destSheet is null",Exp_SheetIsNull:"sheet is null.",Exp_OverlappingSpans:"This operation will cause overlapping spans.",NeedCanvasSupport:"You need a browser which full supports HTML5 Canvas to run Handsontable",ls1:["","506f776572656420627920477261706543697479205370726561642e5368656574732e0d0a596f752063616e206f6e6c79206465706c6f792074686973204556414c554154494f4e2076657273696f6e206c6f63616c6c792e0d0a54656d706f72617279206465706c6f796d656e74206b6579732061726520617661696c61626c6520666f722074657374696e672e0d0a456d61696c207370726561642e73616c6573406772617065636974792e636f6d2e"],ls2:["","506f776572656420627920477261706543697479205370726561642e5368656574732e0d0a596f75722074656d706f72617279206465706c6f796d656e74206b6579206578706972657320696e207b307d206461792873292e"],ls3:["","4c6963656e7365204e6f7420466f756e640d0a596f75206e65656420612076616c6964206c6963656e7365206b657920746f2072756e205370726561642e5368656574732e200d0a54656d706f72617279206b6579732061726520617661696c61626c6520666f72206576616c756174696f6e2e200d0a496620796f75207075726368617365642061206c6963656e73652c20796f7572206b657920697320696e20796f757220707572636861736520636f6e6669726d6174696f6e20656d61696c2e0d0a456d61696c207370726561642e73616c6573406772617065636974792e636f6d20696620796f75206e65656420617373697374616e63652e"],ls4:["","496e76616c6964206c6963656e7365206b65792e20456d61696c207370726561642e73616c6573406772617065636974792e636f6d20696620796f75206e6565642068656c702e"],ls5:["","506f776572656420627920477261706543697479205370726561642e5368656574732e0d0a596f75722074656d706f72617279206465706c6f796d656e74206b65792068617320657870697265642e0d0a456d61696c207370726561642e73616c6573406772617065636974792e636f6d20666f722068656c702e"],ls6:["","506f776572656420627920477261706543697479205370726561642e536865657473204576616c756174696f6e2056657273696f6e0d0a4e6f74204c6963656e73656420666f7220446973747269627574696f6e"]}},function(e,t,n){function r(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}var t={};n(111),r(t,n(25)),r(t,n(112)),r(t,n(113)),t.SR={},t.SR.en=n(58),e.exports=t},function(e,t){e.exports={Exp_NotSupportedDataSource:"The data source is not supported!"}},function(e,t,n){function r(e){var t=e._sheet;return e._isRowGroup?t.rowOutlines:t.columnOutlines}function o(e){var t=this,n=!1;if(e?t.canExecute():t.canUndo()){var o=t._sheet,i=t._command.index,a=t._command.count,s=r(t);if(o&&s&&!S(i)&&!S(a)){var l=e?s.group:s.ungroupRange;t._beforeAction(o,!0),l.call(s,i,a),t._afterAction(o,!0),n=!0}}return n}function i(e,t,n,r,o){var i,a=0;for(i=t;i<=n&&i<r;i++)a+=o.call(e,i)*e._zoomFactor;return a}function a(e,t,n,r,o){var i,a=0;for(i=t;i<r&&a<n;i++)t++,a+=o.call(e,i)*e._zoomFactor;return t>=r?r-1:t}function s(e,t,n,r,o){if(t<r)return r;if(t>o)return o;for(var i=t;i<=o;i++)if(n.call(e,i))return i;return-1}function l(e,t,n){var o=this,l=o._sheet,u=n.index,c=t?l.getRowCount():l.getColumnCount(),f=void 0;if(!(u<0||u>=c)){var d,p,h,m=r(o),g=1===m.direction(),_=t?l.frozenRowCount():l.frozenColumnCount(),v=t?l.getRowHeight:l.getColumnWidth,y=t?l.getViewportTopRow:l.getViewportLeftColumn,b=t?l.getViewportHeight:l.getViewportWidth,w=y.call(l,1),C=m.find(g?u-1:u+1,n.level);if(C){var S=g?C.start:u,x=g?u:C.end;g?(e?S=u:S<_&&(S=_),S<w&&(w=S),d=b.call(l,1),p=i(l,w,x,c,v),p>d&&(w=a(l,w,p-d,c,v)),h=s(l,w,v,_,c-1)):(e?x=u:x>=c&&(x=c-1),S<w?h=s(l,S,v,_,c-1):(d=b.call(l,1),(p=i(l,w,x,c,v))>d&&(w=a(l,w,p-d,c,v),h=s(l,w,v,_,c-1)))),t&&h!==f?(l._scrollTopRow=h,l._syncVScrollbarPosition()):t||h===f||(l._scrollLeftCol=h,l._syncHScrollbarPosition())}}}function u(e){var t=this,n=!1;if(e?t.canExecute():t.canUndo()){var o=t._sheet,i=t._command,a=r(t),s=i.collapsed,u=i.index;!o||!a||S(s)||S(u)||S(i.level)||(t._beforeAction(o,!0),e||(s=!s),a.setCollapsed(u,s),l.call(t,s,t._isRowGroup,i),t._afterAction(o,!0),n=!0)}return n}var c=n(0),f=n(1),d=f.Commands,p=d.ActionBase,h=f.GC$,m="outlineColumn",g="removeColumnOutline",_="expandColumnOutline",v="expandColumnOutlineForLevel",y="outlineRow",b="removeRowOutline",w="expandRowOutline",C="expandRowOutlineForLevel",S=c._Types._isNullOrUndefined,x=function(e){function t(t,n,r){var o=this;e.call(o),o._sheet=t,o._command=n,o._isRowGroup=r}h.inherit(t,e);var n={execute:function(){return o.call(this,!0)},undo:function(){return o.call(this,!1)}};return h.extend(t.prototype,n),t}(p),T=function(e){function t(t,n){e.call(this,t,n,!1)}return h.inherit(t,e),t}(x),E=function(e){function t(t,n){e.call(this,t,n,!0)}return h.inherit(t,e),t}(x),M=function(e){function t(t,n,r){var o=this;e.call(o),o._sheet=t,o._command=n,o._isRowGroup=r}h.inherit(t,e);var n={execute:function(){var e=this,t=e._sheet,n=!1;if(e.canExecute()){var o=e._command.index,i=e._command.count,a=r(e);t&&a&&!S(o)&&!S(i)&&((a.getLevel(o)>=0||a.getLevel(o+i-1)>=0)&&(e._beforeAction(t,!0),a.ungroupRange(o,i),e._afterAction(t,!0)),n=!0)}return n},undo:function(){var e=this,t=!1,n=e._sheet;if(e.canUndo()){var o=e._command.index,i=e._command.count,a=r(e);n&&a&&!S(o)&&!S(i)&&(e._beforeAction(n,!0),a.group(o,i),e._afterAction(n,!0),t=!0)}return t}};return h.extend(t.prototype,n),t}(p),A=function(e){function t(t,n){e.call(this,t,n,!1)}return h.inherit(t,e),t}(M),k=function(e){function t(t,n){e.call(this,t,n,!0)}return h.inherit(t,e),t}(M),R=function(e){function t(t,n,r){var o=this;e.call(o),o._sheet=t,o._command=n,o._isRowGroup=r}h.inherit(t,e);var n={execute:function(){return u.call(this,!0)},undo:function(){return u.call(this,!1)}};return h.extend(t.prototype,n),t}(p),I=function(e){function t(t,n){e.call(this,t,n,!1)}return h.inherit(t,e),t}(R),O=function(e){function t(t,n){e.call(this,t,n,!0)}return h.inherit(t,e),t}(R),D=function(e){function t(t,n,r){var o=this;e.call(o),o._sheet=t,o._command=n,o._isRowGroup=r}h.inherit(t,e);var n={execute:function(){var e=this,t=e._sheet,n=!1;if(e.canExecute()){var o,i=e._command.level,a=r(e);if(t&&a&&!S(i)){for(e._beforeAction(t,!0),e.saveState(),o=0;o<i;o++)a.expand(o,!0);a.expand(i,!1),e._afterAction(t,!0),n=!0}}return n},saveState:function(){var e,t,n,o,i,a,s=this,l=s._sheet,u=s._command,c=null,f=s._isRowGroup,d=u.level,p=r(s),h=f?l.getRowCount():l.getColumnCount();if(l&&p&&!S(d))for(c={},e=0;e<=d;e++)for(i=0;i<h;){if(t=p.find(i,e)){switch(a=-1,n=t.start,o=t.end,p.direction()){case 0:a=n-1;break;case 1:a=o+1}c[a]||(c[a]=1===t.state()),i+=o-n+1}i++}u._oldStatus=c},undo:function(){var e=this,t=!1;if(e.canUndo()){var n,o=e._sheet,i=e._command._oldStatus,a=r(e);if(o&&i&&a){e._beforeAction(o,!0);for(n in i)n&&(a.setCollapsed(parseInt(n),i[n]),t=!0);e._afterAction(o,!0)}}return t}};return h.extend(t.prototype,n),t}(p),P=function(e){function t(t,n){e.call(this,t,n,!1)}return h.inherit(t,e),t}(D),N=function(e){function t(t,n){e.call(this,t,n,!0)}return h.inherit(t,e),t}(D),F=d._executeCommand;d[m]={canUndo:!0,execute:function(e,t,n){return F(e,T,t,n)}},d[y]={canUndo:!0,execute:function(e,t,n){return F(e,E,t,n)}},d[g]={canUndo:!0,execute:function(e,t,n){return F(e,A,t,n)}},d[b]={canUndo:!0,execute:function(e,t,n){return F(e,k,t,n)}},d[_]={canUndo:!0,execute:function(e,t,n){return F(e,I,t,n)}},d[w]={canUndo:!0,execute:function(e,t,n){return F(e,O,t,n)}},d[v]={canUndo:!0,execute:function(e,t,n){return F(e,P,t,n)}},d[C]={canUndo:!0,execute:function(e,t,n){return F(e,N,t,n)}},d._initOutlineDefaultCommands=function(e){e.register(m,d[m]),e.register(y,d[y]),e.register(g,d[g]),e.register(b,d[b]),e.register(_,d[_]),e.register(w,d[w]),e.register(v,d[v]),e.register(C,d[C])},e.exports=d},function(e,t){e.exports={Exp_InvalidIndex:"Invalid index",Exp_InvalidCount:"Invalid count",Exp_InvalidLevel:"Invalid level",Exp_GroupInfoIsNull:"groupInfo is null"}},function(e,t){e.exports={ToolStrip_PasteText:"Paste",ToolStrip_CutText:"Cut",ToolStrip_CopyText:"Copy",ToolStrip_AutoFillText:"AutoFill"}},function(e,t,n){var r=n(34);n(118),n(63),n(119),r.SR={},r.SR.en=n(64),e.exports=r},function(e,t,n){function r(e){var t=e._floatingObjectModel,n=!1;return t&&t._all().forEach(function(e){e&&e[I]()&&(n=!0)}),n}function o(e){var t=[];return e._floatingObjectModel._all().forEach(function(e){e[I]()&&t.push(e[O]())}),t}function i(e,t,n){var r=e._getFloatingObjectClipboardHelper(),o=r.fromSheet;r.fromSheet=e,r.isCutting=n;for(var i=new B,a=0,s=0;s<f(t);s++){var l=e._floatingObjectModel._get(t[s]);l&&(i.push(l),a++)}return o&&(o._clipboardFloatingObjectData=p),e._clipboardFloatingObjectData=i,a>0}function a(e){return function(t,n){var r=c._getWorksheet(t,n),i=0;0===e?i=-1:2===e&&(i=1);var a=0;1===e?a=-1:3===e&&(a=1);var s=o(r);return f(s)>0&&r._commandManager().execute({cmd:T,sheetName:r.name(),floatingObjects:s,offsetX:i,offsetY:a})}}var s=n(1),l=n(0),u=s.GC$,c=s.Commands,f=l._ArrayHelper._getLength,d=c.ActionBase,p=null,h=void 0,m=Math.min,g="unSelectAllFloatingObjects",_="deleteFloatingObjects",v="navigationNextFloatingObject",y="navigationPreviousFloatingObject",b="cutFloatingObjects",w="copyFloatingObjects",C="pasteFloatingObjects",S="dragCopyFloatingObjects",x="selectAllFloatingObjects",T="moveFloatingObjects",E="moveFloatingObjectsUp",M="moveFloatingObjectsDown",A="moveFloatingObjectsLeft",k="moveFloatingObjectsRight",R="resizeFloatingObjects",I="isSelected",O="name",D=c._executeCommand,P=function(e){function t(){e.call(this)}u.inherit(t,e);var n={init:function(e,t){var n=this;n._sheet=e,n._command=t,t._savedFloatingObjects=t._savedFloatingObjects||[]},canExecute:function(){return!!r(this._sheet)},canUndo:function(){var e=this._command._savedFloatingObjects;return!!(e&&f(e)>0)},saveState:function(){var e=this,t=e._command.floatingObjects;if(t instanceof Array)for(var n=e._sheet._floatingObjectModel,r=0,o=f(t);r<o;r++){var i=n._get(t[r]);i&&e._command._savedFloatingObjects.push(i)}}};return u.extend(t.prototype,n),t}(d),N=function(e){function t(t,n){e.call(this),this.init(t,n)}u.inherit(t,e);var n={constructor:t,execute:function(){var e=this,t=!1,n=e._sheet,r=e._command,o=r.floatingObjects;if(e.canExecute()&&o instanceof Array){e.saveState(),e._beforeAction(n,!0);for(var i=n._floatingObjectModel,a=0,s=f(o);a<s;a++){var l=i._get(o[a]);if(l){var u=n.slicers;e._isSlicer(l)&&u&&u.remove(l[O]());i._remove(o[a],!0)||(r._savedFloatingObjects[a]=h),l[I](!1)}}n._loadAndSetSheetSelections(),e._afterAction(n,!0),t=f(o)>0}return t},undo:function(){var e=this,t=e._command,n=t._savedFloatingObjects,r=e._sheet;if(e.canUndo()){e._beforeAction(r,!0);for(var o=r._floatingObjectModel,i=0,a=f(n);i<a;i++){var s=n[i];if(s){s[I](!0),o._add(s);var l=r.slicers;e._isSlicer(s)&&l&&l._addInternal(s),s.position(t._savedFloatingObjectPositions[s[O]()])}}return r._saveAndClearSheetSelections(),n.length=0,e._afterAction(r,!0),!0}return!1},init:function(t,n){e.prototype.init.call(this,t,n),n._savedFloatingObjectPositions=n._savedFloatingObjectPositions||{}},_isSlicer:function(e){return e&&"Slicer"===e.typeName},saveState:function(){e.prototype.saveState.call(this);var t=this,n=t._sheet,r=t._command.floatingObjects;if(r instanceof Array)for(var o=n._floatingObjectModel,i=0,a=f(r);i<a;i++){var s=o._get(r[i]);s&&s.position()&&(t._command._savedFloatingObjectPositions[s[O]()]=s.position())}}};return u.extend(t.prototype,n),t}(P),F=function(e){function t(t,n){var r=this;e.call(r),r.init(t,n)}u.inherit(t,e);var n={constructor:t,canExecute:function(){return!0},execute:function(){var e=this,t=!1,n=e._command,r=n.floatingObjects,o=e._sheet;if(e.canExecute()&&r instanceof Array){e.saveState(),e._beforeAction(o,!0);for(var i=o._floatingObjectModel,a=0,l=f(r);a<l;a++){var u=i._get(r[a]),c=u.position();u.position(new s.Point(c.x+n.offsetX,c.y+n.offsetY))}e._afterAction(o,!0),t=f(r)>0}return t},undo:function(){var e=this,t=e._command._savedFloatingObjects,n=e._sheet;if(e.canUndo()){e._beforeAction(n,!0);for(var r=0,o=f(t);r<o;r++){var i=t[r],a=i.position();i.position(new s.Point(a.x-e._command.offsetX,a.y-e._command.offsetY))}return t.length=0,e._afterAction(n,!0),!0}return!1}};return u.extend(t.prototype,n),t}(P),L=function(e){function t(t,n){var r=this;e.call(r),r.init(t,n)}u.inherit(t,e);var n={execute:function(){var e=this,t=!1,n=e._command,r=n.floatingObjects,o=e._sheet;if(e.canExecute()&&r instanceof Array){e.saveState(),e._beforeAction(o,!0);for(var i=o._floatingObjectModel,a=0,l=f(r);a<l;a++){var u=i._get(r[a]),c=u.position();u.width(u.width()+n.offsetWidth),u.height(u.height()+n.offsetHeight),u.position(new s.Point(c.x+n.offsetX,c.y+n.offsetY))}e._afterAction(o,!0),t=f(r)>0}return t},undo:function(){var e=this,t=e._command._savedFloatingObjects,n=e._sheet;if(e.canUndo()){e._beforeAction(n,!0);for(var r=0,o=f(t);r<o;r++){var i=t[r],a=i.position();i.position(new s.Point(a.x-e._command.offsetX,a.y-e._command.offsetY)),i.width(i.width()-e._command.offsetWidth),i.height(i.height()-e._command.offsetHeight)}return t.length=0,e._afterAction(n,!0),!0}return!1}};return u.extend(t.prototype,n),t}(P),H=function(e){function t(){var t=this;e.call(t),t._sheet=p}u.inherit(t,e);var n={canExecute:function(){var e=this,t=e._command.floatingObjects;return!!(f(t)>0&&e._canEditObjects(t))},canUndo:function(){var e=this._command._savedObjects;return!!(e&&f(e)>0)},_canEditObjects:function(e){for(var t=this,n=t._sheet,r=n._floatingObjectModel,o=0,i=f(e);o<i;o++){var a=r._get(e[o]);if(a&&!n._canEditFloatingObject(a))return!1}return!0},_isSlicer:function(e){return e&&"Slicer"===e.typeName}};return u.extend(t.prototype,n),t}(d),V=function(e){function t(t,n){var r=this;e.call(r),r.OFFSET=15,r._sheet=t,r._command=n,n._savedObjects=n._savedObjects||[],n._selectedObjects=n._selectedObjects||[]}u.inherit(t,e);var n={execute:function(){var e=this,t=e._command,n=t.floatingObjects;if(e.canExecute()){var o=e._sheet,i=t.fromSheet;e._beforeAction(o,!0);var a=t._selectedObjects,l=o._floatingObjectModel;void 0===t._activeRowIndex&&(r(o)&&l._all().forEach(function(e){e&&e[I]()&&a.push(e)}),t._activeRowIndex=e._sheet.getActiveRowIndex(),t._activeColumnIndex=e._sheet.getActiveColumnIndex()),r(o)&&l._all().forEach(function(e){e&&e[I]()&&e[I](!1)});var u,c,d=[],p=Number.MAX_VALUE,h=p,g=p,_=[];for(u=0,c=f(n);u<c;u++){var v=i._clipboardFloatingObjectData.find(n[u]).position();h=m(h,v.x),g=m(g,v.y),_.push(new s.Point(v.x-h,v.y-g))}var y=0,b=0;if(a.length){var w=p,C=p;a.forEach(function(e){if(e){var t=e.position();w=m(w,t.x),C=m(C,t.y)}}),y=w<p?w+e.OFFSET:0,b=C<p?C+e.OFFSET:0}else{for(var S=0;S<t._activeRowIndex;S++)b+=o._getActualRowHeight(S,3);for(var x=0;x<t._activeColumnIndex;x++)y+=o._getActualColumnWidth(x,3)}for(u=0,c=f(n);u<c;u++){var T=_[u];d.push(new s.Point(y+T.x,b+T.y))}var E=t.isCutting,M=i._floatingObjectModel;for(u=0,c=f(n);u<c;u++){var A,k,R=i._clipboardFloatingObjectData.find(n[u]);E&&!M._get(n[u])?(A=R,A.sheet(o)):(A=R.clone(o),k=e._isSlicer(A)?o.slicers._getAutoSlicerName(A[O]()):l._generateFloatingObjectName()),k&&A[O](k),e._isSlicer(A)&&(o.slicers._addInternal(A),A.width(R.width()),A.height(R.height())),A.isVisible(!0),A.position(d[u]),A[I](!0),l._add(A),t._savedObjects.push(A)}return e._afterAction(o,!0),!0}return!1},undo:function(){var e=this,t=e._command,n=t._savedObjects;if(e.canUndo()){var r=e._sheet,o=r._floatingObjectModel;e._beforeAction(r,!0);for(var i=0,a=f(n);i<a;i++){var s=n[i],l=r.slicers;e._isSlicer(s)&&l&&l.remove(s[O]()),o._remove(s[O](),!0)}n.length=0;return t._selectedObjects.forEach(function(e){e[I](!0)}),e._afterAction(r,!0),!0}return!1}};return u.extend(t.prototype,n),t}(H),j=function(e){function t(e,t){var n=this;n._sheet=e,n._command=t,t._savedObjects=t._savedObjects||[]}u.inherit(t,e);var n={constructor:t,execute:function(){var e=this,t=!1,n=e._command,r=n.floatingObjects,o=e._sheet;if(e.canExecute()){e._beforeAction(o,!0);var i,a,l=o._floatingObjectModel;for(i=0,a=f(r);i<a;i++){var u=l._get(r[i]);if(u){var c=u.clone(o),d=u.position();if(c.position(new s.Point(d.x+n.offsetX,d.y+n.offsetY)),c[O](l._generateFloatingObjectName()),c[I](!0),u[I](!1),e._isSlicer(c)&&o.slicers){var p=c,h=o.slicers._getAutoSlicerName(p.columnName());p[O](h),o.slicers._addInternal(p)}l._add(c),n._savedObjects.push(c)}}e._afterAction(o,!0),t=!0}return t},undo:function(){var e=this,t=e._command,n=t._savedObjects,r=e._sheet;if(e.canUndo()){e._beforeAction(r,!0);for(var o=r._floatingObjectModel,i=0,a=f(n);i<a;i++){var s=n[i][O](),l=r.slicers,u=o._get(s);e._isSlicer(u)&&l&&l.remove(s),o._remove(s,!0)}return n.length=0,e._afterAction(r,!0),!0}return!1}};return u.extend(t.prototype,n),t}(H);c[g]={canUndo:!1,execute:function(e,t){var n=c._getWorksheet(e,t);return!!r(n)&&(n.suspendPaint(),n._unSelectAllFloatingObjects(),n._loadAndSetSheetSelections(),n.resumePaint(),!0)}},c[x]={canUndo:!1,execute:function(e,t){var n=c._getWorksheet(e,t);n.suspendPaint(),n._floatingObjectModel._all().forEach(function(e){e[I](!0)}),n.resumePaint()}},c[_]={canUndo:!0,execute:function(e,t,n){if(t.floatingObjects)return D(e,N,t,n);var r=e.sheets?e.getActiveSheet():e,i=o(r);return f(i)>0?r._commandManager().execute({cmd:_,sheetName:r.name(),floatingObjects:i}):void 0}},c[v]={canUndo:!1,execute:function(e,t){var n=c._getWorksheet(e,t);if(r(n)){n.suspendPaint();var o,i,a,s,l=n._floatingObjectModel._all(),u=l.length;for(s=0;s<u;s++){var f=l[s];if(i||(i=f),o){a=f;break}f&&f[I]()&&(o=f)}return n._unSelectAllFloatingObjects(),a||(a=i),a&&a[I](!0),n.resumePaint(),!0}return!1}},c[y]={canUndo:!1,execute:function(e,t){var n=c._getWorksheet(e,t);if(r(n)){n.suspendPaint();var o,i,a,s=n._floatingObjectModel._all(),l=s.length;for(a=0;a<l;a++){var u=s[a];if(o||(o=u),o[I]())i=u;else if(u[I]()||(i=u),u[I]())break}return n._unSelectAllFloatingObjects(),i[I](!0),n.resumePaint(),!0}return!1}},c[b]={canUndo:!1,execute:function(e,t){var n=c._getWorksheet(e,t),r=[];if(n._floatingObjectModel._all().forEach(function(e){e[I]()&&r.push(e[O]())}),f(r)>0){i(n,r,!0),n._trigger(s.Events.FloatingObjectCuting,{selectedFloatingObjects:r});var o={cmd:_,sheetName:n.name(),floatingObjects:r};return n._commandManager().execute(o)}return!1}},c[w]={canUndo:!1,execute:function(e,t){var n=c._getWorksheet(e,t),r=[];return n._floatingObjectModel._all().forEach(function(e){e[I]()&&r.push(e[O]())}),i(n,r,!1)}},c[C]={canUndo:!0,execute:function(e,t,n){if(t.floatingObjects)return D(e,V,t,n);var r=c._getWorksheet(e,t);if(!r.isEditing()){var o=r._getFloatingObjectClipboardHelper(),i=o.fromSheet,a=i&&i._clipboardFloatingObjectData;if(a){var s=[];if(a.each(function(e){s.push(e[O]())}),0===f(s))return!1;if(!r._disposed)return r._commandManager().execute({cmd:C,sheetName:r.name(),floatingObjects:s,fromSheet:i,isCutting:o.isCutting})}}}},c[S]={canUndo:!0,execute:function(e,t,n){return D(e,j,t,n)}},c[A]=a(0),c[E]=a(1),c[k]=a(2),c[M]=a(3),c[T]={canUndo:!0,execute:function(e,t,n){return D(e,F,t,n)}},c[R]={canUndo:!0,execute:function(e,t,n){return D(e,L,t,n)}},c._initFloatingObjectsDefaultCommands=function(e){var t=s._util._isMacOS(),n=!t,r=t;e.register(g,c[g],27,!1,!1,!1,!1),e.register(x,c[x],65,n,!1,!1,r),e.register(_,c[_],46,!1,!1,!1,!1),e.register(v,c[v],9,!1,!1,!1,!1),e.register(y,c[y],9,!1,!0,!1,!1),e.register(b,c[b],88,n,!1,!1,r),e.register(w,c[w],67,n,!1,!1,r),e.register(S,c[S]),e.register(C,c[C],86,n,!1,!1,r),e.register(T,c[T]),e.register(E,c[E],38,!1,!1,!1,!1),e.register(M,c[M],40,!1,!1,!1,!1),e.register(A,c[A],37,!1,!1,!1,!1),e.register(k,c[k],39,!1,!1,!1,!1),e.register(R,c[R])};var B=function(){function e(e){return"string"==typeof e[O]?e[O]:e[O]()}function t(){this._elements={}}return t.prototype={push:function(t){this._elements[e(t)]=t},remove:function(e){delete this._elements[e]},find:function(e){return this._elements[e]},empty:function(){delete this._elements,this._elements={}},each:function(e){var t=this._elements;for(var n in t)t.hasOwnProperty(n)&&e(t[n])},isEmpty:function(){var e=this._elements;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}},t}();e.exports={_NamedObjectArray:B,FloatingObjectUndoActionBase:P,DeleteFloatingObjectUndoAction:N,MovingFloatingObjectUndoAction:F,ResizingFloatingObjectUndoAction:L,FloatingObjectCopyPasteUndoAction:H,ClipboardPasteFloatingObjectUndoAction:V,DragCopyFloatingObjectUndoAction:j}},function(e,t){e.exports={Exp_FloatingObjectHasSameNameError:"The current worksheet already has a floating object with the same name.",Exp_FloatingObjectNameEmptyError:"Floating object must have name"}},function(e,t){e.exports={Exp_RuleIsNull:"The argument 'rule' is null",Exp_NotSupported:"NotSupportException"}},function(e,t,n){n(67);var t=n(124);t.SR={},t.SR.en=n(68),e.exports=t},function(e,t,n){function r(e,t){y(e).addClass(t)}function o(e,t){y(e).removeClass(t)}function i(e,t,n){e.css([Pe,Ne],[t+ae,n+ae])}function a(e){y(e).css([Fe,xe,Ae],[0,0,0])}function s(e,t,n,r){return{sheet:e,sheetName:e._name,table:t,tableCol:n,filterValues:r}}function l(e,t,n){return{sheet:e,sheetName:e._name,col:t,filterValues:n}}function u(e){return e.concat([])}function c(e,t,n,r,o,i,a,s){e._width(t),e._height(n),e._minimum(r),e._maximum(o),e._pageValue(i),e._smallChange(a),e._largeChange(s),e._refreshLayout()}var f=n(1),d=n(0),p=f._BaseDialog,h=n(18),m=n(7),g=d._RegexHelper,_=n(55),v={},y=f.GC$,b=f.Events,w=f._util._createElement,C=f._util,S=C._cancelDefault,x=d._ArrayHelper._getLength,T=d._StringHelper._escapeHtml,E=null,M=d._Types._isNullOrUndefined,A=Math.max,k=parseFloat,R=y.inArray,I=isNaN,O="gc-sortASC",D="gc-sortDES",P="gc-filterOK",N="gc-filterCancel",F="gc-filterSearch",L="gc-filterCheckAll",H="gc-filterUnCheckAll",V="gc-filter-item",j="gc-filter-item-container",B="gc-filter-item-input",U="gc-filter-item-text",W="gc-filter-hover",z="gc-filter-button",Y="gc-filter-sort",G="ui-state-hover ",K="gc-filter-button-hover "+G,X="gc-filter-item-hover",q=G+X,J=W+" form-control well "+q,Z=" ui-corner-all ",Q="ui-button-disabled",$=" ui-state-disabled",ee="gc-filter-button-disable",te="gc-no-user-select",ne=" gc-filter-check",re="gc-filter-check-outerDiv",oe="gc-filter-button-active",ie=".ui-filter-dialog",ae="px",se="font-size",le="string",ue="javascript:void(0)",ce="mouseout",fe="click",de="keydown",pe="keyup",he="search",me="input",ge="span",_e="div",ve="button",ye="DOMMouseScroll",be="mousewheel",we="mousedown",Ce="mouseover",Se="mouseup",xe="margin",Te=xe+"Left",Ee=xe+"Top",Me=xe+"Right",Ae="padding",ke=Ae+"Left",Re=Ae+"Right",Ie=Ae+"Top",Oe="display",De="none",Pe="width",Ne="height",Fe="border",Le="left",He="top",Ve="box-sizing",je="content-box",Be="block",Ue=function(){return d._getResource(v.SR)()},We=function(){function e(e,t,n,r,o,i,a,s){var l=this;l.rowFilter=e,l.row=t,l.col=n,l.sheetArea=r,l.x=o,l.y=i,l.width=a,l.height=s}return e.prototype._getState=function(){var e=this,t=e.rowFilter,n=e.col,r=t.getSortState(n);return t?t.isFiltered(n)?[3,4,5][r]:r:0},e}();v._FilterButtonInfo=We;var ze=function(e){function t(t,n,r){var o=this,i=n.parent;e.call(o,t,C._getPreferredZIndex(i&&i._host)),o._allValues=[],o._searchedValues=[],o._allCheckedValues=[],o._inputElements=[],o._spanElements=[],o._itemOuterDivs=[],o.sheet=n,o.filterButtonInfo=r,o._containerWidth=237,o._containerHeight=318,o._itemContainerWidth=191,o._itemContainerHeight=150,o._itemDivMargin=2,o._itemDivBorder=1,o._itemDivHeight=20,o._itemHeight=o._itemDivHeight+2*o._itemDivBorder+o._itemDivMargin,o._touchContainerWidth=257,o._touchContainerHeight=355,o._defaultScrollbarSize=i?i._getScrollbarSize():18,o.rEscape=/[\-\[\]{}()+.,\\\^$|#\s]/g,o._itemValueCache=[],o._firstOpenCache=[],o.elementList=[],o.activeItemIndex=0,o._container=o._getContainer(),o._createTableLayout(),o._initFilterPanel()}y.inherit(t,e);var n={_open:function(){var e=this,t=e.sheet.parent,n=e.filterButtonInfo,r=e._container;e._useTouchLayout=!!t&&t.options.useTouchLayout,e._initData(n.col),e._initFilterItemsLayout(),r.appendTo(e._getHost()),r.hide(),e._show(function(){y("#"+O).focus()}),e._useTouchLayout&&e._updateFilterPanel(e._touchContainerWidth,e._touchContainerHeight),r.css([Le,He],[n.x+n.width-r.width()-6,n.y+n.height]),e._resetDialogPosition(),e._firstOpenCache=u(e._allCheckedValues);for(var o=e._allValues,i=0;i<x(o);i++)e._itemValueCache.push(o[i]);e._attachEvent()},_updateFilterPanel:function(e,t){var n=this,r=e-n._containerWidth,o=t-n._containerHeight;if(r>0&&o>0){i(n._container,e,t);var a=y("."+Y),s=k(a.css(Ie))+o/30,l=y("."+z),u=k(l.css(Pe))+r/4,c=k(l.css(Ne))+o/8,f=y("#"+P),d=k(f.css(Te))+r/2,p=y("#"+F),h=k(p.css(Pe))+r,m=k(p.css(Ne))+o/8,g=y("."+re),_=k(g.css(Ee))+o/10,v=y("#"+H),b=k(v.css(Te))+r;a.css(Ae,s+ae+" 6px"),i(l,u,c),f.css(Te,d+ae),i(p,h,m),g.css(Ee,_+ae),v.css(Te,b+ae)}},close:function(){var t=this,n=t.sheet;e.prototype.close.call(t),y(t._itemSpanElement).remove(),y(t._itemInputElement).remove(),n&&n._setFocus()},_initFilterPanel:function(){var e=this,n=e.elementList,o=e.table[0].children,i=o[0],a=o[1],s=o[2],l=o[3],u=o[4],c=e._getSortLink(O,Ue().SortAscending).css(Ee,"6px"),f=e._getSortLink(D,Ue().SortDescending);y(i.children[0]).append(y(w("img")).attr("src",t._getImageSrc(6))),y(a.children[0]).append(y(w("img")).attr("src",t._getImageSrc(7))),y(i.children[1]).append(c),y(a.children[1]).append(f),n.push(c[0]),n.push(f[0]);var d=y(w(_e)).css([xe,Ae],[0,0]),p=y(w(_e)).appendTo(d),h=y(w(me)).attr({type:he,placeholder:Ue().Search,id:F}).appendTo(p);r(d[0],"gc-search-outer-div ui-widget-header"+Z+"ui-multiselect-header ui-helper-clearfix"),n.push(h[0]);var g,_=y(w(_e)).appendTo(d),v=e._getCheckLink(L,Ue().CheckAll,"gc-check-image ui-icon ui-icon-check"),b=e._getCheckLink(H,Ue().UncheckAll,"gc-uncheck-image ui-icon ui-icon-closethick");r(_[0],re),_.append(v).append(b),y(s.children[1]).append(d),g=e.itemList=y(w(_e)).css([Pe,Ne,Ve],[e._itemContainerWidth,e._itemContainerHeight,je]),r(g[0],j),y(l.children[1]).append(g);var C=z+" gc-filter-button"+Z+m.BTN_CLASS,S=w(ve),x=w(ve),T=y(S).text(Ue().OK).css(se,"1em").attr("id",P),E=y(x).text(Ue().Cancel).css(se,"1em").attr("id",N);r(S,C),r(x,C),y(u.children[1]).append(T).append(E),n.push(S),n.push(x)},_createTableLayout:function(){var e,t,n=this,o=n._container,i=" gc-sort-container ui-menu-item",s=n.table=y(w("table")).css([Ae,Oe],[0,"table"]).attr({cellspacing:0,cellpadding:0});for(r(s[0],"gc-layout-table"),e=0;e<5;e++){var l=w("tr"),u=y(l).appendTo(s);for(a(l),t=0;t<3;t++){var c=w("td");y(c).appendTo(u),a(c),0===t?r(c,"gc-layout-table-first-column"):2===t?r(c,"gc-layout-table-last-column"):1===t&&(0===e?r(c,"gc-filter-sort-asc-container"+i):1===e&&r(c,"gc-filter-sort-desc-container"+i))}}n.table.appendTo(o),o.css(["box-shadow",Ae,Pe,Ne,Ve],["rgba(0, 0, 0, 0.4) 2px 4px 5px","2px",n._containerWidth+ae,n._containerHeight+ae,je]),r(o[0],"gc-filter-dialog-style "+te)},_itemsWrapMouseWheel:function(e){var t,n=this,r=e.originalEvent,o=e.wheelDelta,i=e.detail,a=n._spanElements,s=x(a),l=n._searchedValues,u=x(l),c=0;M(o)&&M(i)&&(o=r.wheelDelta,i=r.detail);var f=i||o/-40,d=e.wheelDeltaY;C._isMacOS()&&d&&(f=d/-40),f=(f>=0?1:-1)*Math.floor(Math.abs(f)),s&&(c=R(y(a[0]).text(),l)),t=c+f,t>u-s&&(t=u-s),t<0&&(t=0),n._updateItemsLayout(t),S(e)},_attachEvent:function(){var e=this,t=e._itemsWrap,n=!1,i=!1,a=y("."+V),s=y("."+z);t.addEventListener(be,function(t){e._itemsWrapMouseWheel(t)},!1),t.addEventListener(ye,function(t){e._itemsWrapMouseWheel(t)},!1),y("#"+O).bind(Se,function(t){n&&(n=!1,e._sortByUser(!0),e.close(),S(t))}).bind(we,function(e){S(e),n=!0}),y("#"+D).bind(Se,function(t){i&&(i=!1,e._sortByUser(!1),e.close(),S(t))}).bind(we,function(e){S(e),i=!0}),y("."+Y).bind(Ce,function(){o(y("."+W)[0],q),r(this,J)}).bind(ce,function(){o(this,J)}),y("#"+L).bind(we,function(e){S(e)}).bind(Se,function(t){e._updateFilterItemState(t,!0)}),y("#"+H).bind(we,function(e){S(e)}).bind(Se,function(t){e._updateFilterItemState(t,!1)}),a.bind(Ce,function(){o(y("."+W)[0],q),r(this,J)}).bind(ce,function(){o(this,J)}).bind(fe,function(){y(this).find(me)[0].click()}),a.find(me).bind(fe,function(t){t&&t.stopPropagation?t.stopPropagation():window.event.cancelBubble=!0,e._updateActiveItemIndex(y(this).parent()[0]),e._setButtonState()}),y("#"+F).bind(de,function(e){13===(e.which||e.keyCode)&&e.preventDefault()}).bind(pe,function(t){R(t.keyCode,[9,37,38,39,40])<0&&(e._searchHandler(t),e._setButtonState())}).bind(he,function(t){e._searchHandler(t),e._setButtonState()}),s.bind(Ce,function(){r(this,K)}).bind(ce,function(){o(this,K)}),s.bind(we,function(){o(this,K),r(this,oe)}).bind(ce,function(){o(this,oe)}),y("#"+P).bind(fe,function(){var t=e._allCheckedValues;e._updateData(t),e._filter(t),e.close()}),y("#"+N).bind(fe,function(){e.close()}),e._container.bind(be,function(e){S(e)}).bind(ye,function(e){S(e)}).bind(de+ie,function(t){e._filterKeyDown(t)}).bind(pe+ie,function(e){S(e)})},_updateFilterItemState:function(e,t){var n,r=this,o=[];r._itemOuterDivs.forEach(function(e){(n=e.style)&&n.display!==De&&o.push(e)}),y(o).find(me).prop("checked",t),r._allCheckedValues=t?u(r._searchedValues):[],r._setButtonState(),S(e)},_filterKeyDown:function(e){var t=this,n=t.elementList,i=y("."+X),a=i[0],s=R(e.which||e.keyCode,[27,13,38,40,9]);if(0===s)t.close(),S(e);else if(1===s&&1===x(i)){var l=i.attr("id"),c=l===O,f=t._allCheckedValues,d=i.find(me);c||l===D?(t._sortByUser(c),t.close()):l===P?(t._updateData(f),t._filter(f),t.close()):l===N?t.close():(x(d)>0&&d.trigger(fe),t._updateActiveItemIndex(a))}else if(s>1){var p,h=t._searchedValues;if(x(i)){var m=t.activeItemIndex,g=u(n);o(i,q);for(var _=0;_<x(h);_++)g.splice(-2,0,h[_]);if(4===s){var v=u(n),b=R(a,t._itemOuterDivs),w=e.shiftKey;if(h[m]&&v.splice(-2,0,h[m]),b>=0)p=w?n[2]:t._isElementDisabled(n[3])?n[4]:n[3];else{if((b=R(a,v))>=0){for(p=w?v[b-1]:v[b+1];w&&b>0&&t._isElementDisabled(p);)p=v[--b-1];for(;!w&&t._isElementDisabled(p)&&b<x(v);)p=v[++b+1]}w&&!p&&(p=v[x(v)-1])}p||(p=v[0])}else{R(a,t._itemOuterDivs)>=0&&(a=y(a).find("span."+U).text());var C=R(a,g),T=3===s;if(C>=0){for(p=T?g[C+1]:g[C-1],R(p,h)>=0&&R(a,h)<0&&(C=T?C+m:m+3,p=T?g[C+1]:g[C]);T&&C<x(g)&&t._isElementDisabled(p);)p=g[++C+1];if(!T){for(;C>0&&t._isElementDisabled(p);)p=g[--C-1];p||(p=g[x(g)-1])}p||(p=g[0])}}}else p=n[0];if(typeof p===le){var E=t._hoverToTargetFilterItem(p,h);E&&(i=E)}else i=y(p),i.focus();r(i,W+" "+q),S(e)}},_hoverToTargetFilterItem:function(e,t){var n=this,r=R(e,t),o=E,i=n._spanElements,a=R(y(i[0]).text(),t);return r>=0&&(n.activeItemIndex=r,r<a?(n._updateItemsLayout(r),o=y(i[0]).parent()):o=n._indexOfCurrentItemList(e,i)>=0?n._getVisibleHoverItem(e,a+1):n._getVisibleHoverItem(e,r-x(i)+1),o.find(me).focus()),o},_indexOfCurrentItemList:function(e,t){for(var n in t)if(y(t[n]).text()===e)return n;return-1},_getVisibleHoverItem:function(e,t){for(var n=this,r=E,o=n._spanElements;;){var i=n._indexOfCurrentItemList(e,o);if(i>=0){r=y(o[i]).parent();var a=n._scrollbarH,s=!0;if(n._showHorizontalScrollbar&&a&&x(r)>0&&"none"!==r.css(Oe)){var l=r.offset().top+n._itemHeight,u=a._getScrollbar();l>y(u).offset().top&&(s=!1)}if(s)break}if(n._updateItemsLayout(t),++t>=x(n._searchedValues))break}return r},_updateActiveItemIndex:function(e){var t=this,n=t._allCheckedValues,r=y(e).find("span."+U);if(r){var o=r.text(),i=R(o,n),a=R(o,t._searchedValues);i<0?n.push(o):n.splice(i,1),a>=0&&(t.activeItemIndex=a)}},_isElementDisabled:function(e){return typeof e!==le&&(e=y(e),0!==x(e)&&!!(e.hasClass(Q)||e.hasClass($)||e.hasClass(ee)))},_filter:function(e){var t=this,n=t.sheet;if(n)try{n.suspendPaint();var r=t.filterButtonInfo,o=r.rowFilter;if(!o)return;var i=r.col,a=o.table&&o.table(),u=a?i-a.range().col:-1;e&&(a?n._trigger(b.TableFiltering,s(n,a,u,e)):n._trigger(b.RangeFiltering,l(n,i,e))),o.filter(i),e&&(a?n._trigger(b.TableFiltered,s(n,a,u,e)):n._trigger(b.RangeFiltered,l(n,i,e)))}finally{n.resumePaint()}},_updateData:function(e){var t=this,n=t.filterButtonInfo,r=n.col,o=n.rowFilter,i=x(e),a=Ue().Blanks;if(o&&(o.removeFilterItems(r),i!==x(t._allValues)))for(var s=0;s<i;s++){var l=e[s];l===a&&(l="");var u=new h.Condition(2);u._ps.compareType=0,u._ps.expected=l,u._ps.useWildCards=!1,o.addFilterItem(r,u)}},_searchHandler:function(){var e=this,t=y.trim(y("#"+F).val().toLowerCase()),n=y("."+j).find(me),r=n.parent(),o=e._firstOpenCache;if(t){r.hide(),n.prop("checked",!1);var i,a=g._getWildcardCriteria(t),s=[];a||(i=new RegExp(t.replace(e.rEscape,"\\$&"),"gi")),y.map(e._itemValueCache,function(e){var t=a&&g._getRegIgnoreCase(a).exec(e);(t&&0===t.index||!a&&-1!==e.search(i))&&s.push(e)}),e._searchedValues=u(s),e._allCheckedValues=u(s),e.activeItemIndex=0,e._updateItemsLayout(0)}else r.show(),x(o)?(n.prop("checked",!1),e._searchedValues=u(e._allValues),e._allCheckedValues=u(o),e._updateItemsLayout(0)):e._firstOpenCache=u(e._allCheckedValues)},_getSortLink:function(e,t){var n=y(w("a"));return n.attr({id:e,href:ue}).text(t).css([Oe,Ae,"cursor",xe,"text-decoration","text-align",se,"outline",Ne],[Be,"5px 6px","default","2px 0 1px 2px",De,Le,"12px",De,"inherit"]),r(n[0],Y+Z),n},_getCheckLink:function(e,t,n){var o=w(ge),i=y(w(ge)).text(t),a=w("a"),s=y(a);return r(o,"gc-check-uncheck-all "+n),s.attr({href:ue,id:e}).css(["float",Te,Ae,se,Ne],[Le,"7px","0","12px","16px"]).append(y(o)).append(i),r(a,ne+ne+"-style"),s},_initData:function(e){var t=this,n=t.filterButtonInfo.rowFilter;if(n){var r,o=t.sheet,i=[],a=[],s=Ue().Blanks,l=!1,c={},f=o._getActualRange(n.range),d=f.col,p=[],h=0;if(e>=d&&e<d+f.colCount)for(r=0;r<f.rowCount;r++){var m=f.row+r,g=o.getText(m,e),v=o.getRowHeight(m)>0;if(g=g?g.trim():g,val=o.getValue(m,e),""===g)l||(l=!0,i.push(s),p.push({value:val,index:h++}),v&&a.push(s));else if(!c[g]&&o.getRowVisible(m,3,!0)){v&&a.push(g);var y=n._filteredColumns;(v||!n.isFiltered()||e===y[y.length-1]&&n._isRowfilteredOutByColumn(m,e))&&(i.push(g),p.push({value:val,index:h++}),c[g]=!0)}}t._allValues=i,t._allCheckedValues=a;var b=i.concat();for(p=_.quickSortImpForCellValues(p,!0),r=0;r<p.length;r++)i[r]=b[p[r].index];t._allValues=i,t._searchedValues=u(i),n.isFiltered(e)||(t._allCheckedValues=u(i))}},_initFilterItemsLayout:function(){var e=this,t=0,n=e._itemContainerWidth,o=e._itemContainerHeight,s=e._itemDivMargin,l=e._itemDivBorder,u=e._touchContainerWidth-e._containerWidth,c=e._touchContainerHeight-e._containerHeight,f=e.itemList;e._useTouchLayout&&(t=c/4,n+=u,o+=c/2,e._itemContainerHeight=o,e._itemContainerWidth=n,i(f,n,o),e._itemHeight+=t),e.defaultItemWidth=n-2*s-2*l;var d,p=e._allValues,h=e._itemHeight,m=Math.round(o/h),g=0,_=0,v=w(_e);for(e._itemsWrap=v,r(v,"gc-filter-item-wrapper"),d=0;d<x(p);d++)if(g+=h,!(d>=m)){var b=p[d],C=w(_e),S=w(me),E=w(ge),M=y(C);_=A(e._getItemWidthByText(b),_),r(C,V+Z+te),M.css([Oe,Ae,Fe+"-"+Pe,xe,Ne,Ve],[Be,t/2,l+ae,s+ae,e._itemDivHeight+ae,je]).attr("unselectable","on").appendTo(y(v)),r(S,B),y(S).attr({style:"margin: 3px; padding: 0",type:"checkbox",value:b}).appendTo(M),r(E,U),y(E).html(T(b)).appendTo(M),e._itemOuterDivs.push(C),e._inputElements.push(S),e._spanElements.push(E)}e._maxItemWidth=_,e._totalItemsHeight=g,f.empty();var k=w("table"),R=w("tr"),I=w("tr"),O=w("td"),D=w("td"),P=w("td"),N=w("td");e._hScrollbarTd=N,e._vScrollbarTd=P,a(R),a(I),a(O),a(P),a(N),a(D),R.appendChild(O),R.appendChild(P),I.appendChild(N),I.appendChild(D),k.appendChild(R),k.appendChild(I),O.appendChild(v),a(k),y(k).css([Pe,Ne],[n,o]).attr({cellspacing:0,cellpadding:0,border:0}),e._refreshScrollbar(),f.append(k),e._setItemWidth(),e._setCheckedValues()},_updateItemsLayout:function(e){var t,n=this,r=n._searchedValues,o=n._spanElements,i=n._scrollbarV,a=0,s=e;for(t=0;t<x(o);t++){var l=o[t],u=n._inputElements[t],c=r[e++];l&&c&&""!==c?(y(u).attr("value",c),y(l).html(T(c)).parent().show(),a=A(n._getItemWidthByText(c),a)):(y(u).attr("value",""),y(l).html("").parent().hide())}n._maxItemWidth=a,n._totalItemsHeight=x(r)*n._itemHeight,n._refreshScrollbar(),i&&i.value(s),n._setItemWidth(),n._setCheckedValues()},_refreshScrollbar:function(){var e=this,t=e._maxItemWidth,n=e._itemContainerWidth,r=e._itemContainerHeight,o=e._itemHeight,i=e._defaultScrollbarSize,a=n-i,s=r-i,l=e._isNeedScrollbars(t,e._totalItemsHeight,n,r),u=l._isNeedVScroll,f=l._isNeedHScroll,d=y(e._vScrollbarTd),p=y(e._hScrollbarTd);if(u){f||(s+=i),e._scrollbarV||e._createFilterScrollbar(!1);var h=Math.floor(s/o);c(e._scrollbarV,i,s,0,x(e._searchedValues)-h,h,1,h-1),d.show(),e._showVerticalScrollbar=!0}else d.hide(),e._showVerticalScrollbar=!1;f?(u||(a+=i),e._scrollbarH||e._createFilterScrollbar(!0),c(e._scrollbarH,a,i,0,t-a,a,o,a),p.show(),e._showHorizontalScrollbar=!0):(p.hide(),e._showHorizontalScrollbar=!1),f||u||(s=r,a=n),y(e._itemsWrap).css([Pe,Ne,"overflow"],[a,s,"hidden"])},_createFilterScrollbar:function(e){var t=this,n=new f._Scrollbar(e),r=n._getScrollbar();e?(t._scrollbarH=n,t._hScrollbarTd.appendChild(r)):(t._scrollbarV=n,t._vScrollbarTd.appendChild(r)),y(r).bind("scroll.gcScrollbar",function(n,r){var o=r.scrollOrientation,i=r.newValue;R(r.scrollEventType,[0,1,2,3,5])>=0&&(e?0===o&&y("."+V).css(Le,0-i):1===o&&t._updateItemsLayout(i))})},_isNeedScrollbars:function(e,t,n,r){var o=this._defaultScrollbarSize,i={_isNeedHScroll:!1,_isNeedVScroll:!1};return e>n&&(i._isNeedHScroll=!0,i._isNeedVScroll=!!(t>r-o)),t>r&&(i._isNeedVScroll=!0,i._isNeedHScroll=!!(e>n-o)),i},_getItemWidthByText:function(e){var t=this;if(!t._itemSpanElement){var n=w(me),o=w(ge),i=document.body,a=y(n).attr("type","checkbox").addClass(B),s=y(o);r(n,B),r(o,U),t._itemInputElement=n,t._itemSpanElement=o,i.insertBefore(n,E),i.insertBefore(o,E);var l=k(a.css(Te))+k(a.css(Me)),u=k(a.css(ke))+k(a.css(Re)),c=k(s.css(Te))+k(s.css(Me)),f=k(s.css(ke))+k(s.css(Re));I(l)&&(l=0),I(u)&&(u=0),I(c)&&(c=0),I(f)&&(f=0),t._itemInputWidth=a.width()+l+u,t._itemSpanPartWidth=c+f,a.css(Oe,De),s.css(Oe,De)}return y(t._itemSpanElement).html(T(e)).width()+t._itemInputWidth+t._itemSpanPartWidth+1+2*t._itemDivMargin+2*t._itemDivBorder},_setItemWidth:function(){var e,t=this,n=t.defaultItemWidth;e=t._showHorizontalScrollbar?t._maxItemWidth:t._showVerticalScrollbar?n-t._defaultScrollbarSize:n,y(t._itemOuterDivs).css(Pe,e)},_setCheckedValues:function(){var e=this,t={};y.each(e._allCheckedValues,function(e,n){t[n]=n}),e._inputElements.forEach(function(e){y(e).prop("checked",!M(t[y(e).val()]))})},_sortByUser:function(e){var t=this,n=t.filterButtonInfo,r=n.rowFilter,o=t.sheet;if(r&&o&&o._canDoSort()){var i=n.col,a={sheet:o,sheetName:o._name,col:i,ascending:e,cancel:!1};if(o._trigger(b.RangeSorting,a),a&&!1===a.cancel){o.suspendPaint();var s=r.sortColumn(i,e);o.resumePaint(),s&&o._trigger(b.RangeSorted,a)}}},_setButtonState:function(){var e=y("#"+P),t=Q+$+" "+ee;x(this._allCheckedValues)>0?(e.prop("disabled",!1),o(e[0],t)):(e.prop("disabled",!0),r(e[0],t))}};return y.extend(t.prototype,n),t._getImageSrc=function(e){return 0===e?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAMOSURBVHjaXJNdaJRHFIbfM7PfGremUTfkpxgpiheiBOmFtYUgRXNRqNnd75sEhBoIKhrwQpFUUSsihhIQ41+FNrUGqYhRY43STZqgARNRTIzRaFqz6xJTtals3K8xRQ3x7UV215+LB2bOxTNn3jMDs+mEIgmS+LwQiqSQ9JG03FHX54666pn7TLmJEZVIjCCRGMkYGxvNiI9FvaENZzLw/PmqtCDFV/4WkERw8TI03K6XqqrNWLBgPoafDmNwMCbd3TestpMDHpJAuIcWSZjSUrnS0SFOWamXJLpuDYAkAiYAkioYDCIej0+Lx12QrervFxOemjWfCvIyIcmTVeLVC1986OkUklhRtlgutLYrkpnOKlt1dl0BSfTHmnCnm5oTm0AS6I0xLaDLrK1PusTp/cb7/rUAyH8kSL+Vqt0ebpuGP699LCRROAdqf/suGforCpLi4DMpAOQQLAEgfE2sRDZIv5cknGxi74HDFnZ/32olk9f//vOTPIj05ZnKZpp14QlnfZgpTOXvNGsvjrvuH9MnOwAOYlhQ/UPYmxRkJVvzPHw8JF8EdrKoZEeapSt2cHDo4Sxn7R0hiV8/hEQe3Ad21jZNJQnbDklSBBas0ddvRj2Fi4qZIhaL+Q3ni8N0ZohGe4Dv6sKZfFP0kvkSWLZdGvLpiUTuTS9cVMxI5H5+fz+UfXyOto/Ns5bUL7dyjsBjTsKDbbVnM0iqYNHXYi9ZLiSlaRbFn089zlzvwN1IzkDlmDhfdiin5KgOBY5qO9iojX1K9+VRcOCXnlySsFkOkjj/WGschtR0Kt/Ga9D2aYj5DWKaIeYSxTlFMS2T66udBDbXHS94Z97ZUB8Ayt7+iVVddlkzl5LCvrklvQ9dr1fnF0IQbng5O/VQsmAJSfnxSLuqCG3Rxxpfz3xbXv0IEkzm5YR7lXOCGs6+PVNJYjaQnoKwSgBIDSqkjjPUuv3QLP9ImW+hG1/lKJtzp5jaCmW2nrNAUpOUkqrWrJUb23T5rhZf0eoWhbeEKX7O4eTPHe8DSTjF59T/AwCfnhbaDaIICgAAAABJRU5ErkJggg==":1===e?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAALLSURBVHjadJNtaNVlGMav+/kfjy3GTDfcsQW1CMrhWSZ6AsmXmflFDts5/0eYA52i02M6tdBIRQQJBLX8Yg4xYlMEJaHphzxKzoiaZptN0MBtacyXoYIobUgT/fXhtOMS+vBw89wXXPfLdd0CLNxwyACF648YYH7tnuEYAeQbv3CA/EeHBcivazbAUo1fv6hwfYtJEjDy2XP//8vpGbA9ZiE7xQ6USs3S7sUx9YHNbMqYn1IerGmQ3pr8uYXsNUAqnZ+LvqHJAA2BeIoGT6DJbMqBbAwArR77vs4/uhOje9BxlXEcww13pXDvtwaoes1MB6iz8xfxGkIIiLCUIEXaDTxiFJOmKp5YxDcciS6jVpRi8g1H87PVgLYslwO0GYzf+x377ubwXoLKafXEE/WUTfC9tBIhwNTJdAPkw4R1fdkkOmJW1/LAYNBV54iDJK8HH7NPd+/9MTqeWER//62YHxrrJvCDydd99Z/tpjLboz7znQF2/vSfufwY9Ne1e9r9JtHKaUvxqWY3UgXX23dNbccOlhQUFxUN9GweVsaWIQNZRfkeByidrnDxRD19N29U5AnChkMO0BMYAwRA4GkPAKuZc/2F8JWTDlB716sCIm9PXcz1K9+/lCc4erstABQmP3U8LBvlV2VJr8yyIHMSv+LUk1QmCzADBjQnrB0dT9TT0/243NfqXx8szwaAzq6Q1bDJnWnrmlKV3EZVchvvJbfQ2nqmDLDqD0/YXFqs8t0l/Haxu3j+vOPDO9ifu4P9jwPAeSk6RE/RpHc+4KefL8waYWEDrOPX9ol/cycA1KH7pvCTsxFAPxZGXQ1YmDhlgNIHsoWQd5wONw4JxgfhwmeKXSUjXbq0Oi/j80el28UjqpdqK1ivcCB7KJwXTuHKcwWAPtPCoJkShy7kjKU3dIXLAvQyVdq1C3WVXNbE2RgUOphuqVXH3T8DAFTcPgRQEEuLAAAAAElFTkSuQmCC":2===e?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAJKSURBVHjanJJfSJNhFMaf9/02R9MFCVZLUOgfpLMCmwrd7KIIm6X4fXoTY1oXltaN86oEi4xodtNNeNMHJZQ0gpDQmUKEyUAiyKCFW4PNtSFMoyKJSp4uputbJIUX5+K855zfe85zDkhiza4u2+HXn4M64dcBvw5BTotLtyDJ49KvI2fapK/Q/8qkwAjYiEHj4rrBG+ft4p+AB51f8pKazxxDY/djhLYj95bJLKG5fR+w5whUVxNUtR6qOiHUrmABNH3AkgcoqsBM11O56gvVUy2GV6CQNA/WjFdkMpnyhYV0NjZOAf6ksQMZCGQL3e526fUWm0kKrlAJRT7CUXeac+Gp3bRTaJpHXsReoLl3yGQAKPUtlaJh8yHxKI0s+C3xLHHXwjIqlbXtTKc/lKTScaRSFItMAWReB4WtdfdMJCVJTI18xihLNzFCyWXC4WxjMpksjiOK5BytjXIGUH0XCowjkFsESeF27BQLSy9F/2FK0ip6wa2VtV7OxxNF8XgciUQCKpMCZFoaRdQ6PXIHshvQDtACUJDARA/tVTVe6rHrSs97mMPh16j3vQECvpKc4iSLWzrGqXWMrahnx6h1jP5oPRf8Ho1FLA5nG/c7vayq8TIajdoikRi0nqCEdn9gDaCQLNVOXZOuk310nbhCV0Mvhx+OWlbhykGnh+Hou20sy2rUdLtbAJxUfs9PwW9PQM4qjuqjfDEd6ssX+VP56kdZ/+s80H9nZJcBYDxT6x8b+vspDw4Fbf+TuC7gpn7ZtoFCSdJE0vxrAN8Jcr/DWZzEAAAAAElFTkSuQmCC":3===e?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAMuSURBVHjaZJN/aNR1GMefz+f7/d6P3aZGDGVKERLDbXdMJAQhlr+ujWo62g5DpUBiEyJjpxi0ZRtyDSQvV0cDd2uw213b1EHiFjbGZq5bIbc5dTuyybRyK+ZCDrG0evWHdwfWHx8+PDwPz/vzeb2fR451DGvpQB2ODJvnP24zDkewD7Zct6h9qD1j4TzPWNgsip80isbCxuS7vzinGm5aZwcwbwVPGoAhgAIEsAAN2NKxSscmYKRvE1iRPrY3Vt7Ski4WQKaJOmbjyF3WS//3jfr4hVXGEA55J5aXc+ZMdF0yOZWbFtCAKtx5zCUQLQBk32svPFJ8eHN16u+fCn6fv+MErKWlRWdvPzr9QpUVnIroxravlYz0tTvWdi9XRFGA6ugKOMPh7qHu7u5Ue3s7ra2tBIMnaG4+Sl1dHTU1NZSXl7P42x39zRxKYl82mYD8Q0wA8bjFmv855Xqzdu/swsICDx78xfz8r0xMXKa+/iBer5fx8W+PDi22PjH43pKSoi2bzIS+reVlUYCVn18q11hl9vb2GIFAgFQqxczMDKFQCK/Xy8WLF4ozkN2e00o8O07YA1KpxCUCyKYSUX1fxDQgc3NzRjAY/DMej+Pz+ejpiTkzAAEpqfpEJHeP2PZJXO32VBsbKryydY3IPZB1a3IVIH6/n1AoREVFBWmQjzknK7aLHm4bWXs5cel48uq0ziQGolE9e/uG8vsPceDttygrK8s2cBfkZ9zQ8syGbeaVyQmp3v8VNXWDvFo3SPX+8/hqzxEPjqiD9X5eqqoiN8fFjzeu5wHidh9xZTjIgZr1BqAaWi6Zm3e8z/OVDZS90kBv74AdUH7/IbZu3oJps0h8N7N62IXpLt2VnVbZWfKc+jTx+aM/3bti85RuZ3RsvBjQxFgWO9VnTSebzB+SMyvhtMMTFsv9+l4r26Czq0sxcV9F+3eprnOJwumr14ozpMMfnLV/duQjPdeDmiTiaGrutLs3Nhjujc86sxD/uHs/DxCPjFrbXly0N7ZEbR9GcPb0jz4NS/q/1P/nwlOFlYpOrZ4UkeUiOt8nRk6xyGNzT3YXTGBZeqEcgP53ACxeTBjELwuFAAAAAElFTkSuQmCC":4===e?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAMNSURBVHjalJNfaFt1FMfP796bm9hublCwa93AVd3W5d67ddisFFw1lovUl7r0jx2rWWW6prpCkzfrUwjVFx0LwSrYPtiO0YJPDsuwIOJKq1PL0q43iZ3OuUp04p8owmbl40PXMgaCPnzhcPjCOef7PV8BxD6WETrKjXcviUbjTlW870/ta9mqfiqv1kuRQePjk68pkj4FSfX66HRA8ujfDPapvveWN4n1xKAC5H9CB3SRo767m9uhvRxQUGXAEXOt3uCodViWpT4Yi+tC1Rrhj99/luV8QQ43unrkxWaNVSqvXSNgHSeQSqU2A4Zt2xUdHR3bp6amwp8uTNU91jRgij2PAWg1da+sTwmeGTv768TExN8jIyOk0xlOnTpNMpkiFovR3t6O67rcuPHDJkCtr6U7zVH/gffPKrwravLzC75EIkGxWOTWrVWKxR+Zn79EPB7HdV3m5uYaAK12/xfmxm0P1uwW62D36p77nzdXVr4Txwn5h4aGVkqlEp6XJ5PJ4LouMzMzDYAGiPXkGwGJLGIAyqmPYod6sEM9vziRF0xALMvS0+n0zdnZWTo7O5mcnNwHaNevi27bqN0v+w1pWyj5AOUEjygn1I3VeLzaund/xfj4uAASi8WWM5kMLS0tAAYgV69+K5cvvyq/zZ7TpG1hzZaqbZbsDR3DPnSi2n6ka0uhUJB8Pt+QSCTo7++nqamJ204YXV1PG5aF2nFxUgn7PlGAWIefVXYoihVufcBWorLZrOTz+YMDAwN/tba2UlZWRi6Xq7itmQbb9JnU25qMvvmRAKrmoafEqY/edOqf2bljV/iebDYrgPT29q6Ew2FM06RQKFQMDw+L4ziabaP3nXwpIBy9oACVnBblHOh52N4Vqaxr7jYAFQwGty4uLm72PE/3PK8yt+QZuawnjgSN0TOiDj36nCmP9364pjiY1hJ67RX8F5dMBUjtW7Xav+Xh3PRnIiK6CF/qd/66886YHvW3Sfh8lQHfy11Z2MCegBgioknbCZQTPr1l71di/IcUqjsgLfHzvn8GACNDKumTxWELAAAAAElFTkSuQmCC":5===e?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAANBSURBVHjaXJNfSGR1HMXP73fvdcYdo7Vy1KRlZ9DdnOvv5uTODK0s1mxDyKIYSRYoUwQikkgzPUS0RuW6QRCEuIiM/XuxNdiH6m17WnZFCMSHtjuOszONf0ZnGgW1iLbw9DBl0sPhy3k5HDjfD0h6w/VvSJJC8a5sOPeUYQ1TIjAuPOc+kN6Kae2JthodGBCVrSEdpmXAd8pJUrb2julgiWgJ9MMXABIXYADApQA0ACLc8Jjg9bAkKbhbD5LimDTgNQn15sc6SZD1onyPZIAUSyQOSS124oLzDxL7hwRJjaTIFbYcUJ5xB0lYp29oZ8+OypZnPhfvkXiHdGz8nHHs7++6e+vede6UiiiVio69vR2v1+2S5slqQRJ4XvdXkBS7O+uuUv43bO79UvPZp4nfr8/N/Tk7O8urVz9cu3x5zH6x76Xvuru7f+zq6joIhUKFYrHYSBJA4yVBUm5sbWPm15nqH1bvOpRScnBwcL1QKPD+/b+4vV3k0tIy4/E4I5EIFxcXu0nKckDwWUlSV6peqGCUW/mvJUmoNr82MTHBg4MD2rbNqakpRiIR3r59a5ykzOc3QBJob5txkZSbuQ00h/q5ub7htZSJ9NYmlDLF5OQkFxYW2NfXx/n5+YskhWk2G0p9IV5BXgDBAZ1k5Z07tx6wAlHmcjlHjrUim13D8vIaYrEYr12bZmdnJ0k6ygvVHi0GOD2SpHGPhApGmclkKjKZ15HJpHHzJrV4PM6RkRF2dHQwm83WeTweMTw8cCwA1YKkUwWjVMEofaFXeS99w1CksKwWIxaLsaenh1VVVUyn0yf8fmBoKCpIoqeBAr3n50DywdXVlWorEGUqufp0imnpM8eEaZpaPB5nOBymrutMpVKuM2dGdQvjGh+icfFxCCA0YJB0tKC9Mpn8qTKZhLSS0BOJUWmaprBtu8K2bW1lZeVR27alUq3SwpDBh2t1fAUN/eepkYfCOvW26/grWxNB6XukvYJJwgKE+c1zUs270TQdkmq4WeKtTwS+hETiCgUJafrb/89CWTU9/8JT9k2UnP7HN1Ag+OQV8Ps6Yb78vigj/a08ahGCaGzql/zIrbmhy/9IzAmSztMvzJz8ewAvdf7cUVI5hQAAAABJRU5ErkJggg==":6===e?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAaCAYAAABCfffNAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAG7SURBVHjaxJY9SyNRFIaffFi4xWpUsEq1BIsVQc6tFQyYdhRE3JVFBTGC/0H9CWJlqSBYREwhiKLCWnu2MuU2O2wX27VxuTY3ISY3msSJHhiYec+B55457507EGGISF5E8vV6zFM4AfwESqo62gZgCrhyj1lVva7k4p76VaAEfHXAVgBfgEKNdOK0RoiI9AGzwDagwFILgD7gDEjVyJ+BM5dr6GQReEyn06exWOwQmK8U+mI6l0sAx0DGk84Ax9O5XKIesgwcFYvFh3giWQA+AQvNIPfl8g6QfaHR7H25vFsdvDFm3Fr7C5hU1Rv3Ki6BflU1Lc7GAqjqM0MlKzfW2lXgHzAsInNO/gNkxZhRvb2969TaSYAgCHrDMPzutL26mkeszQMbnULiAGEYzjhHjKnqQO0FHAHfgiDofRMEWANuVPW3p+YASLmFdAYxxowAE8C+r2BwaOga+AusdAyx0AOsO783xMX5+X/gB1Bw++JjQ0RsxcYN7vIlfFHv/3YH39VIvrZCEdkCNt1Hk8g7qQWo6lbkkKgATSFRAryQqAG+kzFywDNItwBVSDcB1V+iqHZ8s5PxXXb80wAn8qZQngdyBwAAAABJRU5ErkJggg==":7===e?"data:img/jpg;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAaCAYAAABCfffNAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAGbSURBVHjaxJXPK0RRFMc/d4wFC2JeWc1SFqR0nu0sKJOFepTkR0KE4m8w/gmypJQFNQubURQrv86OlWy8/AEs2NCzcNNreqh5V751N+ec3ueec945FxxKRCIRiart2YTAAnAK3Kpqlwt4JsG2ANwCnRboFiIizcAIsA4oMPMXmUwBb/l8/tAYswuMWbBTyCywVy6XXzN12X2gERh3BvF9vwcQYBfg8uI8BI6B+bSQr78riqIF4AVoE5FRa34A+sX3u/T6+iYVJAiChjAMJ61tqyrmjShaAlZSlSsMw2GgCehW1db4AfaAiSAIGtL2ZBE4U9X7hJgdoMVepDaI7/sdQAHYTgrIed4J8AjM1QyJoB5YBg6SAo4qlXdgGtgfKBbr+G/9uCCTHElSVeNqQTpX9rcbikgJWLNLE+eZxAGqWnIOcQX4FuISAGDSAERkw87YT9rMpMkg53mr9jn4Tsc5z1s1aUtkX84roL3KdQf0qupTJm0PVPUJGASeY+ZnY8yQ9X32xMXEi0hfrHT9qnrifOLtR5eBlTgA4GMAtNSkky83xeAAAAAASUVORK5CYII=":8===e?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAadEVYdFNvZnR3YXJlAFBhaW50Lk5FVCB2My41LjExR/NCNwAAAKBJREFUOE+l0cENwjAMBdCM0BEYhZG6AjdvwQhMUvXQI0KcKo6IY2/9v0qQnVilFoenJF+2q6RJRP7ihhFuGOGGO851Zg4/9PCGi8oOD+iAzQM8c7bRRTX9pStMmbnGd1Nhwz2vbOD+ATcwteagjPBSZuAVTmBqzUHhnTnkA2wkPmJT2wRKGbLk1avZHUAcwldv/n/hhhFuGOGGEW54nKQVV2qyDejeW7YAAAAASUVORK5CYII=":9===e?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAadEVYdFNvZnR3YXJlAFBhaW50Lk5FVCB2My41LjExR/NCNwAAAHpJREFUOE+lz8ENgDAMA8COxEiMkxWYgkmYhCGgllpkUz8aeJyQrVQJJSJ+sWWGLTNsmWHLaq22amkZX2T0MiuB7ASPOMusBIKNh9Evekh4weaTDOfDUDTYdBnTF/AjbOYssxJIf9Q39ouG35DwhS0zbJlhywxbzotyAztMtZGgPPrJAAAAAElFTkSuQmCC":""},t}(p);v._FilterDialog=ze,e.exports=v},function(e,t){e.exports={Exp_InvalidColumnIndex:"Invalid column index.",SortAscending:"Sort Ascending",SortDescending:"Sort Descending",OK:"OK",Cancel:"Cancel",Search:"Search",CheckAll:"Check all",UncheckAll:"Uncheck all",Blanks:"(Blanks)",Exp_FilterItemIsNull:"FilterItem is null."}},function(e,t,n){var t=n(125);t.SR={},t.SR.en=n(70),e.exports=t},function(e,t){e.exports={Exp_DragDropShiftTableCell:"This operation is not allowed. The operation is attempting to shift cells in a table on your worksheet.",Exp_DragDropChangePartOfTable:"Cannot complete operation: You are attempting to change a portion of a table row or column in a way that is not allowed.",Exp_TableEmptyNameError:"The table name cannot be empty.",Exp_TableNameInvalid:"The table name is not valid.",Exp_TableInvalidRow:"Invalid row index or row count.",Exp_TableInvalidColumn:"Invalid column index or column count.",Exp_TableIntersectError:"The tables cannot be intersected.",Exp_TableHasSameNameError:"The current worksheet already exists in a table with the same name.",Exp_TableDataSourceNullError:"Table datasource cannot be null.",Exp_TableMoveOutOfRange:"The table cannot be moved out of the sheet.",Exp_TableResizeOutOfRange:"The invalid row count, column count, and table cannot be resized out of the sheet.",Exp_ArrayFormulaTable:"multi-cell array formulas are not allowed in tables.",Exp_TableResizeInvalidRange:"The headers must remain in the same row, and the resulting table range must overlap the original table range."}},function(e,t){e.exports={Blank:"(blank)",Exp_SlicerNameInvalid:"The slicer name is not valid.",Exp_SlicerNameExist:"The slicer name is already in use, please enter a unique name."}},function(e,t,n){function r(e){if(d(e))return 0;if("number"==typeof e)return e;if("string"==typeof e){var t=parseFloat(e);if(!isNaN(t)&&t.toString()===e)return t}return h}function o(e){return e instanceof Date?e:"string"==typeof e?new Date(e):h}function i(e,t){if(!d(e)){var n;return 1===e||2===e?n=v.createNumberValidator(t.operator,t.value1,t.value2,1===e):3===e?t.value?n=v.createListValidator(t.value):t.formula&&(n=v.createFormulaListValidator(t.formula)):4===e||5===e?n=v.createDateValidator(t.operator,t.value1,t.value2):6===e?n=v.createTextLengthValidator(t.operator,t.value1,t.value2):7===e&&(n=v.createFormulaValidator(t.formula)),n?n.condition():void 0}}var a=n(0),s=n(1),l=n(18),u=l.Condition,c=l._createCondition,f=a._StringHelper._trimStart,d=a._Types._isNullOrUndefined,p=s.GC$,h=null,m=void 0,g=s._util._defProperty,_=s._util._isDefined,v={};v.CriteriaType={anyValue:0,wholeNumber:1,decimalValues:2,list:3,date:4,time:5,textLength:6,custom:7},v.DataValidationResult={forceApply:0,discard:1,retry:2},v.ErrorStyle={stop:0,warning:1,information:2};var y=function(){function e(t){var n=this;n.id=e._validatorId++,t&&(n.condition(t),n.condition().ignoreBlank(n.ignoreBlank()))}var t=["errorStyle","ignoreBlank","inCellDropdown","showInputMessage","showErrorMessage","inputTitle","errorTitle","inputMessage","errorMessage","comparisonOperator","type","condition"];return e.prototype={constructor:e,errorStyle:g("errorStyle",0),ignoreBlank:g("ignoreBlank",!0,function(e){this.condition()&&this.condition().ignoreBlank(e)}),inCellDropdown:g("inCellDropdown",!0),showInputMessage:g("showInputMessage",!0),showErrorMessage:g("showErrorMessage",!0),inputTitle:g("inputTitle",""),errorTitle:g("errorTitle",""),inputMessage:g("inputMessage",""),errorMessage:g("errorMessage",""),comparisonOperator:g("comparisonOperator",6),condition:g("condition",h),type:g("type",0),value1:function(){var e=this.condition(),t=e&&e.item1()?e.item1():e;if(t){var n=t.formula();return n&&n.length>0?"="+f(p.trim(n.toString().toUpperCase()),"="):t.expected()}return h},value2:function(){var e=this.condition(),t=e&&e.item2()?e.item2():e;if(t){var n=t.formula();return n&&n.length>0?"="+f(p.trim(n.toString().toUpperCase()),"="):t.expected()}return h},isValid:function(e,t,n,i){var a=this.condition();if(a){if(a.ignoreBlank()&&(d(i)||""===i))return!0;var s,l=i;if(!d(i))switch(this.type()){case 0:return!0;case 2:case 1:s=r(i),d(s)||(l=s);break;case 4:case 5:s=o(i),d(s)||(l=s)}return a.evaluate(e,t,n,l,l)}return!0},reset:function(){var e=this;e.errorStyle(0),e.ignoreBlank(!0),e.inCellDropdown(!0),e.showInputMessage(!0),e.showErrorMessage(!0),e.inputTitle(""),e.errorTitle(""),e.inputMessage(""),e.errorMessage(""),e.comparisonOperator(6),e.type(0),e.condition(h)},getValidList:function(e,t,n){if(!l)return h;var r=this.condition();return r!==h&&3===this.type()&&12===r.conType()?r.getValidList(e,t,n):h},toJSON:function(){var e=this,n={};return t.forEach(function(t){var r=e[t]();e[t].isDefault(r)||(n[t]=r&&r.toJSON?r.toJSON():r)}),p.isEmptyObject(n)?m:n},fromJSON:function(e,n){if(e&&!p.isEmptyObject(e)){var r=this;t.forEach(function(t){var o=e[t];if(_(o))if("condition"===t){var i=c();i.fromJSON(e.condition,n),r.condition(i,!1)}else r[t](o,!1)});var o=e.validatorInfo;if(o){var a=i(e.type,o),s=o.operator;a&&(a.ignoreBlank(r.ignoreBlank()),r.condition(a)),d(s)||r.comparisonOperator(s)}}},clone:function(){var t=new e;return t.fromJSON(this.toJSON()),t}},e._validatorId=1,e}();v.DefaultDataValidator=y,v._getImageSrc=function(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAMOSURBVHjaXJNdaJRHFIbfM7PfGremUTfkpxgpiheiBOmFtYUgRXNRqNnd75sEhBoIKhrwQpFUUSsihhIQ41+FNrUGqYhRY43STZqgARNRTIzRaFqz6xJTtals3K8xRQ3x7UV215+LB2bOxTNn3jMDs+mEIgmS+LwQiqSQ9JG03FHX54666pn7TLmJEZVIjCCRGMkYGxvNiI9FvaENZzLw/PmqtCDFV/4WkERw8TI03K6XqqrNWLBgPoafDmNwMCbd3TestpMDHpJAuIcWSZjSUrnS0SFOWamXJLpuDYAkAiYAkioYDCIej0+Lx12QrervFxOemjWfCvIyIcmTVeLVC1986OkUklhRtlgutLYrkpnOKlt1dl0BSfTHmnCnm5oTm0AS6I0xLaDLrK1PusTp/cb7/rUAyH8kSL+Vqt0ebpuGP699LCRROAdqf/suGforCpLi4DMpAOQQLAEgfE2sRDZIv5cknGxi74HDFnZ/32olk9f//vOTPIj05ZnKZpp14QlnfZgpTOXvNGsvjrvuH9MnOwAOYlhQ/UPYmxRkJVvzPHw8JF8EdrKoZEeapSt2cHDo4Sxn7R0hiV8/hEQe3Ad21jZNJQnbDklSBBas0ddvRj2Fi4qZIhaL+Q3ni8N0ZohGe4Dv6sKZfFP0kvkSWLZdGvLpiUTuTS9cVMxI5H5+fz+UfXyOto/Ns5bUL7dyjsBjTsKDbbVnM0iqYNHXYi9ZLiSlaRbFn089zlzvwN1IzkDlmDhfdiin5KgOBY5qO9iojX1K9+VRcOCXnlySsFkOkjj/WGschtR0Kt/Ga9D2aYj5DWKaIeYSxTlFMS2T66udBDbXHS94Z97ZUB8Ayt7+iVVddlkzl5LCvrklvQ9dr1fnF0IQbng5O/VQsmAJSfnxSLuqCG3Rxxpfz3xbXv0IEkzm5YR7lXOCGs6+PVNJYjaQnoKwSgBIDSqkjjPUuv3QLP9ImW+hG1/lKJtzp5jaCmW2nrNAUpOUkqrWrJUb23T5rhZf0eoWhbeEKX7O4eTPHe8DSTjF59T/AwCfnhbaDaIICgAAAABJRU5ErkJggg=="},v._isFormula=function(e){return s._supportsCalc&&e&&"="===e[0]},v.createNumberValidator=function(e,t,n,r){var o=h,i=h,a=h,s=h;v._isFormula(t)?o=f(t,"="):i=t,v._isFormula(n)?a=f(n,"="):s=n;var l,u,d=h;6===e&&(l=c(1,3,i,o),l.integerValue(r),u=c(1,5,s,a),u.integerValue(r),d=c(0,1,h,h,h,h,h,l,u)),7===e&&(l=c(1,4,i,o),l.integerValue(r),u=c(1,2,s,a),u.integerValue(r),d=c(0,0,h,h,h,h,h,l,u)),e>=0&&e<=5&&(d=c(1,e,i,o),d.integerValue(r));var p=new y(d);return p.type(r?1:2),p.comparisonOperator(e),p},v.createDateValidator=function(e,t,n){var r=h,o=h,i=h,a=h;v._isFormula(t)?r=f(t,"="):o=t,v._isFormula(n)?i=f(n,"="):a=n;var s,l,u=h;6===e&&(s=c(5,5,o,r),l=c(5,3,a,i),u=c(0,1,h,h,h,h,h,s,l)),7===e&&(s=c(5,2,o,r),l=c(5,4,a,i),u=c(0,0,h,h,h,h,h,s,l));var d;if(e>=0&&e<=5){switch(e){case 0:d=0;break;case 1:d=1;break;case 2:d=4;break;case 3:d=5;break;case 4:d=2;break;case 5:d=3}u=c(5,d,o,r)}var p=new y(u);return p.type(4),p.comparisonOperator(e),p},v.createTextLengthValidator=function(e,t,n){var r=h,o=h,i=h,a=h;v._isFormula(t)?r=f(t,"="):o=t,v._isFormula(n)?i=f(n,"="):a=n;var s,l,u=h;6===e&&(s=c(7,3,o,r),l=c(7,5,a,i),u=c(0,1,h,h,h,h,h,s,l)),7===e&&(s=c(7,4,o,r),l=c(7,2,a,i),u=c(0,0,h,h,h,h,h,s,l)),e>=0&&e<=5&&(u=c(7,e,o,r));var d=new y(u);return d.type(6),d.comparisonOperator(e),d},v.createFormulaValidator=function(e){if(!s._supportsCalc)return h;var t=new y(c(4,h,h,f(e,"="),4));return t.type(7),t},v.createFormulaListValidator=function(e){if(!s._supportsCalc)return h;var t=new y(u.fromFormula(e));return t.type(3),t},v.createListValidator=function(e){var t=new y(u.fromSource(e));return t.type(3),t},p.extend(s.Worksheet.prototype,{getDataValidator:function(e,t,n){return this._getStyleProperty(e,t,"validator",n)},setDataValidator:function(e,t,n,r){d(r)&&(r=3);var o=this,i=o._getStyleImp(e,t,r);i||(i=new s.Style);var a=i.validator;i.validator=n,o.suspendEvent(),o.setStyle(e,t,i,r),o.resumeEvent();var l=n&&n.condition();l&&4===l.conType()&&(d(l._baseRow)&&(l._baseRow=-1!==e?e:0),d(l._baseCol)&&(l._baseCol=-1!==t?t:0));var u="validator";o._raiseCellChanged(u,e,t,r,a,n),-1!==e&&-1===t?o._raiseRowChanged(e,r,u,n,a):-1===e&&-1!==t&&o._raiseColumnChanged(t,r,u,n,a)},isValid:function(e,t,n){try{var r=this;r._validatingRow=e,r._validatingColumn=t,r._validatingValue=n,r._isValidatingCell=!0;var o=r.getDataValidator(e,t);if(o)return o.isValid(r,e,t,n)}finally{r._validatingRow=-1,r._validatingColumn=-1,r._validatingValue=h,r._isValidatingCell=!1}return!0},_disposeValidationUI:function(){var e=this;if(e._isDisposingValidationUI)return!1;e._isDisposingValidationUI=!0;var t,n=e._validationInputMessage;n&&(t=n.parentNode,t&&t.removeChild(n),e._validationInputMessage=h);var r=e._validationButton;r&&(p(r).unbind("click"),t=r.parentNode,t&&t.removeChild(r),e._validationButton=h);var o=e._validationSelect;return o&&(p(o).unbind("keydown").unbind("blur").unbind("click"),t=o.parentNode,t&&t.removeChild(o),e._validationSelect=h),e._isDisposingValidationUI=!1,!0}}),s.Worksheet._registerFeature("validator",{dispose:function(){this._disposeValidationUI()}}),s.Style._registerFeature("validator",{fromJson:function(e){if("validator"===e.p){var t=new y;t.fromJSON(e.v),this.validator=t,e.r=!0}}}),window._gcGlobal._clickOutsideSheetCallBack.push(function(e,t){!t&&e._disposeValidationUI&&e._disposeValidationUI()}),e.exports=v},function(e,t,n){function r(e,t,n,r,o,i){var a=e._isTouchMode,s=a?"160px":"150px",l=a?"25px":"20px",f=u(c("div")).css([M,A,k,"padding",R],["block",s,l,0,0]).addClass("gc-smartMenu-item-default "+n+" ui-state-default"+h),d=u(c("div")).addClass(w).appendTo(f),p=u(c("div")).addClass("gc-menu-item-text").appendTo(f),m=u(c("input")).attr({id:t,value:o,type:"radio",name:"fill-group",style:"display:none"}).appendTo(d);return u(c("span")).text(r).appendTo(p),i?(d.addClass(b),m.prop("checked","checked")):m.prop("checked",""),f}function o(e){var t="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA",n="AAAASCAYAAA",r="AAAACXBIWXMAAA7",o="lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN";return e?t+"Ac"+n+"CXScT7"+r+"DAAAOwwHHb6hkAAAKTW"+o+"3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAGCSURBVHjafNFPKKRxHAbw5/v7GYdBYUQjLm5SkoNykCQHtcx431/KgdKumJvSrAO7Nwc3RQ5kd3OkHJC/hUJREluonVcToqRh3sRFPA6M1Mbhc3z6Pj1fkMRHQNJL0uPeul731lU37o1y49cqHr8GvvgWQRLBsmpM/P0j4XAXiooKcXl1CZDEzl4EJBEwAZBUwWAQsVgsFSRR11gmM8trimSa3WypzZ31l5v2/vfk/4oAcv9aSGyUSz4gg/AIAOET0YQswIQWaNrnH+2OeSaY0BJN2+wDTi/OpCrwkxX1vW8q63p5cnaaB+Z/09u7x0nFJTVMiEajPsNCQaC6Ryb8THKcw/Tikho6zj//0RGUNV6gMZ1H8fmpH5iTHDlwsiOhO7FrN5RdP6aBIUj/pvJ2bkFbkxAzBzELELNCQQqgrJ5ST1/jqmYOJcHa7dYYGV5TrQ3d+vfUU+b7IfrOIRCGBYD0o1VGmaHaB6DZkqvMD2hUfF1UAISkvE/+yqbCZ89+HgBtwgFOrBUzJgAAAABJRU5ErkJggg==":t+"BI"+n+"BWzo5X"+r+"EAAAOxAGVKw4bAAAKT2"+o+"nVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAAAFJJREFUeNrclEEKACAIBOfp/Xy7i4WSRnRYBIVRVhFJVIhyEAxllQa5E/wBSnsU6Rza2nugqNmASi57C/KKNg/Iqn+iVWzx6M4bOdUEAAD//wMAAYRMfiNaiqEAAAAASUVORK5CYII="}var i=n(1),a=n(0),s=i._BaseDialog,l={},u=i.GC$,c=i._util._createElement,f=i._util,d=f._getPreferredZIndex,p=u(document),h=" btn btn-default",m="ui-state-hover ",g="gc-fill-type-item",_="gc-fill-menu-container",v=m+"gc-smartMenu-item-hover",y=m+"gc-smart-tag-hover",b="ui-icon ui-icon-check gc-check-image",w="gc-menu-item-input",C="ui-state-active gc-smart-tag-active",S="gc-tag-container",x="float",T="left",E="top",M="display",A="width",k="height",R="margin",I="change",O="input[type=radio]",D="mouseover",P="mouseout",N="click",F="fillTypeChanged",L="keydown.ui-fill",H=function(){return a._getResource(l.SR)()},V=function(e){function t(t,n){var o,i=this;e.call(i,t,d(n.parent._host)),i._sheet=n,i._smartTagContainer=u("."+S),o=i._menuContainer=i._getContainer(),o.addClass(_),r(n,"smartMenuCopyCells",g,H().CopyCells,"0",!0).appendTo(o),r(n,"smartMenuFillSeries",g,H().FillSeries,"1").appendTo(o),r(n,"smartMenuFillFormattingOnly",g,H().FillFormattingOnly,"2").appendTo(o),r(n,"smartMenuFillWithoutFormatting",g,H().FillWithoutFormatting,"3").appendTo(o)}u.inherit(t,e);var n={_show:function(){e.prototype._show.call(this)},_attachEvent:function(){var e=this;u("."+g).bind(D,function(){u(this).addClass(v)}).bind(P,function(){u(this).removeClass(v)}).bind(N,function(){var t=u(this),n=e._smartTagContainer,r=t.find(O),o=r[0];o.checked=!0,r.trigger(I),n.trigger(N),n.trigger(P),t.removeClass(v);var i=parseInt(u(o).attr("value"));e._changeFill(i)}),e._menuContainer.find(O).bind(I,function(){u("."+w).removeClass(b),u(this).parent().addClass(b)})},_dettachEvent:function(){u("."+g).unbind(D).unbind(P).unbind(N),this._menuContainer.find(O).unbind(I)},_changeFill:function(e){var t=this,n=t._sheet,r=n._eventHandler;if(t._fillType!==e){t._fillType=e,n._skipCloseDragFillSmartTag=!0,n.suspendEvent();try{i.Commands.undo.execute(n.parent,{sheetName:n.name()})}finally{n.resumeEvent()}n._skipCloseDragFillSmartTag=!1,n._commandManager().execute({cmd:"fill",sheetName:n.name(),startRange:r._dragFillStartRange,fillRange:r._currentFillRange,autoFillType:e,fillDirection:r._currentFillDirection}),t._smartTagContainer.trigger(F,e)}},_isOpen:function(){return!!u("."+_).length}};return u.extend(t.prototype,n),t}(s),j=function(e){function t(t,n,r){var i,a=this;e.call(a,t,d(n.parent._host)),a._sheet=n,a._fillInfo=r,i=a._tagContainer=a._getContainer().addClass("gc-smart-tag-default "+S+" gc-no-user-select ui-widget-header"+h),a._smartTag=u(c("img")).attr("src",o(0)).css(x,T).appendTo(i),a._smartTagDown=u(c("img")).attr("src",o(1)).css([x,M],[T,"none"]).appendTo(i)}u.inherit(t,e);var n={_doMouseEvent:function(e,t,n){var r=this,o=r._sheet._isTouchMode,i=u(t),a=r._menuDialog,s=r._smartTagDown,l=o?"38px":"32px",c=o?"24px":"18px";a&&a._isOpen()||(e?i.addClass(y):i.removeClass(y),i.css([A,k],[e?l:c,c]),n||(e?s.show():s.hide()))},_registerEvent:function(){var e=this,t=e._tagContainer,n=f._device(),r=f._browser.safari&&(n.ipad||n.iphone);t.bind(D,function(){e._doMouseEvent(!0,this,r)}).bind(P,function(){e._doMouseEvent(!1,this,r)}),t.bind(N,function(){var t=u(this),n=e._menuDialog,o=e._smartTagDown;if(n&&n._isOpen())r&&o.hide(),t.removeClass(C),e._closeMenu();else{r&&o.show(),t.addClass(C),e._openMenu();var i=e._menuContainer,a=i&&i.find(O)[e._fillInfo.fillType];a&&!a.checked&&(a.checked=!0,u(a).trigger(I))}}),p.bind(L,function(t){27===t.keyCode&&(e._menuDialog&&e._menuDialog._isOpen()?e._closeMenu():e.close(),f._cancelDefault(t))})},_open:function(){var e=this,t=e._tagContainer,n=e._fillInfo,r=e._sheet._isTouchMode,o=r?"3px":"0px",i=r?"24px":"18px";t&&(t.css([T,E],[n.x,n.y]),e._show(),e._registerEvent(),e._smartTag.css(R,o),e._smartTagDown.css(k,i),e._reset())},_openMenu:function(){var e=this,t=e._sheet;e._menuDialog||(e._menuDialog=new V(t.parent._getContainerDiv(),t),e._menuContainer=e._menuDialog._getContainer());var n=e._tagContainer,r=n.css(T),o=n.css(E),i=parseFloat(o),a=e._menuDialog,s=e._fillInfo;a._fillType=s.fillType,isNaN(i)||(o=i+n.height()+2),e._menuContainer.css([T,E],[r,o]),a._show(),a._attachEvent(),a._smartTagContainer.unbind(F).bind(F,function(e,t){s.fillType=t})},_closeMenu:function(){var e=this._menuDialog;e&&(e._dettachEvent(),e.close())},_reset:function(){var e=this,t=e._menuDialog,n=e._tagContainer;t&&(t._isOpen()&&n.trigger(N),n.trigger(P))},close:function(){var t=this,n=t._sheet;t._reset(),p.unbind(L),e.prototype.close.call(t),n&&n._setFocus()}};return u.extend(t.prototype,n),t}(s);l._FillDialog=j,e.exports=l},function(e,t){e.exports={CopyCells:"Copy Cells",FillSeries:"Fill Series",FillFormattingOnly:"Fill Formatting Only",FillWithoutFormatting:"Fill Without Formatting",Exp_NumberOnly:"Only works for Numbers",Exp_RangeContainsMergedCell:"Range should not have merged cells.",Exp_TargetContainsMergedCells:"Target range should not have merged cells.",Exp_MergedCellsIdentical:"This operation requires the merged cells to be identically sized.",Exp_FillRangeContainsMergedCell:"Cannot fill range that contains a merged cell.",Exp_FillCellsReadOnly:"The cells you are trying to fill are protected and therefore read-only.",Exp_ChangeMergedCell:"Cannot change part of merged cell.",Exp_ColumnReadOnly:"The column you are trying to change is protected and therefore read-only.",Exp_RowReadOnly:"The row you are trying to change is protected and therefore read-only.",Exp_CellReadOnly:"The cell you are trying to change is protected and therefore read-only.",Exp_RangeIsNull:"range is null",Exp_ChangePartOfArray:"Cannot change part of an array."}},function(e,t){function n(e,t){return{name:e,description:t}}e.exports={Fbx_Summary:"Summary",Fbx_TableName_Description:"Table name for ",Fbx_CustomName_Description:"Custom name for ",_tableFunctionsResource:[n("#All","Returns the entire contents of the table, or specified table columns including column headers, data and total rows."),n("#Data","Returns the data cells of the table or specified table columns."),n("#Headers","Returns the columns headers for the table, or specified table columns."),n("#Totals","Returns the total rows for the table or specified table columns."),n("@","This row.")]}},function(e,t,n){function r(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}var o=n(26),i="./zhSR/",a=o.Spread,s=a.Common,l=a.CalcEngine,u=a.Sheets,c=s.SR.ja||{};s.SR.zh=r(c,n(139)(i+"common")),s.SR.zh=r(c,n(141)(i+"formatter")),l.SR.zh=r(c,n(143)(i+"calc")),u.SR.zh=r(c,n(145)(i+"sheet")),u.Bindings.SR.zh=r(c,n(147)(i+"binding")),u.Outlines.SR.zh=r(c,n(149)(i+"outlines")),u.Touch.SR.zh=r(c,n(151)(i+"touch")),u.FloatingObjects.SR.zh=r(c,n(153)(i+"flocatingobject")),u.ConditionalFormatting.SR.zh=r(c,n(155)(i+"conditionalFormats")),u.Filter.SR.zh=r(c,n(157)(i+"filter")),u.Tables.SR.zh=r(c,n(159)(i+"table")),u.Slicers.SR.zh=r(c,n(161)(i+"slicer")),u.Fill.SR.zh=r(c,n(163)(i+"fill")),u.FormulaTextBox.SR.zh=r(c,n(165)(i+"formulaTextBox")),e.exports=o},function(e,t,n){t.Common=n(0),t.Commands=n(40),t.Formatter=n(10),t.Sparklines=n(28),t.Slicers=n(42)},function(e,t,n){var r=n(11),o=n(21)._toHexString,i=Math.min,a=Math.max,s=Math.abs,l=parseInt,u=function(){function e(){}return e._toString=function(e){var t=e.a,n=e.r,r=e.g,i=e.b;return 3===arguments.length&&(t=255,n=arguments[0],r=arguments[1],i=arguments[2]),4===arguments.length&&(t=arguments[0],n=arguments[1],r=arguments[2],i=arguments[3]),255===t?"#"+o(n,!0,2)+o(r,!0,2)+o(i,!0,2):"rgba("+n+","+r+","+i+","+t+")"},e._compare=function(e,t){return e.a===t.a&&e.r===t.r&&e.g===t.g&&e.b===t.b},e._getBrightness=function(t){var n=e._fromString(t);return(299*n.r+587*n.g+114*n.b)/1e3},e._hueToRGB=function(e,t,n){return n<0&&(n+=240),n>240&&(n-=240),n<40?e+((t-e)*n+20)/40:n<120?t:n<160?e+((t-e)*(160-n)+20)/40:e},e._fromHLS=function(t,n,r){function o(t,n,r){return parseInt((255*e._hueToRGB(t,n,r)+120)/240,10)}var i,a,s;if(0===r)i=a=s=l(255*n/240,10);else{var u,c;c=n<=120?(n*(240+r)+120)/240:n+r-(n*r+120)/240,u=2*n-c,i=o(u,c,t+80),a=o(u,c,t),s=o(u,c,t-80)}return{a:255,r:i,g:a,b:s}},e._isTwoColorSimilar=function(e,t){var n=255-s(e.r-t.r),r=255-s(e.g-t.g),o=255-s(e.b-t.b),i=s(e.a-t.a);return n/=255,r/=255,o/=255,!!((n+r+o)/3>=.9&&i<=.05)},e._invertColor=function(t){var n=255^t.r,r=255^t.g,o=255^t.b;return e._toString(t.a,n,r,o)},e._fromString=function(t){function n(t){var n=e._ctx;if(!n){var r=document.createElement("canvas");r&&r.getContext&&(n=e._ctx=r.getContext("2d"))}return n?(n.fillStyle=t,t=n.fillStyle):t}function r(e){var t=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i,r=/^#([0-9a-f])([0-9a-f])([0-9a-f])$/i,o=/^rgb\(([\s\d]*),([\s\d]*),([\s\d]*)\)$/i,i=/^rgba\(([\s\d]*),([\s\d]*),([\s\d]*),([\s\d]*)\)$/i,a=function(e){return l(e,16)},s=function(e){return l(e+e,16)},u=function(e){return e.indexOf("%")>0?2.55*parseFloat(e):0|e},c=n(e),f=RegExp;if(t.test(c))return[f.$1,f.$2,f.$3].map(a);if(i.test(c)){var d=[f.$1,f.$2,f.$3].map(u);return d.splice(0,0,255*parseFloat(f.$4)),d}return o.test(c)?[f.$1,f.$2,f.$3].map(u):r.test(c)?[f.$1,f.$2,f.$3].map(s):null}if(t instanceof e)return t;var o=0,i=0,a=0,s=0;if(t&&""!==t){var u=r(t);u&&(3===u.length?(o=255,i=u[0],a=u[1],s=u[2]):4===u.length&&(o=u[0],i=u[1],a=u[2],s=u[3]))}return{a:o,r:i,g:a,b:s}},e._applyTint=function(t,n){if(0===n)return t;var r=new c(t),o=l(n>0?(240-r._luminosity)*n:r._luminosity*n,10);return e._fromHLS(r._hue,r._luminosity+o,r._saturation)},e._getLighterColor=function(t,n){var r=e._fromString(t),o=new c(r),i=o._getLighterColor(n);return e._toString(i)},e}(),c=function(){function e(e){var t=this,n=e.r,r=e.g,o=e.b,s=a(a(n,r),o),u=i(i(n,r),o),c=s+u;t._luminosity=l((240*c+255)/510,10);var f=s-u;if(0===f)t._saturation=0,t._hue=160;else{t._luminosity<=120?t._saturation=l((240*f+c/2)/c,10):t._saturation=l((240*f+(510-c)/2)/(510-c),10);var d=(40*(s-n)+f/2)/f,p=(40*(s-r)+f/2)/f,h=(40*(s-o)+f/2)/f;t._hue=n===s?l(h-p,10):r===s?l(80+d-h,10):l(160+p-d,10),t._hue<0&&(t._hue+=240),t._hue>240&&(t._hue-=240)}}return e.prototype={constructor:e,_getLighterColor:function(e){var t=this,n=t._luminosity,r=t._newLuma(t._luminosity,500,!0);return u._fromHLS(t._hue,n+(r-n)*e,t._saturation)},_newLuma:function(e,t,n){return 0===t?e:n?t>0?(e*(1e3-t)+241*t)/1e3:e*(t+1e3)/1e3:(e+=240*t/1e3,e<0&&(e=0),e>240&&(e=240),e)}},e}();r._ColorHelper=u,e.exports=r},function(e,t){function n(e){return e}function r(e,t,n,r,o,i,a,s,u,d,p){var h,m,g,_,v,y,b,w,C,S,x,T,E,M,A,k,R=n[c],I=n[f],O=t[c],D=t[f],P=r[c],N=r[f],F=1===I,L=1===D;if(O===R&&D===I){var H=0,V=0,j=0,B=0;for(b=R*I,h=0;h<R;h++)for(m=0;m<I;m++){if(_=i(n[h][m]),v=i(t[h][m]),e&&(l(_)||l(v)))return u;v=d(v),H+=_,V+=_*_,j+=v,B+=_*v}for(y=o?(b*B-H*j)/(b*V-H*H):B/V,w=o?(j*V-H*B)/(b*V-H*H):0,C=[],h=0;h<P;h++)for(C[h]=[],m=0;m<N;m++){if(_=i(r[h][m]),e&&l(_))return u;C[h][m]=p(y*_+w)}return a?new a(C):C}if(F&&O===R||1===O&&D===I){for(_=[],v=[],A=I+1,k=I+2,h=0;h<R;h++){if(x=F?t[h][0]:t[0][h],w=i(x),e&&l(w))return u;v[h]=F?d(w):w}for(h=0;h<R;h++)for(_[h]=[],m=0;m<I;m++){if(w=i(n[h][m]),e&&l(w))return u;_[h][m]=w}var U=[];for(y=0;y<A;y++)for(U[y]=[],b=0;b<k;b++)U[y][b]=0;for(g=0;g<R;g++)for(U[0][A]+=v[g],h=0;h<I;h++)for(x=h+1,U[0][x]+=_[g][h],U[x][0]=U[0][x],U[x][A]+=_[g][h]*v[g],m=h;m<I;m++)E=m+1,U[E][x]+=_[g][h]*_[g][m],U[x][E]=U[E][x];U[0][0]=R;var W=o?0:1;for(S=W;S<A;S++){if(e){if(0===U[h][h]){for(M=!1,m=h+1;!M&&m<A;m++)if(0!==U[m][h]){for(g=0;g<k;g++)E=U[h][g],U[h][g]=U[m][g],U[m][g]=E;M=!0}if(!M)return s}}else{for(h=S;h<A&&0===U[h][S];)h++;if(h>=A)return s;for(T=W;T<k;T++)x=U[S][T],U[S][T]=U[h][T],U[h][T]=x}for(x=1/U[S][S],T=W;T<k;T++)U[S][T]*=x;for(h=W;h<A;h++)if(h!==S)for(x=-U[h][S],T=0;T<k;T++)U[h][T]+=x*U[S][T];!o&&(U[0][A]=0)}for(C=[],!L&&(C[0]=[]),h=0;h<P;h++){for(L&&(C[h]=[]),x=U[0][A],m=0;m<I;m++){if(x=L?r[h][m]:r[m][h],w=i(x),e&&l(w))return u;x+=U[m+1][A]*w}L?C[h][0]=p(x):C[0][h]=p(x)}return a?new a(C):C}return s}function o(e,t,n,r,o,i,a,s,l,u,d){function p(e){e=e.toString();var t=e.split(".");return parseInt(t[t.length-1])}function h(e,t){if(parseInt(t)<0)return e;e=e.toString();var n=e.split(".");return n[n.length-1]=t,n.join(".")}var m,g,_,v,y,b,w,C,S=n[c],x=n[f],T=t[c],E=t[f],M=r[c],A=r[f];if(T===S&&E===x){var k=0,R=0,I=0,O=0;for(b=S*x,m=0;m<S;m++)for(g=0;g<x;g++)_=i(n[m][g]),v=t[m][g],v=p(v),k+=_,R+=_*_,I+=v,O+=_*v;for(y=o?(b*O-k*I)/(b*R-k*k):O/R,w=o?(I*R-k*O)/(b*R-k*k):0,C=[],m=0;m<M;m++)for(C[m]=[],g=0;g<A;g++)_=i(r[m][g]),C[m][g]=h(t[m][g],y*_+w);return a?new a(C):C}return s}function i(e,t,o,i,a,s,l,u){return r(!0,e,t,o,i,a,s,u,l,n,n)}function a(e,t,r,i,a,s,l,u){return o(!0,e,t,r,i,a,s,u,l,n,n)}function s(e,t,o,i,a,s,l){var u,d;for(u=0;u<e[c];u++)for(d=0;d<e[f];d++)if(e[u][d]<=0)return s;return r(!1,e,t,o,i,n,a,l,null,Math.log,Math.exp)}var l=isNaN,u={},c="rowCount",f="colCount";u._trend=i,u._growth=s,u._trendSerial=a,e.exports=u},function(e,t){function n(e,t){var n=this;n._owner=e,n._cmdDef=t,Object.defineProperty(n,"shortcutKey",{get:function(){return n._shortcutKey},set:function(e){var t=n._shortcutKey;if(t!==e){var r=n._owner._shortcutKeys,o=r[t];if(o){var i=o.indexOf(n);i>=0&&o.splice(i,1)}n._shortcutKey=e,e&&(o=r[e],o||(r[e]=o=[]),o.splice(0,0,n))}}})}function r(e){var t=this;t._context=e,t._listeners={},t._shortcutKeys={}}var t={};t.Key={left:37,right:39,up:38,down:40,tab:9,enter:13,shift:16,ctrl:17,space:32,altkey:18,home:36,end:35,pup:33,pdn:34,backspace:8,del:46,esc:27,a:65,c:67,v:86,x:88,z:90,y:89},n.prototype={canUndo:function(){return this._cmdDef.canUndo},execute:function(e,t,n,r){var o=this,i=!0;try{var a=o._cmdDef.execute||o._cmdDef,s=a(e,t,1===n,r);i=!1!==s}catch(e){i=!1}return t&&i&&o._owner._commandExecuted({command:t,result:s,_actionType:n}),s}},r.prototype={register:function(e,t,r,o,i,a,s){var l=this,u=new n(l,t);l[e]=u,r&&(u.shortcutKey=l.getShortcutKey(r,o,i,a,s))},execute:function(e){var t=this[e.cmd];if(t)return t.execute(this._context,e,0)},setShortcutKey:function(e,t,n,r,o,i){var a=this;if(e){var s=a[e];s&&(s.shortcutKey=a.getShortcutKey(t,n,r,o,i))}else{var l=a.getShortcutKey(t,n,r,o,i),u=a.getCommands(l);if(u)for(var c=u.length-1;c>=0;c--)u[c].shortcutKey=void 0}},getShortcutKey:function(e,n,r,o,i){if(e){var a="A".charCodeAt(0)<=e&&e<="Z".charCodeAt(0)?String.fromCharCode(e):t.Key[e];return a||(a=e),a+(n?"+ctrl":"")+(r?"+shift":"")+(o?"+alt":"")+(i?"+window":"")}},getCommands:function(e){return this._shortcutKeys[e]},addListener:function(e,t){this._listeners[e]=t},removeListener:function(e){delete this._listeners[e]},_commandExecuted:function(e){var t=this._listeners;for(var n in t)t.hasOwnProperty(n)&&t[n](e)}},t.CommandManager=r,e.exports=t},function(e,t){function n(e,t,n){var r=this;r._context=e,t<0&&(t=2147483647),r._maxLength=t,r._allowUndo=n,r._undoStack=[],r._redoStack=[]}n.prototype={_addCommand:function(e,t){var n=this;if(e)if(1===t)n._redoStack.push(e);else{var r=n._maxLength,o=n._undoStack.length;if(r>0&&o>=r)for(var i=0;i<o-r+1;i++)n._undoStack.shift();n._undoStack.push(e),0===t&&(n._redoStack=[])}},canUndo:function(){return this._undoStack.length>0},undo:function(){var e=this,t=e._undoStack,n=!0;if(e._allowUndo&&e.canUndo()){var r=t[t.length-1];try{var o=e._context.commandManager()[r.cmd];o&&(n=o.execute(e._context,r,1))}catch(e){n=!1}!1!==n&&t.pop()}return n},canRedo:function(){return this._redoStack.length>0},redo:function(){var e=this,t=e._redoStack,n=!0;if(e._allowUndo&&e.canRedo()){var r=t[t.length-1];try{var o=e._context.commandManager()[r.cmd];o&&(n=o.execute(e._context,r,2))}catch(e){n=!1}!1!==n&&t.pop()}return n},clear:function(){this._undoStack=[],this._redoStack=[]}},e.exports.UndoManager=n},function(e,t,n){function r(e,t,n){return e.substr(t,n)}function o(e){return R._isNullOrUndefined(e)?"":"boolean"==typeof e?e?"TRUE":"FALSE":"string"==typeof e?e:e.toString()}function i(e,t){if("\\"===e[t])throw new Error(L().Exp_InvalidBackslash);if(t-1>0&&t-1<e.length&&"\\"===e[t-1]){if(t-2<0)return!0;if(t-2>0&&t-2<e.length)return"\\"!==e[t-2]}return!1}function a(e){if(!e)throw new Error(L().Exp_TokenIsNull);return"["+e+"]"}function s(e){if(e===T||e===x||""===e)return e;for(var t="",n=0,r=0;r<e.length;r++){var o=e[r];"["===o?n++:"]"===o?--n<0&&(n=0):0===n&&(t+=o)}return t.toString()}function l(e){return e=u(e,"[",""),u(e,"]","")}function u(e,t,n){return!e||e===W._Empty||f(t,n,!0)?e:(t=t.replace(G,"\\$1"),e.replace(new RegExp(t,"g"),n))}function c(e){for(var t=e.length,n=!1,r="",o=0;o<t;o++){var i=e.charAt(o);"\\"===i?(n=!n)||(r+=i):(n=!1,r+=i)}return r}function f(e,t,n){return n?B(e)===B(t):e===t}function d(e,t){1===arguments.length&&(t=!0);for(var n=!1,r="",o=0;o<e.length;o++){var a=e[o];if('"'===a)n=!n;else if(!n&&!((t||"?"!==a&&"/"!==a)&&"_"!==a&&"*"!==a||i(e,o))){"_"===a&&o++;continue}r+=a}return r}function p(e,t){if(!e||e===W._Empty)return!1;for(var n=d(e),r="",o=!1,i=0,a=n.length;i<a;i++){var s=n[i];'"'===s&&(o=!o),"E"===s||o||(r+=B(s))}for(var l=0;l<t.length;l++)if(r===t[l]||r.indexOf(t[l])>=0)return!0;return!1}function h(e,t,n){this._partLocaleID=e,this._partDBNumberFormat=t,this.cultureName=n}function m(e){this._originalToken=e}function g(e){var t,n=l(e);return n&&n!==W._Empty?(["<",">","="].indexOf(n[0])>-1?(t=q,t.Name="ConditionalFormatPart"):A._startsWith(n,"DBNum",!0)?(t=Q,t.Name="DBNumberFormatPart"):f(n[0],"$",!1)?(t=$,t.Name="LocaleIDFormatPart"):v(n)?(t=Z,t.Name="ABSTimeFormatPart"):n.length>=3&&(t=J,t.Name="ColorFormatPart"),t):t}function _(e){var t,n=!1;return e=e?e.toString():W._Empty,p(e,["general"])?t=ae:te._evaluateFormat(e)?t=te:p(e,["E+","E-","#",".",",","%","0","/"])?(n=!0,t=ie):(n=!0,t=oe),{_isDigitalOrText:n,_type:t}}function v(e){var t=B(e),n=t[0];if("h"!==n&&"m"!==n&&"s"!==n)return!1;for(var r=1;r<t.length;r++)if(n!==t[r])return!1;return!0}function y(e,t,n){var r;r=e?e.cultureInfo():H(n);var o=r.NumberFormat.dbNumber;return o?o[t]:x}function b(e,t,n,r,o){var i=e;if(!D(r)&&t instanceof Date){var a=y(n,r.type,o);i=r._replaceNumberString(i,a,!0),1===r.type&&(i=i.replace(new RegExp(N,"g"),F)),i=i.replace("@"+ne._yearFourDigit,k._localeFormat(t,ne._yearFourDigit)),i=i.replace("@"+ne._yearTwoDigit,k._localeFormat(t,ne._yearTwoDigit)),i=r._replaceNumberString(i,a,!1)}return i}function w(e,t,n,r,o){if(!D(r)){var i=y(n,r.type,o);if(!D(i)){var a,s=r._replaceNumberString(e,i,t),l=H(o);return"ja-JP"===l.name()&&s.length>1&&("一千"===(a=s.substr(0,2))||"一百"===a||"一十"===a)&&(s=s.substr(1)),s}}return e}var C=n(0),S=n(27),x=null,T=void 0,E=Math.abs,M={},A=C._StringHelper,k=C._DateTimeHelper,R=C._Types,I=R._isType,O=C._NumberHelper,D=R._isNullOrUndefined,P=C.CultureManager,N="一十",F="十",L=function(){return C._getResource(M.SR)()},H=function(e){return P._getCultureInfo(e)},V=function(e){return H(e).DateTimeFormat},j=function(e){return H(e).NumberFormat},B=function(e){return e&&e.toLowerCase()},U=function(){throw new Error(L().Exp_FormatIllegal)},W={_Empty:"",_format:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(0===arguments.length)return x;for(var n=e[0],r=1;r<arguments.length;r++){var o=new RegExp("\\{"+(r-1)+"\\}","gm");n=n.replace(o,arguments[r])}return n},_isNullOrEmpty:function(e){return!e||e===W._Empty}},z={_isDigit:function(e){var t=e.charCodeAt(0);return t>=48&&t<=57},_isWhiteSpace:function(e){var t=e.charCodeAt(0);return t>=9&&t<=13||32===t||133===t||160===t}},Y={_positive:0,_negative:1,_zero:2,_text:3},G=new RegExp("([.+?*$^\\[\\](){}|/])","g"),K=[["M/d","MMM/d","MMMM/d","d/M","d/MMM","d/MMMM","M-d","MMM-d","MMMM-d","d-M","d-MMM","d-MMMM"],["M/y","MMM/y","M/yyyy","MMM/yyyy","M-y","MMM-y","M-yyyy","MMM-yyyy"],["M/d/y","MMM/d/y","MMMM/d/y","M/d/yyyy","MMM/d/yyyy","MMMM/d/yyyy","d/M/y","d/MMM/y","d/MMMM/y","d/M/yyyy","d/MMM/yyyy","d/MMMM/yyyy","yyyy/M/d","M-d-y","MMM-d-y","MMMM-d-y","M-d-yyyy","MMM-d-yyyy","MMMM-d-yyyy","d-M-y","d-MMM-y","d-MMMM-y","d-M-yyyy","d-MMM-yyyy","d-MMMM-yyyy","yyyy-M-d"],["H:m","h:m tt"],["H:m:s","h:m:s tt","H:m:s","h:mm:ss tt"],["H:m:s.FFF","h:m:s.FFF tt"],["M/d H:m","MMM/d H:m","MMMM/d H:m","d/M H:m","d/MMM H:m","d/MMMM H:m","M/y H:m","MMM/y H:m","M/yyyy H:m","MMM/yyyy H:m","M/d/y H:m","MMM/d/y H:m","MMMM/d/y H:m","M/d/yyyy H:m","MMM/d/yyyy H:m","MMMM/d/yyyy H:m","M-d H:m","MMM-d H:m","MMMM-d H:m","d-M H:m","d-MMM H:m","d-MMMM H:m","M-y H:m","MMM-y H:m","M-yyyy H:m","MMM-yyyy H:m","M-d-y H:m","MMM-d-y H:m","MMMM-d-y H:m","M-d-yyyy H:m","MMM-d-yyyy H:m","MMMM-d-yyyy H:m","M/d h:m tt","MMM/d h:m tt","MMMM/d h:m tt","d/M h:m tt","d/MMM h:m tt","d/MMMM h:m tt","M/y h:m tt","MMM/y h:m tt","M/yyyy h:m tt","MMM/yyyy h:m tt","M/d/y h:m tt","MMM/d/y h:m tt","MMMM/d/y h:m tt","M/d/yyyy h:m tt","MMM/d/yyyy h:m tt","MMMM/d/yyyy h:m tt","M-d h:m tt","MMM-d h:m tt","MMMM-d h:m tt","d-M h:m tt","d-MMM h:m tt","d-MMMM h:m tt","M-y h:m tt","MMM-y h:m tt","M-yyyy h:m tt","MMM-yyyy h:m tt","M-d-y h:m tt","MMM-d-y h:m tt","MMMM-d-y h:m tt","M-d-yyyy h:m tt","MMM-d-yyyy h:m tt","MMMM-d-yyyy h:m tt"],["M/d H:m:s","MMM/d H:m:s","MMMM/d H:m:s","d/M H:m:s","d/MMM H:m:s","d/MMMM H:m:s","M/y H:m:s","MMM/y H:m:s","M/yyyy H:m:s","MMM/yyyy H:m:s","M/d/y H:m:s","MMM/d/y H:m:s","MMMM/d/y H:m:s","M/d/yyyy H:m:s","MMM/d/yyyy H:m:s","MMMM/d/yyyy H:m:s","d/M/y H:m:s","d/MMM/y H:m:s","d/MMMM/y H:m:s","d/M/yyyy H:m:s","d/MMM/yyyy H:m:s","d/MMMM/yyyy H:m:s","yyyy/M/d H:m:s","M-d H:m:s","MMM-d H:m:s","MMMM-d H:m:s","d-M H:m:s","d-MMM H:m:s","d-MMMM H:m:s","M-y H:m:s","MMM-y H:m:s","M-yyyy H:m:s","MMM-yyyy H:m:s","M-d-y H:m:s","MMM-d-y H:m:s","MMMM-d-y H:m:s","M-d-yyyy H:m:s","MMM-d-yyyy H:m:s","MMMM-d-yyyy H:m:s","d-M-y H:m:s","d-MMM-y H:m:s","d-MMMM-y H:m:s","d-M-yyyy H:m:s","d-MMM-yyyy H:m:s","d-MMMM-yyyy H:m:s","yyyy-M-d H:m:s","M/d h:m:s tt","MMM/d h:m:s tt","MMMM/d h:m:s tt","d/M h:m:s tt","d/MMM h:m:s tt","d/MMMM h:m:s tt","M/y h:m:s tt","MMM/y h:m:s tt","M/yyyy h:m:s tt","MMM/yyyy h:m:s tt","M/d/y h:m:s tt","MMM/d/y h:m:s tt","MMMM/d/y h:m:s tt","M/d/yyyy h:m:s tt","MMM/d/yyyy h:m:s tt","MMMM/d/yyyy h:m:s tt","d/M/y h:m:s tt","d/MMM/y h:m:s tt","d/MMMM/y h:m:s tt","d/M/yyyy h:m:s tt","d/MMM/yyyy h:m:s tt","d/MMMM/yyyy h:m:s tt","yyyy/M/d h:m:s tt","M/d/yyyy h:mm:ss tt","M-d h:m:s tt","MMM-d h:m:s tt","MMMM-d h:m:s tt","d-M h:m:s tt","d-MMM h:m:s tt","d-MMMM h:m:s tt","M-y h:m:s tt","MMM-y h:m:s tt","M-yyyy h:m:s tt","MMM-yyyy h:m:s tt","M-d-y h:m:s tt","MMM-d-y h:m:s tt","MMMM-d-y h:m:s tt","M-d-yyyy h:m:s tt","MMM-d-yyyy h:m:s tt","MMMM-d-yyyy h:m:s tt","d-M-y h:m:s tt","d-MMM-y h:m:s tt","d-MMMM-y h:m:s tt","d-M-yyyy h:m:s tt","d-MMM-yyyy h:m:s tt","d-MMMM-yyyy h:m:s tt","yyyy-M-d h:m:s tt"],["M/d H:m:s.FFF","MMM/d H:m:s.FFF","MMMM/d H:m:s.FFF","d/M H:m:s.FFF","d/MMM H:m:s.FFF","d/MMMM H:m:s.FFF","M/y H:m:s.FFF","MMM/y H:m:s.FFF","M/yyyy H:m:s.FFF","MMM/yyyy H:m:s.FFF","d/M/y H:m","d/MMM/y H:m","d/MMMM/y H:m","d/M/yyyy H:m","d/mmm/yyyy H:m","d/MMMM/yyyy H:m","yyyy/M/d H:m","M/d/y H:m:s.FFF","MMM/d/y H:m:s.FFF","MMMM/d/y H:m:s.FFF","M/d/yyyy H:m:s","MMM/d/yyyy H:m:s.FFF","MMMM/d/yyyy H:m:s.FFF","d/M/y H:m:s.FFF","d/MMM/y H:m:s.FFF","d/MMMM/y H:m:s.FFF","d/M/yyyy H:m:s.FFF","d/MMM/yyyy H:m:s.FFF","d/MMMM/yyyy H:m:s.FFF","yyyy/M/d H:m:s.FFF","M-d H:m:s.FFF","MMM-d H:m:s.FFF","MMMM-d H:m:s.FFF","d-M H:m:s.FFF","d-MMM H:m:s.FFF","d-MMMM H:m:s.FFF","M-y H:m:s.FFF","MMM-y H:m:s.FFF","M-yyyy H:m:s.FFF","MMM-Yyyy H:m:s.FFF","d-M-y H:m","d-MMM-y H:m","d-MMMM-y H:m","d-M-yyyy H:m","d-MMM-yyyy H:m","d-MMMM-yyyy H:m","yyyy-M-d H:m","M-d-y H:m:s.FFF","MMM-d-y H:m:s.FFF","MMMM-d-y H:m:s.FFF","M-d-yyyy H:m:s","MMM-d-yyyy H:m:s.FFF","MMMM-d-yyyy H:m:s.FFF","D-M-y H:m:s.FFF","d-MMM-y H:m:s.FFF","d-MMMM-y H:m:s.FFF","D-M-yyyy H:m:s.FFF","d-MMM-yyyy H:m:s.FFF","d-MMMM-yyyy H:m:s.FFF","yyyy-M-d H:m:s.FFF","M/d h:m:s.FFF tt","MMM/d h:m:s.FFF tt","MMMM/d h:m:s.FFF tt","d/M h:m:s.FFF tt","d/MMM h:m:s.FFF tt","d/MMMM h:m:s.FFF tt","M/y h:m:s.FFF tt","MMM/y h:m:s.FFF tt","M/yyyy h:m:s.FFF tt","MMM/yyyy h:m:s.FFF tt","d/M/y h:m tt","d/MMM/y h:m tt","d/MMMM/y h:m tt","d/M/yyyy h:m tt","d/mmm/yyyy h:m tt","d/MMMM/yyyy h:m tt","yyyy/M/d h:m tt","M/d/y h:m:s.FFF tt","MMM/d/y h:m:s.FFF tt","MMMM/d/y h:m:s.FFF tt","M/d/yyyy h:m:s tt","MMM/d/yyyy h:m:s.FFF tt","MMMM/d/yyyy h:m:s.FFF tt","d/M/y h:m:s.FFF tt","d/MMM/y h:m:s.FFF tt","d/MMMM/y h:m:s.FFF tt","d/M/yyyy h:m:s.FFF tt","d/MMM/yyyy h:m:s.FFF tt","d/MMMM/yyyy h:m:s.FFF tt","yyyy/M/d h:m:s.FFF tt","M-d h:m:s.FFF tt","MMM-d h:m:s.FFF tt","MMMM-d h:m:s.FFF tt","d-M h:m:s.FFF tt","d-MMM h:m:s.FFF tt","d-MMMM h:m:s.FFF tt","M-y h:m:s.FFF tt","MMM-y h:m:s.FFF tt","M-yyyy h:m:s.FFF tt","MMM-Yyyy h:m:s.FFF tt","d-M-y h:m tt","d-MMM-y h:m tt","d-MMMM-y h:m tt","d-M-yyyy h:m tt","d-MMM-yyyy h:m tt","d-MMMM-yyyy h:m tt","yyyy-M-d h:m tt","M-d-y h:m:s.FFF tt","MMM-d-y h:m:s.FFF tt","MMMM-d-y h:m:s.FFF tt","M-d-yyyy H:m:s tt","MMM-d-yyyy H:m:s.FFF tt","MMMM-d-yyyy h:m:s.FFF tt","d-M-y h:m:s.FFF tt","d-MMM-y h:m:s.FFF tt","d-MMMM-y h:m:s.FFF tt","d-M-yyyy h:m:s.FFF tt","d-MMM-yyyy h:m:s.FFF tt","d-MMMM-yyyy h:m:s.FFF tt","yyyy-M-d h:m:s.FFF tt"]],X=function(){return{pattern:K,formatter:["d-mmm","mmm-yy",V().shortDatePattern,"h:mm","HH:mm:ss","h:mm:ss.0",V().shortDatePattern+" h:mm",V().shortDatePattern+" HH:mm:ss",V().shortDatePattern+" h:mm:ss.0"]}},q=function(){function e(e,n){m.call(this,n);for(var r,o,i,a=this,s=["<=","<>",">=",">","<","="],l=0,u=s.length;l<u;l++)if(r=s[l],A._startsWith(e,r,!0)){o=A._remove(e,0,r.length);var c=parseFloat(o);isNaN(c)||(i=c);break}if(i===x&&i===T)throw new Error(L().Exp_TokenIllegal);a.value=i,a._compareOperator=r,a.isMeetCondition=t(a)}function t(e){var t="var self = this;",n=e._compareOperator;return n="<>"===n?"!=":n,n="="===n?"===":n,t+="return value "+n+" self.value;",new Function(["value"],t)}return e.Name="ConditionalFormatPart",e.prototype={toString:function(){return a(this._compareOperator+this.value.toString())}},e}(),J=function(){function e(e,t){m.call(this,t),this.foreColor=e}return e.Name="ColorFormatPart",e.prototype.toString=function(){return a(this.foreColor)},e}(),Z=function(e,t){m.call(this,t);var n,r=this,o=B(e)[0];if("h"===o)n=3600;else if("m"===o)n=60;else{if("s"!==o)throw new Error(L().Exp_TokenIllegal);n=1}r._getTimeSpan=function(e){return Math.floor(e/1e3/n)}};Z.Name="ABSTimeFormatPart";var Q=function(){function e(e,t){m.call(this,t);var n=this;if(n.token=e,n.type=parseInt(A._remove(e,0,"dbnum".length),10),n.type<0||n.type>3)throw new Error(L().Exp_TokenIllegal)}function t(e,t,r){var o=e.split(".");if(o){if(1===o.length)return n(o[0],t.numbers,r?t.letters:x);if(2===o.length){return n(o[0],t.numbers,r?t.letters:x)+"."+n(o[1],t.numbers)}}throw new Error(L().Exp_ValueIllegal)}function n(e,t,o){var i=e,a=0,s=x,l=0;if(2===arguments.length){var u="";for(a=0;a<i.length;a++)s=r(i,a,1),l=parseInt(s,10),u+=t[l];return u}if(3===arguments.length){if(!o)return n(e,t);var c=0,f="",d=i.length,p=!1,h=[];for(a=0;a<d;a++){var m=o.length-1-a;m>-1?h.push(o[m].toString()):h.push(W._Empty)}for(var g=[],_=h.length-1;_>=0;_--)g[h.length-_-1]=h[_];h=g;var v=!1;for(_=0;_<d;_++){s=r(i,_,1),l=parseInt(s,10);var y=W._Empty,b=W._Empty;d-_-16>0?(y=t[l],b="",v=!0):_!==d-1&&_!==d-5&&_!==d-9&&_!==d-13?"0"===s?(y="",b="",c+=1):"0"!==s&&0!==c?(y=t[0]+t[l],b=h[_],c=0):(y=t[l],b=h[_],c=0):"0"!==s&&0!==c?(y=t[0]+t[l],b=h[_],c=0):"0"!==s&&0===c||v?(y=t[l],b=h[_],c=0,v=!1):"0"===s&&c>=3?(y="",b="",c+=1):d>=11?(y="",c+=1):(y="",b=h[_],c+=1);y+b===W._Empty||(p=!1),_!==d-13||p||(b=h[_],p=!0),_!==d-9||p||(b=h[_],p=!0),_===d-1&&(b=h[_],p=!0),f=f+y+b}var w=parseInt(e,10);return isNaN(w)||0!==w?f:t[0]}}return e.Name="DBNumberFormatPart",e.prototype={_replaceNumberString:function(e,n,o){if(!e||e===W._Empty)return e;for(var i=e,a=e,s=-1,l=-1,u=!1,c=x,d=x,p=x,h=e.length-1;h>=0;h--){var m=a[h];!isNaN(m)||f(m,".",!1)&&!u?(f(m,".",!1)&&(u=!0),-1===s&&(s=h),l=h):l>-1&&s>-1&&(c=r(a,l,s-l+1),d=parseFloat(c),isNaN(d)||(p=t(c,n,o),i=A._remove(i,l,s-l+1),i=A._insert(i,l,p)),s=-1,l=-1,u=!1)}return l>-1&&s>-1&&(c=r(a,l,s-l+1),d=parseFloat(c),isNaN(d)||(p=t(c,n,o),i=A._remove(i,l,s-l+1),i=A._insert(i,l,p)),s=-1,l=-1,u=!1),i},toString:function(){if(this.type>-1)return a("DBNum"+this.type);throw new Error}},e}(),$=function(){function e(e,t){m.call(this,t);var n=this;n._content=e;var o=n._content,i=f(o[0],"$",!1),a=o.indexOf("-");if(!(i&&a>-1))throw new Error(L().Exp_TokenIllegal);n._currencySymbol=r(o,1,a-1),o=A._remove(o,0,a+1),o.length>0&&(n._locateID=parseInt(o,16))}return e.Name="LocaleIDFormatPart",e.prototype={cultureInfo:function(){var e=this;return e._cultureInfo||(e._cultureInfo=H(e._locateID),e._currencySymbol&&e._currencySymbol!==W._Empty&&(e._cultureInfo.NumberFormat.isReadOnly||(e._cultureInfo.NumberFormat.currencySymbol=e._currencySymbol))),e._cultureInfo},currencySymbol:function(){return this._currencySymbol?A._replace(this._currencySymbol,"\\.","'.'"):W._Empty},allowScience:function(){if(this._cultureInfo)return!(0===this._cultureInfo.name().indexOf("ja")||0===this._cultureInfo.name().indexOf("zh"))},toString:function(){return this._content?a(this._content):W._Empty}},e}(),ee=function(){function e(e,t){this.formatCached=e,this.cultureName=t,this.typeName=""}return e.prototype={format:function(e,t){return x},parse:function(e){return x},formatString:function(){return this.formatCached},toJSON:function(){var e={};for(var t in this)this.hasOwnProperty(t)&&(e[t]=this[t]);return e},fromJSON:function(e){if(e)for(var t in e)e[t]!==T&&(this[t]=e[t])}},e}(),te=function(){function e(e,t,n,r,o){h.call(this,t,n,r);var i=this;i._formatString=i._fixFormat(d(e)),i._absTimeParts=o,i._formatType=2,i._init()}function t(e){return A._indexOf(e,ne._hoursSingleDigit[0],!0)>-1||A._indexOf(e,ne._secondSingleDigit[0],!0)>-1}function n(e){return A._indexOf(e,ne._yearTwoDigit[0],!0)>-1||A._indexOf(e,ne._daySingleDigit[0],!0)>-1}return e.prototype={_init:function(){var t=this,n={_value:t._formatString};if(e._evaluateFormat(n._value)){var r=t._processAMPM(n);if(t.hasJD=t._replace(n._value,ne._monthJD,'"'+ne._placeholderMonthJD+'"',!0,!1,n,!1),t._replace(n._value,ne._monthUnabbreviated,"MMMM",!0,!1,n,!1),t._replace(n._value,ne._monthAbbreviation,"MMM",!0,!1,n,!1),t._replace(n._value,ne._monthTwoDigit,"MM",!0,!1,n,!1),t._replace(n._value,ne._monthSingleDigit,"M",!0,!1,n,!1),t._replace(n._value,ne._dayWeekDayAbbreviation,"ddd",!0,!0,n,!0),t._replace(n._value,ne._dayWeekDayUnabbreviated,"dddd",!0,!0,n,!0),r||(t._replace(n._value,ne._hoursSingleDigit,"H",!0,!0,n,!1),t._replace(n._value,ne._hoursTwoDigit,"HH",!0,!0,n,!1)),t._partDBNumberFormat&&t._partLocaleID&&(t._hasYearDelay=t._hasYearDelay||t._replace(n._value,ne._yearFourDigit,'"@'+ne._yearFourDigit+'"',!0,!1,n,!0),t._hasYearDelay=t._hasYearDelay||t._replace(n._value,ne._yearTwoDigit,'"@'+ne._yearTwoDigit+'"',!0,!1,n,!0)),t._absTimeParts)for(var o=0;o<t._absTimeParts.length;o++){var i=t._absTimeParts[o];t._replace(n._value,i._originalToken,"@"+i._originalToken,!0,!0,n,!0)}t._validDateTimeFormatString=n._value}else U()},formatString:function(){return this._formatString},format:function(e){var t=this,n=W._Empty,i=x;try{if(i=k._DT(e),i?e=i:n=e.toString(),i){if(n=k._customCultureFormat(i,t._validDateTimeFormatString,t._partLocaleID&&t._partLocaleID.cultureInfo()||H(t.cultureName)),t.hasJD){var a=H(t.cultureName).DateTimeFormat.monthNames[i.getMonth()];n=A._replace(n,ne._placeholderMonthJD,r(a,0,1))}if(t._absTimeParts)for(var s=24*(k._toOADate(i)-k._toOADate(ne._defaultAbsoluteTime))*60*60*1e3,l=0;l<t._absTimeParts.length;l++){var u=t._absTimeParts[l],c=u._getTimeSpan(s);if(c){var f=u._originalToken.replace("[","\\[").replace("]","\\]");n=A._replace(n,"@"+f,c)}}}}catch(t){n=o(e)}return b(n,e,t._partLocaleID,t._partDBNumberFormat,t.cultureName)},parse:function(e){if(!e||e===W._Empty)return x;var t=this,n=e,r=B(n);if("true"===r)return!0;if("false"===r)return!1;if(t._validDateTimeFormatString){var o=k._parseExact(n,t._validDateTimeFormatString,H(t.cultureName));if(o)return o}try{var i=k._DT(n);return i&&!isNaN(i)?i:(i=new Date(n),isNaN(i.valueOf())?n:i)}catch(e){return n}},_fixFormat:function(e){for(var t=e,n="",r=!1,o=0;o<t.length;o++){var i=t[o];if('"'===i)r=!r;else if(!r)if("Y"===i||"D"===i||"S"===i||"E"===i||"G"===i)i=B(i);else if("M"===i){var a=t[o-1];f("A",a,!0)||f("P",a,!0)||(i=B(i))}n+=i}return n},_processAMPM:function(e){for(var t=[ne._aMPMTwoDigit,V(this.cultureName).amDesignator+"/"+V(this.cultureName).pmDesignator,ne._aMPMSingleDigit],n=["tt","tt","t"],r=0;r<3;r++)if(A._contains(e._value,t[r],1))return e._value=A._replace(e._value,t[r],n[r],!0),!0;return!1},_replace:function(e,r,o,i,a,s,l){if(i||a){var u=[],c=!0;!n(e)&&t(e)&&(c=!1);for(var d=!1,p=0;p<e.length;p++){var h=e[p];if(t(h)?c=!1:n(h)&&(c=!0),i&&f(h,r[0],l)&&c||a&&f(h,r[0],l)&&!c){for(var m=!0,g=0;g<r.length;g++)if(g+p>=e.length||!f(r[g],e[g+p],l)){m=!1;break}var _=p+r.length-1;if(m&&_+1<e.length){var v=e[_],y=-1;for(y=_+1;y<e.length&&f(v,e[y],l);y++);y>_+1&&(p=y,m=!1)}m&&!d&&u.splice(0,0,p)}'"'===h&&(d=!d)}if(s._value=e,u.length>0){for(p=0;p<u.length;p++){var b=u[p];s._value=A._remove(s._value,b,r.length),s._value=A._insert(s._value,b,o)}return!0}return!1}return!1}},e._evaluateFormat=function(e){return p(e,re)},e}(),ne={_yearTwoDigit:"yy",_yearSingleDigit:"y",_yearFourDigit:"yyyy",_monthSingleDigit:"m",_monthTwoDigit:"mm",_monthAbbreviation:"mmm",_monthUnabbreviated:"mmmm",_monthJD:"mmmmm",_daySingleDigit:"d",_dayTwoDigit:"dd",_dayWeekDayAbbreviation:"aaa",_dayWeekDayUnabbreviated:"aaaa",_hoursSingleDigit:"h",_hoursTwoDigit:"hh",_minuteSingleDigit:"m",_minuteTwoDigit:"mm",_secondSingleDigit:"s",_secondTwoDigit:"ss",_eraYear:"e",_aMPMTwoDigit:"AM/PM",_aMPMSingleDigit:"A/P",_placeholderMonthJD:"@mmmmm",_defaultAbsoluteTime:new Date(1899,11,30,0,0,0,0)},re=[ne._yearSingleDigit,ne._yearTwoDigit,ne._yearFourDigit,ne._monthSingleDigit,ne._monthTwoDigit,ne._monthAbbreviation,ne._monthUnabbreviated,ne._monthJD,ne._daySingleDigit,ne._dayTwoDigit,ne._dayWeekDayAbbreviation,ne._dayWeekDayUnabbreviated,ne._hoursSingleDigit,ne._hoursTwoDigit,ne._minuteSingleDigit,ne._minuteTwoDigit,ne._secondSingleDigit,ne._secondTwoDigit,"ggg","gg","g","ee","e"],oe=function(){function e(e,t,n,r){var o=this;h.call(o,t,n,r);var i=d(e,!1);t&&(i=u(i,o._partLocaleID._originalToken,o._partLocaleID.currencySymbol())),i=s(i),i=c(i),o._formatString=i,o._formatType=3}return e.prototype={format:function(e){try{var t;t=e instanceof Date?k._toOADate(e).toString():o(e);var n=A._replace(this._formatString,'"',"");return n!==x&&n!==T&&(t=A._replace(n,"@",t)),t}catch(e){return""}},parse:function(e){return e||""},formatString:function(){return this._formatString}},e}(),ie=function(){function e(e,t,n,o){function i(e,t){var n=[],r='"';if(e===x||""===e)return n;var o,i,a=!1,s=[],l=!1;for(o=0;o<e.length;o++)i=e[o],i!==r||a||(l=!l),a||l||i!==t?s.push(i):(n.push(s.join("")),s=[]),a="\\"===i&&!a;return n.push(s.join("")),n}h.call(this,t,n,o);var a=this;a._isGeneralNumber=!1,a._formatType=1,a._fullFormatString=s(e);var l=d(e);if(t&&(l=u(l,a._partLocaleID._originalToken,a._partLocaleID.currencySymbol())),l=s(l),l.indexOf("/")>-1){var c=i(l,"/");if(c&&2===c.length){a._fractionDenominatorFormat=c[1];var f=c[0];if(f){var p=f.lastIndexOf(" ");p>-1?(a._fractionIntegerFormat=r(f,0,p),a._fractionNumeratorFormat=r(f,p+1,f.length-p-1)):a._fractionNumeratorFormat=f}}}a._numberFormatString=l}function t(e,t){if(0===e)return E(t);if(0===t)return E(e);for(var n=Math.max(e,t),r=Math.min(e,t),o=n%r;0!==o;)n=r,r=o,o=n%r;return E(r)}function n(e,t,n,r,o){var i=0,a=0,s=0,l=0,u=Math.ceil;e>0?(l=e-u(e)+1,1===l?(l=0,i=e):i=u(e)-1):e<0&&(i=u(e),l=u(e)-e);var c=Math.pow(10,t-1),f=Math.pow(10,t)-1;c<2&&(c=2),f<2&&(f=2);for(var d=!1,p=0,h=c;h<=f;h++){var m=h*l,g=Math.round(m),_=g/h,v=E(_-l);if((!d||v<E(p-l))&&(d=!0,p=_,a=g,s=h,v<1e-5))break}return n.value=i,r.value=a,o.value=s,d}return e.prototype={formatString:function(){return this._fullFormatString},format:function(e){if(I(e,"boolean"))return e.toString().toUpperCase();var r=this,o=R._toDouble(e);if(isNaN(o)||!isFinite(o)||isNaN(e))return"string"==typeof e?e:x;var i,a,s,l,u,c=H(r.cultureName),f=x;if(r._fractionNumeratorFormat&&r._fractionDenominatorFormat){var d={value:0},p={value:0},h={value:0};if(n(o,r._fractionDenominatorFormat.length,d,p,h)){var m=t(p.value,h.value);if(m>1&&(p.value/=m,h.value/=m),r._fractionIntegerFormat){f="",1===h.value&&(d.value+=p.value,p.value=0,h.value=0),0!==d.value&&(f+=O._customCultureFormat(d.value,r._encodeNumberFormat(r._fractionIntegerFormat),c),f+=" "),0===d.value&&o<0&&(f+=c.NumberFormat.negativeSign),0===o&&(f+="0"),a=r._fractionDenominatorFormat,s=parseFloat(a),isNaN(s)||s>0&&(p.value*=s/h.value,a="",h.value=s,l=Math.ceil(p.value),u=l-p.value,p.value=u<=.5&&u>=0?parseFloat(l.toString()):parseFloat((l-1).toString()));var g=r._fractionNumeratorFormat,_=parseFloat(g);if(!isNaN(_)&&0===_){var v=g.length,y=p.value.toString(),b=y.length;v>b?g=g.substr(0,v-(v-b)):v<b&&(y=y.substr(0,b-(b-v)),p.value=parseInt(y,10))}return 0!==p.value&&(f+=O._customCultureFormat(p.value,r._encodeNumberFormat(g),c).replace(/^0*/,""),f+="/",f+=O._customCultureFormat(h.value,r._encodeNumberFormat(a),c).replace(/^0*/,"")),""===f?"0":f}f="";var C=d.value*h.value+p.value;return a=r._fractionDenominatorFormat,s=parseFloat(a),s>0?(C*=s/h.value,h.value=s,l=Math.ceil(C),u=l-C,C=u<=.5&&u>=0?parseFloat(l.toString()):parseFloat((l-1).toString()),f+=C+"/"+h.value):(f+=O._customCultureFormat(C,r._encodeNumberFormat(r._fractionNumeratorFormat),c).replace(/^0*/,""),f+="/",f+=O._customCultureFormat(h.value,r._encodeNumberFormat(r._fractionDenominatorFormat),c).replace(/^0*/,"")),0===C?"0":f}return o.toString()}return i=O._customCultureFormat(o,r._encodeNumberFormat(r._numberFormatString),c),i=w(i,r._isGeneralNumber,r._partLocaleID,r._partDBNumberFormat,r.cultureName)},parse:function(e){var t=this;if(!e||e===W._Empty)return x;var n=B(e);if("true"===n)return!0;if("false"===n)return!1;e=t._trimSpecialSymbol(e),e=t._trimCurrencySymbol(e);var r=t._trimPercentSign(e),o=r._isPer,i=r._str;if(t._isValidaNumberString(i)){i=A._replaceAllNoReg(i,j(t.cultureName).numberGroupSeparator,"");var a=O._parseFloat(i,t.cultureName);if(!isNaN(a)&&isFinite(a))return o&&(a/=100),a}return x},_isValidaNumberString:function(e){for(var t="",n=0,r=0,o=0,i=!0,a=j(this.cultureName),s=e.length-1;s>-1;s--){if(e[s]===a.numberDecimalSeparator)n++,o>0&&(i=!1),t="";else if("e"===B(e[s]))r++,t="";else if(e[s]===a.numberGroupSeparator)i=3===t.length,o++,t="";else if("-"===e[s]||"+"===e[s]){if(s>0&&"e"!==B(e[s-1]))return!1}else{if(!z._isDigit(e[s]))return!1;t+=e[s]}if(n>1||r>1||!i||1===r&&s===e.length-1)return!1}return!0},_encodeNumberFormat:function(e){if(e){for(var t=e.split(""),n="",r=0;r<t.length-1;)"\\"===t[r]?(n+=t[r+1],r+=2):(n+=t[r],r++);r===t.length-1&&"\\"!==t[r]&&(n+=t[r]),e=u(n,"?","0")}return e},_trimSpecialSymbol:function(e){for(var t=e,n=[],r=0;r<t.length;r++)z._isDigit(t[r])&&n.push(r);for(var o=j(this.cultureName),i=[o.currencyDecimalSeparator,o.currencyGroupSeparator,o.currencySymbol,o.nanSymbol,o.negativeInfinitySymbol,o.negativeSign,o.numberDecimalSeparator,o.numberGroupSeparator,o.percentDecimalSeparator,o.percentGroupSeparator,o.percentSymbol,o.perMilleSymbol,o.positiveInfinitySymbol,o.positiveSign],a=t.length-1;a>-1;a--){var s=t[a];if(!z._isWhiteSpace(s)||i.indexOf(s.toString())>-1){if("-"===s||"+"===s){var l=a>0?t[a-1].toString():x,u=["e","E","(",j(this.cultureName).currencySymbol];if(u.indexOf(l)<0)break}}else(a<n[0]||n[n.length-1]<a)&&(t=A._remove(t,a,1))}return t},_trimCurrencySymbol:function(e){var t=j(this.cultureName).currencySymbol,n=A._startsWith(e,t)?A._remove(e,0,t.length):e;return n.indexOf(t)<0?n:e},_trimPercentSign:function(e){var t=j(this.cultureName).percentSymbol,n=!0,r=e;return A._startsWith(e,t)?r=A._remove(e,0,t.length):A._endsWith(e,t)?r=A._remove(e,e.length-t.length,t.length):n=!1,A._contains(r,t)&&(n=!1),{_str:r,_isPer:n}}},e}(),ae=function(){function e(e,t,n,r){h.call(this,t,n,r),arguments.length>0?((e.indexOf("0")>=0||e.indexOf("#")>=0||e.indexOf(".")>=0||e.indexOf("@")>=0)&&U(),this._fullFormatString=e):this._fullFormatString="General",this._formatType=0}return e.prototype={_getDigitalFormat:function(){var e=this;if(!e._digitalFormat){var t=e._fullFormatString;t=u(t,"General","##################0.################"),e._digitalFormat=new ie(t,e._partLocaleID,e._partDBNumberFormat,e.cultureName),e._digitalFormat._isGeneralNumber=!0}return e._digitalFormat},_getExponentialDigitalFormat:function(){var e=this;return e._exponentialDigitalFormat||(e._exponentialDigitalFormat=new ie("0.#####E+00",e._partLocaleID,e._partDBNumberFormat,e.cultureName),e._exponentialDigitalFormat._isGeneralNumber=!0),e._exponentialDigitalFormat},formatString:function(){return A._replace(this._fullFormatString,"@NumberFormat","General")},format:function(e){var t=this;if(/^0+\d*$/.test(e))return e;if(S.isBigNumber(e)&&!t._exponentialDigitalFormat)return e;if(R._isNumber(e,t.cultureName)){var n=!t._partLocaleID||t._partLocaleID.allowScience(),r=R._toDouble(e);if(r!==T&&r!==x)return E(r)>999999999999999&&n||E(r)<1e-11&&0!==r?t._getExponentialDigitalFormat().format(e):t._getDigitalFormat().format(e)}else{if(I(e,"string")){var o=A._replace(t.formatString(),'"',"");return o=c(o),o?A._replace(o,"General",e):e}if(I(e,"boolean"))return e.toString().toUpperCase()}return""},parse:function(e){if(W._isNullOrEmpty(e))return x;if("number"==typeof e)return e;var t=!1,n=A._indexOf(e,"-");if(n>0&&(f(e.charAt(n-1),"E",!0)||(t=!0)),A._contains(e,"/")||t||A._contains(e,":")||A._contains(e,"-")){var r=k._parseLocale(e);if(r)return r}var o,i="-"===e.charAt(0),a=i?A._remove(e,0,1):e,s="("===a.charAt(0)&&")"===e.charAt(e.length-1);return o=this._getDigitalFormat().parse(a),o!==x&&o!==T?(s||i)&&I(o,"number")?-1*E(o):o:e}},e}(),se=function(){function e(e,t){var n=this;0===arguments.length?(n.formatCached="General",n._numberFormat=new ae):n._init(e,t)}function t(e){if(!e||e===W._Empty)throw new Error(L().Exp_TokenIllegal)}function n(e){t(e);var n=l(e);return t(n),n}var r=["colorFormatPart","conditionalFormatPart","dbNumberFormatPart","localeIDFormatPart"];return e.prototype={_init:function(e,t){e!==x&&e!==T||U();var r=this;r.formatCached=e;for(var o="",i="",a=!1,s=[],l=0;l<e.length;l++){var u=e[l];if("["===u)a&&U(),i&&(o||(o=""),o+=i,i=""),i=u.toString(),a=!0;else if("]"===u){if(a||U(),i){i+=u;var c=i.toString(),f=g(i.toString());f?"ABSTimeFormatPart"===f.Name?(s.push(new f(n(c),c)),o+=i):r.addPart(f,c):U(),i=""}else U();a=!1}else i+=u}i&&(a?U():o+=i),r.localeIDFormatPart&&(t=r.localeIDFormatPart.cultureInfo().name());var d=_(o),p=d._type,h=d._isDigitalOrText?e:o;p?r._numberFormat=new p(h,r.localeIDFormatPart,r.dbNumberFormatPart,t,s.length>0?s:x):U()},formatString:function(){for(var e=this,t="",n=0,o=r.length;n<o;n++){var i=r[n];e[i]&&(t+=e[i].toString())}return t+=e._numberFormat.formatString()},addPart:function(e,t){for(var o=this,i=n(t),a=0,s=r.length;a<s;a++){var l=r[a];if(f(l,e.Name,!0)){if(o[l])throw new Error(L().Exp_DuplicatedDescriptor);o[l]=new e(i,t)}}},format:function(e){return this._numberFormat.format(e)},parse:function(e){return this._numberFormat.parse(e)}},e}(),le=function(e){function t(e,t){var n=this;n._isSingleFormatterInfo=!0,n.PropertyChanged=[],W._isNullOrEmpty(e)&&(e="General"),n.formatCached=e,n.cultureName=t,n.init()}function n(e){var n=t[e];return n||(n=new t(e),t[e]=n),n}return R._inherit(t,e),t.prototype={toJSON:function(){var e=this,t={formatCached:e.formatCached};return e.cultureName&&(t.customerCultureName=e.cultureName),"general"===B(e.formatCached)&&delete t.formatCached,t},hasFormatedColor:function(){var e=this;for(var t in Y)if(Y.hasOwnProperty(t)){var n=e.getFormatter(Y[t]);if(n&&n.colorFormatPart)return!0}return!1},formatString:function(e){var t=this;if(0===arguments.length){for(var n=W._Empty,r=0,o=t.formatters.length;r<o;r++){n+=t.formatters[r].formatString(),r!==o-1&&(n+=";")}return n}if(!e)throw new Error(L().Exp_ValueIsNull);return t.formatters=x,t.formatCached=e,t.init(),t._raisePropertyChanged("formatString"),t},getFormatter:function(e){var t=this;return t.formatters&&t.formatters[e]},getPreferredEditingFormatter:function(e){var t=V(this.cultureName);return n(I(e,"DateTime")?k._toOADate(e)<1?"HH:mm:ss":0===e.getHours()&&0===e.getMinutes()&&0===e.getSeconds()&&0===e.getMilliseconds()?t.shortDatePattern:t.shortDatePattern+" HH:mm:ss":I(e,"TimeSpan")?t.longTimePattern:"General")},getPreferredDisplayFormatter:function(e,r){var o=this;r||(r={value:x}),r.value=x;var i=/^0+\d*$/,a=S.isBigNumber(e);if(W._isNullOrEmpty(e)||i.test(e)||a)return a&&(r.value=e),new t;var s=e,l=r.value=o.parse(s);if(I(l,"DateTime")||I(l,"TimeSpan"))for(var u=X(),c=u.pattern,f=u.formatter,d=0;d<c.length;d++)for(var p=c[d],h=0;h<p.length;h++){var m=p[h],g=k._parseLocale(e,m);if(g&&g-l==0)return new t(f[d])}else if(R._isNumber(l,o.cultureName)){var _=j(o.cultureName),v=_.currencySymbol,y=_.numberDecimalSeparator,b=_.percentSymbol,w=_.numberGroupSeparator,C="E",T=A._contains,E=T(s,y),M=E?".00":"";if(s[0]===v)return n(W._format("{0}#,##0{1};[Red]({0}#,##0{1})",v,M));if(T(s,C,1))return n("0.00E+00");if(s[0].toString()===b||s[s.length-1].toString()===b)return n(W._format("0{0}%",M));if(T(s,w))return n(W._format("#,##0{0}",M))}return n("General")},format:function(e,t){if(I(e,"boolean"))return e.toString().toUpperCase();var n=this._getFormatInfo(e);if(n){var r=n.colorFormatPart;t&&r&&(t.value=r.foreColor);var o=0,i=R._isNumber(e,self.cultureName);i&&(o=R._toDouble(e));var a=W._Empty;if(i&&n===this.getFormatter(Y._negative))a=n.format(E(o)),n&&n.conditionalFormatPart&&n.conditionalFormatPart.value>0&&o<0&&(a="-"+a);else try{a=n.format(e)}catch(t){I(e,"string")&&(a=e.toString())}return a}return i&&o<0?"-".toString():I(e,"string")?e.toString():e===T||e===x?W._Empty:e.toString()},parse:function(e){var t=this;return t.formatters&&t.formatters.length>0?t.formatters[0].parse(e):x},init:function(){var e=this,t=e.formatCached;W._isNullOrEmpty(t)&&U(),e.formatters=[];var n=t.split(";");e._isSingleFormatterInfo=1===n.length,(!n||n.length<1||n.length>4)&&U();for(var r=0;r<n.length;r++){var o=new se(n[r],e.cultureName);o&&e.formatters.push(o)}e.getFormatter(Y._positive)||U()},_getFormatInfo:function(e){var t=this,n=t.getFormatter(Y._positive),r=t.getFormatter(Y._text);if("string"==typeof e&&isNaN(e))return r||n;if(R._isNumber(e,t.cultureName)||I(e,"boolean")){var o,i=t.getFormatter(Y._negative),a=t.getFormatter(Y._zero),s=R._toDouble(e),l=n&&n.conditionalFormatPart,u=l&&n.conditionalFormatPart.isMeetCondition(s),c=i&&i.conditionalFormatPart,f=c&&i.conditionalFormatPart.isMeetCondition(s);return t._isSingleFormatterInfo||(l?u:s>0)||0===s&&!t.getFormatter(Y._zero)?o=n:(c?f:s<0)?o=i:a?o=a:i&&(o=i),o}return x},_raisePropertyChanged:function(e){var t=this;if(t.PropertyChanged)for(var n=0;n<t.PropertyChanged.length;n++){var r=t.PropertyChanged[n];"function"==typeof r&&r(t,e)}}},t}(ee);M.GeneralFormatter=le,M.FormatterBase=ee,e.exports=M},function(e,t,n){function r(){throw x()[E]}function o(e,t,n){throw S._format(x()[n||T],[e,t])}function i(e){return e<=255}function a(e){return e<=127}function s(e,t,n,r,i,a){for(var s=e.length,l=n===r?0:1,u=[],c=t+1;c<s;c++){var f=e[c];if(f===i&&(u.push(f),c++,f=e[c]),f===n&&l++,f===r)if(l--,n===r&&c+2<s&&e[c+1]===n)u.push(n),c++;else{if(0===l)return{result:u,endIndex:c};u.push(f)}else u.push(f)}a&&o(r,n,M)}function l(e,t,n){for(var r=e.length,i=r-t,a=0;a<w.length;a++){var s=w[a],l=s.length;if(t+l<=r){var u=e.slice(t,t+l);if(l<=i&&s===u.join("").toUpperCase())return{result:u,endIndex:t+l-1}}}n&&o([e[t],t])}function u(e,t,n){for(var r=e.length,o=0,i=[],a=t;a<r;a++){var s=e[a];if(N(s))0===o?o=2:3===o?o=4:1===o?o=2:5!==o&&6!==o||(o=7),i.push(s);else if(s===n){if(2===o)o=4;else{if(0!==o&&1!==o)return{};o=3}i.push(".")}else if("+"===s||"-"===s){if(0===o)o=1;else{if(5!==o)return{num:i,endIndex:a-1};o=6}i.push(s)}else if("E"===s||"e"===s){if(2!==o&&4!==o)return{};o=5,i.push(s)}else if(2===o||4===o||7===o)return{num:i,endIndex:a-1}}return 2===o||4===o||7===o?{num:i,endIndex:r-1}:{}}var c=n(0),f=n(22),d=c._Types._inherit,p=c._Types._extend,h=void 0,m=null,g="string",_="boolean",v="TRUE",y="FALSE",b="ARRAY",w=f.ErrorList,C=f.Expression,S=c._StringHelper,x=function(){return c._getResource(f.SR)()},T="Exp_FormulaInvalidChar",E="Exp_FormulaInvalid",M="Exp_NoSyntax";f.OperatorType={Plus:0,Negate:1,Percent:2,Add:3,Sub:4,Mul:5,Div:6,Exp:7,Concat:8,EqualTo:9,NotEqualTo:10,LessThan:11,LessThanOrEqualTo:12,GreaterThan:13,GreaterThanOrEqualTo:14,Range:15,Union:16,Intersect:17};var A=f._OperatorTypeStringMap=["+","-","%","+","-","*","/","^","&","=","<>","<","<=",">",">=",":",","," "],k={":":1,"^":2," ":3,"*":4,"/":4,",":5,"+":6,"-":6,"&":7,"<":8,"=":8,">":8,">=":8,"<=":8,"<>":8};f.FormulaTokenType={Operand:0,Function:1,Subexpression:2,Argument:3,OperatorPrefix:4,OperatorInfix:5,OperatorPostfix:6,Whitespace:7},f.FormulaTokenSubtype={Nothing:0,Start:1,Stop:2,Text:3,Number:4,Logical:5,Error:6,RangeOrName:7,Concatenation:8,Intersection:9,Union:10,RangeOp:11,ExternalReference:12};var R=".",I=",",O=";",D=",",P=[14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,11,24,24,24,26,24,24,24,20,21,24,25,24,19,24,24,8,8,8,8,8,8,8,8,8,8,24,24,25,25,25,24,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,20,24,21,27,18,27,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,20,25,21,25,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,11,24,26,26,26,26,28,28,27,28,1,22,25,19,28,27,28,25,10,10,27,1,28,24,27,10,1,23,10,10,10,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,25,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,25,1,1,1,1,1,1,1,1],N=f.isDigit=function(e){var t=e.charCodeAt(0);return t>=48&&t<=57};f._isLetter=function(e){var t=e.charCodeAt(0);return!i(t)||(a(t)?(t|=32)>=96&&t<=122:0===P[t]||1===P[t])};f._isLetterOrDigit=function(e){var t=e.charCodeAt(0);return!i(t)||(a(t)?t<=57?t>=48:(t|=32)>=96&&t<=122:0===P[t]||1===P[t])};f.isNumber=function(e){var t=e.charCodeAt(0);return a(t)?t>=48&&t<=57:8===P[t]||10===P[t]},f.Parser=function(){function e(){}return e.prototype={setParserOption:function(e){var t;!e||!0===e&&!c.CultureManager._getCultureInfo()?t={}:e&&(t=e.NumberFormat?e.NumberFormat:c.CultureManager._getCultureInfo().NumberFormat),I=t.listSeparator||",",R=t.numberDecimalSeparator||".",O=t.arrayGroupSeparator||";",D=t.arrayListSeparator||","},parse:function(e,t){this.setParserOption(e.culture);var n=t.split("");this._charArray=n;var r=this.parseToTokens(e,n,!e.ignoreError);return this.buildExpressionTree(e,r,!e.ignoreError)},unparse:function(e,t,n){this.setParserOption(e.culture);var r=e.getResolvers();n=n||[];for(var o=0;o<r.length&&!r[o].unparse(e,this,t,n);o++);return n.join("")},parseToTokens:function(e,t,n){void 0===n&&(n=!0);for(var r,i,a=this,c=function(e,t,n){return t.length>0?(e.push(new L(t,0,n)),[]):t},f=t.length,d=[],p=[],h=-1,m=[],g=0,_=0;_<f&&" "===t[_];)_++;"="===t[_]&&_++,g=_;for(var v=_;v<f;v++){var y,w=t[v];if('"'===w)y=s(t,v,'"','"',"",n),y?(d.push(new L(y.result,0,v,v+y.result.length+2,3)),v=y.endIndex,g=v+1):(F(m,t.slice(v,f)),v=f-1);else if("'"===w)y=s(t,v,"'","'","",n),y?(m.push("'"),F(m,y.result),m.push("'"),v=y.endIndex):(m.push("'"),v=f-1);else if("["===w)if(y=s(t,v,"[","]","'",n))m.push("["),F(m,y.result),m.push("]"),v=y.endIndex;else{if(a._isR1C1&&0===m.length&&("R"===m[0]||"r"===m[0]||"C"===m[0]||"c"===m[0]))continue;F(m,t.slice(v,f)),v=f-1}else{if("\r"===w||"\n"===w)continue;if("#"===w){var C=l(t,v);C?(d.push(new L(C.result,0,v,v+C.result.length-1,6)),g=v+1,v=C.endIndex):m.push(w)}else if("!"===w)m.length,d.push(new L(m,0,g,v,12)),m=[],g=v+1;else if("+"===w||"-"===w){var S=0===d.length?null:d[d.length-1];0!==m.length?(d.push(new L(m,0,g)),d.push(new L(w,5,v)),m=[],g=v+1):(S&&7===S._type&&d.pop(),!S||2!==S._subType&&6!==S._type&&0!==S._type?(d.push(new L(w,4,v)),g=v+1):(d.push(new L(w,5,v)),g=v+1))}else if(w===R||N(w)){var x;if(m.length>0)m.push(w);else if((x=u(t,v,R)).num){var T=x.endIndex,E=x.num;d.push(new L(E,0,v,T,4)),v=T,g=v+1}else m.push(w)}else if("{"===w)m.length>0&&n&&o(w,v),r=new L(b,1,v,v,1),d.push(r),p[++h]=r,g=v+1;else if(w===O&&h>=0&&p[h].value===b)m=c(d,m,g),h<0&&n&&o(w,v),d.push(new L(O,3,v,v)),g=v+1;else if("}"===w)m=c(d,m,g),T<0&&n&&o(w,v),i=p[h--],i=new L(w,i._type,v,v,2),d.push(i),g=v+1;else if(" "===w)m=c(d,m,g),g=v+1;else if(w===I||w===D||w===O)m=c(d,m,g),h<0||1!==p[h]._type?d.push(new L(I,5,v,v,10)):d.push(new L(w,3,v,v)),g=v+1;else if("%"===w)m=c(d,m,g),d.push(new L(t[v],6,v,v)),g=v+1;else if(v+2<=f&&j[w+t[v+1]])m=c(d,m,g),d.push(new L(t.slice(v,v+2),5,v,v+1,5)),v++,g=v+1;else if(j[w])m=c(d,m,g),d.push(new L(w,5,v,v)),g=v+1;else if("("===w)m.length>0?(r=new L(m,1,g,v,1),m=[]):r=new L(w,2,v,v,1),d.push(r),p[++h]=r,g=v+1;else if(")"===w){if(m=c(d,m,g),h<0){n&&o(w,v);continue}i=p[h--],i=new L(w,i._type,v,v,2),d.push(i),g=v+1}else":"===w?(m=c(d,m,g),d.push(new L(w,5,v,v,11)),g=v+1):m.push(w)}}return c(d,m,g),d},buildExpressionTree:function(e,t,n){var r=this._buildExpressionNodes(e,t,n);return this._buildExpressionsToTree(e,r,n)},_buildExpressionsToTree:function(e,t,n){var r,o,i,a,s=this._parseToBinaryOperatorList(e,t,n);for(a=3;a<s.length;){var l=s[a],u=s[a-2];if(l&&9===l.type){for(;a>=3&&k[l.value]>=k[u.value];)o=s[a-3],i=s[a-1],r=f._createOperatorExpression(u.operatorType,o,i),s.splice(a-3,3,r),(a-=2)>=3&&(u=s[a-2]);a+=2}else a++}if(1===s.length)return s[0];for(a=s.length-2;a>0;a-=2)o=s[a-1],i=s[a+1],r=f._createOperatorExpression(s[a].operatorType,o,i),s.splice(a-1,3,r);return r},_parseToBinaryOperatorList:function(e,t,n){t=Array.isArray(t)?t:[t];for(var o=[],i=t.length,a=0;a<i;a++){var s=t[a],l=s;if(9===s.type){if(0===s.operatorType||1===s.operatorType)if(a===i-1)n&&r();else{for(var u=a;9===t[u].type&&t[u].operatorType<=1;)u++;for(var c=this._buildExpressionsToTree(e,t[u]),d=u-1;d>=a;d--)l=f._createOperatorExpression(s.operatorType,c),c=l;l=c,a=u}else if(2===s.operatorType){if(0!==a){l=f._createOperatorExpression(s.operatorType,this._buildExpressionsToTree(e,o[o.length-1])),o[o.length-1]=l;continue}n&&r()}}else if(10===s.type)s.value=this._buildExpressionsToTree(e,s.value),l=s;else if(7===s.type){var p=0,h=s.arguments,m=[];if(h.length>0){for(var g=0;g<=h.length;g++){var _=h[g];(g===h.length||0===_.type&&_.value===I)&&(p===g?m.push(new C(11)):m.push(this._buildExpressionsToTree(e,h.slice(p,g))),p=g+1)}s.arguments=m}l=s}o.push(l)}return o},_buildExpressionNodes:function(e,t,n){for(var r=[],o=0,i=t.length;o<i;)o=this.resolveToken(e,t,r,o,n);return r},resolveToken:function(e,t,n,r,o){for(var i=t[r],a=e.getResolvers(),s=0;s<a.length;s++){var l=a[s].resolveToken(e,this,t,r);if(l){var u=l.expr,c=r-1;u&&l.index!==h?r=l.index-1:u=l;var d=n.length>0?n[n.length-1]:m;if(d&&0!==u.type&&7!==u.type&&u.type<9&&0!==d.type&&7!==d.type&&d.type<9){t[c]._endIndex<i._index-1&&n.push(f._createOperatorExpression(17," "))}n.push(u);break}}return r+1},resolveSubTokens:function(e,t,n,r){for(var o=[];n<t.length&&2!==t[n]._subType;)n=this.resolveToken(e,t,o,n,r);return{exprs:o,index:n+1}}},e}();var F=function(e,t){return e.push.apply(e,t),e},L=f.FormulaToken=function(){function e(e,t,n,r,o){o=o||0;var i=this;i._value=e;var a=Array.isArray(e)?e.join(""):e;if(i._type=t,i._index=n,i._endIndex=r||n+e.length-1,0===t&&0===o&&e){var s=a.toUpperCase();s!==v&&s!==y||(o=5,a=s)}else 1===t&&a!==b&&(a=a.toUpperCase());i._stringValue=a,i._subType=o,i._children=[]}return e}(),H=f.TokenResolver=function(){function e(e){this.priority=e||5e3}return e.prototype.resolveToken=function(e,t,n,r){},e.prototype.unparse=function(e,t,n,r){},e}();f.ParserContext=function(){function e(e,t,n,r){var o=this;o._toStandard=!1,o.ignoreError=!1,o.source=m,o.useR1C1=t,o.row=n.row||0,o.column=n.col||0,o.baseIdentity=n,o.option=r,o.source=e,o._resolves=[],o.addResolver(new B)}return e.prototype={getExternalSource:function(e,t){for(var n=this.source._getCalcServiceInternal(),r=n.getAllSouceModels(),o=0;o<r.length;o++)if(S._compareStringIgnoreCase(r[o].getSource().getName(),t))return r[o].getSource();return m},getExternalSourceToken:function(e){return e.getName()},getTableByName:function(e){return m},getTableByIndex:function(e,t){return m},setSource:function(e){this.source=e},getResolvers:function(){return this._resolves},addResolver:function(e){for(var t=this._resolves,n=0;;n++)if(!t[n]||e.priority>t[n].priority){t.splice(n,0,e);break}},getFunction:function(e){return this.source&&this.source.getCustomFunction(e)||f.Functions.findGlobalFunction(e)}},e}();var V={"+":0,"-":1},j=f.operaterTypesMap={":":15,",":16,"+":3,"-":4,"*":5,"/":6,"^":7,"%":2,"&":8,"=":9,"<":11,"<>":10,"<=":12,">":13,">=":14},B=f.DefaultTokenResolver=function(){H.call(this)};d(B,H),p(B.prototype,{resolveToken:function(e,t,n,o){var i,a,s=n[o],l=s._stringValue;if(0===s._type&&0===s._subType){var u=l.toUpperCase();u===v||u===y?(s._subType=5,s._stringValue=u,i=new C(4),i.value=u===v):(i=new C(8),i.value=l)}else if(1===s._type){if(l===b){i=new C(6),o++,u=[[]],a=0;for(var c=0,d=0;o<n.length&&2!==n[o]._subType;){if(s=n[o],3===s._type){if(s._value===O){if(c!==d)throw S._format(x().Exp_InvalidArrayColumns,[s._index]);u.push([]),a++,d=0}}else{if(0!==s._type||4!==s._subType&&3!==s._subType&&5!==s._subType&&6!==s._subType)throw x().Exp_InvalidArray;var p=s._stringValue;4===s._subType?p=parseFloat(p):5===s._subType?p="TRUE"===p.toUpperCase():6===s._subType&&(p=f.CalcError.parse(p)),u[a].push(p),0===a&&c++,d++}o++}if(c!==d)throw S._format(x().Exp_InvalidArrayColumns,[s._index]);return o++,i.value=new f.CalcArray(u),{expr:i,index:o}}if(s._value.length>0){"@"===s._value[0]&&(s._stringValue=s._value.slice(0,s._value.length-1).join("")),i=new C(7),i.functionName=s._stringValue,i.function=e.getFunction(i.functionName)||f.Functions.findGlobalFunction(i.functionName);var h=t.resolveSubTokens(e,n,o+1);return h?(i.arguments=h.exprs,{expr:i,index:h.index}):(i.arguments=[],i)}}else if(4===s._type||6===s._type||5===s._type)i=f._createOperatorExpression(4===s._type?V[l]:j[l],l);else if(2===s._type){if(i=new C(10),h=t.resolveSubTokens(e,n,o+1))return i.value=h.exprs,{expr:i,index:h.index};r()}else 0===s._type?4===s._subType?(i=new C(2),i.value=parseFloat(l),i.originalValue=l):3===s._subType?(i=new C(3),i.value=l):5===s._subType?(i=new C(4),i.value=l===v):6===s._subType?(i=new C(5),i.value=f.CalcError.parse(l)):7===s._subType&&(i=new C(8),i.value=l):3===s._type&&(i=new C(0),i.value=l);return i},unparse:function(e,t,n,r){var o=this;if(n){if(6===n.type||4===n.type||2===n.type||5===n.type||3===n.type)o._unparseConstantExpression(e,n,r);else if(9===n.type)o._unparseOperatorExpressions(e,t,n,r);else if(10===n.type)r.push("("),t.unparse(e,n.value,r),r.push(")");else{if(7!==n.type)return!1;F(r,(n.function&&n.function.name||n.functionName).split("")),r.push("(");for(var i=0;i<n.arguments.length;i++)0!==i&&r.push(I),t.unparse(e,n.arguments[i],r);r.push(")")}return!0}},_unparseOperatorExpressions:function(e,t,n,r){var o=n.operatorType;2===o?(t.unparse(e,n.value,r),r.push("%")):0===o||1===o?(r.push(A[o]),t.unparse(e,n.value,r)):(t.unparse(e,n.value,r),r.push(A[o]),t.unparse(e,n.value2,r))},_unparseConstantExpression:function(e,t,n){var r=this,o=x().Exp_InvalidArray;if(3===t.type)n.push('"'),n.push(t.value),n.push('"');else if(2===t.type){var i=t.originalValue||t.value.toString();"."!==R&&(i=i.replace(".",R)),n.push(i)}else if(4===t.type)n.push(t.value?v:y);else if(6===t.type){n.push("{");var a=t.value;if(a.getRowCount()<=0)throw o;for(var s=0,l=a.getRowCount();s<l;s++){s>=1&&n.push(O);for(var u=0,c=a.getColumnCount();u<c;u++){0!==u&&n.push(D);var f=a.getValue(s,u);if(f===h||f===m)throw o;var d=typeof f;f instanceof C?r.context(e,f,n):d===g?(n.push('"'),n.push(f),n.push('"')):d===_?n.push(f?v:y):"number"===d&&"."!==R?n.push(f.toString().replace(".",R)):n.push(f.toString())}}n.push("}")}else 5===t.type?n.push(t.value.toString()):t.type}})},function(e,t,n){function r(e,t,n,r){return{row:e,col:t,rowCount:n,colCount:r}}function o(e){for(var t,n=0;n<e._children.length;n++)t=e._children[n],t._hasResult=!1,t._children.length>0&&o(t)}function i(e,t){if(!t)return 0;var n=W(t);return n.success?s(e,n.value):void 0}function a(e,t,n){var r;r=e<=7?s:8===e?l:u;var o=W(t),i=W(n);if(o.success&&i.success)return r(e,o.value,i.value);t=o.value,n=i.value;var a=o.success?-1:t.rowCount,c=o.success?-1:t.colCount,f=i.success?-1:n.rowCount,d=i.success?-1:n.colCount,p=-1,h=-1;if(o.success||i.success)o.success?(p=f,h=d):(p=a,h=c);else{if(1!==a&&1!==f&&a!==f||1!==c&&1!==d&&c!==d)return L;p=1===a?f:a,h=1===c?d:c}for(var m=[],_=0;_<p;_++){m[_]=[];for(var v=0;v<h;v++)!o.success&&(1!==a&&a<p||1!==c&&c<h)||!i.success&&(1!==f&&f<p||1!==d&&d<h)?m[_][v]=L:m[_][v]=r(e,o.success?t:t[1===a?0:_][1===c?0:v],i.success?n:n[1===f?0:_][1===d?0:v])}return new g.CalcArray(m)}function s(e,t,n){var r={value:0};if(!k(t,r))return 0===e&&"string"==typeof t?t:P;var o,i=r.value;if(n!==w){if(!k(n,r))return P;o=r.value}else o=0;return 0===e?i:1===e?-i:2===e?i/100:3===e?i+o:4===e?i-o:5===e?i*o:6===e?o?i/o:H:7===e?!i&&o<0?H:C(i,o):void 0}function l(e,t,n){if(8===e)return R(t)?t:R(n)?n:(t=t||"",n=n||"",A._toString(t)+A._toString(n))}function u(e,t,n){if(R(t))return t;if(R(n))return n;var r=typeof t===T,o=typeof n===T,i=r||o,a=i?"":0;t=t===b||t===w?a:t,n=n===b||n===w?a:n;var s=function(){return t===n?0:r&&o?t.toUpperCase().localeCompare(n.toUpperCase()):r?1:o?-1:g._Helper._approxEqual(t,n)?0:t-n};if(!i){var l={value:0},u={value:0};if(!k(t,l)||!k(n,u))return P;t=l.value,n=u.value}var c=s();return 9===e&&0===c||10===e&&0!==c||11===e&&c<0||12===e&&c<=0||13===e&&c>0||14===e&&c>=0}function c(e,t,n){if(!t||!n||(1!==t.getRangeCount()||1!==n.getRangeCount())&&16!==e||t.endSource||n.endSource)return P;var o=t.getSource();if(!o||o!==n.getSource())return P;var i;if(16===e)i=t._identities.concat(n._identities);else{var a=15===e?S:x,s=15===e?x:S,l=t.getRow(0),u=t.getColumn(0),c=n.getRow(0),f=n.getColumn(0),d=a(l,c),p=a(u,f);i=[r(d,p,s(l+t.getRowCount(0),c+n.getRowCount(0))-d,s(u+t.getColumnCount(0),f+n.getColumnCount(0))-p)]}return new g.CalcReference(o,i)}function f(e,t){var n,r,o=!0;switch(t._argType){case 0:n=Y(e),r=!0;break;case 1:n=parseFloat(e),r=!0;break;case 2:n=G(e),r=!0;break;case 3:n=parseInt(e),r=!0;break;case 4:n=I(e,t._valueType,t._toOneDimension||!1,t._breakOnError||!1,t._breakOnConvertError||!1,t._ignoreBlank),n.isError&&(n=n[0],o=!1),n.isConvertError&&(n=P,o=!1);break;case 5:n=K(e),t._acceptsEmptyString&&""===n&&(n=P,o=!1);break;case 6:var i={value:b};X(e,i)?n=i.value:(n=P,o=!1);break;case 7:n=q(e);break;case 8:n=p(e),!n||t._complexCondition&&0===n._getReal()&&0===n._getImag()?(n=g.Errors.Number,o=!1):n={_real:n._getReal(),_imag:n._getImag()};break;default:n=e}return r&&isNaN(n)&&(n=P,o=!1),{_retValue:n,_isExecuteFunc:o}}function d(e,t){this._real=e,this._imag=t}function p(e){function t(e){function t(e,t){return e.charAt(t)}function n(e,n){for(var r=e.length,o=!1;n<r&&!isNaN(t(e,n));)n++,o=!0;for(n<r&&"."===t(e,n)&&n++;n<r&&!isNaN(t(e,n));)n++,o=!0;if(n<r&&("E"===t(e,n)||"e"===t(e,n)))for(n++,o=!1,n<r&&("+"===t(e,n)||"-"===t(e,n))&&n++;n<r&&!isNaN(t(e,n));)n++,o=!0;return{_digitFlag:o,_index:n}}var r,o,i=0,a=0,s=!1,l=0,u=0,c=0,f=e.length;if(!e)throw E().Exp_ArgumentNull;if(0===f)throw M;c<f&&("+"===t(e,c)||"-"===t(e,c))&&c++;var p=n(e,c);if(c=p._index,r=p._digitFlag,c<f&&("+"===t(e,c)||"-"===t(e,c))?(l=c,c++,p=n(e,c),c=p._index,o=p._digitFlag,c<f&&("i"===t(e,c)||"j"===t(e,c))&&(c++,s=!0),u=c-l):c<f&&("i"===t(e,c)||"j"===t(e,c))?(c++,u=c,o=r,s=!0,r=!1):l=c,c<f)throw M;if(l>0){if(!r)throw M;i=parseInt(e.substr(0,l),10)}if(u>0){if(!s)throw M;if(1===u||2===u&&"+"===t(e,l))a=1;else if(2===u&&"-"===t(e,l))a=-1;else{if(!o)throw M;a=parseInt(e.substr(l,u-1),10)}}return new d(i,a)}try{return e?"number"==typeof e?new d(parseFloat(e),0):"string"==typeof e?t(e):null:new d(0,0)}catch(e){return null}}function h(e,t,n){Array.isArray(t)||(t=[t]);var r,o=e._retValue;for(r=0;r<t.length;r++){var i=t[r].split(" "),a=i[0],s=parseInt(i[1]);if("<"===a&&o<s||">"===a&&o>s||"<="===a&&o<=s||">="===a&&o>=s||"="===a&&o===s||"!="===a&&o!==s||"checkLength"===a&&o.length>s)return e._retValue=n===w?g.Errors.Number:n,void(e._isExecuteFunc=!1)}}function m(e,t){var n,r,o=[];if(!t)return{_args:e,_isExecuteFunc:!0};if(t._isAllArgsSameLimit)for(var i=0;i<e.length;i++)o.push(t);else o=Array.isArray(t)?t:[t];for(r=0;r<o.length;r++){var a=o[r];if(a._acceptsRealValue&&!e[r])throw E().Exp_ArgumentNull;var s=e[r]!==w;if(s){if(n=f(e[r],a),a._argCondition&&h(n,a._argCondition,a._conditionErrorValue),!n._isExecuteFunc)break;e[r]=a._needArgExistsValue?{_isArgExists:s,_value:n._retValue}:n._retValue}else e[r]=a._needArgExistsValue?{_isArgExists:s,_value:a._defaultValue}:a._defaultValue}return{_args:e,_isExecuteFunc:n._isExecuteFunc,_result:n._retValue}}var g=n(22),_=g.Errors,v=n(0),y=v._Types._inherit,b=null,w=void 0,C=Math.pow,S=Math.min,x=Math.max,T="string",E=function(){return v._getResource(g.SR)()},M=E().Exp_Format,A=g.Convert,k=A._tryToDouble,R=A._isError,I=A._toArray,O=function(){function e(e,t,n,r){var o=this;o._asyncId=0,o._asyncCount=0,o._expandArrayToMultiCallCount=0,o.source=e,o.arrayFormulaMode=!!n,o.identity=t||g._createCellIdentity(0,0),o.arrayIdentity=r,o.row=r?r.row:o.identity.row,o.column=r?r.col:o.identity.col,o.rowOffset=r?o.identity.row-r.row:o.row,o.columnOffset=r?o.identity.col-r.col:o.column}return e}();O.prototype={_getActualSource:function(e){return e===g.BangSource?this.source:e},getValue:function(e,t){return e?this._getActualSource(e).getValue(t):D},getReference:function(e,t){return e?this._getActualSource(e).getReference(t):D},getSheetRangeReference:function(e){return e&&e.source&&e.endSource?this._getActualSource(e.source).getSheetRangeReference(e):D},getFunction:function(e){var t=this;return t.source?t.source.getCustomFunction(e):b},getName:function(e){var t=this,n=t.source?t.source.getCustomName(e):b;if(!n&&t.source){var r=t.source._getCalcServiceInternal().getGlobalSourceModel();n=r&&r.getSource().getCustomName(e)}return n},_isExpandArrayToMultiCall:function(){return this._expandArrayToMultiCallCount>0},_beginExpandArrayToMultiCall:function(){this._expandArrayToMultiCallCount++},_endExpandArrayToMultiCall:function(){this._expandArrayToMultiCallCount--},SetAsyncResult:function(e,t){this.source._getCalcServiceInternal()._evaluator.SetAsyncResult(e,t)},cloneFrom:function(e){var t=this;t.acceptsReference=e.acceptsReference,t.arrayFormulaMode=e.arrayFormulaMode}};var D=_.Reference,P=_.Value,N=g.CalcArray,F=_.Name,L=_.NotAvailable,H=_.DivideByZero;g.EvaluateContext=O;var V=function(){function e(e,t){this.id=e._asyncId++,this.ctx=e,this.row=e.row+(e.arrayFormulaMode&&e.rowOffset||0),this.col=e.column+(e.arrayFormulaMode&&e.columnOffset||0),this.node=t}return e.prototype.setAsyncResult=function(e){this.node._result=e,this.node._hasResult=!0,this.ctx.SetAsyncResult(this,e),this.ctx.source.refresh()},e}();g.AsyncEvaluateContext=V;var j=function(e){function t(t,n,r,o,i,a,s,l){e.call(this,t,n,r,o,i,a,s,l),this._globalSource=t._getCalcServiceInternal().getGlobalSourceModel().getSource()}return y(t,e),t.prototype.getName=function(e){var t=this;return t._globalSource?t._globalSource.getCustomName(e):b},t}(O);g.GloableEvaluateContext=j,g.Evaluator=function(){function e(e){this._aync={},this._aync2={},this.asyncManager=new U(this),this.service=e}return e}(),g.Evaluator.prototype={evaluateExpression:function(e,t,n,r,o){var i=this.evaluate(e,t,!!r,!!o);return i===w||i===b?!1===n?i:0:"number"==typeof i&&i.toString().length>=15?+i.toPrecision(15):i},evaluate:function(e,t,n,r){if(!e)throw E().Exp_ExprIsNull;for(;10===e.type&&e.value;)e=e.value;var o,i=this,a=b;if(12===e.type&&(a=e.needExpendIndexs,e=e.value),e.type>=2&&e.type<=6)o=i.evaluateConst(e,t,n);else if(1===e.type||13===e.type)o=i.evaluateReference(e,t,r,n);else if(8===e.type)o=i.evaluateName(e,t,n,r);else if(9!==e.type||e.value2){if(9===e.type)o=i.evaluateBinaryOperation(e,t,n,r,a);else if(7===e.type)o=i.evaluateFunction(e,t,n,r,a);else if(11===e.type)o=w;else if(t.evaluate)return t.evaluate(e,n,r)}else o=i.evaluateUnaryOperation(e,t,n,r,a);return o},evaluateConst:function(e,t,n){var r=e.value;return A._isArray(r)?n||t&&(t.arrayFormulaMode||t._isExpandArrayToMultiCall())?r:r.getValue(0,0):r},evaluateReference:function(e,t,n,r){if(!t)return P;var o=(13===e.type?e.source():e.source)||t.source,i=t.row,a=t.column,s=e.getRange&&e.getRange(i,a);if(!s)return D;var l=s.row<0?0:s.row,u=s.col<0?0:s.col,c=s.rowCount,f=s.colCount;if(n||t.arrayFormulaMode)return e.endSource?t.getSheetRangeReference({source:e.source,endSource:e.endSource,row:l,col:u,rowCount:c,colCount:f}):t.getReference(o,s);if(r&&(c>1||f>1)){for(var d=[],p=0;p<c;p++){d[p]=[];for(var h=0;h<f;h++)d[p][h]=o.getValue(p+l,h+u)}return new N(d)}if(c>1||f>1){var m=i>=s.row&&i<s.row+c,g=a>=s.col&&a<s.col+f;if(m&&g)l=i,u=a;else{if(!m&&!g)return P;if(m&&1===f)l=i;else{if(!g||1!==c)return P;u=a}}}else if(-1===s.row&&-1===c){if(1!==f)return P;l=i}else if(-1===s.col&&-1===f){if(1!==c)return P;u=a}return o.getValue(l,u)},evaluateName:function(e,t,n,r){if(!t)return F;var o;e.source&&(o=e.source,t=o.getEvaluatorContext(t.identity,t.arrayFormulaMode,t.arrayIdentity));var i=t.getName(e.value);return i?this.evaluate(i,t,n,r):F},evaluateUnaryOperation:function(e,t,n,r,o){var i=!1;o&&o.length>0&&(n=!0,i=!0);var a=this.evaluate(e.value,t,n,i);return A._isError(a)?a:a===g.missingArgument?L:this.evaluateWithArgs(e,function(t){return z(e.operatorType,t[0])},t,o,[a],n,r)},evaluateBinaryOperation:function(e,t,n,r,o){var i=[n,n],a=e.operatorType>=15,s=[a,a];if(o&&o.length>0)for(var l=0;l<o.length;l++)i[o[l]]=!0,s[o[l]]=!0;var u=[e.value,e.value2],c=[];for(l=0;l<2;l++){var f=this.evaluate(u[l],t,i[l],s[l]);if(A._isError(f))return f;if(f===g.missingArgument)return L;c[l]=f}return this.evaluateWithArgs(e,function(t){return z(e.operatorType,t[0],t[1])},t,o,c,n,r)},startCache:function(){this._functionResultCaches={},this.asyncManager.startCalc()},endCache:function(){this._functionResultCaches=b},evaluateFunction:function(e,t,n,r,o){if(!e||!e.function||"string"==typeof e.function)return F;var i,a,s=e.arguments.length,l=this,u=t._asyncCount,c=e.function,f=b;if(c instanceof J.AsyncFunction&&this.asyncManager.startCalcFunction(c,e.arguments,t),0===s)i=[];else{i=[];for(var d=[],p=[],h=0;h<s;h++)d[h]=c.acceptsArray(h),p[h]=c.acceptsReference(h);if(o&&o.length>0){for(f=[],h=0;h<s;h++)f[h]=!0;for(h=0;h<o.length;h++){var _=o[h];d[_]=!0,p[_]=!0,f[_]=!(c.acceptsReference(_)&&!c.acceptsArray(_))}}c.isBranch()&&(t.arrayFormulaMode||t._isExpandArrayToMultiCall())&&(d[c.findTestArgument()]=!0,p[c.findTestArgument()]=!0);var v,y=-1,w=-1;for(c.isBranch()&&(y=c.findTestArgument(),c.acceptsArray(y)&&t._beginExpandArrayToMultiCall(),v=l.evaluate(e.arguments[y],t,d[y],p[y]),c.acceptsArray(y)&&t._endExpandArrayToMultiCall(),A._isReference(v)||A._isArray(v)||(w=c.findBranchArgument(v))),h=0;h<s;h++){if(y===h)a=v;else{if(w>=0&&h!==w){i[h]=null;continue}c.acceptsArray(h)&&t._beginExpandArrayToMultiCall(),a=l.evaluate(e.arguments[h],t,d[h],p[h]),c.acceptsArray(h)&&t._endExpandArrayToMultiCall()}if(!c.acceptsArray(h)&&A._isArray(a)||!c.acceptsReference(h)&&A._isReference(a)){var C=A._isArray(a)?a:b,S=A._isReference(a)?a:b;if(C&&1===C.getRowCount()&&1===C.getColumnCount())a=C.getValue(0,0);else if(S&&1===S.getRowCount(0)&&1===S.getColumnCount(0))a=S.getValue(0,0,0);else{var x=[],T=!1;if(o)for(var E=0;E<o.length;E++)x.push(o[E]),o[E]===h&&(T=!0);T||(x.push(h),o=x)}}if(A._isError(a)&&!c.acceptsError(h))return a;a===g.missingArgument&&(c.acceptsMissingArgument(h)||(a=b)),i[h]=a}}return l.evaluateWithArgs(e,function(e,n){var o;if(o=m(e,c._argsLimit),e=o._args,c.isContextSensitive())return t.acceptsReference=r||t._isExpandArrayToMultiCall(),c instanceof J.AsyncFunction?(l._ayncFunctionResultCaches=l._ayncFunctionResultCaches||{},c.evaluateWhenArgumentsIsSame()?l.evaluateAsyncFunction(t,n,c,u,e):l.evaluateWithCache(c,e,function(){return l.evaluateAsyncFunction(t,n,c,u,e)},l._ayncFunctionResultCaches)):c.evaluateWithContext(t,e);var i=function(){return o._isExecuteFunc?c.evaluate.apply(c,e):o._result};return t.arrayFormulaMode?l.evaluateWithCache(c,e,i,l._functionResultCaches):i()},t,o,i,n,r,f)},evaluateAsyncFunction:function(e,t,n,r,o){var i=this.asyncManager.getNode();if(i._hasResult)s=i._result;else if(i.canEvaluate()){var a=new V(e,i),s=n.evaluateWithContext(a,o);s===w&&(s=i._result!==w?i._result:n.defaultValue())}else s=i._result!==w?i._result:n.defaultValue();return i._result=s,this.asyncManager.endCalcFunction(),s},evaluateWithCache:function(e,t,n,r){if(r){var o=!1,i=r[e.name+t.length];if(i)for(h=0;h<i.length;h++){var a=i[h];if(o=!1,a.args.length===t.length){o=!0;for(var s=0;s<t.length;s++){var l=a.args[s],u=t[s];if(l!==u){if(!(l instanceof g.CalcReference&&u instanceof g.CalcReference)){o=!1;break}var c=l._rangeCount;if(l._source!==u._source||c!==u._rangeCount){o=!1;break}for(var f=0;f<c;f++)if(l.getRow(f)!==u.getRow(f)||l.getColumn(f)!==u.getColumn(f)||l.getRowCount(f)!==u.getRowCount(f)||l.getColumnCount(f)!==u.getColumnCount(f)){o=!1;break}}}}if(o)return a.flag++,a.value}else i=r[e.name+t.length]=[]}var d=n();if(r&&d!==w){var p=i.length;if(p>=100){var h,m=[];for(h=0;h<p;h++)i[h].flag>0&&m.push(i[h]);m.sort(function(e,t){return t.flag-e.flag}),p=Math.min(50,m.length),i=m.slice(0,p),r[e.name+t.length]=i}i.push({args:t,value:d,flag:0})}return d},SetAsyncResult:function(e){var t=e.ctx;t.source._getCalcServiceInternal().recalculate(t.source,e.row,e.col,!0)},evaluateWithArgs:function(e,t,n,r,o,i,a,s){if(r&&r.length>0){var l=this._expandArgs(n,e,o,r,s);if(!l)return L;for(var u,c=[],f=l[0].length,d=l[0][0].length,p=0;p<f;p++){c[p]=[];for(var h=0;h<d;h++)try{for(var m=[],_=0;_<o.length;_++)m[_]=l[_][p][h];if(u=t(m,e),A._isReference(u)){if(7===e.type){var v=e.function;if(v.returnReference&&v.returnReference())return u}u=this.getOneValue(n,u)}c[p][h]=u}catch(e){c[p][h]=P}}return new g.CalcArray(c)}try{if(u=t(o,e),n.arrayFormulaMode&&n._isExpandArrayToMultiCall())return u;if(A._isArray(u)&&!i)return this.getOneValue(n,u);if(A._isReference(u)&&!a){var y=u;if(i&&1===y.getRangeCount()){for(var b=[],w=0;w<y.getRowCount(0);w++){b[w]=[];for(var C=0;C<y.getColumnCount(0);C++)b[w][C]=y.getValue(0,w,C)}return new g.CalcArray(b,y.getColumnCount(0))}return this.getOneValue(n,u)}return u}catch(e){return P}},getOneValue:function(e,t){var n,r;if(A._isReference(t)){var o=t;o.getRangeCount()>1?t=P:(-1!==e.rowOffset||-1!==e.columnOffset?(n=1===o.getRowCount(0)?0:e.rowOffset-o.getRow(0),r=1===o.getColumnCount(0)?0:e.columnOffset-o.getColumn(0)):(n=1===o.getRowCount(0)?0:e.row-o.getRow(0),r=1===o.getColumnCount(0)?0:e.column-o.getColumn(0)),t=n>=o.getRowCount(0)||r>=o.getColumnCount(0)?L:o.getValue(0,n,r))}else if(A._isArray(t)){var i=t;!e.arrayFormulaMode||-1===e.rowOffset&&-1===e.columnOffset?t=i.getValue(0,0):(n=1===i.getRowCount()?0:e.rowOffset,r=1===i.getColumnCount()?0:e.columnOffset,t=n>=i.getRowCount()||r>=i.getColumnCount()?L:i.getValue(n,r))}return t},_expandArgs:function(e,t,n,o,i){var a=1,s=1,l=-1,u=!0,c=!0,f=null,d=null,p=1,h=1,m=7===t.type?t:b;if(m&&!m.function.expandRows()&&(u=!1),m&&!m.function.expandColumns()&&(c=!1),m&&m.function.isBranch()&&(e.arrayFormulaMode||e._isExpandArrayToMultiCall())){l=m.function.findTestArgument();var g=[],_=!1;if(o)for(var y=0;y<o.length;y++)g.push(o[y]),o[y]===l&&(_=!0);if(_||A._isArray(n[l])||A._isReference(n[l])){for(var C=0;C<m.arguments.length;C++)C!==l&&v._ArrayHelper._indexOf(g,C)<0&&(A._isArray(n[C])||A._isReference(n[C]))&&g.push(C);o=g}}for(var S=0;S<o.length;S++){var x=n[o[S]];if(f=A._isArray(x)?x:null,d=A._isReference(x)?x:null,p=0,h=0,f)p=f.getRowCount(),h=f.getColumnCount();else if(d){if(d.getRangeCount()>1)return b;p=u?d.getRowCount(0):1,h=c?d.getColumnCount(0):1}a=p>a?p:a,s=h>s?h:s}for(var T=[],E=0,M=o[E],k=0;k<n.length;k++){T[k]=[];var R=n[k];if(f=b,d=b,p=h=1,k===M){if(f=A._isArray(R)?R:b,d=A._isReference(R)?R:b,(f||d)&&(p=f&&f.getRowCount()||(u?d.getRowCount(0):1),h=f&&f.getColumnCount()||(c?d.getColumnCount(0):1),(1!==p&&p!==a||1!==h&&h!==s)&&(-1===l||k===l)&&!e.arrayFormulaMode))return b;E++,M=E<o.length?o[E]:-1}else if(i===w&&(f=A._isArray(R)?R:b,d=A._isReference(R)?R:b,(f||d)&&(p=f&&f.getRowCount()||(u?d.getRowCount(0):1),h=f&&f.getColumnCount()||(c?d.getColumnCount(0):1),(1!==p&&p!==a||1!==h&&h!==s)&&(-1===l||k===l)&&!e.arrayFormulaMode)))return b;if(d){var I=d.getRow(0),O=d.getColumn(0);a=I+a-I,s=O+s-O}for(var D=0;D<a;D++){T[k][D]=[];for(var P=0;P<s;P++)1!==p&&D>=p||1!==h&&P>=h?T[k][D][P]=L:f?T[k][D][P]=f.getValue(1===p?0:D,1===h?0:P):d?!i||i[k]?T[k][D][P]=d.getValue(0,1===p?0:D,1===h?0:P):T[k][D][P]=d.create([r(d.getRow(0)+(1===p?0:D),d.getColumn(0)+(1===h?0:P),1,1)]):T[k][D][P]=R}}return T}};var B=function(){function e(e,t){this.id=e,this._result=w,this._hasResult=!1,this._children=[],t!==w&&(this.evaluateMode=t)}return e}();B.prototype={canEvaluate:function(){for(var e=this._children,t=0;t<e.length;t++)if(!e[t]._hasResult)return!1;return!0}};var U=function(){function e(e){this._stack=[],this._stackIndex=-1,this._nodes={},this._cellFunctionId=-1,this._evaluator=e}return e}();U.prototype={startCalc:function(){var e;for(var t in this._nodes){var n=this._nodes[t];if((e=n.length)>0)for(var r=0;r<e;r++){var o=n[r];0===o.evaluateMode&&(o._hasResult=!1)}}},startCalcCell:function(e,t){var n=this,r=e.getName()+"_"+t.row+"_"+t.col;n._cellFunctionId=-1,n.source=e;var o=n._nodes[r];if(o)return void(n.cellNodes=o);var i=new B(-1);o=n._nodes[r]=[],n._stackIndex=-1,n.cellNodes=o,n.row=t.row,n.col=t.col,o.root=i,n._stack[++n._stackIndex]=i,n.evaluateMode=-1},startCalcFunction:function(e,t,n){var r=this;r._cellFunctionId++,r.isNewNode=!1;var i=r.cellNodes[r._cellFunctionId];if(i)return r.currentNode=i,i;r.isNewNode=!0;var a=r.evaluateMode,s=e.evaluateMode();if("REFRESH"===e.name?(s=t[1]?r._evaluator.evaluate(t[1],n,!1,!1):0,r.evaluateMode=s):-1!==a&&(s=a),i=new B(r._cellFunctionId,s),r.cellNodes[r._cellFunctionId]=i,r._stack[r._stackIndex]._children.push(i),i.parent=r._stack[r._stackIndex],r._stack.push(i),r._stackIndex++,r.currentNode=i,2===s&&-1===a){var l=6e4,u=r.intervals,c=e.interval()||l;"REFRESH"===e.name&&(i.isRefresh=!0,c=t[2]?r._evaluator.evaluate(t[2],n,!1,!1):l),u||(r.intervals=u={});var f=u[c];f||(f=u[c]=[],f.intervalObj=window.setInterval(function(){for(var e=0;e<f.length;e++){var t=f[e],n=t.node;n._hasResult=!1,n.isRefresh&&o(n),r._evaluator.service.recalculate(t.source,t.row,t.col,!0),r.source.refresh()}},c));for(var d=!1,p=0;p<f.length;p++){var h=f[p];if(h.source===r.source&&h.node===i&&h.row===r.row&&h.col===r.col){d=!0;break}}d||f.push({source:r.source,node:i,row:r.row,col:r.col})}return i},getNode:function(){return this.currentNode},endCalcFunction:function(){this.isNewNode&&(this._stack.pop(),this._stackIndex--),this.currentNode=this.currentNode.parent},endCalcCell:function(){},clearCell:function(e,t){var n=e.getName()+"_"+t.row+"_"+t.col;self._nodes[n]&&delete self._nodes[n];var r=self.intervals;for(var o in r){for(var i=r[o],a=[],s=0;s<i.length;s++){var l=i[s];l.source===e&&l.row===t.row&&l.col===t.col||a.push(l)}a.length?a.length!==i.length&&(a.intervalObj=i.intervalObj,r[o]=a):window.clearInterval(i.intervalObj)}},setAsyncResult:function(e,t){e._result=t}};var W=function(e){var t=!0;if(e&&e.getValue){var n=I(e,0,!1,!0);n.isError?e=n[0]:1===n.rowCount&&1===n.colCount?e=n[0][0]:(e=n,t=!1)}return{value:e,success:t}},z=g.evaluateOperator=function(e,t,n){return R(t)?t:R(n)?n:e<=2?i(e,t):e<=14?a(e,t,n):c(e,t,n)},Y=A._toDouble,G=A._toInt,K=A._toString,X=A._tryToDateTime,q=A._toBool,J=g.Functions;d.prototype={_getReal:function(){return this._real},_getImag:function(){return this._imag},_toString:function(e){e=e||"i";var t=this,n=t._real,r=t._imag,o="";return 0===n&&0!==r||(o+=n.toString()),-1===r?o+="-":0!==n&&r>0&&(o+="+"),-1!==r&&0!==r&&1!==r&&(o+=r.toString()),0!==r&&(o+=e),o}},J._Complex=d,J._convertToComplex=p},function(e,t,n){function r(e){this._args=e}function o(e){return"boolean"==typeof e}function i(e){return"string"==typeof e}function a(e){return"number"==typeof e}function s(e){return e%400==0||e%4==0&&e%100!=0||1900===e}function l(e,t){switch(t){case 0:case 2:case 4:return 360;case 1:return s(e.getFullYear())?366:365;case 3:return 365;default:return-1}}function u(e,t){return e-t}function c(e,t){return E(t,[0,2,4,6,7,9,11])>=0?31:E(t,[3,5,8,10])>=0?30:1===t?s(e)?29:28:void 0}function f(e,t,n,r){var o=n.getFullYear(),i=n.getMonth(),a=n.getDate(),s=r.getFullYear(),l=r.getMonth(),u=r.getDate();if(e){var f=2===i&&c(o,i)===a,d=2===l&&c(s,l)===u;t?(f&&(a=30),d&&(u=30)):f&&d&&(a=30,u=30),31===u&&a>=30&&(u=30)}else 31===u&&(u=1,t&&l++);return 31===a&&(a=30),360*(s-o)+30*(l-i)+u-a}function d(e,t,n){var r=1;return u(e,t)>0&&(e=[t,t=e][0],r=-1),E(n,[1,2,3])>=0?r*B(C(t)-C(e)):E(n,[4,5])>=0?r*f(!1,5===n,e,t):r*f(!0,6===n,e,t)}function p(e){var t,n,r;return 0===e?n=0:(r=.5*R(e),r>=3?n=1:r<1?(t=r*r,n=((((((((.000124818987*t-.001075204047)*t+.005198775019)*t-.019198292004)*t+.059054035642)*t-.151968751364)*t+.319152932694)*t-.5319230073)*t+.797884560593)*r*2):(r-=2,n=(((((((((((((-45255659e-12*r+.00015252929)*r-19538132e-12)*r-.000676904986)*r+.001390604284)*r-.00079462082)*r-.002034254874)*r+.006549791214)*r-.010557625006)*r+.011630447319)*r-.009279453341)*r+.005353579108)*r-.002141268741)*r+.000535310849)*r+.999936657524)),e>0?.5*(n+1):.5*(1-n)}function h(e,t,n,r,o){var i,a,s,l,u,c,f,d,p,h=n<100,m=2===n||102===n,g=m||3===n||103===n,_=5===n||105===n,v=4===n||104===n||_,y=9===n||109===n,b=1===n||101===n||y||r,w=6===n||106===n,C=w?1:0,x=!1,T=0;for(i=0;i<S(e);i++){var E,A=e[i];if(g?E=z(A,0,!1,!1,!1,m):v?E=z(A,5,!1,!0,!1,!0):b?E=z(A,5,!1,y,!1,!0):w&&(E=z(A,5,!1,!1,!1,!0)),E.isError)return E[0];if(E.isConvertError)return N;var k=E.rangeCount,R=E.isReference;for(a=0;a<k;a++)for(s=k>1?E[a]:E,R&&(l=A.getRow(a),u=A.getColumn(a)),c=0;c<S(s);c++)if(t||!R||!A.isHiddenRow(a,c,h))for(d=s[c],f=0;f<S(d);f++)!t&&R&&A.isSubtotal(a,c+l,f+u)||(p=d[f])!==V&&(g&&!M(p)&&(!m||""!==p&&W(p,!0))?C++:v&&(!x||_&&p<C||!_&&p>C)?C=p:b?r?(o.sumx+=p,o.sumx2+=p*p,o.n++):(C+=p,T++):w&&(C*=p,T++),x=!0)}return b?y?C:r?void 0:0===T?L:Y(C/T):w?Y(T>0?C:0):C}function m(e,t,n){var r,o=n%100,i=7===o||8===o,a=7===o||10===o?1:0,s={sumx:0,sumx2:0,n:0};return h(e,t,n,!0,s),s.n<=a?L:(r=Math.max(0,(s.n*s.sumx2-s.sumx*s.sumx)/(s.n*(s.n-a))),Y(i?Math.sqrt(r):r))}function g(e){var t,n=1;for(t=e;t>1;t--)n*=t;return n}function _(e,t,n){var r=e.getDate(),o=t.getDate(),i=e.getMonth(),a=t.getMonth(),s=e.getFullYear(),l=t.getFullYear();return r=31===r?30:r,n?o=31===o?30:o:31===o&&(r<30?(o=1,++a>12&&(a=1,l++)):o=30),30*(12*(l-s)+a-i)+o-r}function v(e,t,n){function r(e,t,n){var r,o=d(e,t,n);if(o<0&&(o=-o,e=[t,t=e][0]),1===n){var i,a,c,f,p=e.getFullYear(),h=t.getFullYear();i=new Date(e),i.setFullYear(i.getFullYear()+1),u(t,i)>0?(f=h+1-p,i=new Date(p,0,1),a=new Date(h+1,0,1),c=B(C(a)-C(i))-365*(h+1-p)):(f=1,c=s(p)&&e.getMonth()<3||s(h)&&256*t.getMonth()+t.getDate()>=541?1:0);r=365+U(c)/U(f)}else r=l(new Date,n);return o/r}return n<0||n>4?F:r(e,t,n)}function y(e,t){function n(e,t,n){var r;return 0===e?r=t<=n:1===e?r=t>=n:2===e?r=t!==n:3===e?r=t<n:4===e?r=t===n:5===e&&(r=t>n),r}var r=-1,o=!0,i={value:0},a=x._getWildcardCriteriaFullMatch(t);if(4===e&&a)var s=function(e){var t=x._getRegIgnoreCase(a);return t.lastIndex=0,t.test(e)};return M(t)?r=0:a?o=!1:j(t.toString(),i)?r=i.value:o=!1,function(i){M(i)&&(i="");var l={value:0};return o&&j(i,l)?n(e,l.value,r):(!a||!W(i,!0))&&(a&&s?s(i.toString()):n(e,i.toString().toUpperCase(),M(t)?"":t.toString().toUpperCase()))}}var b=n(0),w=n(22),C=b._DateTimeHelper._toOADate,S=b._ArrayHelper._getLength,x=b._RegexHelper,T=b._Types,E=T._inArray,M=T._isNullOrUndefined,A=void 0,k=isNaN,R=Math.abs,I=Math.exp,O=Math.log,D=Math.pow,P=w.Errors,N=P.Value,F=P.Number,L=P.DivideByZero,H=w.Convert,V=H.CalcConvertedError,j=H._tryToDouble,B=H._toInt,U=H._toDouble,W=H._isNumber,z=H._toArray,Y=H._toResult,G=w.Functions,K=w._Helper,X=K._approxEqual,q=function(){return b._getResource(w.SR)()};r.prototype={_acceptsArgs:function(e){var t,n=this._args;if(T._isArray(n)||(n=[n]),-1===n[0])return!0;for(t=0;t<n.length;t++){var r,o,a=n[t];if(i(a)){if(a=a.split(" "),r=a[0],o=parseInt(a[1]),"!="===r&&e!==o||">"===r&&e>o||">="===r&&e>=o||"%="===r&&e%2===o)return!0}else if(e===a)return!0}return!1},_checkArgs:function(){return this._args}},G._defineBuiltInFunction=function(e,t,n,o,i,a,s,l){function u(e,t,n){if(M(e))throw q().Exp_InvalidFunctionName;if(e=e.toUpperCase(),G._builtInFunctions[e])throw q().Exp_InvalidOverrideFunction;var o=G._builtInFunctions[e];if(o){if(!n||!n.override)throw q().Exp_OverrideNotAllowed}else G._builtInFunctions[e]=o=new G.Function(e,0,255);return t&&"function"==typeof t&&(o.evaluate=t),T._each(n,function(e,t){var i;E(e,["acceptsReference","acceptsArray","acceptsError","acceptsMissingArgument","precedentReference","expandColumns","expandRows"])>=0?(i=new r(t),o[e]=function(e){return i._acceptsArgs(e)}):E(e,["isVolatile","isBranch","findTestArgument","returnReference","isContextSensitive"])>=0?(i=new r(t),o[e]=function(){return i._checkArgs()}):n.hasOwnProperty(e)&&"override"!==e&&(o[e]=t)}),o}return l||(l={}),n!==A&&(l.minArgs=n),o!==A&&(l.maxArgs=o),a!==A&&(l.acceptsReference=a),s!==A&&(l.acceptsArray=s),i!==A&&(l._argsLimit=i),l._acceptsMissingArgument!==A&&(l.acceptsMissingArgument=l._acceptsMissingArgument),l._isVolatile!==A&&(l.isVolatile=l._isVolatile),l._isContextSensitive!==A&&(l.isContextSensitive=l._isContextSensitive),l._precedentReference!==A&&(l.precedentReference=l._precedentReference),l._arrayArgumentEvaluateMode!==A&&(l.arrayArgumentEvaluateMode=l._arrayArgumentEvaluateMode),l._acceptsError!==A&&(l.acceptsError=l._acceptsError),u(e,t,l)},G._MAX_DOUBLE_VALUE=1.79769e308,G._isBoolean=o,G._isString=i,G._isNumber=a,G._isLeapYear=s,G._annualYearBasis=l,G._compareDateTime=u,G._getDaysInMonth=c,G._daysBetweenBasis=d,G._st_normsdist=p,G._st_includeSubstotals=h,G._st_devVarIncludeSubtotals=m,G._fact=g,G._days360=_,G._yearfrac=v;var J={},Z={_approxFloor:function(e){var t=Math.floor(e);return X(e,t+1)?t+1:t},_parseCriteria:function(e){var t=e,n=J;n||(J=n={});var r=n[t];if(r)return r;if(W(e))return r=n[t]=y(4,e);var o,i,a="=><",s=M(e)?"":e.toString().toUpperCase(),l="\0";for(o=0;o<2&&o<S(s);o++){if(i=s[o],-1===a.indexOf(i)){if("<"===l)return n[t]=r=y(3,s.substring(1)),r;if(">"===l)return n[t]=r=y(5,s.substring(1)),r;break}if("="===i)return r="<"===l?y(0,s.substring(2)):">"===l?y(1,s.substring(2)):y(4,"\0"===l?s.substring(1):e),n[t]=r,r;if("\0"===l)l=i;else{if("<"===l)return r=">"===i?y(2,s.substring(2)):y(3,s.substring(1)),n[t]=r,r;if(">"===l)return n[t]=r=y(5,s.substring(1)),r}}return n[t]=r=y(4,e),r},_pow10:function(e){var t=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13,1e14,1e15,1e16][e];return M(t)?D(10,parseFloat(e)):t},_approxCeiling:function(e){var t=Math.ceil(e);return X(e,t-1)?t-1:t},_round:function(e,t){var n=Z._pow10(R(t));return e=t<0?e/n:e*n,e=e<0?Z._approxCeiling(e-.5):Z._approxFloor(e+.5),e=t<0?e*n:e/n,Y(e)},_combin:function(e,t){if(e<0||t<0||e<t)return F;var n,r=1;for(t=Math.min(e-t,t),n=1;n<=t;n++)r*=e-n+1,r/=n;return Y(r)},_pow1p:function(e,t){var n=R(e)>.5?D(1+e,t):I(t*O(1+e));return isFinite(n)?k(n)&&(n=5e-324):n===Number.POSITIVE_INFINITY?n=G._MAX_DOUBLE_VALUE:n===Number.NEGATIVE_INFINITY&&(n=-G._MAX_DOUBLE_VALUE),n},_sinhCosh:function(e,t){return(I(e)+(t?-1:1)*I(-e))/2},_log:function(e,t){return k(e)?e:k(t)?t:1!==t&&1===e||0!==t&&t!==Number.POSITIVE_INFINITY?O(e)/O(t):NaN}};G._MathHelper=Z,e.exports=G},function(e,t,n){function r(e,t){for(;0!==t;){var n=e%t;e=t,t=n}return e}function o(e,t){return t=t<0?nn(t):Math.ceil(t),(e&&t%2==0||!e&&t%2!=0)&&(t+=t<0?-1:1),t}function i(e,t,n){return t>0&&n<0?gn:t<0&&n>0?(n=-n,e?Bn(t/n)*n:jn(t/n)*n):e?jn(t/n)*n:Bn(t/n)*n}function a(e,t,n){var r,o,i=Vn._pow10(Qt(n));return t=n<0?t/i:t*i,r=jn(t),o=Bn(t),e&&(r=[o,o=r][0]),t=t<0?r:o,t=n<0?t*i:t/i,An(t)}function s(e,t,n,r){var o,i,a,s=t?-1:1,l=0;if(zt(n)!==zt(r))return mn;for(a=0;a<zt(n);a++)o=n[a],i=r[a],o!==vn&&i!==vn&&(l+=e?(o-i)*(o-i):o*o+s*i*i);return An(l)}function l(e){return An(Qt(e))}function u(e){return Bn(e)}function c(e,t){var n,r=1;if(e<t)return gn;for(t=tn(e-t,t),n=1;n<=t;n++)r*=e-n+1,r/=n;return An(r)}function f(e){return 180*e/an}function d(e){return o(!0,e)}function p(e){return o(!1,e)}function h(e){return Fn(e)}function m(e){var t,n=1;for(t=e;t>1;t-=2)n*=t;return n}function g(e){return An(on(e))}function _(e,t){return e-t*nn(e/t)}function v(){return an}function y(e,t){return ln(e,t)}function b(){var e,t=arguments,n=0;for(e=0;e<zt(t);e++){var r,o,i=t[e];if(yn(i))return i;if(bn(i)||wn(i)){if(r=Mn(i,1,!0,!0,!1),r.isError)return r[0]}else r=Mn(i,1,!0,!0,!0);for(o=0;o<zt(r);o++)r[o]!==vn&&(n+=r[o])}return n}function w(e){return 0===e?0:-1}function C(){var e,t,n,o,i=arguments,a=0;for(e=0;e<zt(i);e++)for(n=i[e],t=0;t<zt(n);t++)if((o=n[t])!==vn){if(o<0)return gn;a=r(a,Sn(o))}return a}function S(){var e,t,n,o,i=arguments,a=1,s=[];for(e=0;e<zt(i);e++){for(n=i[e],t=0;t<zt(n);t++)if((o=n[t])!==vn){if(o<0)return gn;if(0===o)return 0;s.push(Sn(o))}for(t=0;t<zt(s);t++)o=s[t],a/=r(a,o),a*=o}return a}function x(){return Ln(arguments,!0,6)}function T(e){return $t(e)}function E(e,t){return Zt((e/t).toString())}function M(e){for(var t=arguments,n=[],r=dn,o=1;o<zt(t);o++)n[o-1]=t[o];return Gt(e,[1,101,2,102,3,103,4,104,5,105,6,106,9,109])>=0?r=Ln(n,!1,e):Gt(e,[7,107,8,108,10,110,11,111])>=0&&(r=Hn(n,!1,e)),r}function A(e,t){return i(!0,e,t)}function k(e,t){return i(!1,e,t)}function R(e,t){return e<0&&t>0||t<0&&e>0?gn:Bn(e/t+.5)*t}function I(e,t){return Vn._round(e,t)}function O(e,t){return a(!1,e,t)}function D(e,t){return a(!0,e,t)}function P(e){return An(rn(e))}function N(e,t){return jn(e/Qt(t))*Qt(t)}function F(e,t){return Bn(e/Qt(t))*Qt(t)}function L(e,t){return 1===t?fn:An(Vn._log(e,t))}function H(e){return An(Vn._log(e,10))}function V(e,t,n){if(n=n!==Xt?n:e,Kt(t))throw Wn().Exp_CriteriaIsNull;var r,o=0,i=Vn._parseCriteria(t),a=wn(e),s=wn(n),l=e.toArray(0,!0,!1),u=n.toArray(1,!0,!1);if((a?1:e.getRangeCount())!==(s?1:n.getRangeCount())||(a?e.getRowCount():e.getRowCount(0))>(s?n.getRowCount():n.getRowCount(0))||(a?e.getColumnCount():e.getColumnCount(0))>(s?n.getColumnCount():n.getColumnCount(0)))return dn;if(l.isError)return l[0];if(u.isError)return u[0];for(r=0;r<zt(l);r++)i&&i(l[r])&&u[r]!==vn&&(o+=u[r]);return An(o)}function j(e){var t,n,r,o,i,a,s=arguments,l=zt(e),u=e.rowCount,c=e.colCount,f=[],d=[],p=0;for(o=1;o<zt(s);o+=2){if(a=Mn(s[o],0,!0,!1,!1),a.rowCount!==u||a.colCount!==c)return dn;i=Vn._parseCriteria(s[o+1]),f.push(a),d.push(i)}for(r=0;r<l;r++){for(n=!0,o=0;o<zt(f)&&(i=d[o],t=f[o][r],n=i&&i(t));o++);n&&(t=e[r])!==vn&&(p+=t)}return An(p)}function B(){var e,t,n,r,o,i,a,s,l=arguments,u=0,c=[];for(e=0;e<zt(l);e++){if(o=Mn(l[e],1,!0,!0,!1),o.isError)return o[0];if(o.isConvertError)return dn;if(0===e)t=o.rowCount,n=o.colCount,r=zt(o);else if(o.rowCount!==t||o.colCount!==n)return dn;c.push(o)}for(e=0;e<r;e++){for(i=1,a=0;a<zt(l);a++){if((s=c[a][e])===vn){i=0;break}i*=s}u+=i}return An(u)}function U(){var e,t,n,r,o=arguments,i=0;for(t=0;t<zt(o);t++)for(r=o[t],n=0;n<zt(r);n++)(e=r[n])!==vn&&(i+=e*e);return An(i)}function W(e,t){return s(!1,!0,e,t)}function z(e,t){return s(!1,!1,e,t)}function Y(e,t){return s(!0,!1,e,t)}function G(e,t,n,r){var o,i,a=0;for(o=0;o<zt(r);o++){if(i=xn(r[o]),qt(i))return dn;a+=i*ln(e,t+o*n)}return An(a)}function K(e){return An($t(e*an))}function X(e){return an*e/180}function q(e){return An(Math.sin(e))}function J(e){return An(Math.cos(e))}function Z(e){return An(Math.tan(e))}function Q(e){return An(Math.asin(e))}function $(e){return An(Math.acos(e))}function ee(e){return An(Vn._sinhCosh(e,!0))}function te(e){return An(Vn._sinhCosh(e,!1))}function ne(e){return An(on(e+$t(e*e+1)))}function re(e){return An(on(e+$t(e*e-1)))}function oe(e){return An(Math.atan(e))}function ie(e,t){return 0===e&&0===t?fn:An(Math.atan2(t,e))}function ae(e){var t=rn(e),n=rn(-e);return An(t-n)/(t+n)}function se(e){return An(on((1+e)/(1-e))/2)}function le(e){var t,n,r,o,i,a,s,l,u=e.rowCount,c=1;if(e.rangeCount>1||u!==e.colCount)return dn;for(t=0;t<u-1;t++){if(0===e[t][t]){for(a=!1,n=t+1;!a&&n<u;n++)if(0!==e[n][t]){for(o=t;o<u;o++)s=e[t][o],e[t][o]=e[n][o],e[n][o]=s;c*=-1,a=!0}if(!a)return 0}for(r=t+1;r<u;r++)if(0!==e[r][t])for(l=e[r][t]/e[t][t],i=t;i<u;i++)e[r][i]-=l*e[t][i]}for(t=0;t<u;t++)c*=e[t][t];return c}function ue(e){var t,n,r,o,i,a,s,l,u,c,f,d,p,h,m,g,_=e.rowCount,v=[];if(e.rangeCount>1||_!==e.colCount)return dn;for(t=0;t<_;t++)for(v[t]=[_],o=0;o<_;o++)v[t][o]=t===o?1:0;for(n=0;n<_;n++){if(0===e[n][n]){for(g=!1,i=n+1;!g&&i<_;i++)if(0!==e[i][n]){for(s=n;s<_;s++)h=e[n][s],e[n][s]=e[i][s],e[i][s]=h;for(l=1;l<_;l++)m=v[n][l],v[n][l]=v[i][l],v[i][l]=m;g=!0}if(!g)return gn}for(a=0;a<_;a++)if(a!==n&&0!==e[a][n]){for(d=e[a][n]/e[n][n],u=n;u<_;u++)e[a][u]-=d*e[n][u];for(c=0;c<_;c++)v[a][c]-=d*v[n][c]}}for(r=0;r<_;r++)for(p=e[r][r],f=0;f<_;f++)v[r][f]/=p;return new Ht.CalcArray(v)}function ce(e,t){var n,r,o,i,a,s,l=e.rowCount,u=e.colCount,c=t.rowCount,f=t.colCount,d=[];if(u!==c)return dn;for(o=0;o<l;o++)for(d[o]=n=[],r=e[o],i=0;i<f;i++){for(s=0,a=0;a<c;a++)s+=r[a]*t[a][i];n[i]=s}return new Ht.CalcArray(d)}function fe(){var e,t,n,r=arguments,o=0,i=1;for(t=0;t<zt(r);t++)for(e=r[t],n=0;n<zt(e);n++){var a=Sn(e[n]);if(a<0||170<a)return gn;o+=a,i*=Fn(a)}return o<0||170<o?gn:Fn(o)/i}function de(){return Qt(2*sn()-1)}function pe(e,t){return t<e?gn:Sn(e+sn()*(t-e+1))}function he(e,t){var n,r,o=["M","D","C","L","X","V","I"],i=[1e3,500,100,50,10,5,1],a=7,s=[];for(n=On(t)?t?0:4:t,r=0;r<a;r+=2){if(2<=r&&i[r-2]-i[r]<=e){var l,u=r,c=r-2;for(l=0;l<n&&u+1<a&&i[c]-i[u+1]<=e;l++)u++;s.push(o[u]),s.push(o[c]),e+=i[u],e-=i[c]}if(1<=r&&i[r-1]<=e&&(s.push(o[r-1]),e-=i[r-1]),1<=r&&i[r-1]-i[r]<=e){var f,d=r,p=r-1;for(f=0;f<n&&d+1<a&&i[p]-i[d+1]<=e;f++)d++;s.push(o[d]),s.push(o[p]),e+=i[d],e-=i[p]}for(;i[r]<=e;)s.push(o[r]),e-=i[r]}return s.join("")}function me(e,t){var n,r,o;for(n=0;n<zt(t);n++)for(o=t[n],r=0;r<zt(o);r++)if(e){if(!o[r])return!1}else if(o[r]&&o[r]!==vn)return!0;return!!e}function ge(){return me(!0,arguments)}function _e(){return me(!1,arguments)}function ve(e){var t={};return _n._tryToBool(e,t),!t.value}function ye(e,t,n){var r,o=e,i=t,a=Rn(o);r=n!==Xt?n:2!==zt(arguments)&&0;var s={};return Cn(a.value,s),s.value?i:r}function be(e,t){function n(e,t){return yn(e)?Kt(t)?0:t:Kt(e)?0:e}if(!yn(e)&&bn(e)){if(e.getRangeCount()>1)return dn;e=e.getValue(0,0,0)}return n(e,t)}function we(){return!0}function Ce(){return!1}function Se(e){var t,n=e.getFullYear(),r=e.getMonth(),o=e.getDate(),i=o;for(t=0;t<r;t++)i+=Nn(n,t);return i}function xe(e){if(Dn(e)){if(7!==zt(e)||qt(Zt(e)))return dn}else if(!qt(e)){if(nn(e)<1||nn(e)>17)return gn;e=e.toString()}var t,n=["1","2","3","4","5","6","7"],r=[0,0,0,0,0,0,0];switch(zt(e)){case 1:if(Gt(e,n)>=0){t=Zt(e),r[(t+4)%7]=1,r[(t+5)%7]=1;break}return gn;case 2:if("1"===e[0]&&Gt(e[1],n)>=0){t=Zt(e[1]),r[(t+5)%7]=1;break}return gn;case 7:for(t=0;t<7;t++)r[t]=Zt(e[t]);break;default:return dn}return r}function Te(e,t,n,r,o){var i=Be(t,3);if(yn(i))return i;for(var a=Sn(i);n<0;++n)t.setDate(t.getDate()-1),a=0===a?6:--a,(e&&(5===a||6===a)||!e&&o[a]||r.indexOf(Ut(t))>=0)&&n--;for(;n>0;--n)t.setDate(t.getDate()+1),a=6===a?0:++a,(e&&(5===a||6===a)||!e&&o[a]||r.indexOf(Ut(t))>=0)&&n++;return Ut(t)}function Ee(e,t,n,r,o,i){function a(e,t,n,r,o,i){var a,s;if(i&&(e=e!==Xt?e:"0000011",s=xe(e),yn(s)))return s;if(t!==Xt&&(a=Mn(t,4,!0,!0,!1)),!a)return o;if(a.isError)return a[0];var l,u=zt(a),c=[];for(l=0;l<u;l++){var f=a[l],d=Bt._fromOADate(f),p=d.getDay(),h=zt(s)?s[Be(d,3)]:6===p||0===p;-1===c.indexOf(f)&&!h&&f>=n&&f<=r&&c.push(f)}return o-=zt(c)}var s=Sn(Ut(t)),l=Sn(Ut(n)),u=!1;s>l&&(t=[n,n=t][0],s=[l,l=s][0],u=!0);var c=l-s+1;return c=i(t,n,c,r),e&&yn(c)?c:c<=0?0:(c=a(r,o,s,l,c,e),c=u?-c:c)}function Me(e,t,n){t=_n._toDateTime(t);var r=new Date(t.getFullYear(),t.getMonth(),1);r.setMonth(r.getMonth()+n);var o=Nn(r.getFullYear(),r.getMonth());return r.setDate(e?o:tn(t.getDate(),o)),r}function Ae(e,t,n){e<=1899&&(e+=1900);var r=new Date(e,t-1,n);return r<new Date(1899,11,30)?gn:r}function ke(e,t,n){var r=Bt._fromOADate(0);return r.setHours(e),r.setMinutes(t),r.setSeconds(n),r.setMilliseconds(0),r.getHours()<0&&r.getMinutes()<0&&r.getSeconds()<0?gn:r}function Re(e){var t,n;if(Dn(e)&&((t=Wt(e))||(t=new Date(e))&&!qt(t.valueOf())||(t=null)),!t)return dn;var r=t.getFullYear(),o=Se(t);if(r<1900)return dn;for(n=1900;n<r;n++)o+=365,Pn(n)&&o++;return o}function Ie(e){var t;return Dn(e)&&(t=Wt(e)),t?(60*(60*t.getHours()+t.getMinutes())+t.getSeconds())/86400:dn}function Oe(){return new Date}function De(){var e=new Date;return e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e}function Pe(e){return e.getHours()}function Ne(e){return e.getMinutes()}function Fe(e){return e.getSeconds()}function Le(e){return e.getDate()}function He(e){return e.getMonth()+1}function Ve(e){return e.getFullYear()}function je(e,t){if(1===t||2===t){var n=Se(e),r=new Date(e.getFullYear(),0,1).getDay();2===t&&(r-=1)<0&&(r=6);var o=n-1-(6-r);return o<0&&(o=0),1+Sn(o/7)+(o%7!=0?1:0)}return gn}function Be(e,t){var n=e.getDay();switch(t){case 1:return n+1;case 2:return 0===n?7:n;case 3:return 0===n?6:n-1;default:return gn}}function Ue(e,t){return Me(!1,e,t)}function We(e,t){return Me(!0,e,t)}function ze(e,t,n){return Te(!0,e,t,n)}function Ye(e,t,n,r){var o=xe(n);return yn(o)?o:"1111111"===o.join("")?dn:Te(!1,e,t,r,o)}function Ge(e,t,n){function r(e,t,n){var r=Sn(Ut(t)-Ut(e))%7,o=Sn(Be(e,2)+r),i=0===e.getDay()?1:2;return r=o>5?o-5:0,r=r>i?i:r,n-=r,n-=2*nn(n/7)}return Ee(!1,e,t,Xt,n,r)}function Ke(e,t,n,r){function o(e,t,n,r){r=r!==Xt?r:"0000011";var o,i=xe(r),a=0,s=0;if(yn(i))return i;for(o=0;o<zt(i);o++)1===i[o]&&a++;if(n<30){for(o=0;o<n;o++)i[(Sn(Be(e,3))+o)%7]&&s++;return n-=s}var l=n,u=0,c=0;for(o=0;o<l&&Sn(Be(e,3)+o)%7!=0;o++)u++;for(o=0;o<u;o++)i[(Sn(Be(e,3))+o)%7]&&s++;for(o=0;o<l&&(Sn(Be(t,3))+7-o)%7!=6;o++)c++;for(o=0;o<c;o++)i[(Sn(Be(t,3))+7-o)%7]&&s++;return l=l-u-c,n-=Sn(l/7)*a,n-=s}return Ee(!0,e,t,n,r,o)}function Xe(e,t,n){function r(){var e=[];return e[0]=function(e,t){return t.getFullYear()-e.getFullYear()+(t.getMonth()<e.getMonth()||t.getMonth()===e.getMonth()&&t.getDate()<e.getDate()?-1:0)},e[1]=function(e,t){return 12*(t.getFullYear()-e.getFullYear())+(t.getMonth()-e.getMonth())+(t.getDate()<e.getDate()?-1:0)},e[2]=function(e,t){return(t.getTime()-e.getTime())/864e5},e[3]=function(e,t){var n=new Date(t.getFullYear(),t.getMonth()+(t.getDate()<e.getDate()?-1:0),e.getDate());return(t.getTime()-n.getTime())/864e5},e[4]=function(e,t){return t.getMonth()-e.getMonth()+(t.getMonth()<e.getMonth()||t.getMonth()===e.getMonth()&&t.getDate()<e.getDate()?12:0)+(t.getDate()<e.getDate()?-1:0)},e[5]=function(e,t){return(t-new Date(t.getFullYear()+(t.getMonth()<e.getMonth()||t.getMonth()===e.getMonth()&&t.getDate()<e.getDate()?-1:0),e.getMonth(),e.getDate()))/864e5},e}n=n.toLocaleUpperCase();var o=r(),i=Gt(n,["Y","M","D","MD","YM","YD"]);if(t<e)return gn;if(i<0)throw Wn().Exp_NotSupported;return(0,o[i])(e,t)}function qe(e){var t,n=e.toString(),r="",o=[];e<0&&(n=n.substr(1),r="-");var i=n.split("."),a=zt(i);if(a<1||a>2)return dn;for(2===a&&(o.push(i[1]),o.push(".")),n=i[0],t=zt(n)-3;t>=0;t-=3)o.push(n.substr(t,3)),t>0&&o.push(",");return o.push(n.substring(0,t+3)),o.reverse(),r+o.join("")}function Je(e,t,n){return n>=zt(t)?t:t.substr(e?0:zt(t)-n,n)}function Ze(e){var t,n,r=[];for(t=0;t<zt(e);t++)0<=(n=e.charCodeAt(t))&&n<=31||127===n||128<=n&&n<=159||r.push(e[t]);return r.join("")}function Qe(e){e=e.trim();var t,n=[],r=!0;for(t=0;t<zt(e);t++){var o=e.charAt(t),i=" "===o||"\t"===o||"\n"===o;i&&!r||n.push(o),r=!i}return n.join("")}function $e(e,t){function n(e){var t=qe(e),n=[];return e<0&&(t=t.substr(1)),n.push("$"),n.push(t),e<0&&(n.push(")"),n.unshift("(")),n.join("")}return e=xn(I(e,t)),n(e)}function et(e,t,n){var r=0;return t<0&&(r=Sn(ln(10,Qt(t))),e/=r),e=xn(I(e,en(0,t))),t<0&&(e*=r),n?e.toString():qe(e)}function tt(e,t){function r(e){if(jt._startsWith(e,"[$-"))return e;var t,n=e.indexOf("[");if(-1!==n&&-1!==e.indexOf("]"))for(t=e.indexOf("]",n);-1!==n&&-1!==t;){var r=e.substring(0,n),o=e.substring(t+1);e=r.concat(o),n=e.indexOf("["),t=-1===n?-1:e.indexOf("]",n)}return e}if(""===t)return Tn(e);Kt(e)&&(e=0),t=r(t);try{var o=n(10),i=o&&o.GeneralFormatter;if(i){return new i(t).format(e)}return e.toString()}catch(e){return dn}}function nt(e){if(!e)return 0;var t,n=Wt(e);return Kt(n)?(n=Jt(e),qt(n)?dn:n):(t=Ut(n),yn(t)?Ie(n):t)}function rt(e){return e.toLowerCase()}function ot(e){return e.toUpperCase()}function it(e){var t=zt(e),n=[];if(t>0){var r=e.toUpperCase(),o=e.toLowerCase(),i=1;for(n[0]=r[0];i<t;)n[i]=Ht._isLetter(e[i-1])?o[i]:r[i],i++}return n.join("")}function at(e){return String.fromCharCode(e)}function st(e){return e[0].charCodeAt(0)}function lt(e,t,n,r){var o=zt(e);t=tn(t,o+1),n=tn(n||0,o-t+1);var i=e.substring(0,t-1),a=e.substr(t-1+n);return i.concat(r).concat(a)}function ut(e,t,n,r){var o,i=zt(t);if(zt(arguments)>3){var a,s=Sn(r),l=0;if(s<1)return dn;for(a=0;a<s;a++){if(-1===(l=e.indexOf(t,l)))return e;l+=i}var u=e.substring(0,l-i),c=e.substr(l);o=u.concat(n).concat(c)}else o=jt._join(e,t,n);return o}function ct(){var e,t,n=arguments,r=[],o=zt(n);for(e=0;e<o;e++){var i=n[e],a=zt(i);for(t=0;t<a;t++)Kt(i[t])||r.push(Tn(i[t]))}return r.join("")}function ft(e,t){return Je(!0,e,t)}function dt(e,t){return Je(!1,e,t)}function pt(e,t,n){t--;var r=zt(e);return t>=r?"":r<t+n?e.substr(t):e.substr(t,n)}function ht(e,t){var n,r=[];if(t<0||t*zt(e)>32767)return dn;for(n=0;n<t;n++)r.push(e);return r.join("")}function mt(e){return e?e.length:0}function gt(e,t,n){if(n<1||zt(t)<n)return dn;var r=t.indexOf(e,n-1);return-1===r?dn:r+1}function _t(e,t,n){var r,o,i=-1;return r=Vt._getWildcardCriteria(e),r?(o=Vt._getRegIgnoreCase(r).exec(t),i=Kt(o)?-1:o.index):i=t.toLowerCase().indexOf(e.toLowerCase(),--n),-1===i?dn:i+1}function vt(e,t){return e===t}function yt(e){return Dn(e)?e:""}function bt(e){return yn(e)}function wt(e){return!!yn(e)&&e._code!==mn._code}function Ct(e){return!!yn(e)&&e._code===mn._code}function St(e){if(!Kt(e)&&yn(e)){var t=Gt(e._code,[cn._code,fn._code,dn._code,pn._code,hn._code,gn._code,mn._code]);if(t>=0)return t+1}return mn}function xt(e){return En(e)}function Tt(e){return Bn(Qt(e))%2==0}function Et(e){return Bn(Qt(e))%2!=0}function Mt(e){return En(e)?xn(e):On(e)?e?1:0:yn(e)?e:0}function At(e){return Kt(e)}function kt(e){return On(e)}function Rt(e){return Dn(e)}function It(e){return!Dn(e)}function Ot(e){return bn(e)}function Dt(e){return On(e)?4:En(e)?1:Dn(e)?2:yn(e)?16:wn(e)?64:dn}function Pt(){return mn}function Nt(){var e=new Ht.Functions.AsyncFunction("REFRESH",1,3,Xt);e.evaluate=Ft,Ht.Functions._builtInFunctions.REFRESH=e}function Ft(e,t){return t}var Lt=n(0),Ht=n(5),Vt=Lt._RegexHelper,jt=Lt._StringHelper,Bt=Lt._DateTimeHelper,Ut=Bt._toOADate,Wt=Bt._parseLocale,zt=Lt._ArrayHelper._getLength,Yt=Lt._Types,Gt=Yt._inArray,Kt=Yt._isNullOrUndefined,Xt=void 0,qt=isNaN,Jt=parseFloat,Zt=parseInt,Qt=Math.abs,$t=Math.sqrt,en=Math.max,tn=Math.min,nn=Math.floor,rn=Math.exp,on=Math.log,an=Math.PI,sn=Math.random,ln=Math.pow,un=Ht.Errors,cn=un.Null,fn=un.DivideByZero,dn=un.Value,pn=un.Reference,hn=un.Name,mn=un.NotAvailable,gn=un.Number,_n=Ht.Convert,vn=_n.CalcConvertedError,yn=_n._isError,bn=_n._isReference,wn=_n._isArray,Cn=_n._tryToBool,Sn=_n._toInt,xn=_n._toDouble,Tn=_n._toString,En=_n._isNumber,Mn=_n._toArray,An=_n._toResult,kn=Ht._Helper,Rn=kn.tryExtractToSingleValue,In=Ht.Functions,On=In._isBoolean,Dn=In._isString,Pn=In._isLeapYear,Nn=In._getDaysInMonth,Fn=In._fact,Ln=In._st_includeSubstotals,Hn=In._st_devVarIncludeSubtotals,Vn=In._MathHelper,jn=Vn._approxCeiling,Bn=Vn._approxFloor,Un=In._defineBuiltInFunction,Wn=function(){return Lt._getResource(Ht.SR)()},zn={_argType:0},Yn={_argType:0,_argCondition:"= 0",_conditionErrorValue:fn},Gn={_argType:0,_argCondition:"= 0",_conditionErrorValue:0},Kn={_defaultValue:1,_argType:0,_argCondition:"= 0",_conditionErrorValue:0},Xn={_argType:1},qn={_argType:1,_argCondition:"< 0"},Jn={_argType:2},Zn={_defaultValue:1,_argType:2},Qn={_defaultValue:1,_argType:2,_argCondition:"< 0",_conditionErrorValue:dn},$n={_argType:5},er={_argType:6},tr={_argType:2,_argCondition:"< 0",_conditionErrorValue:dn},nr={_defaultValue:[],_argType:4,_valueType:4,_toOneDimension:!0,_breakOnError:!0,_breakOnConvertError:!0},rr={_argType:4,_valueType:1,_toOneDimension:!0,_breakOnError:!0},or={_argType:4,_valueType:1,_breakOnError:!0,_breakOnConvertError:!0},ir={_argType:4,_valueType:1,_toOneDimension:!0,_breakOnError:!0,_isAllArgsSameLimit:!0},ar={_argType:4,_valueType:3,_toOneDimension:!0,_breakOnError:!0,_isAllArgsSameLimit:!0};Un("ABS",l,1,1,zn),Un("ACOS",$,1,1,{_argType:0,_argCondition:["> 1","< -1"]}),Un("ASIN",Q,1,1,{_argType:0,_argCondition:["> 1","< -1"]}),Un("ATAN",oe,1,1,zn),Un("ATAN2",ie,2,2,[zn,zn]),Un("COS",J,1,1,zn),Un("CEILING",A,2,2,[Gn,Gn]),Un("ODD",d,1,1,Xn),Un("EVEN",p,1,1,Xn),Un("FLOOR",k,2,2,[Gn,Gn]),Un("LN",g,1,1,{_argType:1,_argCondition:"<= 0"}),Un("SQRT",T,1,1,{_argType:1,_argCondition:"< 0"}),Un("SIN",q,1,1,zn),Un("TAN",Z,1,1,zn),Un("SIGN",w,1,1,{_argType:1,_argCondition:"> 0",_conditionErrorValue:1}),Un("GCD",C,1,Xt,ir,-1,-1),Un("LCM",S,1,Xt,ir,-1,-1),Un("PRODUCT",x,1,Xt,Xt,-1,-1),Un("POWER",y,2,2,[Xn,Xn]),Un("MOD",_,2,2,[Xn,{_argType:1,_argCondition:"= 0",_conditionErrorValue:fn}]),Un("QUOTIENT",E,2,2,[zn,Yn],Xt,Xt),Un("SUBTOTAL",M,2,Xt,Jn,"!= 0","!= 0"),Un("INT",u,1,1,Xn),Un("MROUND",R,2,2,[Gn,Gn]),Un("ROUND",I,2,2,[zn,Jn]),Un("ROUNDDOWN",O,2,2,[zn,Jn]),Un("ROUNDUP",D,2,2,[zn,Jn]),Un("TRUNC",O,1,2,[zn,{_defaultValue:0,_argType:2}],Xt,Xt,{_acceptsMissingArgument:1}),Un("EXP",P,1,1,zn),Un("LOG",L,1,2,[{_argType:0,_argCondition:"<= 0"},{_defaultValue:10,_argType:0,_argCondition:"<= 0"}],Xt,Xt,{_acceptsMissingArgument:1}),Un("LOG10",H,1,1,{_argType:0,_argCondition:"<= 0"}),Un("SUM",b,1,Xt,Xt,-1,-1),Un("SUMIF",V,2,3,Xt,[0,2],[0,2],{_acceptsMissingArgument:2}),Un("SUMIFS",j,3,Xt,rr,[0,"%= 1"],[0,"%= 1"]),Un("SUMPRODUCT",B,1,Xt,Xt,-1,-1,{_arrayArgumentEvaluateMode:1}),Un("SUMSQ",U,1,Xt,ir,-1,-1),Un("SUMX2MY2",W,2,2,ir,-1,-1),Un("SUMX2PY2",z,2,2,ir,-1,-1),Un("SUMXMY2",Y,2,2,ir,-1,-1),Un("SERIESSUM",G,4,4,[zn,Jn,Jn,{_argType:4,_valueType:1,_toOneDimension:!0,_breakOnError:!0,_breakOnConvertError:!0}],3,3),Un("PI",v,0,0),Un("SQRTPI",K,1,1,{_argType:0,_argCondition:"< 0"}),Un("DEGREES",f,1,1,Xn),Un("RADIANS",X,1,1,zn),Un("COSH",te,1,1,zn),Un("ACOSH",re,1,1,{_argType:0,_argCondition:"< 0"}),Un("SINH",ee,1,1,zn),Un("ASINH",ne,1,1,zn),Un("TANH",ae,1,1,zn),Un("ATANH",se,1,1,{_argType:0,_argCondition:["<= -1",">= 1"]}),Un("MDETERM",le,1,1,or,-1,-1),Un("MINVERSE",ue,1,1,or,-1,-1),Un("MMULT",ce,2,2,[or,or],-1,-1),Un("FACT",h,1,1,{_argType:3,_argCondition:["< 0","> 170"]}),Un("FACTDOUBLE",m,1,1,{_argType:3,_argCondition:["< 0","> 300"]}),Un("MULTINOMIAL",fe,1,Xt,{_argType:4,_valueType:0,_toOneDimension:!0,_breakOnError:!0,_isAllArgsSameLimit:!0},-1,-1),Un("RAND",de,0,0,Xt,Xt,Xt,{_isVolatile:!0}),Un("RANDBETWEEN",pe,2,2,[Jn,Jn],Xt,Xt,{_isVolatile:!0}),Un("COMBIN",c,2,2,[qn,qn]),Un("ROMAN",he,1,2,[{_argType:2,_argCondition:["< 0","> 3999"],_conditionErrorValue:dn},{_defaultValue:0,_argType:2,_argCondition:["< 0","> 4"],_conditionErrorValue:dn}],Xt,Xt,{_acceptsMissingArgument:1}),Un("CEILING.PRECISE",N,1,2,[Gn,Kn]),Un("ISO.CEILING",N,1,2,[Gn,Kn]),Un("FLOOR.PRECISE",F,1,2,[Gn,Kn]),Un("AND",ge,1,Xt,ar,-1,-1),Un("OR",_e,1,Xt,ar,-1,-1),Un("NOT",ve,1,1),Un("IF",ye,2,3,Xt,[1,2],[1,2],{_acceptsError:[1,2],_acceptsMissingArgument:2,isBranch:!0,findTestArgument:0,findBranchArgument:function(e){if(_n._isError(e))return-1;var t={value:!1};return Cn(e,t),t.value?1:2}}),Un("IFERROR",be,2,2,Xt,0,Xt,{_acceptsError:-1}),Un("TRUE",we,0,0),Un("FALSE",Ce,0,0),Un("DATE",Ae,3,3,[{_argType:2,_argCondition:["< 0","> 9999"]},Jn,Jn]),Un("TIME",ke,3,3,[Jn,Jn,Jn]),Un("DATEVALUE",Re,1,1,{_acceptsEmptyString:!0}),Un("TIMEVALUE",Ie,1,1,{_acceptsEmptyString:!0}),Un("NOW",Oe,0,0,Xt,Xt,Xt,{_isVolatile:!0}),Un("TODAY",De,0,0,Xt,Xt,Xt,{_isVolatile:!0}),Un("HOUR",Pe,1,1,er),Un("MINUTE",Ne,1,1,er),Un("SECOND",Fe,1,1,er),Un("DAY",Le,1,1,er),Un("MONTH",He,1,1,er),Un("YEAR",Ve,1,1,er),Un("WEEKNUM",je,1,2,[er,Zn],Xt,Xt,{_acceptsMissingArgument:1}),Un("WEEKDAY",Be,1,2,[er,Zn],Xt,Xt,{_acceptsMissingArgument:1}),Un("EDATE",Ue,2,2,[er,Jn]),Un("EOMONTH",We,2,2,[er,Jn]),Un("WORKDAY",ze,2,3,[er,Jn,nr],2,2,{_acceptsMissingArgument:2}),Un("WORKDAY.INTL",Ye,2,4,[er,Jn,{_defaultValue:"0000011"},nr],[2,3],[2,3],{_acceptsMissingArgument:[2,3]}),Un("DAYS360",In._days360,2,3,[er,er,{_defaultValue:!1,_argType:7}],{_acceptsMissingArgument:2}),Un("NETWORKDAYS",Ge,2,3,[er,er],2,2,{_acceptsMissingArgument:2}),Un("NETWORKDAYS.INTL",Ke,2,4,[er,er],[2,3],[2,3],{_acceptsMissingArgument:[2,3]}),Un("YEARFRAC",In._yearfrac,2,3,[er,er,{_defaultValue:0,_argType:2}],{_acceptsMissingArgument:2}),Un("DATEDIF",Xe,3,3,[er,er,$n]),Un("CLEAN",Ze,1,1,$n),Un("TRIM",Qe,1,1,$n),Un("DOLLAR",$e,1,2,[zn,{_defaultValue:2,_argType:2,_argCondition:"> 99",_conditionErrorValue:dn}],Xt,Xt,{_acceptsMissingArgument:1}),Un("FIXED",et,1,3,[zn,{_defaultValue:2,_argType:2},{_defaultValue:!1,_argType:7}],Xt,Xt,{_acceptsMissingArgument:[1,2]}),Un("TEXT",tt,2,2,[{},$n]),Un("VALUE",nt,1,1,$n),Un("LOWER",rt,1,1,$n),Un("UPPER",ot,1,1,$n),Un("PROPER",it,1,1,$n),Un("CHAR",at,1,1,{_argType:2,_argCondition:["> 255","< 1"],_conditionErrorValue:dn}),Un("CODE",st,1,1,{_argType:5,_acceptsEmptyString:!0}),Un("REPLACE",lt,4,4,[$n,{_argType:2,_argCondition:"< 1",_conditionErrorValue:dn},tr,$n],Xt,Xt,{_acceptsMissingArgument:2}),Un("SUBSTITUTE",ut,3,4,[$n,{_argType:5,_acceptsEmptyString:!0},$n],Xt,Xt,{_acceptsMissingArgument:3}),Un("CONCATENATE",ct,2,Xt,{_argType:4,_valueType:0,_toOneDimension:!0,_isAllArgsSameLimit:!0},Xt,-1),Un("LEFT",ft,1,2,[$n,Qn],Xt,Xt,{_acceptsMissingArgument:1}),Un("MID",pt,3,3,[$n,tr,tr]),Un("RIGHT",dt,1,2,[$n,Qn],Xt,Xt,{_acceptsMissingArgument:1}),Un("REPT",ht,2,2,[$n,Jn]),Un("LEN",mt,1,1,$n),Un("FIND",gt,2,3,[$n,$n,Zn],Xt,Xt,{_acceptsMissingArgument:2}),Un("SEARCH",_t,2,3,[$n,$n,Qn],Xt,Xt,{_acceptsMissingArgument:2}),Un("EXACT",vt,2,2,[$n,$n]),Un("T",yt,1,1),Un("ISERROR",bt,1,1,Xt,Xt,Xt,{_acceptsError:-1}),Un("ISERR",wt,1,1,Xt,Xt,Xt,{_acceptsError:-1}),Un("ISNA",Ct,1,1,Xt,Xt,Xt,{_acceptsError:-1}),Un("ERROR.TYPE",St,1,1,Xt,Xt,Xt,{_acceptsError:-1}),Un("ISNUMBER",xt,1,1,Xt,Xt,Xt,{_acceptsError:-1}),Un("ISEVEN",Tt,1,1,zn,Xt,Xt),Un("ISODD",Et,1,1,zn,Xt,Xt),Un("N",Mt,1,1,Xt,Xt,Xt),Un("ISBLANK",At,1,1,Xt,Xt,Xt,{_acceptsError:-1}),Un("ISLOGICAL",kt,1,1,Xt,Xt,Xt,{_acceptsError:-1}),Un("ISTEXT",Rt,1,1,Xt,Xt,Xt,{_acceptsError:-1}),Un("ISNONTEXT",It,1,1,Xt,Xt,Xt,{_acceptsError:-1}),Un("ISREF",Ot,1,1,Xt,-1,Xt,{_acceptsError:-1}),Un("TYPE",Dt,1,1,Xt,Xt,-1,{_acceptsError:-1}),Un("NA",Pt,0,0),Nt(),e.exports=In},function(e,t,n){var r=n(5).Functions;n(88),n(89),n(90),n(91),n(92),e.exports=r},function(e,t,n){function r(e,t){this._criteriaOperator=e,this._criteriaValue=t}function o(e,t,n){var r=this;if(r._row=0,r._database=e,r._criteria=n,3===arguments.length){if(r._column=r._columnIndex(e,t),e.rowCount<2||e.colCount<1||n.rowCount<2||n.colCount<1||r._column<0||r._database.colCount<=r._column)throw F}else{if(2!==arguments.length)throw N().Exp_InvalidNull;if(r._column=-1,e.rowCount<2||e.colCount<1||n.rowCount<2||n.colCount<1)throw F}}function i(e,t,n,r){for(var i=0,a=new o(e,t,n);a._moveNext();){var s=a._current();s=r?T(s):s,s&&i++}return M(i)}function a(e,t,n,r,i,a,s){for(var l=s?1:0,u=0,c=0,f=new o(e,t,n);f._moveNext();){var d=f._current();if(T(d)){var p=x(d);if(P(p))return R;l=s?l*p:l+p,u+=p*p,c++}else if(E(d))return d}if(a||s)return M(l);var h=Math.max(0,(c*u-l*l)/(c*(c-i))),m=r?Math.sqrt(h):h;return c<=1?k:M(m)}function s(e,t,n){for(var r=0,i=0,a=new o(e,t,n);a._moveNext();){var s=a._current();if(E(s))return s;if(T(s)){var l={value:0};if(!S._tryToDouble(s,l))return R;r+=l.value,i++}}return 0===i?k:M(r/i)}function l(e,t,n){return i(e,t,n,!0)}function u(e,t,n){return i(e,t,n,!1)}function c(e,t,n){var r=C,i=new o(e,t,n);return i._moveNext()?(r=i._current(),i._moveNext()?A.Number:r):R}function f(e,t,n){for(var r=!1,i=-I._MAX_DOUBLE_VALUE,a=new o(e,t,n);a._moveNext();){var s=a._current();if(E(s))return s;if(T(s)){var l=x(s);if(P(l))return R;(!r||l>i)&&(i=l),r=!0}}return r?M(i):0}function d(e,t,n){for(var r=!1,i=I._MAX_DOUBLE_VALUE,a=new o(e,t,n);a._moveNext();){var s=a._current();if(E(s))return s;if(T(s)){var l=x(s);if(P(l))return R;(!r||s<i)&&(i=s),r=!0}}return r?M(i):0}function p(e,t,n){return a(e,t,n,!1,0,!1,!0)}function h(e,t,n){return a(e,t,n,!0,1)}function m(e,t,n){return a(e,t,n,!0,0)}function g(e,t,n){return a(e,t,n,!1,0,!0)}function _(e,t,n){return a(e,t,n,!1,1)}function v(e,t,n){return a(e,t,n,!1,0)}var y=n(0),b=n(5),w=y._RegexHelper,C=null,S=b.Convert,x=S._toDouble,T=S._isNumber,E=S._isError,M=S._toResult,A=b.Errors,k=A.DivideByZero,R=A.Value,I=b.Functions,O=I._defineBuiltInFunction,D=I._isString,P=isNaN,N=function(){return y._getResource(b.SR)()},F=N().Exp_InvalidCast;r.prototype._evaluate=function(e){var t={"=":9,"<>":10,"<":11,"<=":12,">":13,">=":14},n=b.evaluateOperator(t[this._criteriaOperator],e,this._criteriaValue);return!!I._isBoolean(n)&&S._toBool(n)},o.prototype={_columnIndex:function(e,t){if(D(t)){for(var n=0;n<e.colCount;n++){var r=S._toString(e[0][n]);if(r&&this._ignoreCaseEqual(r,t))return n}return-1}return S._toInt(t)-1},_current:function(){var e=this;if(e._row<=0||e._database.rowCount<=e._row)throw N().Exp_InvalidOperation;return e._database[e._row][e._column]},_moveNext:function(){for(var e=this,t=!1,n=e._database.rowCount;!t&&e._row<n;)++e._row<n&&(t=e._rowMeetsCriteria());return t},_createEvaluator:function(e){if(D(e)){var t,n=["=","<>","<=",">=","<",">"],o=S._toString(e);for(t=0;t<n.length;t++)if(y._StringHelper._startsWith(o,n[t])){o=o.substring(n[t].length);var i=y._NumberHelper._parseInvariant(o);return e=P(i)?!!this._ignoreCaseEqual("true",o)||!this._ignoreCaseEqual("false",o)&&o:i,new r(n[t],e)}return new r("=",e)}return e?new r("=",e):C},_rowMeetsCriteria:function(){var e,t=this,n=!1,r=t._criteria;for(e=1;!n&&e<r.rowCount;e++){n=!0;for(var o=0;n&&o<r.colCount;o++){var i=t._createEvaluator(r[e][o]);if(i){var a=t._columnIndex(t._database,r[0][o]);if(a<0)return!1;var s=t._database[t._row][a],l=w._getWildcardCriteriaFullMatch(i._criteriaValue,!0);n="="===i._criteriaOperator&&D(i._criteriaValue)&&D(s)&&l?w._getRegIgnoreCase(l).test(s):i._evaluate(s)}}}return n},_ignoreCaseEqual:function(e,t){return e.toLowerCase()===t.toLowerCase()}};var L="!= 1",H={_acceptsRealValue:!0,_argType:4,_valueType:0},V={_acceptsRealValue:!0},j=[H,V,H];O("DAVERAGE",s,3,3,j,L,L),O("DCOUNT",l,3,3,j,L,L),O("DCOUNTA",u,3,3,j,L,L),O("DGET",c,3,3,j,L,L),O("DMAX",f,3,3,j,L,L),O("DMIN",d,3,3,j,L,L),O("DPRODUCT",p,3,3,j,L,L),O("DSTDEV",h,3,3,j,L,L),O("DSTDEVP",m,3,3,j,L,L),O("DSUM",g,3,3,j,L,L),O("DVAR",_,3,3,j,L,L),O("DVARP",v,3,3,j,L,L),e.exports=I},function(e,t,n){function r(e,t){return{_str:e,_c:t}}function o(e,t){var n,o=[];for(n=0;n<te(e);n++)o.push(new r(e[n],t[n]));return o.push(new r(null,0)),o}function i(e,t,n){var r=100,o=.5*e,i=o*o;o=le(o,de(t));for(var a=_e._fact(t),s=1,l=0,u=de(t),c=o/a,f=.9*c,d=!1;c!==f&&0!==r;)o*=i,a*=++l,s*=++u,f=c,c=n||d?c+o/a/s:c-o/a/s,r--,d=!d;return c}function a(e,t){var n=le(t,10),r=parseInt(e,t);return pe(r)?ge:n/2<=r?r-n:r}function s(e,t,n){e<0&&(e+=le(t,10));var r,o=e.toString(t),i=n-te(o);for(r=0;r<i;r++)o="0"+o;return o.toUpperCase()}function l(e,t){var n=a(e,t);return te(n)<te(e)?ge:n}function u(e,t,n){var r=s(e,n,t._value);return 0<=r&&t._value<te(r)&&t._isArgExists?ge:r}function c(e,t,n,r,o){var i=a(e,n);if(te(i)<te(e))return ge;if(o&&(i<-o||o-1<i))return ge;var l=s(i,r,t._value);return 0<=i&&t._value<te(l)&&t._isArgExists?ge:l}function f(e,t){var n=Number.POSITIVE_INFINITY,r=e._getReal(),o=e._getImag();return pe(r)||r===n||pe(o)||o===n?ge:e._toString(t)}function d(e,t){function n(e,t,n,r){var o=e,i=t,a=n._getReal(),s=n._getImag();return e=r?o*a-i*s:o+a,t=r?o*s+i*a:i+s,{_real:e,_imag:t}}var r,o,i,a,s,l,u=t?1:0,c=0;for(o=0;o<te(e);o++)if(be._isArray(e[o])){var d=e[o];for(i=0;i<d.rowCount;i++)for(a=0;a<d.columnCount;a++){if(!(r=Te(d.getValue(i,a))))return ge;l=n(u,c,r,t),u=l._real,c=l._imag}}else if(be._isReference(e[o])){var p=e[o];for(s=0;s<p.getRangeCount();s++)for(i=0;i<p.getRowCount(s);i++)for(a=0;a<p.getColumnCount(s);a++){if(!(r=Te(p.getValue(s,i,a))))return ge;l=n(u,c,r,t),u=l._real,c=l._imag}}else{if(!(r=Te(e[o])))return ge;l=n(u,c,r,t),u=l._real,c=l._imag}return f(new xe(u,c))}function p(e,t){return we(i(e,t,!0))}function h(e,t){return we(i(e,t,!1))}function m(e,t){var n=1.7976931348623157e308;if(t>31)return n;var r,o,i,a,s=.5772156649015329,l=0,u=.25*e*e,c=1,f=0,d=1,p=2/e;if(t>0){for(f=-s,a=1;a<t;a++)f+=1/a,c*=a+1;if(d=p,1===t)l=1/e;else{var h=c/t,m=1,g=1;for(r=h,a=1;a<t;a++){if(h/=t-a,m*=a,g*=-u,o=h*g/m,r+=o,n-re(o)<re(r)||p>1&&n/p<d)return n;d*=p}if(r*=.5,o=re(r),d>1&&n/d<o||o>1&&n/o<d)return n;l=r*d}}var _=2*se(e/2),v=-s;0===t?(f=v,o=1):(f+=1/t,o=1/c),r=(v+f-_)*o,i=1;do{o*=u/(i*(i+t)),v+=1/i,f+=1/(i+t),r+=(v+f-_)*o,i++}while(re(o/r)>1.1102230246251565e-16);return r=.5*r/d,!0&t&&(r=-r),l+=r,we(l)}function g(e,t){function n(e,t,n,r){var o=0,i=de(t[o++]),a=n;r&&(i+=e,a--);do{i=i*e+de(t[o++])}while(0!=--a);return i}function r(e,t){var r,o,i,h,m=t?a:s,g=t?l:u,_=t?c:f,T=t?d:p,E=t?v:y,M=t?b:w,A=t?5.783185962946784:14.681970642123893,k=t?30.471262343662087:49.2184563216946,R=e;return e<=5?(r=e*e,t&&e<1e-5?1-r/4:(R=n(r,E,3)/n(r,M,8,!0),o=(r-A)*(r-k),o*=R,t?o:o*e)):(R=5/e,r=t?25/(e*e):R*R,o=n(r,m,6)/n(r,g,6),i=n(r,_,7)/n(r,T,7,!0),h=e-(t?x:S),(o=o*ie(h)-R*i*oe(h))*C/ae(e))}function o(e,t){var o,i,v=t?a:s,y=t?l:u,b=t?c:f,w=t?d:p,T=t?h:m,E=t?g:_,M=t?1:e,A=t?7:5,k=t?7:8;if(e<=5)return i=e*e,o=M*n(i,T,A)/n(i,E,k,!0),o+=.6366197723675814*(t?se(e)*r(e,!0):r(e,!1)*se(e)-1/e);o=5/e,i=t?25/(e*e):o*o;var R=n(i,v,6)/n(i,y,6),I=n(i,b,7)/n(i,w,7,!0),O=e-(t?x:S);return(R=R*oe(O)+o*I*ie(O))*C/ae(e)}function i(e,t){var n,r=o(e,!0),i=o(e,!1),a=1,s=2*a;if(0===t)return r;if(1===t)return i;do{n=s*i/e-r,r=i,i=n,s+=2,++a}while(a<t);return n}var a=[.0007969367292973471,.08283523921074408,1.239533716464143,5.447250030587687,8.74716500199817,5.303240382353949,1],s=[.0007621256162081731,.07313970569409176,1.1271960812968493,5.112079511468076,8.424045901417724,5.214515986823615,1],l=[.0009244088105588637,.08562884743544745,1.2535274390105895,5.470977403304171,8.761908832370695,5.306052882353947,1],u=[.0005713231280725487,.06884559087544954,1.105142326340617,5.073863861286015,8.399855543276042,5.209828486823619,1],c=[-.011366383889846916,-1.2825271867050931,-19.553954425773597,-93.20601521237683,-177.68116798048806,-147.07750515495118,-51.41053267665993,-6.050143506007285],f=[.05108625947501766,4.982138729512334,75.82382841325453,366.7796093601508,710.8563049989261,597.4896124006136,211.68875710057213,25.207020585802372],d=[64.3178256118178,856.4300259769806,3882.4018360540163,7240.467741956525,5930.727011873169,2062.0933166032783,242.0057402402914],p=[74.23732770356752,1056.4488603826283,4986.410583376536,9562.318924047562,7997.041604473507,2826.1927851763908,336.0936078106983],h=[15592.436785523574,-14663929.59039716,5435264770.518765,-982136065717.9115,87590639439536.7,-0xc5090e8ec6601,0x9d4a5b305a0018,-0x41b52d6418d9ec],m=[1263204747.9017804,-647355876379.1603,114509511541823.73,-8127702555013251,0x2cf35a16e6cd620,-0xacf20aeef158b80],g=[1041.2835366425984,626107.330137135,268919633.39381415,86400248710.3935,20297961275010.555,3171577528429750.5,0x37a4bf79f36ba00],_=[594.3015923461282,235564.09294306856,73481194.44597217,18760131610.870617,3882312774962.3857,620557727146953.8,0xf41f1e2a3d2440,0x3721e321ece8fe00],v=[-4794432209.782018,1956174919465.5657,-249248344360967.72,9708622510473064],y=[-899971225.7055594,452228297998.19403,-72749424522181.83,0xd15a1534be241],b=[499.563147152651,173785.4016763747,48440965.83399621,11185553704.535683,2112775201154.892,310518229857422.56,0x710505f9ecba70,0x17be34c7b662cc00],w=[620.8364781180543,256987.25675774884,83514679.14319493,22151159547.97925,4749141220799.914,784369607876235.9,89522233618462740,0x49de55d9c0a4e400],C=.7978845608028654,S=2.356194490192345,x=.7853981633974483;return we(i(e,t))}function _(e){return l(e,2)}function v(e){return l(e,16)}function y(e){return l(e,8)}function b(e,t){return c(e,t,2,16)}function w(e,t){return c(e,t,2,8)}function C(e,t){return u(e,t,2)}function S(e,t){return u(e,t,16)}function x(e,t){return u(e,t,8)}function T(e,t){return c(e,t,16,2,512)}function E(e,t){return c(e,t,8,2,512)}function M(e,t){return c(e,t,16,8,536870912)}function A(e,t){return c(e,t,8,16,549755813888)}function k(e,t){var n=ye(e*ae(2)),r=2*de(n)-1;if(t._isArgExists){n=ye(t._value*ae(2));r=2*de(n)-1-r}return r}function R(e){return k(e,{_isArgExists:!1})}function I(e){return 1-k(e,{_isArgExists:!1})}function O(e,t){return ee._Helper._approxEqual(e,t)?1:0}function D(e,t){return e>=t?1:0}function P(e,t,n){return"i"!==n&&"j"!==n?he.Value:f(new xe(e,t),n)}function N(e){return we(ae(e._real*e._real+e._imag*e._imag))}function F(e){return we(e._imag)}function L(e){return 0===e._real&&0===e._imag?he.DivideByZero:we(fe(e._imag,e._real))}function H(e){return f(new xe(e._real,-e._imag))}function V(e){return f(new xe(ie(e._real)*Se(e._imag,!1),-oe(e._real)*Se(e._imag,!0)))}function j(e,t){var n=e._real,r=e._imag,o=t._real,i=t._imag;return f(new xe((n*o+r*i)/(o*o+i*i),(r*o-n*i)/(o*o+i*i)))}function B(e){return f(new xe(ue(e._real)*ie(e._imag),ue(e._real)*oe(e._imag)))}function U(e){var t=e._real,n=e._imag;return f(new xe(se(ae(t*t+n*n)),fe(n,t)))}function W(e){var t=e._real,n=e._imag,r=Ce._log(ce,10);return f(new xe(r*se(ae(t*t+n*n)),r*fe(n,t)))}function z(e){var t=e._real,n=e._imag,r=Ce._log(ce,2);return f(new xe(r*se(ae(t*t+n*n)),r*fe(n,t)))}function Y(e,t){var n=e._real,r=e._imag;if(0===n&&0===r)return t>0?"0":ge;var o=ae(n*n+r*r),i=fe(r,n);return f(new xe(le(o,t)*ie(t*i),le(o,t)*oe(t*i)))}function G(e){return we(e._real)}function K(e){return f(new xe(oe(e._real)*Se(e._imag,!1),ie(e._real)*Se(e._imag,!0)))}function X(e){var t=e._real,n=e._imag;if(0===t&&0===n)return"0";var r=ae(t*t+n*n),o=fe(n,t);return f(new xe(ae(r)*ie(o/2),ae(r)*oe(o/2)))}function q(e,t){return f(new xe(e._real-t._real,e._imag-t._imag))}function J(){return d(arguments,!0)}function Z(){return d(arguments,!1)}function Q(e,t,n){function r(e,t){return e===t}function o(e,t,n){function r(e){for(var t=["cup","mmHg","J","sec","cel","kel","hh","Wh","wh","flb","BTU"],n=0;t[n]._str;n++)if(0===e.localeCompare(t[n]._str))return!1;return!0}var o,i=0,a=1;for(o=0;e[o]._str;o++)if(0===n.localeCompare(e[o]._str))return i=e[o]._c,{_hasUnit:!0,_prefix:a,_constant:i};if(t)for(o=0;t[o]._str;o++){var s=n.substr(0,1).toLowerCase(),l=t[o]._str.substr(0,1).toLowerCase();s===l&&r(n)&&(a=t[o]._c)}for(o=0;e[o]._str;o++){var u=te(e[o]._str);if(n.substr(1,u)===e[o]._str.substr(0,u)&&r(n))return i=e[o]._c,{_hasUnit:!0,_prefix:a,_constant:i}}return{_hasUnit:!1,_prefix:a,_constant:i}}var i=273.15;if(!t||""===t||!n||""===n)return me;var a=r(t,"C")||r(t,"cel"),s=r(n,"C")||r(n,"cel"),l=r(t,"F")||r(t,"fah"),u=r(n,"F")||r(n,"fah"),c=r(t,"K")||r(t,"kel"),f=r(n,"K")||r(n,"kel");if(a&&s||l&&u||c&&f)return e;if(a&&u)return 9*e/5+32;if(l&&s)return 5*(e-32)/9;if(l&&f)return 5*(e-32)/9+i;if(c&&u)return 9*(e-i)/5+32;if(a&&f)return e+i;if(c&&s)return e-i;for(var d=[Ee,Ie,Fe,He,je,Ke,Ue,Xe,Je,Xe],p=0;p<te(d);p++){var h=d[p],m=o(h,Ze,t),g=m._hasUnit,_=m._constant,v=m._prefix;m=o(h,Ze,n);var y=m._hasUnit,b=m._prefix,w=m._constant;if(g&&y&&0!==_&&0!==b)return e*v/_*w/b}return me}var $=n(0),ee=n(5),te=$._ArrayHelper._getLength,ne=void 0,re=Math.abs,oe=Math.sin,ie=Math.cos,ae=Math.sqrt,se=Math.log,le=Math.pow,ue=Math.exp,ce=Math.E,fe=Math.atan2,de=parseFloat,pe=isNaN,he=ee.Errors,me=he.NotAvailable,ge=he.Number,_e=ee.Functions,ve=_e._defineBuiltInFunction,ye=_e._st_normsdist,be=ee.Convert,we=be._toResult,Ce=_e._MathHelper,Se=Ce._sinhCosh,xe=_e._Complex,Te=_e._convertToComplex,Ee=o(["g","sg","lbm","u","ozm"],[1,6852205001e-14,.002204622915,6.02217e23,.035273972]),Me=1e4/254,Ae=Me/12,ke=Ae/3,Re=ke/1760,Ie=o(["m","mi","Nmi","in","ft","yd","ang","Pica","km"],[1,Re,1/1852,Me,Ae,ke,1e10,2834.645669,.001]),Oe=365.25,De=24*Oe,Pe=60*De,Ne=60*Pe,Fe=o(["yr","day","hr","mn","sec"],[1,Oe,De,Pe,Ne]),Le=.00750061708,He=o(["Pa","atm","mmHg","p","at"],[1,9869233e-12,Le,1,Le]),Ve=1e5,je=o(["N","dyn","lbf","dy"],[1,Ve,.224808924,Ve]),Be=745.701,Ue=o(["HP","W","h","w"],[1,Be,1,Be]),We=62146e14,ze=1/(3600*Be),Ye=1/3600,Ge=947815e-9,Ke=o(["J","e","c","cal","eV","HPh","Wh","flb","BTU","ev","hh","wh","btu"],[1,9999995.193,.239006249,.238846191,We,ze,Ye,23.73042222,Ge,We,ze,Ye,Ge]),Xe=o(["T","gs"],[1,1e4]),qe=.0049289216,Je=o(["tsp","tbs","oz","cup","pt","qt","gal","l","uk_pt","us_pt","lt"],[1,1/3,1/6,1/48,1/96,1/192,1/768,qe,.008675585,1/96,qe]),Ze=o(["Y","Z","E","P","T","G","M","k","h","e","d","c","m","u","n","p","f","a","z","y"],[1e24,1e21,1e18,1e15,1e12,1e9,1e6,1e3,100,10,.1,.01,.001,1e-6,1e-9,1e-12,1e-15,1e-18,1e-21,1e-24]),Qe={_argType:0},$e={_argType:5},et={_argType:5,_argCondition:["checkLength 10"]},tt={_needArgExistsValue:!0,_argType:2,_defaultValue:1,_argCondition:["< 1","> 10"]},nt={_argType:2,_argCondition:"< 0"},rt={_argType:8},ot={_argType:8,_complexCondition:!0},it=[Qe,nt],at=[{_argType:0,_argCondition:"<= 0"},nt],st=[Qe,{_argType:0,_defaultValue:0}],lt=[et,tt];ve("BESSELI",p,2,2,it),ve("BESSELJ",h,2,2,it),ve("BESSELK",m,2,2,at),ve("BESSELY",g,2,2,at),ve("BIN2DEC",_,1,1,et),ve("BIN2HEX",b,1,2,lt,ne,ne,{_acceptsMissingArgument:1}),ve("BIN2OCT",w,1,2,lt,ne,ne,{_acceptsMissingArgument:1}),ve("DEC2BIN",C,1,2,[{_argType:0,_argCondition:["< -512","> 511"]},tt],ne,ne,{_acceptsMissingArgument:1}),ve("DEC2HEX",S,1,2,[{_argType:0,_argCondition:["< -549755813888","> 549755813887"]},tt],ne,ne,{_acceptsMissingArgument:1}),ve("DEC2OCT",x,1,2,[{_argType:0,_argCondition:["< -536870912","> 536870911"]},tt],ne,ne,{_acceptsMissingArgument:1}),ve("HEX2BIN",T,1,2,lt,ne,ne,{_acceptsMissingArgument:1}),ve("HEX2DEC",v,1,1,et),ve("HEX2OCT",M,1,2,lt,ne,ne,{_acceptsMissingArgument:1}),ve("OCT2BIN",E,1,2,lt,ne,ne,{_acceptsMissingArgument:1}),ve("OCT2DEC",y,1,1,et),ve("OCT2HEX",A,1,2,lt,ne,ne,{_acceptsMissingArgument:1}),ve("ERF",k,1,2,[Qe,{_needArgExistsValue:!0,_argType:0}],ne,ne,{_acceptsMissingArgument:1}),ve("ERF.PRECISE",R,1,1,Qe),ve("ERFC",I,1,1,Qe),ve("ERFC.PRECISE",I,1,1,Qe),ve("DELTA",O,1,2,st,ne,ne,{_acceptsMissingArgument:1}),ve("GESTEP",D,1,2,st,ne,ne,{_acceptsMissingArgument:1}),ve("COMPLEX",P,2,3,[Qe,Qe,{_argType:5,_defaultValue:"i"}],ne,ne,{_acceptsMissingArgument:2}),ve("IMABS",N,1,1,rt),ve("IMAGINARY",F,1,1,rt),ve("IMARGUMENT",L,1,1,rt),ve("IMCONJUGATE",H,1,1,rt),ve("IMCOS",V,1,1,rt),ve("IMDIV",j,2,2,[rt,ot]),ve("IMEXP",B,1,1,rt),ve("IMLN",U,1,1,ot),ve("IMLOG10",W,1,1,ot),ve("IMLOG2",z,1,1,ot),ve("IMREAL",G,1,1,rt),ve("IMSIN",K,1,1,rt),ve("IMSQRT",X,1,1,rt),ve("IMSUB",q,2,2,[rt,rt]),ve("IMPOWER",Y,2,2,[rt,{_argType:2}]),ve("IMPRODUCT",J,1,255,ne,-1,-1),ve("IMSUM",Z,1,255,ne,-1,-1),ve("CONVERT",Q,3,3,[{_argType:1},$e,$e]),e.exports=_e},function(e,t,n){function r(e){return e.getMonth()}function o(e){return e.getDate()}function i(e){return e.getFullYear()}function a(e){return e instanceof Date?Be._DateTimeHelper._toOADate(e):e}function s(e,t,n){var s=i(t)-i(e),l=r(t)-r(e)+12*s,u=o(t)-o(e),c=-1;return 0===n?c=gt._days360(e,t):Ye(n,[1,2,3])>=0?c=a(t)-a(e):4===n&&(c=30*l+u),c}function l(e,t,n,r,o){var i=ot(1+e,t),a=We(i)?i:mt;return 0===e?t:(i=(i-1)/e,i=(-n*a-r)/((1+e*o)*(We(i)?i:mt)),We(i)?i:mt)}function u(e,t,n,a){var s=i(t),l=r(t),u=o(t),c=new Date(1,0,1),f=0,d=u===Ct(s,l),p=12/n,h=s-i(e);c.setFullYear(1),h>0&&(h=(h-1)*n);do{c=new Date(s,l,u),h++,c.setMonth(l-h*p),d&&(f=Ct(i(c),r(c)),c=new Date(i(c),r(c),f))}while(St(e,c)<0);return a&&(c=new Date(s,l,u),h--,c.setMonth(l-h*p),d&&(f=Ct(i(c),r(c)),c=new Date(i(c),r(c),f))),c}function c(e,t,n,r){return xt(u(e,t,n,!1),e,r)}function f(e,t,n,r){return Ye(r,[0,2,4,5])>=0?360/n:3===r?365/n:xt(u(e,t,n,!1),u(e,t,n,!0),1)}function d(e,t,n,r){return xt(e,u(e,t,n,!0),r)}function p(e,t,n){var a=i(t),s=r(t),l=o(t),u=new Date(a,s,l),c=s-r(e)+12*(a-i(e));if(u.setMonth(r(u)-c),l===Ct(a,s))for(;o(u)!==Ct(i(u),r(u));)u.setDate(o(u)+1);return o(e)>=o(u)&&c--,parseInt((1+c/(12/n)).toString())}function h(e,t,n){return t>0?(n._havexpos?n._havexneg?it(e-n._xneg)<it(n._xpos-n._xneg)&&(n._xpos=e,n._ypos=t):t<n._ypos&&(n._xpos=e,n._ypos=t):(n._xpos=e,n._ypos=t,n._havexpos=!0),[!1,n]):t<0?(n._havexneg?n._havexpos?it(e-n._xpos)<it(n._xpos-n._xneg)&&(n._xneg=e,n._yneg=t):-t<-n._yneg&&(n._xneg=e,n._yneg=t):(n._xneg=e,n._yneg=t,n._havexneg=!0),[!1,n]):(n._root=e,[!0,n])}function m(e,t,n,a,s){var l=u(e,n,a,!0),c=u(e,n,a,!1);if(St(l,t)>=0)return xt(e,t,s)/f(c,l,a,s);for(var d=xt(e,l,s)/f(c,l,a,s);;){if(c=new Date(i(l),r(l),o(l)),l.setMonth(r(l)+12/a),St(l,t)>=0)return d+=xt(c,t,s)/f(c,l,a,s);d+=1}}function g(e,t,n,r,o,i,a){var s,l=c(e,t,i,a),u=d(e,t,i,a),h=f(e,t,i,a),m=parseInt(p(e,t,i).toString()),g=0,_=100*n/i,v=1+r/i,y=u/h;for(s=0;s<m;s++)g+=_/ot(v,y+s);return o/ot(v,m-1+u/h)+g-l/h*_}function _(e,t,n,a,s,l,u,c,d){var h=xt(c,e,u),g=xt(e,d,u),_=xt(c,d,u),v=f(e,t,l,u),y=parseInt(p(e,t,l).toString()),b=100*n/l,w=1+a/l;if(g>v)switch(u){case 0:case 4:var C=xt(d,t,u);y=1+parseInt(at(C/v).toString());break;default:var S=new Date(i(d),r(d),o(d));for(y=0;y<32767;y++){var x=new Date(i(S),r(S),o(S));if(S.setMonth(r(S)+12/l),St(S,t)>=0){y+=parseInt((at(xt(x,t,u))/f(x,S,l,u)).toString())+1;break}}h=v*m(c,e,d,l,u),g=v*m(e,d,d,l,u),_=v*m(c,d,d,l,u)}return s/ot(w,y-1+g/v)+b*(_/v/ot(w,g/v)+ot(w,-g/v)*(ot(w,-y)-1/w)/(1/w-1)-h/v)}function v(e,t){var n=e.substr(0,3),r={ATS:13.7603,BEF:40.3399,DEM:1.95583,ESP:166.386,EUR:1,FIM:5.94573,FRF:6.55957,GRD:340.75,IEP:.787564,ITL:1936.27,LUX:40.3399,LUF:40.3399,NLG:2.20371,PTE:200.482,SIT:245.18};return r[n]?yt(r[n],t):-1}function y(e,t,n,r,o,i,a){function s(e,t,n,r,o){var i,a=ot(1+e,t);return 0===e?i=(n+r)/t:(i=r*e/(a-1)+n*e/(1-1/a),o>0&&(i/=1+e)),-i}function l(e,t,n,r,o){var i=ot(1+e,t),a=o>0?1+e:1;return-(0===e?r+n*t:r*i+n*a*(i-1)/e)}if(i<o||i>n||0!==a&&1!==a)return mt;var u,c,f=s(t,n,r,0,a),d=0;for(1===o&&(e&&(d=f),a<=0&&(d+=e?r*t:-r),o++),u=o;u<=i;u++)c=a>0?l(t,u-2,f,r,1)-f:l(t,u-1,f,r,0),d+=e?f-c*t:c;return e?d:d*t}function b(e,t,n,r){var o=ot(1+n,r),i=-(e*o*n+t*(o-1));return We(i)?i:mt}function w(e,t,n,r,o){return Ye(r,[1,2,4])<0||St(t,n)>=0?mt:e(t,n,r,o)}function C(e,t,n,r,o,i){function a(e,t,n,r){var o,i=0,a=0,s=100;for(e*=s/et(n),t/=n,t++,o=1;o<r;o++)i+=o*e/ot(t,o);for(i+=r*(e+s)/ot(t,r),o=1;o<r;o++)a+=e/ot(t,o);return a+=(e+s)/ot(t,r),i/=a,i/=et(n)}if(Ye(i,[1,2,4])<0||St(t,n)>0)return mt;var s=a(r,o,i,p(t,n,i));return e?s/(1+o/i):s}function S(e,t,n,a,s,l,u,c,f){if(Ye(u,[1,2,4])<0||St(t,n)>0||St(a,t)>0)return mt;var d=new Date(i(a),r(a),o(a));do{d.setMonth(r(d)+12/u)}while(St(d,n)<0);var p=m(a,t,d,u,c),h=m(a,n,d,u,c),g=m(t,n,d,u,c);return e?(l*u+100*s*(h-p*(1+f*g/u)))/(f*g+u):(u*(l-f)+100*s*(h-p))/(g*f+100*s*p*g/u)}function x(e,t,n){if(0===n)return pt;var r=t<0?at(t):ut(t),o=ot(10,at(vt._log(n,10))),i=t-r;return Qe(r+(e?i*o/n:i*n/o))}function T(e,t,n){var r,o=Xe(t),i=0,a=1,s=1/(e+1);for(r=0;r<o;r++)i+=t[r]*a*(n?-r:1),a*=s;return i}function E(e,t,n,r){for(var o=0,i=Xe(t),s=0;s<i;s++){var l=a(r[s])-a(r[0]);if(l<0)return[!1,n];o+=t[s]/vt._pow1p(e,l/365)}return We(o)?n=isNaN(o)?5e-324:o:o===Number.POSITIVE_INFINITY?n=bt:o===Number.NEGATIVE_INFINITY&&(n=-bt),[!0,n]}function M(e,t,n,r){if(e>-1&&0!==e){var o=n,i=ot(1+e,o._nper-(r?1:0)),a=(ot(1+e,o._nper)-1)/e;return t=r?-o._pmt*a/e+i*o._nper*(o._pv+o._pmt*(o._type+1/e)):o._pv*i+o._pmt*(1+e*o._type)*a+o._fv,[!0,t,n]}return[!1,t,n]}function A(e,t,n,r,o,i,a,s,l,u,c,f,d,p,h){var m,g,_,v,y=0,b=0,w=n-o,C=n+o,S=2===e;if(w<i._xmin&&(w=n),C>i._xmax&&(C=n),w===C)return S?[!1,r,i,a]:[!1,r,i];if(0===e?(m=t(a,s,l,w,c,f,d,p,h)-u,g=t(a,s,l,C,c,f,d,p,h)-u):1===e?(m=t(w,a,y,s),g=t(C,a,b,s)):(m=M(w,y,a),g=M(C,b,a)),Ge(m)){if(v=m[2],y=m[1],!(_=m[0]))return S?[_,r,i,v]:[_,r,i]}else y=m;if(Ge(g)){if(v=g[2],b=g[1],!(_=g[0]))return S?[_,r,i,v]:[_,r,i]}else b=g;return r=(b-y)/(C-w),S?[!0,r,i,v]:[!0,r,i]}function k(e,t,n,r,o,i,a,s,l,u,c,f,d){if(r<n._xmin||r>n._xmax)return[!1,n];var p=e?T(r,o):t(o,i,a,r,l,u,c,f,d)-s,m=h(r,p,n);return n=m[1],[!!m[0],n]}function R(e,t,n,r,o){if(t<e._xmin||t>e._xmax)return[!1,e,r];var i=E(t,n,r,o);return r=i[1],i[0]?(i=h(t,0,e),e=i[1],[!!i[0],e,r]):[i[0],e,r]}function I(e,t,n){var r=0;if(t<e._xmin||t>e._xmax)return[!1,e,n];var o=M(t,r,n);if(n=o[2],r=o[1],!o[0])return[o[0],e,n];var i=h(t,r,e);return e=i[1],[!!i[0],e,n]}function O(e,t,n,r,o,i,a,s,l,u){var c,f=0,d=e?15:2;if(!n._havexpos||!n._havexneg)return e?[!1,n,r]:[!1,n];var p=it(n._xpos-n._xneg)/(it(n._xpos)+it(n._xneg));for(c=0;c<100+4*d;c++){var h,m=0,_=0;h=c%4==0?1:c%4==2?2:3;var v;if(v=e?L(n,r,p,f,_,h):t?H(!0,n,f,m,_,h,E,p,o,r,A):H(!1,n,f,m,_,h,g,p,i,a,s,r,o,l,u),n=v[1],r=v[2],f=e?v[3]:v[2],v[0])return e?[!0,n,r]:[!0,n]}return e?[!1,n,r]:[!1,n]}function D(e,t,n,r,o,i,a,s,l,u,c){var f,d,p=0,m=e?15:2;if(!t._havexpos||!t._havexneg)return[!1,t];for(d=it(t._xpos-t._xneg)/(it(t._xpos)+it(t._xneg)),f=0;f<100+4*m;f++){var g,v=0,y=0;g=f%4==0?1:f%4==2?2:3;var b=e?H(!0,t,p,v,y,g,T,d,rt,n,A):H(!1,t,p,v,y,g,_,d,a,s,l,n,r,u,c,o,i);if(t=b[1],p=b[2],v=b[3],y=b[4],g=b[5],!(e&&b[0]===nt||!e&&Ke(b[0]))){if(b[0])return[!0,t];y=e?T(v,n):_(n,r,a,v,l,u,c,o,i)-s;var w=h(v,y,t);if(t=w[1],w[0])return[!0,t];if((d=it(t._xpos-t._xneg)/(it(t._xpos)+it(t._xneg)))<t._precision)return t._yneg<y&&(y=t._yneg,v=t._xneg),t._ypos<y&&(y=t._ypos,v=t._xpos),t._root=v,[!0,t]}}return[!1,t]}function P(e,t,n,r,o,i,a,s,l,u,c,f,d){var p,m,g,_=n._precision/2;for(p=0;p<20;p++){if(r<n._xmin||r>n._xmax)return[!1,n];var v=e?E(r,o,0,i):t(o,i,a,r,l,u,c,f,d)-s;if(Ge(v)){if(g=v[1],!(m=v[0]))return[m,n]}else g=v;var y=h(r,g,n);if(n=y[1],y[0])return[!0,n];var b=n._havexneg&&n._havexpos?it(n._xpos-n._xneg):n._xmax-n._xmin,w=(it(r)<1e-10?b:it(r))/1e6,C=0;if(y=e?A(1,E,r,C,w,n,o,i):A(0,t,r,C,w,n,o,i,a,s,l,u,c,f,d),n=y[2],C=y[1],!(m=y[0]))return[m,n];if(0===C)return[!1,n];var S=r-1.000001*g/C;if(S===r)return n._root=r,[!0,n];var x=it(S-r)/(it(r)+it(S));if(r=S,x<_)return n._root=r,[!0,n]}return[!1,n]}function N(e,t,n){var r,o=e._precision/2;for(r=0;r<20;r++){var i,a,s=0,l=0;if(n<e._xmin||n>e._xmax)return[!1,e];s=T(n,t);var u=h(n,s,e);if(e=u[1],u[0])return[!0,e];if(0===(l=T(n,t,!0)))return[!1,e];if((i=n-1.000001*s/l)===n)return e._root=n,[!0,e];if(a=it(i-n)/(it(n)+it(i)),n=i,a<o)return e._root=n,[!0,e]}return[!1,e]}function F(e,t,n){var r,o=e._precision/2;for(r=0;r<100;r++){var i,a,s,l=0,u=0;if(n<e._xmin||n>e._xmax)return[!1,e,t];var c=M(n,l,t);if(t=c[2],l=c[1],!(s=c[0]))return[s,e,t];var f=h(n,l,e);if(e=f[1],f[0])return[!0,e,t];if(c=M(n,u,t,!0),t=c[2],u=c[1],!(s=c[0]))return[s,e,t];if(0===u)return[!1,e,t];if((i=n-1.000001*l/u)===n)return e._root=n,[!0,e,t];if(a=it(i-n)/(it(n)+it(i)),n=i,a<o)return e._root=n,[!0,e,t]}return[!1,e,t]}function L(e,t,n,r,o,i){var a;switch(i){case 0:a=e._xpos-e._ypos*((e._xneg-e._xpos)/(e._yneg-e._ypos));break;case 1:var s;a=(e._xpos+e._xneg)/2;var l=M(a,o,t);if(t=l[2],o=l[1],!l[0])return[nt,e,t,r];if(0===o)return e=h(a,o,e)[1],[!0,e,t,r];if(0===(s=lt(o*o-e._ypos*e._yneg)))return[nt,e,t,r];a+=(a-e._xpos)*o/s;break;case 3:a=(e._xpos+e._xneg)/2;break;case 2:var u,c,f=0,d=0;if(n>.1)return i=3,L(e,t,n,r,o,i);var p=r++%4;if(0===p)u=e._xpos,u=e._ypos;else if(2===p)u=e._xneg,f=e._yneg;else if(u=(e._xpos+e._xneg)/2,l=M(u,f,t),t=l[2],f=l[1],!l[0])return[nt,e,t,r];c=it(e._xpos-e._xneg)/1e6;var m=A(2,void 0,u,d,c,e,t);if(t=m[3],e=m[2],d=m[1],!m[0]||0===d)return[nt,e,t,r];if((a=u-1.01*f/d)<e._xpos&&a<e._xneg||a>e._xpos&&a>e._xneg)return[nt,e,t,r]}return[!1,e,t,r]}function H(e,t,n,r,o,i,a,s,l,u,c,f,d,p,m,g,_){var v;switch(i){case 0:r=t._xpos-t._ypos*((t._xneg-t._xpos)/(t._yneg-t._ypos));break;case 1:if(r=(t._xpos+t._xneg)/2,v=e?a(r,u,o,l):a(f,d,l,r,c,p,m,g,_)-u,Ge(v)){if(o=v[1],!v[0])return[nt,t,n,r,o,i]}else o=v;if(0===o)return t=h(r,o,t)[1],[!0,t,n,r,o,i];var y=lt(o*o-t._ypos*t._yneg);if(0===y)return[nt,t,n,r,o,i];r+=(r-t._xpos)*o/y;break;case 3:r=(t._xpos+t._xneg)/2;break;case 2:var b=0,w=0,C=0,S=0;if(s>.1)return i=3,H(e,t,n,r,o,i,a,s,l,u,c,f,d,p,m);var x=n++%4;if(0===x)b=t._xpos,b=t._ypos;else if(2===x)b=t._xneg,w=t._yneg;else if(b=(t._xpos+t._xneg)/2,v=e?a(b,u,w,l):a(f,d,l,b,c,p,m,g,_)-u,Ge(v)){if(w=v[1],!v[0])return[nt,t,n,r,o,i]}else w=v;C=it(t._xpos-t._xneg)/1e6;var T=e?c(1,a,b,S,C,t,u,l):A(0,a,b,S,C,t,f,d,l,u,c,p,m,g,_);if(t=T[2],S=T[1],!T[0]||0===S)return[nt,t,n,r,o,i];if((r=b-1.01*w/S)<t._xpos&&r<t._xneg||r>t._xpos&&r>t._xneg)return[nt,t,n,r,o,i]}return[!1,t,n,r,o,i]}function V(e,t,n,r,o){o=o?1:0;var i=ot(1+e,t);return i=0===e?n*t+r:r*i+n*(1+e*o)*(i-1)/e,Qe(-i)}function j(e,t){for(var n=0;n<Xe(t);n++)t[n]!==tt&&(e*=1+t[n]);return e}function B(e){var t,n,r=arguments,o=0,i=1;for(n=1;n<Xe(r);n++){var a=$e(r[n],1,!0,!0,!1);if(a.isError)return a[0];for(t=0;t<Xe(a);t++)a[t]!==tt&&(o+=a[t]/ot(1+e,i++))}return o}function U(e,t,n,r,o){if(o=o?1:0,0===e)return Qe(-(n*t+r));var i=ot(1+e,t);return-1===e?pt:Qe(-(r+n*(1+e*o)*(i-1)/e)/i)}function W(e,t,n,r,o){if(St(e,t)>=0)return mt;var i=s(e,t,o),a=wt(e,o);if(i<=0||a<=0)return mt;var l=1-r*i/a;return l<=0?mt:n/l}function z(e,t,n){var r,o=Xe(t),i=Xe(n),a=0;if(o!==i)return mt;for(r=0;r<o;r++)a+=t[r]/ot(1+e,(n[r]-n[0])/365);return a}function Y(e,t,n,r,o,i){return y(!1,e,t,n,r,o,i)}function G(e,t,n,r,o,i){return y(!0,e,t,n,r,o,i)}function K(e,t,n,r,o,i){return t>=n+1||0!==i&&1!==i?mt:b(r,l(e,n,r,o,i),e,t-1)}function X(e,t,n,r){return Qe(r*e*(t/n-1))}function q(e,t,n,r,o){o=o?1:0;var i=ot(1+e,t);return i=0===e?(n+r)/t:(n*i+r)/((1+e*o)*(i-1)/e),Qe(-i)}function J(e,t,n,r,o,i){if(i=i?1:0,t>=n+1)return mt;var a=l(e,n,r,o,i);return a-b(r,a,e,t-1)}function Z(e,t,n,r){return w(c,e,t,n,r)}function Q(e,t,n,r){return w(f,e,t,n,r)}function $(e,t,n,r){return w(d,e,t,n,r)}function ee(e,t,n){function r(e,t,n){return a(u(e,t,n,!0))}return w(r,e,t,n)}function te(e,t,n){return w(p,e,t,n)}function ne(e,t,n){function r(e,t,n){return a(u(e,t,n,!1))}return w(r,e,t,n)}function re(e,t,n,r,o){return C(!1,e,t,n,r,o)}function oe(e,t,n,r,o){return C(!0,e,t,n,r,o)}function ie(e,t,n,r,o){return o=o?1:0,0===e?0===t?pt:Qe(-(n+r)/t):Qe(st((t*(1+e*o)-r*e)/(n*e+t*(1+e*o)))/st(1+e))}function ae(e,t,n,r,o,i,a){if(Ye(i,[1,2,4])<0||St(e,t)>0)return mt;if(p(e,t,i)<=1){var s=c(e,t,i,a),l=d(e,t,i,a),u=f(e,t,i,a);return(o/100+n/i-(r/100+s/u*n/i))/(r/100+s/u*n/i)*(i*u/l)}var h,m=.1,_={_xmin:0,_xmax:1e3,_precision:1e-10,_havexpos:!1,_xpos:0,_ypos:0,_havexneg:!1,_xneg:0,_yneg:0,_root:0},v=P(!1,g,_,m,e,t,n,r,o,i,a);if(_=v[1],!(h=v[0])){for(m=1e-10;m<_._xmax;m*=2)_=k(!1,g,_,m,e,t,n,r,o,i,a)[1];v=O(!1,!1,_,e,t,n,r,o,i,a),_=v[1],h=v[0]}return h?_._root:mt}function se(e,t,n,r,o){return St(e,t)>=0?mt:(r/n-1)/Tt(e,t,o)}function le(e,t,n,r,o,i){var a=Tt(n,t,i),s=Tt(n,e,i),l=Tt(e,t,i),u=1+a*r;return u/=o/100+s*r,u--,u/=l}function ue(e,t,n,r,o,i,a){function s(e,t,n,r,o,i,a){var s,l,u,c,f;f=1/i,l=f<3?1:f<5?1.5:f<=6?2:2.5,i*=l;var d=Tt(t,n,a);if(Ze(d))return 0;for(u=ut(d*i*e+.5),e-=u,c=e-r,s=0;s<o;s++){if(u=ut(i*e+.5),(c-=u)<0){var p=o-s;return 0===p||1===p?ut(.5*e+.5):0}e-=u}return u}var l=1/i;return l>0&&l<1||l>1&&l<2||l>2&&l<3||l>4&&l<5||St(t,n)>0?mt:s(e,t,n,r,o,i,a)}function ce(e,t,n,r,o,i,a){function s(e,t,n,r,o,i,a){var s=e*i,l=e-r,u=Tt(t,n,a);if(Ze(u))return 0;var c=u*i*e,f=(e-r-c)/s,d=Je((e-r-c)/s);return 0===o?c:o<=d?s*(f<1?f:1):o===d+1?l-s*d-c:0}return St(t,n)>0?mt:s(e,t,n,r,o,i,a)}function fe(e,t,n,r,o,i,a,s,l){var u=.1;if(Ye(s,[1,2,4])<0||St(n,e)>0||St(e,r)>0||St(r,t)>0)return mt;var c={_xmin:0,_xmax:1e3,_precision:1e-10,_havexpos:!1,_xpos:0,_ypos:0,_havexneg:!1,_xneg:0,_yneg:0,_root:0},f=P(!1,_,c,u,e,t,o,i,a,s,l,n,r);c=f[1];var d=f[0];if(d){for(u=1e-10;u<c._xmax;u*=2)c=k(!1,_,c,u,e,t,o,i,a,s,l,n,r)[1];f=D(!1,c,e,t,n,r,o,i,a,s,l),c=f[1],d=f[0]}return d?c._root:mt}function de(e,t,n,r,o,i,a,s){return S(!1,e,t,n,r,i,a,s,o)}function pe(e,t,n,r,o,i,a,s){return S(!0,e,t,n,r,i,a,s,o)}function he(e,t,n){var r=a(t)-a(e);if(St(e,t)>=0||r>365)return mt;var o=365*n,i=360-n*r;return 0===i?pt:i<0?mt:Qe(o/i)}function me(e,t,n){var r=a(t)-a(e);return St(e,t)>=0||r>365?mt:(100-n)/n*(360/r)}function ge(e,t){var n=Xe(e),r=[],o=!1,i=!1,a={_xmin:-1,_xmax:1e10,_precision:1e-10,_havexpos:!1,_xpos:0,_ypos:0,_havexneg:!1,_xneg:0,_yneg:0,_root:0};if(n<2)return mt;it(t)>1&&(t=.1),a._xmax=ft(a._xmax,ot(bt/1e10,1/n)-1);for(var s=0;s<n;s++){var l=e[s];l!==tt&&(r[s]=l,l>0&&(o=!0),l<0&&(i=!0))}if(!o||!i)return mt;var u=N(a,r,t);a=u[1];var c,f=u[0];if(!f){for(c=2;(!a._havexneg||!a._havexpos)&&c<100;c*=2)a=k(!0,rt,a,t*c,r)[1],a=k(!0,rt,a,t/c,r)[1];u=D(!0,a,r),a=u[1],f=u[0]}return f?a._root:mt}function _e(e,t,n){var r=0,o=0,i=0,a=0,s=0,l=[],u=Xe(e);if(u<2)return pt;for(var c=0;c<u;c++){var f=e[c];f!==tt&&(l[c]=f,f>=0?r++:o++)}i=o+r;for(var d=0;d<i;d++){var p=l[d];p>=0?a+=p/ot(1+n,d):s+=p/ot(1+t,d)}return 0===s||0===a||n<=-1?pt:ot(-a*ot(1+n,i)/(s*(1+n)),1/(i-1))-1}function ve(e,t,n){var r=Xe(e);if(r!==Xe(t))return mt;for(var o,i,a=0;a<r;a++)o=e[a]>0||o,i=e[a]<0||i;if(!o||!i)return mt;var s={_xmin:-1,_xmax:1e3,_precision:1e-10,_havexpos:!1,_xpos:0,_ypos:0,_havexneg:!1,_xneg:0,_yneg:0,_root:0},l=P(!0,A,s,n,e,t);if(s=l[1],l[0])return s._root;for(a=1;a<=1024;a+=a){var u=a,c=9/(u+9),f=R(s,n,c,e,t);s=f[1],c=f[2],c=u,f=R(s,n,c,e,t),s=f[1],c=f[2];var d=O(!1,!0,s,e,t);if(s=d[1],d[0])return s._root}return mt}function ye(e,t,n,r,o,i){o>1&&(o=1);var a={_precision:1e-10,_havexpos:!1,_xpos:0,_ypos:0,_havexneg:!1,_xneg:0,_yneg:0,_root:0},s=ot(1.7976931348623157e298,1/e);a._xmin=ct(-1e10,1-s),a._xmax=ft(1e10,s-1);var l={_nper:e,_pmt:t,_pv:n,_fv:r,_type:o},u=F(a,l,i);l=u[2],a=u[1];var c,f=u[0];if(!f){for(c=2;(!a._havexneg||!a._havexpos)&&c<100;c*=2)u=I(a,i*c,l),l=u[2],a=u[1],u=I(a,i/c,l),l=u[2],a=u[1];u=O(!0,!1,a,l),a=u[1],f=u[0]}return f?a._root:mt}function be(e,t,n,r,o,i,a){function s(e,t,n,r,o){var i,a,s,l=o/n;return l>=1?(l=1,a=1===r?e:0):a=e*ot(1-l,r-1),s=e*ot(1-l,r),i=a-(s<t?t:s),i<0?0:i}function l(e,t,n,r,o,i,a){function l(e,t,n,r,o,i){var a,l,u,c=0,f=0,d=at(o),p=d,h=e-t,m=!1;for(u=1;u<=p;u++)m?l=f:(a=s(e,t,n,u,i),f=h/(r-(u-1)),f>a?(l=f,m=!0):(l=a,h-=a)),u===p&&(l*=o+1-d),c+=l;return c}var u,c=ut(r),f=c,d=at(o),p=d,h=0;if(a)for(u=f+1;u<=p;u++){var m=s(e,t,n,u,i);u===f+1?m*=ft(o,c+1)-r:u===p&&(m*=o+1-d),h+=m}else{var g,_=n;r!==ut(r)&&i>1&&r>=n/2&&(g=r-n/2,r=n/2,o-=g,_+=1),e-=l(e,t,n,_,r,i),h=l(e,t,n,n-r,o-r,i)}return h}return o<r?mt:e<t&&0===r&&1===o?e-t:l(e,t,n,r,o,i,a)}function we(e,t,n,r,o,i,s){if(Ye(i,[1,2,4])<0||St(e,n)>=0)return mt;if(1===i||0===s||4===s)return Ce(e,t,n,r,o,i,s);for(var l=e.getFullYear(),u=e.getMonth(),c=e.getDate(),f=n.getFullYear(),d=n.getMonth(),p=n.getDate(),h=t.getMonth(),m=t.getDate(),g=[],_=[],v=[],y=[31,28,31,30,31,30,31,31,30,31,30,31],b=0;b<i;b++)g[b]=(h+12*b/i)%12,_[b]=m<=y[g[b]]?m:y[g[b]],2===s?v[b]=360/i:3===s&&(v[b]=365/i);for(b=0;b<i;b++){var w=b===i-1?0:b+1,C=g[w]>g[b]?2001:2002;v[b]=a(new Date(C,g[w],_[w]))-a(new Date(2001,g[b],_[b]))}for(var S=0,x=a(n);l<f||l===f&&u<d||l===f&&u===d&&c<p;){for(b=0;b<i&&(u<g[b]||u===g[b]&&c<_[b])&&(0===b||g[b]>g[b-1]);)b++;for(;b<i&&(u>g[b]||u===g[b]&&c>=_[b])&&(b++,u!==g[b-1]||c!==_[b-1]););b--,w=b===i-1?0:b+1,C=u+12/i>=12?l+1:l;var T=a(new Date(l,u,c));S+=o*r/i*(Math.min(a(new Date(C,g[w],_[w])),x)-T)/v[b],l=C,u=g[w],c=_[w]}return S}function Ce(e,t,n,r,o,i,a){var l=s(e,n,a),u=wt(e,a);return l<0||u<=0?mt:o*r*(l/u)}function Se(e,t,n,r,o){if(St(e,t)>0)return mt;var i=s(e,t,o),a=wt(e,o);return i<0||a<=0?mt:r*n*i/a}function xe(e,t,n,r,o){if(St(e,t)>=0)return mt;var i=wt(e,o),a=s(e,t,o);return a<=0||i<=0?mt:(r-n)/r*(i/a)}function Te(e,t){return ot(1+e/t,t)-1}function Ee(e,t,n,r,o){if(St(e,t)>=0)return mt;var i=s(e,t,o),a=wt(e,o);return i<=0||a<=0?mt:(r-n)/n*(a/i)}function Me(e,t){return t*(ot(1+e,1/t)-1)}function Ae(e,t,n,r,o){if(n+(o<12?1:0)<r)return mt;if(0===e)return 0;for(var i=yt(1-ot(t/e,1/n),3),a=0,s=0,l=1;l<=r;l++)s=1===l?e*i*o/12:l===n+1?(e-a)*i*(12-o)/12:(e-a)*i,a+=s;return s}function ke(e,t,n,r,o){var i=0,a=0;if(n<r)return mt;if(e<=t)return 0;for(var s=1;s<=r;s++)a=o/n*(e-i),a=ft(a,e-i-t),i+=a;return a}function Re(e,t,n){return(e-t)/n}function Ie(e,t,n,r){return r>n?mt:(e-t)*(n-r+1)*2/(n*(n+1))}function Oe(e,t){return x(!0,e,t)}function De(e,t){return x(!1,e,t)}function Pe(e,t,n,r,o,i,a){return Ye(i,[1,2,4])<0||St(e,t)>0?mt:g(e,t,n,r,o,i,a)}function Ne(e,t,n,r,o){if(St(e,t)>=0)return mt;var i=s(e,t,o),a=wt(e,o);return i<=0||a<=0?mt:r-n*r*i/a}function Fe(e,t,n,r,o,i){if(St(e,t)>=0)return mt;var a=s(e,t,i),l=s(n,t,i),u=s(n,e,i),c=wt(e,i);if(u<=0||c<=0||a<=0||l<=0)return mt;var f=1+a/c*o;return 0===f?mt:(100+l/c*r*100)/f-u/c*r*100}function Le(e,t,n,r,o,i,a,s,l){return Ye(s,[1,2,4])<0||St(n,e)>0||St(e,r)>0||St(r,t)>0?mt:_(e,t,o,i,a,s,l,n,r)}function He(e,t,n){var r=a(t)-a(e);return St(e,t)>=0||r>365?mt:100*(1-n*r/360)}function Ve(e){var t=v(e,2);return t>=0?t:mt}function je(e,t,n,r,o){function i(e){var t=e.substr(0,3);return Ye(t,["BEF","LUF","ESP","ITL","PTE","GRD","LUX"])>=0?0:2}function a(e){var t=e.substr(0,3);return Ye(t,["BEF","LUF","ESP","ITL","LUX"])>=0?0:2}var s=0;r||(s=a(n)),o._isArgExists||(o._value=i(t));var l=0,u=v(t,o._value),c=v(n,o._value);return u>=0&&c>=0?(l=e*c/u,r||(l=yt(l,s)),l):ht}var Be=n(0),Ue=n(5),We=isFinite,ze=Be._Types,Ye=ze._inArray,Ge=ze._isArray,Ke=ze._isNullOrUndefined,Xe=Be._ArrayHelper._getLength,qe=Ue.Convert,Je=qe._toInt,Ze=qe._isError,Qe=qe._toResult,$e=qe._toArray,et=qe._toDouble,tt=qe.CalcConvertedError,nt=null,rt=void 0,ot=Math.pow,it=Math.abs,at=Math.ceil,st=Math.log,lt=Math.sqrt,ut=Math.floor,ct=Math.max,ft=Math.min,dt=Ue.Errors,pt=dt.DivideByZero,ht=dt.Value,mt=dt.Number,gt=Ue.Functions,_t=gt._defineBuiltInFunction,vt=gt._MathHelper,yt=vt._round,bt=gt._MAX_DOUBLE_VALUE,wt=gt._annualYearBasis,Ct=gt._getDaysInMonth,St=gt._compareDateTime,xt=gt._daysBetweenBasis,Tt=gt._yearfrac,Et={_argType:0},Mt={_defaultValue:0,_argType:0},At={_argType:0,_argCondition:"<= 0"},kt={_argType:0,_argCondition:"< 1"},Rt={_argType:0,_argCondition:"< 0"},It={_defaultValue:.1,_argType:0},Ot={_defaultValue:2,_argType:0},Dt={_argType:0,_argCondition:"= 0"},Pt={_defaultValue:1e3,_argType:0,_argCondition:"<= 0"},Nt={_argType:6},Ft={_argType:5},Lt={_defaultValue:!1,_argType:7},Ht={_argType:2},Vt={_argType:2,_argCondition:"<= 0"},jt={_argType:2,_argCondition:"< 1"},Bt={_defaultValue:0,_argType:2},Ut={_defaultValue:0,_argType:2,_argCondition:["< 0","> 4"]},Wt={_defaultValue:0,_argType:2,_argCondition:["< 0","> 4","= 2"]},zt={_argType:2,_argCondition:"= 0",_conditionErrorValue:pt},Yt={_argType:2,_argCondition:"< 0"},Gt={_argType:4,_valueType:1,_toOneDimension:!0,_breakOnError:!0},Kt={_argType:4,_valueType:1,_toOneDimension:!0,_breakOnError:!0,breakOnConvertError:!0},Xt=[Nt,Nt,Ht,Ut],qt=[Nt,Nt,Et,Et,Ht,Ut],Jt=[Nt,Nt,At],Zt=[Et,Nt,Nt,Et,Ht,At,Wt],Qt=[Et,Et,Et,Mt,Mt],$t=[Nt,Nt,At,At,Ut],en=[At,Vt,At,jt,Ht,Ht],tn=[At,jt],nn=[Et,Yt];_t("FV",V,3,5,Qt,rt,rt,{_acceptsMissingArgument:[3,4]}),_t("FVSCHEDULE",j,2,2,[Et,Gt],1,1),_t("NPV",B,2,rt,Et,"> 0","> 0"),_t("PV",U,3,5,Qt,rt,rt,{_acceptsMissingArgument:[3,4]}),_t("RECEIVED",W,4,5,$t,rt,rt,{_acceptsMissingArgument:3}),_t("XNPV",z,3,3,[Et,Kt,Kt],"!= 0","!= 0"),_t("CUMIPMT",Y,6,6,en),_t("CUMPRINC",G,6,6,en),_t("IPMT",K,4,6,[Et,kt,kt,Et,Mt,Bt],rt,rt,{_acceptsMissingArgument:[4,5]}),_t("ISPMT",X,4,4,[Et,Ht,zt,Et]),_t("PMT",q,3,5,[Et,{_argType:0,_argCondition:"= 0",_conditionErrorValue:pt},Et,Mt,Mt],rt,rt,{_acceptsMissingArgument:[3,4]}),_t("PPMT",J,4,6,[Et,kt,Et,Et,Mt,Mt],rt,rt,{_acceptsMissingArgument:[4,5]}),_t("COUPDAYBS",Z,3,4,Xt,rt,rt,{_acceptsMissingArgument:3}),_t("COUPDAYS",Q,3,4,Xt,rt,rt,{_acceptsMissingArgument:3}),_t("COUPDAYSNC",$,3,4,Xt,rt,rt,{_acceptsMissingArgument:3}),_t("COUPNCD",ee,3,4,Xt,rt,rt,{_acceptsMissingArgument:3}),_t("COUPNUM",te,3,4,Xt,rt,rt,{_acceptsMissingArgument:3}),_t("COUPPCD",ne,3,4,Xt,rt,rt,{_acceptsMissingArgument:3}),_t("DURATION",re,5,6,qt,rt,rt,{_acceptsMissingArgument:5}),_t("MDURATION",oe,5,6,qt,rt,rt,{_acceptsMissingArgument:5}),_t("NPER",ie,3,5,[{_argType:0,_argCondition:"<= -1"},Et,Et,Mt,Mt],rt,rt,{_acceptsMissingArgument:[3,4]}),_t("YIELD",ae,6,7,[Nt,Nt,Rt,Rt,At,Ht,Ut],rt,rt,{_acceptsMissingArgument:6}),_t("YIELDDISC",se,4,5,[Nt,Nt,At,At,Ut],rt,rt,{_acceptsMissingArgument:3}),_t("YIELDMAT",le,5,6,[Nt,Nt,Nt,Rt,Et,Ut],rt,rt,{_acceptsMissingArgument:5}),_t("AMORDEGRC",ue,6,7,Zt,rt,rt,{_acceptsMissingArgument:6}),_t("AMORLINC",ce,6,7,Zt,rt,rt,{_acceptsMissingArgument:6}),_t("ODDFYIELD",fe,8,9,[Nt,Nt,Nt,Nt,Rt,At,At,Ht,Ut],rt,rt,{_acceptsMissingArgument:8}),_t("ODDLYIELD",de,7,8,[Nt,Nt,Nt,Rt,Rt,At,Et,Ut],rt,rt,{_acceptsMissingArgument:7}),_t("ODDLPRICE",pe,7,8,[Nt,Nt,Nt,Rt,Rt,At,Ht,Ut],rt,rt,{_acceptsMissingArgument:7}),_t("TBILLEQ",he,3,3,Jt),_t("TBILLYIELD",me,3,3,Jt),_t("IRR",ge,1,2,[Gt,It],0,0,{_acceptsMissingArgument:1}),_t("MIRR",_e,3,3,[Gt,Et,Et],0,0),_t("XIRR",ve,2,3,[Kt,{_argType:4,_valueType:4,_toOneDimension:!0,_breakOnError:!0,breakOnConvertError:!0},It],"!= 2","!= 2",{_acceptsMissingArgument:2}),_t("RATE",ye,3,6,[At,Et,Et,Mt,{_defaultValue:0,_argType:2,_argCondition:"< 0",_conditionErrorValue:ht},It],rt,rt,{_acceptsMissingArgument:[3,4,5]}),_t("VDB",be,5,7,[Rt,Rt,Yt,Rt,Rt,Ot,Lt],rt,rt,{_acceptsMissingArgument:[5,6]}),_t("ACCRINT",we,6,8,[Nt,Nt,Nt,At,Pt,Ht,Ut],rt,rt,{_acceptsMissingArgument:[4,6,7]}),_t("ACCRINTM",Se,3,5,[Nt,Nt,At,Pt,Ut],rt,rt,{_acceptsMissingArgument:[3,4]}),_t("DISC",xe,4,5,[Nt,Nt,At,At,Ut],rt,rt,{_acceptsMissingArgument:3}),_t("EFFECT",Te,2,2,tn),_t("INTRATE",Ee,4,5,$t,rt,rt,{_acceptsMissingArgument:3}),_t("NOMINAL",Me,2,2,tn),_t("DB",Ae,4,5,[Rt,Et,jt,jt,{_defaultValue:12,_argType:2,_argCondition:["< 1","> 12"]}],rt,rt,{_acceptsMissingArgument:3}),_t("DDB",ke,4,5,[Rt,Et,Vt,Vt,{_defaultValue:2,_argType:0,_argCondition:"<= 0"}],rt,rt,{_acceptsMissingArgument:3}),_t("SLN",Re,3,3,[Et,Et,zt]),_t("SYD",Ie,4,4,[Et,Rt,jt,Vt]),_t("DOLLARDE",Oe,2,2,nn),_t("DOLLARFR",De,2,2,nn),_t("PRICE",Pe,6,7,[Nt,Nt,Rt,Rt,Dt,Ht,Ut],rt,rt,{_acceptsMissingArgument:6}),_t("PRICEDISC",Ne,4,5,$t,rt,rt,{_acceptsMissingArgument:3}),_t("PRICEMAT",Fe,5,6,[Nt,Nt,Nt,Rt,Rt,Ut],rt,rt,{_acceptsMissingArgument:5}),_t("ODDFPRICE",Le,8,9,[Nt,Nt,Nt,Nt,Rt,Rt,At,Ht,Ut],rt,rt,{_acceptsMissingArgument:8}),_t("TBILLPRICE",He,3,3,[Nt,Nt,At]),_t("EURO",Ve,1,1,Ft),_t("EUROCONVERT",je,3,5,[Et,Ft,Ft,Lt,{_needArgExistsValue:!0,_argType:2,_defaultValue:3,_argCondition:"< 3",_conditionErrorValue:ht}],rt,rt,{_acceptsMissingArgument:[3,4]}),e.exports=gt},function(e,t,n){function r(e,t,n){if(j(e))return P;if(e.isArray||e.isReference){var r=e.colCount;return t>r&&(t=[n,n=t][0]),e[n*r+t]}return e[0]}function o(e,t){return!j(t)&&(!!((j(e)||K(e,!0))&&K(t,!0)||oe(e)&&oe(t))||!(!ie(e)||!ie(t)))}function i(e,t,n,r,o){if(e<0||t<0||t<e||n<e||n>t)return-1;if(o)return E=e,M=t,A=n,k=n,R=r,I=r,A;if(R){if(++A>M){if(R!==I)return-1;A=k-1,R=!1}}else if(--A<E){if(R!==I)return-1;A=k+1,R=!0}return A}function a(e,t,n){function r(e,t,n){var r=H(e),o=n;return isNaN(r)||(r===t?o=0:r>t&&(o=1),o=2),o}if(e===t)return 0;if(ie(e)){if(!t&&0===U(e.toString()))return 0;if(K(t))return 1;if(oe(t))return 2;if(ie(t)){var o=n?e.toString().localeCompare(t.toString()):e.toLowerCase().localeCompare(t.toLowerCase());return 0===o?0:o>0?1:2}return t instanceof Date?r(e,t,1):-1}if(ie(t))return e||0!==U(t.toString())?K(e)?2:oe(e)?1:e instanceof Date?r(e,t,2):-1:0;if(oe(e)&&K(t))return 1;if(oe(t)&&K(e))return 2;var i=X(e),a=X(t);return i===a?0:i<a?2:1}function s(e,t,n){var o=r(e,t,n);return j(o)?0:o}function l(e,t,n,l){var u,c=-1,f=0,d=-1,p=-1;if(u=l?t.rowCount:t.colCount,--u<f)return-1;for(;f<=u;){var h,m=P,g=e[0];for(n>=1!=(2===c)&&(d=p),p=Y((f+u)/2),p=i(f,u,p,n>=0,!0),h=p;!o(g,m)&&-1!==p;){var _=!1;if(m=l?r(t,0,p):r(t,p,0),o(g,m))break;p=i(0,0,0,!1,!1),!_&&n>=0&&p<h?(u=p,_=!0):!_&&n<0&&p>h&&(f=p,_=!0)}if(-1===p&&n>=1!=(2===c))return d;if(-1===p)return-1;if(c=a(g,m,!1),n>=1&&1===c)f=p+1;else if(n>=1&&2===c)u=p-1;else if(n<=-1&&1===c)u=p-1;else if(n<=-1&&2===c)f=p+1;else if(0===c){for(;n<=-1&&p>f||n>=0&&p<u;){var v=0;if(v=n>=0?p+1:p-1,!(m=l?s(t,0,v):s(t,v,0)))return-1;if(!o(g,m))break;if(0!==(c=a(g,m,!1)))break;p=v}return p}}return n>=1!=(2===c)?p:d}function u(e,t,n,i){var s,l,u,c,f,d=P,p=-1,h=e[0],m=ie(h),g=F._getWildcardCriteriaFullMatch(h);for(l=i?t.rowCount:t.colCount,m&&g&&(c=F._getRegIgnoreCase(g)),u=0;u<l;u++)if(f=i?r(t,0,u):r(t,u,0),o(h,f)){var _=ie(f);if(m&&_&&g?(c.lastIndex=0,s=c.test(f)?0:1):s=a(h,f,!1),n>=1&&1===s)s=-1,p>=0&&(s=a(f,d,!1)),(p<0||p>=0&&1===s)&&(p=u,d=f);else if(n<=-1&&2===s)s=-1,p>=0&&(s=a(f,d,!1)),(p<0||p>=0&&2===s)&&(p=u,d=f);else if(0===s)return u}return p}function c(e,t,n){if(!e)return J;var r=e.arrayFormulaMode,o=t!==N,i=n?0:1;return t=o?t:e.getReference(e.source,D._createRangeIdentity(e.row,e.column,e.rowCount,e.columnCount)),t&&1===t.getRangeCount()?r&&o?new se(t.getSource(),t.getRow(0),t.getColumn(0),t.getRowCount(0),1,i):(n?t.getRow(0):t.getColumn(0))+1:J}function f(e,t,n,r,o){if(o&&n>t.colCount||!o&&n>t.rowCount)return Z;var i=r?l(e,t,1,o):u(e,t,0,o);return i>=0?o?s(t,n-1,i):s(t,i,n-1):Q}function d(e,t){return c(e,t,!0)}function p(e,t){return c(e,t,!1)}function h(e){return te.getRowCount(e)}function m(e){return te.getColumnCount(e)}function g(e){return new le(e)}function _(e,t,n,r){return f(e,t,n,r,!1)}function v(e,t,n,r){return f(e,t,n,r,!0)}function y(e,t,n){var r,o=e,i=t,a=-1,u=i.colCount,c=i.rowCount;if(n===N){var f=u>c?_(o,i,c):v(o,i,u);return z(f)?Q:f}if(r=W._toArray(n,0,!0,!1,!1)){if(r.colCount>1&&r.rowCount>1)return Q}else r=i;return a=l(o,i,1,!(u>c)),a>=0?(u=r.colCount,c=r.rowCount,u>c?s(r,a,c-1):s(r,u-1,a)):Q}function b(e){var t=arguments;return e<1||U(t)<=e?J:j(t[e])?0:t[e]}function w(e,t,n){function r(e,t){var n,r=U(e);for(n=1;n<r;n++){if(2===a(e[n-1],e[n],!1)&&!t)return!1}return!0}var o=e,i=t;if(!i.isArray&&!i.isReference)return Q;var s=i.colCount,c=i.rowCount,f=-1;return s>1&&c>1?Q:1===n&&!r(i,!0)||-1===n&&!r(i,!1)?Q:(1===n?f=l(o,i,1,c>1):0===n?f=u(o,i,0,c>1):-1===n&&(f=l(o,i,-1,c>1)),-1===f?Q:f+1)}function C(e,t,n,r,o){function i(e,t,n,r){return e+=t,r?0!==n&&(e+="[",e+=n.toString(),e+="]"):e+=n,e}function a(e,t,n){return n||(e+="$"),e+=t}function s(e,t,n){for(n||(e+="$");t>.1;t=parseInt((t-1)/26),10)e=O._StringHelper._insert(e,U(e),String.fromCharCode("A".charCodeAt(0)+(t-1)%26));return e}function l(e,t){if(t&&0<U(t)){var n,r=!D._isLetter(t[0])&&"_"!==t[0];for(n=1;!r&&n<U(t);n++)r=!D._isLetterOrDigit(t[n])&&"_"!==t[n];r?(e+="'",e+=t.replace("'","''"),e+="'"):e+=t,e+="!"}return e}var u=3===n||4===n||7===n||8===n,c=2===n||4===n||6===n||8===n,f="";return e<1&&(r||!u)||e>D.maxRowCount||t<1&&(r||!c)||t>D.maxColumnCount||n<1||8<n?J:(f=l(f,o),r?(f=s(f,t,c),f=a(f,e,u)):(f=i(f,"R",e,u),f=i(f,"C",t,c)),f)}function S(e,t,n,r,o){function i(e){return!j(e)&&!e._error}var a=e instanceof D.EvaluateContext?e:N,s=a!==P&&a.acceptsReference;if(t instanceof ee){var l,u,c={value:-1},f=t,d=f.getRowCount(0),p=f.getColumnCount(0),h=f.getRow(0),m=f.getColumn(0);if(3===U(arguments)){if(1!==f.getRangeCount()||1!==d&&1!==p)return Z;var g=i(n)&&G(n,c)?c.value:0;return 0!==g||s||a===P||(g=d>0?a.rowOffset:a.columnOffset),g<0?J:d*p<g?Z:0===g?f.create([ae(h,m,d,p)]):(l=Math.floor((g-1)/p)+h,u=(g-1)%p+m,f.create([ae(l,u,1,1)]))}if(n=i(n)&&G(n,c)?c.value-1:-1,r=i(r)&&G(r,c)?c.value-1:-1,(o=i(o)&&G(o,c)?c.value-1:0)>=f.getRangeCount())return Z;d=f.getRowCount(o),p=f.getColumnCount(o);var _=f.getRow(o),v=f.getColumn(o);return-1===n&&!s&&d>1&&a!==P&&(n=a.rowOffset),-1===r&&!s&&p>1&&a!==P&&(r=a.columnOffset),l=n+_,u=r+v,n<-1||r<-1||o<0?J:d<=n||p<=r||f.getRangeCount()<=o?Z:-1===n&&-1===r?f.create([ae(_,v,d,p)]):-1===n?f.create([ae(_,u,d,1)]):-1===r?f.create([ae(l,v,1,p)]):f.create([ae(l,u,1,1)])}if(W._isArray(t)){var y=t;return d=y.getRowCount(),(p=y.getColumnCount(),n=n!==N?Y(n):-1,r=r!==N?Y(r):-1,1!==(o=o!==N?Y(o)-1:1))?Z:(-1===n&&-1===r?n=r=0:-1===r&&1===d&&(r=n,n=1),n=-1===n?0:n,r=-1===r?0:r,d=y.getRowCount(),p=y.getColumnCount(),n<0||r<0||o<0?J:(n>d&&1===d&&r===N&&(r=n,n=0),d<n||p<r?Z:0===n&&0===r?y.slice(0,0,d,p):0===n?y.slice(0,r-1,d,1):0===r?y.slice(n-1,0,1,p):y.getValue(n-1,r-1)))}}function x(e,t,n,r,o){if(!(e&&e instanceof ee&&1===e.getRangeCount()))return J;r=r!==N?Y(r):e.getRowCount(0),o=o!==N?Y(o):e.getColumnCount(0);var i=e.getSource(),a=e.getRow(0)+t,s=e.getColumn(0)+n;return r<=0||o<=0||a<0||i.getRowCount()<a+r||s<0||i.getColumnCount()<s+o?Z:e.create([{row:a,col:s,rowCount:r,colCount:o}])}function T(e,t,n){if(!e)return Q;if(!t)return Z;var r,o=e.row,i=e.column,a=new $,s=D._createCellIdentity(o,i),l=e.source?e.source.getParserContext(!n,s):new D.ParserContext(e.source,!n,s),u=a.parse(l,t);if(u){if(8===u.type&&(u.source?(r=u.source,u=r.getCustomName(u.value)):u=e.getName(u.value)),!u||L._inArray(u.type,[1,13])<0)return Z;if(r=u.source||e.source,25===u.type||26===u.type)return r.getValueByName(u.nameIdentity);var c=u.getRange(o,i);return 13===u.type&&(r=u.source()),1!==c.rowCount||1!==c.colCount||e.acceptsReference||e.arrayFormulaMode?r.getReference(c):r.getValue(c.row,c.col)}return Z}var E,M,A,k,R,I,O=n(0),D=n(5),P=null,N=void 0,F=O._RegexHelper,L=O._Types,H=O._DateTimeHelper._parseInvariant,V=L._extend,j=L._isNullOrUndefined,B=L._inherit,U=O._ArrayHelper._getLength,W=D.Convert,z=W._isError,Y=W._toInt,G=W._tryToInt,K=W._isNumber,X=W._toDouble,q=D.Errors,J=q.Value,Z=q.Reference,Q=q.NotAvailable,$=D.Parser,ee=D.CalcReference,te=D.CalcArrayHelper,ne=D.Functions,re=ne._defineBuiltInFunction,oe=ne._isBoolean,ie=ne._isString,ae=function(e,t,n,r){return{row:e,col:t,rowCount:n,colCount:r}},se=function(e){function t(t,n,r,o,i,a){var s=this;e.call(s,t,[ae(n,r,o,i)]),s._row=n,s._column=r,s._rowCount=o,s._columnCount=i,s._type=a}B(t,e);var n={type:function(){return this._type},getValue:function(t,n,r){var o=this,i=o._type;return 0===i?o.getRow(0)+1+n:1===i?o.getColumn(0)+1+r:e.prototype.getValue.call(o,t,n,r)},toArray:function(t,n){var r,o,i,a,s,l,u=this,c=[],f=u._row,d=u._column,p=u._type,h=u.getRangeCount(),m=u._rowCount,g=u._columnCount;for(r=0;r<h;r++)for(n||(i=[],c.push(i)),s=0;s<m;s++)for(n||(a=[],i.push(a)),l=0;l<g;l++)o=0===p?f+1+s:1===p?d+1+l:e.prototype.getValue.call(u,r,f+s,d+l),n?c.push(o):a.push(o);return n||1!==h||(c=c[0]),c.rowCount=m,c.colCount=g,c.rangeCount=h,c}};return V(t.prototype,n),t}(D.CalcReference),le=function(e){function t(t){e.call(this),this._array=t}B(t,e);var n={getRowCount:function(){return te.getColumnCount(this._array)},getColumnCount:function(){return te.getRowCount(this._array)},getValue:function(e,t){return te.getValue(this._array,t,e)}};return V(t.prototype,n),t}(D.CalcArray),ue={_defaultValue:!0,_argType:7},ce={_argType:2},fe={_defaultValue:1,_argType:2},de={_argType:2,_argCondition:"<= 0",_conditionErrorValue:J},pe={_argType:4,_valueType:0,_toOneDimension:!0};re("ADDRESS",C,2,5,[ce,ce,fe,ue,{_defaultValue:"",_argType:5}],N,N,{_acceptsMissingArgument:[2,3,4]}),re("INDEX",S,2,4,N,0,0,{_acceptsMissingArgument:[1,2,3],_isContextSensitive:!0}),re("OFFSET",x,3,5,[{},ce,ce],0,0,{_acceptsMissingArgument:[3,4],_isVolatile:!0,_arrayArgumentEvaluateMode:2,returnReference:!0}),re("ROW",d,0,1,N,-1,N,{_isContextSensitive:!0,_precedentReference:-1,expandColumns:-1}),re("COLUMN",p,0,1,N,-1,N,{_acceptsMissingArgument:0,_isContextSensitive:!0,_precedentReference:-1,expandRows:-1}),re("ROWS",h,1,1,N,-1,-1,{_precedentReference:-1,expandColumns:-1,_isVolatile:!0}),re("COLUMNS",m,1,1,N,-1,-1,{_precedentReference:-1,expandRows:-1,_isVolatile:!0}),re("TRANSPOSE",g,1,1,N,-1,-1),re("LOOKUP",y,2,3,[pe,pe],"!= 0","!= 0",{_arrayArgumentEvaluateMode:1}),re("HLOOKUP",_,3,4,[pe,pe,de,ue],1,1,{_acceptsMissingArgument:3}),re("VLOOKUP",v,3,4,[pe,pe,de,ue],1,1,{_acceptsMissingArgument:3}),re("CHOOSE",b,2,255,ce,">= 1",">= 1",{_acceptsError:">= 1",isBranch:!0,findTestArgument:0,findBranchArgument:function(e){var t={value:-1};return z(e)?-1:(G(e,t),t.value)}}),re("MATCH",w,2,3,[pe,pe,fe],1,1,{_acceptsMissingArgument:2}),re("INDIRECT",T,1,2,[{_argType:5},ue],N,N,{_acceptsMissingArgument:2,_isVolatile:!0,_isContextSensitive:!0}),e.exports=ne},function(e,t,n){function r(e,t,n,r){function o(e,t,n){var r,o,i=zt(e);if(t!==e[0]){var a=0,s=e[0];for(o=1;o<i&&e[o]<t;o++)e[o]!==s&&(a=o,s=e[o]);if(e[o]!==s&&(a=o),t===e[o])r=n?a/(i-1):(o+1)/(i+1);else if(0===a)r=0;else{var l=(t-e[a-1])/(e[a]-e[a-1]);r=n?(a-1+l)/(i-1):(a+l)/(i+1)}}else r=n?0:1/(i+1);return r}var i=[];w(e,i);var a=zt(i);if(0===a||t<i[0]||t>i[a-1])return hn;var s=1===a?1:o(i,t,r);return 0!==s?cn(s*Zt(10,n))/Zt(10,n):s}function o(e,t,n){var r,o,i,a,s,l,u,c,f,d,p=300,h=1e-50,m=1e-20;for(c=e+t,d=e+1,f=e-1,s=1,l=1-c*n/d,sn(l)<h&&(l=h),l=1/l,i=l,r=1;r<=p&&(o=r+r,a=(t-r)*r*n/((f+o)*(e+o)),l=1+a*l,sn(l)<h&&(l=h),s=1+a/s,sn(s)<h&&(s=h),l=1/l,i*=l*s,a=0-(e+r)*(c+r)*n/((e+o)*(d+o)),l=1+a*l,sn(l)<h&&(l=h),s=1+a/s,sn(s)<h&&(s=h),l=1/l,u=l*s,i*=u,!(sn(u-1)<m));r++);return i}function i(e){return[2.2250738585072014e-308,1.7976931348623157e308,Zt(2,-53),Zt(2,-52),Cn._log(2,10)][e-1]||0}function a(e,t,n){var r,o=0,i=0;if(t<1)return 0;for(r=1;r<=t;r++)if(o=t-r,(i+=sn(wn(e[o])))>n)return o;return o}function s(e,t,n){var r,o,i,a,s;if(n<1||n>1e3||e<-1.1||e>1.1)return NaN;for(a=2*e,i=o=0,r=0,s=1;s<=n;s++)i=o,o=r,r=a*o-i+wn(t[n-s]);return.5*(r-i)}function l(e){var t=[.16663894804518634,-1384948176067564e-20,9.81082564692473e-9,-1.809129475572494e-11,6.221098041892606e-14,-3.399615005417722e-16,2.683181998482699e-18,-2.868042435334643e-20,3.9628370610464347e-22,-6.831888753985767e-24,1.4292273559424982e-25,-3.5475981581010704e-27,1.025680058010471e-28,-3.401102254316749e-30,1.276642195630063e-31],n=a(t,15,i(3)),r=1/ln(i(3)),o=an($t(un(i(2)/12),-un(12*i(1))));if(e<10)return NaN;if(e>=o)return 4.930380657631324e-32;if(e<r){var l=10/e;return s(l*l*2-1,t,n)/e}return 1/(12*e)}function u(e){var t=[1.037869356274377,-.13364301504908918,.019408249135520562,-.0030107551127535777,.0004869461479715485,-8105488189317536e-20,13778847799559525e-21,-2380221089435897e-21,4.1640416213865184e-7,-7.359582837807599e-8,1.3117611876241675e-8,-2.3546709317742423e-9,4.2522773276035e-10,-7.71908941348408e-11,1.407574648135907e-11,-2.5769072058024682e-12,4.734240666629442e-13,-8.724901267474264e-14,1.612461490274055e-14,-2.9875652015665774e-15,5.548070120908289e-16,-1.0324619158271569e-16,1.9250239203049852e-17,-3.595507346526515e-18,6.726454253787686e-19,-1.260262416873522e-19,2.364488440860621e-20,-4.4419377050807936e-21,8.354659446403425e-22,-1.5731559416479563e-22,2.9653128740247425e-23,-5.594958348181595e-24,1.056635426883568e-24,-1.9972483680670205e-25,3.778297781883936e-26,-7.153158688908174e-27,1.3552488463674214e-27,-2.5694673048487566e-28,4.8747756066216946e-29,-9.254211253084972e-30,1.757859784176024e-30,-3.341002667773101e-31,6.353393618023618e-32],n=a(t,43,.1*i(3));return e<=-1?NaN:sn(e)<=.375?e*(1-e*s(e/.375,t,n)):un(e+1)}function c(e){var t,n,r,o,i,a,s=1,l=[1,.5772156649015329,-.6558780715202538,-.0420026350340952,.1665386113822915,-.0421977345555443,-.009621971527877,.007218943246663,-.0011651675918591,-.0002152416741149,.0001280502823882,-201348547807e-16,-12504934821e-16,1133027232e-15,-2.056338417e-7,6.116095e-9,5.0020075e-9,-1.1812746e-9,1.043427e-10,7.7823e-12,-3.6968e-12,5.1e-13,-2.06e-14,-5.4e-15,1.4e-15];if(e>171)return 1e308;if(e===bn(e))if(e>0)for(o=1,t=2;t<e;t++)o*=t;else o=1e308;else{if(sn(e)>1){for(a=sn(e),r=bn(a),s=1,n=1;n<=r;n++)s*=a-n;a-=r}else a=e;for(i=l[24],n=23;n>=0;n--)i=i*a+l[n];o=1/(i*a),sn(e)>1&&(o*=s,e<0&&(o=-rn/(e*o*tn(rn*e))))}return o}function f(e){var t,n,r,o,i,a,s=0,l=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(t=e,e<=0)return 1e308;if(1===e||2===e)return 0;for(e<=7&&(s=bn(7-e),t=e+s),n=1/(t*t),r=2*rn,i=l[9],a=8;a>=0;a--)i=i*n+l[a];if(o=i/t+.5*un(r)+(t-.5)*un(t)-t,e<=7)for(a=1;a<=s;a++)o-=un(t-1),t-=1;return o}function d(e,t){var n,r,o;if(r=o=e,t<r&&(r=t),t>o&&(o=t),r<0)return NaN;if(0===r)return Dn;if(r>=10)return n=l(r)+l(o)-l(r+o),-.5*un(o)+.9189385332046728+n+(r-.5)*un(r/(r+o))+o*u(-r/(r+o));if(o>=10){n=l(o)-l(r+o);var i=ct(r);return En(i)?NaN:wn(i)+n+r-r*un(r+o)+(o-.5)*u(-r/(r+o))}return un(c(r)*(c(o)/c(r+o)))}function p(e,t,n){var r,o,a,s,l,u,c,f,p,h,m,g=0,_=0,v=0,y=0;0===g&&(g=i(3),_=un(g),v=i(1),y=un(v));var b=e,w=t,C=n;if(w/(w+C)<e&&(b=1-b,w=n,C=t),(w+C)*b/(w+1)<g)r=0,c=w*un(Qt(b,v))-un(w)-d(w,C),c>y&&0!==b&&(r=an(c)),b===e&&w===t||(r=1-r);else{if(s=C-en(C),0===s&&(s=1),c=w*un(b)-d(s,w)-un(w),r=0,c>=y&&(r=an(c),u=r*w,1!==s))for(p=bn(Qt(_/un(b),4)),h=1;h<=p;h++)f=h,u=u*(f-s)*b/f,r+=u/(w+f);if(C>1){for(c=w*un(b)+C*un(1-b)-d(w,C)-un(C),m=bn(Qt(c/y,0)),u=an(c-m*y),o=1/(1-b),l=C*o/(w+C-1),a=0,p=bn(C),C===p&&(p-=1),h=1;h<=p&&!(l<=1&&u/g<=a);h++)f=h,u=(C-f+1)*o*u/(w+C-f),u>1&&(m-=1,u*=v),0===m&&(a+=u);r+=a}b===e&&w===t||(r=1-r),r=Qt($t(r,1),0)}return r}function h(e){e=.7071067811865475*-e;var t=wn(e);if(Xt(t))return pn;var n=kn(t*ln(2));return En(n)?NaN:.5*(2-2*parseFloat(n))}function m(e,t,n,r){function o(e,t){return e<0&&t>0||e>0&&t<0}var i,a,s=1e-307,l=2.22045e-16,u=e._getValue(t),c=e._getValue(n);for(a=0;a<1e3&&!o(u,c);a++)sn(u)<=sn(c)?(i=t,t+=2*(t-n),t<0&&(t=0),n=i,c=u,u=e._getValue(t)):(i=n,n+=2*(n-t),t=i,u=c,c=e._getValue(n));if(0===u)return t;if(0===c)return n;if(!o(u,c))return r._bConvError=!0,0;var f=t,d=u,p=n,h=c,m=t,g=u,_=.5*(t+n),v=!0;for(a=0;a<500&&sn(g)>s&&n-t>Qt(sn(t),sn(n))*l;)v&&(d!==h&&h!==g&&g!==d?(_=f*g*h/(g-d)/(h-d)+m*h*d/(h-g)/(d-g)+p*d*g/(d-h)/(g-h),v=t<_&&_<n):v=!1),v||(_=.5*(t+n),f=t,d=u,p=n,h=c,v=!0),f=p,p=m,m=_,d=h,h=g,g=e._getValue(_),o(u,g)?(n=m,c=g):(t=m,u=g),v=v&&2*sn(g)<=sn(h),++a;return m}function g(e,t){var n,r=zt(t);for(n=0;n<r;n++){var o=wn(t[n]),i=o-e.M,a=i/(e.N+1);e.M+=a,e.Q+=e.N*i*a,e.N++,e._sum+=o}}function _(e){var t,n=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],r=1.000000000190015,o=e,i=e+5.5;for(i-=(e+.5)*un(i),t=0;t<=5;t++)r+=n[t]/++o;return-i+un(2.5066282746310007*r/e)}function v(e,t,n){var r=0===n||1===n?0:an(_(e+t)-_(e)-_(t)+e*un(n)+t*un(1-n)),o=n>=(e+1)/(e+t+2);o&&(e=[t,t=e][0],n=1-n);var i=4.450147717014403e-308,a=100,s=e+t,l=e+1,u=e-1,c=1,f=1-s*n/l;sn(f)<i&&(f=i),f=1/f;for(var d=f,p=1,h=2;p<=a;p++,h+=2){var m=p*(t-p)*n/((u+h)*(e+h));f=1+m*f,sn(f)<i&&(f=i),c=1+m/c,sn(c)<i&&(c=i),f=1/f,d*=f*c,m=-(e+p)*(s+p)*n/((e+h)*(l+h)),f=1+m*f,sn(f)<i&&(f=i),c=1+m/c,sn(c)<i&&(c=i),f=1/f;var g=f*c;if(d*=g,sn(wn(g-1))<5e-324){var v=r*d/e;return o?1-v:v}}return mn}function y(e,t){for(var n,r,o,i=zt(t),a=0;a<i;a++)(n=t[a])!==Pn&&(r=n-e.M,o=r/(e.N+1),e.M+=o,e.Q+=e.N*r*o,e.N++,e._sum+=n)}function b(e){e.sort(function(e,t){return e-t})}function w(e,t){for(var n=0;n<zt(e);n++){var r=e[n];r!==Pn&&t.push(r)}b(t)}function C(e){var t,n=[];for(t=0;t<zt(e);t++)w(e[t],n);return n}function S(e,t,n){var r=Math.expm1||function(e){return an(e)-1},o=Math.log1p||function(e){return un(1+e)};if(e<=0)return 0;if(e>=1)return 1;if(1===n)return Zt(e,t);if(1===t)return-r(n*o(-e));var i,a=.5-e+.5,s=o(-e),l=e,u=un(e),c=t,f=n,d=e>t/(t+n);d&&(c=n,f=t,l=a,a=e,u=s,s=un(e)),i=x(l,c,f),i/=c;var p,h=c/(c+f),m=f/(c+f);return p=c>1&&f>1&&h<.97&&m<.97?T(l,c,f)*l*a:an(c*u+f*s-E(!1,c,f)),i*=p,d&&(i=.5-i+.5),i>1&&(i=1),i<0&&(i=0),i}function x(e,t,n){var r,o,i,a,s,l,u,c,f,d,p=2.22045e-16;r=1,o=1,a=1-(t+n)/(t+1)*e,0===a?(i=0,s=1,d=1):(i=1,s=1/a,d=i*s),f=1;var h=1,m=5e4,g=!1;do{l=t+2*h,u=h*(n-h)*e/((l-1)*l),c=-(t+h)*(t+n+h)*e/(l*(l+1)),r=(i+u*r)*s,o=(a+u*o)*s,i=r+c*i*s,a=o+c*a*s,0!==a&&(s=1/a,f=i*s,g=sn(d-f)<sn(d)*p),d=f,h+=1}while(h<m&&!g);return d}function T(e,t,n){if(1===t)return 1===n?1:2===n?-2*e+2:e<=.01?n+n*an((n-1)*un(1-e))-1:n*Zt(.5-e+.5,n-1);if(1===n)return 2===t?t*e:t*Zt(e,t-1);if(e<=0&&!(t<1&&0===e)||e>=1&&!(n<1&&1===e))return 0;var r=un(i(2)),o=un(i(1)),a=un(e<.1?1-e:1-e),s=un(e),l=(t-1)*s,u=(n-1)*a,c=E(!1,t,n);return l<r&&l>o&&u<r&&u>o&&c<r&&c>o&&l+u<r&&l+u>o?Zt(e,t-1)*Zt(.5-e+.5,n-1)/E(!0,t,n):an(l+u-c)}function E(e,t,n){var r=n,o=t;if(t>n&&(r=[o,o=r][0]),e&&r+o<171.624376956302)return A(r)/A(r+o)*A(o);var i=6.02468004077673,a=i-.5,s=R(r);s/=R(r+o),s*=R(o);var l=r+o+a,u=e?s*ln(l/(r+a)/(o+a)):un(s)+.5*(un(l)-un(r+a)-un(o+a)),c=o/(r+a),f=r/(o+a),d=-r*un(1+c)-o*un(1+f)-a;return e?an(d)*u:d+u}function M(e){var t=R(e),n=6.02468004077673,r=e+n-.5,o=Zt(r,e/2-.25);return t*=o,t/=an(r),t*=o,e<=20&&e===Cn._approxFloor(e)&&(t=cn(t)),t}function A(e){var t=un(rn),n=un(i(2));if(e>171.624376956302)return mn;if(e>=1)return M(e);if(e>=.5)return M(e+1)/e;if(e>=-.5){return M(e+2)-un(e+1)-un(sn(e))>=n?mn:M(e+2)/(e+1)/e}var r=M(1-e)+un(sn(tn(rn*e)));return r-t>=n?0:r<0&&t-r>n?mn:an(t-r)*(tn(rn*e)<0?-1:1)}function k(e){return e>=171.624376956302?M(e):e>=1?un(M(e)):e>=.5?un(M(e+1)/e):M(e+2)-un(e+1)-un(e)}function R(e){var t,n,r,o=[23531376880.41076,42919803642.6491,35711959237.35567,17921034426.03721,6039542586.352028,1439720407.3117216,248874557.86205417,31426415.585400194,2876370.6289353725,186056.26539522348,8071.672002365816,210.82427775157936,2.5066282746310002],i=[0,39916800,120543840,150917976,105258076,45995730,13339535,2637558,357423,32670,1925,66,1];if(e<=1)for(t=o[12],n=i[12],r=11;r>=0;--r)t*=e,t+=o[r],n*=e,n+=i[r];else{var a=1/e;for(t=o[0],n=i[0],r=1;r<=12;++r)t*=a,t+=o[r],n*=a,n+=i[r]}return t/n}function I(e,t){return e<=0?0:O(t/2,e/2)}function O(e,t){var n=e*un(t)-t-k(e),r=an(n);return t>e+1?1-r*P(e,t):r*D(e,t)}function D(e,t){var n=.5*i(3),r=e,o=1/e,a=o,s=1;do{r+=1,o=o*t/r,a+=o,s+=1}while(o/a>n&&s<=1e4);return s>1e4?pn:a}function P(e,t){var n=i(3),r=.5*n,o=1/n,a=0,s=0,l=1-e,u=t+2-e,c=0,f=t+1,d=1,p=1,h=u*t,m=t,g=f/h,_=!1,v=0;do{a+=1,l+=1,s=l*a,u+=2,c=f*u-d*s,p=h*u-m*s,0!==p&&(v=c/p,_=sn((g-v)/v)<=r,g=v),d=f,f=c,m=h,h=p,sn(c)>o&&(d*=n,f*=n,m*=n,h*=n)}while(!_&&a<1e4);return _?g:pn}function N(e,t){var n,r;if(e<=0)return 0;if(t*e>1391e3)n=an((.5*t-1)*un(.5*e)-.5*e-un(2)-k(.5*t));else{for(t%2<.5?(n=.5,r=2):(n=1/ln(2*e*rn),r=1);r<t;)n*=e/r,r+=2;n=e>=1425?an(un(n)-e/2):n*an(-e/2)}return n}function F(e,t,n,r){var o=Sn(n,e);if(En(o))return o;var i=wn(o);if(o=Sn(r-n,t-e),En(o))return o;var a=wn(o);if(o=Sn(r,t),En(o))return o;var s=wn(o);return vn(i*a/s)}function L(e,t,n){var r=S(t/(t+e*e),t/2,.5);switch(n){case 1:return.5*r;case 2:return r;case 3:return Zt(1+e*e/t,-(t+1)/2)/(ln(t)*E(!0,.5,t/2));case 4:var o=t/(e*e+t),i=.5*S(o,.5*t,.5);return e<0?i:1-i}return pn}function H(e,t,n){var r={_bConvError:!1},o=function(e,t,n){return{_getValue:function(r){return e-L(r,t,n)}}}(e,t,n),i=m(o,.5*t,t,r);return r._bConvError?hn:i}function V(e,t){var n,r,o,i,a,s=!1,l=0;for(r=0;r<zt(t);r++)for(a=t[r],o=0;o<zt(a);o++)if(i=a[o],Tn(i)||Rn(i)||In(i))n=In(i)?0:wn(i),(!s||e&&n>l||!e&&n<l)&&(l=n),s=!0;else if(En(i))return i;return l}function j(e,t,n){var r=[];w(t,r);var o=zt(r);return n<=0||o<n?mn:e?r[o-n]:r[n-1]}function B(e,t,n,r){var o,i,a=0,s=0,l=0;for(o=0;o<zt(t);o++)(i=t[o])!==Pn&&(i<n?a++:n<i?l++:s++);if(0===s)return hn;var u=(0===r?l:a)+1;return e?u:u+(s-1)/2}function U(e,t,n){function r(e,t){var n,r,o,i,a;for(i=0;i<zt(e);i++)for(n=e[i],a=0;a<zt(n);a++)if((o=n[a])===Gt)t.n++;else if(In(o)){var s={value:0};if(_n._tryToDouble(o,s))r=s.value,t._sumx+=r,t._sumx2+=r*r;else if(!n.isArray&&!n.isReference)return pn;t.n++}else{if(En(o))return o;Tn(o)&&(r=wn(o),t._sumx+=r,t._sumx2+=r*r,t.n++)}}var o={_sumx:0,_sumx2:0,n:0},i=r(e,o);if(En(i))return i;if(o.n<=t)return dn;var a=Qt(0,(o.n*o._sumx2-o._sumx*o._sumx)/(o.n*(o.n-t)));return a=n?ln(a):a,vn(a)}function W(e,t,n){var r,o,i,a=0,s=0,l=0,u=0,c=zt(t);if(c!==zt(n))return hn;for(i=0;i<c;i++)r=t[i],o=n[i],r!==Pn&&o!==Pn&&(a+=r,s+=o,u++);if(u<=1)return dn;var f=a/u,d=s/u;for(i=0;i<c;i++)r=t[i],o=n[i],r!==Pn&&o!==Pn&&(l+=(r-f)*(o-d));return vn(e?l/u:l/(u-1))}function z(e,t){var n,r,o,i,a=e?1:0,s=0;for(o=0;o<zt(t);o++)for(n=t[o],i=0;i<zt(n);i++)if((r=n[i])!==Pn){if(r<=0)return mn;a=e?a*r:a+1/r,s++}return e?s<=0?dn:vn(Zt(a,1/s)):0===a?dn:vn(s/a)}function Y(e,t,n,r,o){var i,a,s,l=t.rowCount,u=t.colCount;e?n=n!==Kt?yn(n,1,!1,!0,!0):t:(i=n!==Kt?n:function(e,t){var n=[];for(a=0;a<e;a++)for(n[a]=[],s=0;s<t;s++)n[a][s]=a*t+s+1;return new gn(n)}(l,u),n=yn(i,1,!1,!0,!0));var c,f,d,p,h,m,g,_,v,y,b,w,C=n.rowCount,S=n.colCount;if(l===C&&u===S&&(r||!o)){d=e?C*S:wn(C*S);var x,T=0,E=0,M=0,A=0,k=0;for(a=0;a<C;a++)for(s=0;s<S;s++)p=n[a][s],h=t[a][s],e&&(h=un(h)),T+=p,E+=p*p,M+=h,A+=h*h,k+=p*h;if(y=d*E-T*T,f=r?(d*k-T*M)/y:k/E,x=r?(M*E-T*k)/y:0,e&&(f=an(f),x=an(x)),_=[[f,x]],o){_[1]=[],_[2]=[],_[3]=[],_[4]=[];var R=d*E-T*T,I=d*A-M*M,O=d*k-T*M,D=A-x*M-f*k,P=O*O/(R*I);d<3?(_[1][0]=mn,_[1][1]=mn,_[2][1]=mn,_[3][0]=mn):(_[1][0]=ln(D*d/(R*(d-2))),_[1][1]=ln(D*E/(R*(d-2))),_[2][1]=ln((I-O*O/R)/(d*(d-2))),_[3][0]=1===P?mn:P*(d-2)/(1-P)),_[2][0]=P,_[3][1]=d-2,_[4][0]=I/d-D,_[4][1]=D}return new gn(_)}if(1===u&&l===C||1===l&&u===S){for(h=[],p=[],y=1===u,f=y?S:C,d=y?C:S,d=C,f=S,a=0;a<d;a++)h[a]=r?t[a][0]:t[0][a],e&&(h[a]=un(h[a]));for(a=0;a<d;a++)for(p[a]=[],s=0;s<f;s++)p[a][s]=y?n[a][s]:n[s][a];var N=[];for(c=0;c<f+1;c++)N[c]=[];for(m=0;m<f+1;m++)for(g=0;g<f+2;g++)N[m][g]=0;var F=[];for(m=0;m<f+2;m++)F[m]=0;var L=o?[]:Gt;for(c=0;c<d;c++)for(F[f+1]+=h[c]*h[c],N[0][f+1]+=h[c],F[0]=N[0][f+1],a=0;a<f;a++)for(N[0][a+1]+=p[c][a],N[a+1][0]=N[0][a+1],N[a+1][f+1]+=p[c][a]*h[c],F[a+1]=N[a+1][f+1],s=a;s<f;s++)N[s+1][a+1]+=p[c][a]*p[c][s],N[a+1][s+1]=N[s+1][a+1];if(N[0][0]=d,o){for(m=0;m<f+1;m++)for(L[m]=[],g=0;g<f+1;g++)L[m][g]=0;for(a=0;a<f+1;a++)L[a][a]=1}var H=r?0:1;for(a=0;a<f+1;a++){if(0===N[a][a]){for(v=!1,s=a+1;!v&&s<f+1;s++)if(0!==N[s][a]){for(c=0;c<f+2;c++)y=N[a][c],N[a][c]=N[s][c],N[s][c]=y;if(o)for(c=0;c<f+1;c++)y=L[a][c],L[a][c]=L[s][c],L[s][c]=y;v=!0}if(!v)return mn}for(b=1/N[a][a],c=H;c<f+2;c++)N[a][c]*=b;if(o)for(c=H;c<f+1;c++)L[a][c]*=b;for(s=H;s<f+1;s++)if(s!==a){for(b=-N[s][a],c=H;c<f+2;c++)N[s][c]+=b*N[a][c];if(o)for(c=H;c<f+1;c++)L[s][c]+=b*L[a][c]}!r&&(N[0][f+1]=0)}for(_=e?[[],f+1]:[[]],a=0;a<f+1;a++)_[0][a]=e?an(N[f-a][f+1]):N[f-a][f+1];if(o){if(e)_[1]=[],_[2]=[],_[3]=[],_[4]=[];else for(m=1;m<5;m++)for(_[m]=[],g=0;g<f+1;g++)_[m][g]=0;var V,j,B;for(j=F[f+1]-F[0]*F[0]/d,V=F[f+1],a=0;a<f+1;a++)V-=N[a][f+1]*F[a];if(B=j-V,_[2][0]=0===j?mn:B/j,_[4][0]=B,_[4][1]=V,0===(y=r?d-f-1:d-f)){for(a=0;a<f+1;a++)_[1][a]=mn;_[2][1]=mn}else{for(w=V/wn(y),!r&&(_[1][f]=hn),a=H;a<f+1;a++)_[1][f-a]=ln(w*L[a][a]);_[2][1]=ln(w)}for(_[3][0]=0===V?mn:wn(y)*B/(V*wn(f)),_[3][1]=wn(y),a=2;a<5;a++)for(s=2;s<f+1;s++)_[a][s]=hn}return!e&&(_=[_[0]]),new gn(_)}return mn}function G(e,t){var n,r,o,i,a,s=0,l=0,u=0,c=[];for(o=0;o<zt(t);o++)for(a=t[o],c.push(a),i=0;i<zt(a);i++)(n=a[i])!==Pn&&(s+=n,u++);for(r=s/u,o=0;o<zt(t);o++)for(a=c[o],i=0;i<zt(a);i++)(n=a[i])!==Pn&&(l+=e?(n-r)*(n-r):sn(n-r));return e?vn(l):0===u?dn:vn(l/u)}function K(e,t,n,r){t=t!==Kt?yn(t,0,!1,!0,!1):e,n=n!==Kt?yn(n,0,!1,!0,!1):t;var o,i;for(o=0;o<e.rowCount;o++)for(i=0;i<e.colCount;i++)if(!Tn(e[o][i]))return pn;for(o=0;o<t.rowCount;o++)for(i=0;i<t.colCount;i++)if(!Tn(t[o][i]))return pn;for(o=0;o<n.rowCount;o++)for(i=0;i<n.colCount;i++)if(!Tn(n[o][i]))return pn;return Bt._trend(e,t,n,r,wn,gn,pn,hn)}function X(e,t,n,r){return t=t!==Kt?yn(t,1,!1,!0,!0):e,n=n!==Kt?yn(n,1,!1,!0,!0):t,Bt._growth(e,t,n,r,gn,mn,hn)}function q(e,t,n){var r,o=0,i=0,a=0,s=0,l=zt(t),u=0;if(l!==zt(n))return hn;for(r=0;r<l;r++){var c=t[r],f=n[r];c!==Pn&&f!==Pn&&(o+=c,i+=f,a+=f*f,s+=f*c,u++)}if(0===u)return dn;if(u*a-i*i==0)return dn;var d=(u*s-i*o)/(u*a-i*i);return vn(o/u-d*(i/u)+d*e)}function J(){return Mn(arguments,!0,1)}function Z(){return An(arguments,!0,7)}function Q(e,t){if(e=yn(e,1,!0,!0,!1,!0),t=wn(t),e.isError)return e[0];if(e.isConvertError||Xt(t))return pn;var n=[];if(w(e,n),!zt(n)||t<0||t>1)return mn;var r=t*(zt(n)-1),o=r%1;return r=Jt(r.toString()),0===o?n[r]:wn(n[r])+o*(wn(n[r+1])-wn(n[r]))}function $(){return Mn(arguments,!0,4)}function ee(){return V(!0,arguments)}function te(){return Mn(arguments,!0,5)}function ne(){return V(!1,arguments)}function re(e,t){return j(!0,e,t)}function oe(e,t){return j(!1,e,t)}function ie(){var e,t,n,r,o=arguments,i=0,a=0;for(e=0;e<zt(o);e++)for(r=o[e],t=0;t<zt(r);t++)n=r[t],Tn(n)||Rn(n)?(i+=wn(n),a++):(n===Gt||In(n))&&a++;return 0===a?dn:vn(i/a)}function ae(e,t,n){function r(e,t,n){var r=0,o=0,i=xn(t);if(e.rowCount!==n.rowCount||e.colCount!==n.colCount)return pn;for(var a=0;a<zt(e);a++){var s=e[a];if(i&&i(s)){var l=n[a];l!==Pn&&(r+=l,o++)}}return 0===o?dn:vn(r/o)}function o(e,t,n,o){var i,a,s=e?t.rowCount:t.getRowCount(0),l=e?t.colCount:t.getColumnCount(0),u=[];for(i=0;i<s;i++)for(u[i]=[],a=0;a<l;a++){var c=e?t.getValue(i,a):t.getValue(0,i,a);u[i][a]=r(n,c,o)}return new gn(u)}if(n!==Kt){if(e=yn(e,0,!0,!1,!1),n=yn(n,1,!0,!0,!1),n.isError)return n[0]}else{if(e=yn(e,1,!0,!0,!1),e.isError)return e[0];n=e}return _n._isReference(t)?o(!1,t,e,n):_n._isArray(t)?o(!0,t,e,n):r(e,t,n)}function se(e){var t,n,r,o,i=arguments,a=0,s=0,l=e.length,u=i.length,c=[];for(c.push(e),r=1;r<u;r+=2){if(o=yn(i[r],0,!0,!1,!1),o.isError)return o[0];c.push(o);var f=i[r+1],d=xn(f);c.push(d)}for(n=0;n<l;n++)if((t=e[n])!==Pn){var p=!0;for(r=1;r<u&&(d=c[r+1],p=d(c[r][n]));r+=2);p&&(a+=t,s++)}return 0===s?dn:vn(a/s)}function le(){var e=C(arguments),t=zt(e);return 0===t?mn:t%2==0?(wn(e[t/2-1])+wn(e[t/2]))/2:e[Jt((t/2).toString())]}function ue(){var e,t,n,r=Gt,o=0,i=C(arguments),a=zt(i);for(e=0;e<a;e++){for(n=0,t=0;t<a;t++)t!==e&&i[t]===i[e]&&n++;n>o&&(o=n,r=i[e])}return 0===o?hn:r}function ce(){return z(!0,arguments)}function fe(){return z(!1,arguments)}function de(e,t){var n=0,r=[];w(e,r);for(var o=zt(r),i=Jt((o*t/2).toString()),a=i;a<o-i;a++)n+=wn(r[a]);return n/(o-2*i)}function pe(e,t){var n,r,o,i=0,a=t.rowCount,s=t.colCount;for(n=0;n<a;n++)for(r=0;r<s;r++)t[n][r]!==Pn&&i++;var l=e.rowCount,u=e.colCount,c=[],f=[],d=i+1;for(i=0,n=0;n<a;n++)for(r=0;r<s;r++)(o=t[n][r])!==Pn&&(c[i++]=wn(o));var p=c.slice(0);for(b(c),n=0;n<d;n++)f[n]=[0];for(n=0;n<l;n++)for(r=0;r<u;r++)if(o=e[n][r],Tn(o)){for(var h=wn(o),m=!1,g=0;!m&&g<i;g++)h<=c[g]&&(f[p.indexOf(c[g])][0]++,m=!0);m||f[i][0]++}return new gn(f)}function he(e,t,n){var r=Ut.CalcArrayHelper;if(_n._isReference(e)){if(1!==r.getLength(e))return pn;e=r.getValueByIndex(e,0)}return Xt(e=wn(e))?pn:B(!0,t,e,n)}function me(){var e,t,n,r,o,i,a,s=arguments,l=0,u=0,c=0,f=0,d=zt(s),p=[];for(r=0;r<d;r++){for(a=s[r],p.push(a),o=0;o<zt(a);o++)(e=a[o])!==Pn&&(l+=e,u+=e*e,f++);if(f<=3)return dn;if(t=l/f,0===(n=ln((f*u-l*l)/(f*(f-1)))))return dn;for(i=0;i<d;i++)for(a=p[i],o=0;o<zt(a);o++)(e=a[o])!==Pn&&(c+=Zt((e-t)/n,4));return vn(f*(f+1)*c/((f-1)*(f-2)*(f-3))-3*(f-1)*(f-1)/((f-2)*(f-3)))}}function ge(e,t,n){return r(e,t,n,!0)}function _e(e,t,n){return r(e,t,n,!1)}function ve(e,t){var n=Yt(t,[0,1,2,3,4]);return n<0?mn:Q(e,.25*n)}function ye(){return Mn(arguments,!0,2)}function be(){return Mn(arguments,!0,3)}function we(e){for(var t=0,n=0;n<zt(e);n++)e[n]===Gt&&t++;return t}function Ce(e,t){function n(e,t){for(var n=0,r=0===t||"*"===t,o=xn(t),i=0;i<zt(e);i++){var a=e[i];r&&a===Gt||!o||!o(a)||n++}return vn(n)}var r,o,i,a=0;if(t.isArray||t.isReference){for(i=0;i<zt(t);i++){if(o=n(e,t[i]),En(o))return o;if(Xt(r=wn(o)))return pn;a+=r}return a}return n(e,t[0])}function Se(e){var t,n,r,o,i=arguments,a=0,s=zt(e),l=zt(i),u=[];for(r=0;r<l;r+=2){if(t=0===r?e:yn(i[r],0,!0,!1,!1),t.isError)return t[0];s=t.length,u.push(t),o=xn(i[r+1]),u.push(o)}for(n=0;n<s;n++){var c=!0;for(r=0;r<l&&(o=u[r+1],c=o&&o(u[r][n]));r+=2);c&&a++}return vn(a)}function xe(){return G(!1,arguments)}function Te(){return U(arguments,1,!0)}function Ee(){return An(arguments,!0,8)}function Me(){return U(arguments,0,!0)}function Ae(){return An(arguments,!0,10)}function ke(){return U(arguments,1,!1)}function Re(){return An(arguments,!0,11)}function Ie(){return U(arguments,0,!1)}function Oe(e,t){return W(!0,e,t)}function De(){return G(!0,arguments)}function Pe(e,t,n){var r=vt(e/2);return En(r)?r:-wn(r)*(t/ln(n))}function Ne(e,t,n){return 1===n?dn:t*H(e,n-1,2)/ln(n)}function Fe(e,t){var n,r,o,i,a=0,s=0,l=0,u=0,c=0,f=zt(e);if(f!==zt(t))return hn;for(i=0;i<f;i++)n=e[i],(r=t[i])!==Pn&&n!==Pn&&(a+=n,s+=r,l+=r*r,u+=r*n,c++);return 0===c?dn:c*l-s*s==0?dn:(o=(c*u-s*a)/(c*l-s*s),vn(a/c-o*(s/c)))}function Le(e,t,n,r){return Y(!1,e,t,n,r)}function He(e,t){var n=0,r=0,o=0,i=0,a=0,s=zt(t);if(s!==zt(e))return hn;for(var l=0;l<s;l++){var u=e[l],c=t[l];if(c!==Pn&&u!==Pn&&!En(c)&&!En(u)){var f=wn(u),d=wn(c);n+=f,r+=d,o+=d*d,i+=d*f,a++}}return a*o-r*r==0?dn:vn((a*i-r*n)/(a*o-r*r))}function Ve(e,t,n,r){return Y(!0,e,t,n,r)}function je(e,t){var n,r,o=0,i=0,a=0,s=0,l=0,u=0,c=zt(e);if(c!==zt(t))return hn;for(var f=0;f<c;f++){var d=e[f],p=t[f];d!==Pn&&p!==Pn&&(r=d,n=p,o+=r,i+=r*r,a+=n,s+=n*n,l+=n*r,u++)}return u*(u-2)==0||u*s-a*a==0?dn:ln((u*i-o*o-(u*l-a*o)*(u*l-a*o)/(u*s-a*a))/(u*(u-2)))}function Be(e,t,n,r,i){function a(e){var t,n=e,r=n+5.5;return r-=(n+.5)*un(r),t=1.000000000190015+76.18009172947146/(e+1),t-=86.50532032941678/(e+2),t+=24.01409824083091/(e+3),t-=1.231739572450155/(e+4),t+=.001208650973866179/(e+5),t-=5395239384953e-18/(e+6),un(2.506628274631001*t/n)-r}if(e<r||i<e||r===i)return mn;var s=(e-r)/(i-r),l=a(t+n),u=a(t),c=a(n),f=un(s),d=un(1-s),p=an(l-u-c+t*f+n*d),h=p*o(n,t,1-s)/n;return vn(s<(t+1)/(t+n+2)?h:1-h)}function Ue(e,t,n,r,o,i){if(e<o||i<e||o===i)return mn;var a=(e-o)/(i-o);return r?S(a,t,n):T(a,t,n)/(i-o)}function We(e,t,n,r,o){var i,a,s,l,u,c,f,h,m,g,_,v,y,b,w,C,S,x,T,E=2.30753,M=.27061,A=.99229,k=.04481,R=3e-308,I=1e-300,O=R,D=1-2.22e-16,P=5,N=6,F=2,L=e;for(c=d(t,n),e<=.5?(l=e,m=t,_=n,i=0):(l=1-e,m=n,_=t,i=1),v=ln(-un(l*l)),S=v-(E+M*v)/(1+(A+k*v)*v),m>1&&_>1?(v=(S*S-3)/6,y=1/(m+m-1),b=1/(_+_-1),h=2/(y+b),C=S*ln(h+v)/h-(b-y)*(v+P/N-F/(3*h)),L=m/(m+_*an(C+C))):(v=_+_,b=1/(9*_),b=v*Zt(1-b+S*ln(b),3),b<=0?L=1-an((un((1-l)*_)+c)/_):(b=(4*m+v-F)/b,L=b<=1?an((un(l*m)+c)/m):1-F/(b+1))),v=1-m,b=1-_,x=0,u=1,L<O?L=O:L>D&&(L=D),T=Qt(I,Zt(10,-13-2.5/(m*m)-.5/(l*l))),w=g=0,a=0;a<1e3;a++){for(S=p(L,m,_),S=(S-l)*an(c+v*un(L)+b*un(1-L)),S*x<=0&&(g=Qt(sn(u),R)),f=1,s=0;s<1e3;s++){if(u=f*S,sn(u)<g&&(w=L-u)>=0&&w<=1){if(g<=T)return 0!==i&&(L=1-L),vn((o-r)*L+r);if(sn(S)<=T)return 0!==i&&(L=1-L),vn((o-r)*L+r);if(0!==w&&1!==w)break}f/=3}if(w===L)return 0!==i&&(L=1-L),vn((o-r)*L+r);L=w,x=S}return 0!==i&&(L=1-L),vn((o-r)*L+r)}function ze(e,t,n,r){if(t<e)return mn;var o,i,a;if(!r){if(o=1-n,0===(i=Zt(o,t))){if(0===(i=Zt(n,t)))return mn;for(a=0;a<t-e&&i>0;a++)i*=wn(t-a)/wn((a+1)*o/n);return i}for(a=0;a<e&&i>0;a++)i*=wn(t-a)/wn((a+1)*n/o);return i}if(t===e)return 1;o=1-n,i=Zt(o,t);var s;if(0===i){if(0===(i=Zt(n,t)))return mn;for(s=1-i,a=0;a<t-e&&i>0;a++)i*=wn(t-a)/wn((a+1)*o/n),s-=i;return s<0?0:s}for(s=i,a=0;a<e&&i>0;a++)i*=wn(t-a)/wn((a+1)*n/o),s+=i;return s}function Ye(e,t,n){if(e+t-1<=0)return mn;var r=Sn(e+t-1,t-1);return En(r)?r:vn(wn(r)*Zt(n,t)*Zt(1-n,e))}function Ge(e,t,n,r){if(e+t-1<=0)return mn;if(r)return 1-S(1-n,e+1,t);var o,i=Zt(n,t);for(o=0;o<e;o++)i*=(o+t)/(o+1)*(1-n);return i}function Ke(e,t,n){var r,o,i=1-t,a=Zt(i,e);if(0===a){if(0===(a=Zt(t,e)))return mn;for(r=1-a,o=0;o<e&&r>=n;o++)a*=wn(e-o)/wn((o+1)*i/t),r-=a;return wn(e-o)}for(r=a,o=0;o<e&&r<n;o++)a*=wn(e-o)/wn((o+1)*t/i),r+=a;return wn(o)}function Xe(e,t){var n,r,o,i,a=un(ln(rn)),s=1/ln(rn),l=0,u=e,c=.5*u,f=t%2==0;t>1&&(l=an(-c));var d=kn(-ln(u));if(En(d))return d;var p=wn(d);if(r=f?l:2*p,t>2){if(u=.5*(t-1),o=f?1:.5,c>20){for(n=f?0:a,i=un(c);o<=u;)n=un(o)+n,r+=an(i*o-c-n),o+=1;return r}for(n=f?1:s/ln(c),i=0;o<=u;)n*=c/o,i+=n,o+=1;return i*l+r}return r}function qe(e,t,n){return n?I(e,t):N(e,t)}function Je(e,t){var n=ut(1-e,.5*t,2);return wn(n)}function Ze(e,t){var n=function(e,t){return{_getValue:function(n){return e-I(n,t)}}}(e,t),r={bConvError:!1},o=m(n,.5*t,t,r);return r._bConvError?hn:o}function Qe(e,t){var n,r=0,o=e.rowCount,i=e.colCount;if(o!==t.rowCount||i!==t.colCount)return hn;if(o>1&&i>1)n=(o-1)*(i-1);else if(o>1&&1===i)n=o-1;else{if(!(1===o&&i>1))return hn;n=i-1}for(var a=0;a<zt(e);a++){var s=e[a],l=t[a];if(s!==Pn&&l!==Pn){if(0===l)return dn;r+=(s-l)*(s-l)/l}}return Xe(r,n)}function $e(e,t){var n,r,o,i,a=0,s=0,l=0,u=0,c=0,f=zt(t);if(f!==zt(e))return hn;var d,p,h,m=0;for(d=0;d<f;d++)p=e[d],h=t[d],p!==Pn&&h!==Pn&&(a+=p,s+=h,l+=p*p,u+=h*h,m++);if(m<=1)return dn;if(n=a/m,r=s/m,o=ln((m*l-a*a)/(m*(m-1))),i=ln((m*u-s*s)/(m*(m-1))),0===o||0===i)return dn;for(d=0;d<f;d++)p=e[d],h=t[d],p!==Pn&&h!==Pn&&(c+=(p-n)*(h-r));return vn(c/wn((m-1)*o*i))}function et(e,t,n){var r=an(-t*e);return vn(n?1-r:t*r)}function tt(e,t,n){var r=t*e/(t*e+n),o=.5*t,i=.5*n,a=Be(r,o,i,0,1);return En(a)?a:1-wn(a)}function nt(e,t,n,r){if(r){return 1-S(n/(n+t*e),n/2,t/2)}return Zt(t/n,t/2)*Zt(e,t/2-1)/(Zt(1+e*t/n,(t+n)/2)*E(!0,t/2,n/2))}function rt(e,t,n){var r=1-e,o=We(1-r,n/2,t/2,0,1);return En(o)?o:(1/wn(o)-1)*(n/t)}function ot(e,t,n){var r=1-e,o=We(r,n/2,t/2,0,1);return En(o)?o:(1/wn(o)-1)*(n/t)}function it(e){return un((1+e)/(1-e))/2}function at(e){var t=an(2*e)-1,n=an(2*e)+1;return!qt(t)&&t>0&&!qt(n)&&n>0?1:t/n}function st(e,t){var n,r,o,i,a,s={N:0,M:0,Q:0,_sum:0};if(y(s,e),i=s.N-1,1===s.N)return dn;if(0===(n=s.Q/(s.N-1)))return dn;if(s.N=0,s.M=0,s.Q=0,s._sum=0,y(s,t),a=s.N-1,1===s.N)return dn;if(0===(r=s.Q/(s.N-1)))return dn;var l=tt(n/r,i,a);return En(l)?l:(o=2*(1-wn(l)),o>1&&(o=2-o),o)}function lt(e,t,n,r){if(!1===r){var o=Zt(n,t);if(Xt(o)||!qt(o))return dn;return 1/(o*c(t))*(Zt(e,t-1)*an(-e/n))}var i,a,s,l,u,f,d,p,h,m,g,_,v,y,b=1/3,w=1e8,C=1e37,S=1e3,x=-88;if((e/=n)<=0)return mn;if(t>S)return i=3*ln(t)*(Zt(e/t,b)+1/(9*t)-1),y=gt(i,0,1,!0),En(y)?y:wn(y);if(e>w)return 1;if(e<=1||e<t){if(y=ct(t+1),En(y))return y;d=t*un(e)-e-wn(y),p=1,v=1,m=t;do{m+=1,p=p*e/m,v+=p}while(p>2.220446049250313e-16);d+=un(v),v=0,d>=x&&(v=an(d))}else{if(y=ct(t),En(y))return y;for(d=t*un(e)-e-wn(y),m=1-t,g=m+e+1,p=0,i=1,a=e,s=e+1,l=e*g,v=s/l;;){if(m+=1,g+=2,p+=1,_=m*p,u=g*s-_*i,f=g*l-_*a,sn(f)>0){if(h=u/f,sn(v-h)<=$t(2.220446049250313e-16,2.220446049250313e-16*h))break;v=h}i=s,a=l,s=u,l=f,sn(u)>=C&&(i/=C,a/=C,s/=C,l/=C)}d+=un(v),v=1,d>=x&&(v=1-an(d))}return v}function ut(e,t,n){var r,o,i,a,s,l,u,c,f,d,p,h,m,g,_,v,y,b,w=4.67,C=6.66,S=6.73,x=13.32,T=60,E=70,M=84,A=105,k=120,R=127,I=140,O=1175,D=210,P=252,N=2264,F=294,L=346,H=420,V=462,j=606,B=672,U=707,W=735,z=889,Y=932,G=966,K=1141,X=1182,q=1278,J=1740,Z=2520,Q=5040,$=5e-7,ee=.01,te=5e-7,ne=20,re=2e-6,oe=.999998;if(e<re)return 0;if(e>oe)return Dn;u=2*t,i=t-1;var ie=ct(t);if(En(ie))return ie;if(s=wn(ie),u<-1.24*un(e)){if((a=Zt(e*t*an(s+.6931471805599453*t),1/t))<$)return NaN}else if(u>.32){if(ie=_t(e,0,1),En(ie))return ie;y=wn(ie),l=.222222/u,a=u*Zt(y*ln(l)+1-l,3),a>2.2*u+6&&(a=-2*(un(1-e)-i*un(.5*a)+s))}else{a=.4,r=un(1-e)+s+.6931471805599453*i;do{f=a,l=1+a*(w+a),c=a*(S+a*(C+a)),v=(w+2*a)/l-.5-(S+a*(x+3*a))/c,a-=(1-an(r+.5*a)*c/l)/v}while(sn(f/a-1)>ee)}for(b=1;b<=ne;b++){if(f=a,l=.5*a,ie=lt(l,t,1,!0),En(ie))return ie;if(c=e-wn(ie),v=c*an(.6931471805599453*t+s+l-i*un(a)),o=v/a,r=.5*v-o*i,d=(D+r*(I+r*(A+r*(M+r*(E+T*r)))))/H,p=(H+r*(W+r*(G+r*(K+q*r))))/Z,h=(D+r*(V+r*(U+Y*r)))/Z,m=(P+r*(B+X*r)+i*(F+r*(z+J*r)))/Q,g=(M+N*r+i*(O+j*r))/Z,_=(k+i*(L+R*i))/Q,a+=v*(1+.5*v*d-o*i*(d-o*(p-o*(h-o*(m-o*(g-o*_)))))),sn(f/a-1)>te)return.5*n*a}return.5*n*a}function ct(e){return f(e)}function ft(e,t,n,r){return e>$t(t,n)||e<Qt(0,t-r+n)||t>r||n>r?mn:F(e,t,n,r)}function dt(e,t,n,r,o){if(e>$t(t,n)||e<Qt(0,t-r+n)||t>r||n>r)return mn;if(o){for(var i=0,a=0;a<=e;a++)i+=F(a,t,n,r);return i}return F(e,t,n,r)}function pt(e,t,n){return kn((un(e)-t)/n)}function ht(e,t,n,r){if(r)return kn((un(e)-t)/n);var o=(un(e)-t)/n;return.3989422804014327*an(-o*o/2)/n/e}function mt(e,t,n){var r=vt(e);if(En(r))return r;var o=wn(r);return vn(an(t+n*o))}function gt(e,t,n,r){return r?kn((e-t)/n):vn(an(-(e-t)*(e-t)/(2*n*n))/(ln(2*rn)*n))}function _t(e,t,n){var r,o,i=e-.5;if(sn(i)<=.42)r=i*i,o=i*(((-25.44106049637*r+41.39119773534)*r-18.61500062529)*r+2.50662823884)/((((3.13082909833*r-21.06224101826)*r+23.08336743743)*r-8.4735109309)*r+1);else{if(r=e,i>0&&(r=1-e),!(r>2.220446049250313e-16))return r>1e-300?(o=-2*un(e),r=un(6.283185307179586*o),r=r/o+(2-r)/(o*o)+(6*r-14-r*r)/(2*o*o*o),o=ln(o*(1-r)),i<0?-o:o):i<0?-Dn:Dn;r=ln(-un(r)),o=(((2.32121276858*r+4.85014127135)*r-2.29796479134)*r-2.78718931138)/((1.63706781897*r+3.54388924762)*r+1),i<0&&(o=-o)}var a=(o-0)/1,s=.3989422804014327*an(-.5*a*a)/1,l=gt(o,0,1,!0);return En(l)?l:(o-=(l-e)/s,t+n*o)}function vt(e){return _t(e,0,1)}function yt(e,t){return t?h(e):an(-Zt(e,2)/2)/ln(2*rn)}function bt(e,t){var n=0,r=0,o=0,i=0,a=0,s=zt(e);if(s!==zt(t))return hn;for(var l=0,u=0;u<s;u++){var c=e[u],f=t[u];On(c)&&On(f)&&(n+=c,r+=f,o+=c*c,i+=f*f,a+=c*f,l++)}return l*o-n*n==0||l*i-r*r==0?dn:(l*a-n*r)/ln((l*o-n*n)*(l*i-r*r))}function wt(e,t){var n=0,r=0,o=0,i=0,a=0,s=0,l=zt(t);if(l!==zt(e))return hn;for(var u=0;u<l;u++){var c=t[u],f=e[u];On(c)&&On(f)&&(n+=c,r+=f,o+=c*c,i+=f*f,a+=c*f,s++)}var d=ln((s*o-n*n)*(s*i-r*r));if(0===d)return dn;var p=(s*a-n*r)/d;return vn(p*p)}function Ct(e,t,n){var r=0;if(n)for(var o=0;o<=e;o++)r+=an(-t)*Zt(t,o)/Wt._fact(o);else r=an(-t)*Zt(t,e)/Wt._fact(e);return vn(r)}function St(e,t,n,r){var o=n;if(r!==Kt&&Xt(o=wn(r)))return pn;var i=0,a=0,s=zt(e);if(s!==zt(t))return hn;for(var l=0;l<s;l++){var u=e[l],c=t[l];if(u!==Pn&&c!==Pn){if(c<=0||1<c)return mn;n<=u&&u<=o&&(i+=c),a+=c}}return 1!==a?mn:i}function xt(){var e,t,n,r,o,i,a=arguments,s=0,l=0,u=0,c=0,f=[];for(n=0;n<zt(a);n++)for(i=a[n],f.push(i),r=0;r<zt(i);r++)(o=i[r])!==Pn&&(s+=o,l+=o*o,c++);if(c<=2)return dn;if(e=s/c,0===(t=ln((c*l-s*s)/(c*(c-1)))))return dn;for(n=0;n<zt(f);n++)for(i=f[n],r=0;r<zt(i);r++)(o=i[r])!==Pn&&(u+=Zt((o-e)/t,3));return vn(c*u/((c-1)*(c-2)))}function Tt(e,t,n){return(e-t)/n}function Et(e,t,n){if(1!==n&&2!==n)return mn;var r=t,o=e/ln(r),i=r/(r+e*e),a=r-2,s=r%2,l=1,u=1;r=1;var c=2+s,f=c;if(a>=2)for(var d=bn(c);d<=a&&(u=u*i*(f-1)/f,(l+=u)!==r);d+=2)r=l,f+=2;return 1!==s?n*(1-(.5+.5*o*ln(i)*l)):(1===t&&(l=0),n*(1-(.5+.3183098862*(o*i*l+on(o)))))}function Mt(e,t,n){return L(e,t,n?4:3)}function At(e,t){return Et(e,t,1)}function kt(e,t){return Et(e,t,2)}function Rt(e,t){var n,r,o,i,a,s,l,u,c,f,d=1e-12,p=e/2,h=p;if(t>1e20)return vt(p);if(h<.5?(f=0,s=2*h):(f=1,s=2*(1-h)),sn(t-2)<d)l=s>0?ln(2/(s*(2-s))-2):Dn;else if(wn(t)<1+d)s>0?(a=1.5707963267948966*(s+1),l=-nn(a)):l=Dn;else{if(n=1/(t-.5),r=48/(n*n),o=((20700*n/r-98)*n-16)*n+96.36,i=((94.5/(r+o)-3)/r+1)*ln(1.5707963267948966*n)*t,(c=Zt(i*s,2/t))>.05+n){var m=vt(.5*s);if(En(m))return m;u=wn(m),c=u*u,t<5&&(o+=.3*(t-4.5)*(u+.6)),o=(((.05*i*u-5)*u-7)*u-2)*u+r+o,c=(((((.4*c+6.3)*c+36)*c+94.5)/o-c-3)/r+1)*u,c*=n*c,c=c>.002?an(c)-1:.5*c*c+c}else c=((1/(((t+6)/(t*c)-.089*i-.822)*(t+2)*3)+.5/(t+4))*c-1)*(t+1)/(t+2)+1/c;l=ln(t*c)}return 0!==f&&(l=-l),vn(l)}function It(e,t){return e<.5?-H(1-e,t,4):H(e,t,4)}function Ot(e,t,n,r){var o,i,a,s,l,u,c,f,d,p={N:0,M:0,Q:0,_sum:0};if(1!==n&&2!==n)return mn;if(1===r){var h,m,_,y,b,w,C;if(zt(e)!==zt(t))return hn;var S=zt(e);for(C=0;C<S;C++)e[C]=e[C]-t[C];for(m=_=y=b=w=h=0,C=0;C<S;C++){var x=e[C];m=x-y,_=m/(w+1),y+=_,b+=w*m*_,w++,h+=x}if(w-1==0||0===w)return dn;if(s=ln(b/(w-1)),Xt(s)||!qt(s))return mn;o=h/w,a=o/(s/ln(w)),c=w-1}else{if(p.N=0,p.M=0,p.Q=0,p._sum=0,g(p,e),l=p.Q/(p.N-1),o=p._sum/p.N,f=p.N,p.N=0,p.M=0,p.Q=0,p._sum=0,g(p,t),u=p.Q/(p.N-1),i=p._sum/p.N,d=p.N,2!==r){var T=l/f/(l/f+u/d);c=1/(T*T/wn(f-1)+(1-T)*(1-T)/wn(d-1))}else c=wn(f+d-2);a=(o-i)/ln(l/wn(f)+u/wn(d))}a=sn(a);var E=v(.5*c,.5,c/(c+a*a));return En(E)?E:.5*n*wn(E)}function Dt(e,t,n,r){var o=an(-Zt(e/n,t));return vn(r?1-o:t/Zt(n,t)*Zt(e,t-1)*o)}function Pt(e,t,n){var r,o,i,a=0,s=0,l=0,u=0;if(n!==Kt&&Xt(a=wn(n)))return pn;for(var c=0;c<zt(e);c++){var f=e[c];f!==Pn&&(i=wn(f),s+=i,l+=i*i,u++)}if(0===u)return hn;if(1===u)return dn;if(r=s/u,0===(o=n!==Kt?a:ln((u*l-s*s)/(u*(u-1)))))return dn;var d=kn((r-t)/(o/ln(u)));return En(d)?d:vn(1-wn(d))}function Nt(e,t){e=wn(bn(e)),t=wn(bn(t));var n,r=1;if(e<0||t<0||e<t)return mn;for(n=e-t+1;n<=e;n++)r*=n;return vn(r)}function Ft(e,t){return W(!1,e,t)}function Lt(){var e,t,n=0,r=[],o=C(arguments),i=zt(o);for(e=0;e<i;e++){var a=0;for(t=e+1;t<i;t++)o[e]===o[t]&&a++;a>n?(n=a,r=[],r.push([o[e]])):a===n&&r.push([o[e]])}return 0===n?hn:new gn(r)}function Ht(e,t){var n=zt(e);if(b(e),!n)return mn;var r=t*(n+1)-1,o=r%1;if(r<0||n-1<r)return mn;var i=en(r),a=e[i];return 0===o?a:a+o*(e[i+1]-a)}function Vt(e,t){var n=Yt(t,[1,2,3]);return n<0?mn:Ht(e,.25*(n+1))}function jt(e,t,n){return e.rowCount>1||e.colCount>1?pn:B(!1,t,e[0],n)}var Bt=n(0),Ut=n(5),Wt=Ut.Functions,zt=Bt._ArrayHelper._getLength,Yt=Bt._Types._inArray,Gt=null,Kt=void 0,Xt=isNaN,qt=isFinite,Jt=parseInt,Zt=Math.pow,Qt=Math.max,$t=Math.min,en=Math.floor,tn=Math.sin,nn=Math.tan,rn=Math.PI,on=Math.atan,an=Math.exp,sn=Math.abs,ln=Math.sqrt,un=Math.log,cn=Math.round,fn=Ut.Errors,dn=fn.DivideByZero,pn=fn.Value,hn=fn.NotAvailable,mn=fn.Number,gn=Ut.CalcArray,_n=Ut.Convert,vn=_n._toResult,yn=_n._toArray,bn=_n._toInt,wn=_n._toDouble,Cn=Wt._MathHelper,Sn=Cn._combin,xn=Cn._parseCriteria,Tn=_n._isNumber,En=_n._isError,Mn=Wt._st_includeSubstotals,An=Wt._st_devVarIncludeSubtotals,kn=Wt._st_normsdist,Rn=Wt._isBoolean,In=Wt._isString,On=Wt._isNumber,Dn=Wt._MAX_DOUBLE_VALUE,Pn=_n.CalcConvertedError,Nn=Wt._defineBuiltInFunction,Fn={_argType:7},Ln={_defaultValue:!0,_argType:7},Hn={_argType:2},Vn={_argType:2,_argCondition:"< 1"},jn={_argType:2,_argCondition:"< 0"},Bn={_argType:2,_argCondition:["< 1","> 10000000000"]},Un={_argType:0},Wn={_argType:0,_argCondition:["< 0",">= 1"]},zn={_argType:0,_argCondition:["<= 0",">= 1"]},Yn={_argType:0,_argCondition:"<= 0"},Gn={_defaultValue:0,_argType:0},Kn={_defaultValue:1,_argType:0},Xn={_argType:0,_argCondition:["< 0","> 1"]},qn={_argType:0,_argCondition:"< 0"},Jn={_argType:0,_argCondition:["< 1","> 10000000000"]},Zn={_argType:0,_argCondition:["< 1",">= 10000000000"]},Qn={_argType:4,_valueType:1,_toOneDimension:!0,_breakOnError:!0,_ignoreBlank:!0},$n={_argType:4,_valueType:1,_toOneDimension:!0,_breakOnError:!0},er={_argType:4,_valueType:1,_toOneDimension:!0,_breakOnError:!0,_ignoreBlank:!0,_isAllArgsSameLimit:!0},tr={_argType:4,_valueType:1,_toOneDimension:!0,_breakOnError:!0,_isAllArgsSameLimit:!0},nr={_argType:4,_valueType:1,_breakOnError:!0,_ignoreBlank:!0},rr={_argType:4,_valueType:0,_toOneDimension:!0},or={_argType:4,_valueType:1,_toOneDimension:!0},ir={_argType:4,_valueType:1,_toOneDimension:!0,_breakOnError:!0,_breakOnConvertError:!0},ar={_argType:4,_valueType:0,_toOneDimension:!0,_breakOnError:!0,_isAllArgsSameLimit:!0},sr={_argType:4,_valueType:0,_toOneDimension:!0,_breakOnError:!0,_ignoreBlank:!0,_isAllArgsSameLimit:!0},lr={_argType:4,_valueType:0,_toOneDimension:!0,_breakOnError:!0},ur={_argType:4,_valueType:1,_breakOnError:!0,_breakOnConvertError:!0},cr=[Qn,{_argType:2}],fr=[$n,Hn],dr=[Qn,Un,{_defaultValue:3,_argType:2,_argCondition:"< 1"}],pr=[zn,Yn,Vn],hr=[zn,Yn,Yn,Gn,Kn],mr=[jn,jn,Xn,Fn],gr=[jn,Xn,zn],_r=[qn,Jn],vr=[Xn,Bn],yr=[$n,$n],br=[qn,Yn,Fn],wr=[qn,Zn,Zn],Cr=[Xn,Zn,Zn],Sr=[Qn,Qn],xr=[qn,Yn,Yn,Fn],Tr=[Xn,Yn,Yn],Er=[Xn,Un,Yn],Mr=[Un,Un,Yn,Fn],Ar=[or,or],kr=[{_argType:2,_argCondition:"<= 0"},Yn,Fn],Rr=[qn,Vn],Ir=[ir,ir,Hn,{_argType:2,_argCondition:["< 1","> 3"]}],Or=[qn,Yn,Yn,Fn],Dr=[Qn,Un],Pr=[ur,{},Ln,{_defaultValue:!1,_argType:7}],Nr=[{},$n,Gn];Nn("TREND",K,1,4,[{_argType:4,_valueType:0,_breakOnError:!0},{},{},Ln],[0,1,2],[0,1,2],{_acceptsMissingArgument:[1,2,3]}),Nn("GROWTH",X,1,4,[ur,{},{},Ln],"!= 3","!= 3",{_acceptsMissingArgument:[1,2,3]}),Nn("FORECAST",q,3,3,[Un,$n,$n],"> 0","> 0"),Nn("AVERAGE",J,1,Kt,Kt,-1,-1),Nn("STDEV",Z,1,Kt,Kt,-1,-1),Nn("STDEV.S",Z,1,Kt,Kt,-1,-1),Nn("PERCENTILE",Q,2,2,Kt,0,0),Nn("PERCENTILE.INC",Q,2,2,Kt,0,0),Nn("MAX",$,1,Kt,Kt,-1,-1),Nn("MAXA",ee,1,Kt,ar,-1,-1),Nn("MIN",te,1,Kt,Kt,-1,-1),Nn("MINA",ne,1,Kt,ar,-1,-1),Nn("LARGE",re,2,2,fr,0,0),Nn("SMALL",oe,2,2,fr,0,0),Nn("AVERAGEA",ie,1,Kt,sr,-1,-1),Nn("AVERAGEIF",ae,2,3,Kt,[0,2],[0,2],{_acceptsMissingArgument:2}),Nn("AVERAGEIFS",se,3,Kt,$n,[0,"%= 1"],[0,"%= 1"]),Nn("MEDIAN",le,1,Kt,er,-1,-1),Nn("MODE",ue,1,Kt,er,-1,-1),Nn("MODE.SNGL",ue,1,Kt,er,-1,-1),Nn("GEOMEAN",ce,1,Kt,tr,-1,-1),Nn("HARMEAN",fe,1,Kt,er,-1,-1),Nn("TRIMMEAN",de,2,2,[Qn,Wn],0,0),Nn("FREQUENCY",pe,2,2,[nr,nr],-1,-1),Nn("RANK",he,2,3,Nr,[0,1],[0,1],{_acceptsMissingArgument:2}),Nn("RANK.EQ",he,2,3,Nr,[0,1],1,{_acceptsMissingArgument:2}),Nn("KURT",me,1,Kt,er,-1,-1),Nn("PERCENTRANK",ge,2,3,dr,0,0,{_acceptsMissingArgument:2}),Nn("PERCENTRANK.INC",ge,2,3,dr,0,0,{_acceptsMissingArgument:2}),Nn("PERCENTRANK.EXC",_e,2,3,dr,0,0,{_acceptsMissingArgument:2}),Nn("QUARTILE",ve,2,2,cr,0,0),Nn("QUARTILE.INC",ve,2,2,cr,0,0),Nn("COUNT",ye,1,Kt,Kt,-1,-1,{_acceptsError:-1}),Nn("COUNTA",be,1,Kt,Kt,-1,-1,{_acceptsError:-1}),Nn("COUNTBLANK",we,1,1,rr,-1,-1),Nn("COUNTIF",Ce,2,2,[rr,rr],0,0),Nn("COUNTIFS",Se,2,Kt,lr,"%= 0","%= 0"),Nn("AVEDEV",xe,1,Kt,er,-1,-1),Nn("STDEVA",Te,1,Kt,sr,-1,-1),Nn("STDEVP",Ee,1,Kt,Kt,-1,-1),Nn("STDEV.P",Ee,1,Kt,Kt,-1,-1),Nn("STDEVPA",Me,1,Kt,sr,-1,-1),Nn("VAR",Ae,1,Kt,Kt,-1,-1),Nn("VAR.S",Ae,1,Kt,Kt,-1,-1),Nn("VARA",ke,1,Kt,sr,-1,-1),Nn("VARP",Re,1,Kt,Kt,-1,-1),Nn("VAR.P",Re,1,Kt,Kt,-1,-1),Nn("VARPA",Ie,1,Kt,sr,-1,-1),Nn("COVAR",Oe,2,2,yr,-1,-1),Nn("COVARIANCE.P",Oe,2,2,yr,-1,-1),Nn("DEVSQ",De,1,Kt,er,-1,-1),Nn("CONFIDENCE",Pe,3,3,pr),Nn("CONFIDENCE.NORM",Pe,3,3,pr),Nn("CONFIDENCE.T",Ne,3,3,pr),Nn("INTERCEPT",Fe,2,2,yr,-1,-1),Nn("LINEST",Le,1,4,Pr,[0,1],[0,1],{_acceptsMissingArgument:[1,2,3],_arrayArgumentEvaluateMode:1}),Nn("SLOPE",He,2,2,Ar,-1,-1,{_arrayArgumentEvaluateMode:1}),Nn("LOGEST",Ve,1,4,Pr,[0,1],[0,1],{_acceptsMissingArgument:[1,2,3]}),Nn("STEYX",je,2,2,yr,-1,-1),Nn("BETADIST",Be,3,5,[Un,Yn,Yn,Gn,Kn],Kt,Kt,{_acceptsMissingArgument:[3,4]}),Nn("BETA.DIST",Ue,4,6,[Un,Yn,Yn,Fn,Gn,Kn],Kt,Kt,{_acceptsMissingArgument:[5,6]}),Nn("BETAINV",We,3,5,hr,Kt,Kt,{_acceptsMissingArgument:[3,4]}),Nn("BETA.INV",We,3,5,hr,Kt,Kt,{_acceptsMissingArgument:[3,4]}),Nn("BINOMDIST",ze,4,4,mr),Nn("BINOM.DIST",ze,4,4,mr),Nn("NEGBINOMDIST",Ye,3,3,[Hn,Hn,Wn]),Nn("NEGBINOM.DIST",Ge,4,4,[jn,Vn,Wn,Fn]),Nn("CRITBINOM",Ke,3,3,gr),Nn("BINOM.INV",Ke,3,3,gr),Nn("CHIDIST",Xe,2,2,_r),Nn("CHISQ.DIST.RT",Xe,2,2,_r),Nn("CHISQ.DIST",qe,3,3,[qn,Bn,Fn]),Nn("CHIINV",Je,2,2,vr),Nn("CHISQ.INV.RT",Je,2,2,vr),Nn("CHISQ.INV",Ze,2,2,vr),Nn("CHITEST",Qe,2,2,yr,-1,-1),Nn("CHISQ.TEST",Qe,2,2,yr,-1,-1),Nn("CORREL",$e,2,2,yr,-1,-1),Nn("EXPONDIST",et,3,3,br),Nn("EXPON.DIST",et,3,3,br),Nn("FDIST",tt,3,3,wr),Nn("F.DIST",nt,4,4,[qn,Jn,Jn,Fn]),Nn("F.DIST.RT",tt,3,3,wr),Nn("FINV",rt,3,3,Cr),Nn("F.INV.RT",rt,3,3,Cr),Nn("F.INV",ot,3,3,[Xn,Bn,Bn]),Nn("FISHER",it,1,1,{_argType:0,_argCondition:["<= -1",">= 1"]}),Nn("FISHERINV",at,1,1,Un),Nn("FTEST",st,2,2,Sr,-1,-1),Nn("F.TEST",st,2,2,Sr,-1,-1),Nn("GAMMADIST",lt,4,4,xr),Nn("GAMMA.DIST",lt,4,4,xr),Nn("GAMMAINV",ut,3,3,Tr),Nn("GAMMA.INV",ut,3,3,Tr),Nn("GAMMALN",ct,1,1,Yn),Nn("GAMMALN.PRECISE",ct,1,1,Yn),Nn("HYPGEOMDIST",ft,4,4,[jn,jn,jn,jn]),Nn("HYPGEOM.DIST",dt,5,5,[jn,jn,jn,jn,Fn]),Nn("LOGNORMDIST",pt,3,3,[Yn,Un,Yn]),Nn("LOGNORM.DIST",ht,4,4,[Yn,Un,Yn,Fn]),Nn("LOGINV",mt,3,3,Er),Nn("LOGNORM.INV",mt,3,3,Er),Nn("NORMDIST",gt,4,4,Mr),Nn("NORM.DIST",gt,4,4,Mr),Nn("NORMINV",_t,3,3,Er),Nn("NORM.INV",_t,3,3,Er),Nn("NORMSDIST",kn,1,1,Un,Kt,Kt),Nn("NORMSINV",vt,1,1,Xn),Nn("NORM.S.INV",vt,1,1,Xn),Nn("NORM.S.DIST",yt,2,2,[Un,Fn]),Nn("PEARSON",bt,2,2,Ar,-1,-1),Nn("RSQ",wt,2,2,Ar,[0,1],[0,1]),Nn("POISSON",Ct,3,3,kr),Nn("POISSON.DIST",Ct,3,3,kr),Nn("PROB",St,3,4,[ir,$n,Un],[0,1],[0,1],{_acceptsMissingArgument:3}),Nn("SKEW",xt,1,Kt,er,-1,-1),Nn("STANDARDIZE",Tt,3,3,[Un,Un,Yn]),Nn("TDIST",Et,3,3,[qn,Vn,Hn]),Nn("T.DIST",Mt,3,3,[qn,Vn,Fn]),Nn("T.DIST.RT",At,2,2,Rr),Nn("T.DIST.2T",kt,2,2,Rr),Nn("TINV",Rt,2,2,vr),Nn("T.INV.2T",Rt,2,2,vr),Nn("T.INV",It,2,2,[{_argType:0,_argCondition:["<= 0","> 1"]},Bn]),Nn("TTEST",Ot,4,4,Ir,[0,1],[0,1]),Nn("T.TEST",Ot,4,4,Ir,[0,1],[0,1]),Nn("WEIBULL",Dt,4,4,Or),Nn("WEIBULL.DIST",Dt,4,4,Or),Nn("ZTEST",Pt,2,3,Dr,0,0,{_acceptsMissingArgument:2}),Nn("Z.TEST",Pt,2,3,Dr,0,0,{_acceptsMissingArgument:2}),Nn("PERMUT",Nt,2,2),Nn("COVARIANCE.S",Ft,2,2,yr,-1,-1),Nn("MODE.MULT",Lt,1,Kt,tr,-1,-1),Nn("PERCENTILE.EXC",Ht,2,2,[Qn,zn],0,0),Nn("QUARTILE.EXC",Vt,2,2,[Qn,Hn],0,0),Nn("RANK.AVG",jt,2,3,[ir,or,Gn],[0,1],1,{_acceptsMissingArgument:2}),e.exports=Wt},function(e,t){e.exports={_pri:function(){},_productType:0}},function(e,t,n){function r(e){return 0===e}function o(e){return 0===e||2===e}function i(e){var t=[];if(P(e))for(var n=0,r=e.getRangeCount();n<r;n++)for(var o=e.getRowCount(n),i=e.getColumnCount(n),a=0;a<o;a++)for(var s=0;s<i;s++)t.push(e.getValue(n,a,s));return t}function a(e,t){var n=[];if(P(e)){if(e.getRangeCount()>t)for(var r=e.getRowCount(t),o=e.getColumnCount(t),i=0;i<r;i++){n[i]=[];for(var a=0;a<o;a++)n[i].push(e.getValue(t,i,a))}}return n}function s(e){var t;return P(e)?t=e.getValue(0,0,0):H(e)||(t=e),t}function l(){var e=this.createFunction();if(e){var t=e.name,n=e.evaluate;e.evaluate=function(){var e=n.call(this,arguments);return e?new ue(t,e):Y},this._name=t,t&&!N.findGlobalFunction(t)&&(N._customFunctions[t]=e)}this.typeName=""}function u(){l.call(this)}function c(){l.call(this)}function f(){l.call(this)}function d(){l.call(this)}function p(){l.call(this)}function h(){l.call(this)}function m(){l.call(this)}function g(){l.call(this)}function _(){l.call(this)}function v(){l.call(this)}function y(){l.call(this)}function b(){l.call(this)}function w(){l.call(this)}function C(){l.call(this)}function S(e,t){function n(e){var t={},n=!1,r=!0,o="",i="";if(e){e=e.substr(1,e.length-2);for(var a=0,s=e.length;a<s;a++){var l=e.charAt(a);":"===l?r=!1:","!==l||n?"'"===l||'"'===l||("("===l?n=!0:")"===l&&(n=!1),r?o+=l:i+=l):(t[o]=i,o="",i="",r=!0)}o&&(t[o]=i);for(var u in t)if(t.hasOwnProperty(u)){var c=t[u];H(c)||("TRUE"===c.toUpperCase()?t[u]=!0:"FALSE"===c.toUpperCase()?t[u]=!1:!G(c)&&isFinite(c)&&(t[u]=K(c)))}}return t}function r(e){return new R.Range(e.getRow(0),e.getColumn(0),e.getRowCount(0),e.getColumnCount(0))}var i=new F(e,2,5);return i.evaluate=function(e){var o=e[0];if(P(o)){var i=o.getRangeCount();if(i>0){var s,l,u=r(o),c=e[1],f=e[2];P(f)&&(i=f.getRangeCount())>0&&(s=r(f),l=e[3]);var d=n(e[4]||"{}"),p={ac:"axisColor",fmc:"firstMarkerColor",hmc:"highMarkerColor",lastmc:"lastMarkerColor",lowmc:"lowMarkerColor",mc:"markersColor",nc:"negativeColor",sc:"seriesColor",deca:"displayEmptyCellsAs",rtl:"rightToLeft",dh:"displayHidden",dxa:"displayXAxis",sf:"showFirst",sh:"showHigh",slast:"showLast",slow:"showLow",sn:"showNegative",sm:"showMarkers",mmax:"manualMax",mmin:"manualMin",maxat:"maxAxisType",minat:"minAxisType",lw:"lineWeight"};for(var h in p)p.hasOwnProperty(h)&&d.hasOwnProperty(h)&&(d[p[h]]=d[h]);var m=new O.SparklineSetting(d),g=m.options;return 1===g.maxAxisType&&(g.maxAxisType=0),1===g.minAxisType&&(g.minAxisType=0),{data:u,dataOrientation:c,dateAxisData:s,dateAxisOrientation:l,sparklineType:t,displayDateAxis:s&&!H(l),setting:m,values:a(o,0),dateValues:a(f,0)}}}},i.acceptsReference=o,i}function x(e,t,n,r,o,i,a){var s=O.Sparkline._provideValuesImp,l=a.sheet,u=t.setting,c=u.options.displayHidden,f={sparklineType:t.sparklineType,displayDateAxis:t.displayDateAxis,zoomFactor:a.zoomFactor,values:s(t.values,l,c,t.data,t.dataOrientation),dateValues:s(t.dateValues,l,c,t.dateAxisData,t.dateAxisOrientation,!0),settings:u,getColor:function(e){if(l&&e){var t=R._ThemeContext._getColor(l,e);if(t)return t}return e}};(new W).paint(e,f,n,r,o,i)}function T(){l.call(this)}function E(){l.call(this)}function M(){l.call(this)}function A(e){e&&(ce[e.name()]=e)}var k=n(5),R=n(1),I=n(28),O=n(44),D=n(0),t=O,P=k&&k.Convert._isReference,N=k&&k.Functions,F=N&&N.Function,L=N&&N._builtInFunctions,H=D._Types._isNullOrUndefined,V=R.GC$,j=R.Workbook,B=V.inherit,U=V.extend,W=I.SparklineRender,z=I.SparklineExRenders,Y=null,G=isNaN,K=parseFloat,X=NaN,q="PIESPARKLINE",J="AREASPARKLINE",Z="SCATTERSPARKLINE",Q="BULLETSPARKLINE",$="SPREADSPARKLINE",ee="STACKEDSPARKLINE",te="HBARSPARKLINE",ne="VBARSPARKLINE",re="VARISPARKLINE",oe="BOXPLOTSPARKLINE",ie="CASCADESPARKLINE",ae="PARETOSPARKLINE",se="MONTHSPARKLINE",le="YEARSPARKLINE",ue=t.SparklineExValue=function(e,t){this.name=e,this.value=t};U(l.prototype,{name:function(){return this._name},createFunction:function(){return Y},paint:function(e,t,n,r,o,i,a){},toJSON:function(){var e={};for(var t in this)this.hasOwnProperty(t)&&(e[t]=this[t]);return e},fromJSON:function(e){if(e)for(var t in e)H(e[t])||(this[t]=e[t])}}),t.SparklineEx=l,B(u,l),U(u.prototype,{createFunction:function(){var e=new F(q,1,255);return e.evaluate=function(e){var t=e[0],n=i(t);return n.length<=0&&!H(t)&&n.push(t),{values:n,colors:Array.prototype.slice.call(e,1)}},e.acceptsReference=r,e},paint:z[q]}),t.PieSparkline=u,B(c,l),U(c.prototype,{createFunction:function(){var e=new F(J,1,7);return e.evaluate=function(e){return{points:i(e[0]),mini:e[1],maxi:e[2],line1:e[3],line2:e[4],colorPositive:e[5],colorNegative:e[6]}},e.acceptsReference=r,e},paint:z[J]}),t.AreaSparkline=c,B(f,l),U(f.prototype,{createFunction:function(){var e=new F(Z,1,18);return e.evaluate=function(e){return{points1:a(e[0],0),points2:a(e[1],0),minX:e[2],maxX:e[3],minY:e[4],maxY:e[5],hLine:e[6],vLine:e[7],xMinZone:e[8],xMaxZone:e[9],yMinZone:e[10],yMaxZone:e[11],tags:e[12],drawSymbol:e[13],drawLines:e[14],color1:e[15],color2:e[16],dash:e[17]}},e.acceptsReference=function(e){return 0===e||1===e},e},paint:z[Z]}),t.ScatterSparkline=f,B(d,l),U(d.prototype,{createFunction:function(){var e=new F(Q,3,9);return e.evaluate=function(e){return{measure:s(e[0]),target:s(e[1]),maxi:s(e[2]),good:s(e[3]),bad:s(e[4]),forecast:s(e[5]),tickUnit:s(e[6]),colorScheme:e[7],vertical:e[8]}},e.acceptsReference=function(e){return 0<=e&&e<=6},e},paint:z[Q]}),t.BulletSparkline=d,B(p,l),U(p.prototype,{createFunction:function(){function e(e){for(var t,n=[],r=0,o=0,i=e.length;r<i;r++)t=K(e[r]),!G(t)&&isFinite(t)&&(n[o++]=t);return n}function t(e){for(var t,n={},r=0,o=e.length;r<o;r++)t=e[r],n[t]?n[t]++:n[t]=1;var i=[];for(var a in n)n.hasOwnProperty(a)&&i.push({key:K(a),value:n[a]});return i.sort(function(e,t){return e.key-t.key})}var n=new F($,1,7);return n.evaluate=function(n){var r=i(n[0]),o=[];if(!H(r)){r=e(r),o=t(r);var a=n[4];if(3===a)for(var s=0,l=o.length;s<l;s++){for(var u=o[s],c=u.value,f=[],d=Math.max(100,10*c),p=0;p<d+c-1;p++)f.push(Math.random());u.randomNumbers=f}}return{spreadData:o,showAverage:n[1],scaleStart:n[2],scaleEnd:n[3],style:a,colorScheme:n[5],vertical:n[6]}},n.acceptsReference=r,n},paint:z[$]}),t.SpreadSparkline=p,B(h,l),U(h.prototype,{createFunction:function(){var e=new F(ee,1,13);return e.evaluate=function(e){return{points:i(e[0]),colorRange:i(e[1]),labelRange:i(e[2]),maximum:e[3],targetRed:e[4],targetGreen:e[5],targetBlue:e[6],targetYellow:e[7],color:e[8],highlightPosition:e[9],vertical:e[10],textOrientation:e[11],textSize:e[12]}},e.acceptsReference=function(e){return 0<=e&&e<=2},e},paint:z[ee]}),t.StackedSparkline=h,B(m,l),U(m.prototype,{createFunction:function(){var e=new F(te,1,2);return e.evaluate=function(e){return{value:s(e[0]),colorScheme:e[1]}},e.acceptsReference=r,e},paint:z[te]}),t.HBarSparkline=m,B(g,l),U(g.prototype,{createFunction:function(){var e=new F(ne,1,2);return e.evaluate=function(e){return{value:s(e[0]),colorScheme:e[1]}},e.acceptsReference=r,e},paint:z[ne]}),t.VBarSparkline=g,B(_,l),U(_.prototype,{createFunction:function(){var e=new F(re,1,10);return e.evaluate=function(e){return{variance:s(e[0]),reference:s(e[1]),mini:s(e[2]),maxi:s(e[3]),mark:s(e[4]),tickUnit:s(e[5]),legend:e[6],colorPositive:e[7],colorNegative:e[8],vertical:e[9]}},e.acceptsReference=function(e){return 0<=e&&e<=5},e},paint:z[re]}),t.VariSparkline=_,B(v,l),U(v.prototype,{createFunction:function(){function e(e,t){return P(e)&&!G(t)&&0<=t&&t<=100?L.PERCENTILE.evaluate(e,t/100):X}function t(e){return P(e)?L.STDEVP.evaluate(e):X}var n=new F(oe,1,10);return n.evaluate=function(n){var r=n[0];return{points:i(r),boxPlotClass:n[1],showAverage:n[2],scaleStart:s(n[3]),scaleEnd:s(n[4]),acceptableStart:s(n[5]),acceptableEnd:s(n[6]),colorScheme:n[7],style:n[8],vertical:n[9],perc02:e(r,2),perc09:e(r,9),perc10:e(r,10),perc90:e(r,90),perc91:e(r,91),perc98:e(r,98),q1:e(r,25),q3:e(r,75),median:e(r,50),stDev:t(r)}},n.acceptsReference=r,n},paint:z[oe]}),t.BoxPlotSparkline=v,B(y,l),U(y.prototype,{createFunction:function(){var e=new F(ie,1,8);return e.evaluate=function(e){return{points:i(e[0]),pointIndex:s(e[1]),labels:i(e[2]),minimum:s(e[3]),maximum:s(e[4]),colorPositive:e[5],colorNegative:e[6],vertical:e[7]}},e.acceptsReference=o,e.acceptsArray=o,e},paint:z[ie]}),t.CascadeSparkline=y,B(b,l),U(b.prototype,{createFunction:function(){var e=new F(ae,1,8);return e.evaluate=function(e){return{points:i(e[0]),pointIndex:s(e[1]),colorRange:i(e[2]),target:s(e[3]),target2:s(e[4]),highlightPosition:s(e[5]),label:e[6],vertical:e[7]}},e.acceptsReference=o,e.acceptsArray=o,e},paint:z[ae]}),t.ParetoSparkline=b,B(w,l),U(w.prototype,{createFunction:function(){var e=new F(se,3,7);return e.evaluate=function(e){var t=e[0],n=e[1],r=e[2],o=r;P(r)&&(o=a(r,0));var i=e[3],s=[];P(i)&&(s=a(i,0));for(var l=[],u=[],c=0,f=o.length;c<f;c++){var d=o[c];if(d){var p=d[0];if(p&&p.getFullYear()===t&&p.getMonth()+1===n){var h=p.getDate()-1;l[h]=d[1],s.length>0&&(u[h]=s[c][0])}}}return s.length>0?{year:t,month:n,values:l,colors:u}:{year:t,month:n,values:l,emptyColor:i,startColor:e[4],middleColor:e[5],endColor:e[6]}},e.acceptsReference=function(e){return 2===e||3===e},e},paint:z[se]}),t.MonthSparkline=w,B(C,l),U(C.prototype,{createFunction:function(){var e=new F(le,2,6);return e.evaluate=function(e){function t(e,t){switch(t){case 2:return e%4==0&&e%100!=0||e%400==0?29:28;case 4:case 6:case 9:case 11:return 30;default:return 31}}function n(e){for(var n=e.getFullYear(),r=e.getMonth(),o=e.getDate(),i=1;i<r+1;i++)o+=t(n,i);return o}var r=e[0],o=e[1],i=o;P(o)&&(i=a(o,0));var s=e[2],l=[];P(s)&&(l=a(s,0));for(var u=[],c=[],f=0,d=i.length;f<d;f++){var p=i[f];if(p){var h=p[0];if(h&&h.getFullYear()===r){var m=n(h)-1;u[m]=p[1],l.length>0&&(c[m]=l[f][0])}}}return l.length>0?{year:r,values:u,colors:c}:{year:r,values:u,emptyColor:s,startColor:e[3],middleColor:e[4],endColor:e[5]}},e.acceptsReference=function(e){return 1===e||2===e},e},paint:z[le]}),t.YearSparkline=C,B(T,l),U(T.prototype,{createFunction:function(){return S("LINESPARKLINE",0)},paint:x}),t.LineSparkline=T,B(E,l),U(E.prototype,{createFunction:function(){return S("COLUMNSPARKLINE",1)},paint:x}),t.ColumnSparkline=E,B(M,l),U(M.prototype,{createFunction:function(){return S("WINLOSSSPARKLINE",2)},paint:x}),t.WinlossSparkline=M;var ce={};F&&(A(new u),A(new c),A(new f),A(new d),A(new p),A(new h),A(new m),A(new g),A(new _),A(new v),A(new y),A(new b),A(new w),A(new C),A(new T),A(new E),A(new M)),U(j.prototype,{addSparklineEx:function(e){var t=this._sparklineExs||(this._sparklineExs={});e&&(t[e.name()]=e)},getSparklineEx:function(e){var t=ce[e];if(t)return t;var n=this._sparklineExs;return n&&n[e]},removeSparklineEx:function(e){var t=this._sparklineExs;t&&(t[e]=void 0)}}),j._registerFeature("sparklineEx",{toJson:function(e){var t=this._sparklineExs,n=[];if(t){for(var r in t)if(t.hasOwnProperty(r)){var o=t[r],i=o.toJSON();i&&i.typeName&&n.push(i)}n.length>0&&(e.sparklineExs=n)}},fromJson:function(e){var t=e.sparklineExs;if(t)for(var n=0;n<t.length;n++){var r=t[n],o=R.getTypeFromString(r.typeName);if(o){var i=new o;i.fromJSON(r),this.addSparklineEx(i)}}}}),e.exports=t},function(e,t,n){function r(e,t,r,o,i){var a=e&&e instanceof n(6).Worksheet&&e,s=new v.Parser;r=r===E?0:r,o=o===E?0:o;var l=new D(a,!!i,v._createCellIdentity(r,o));return s.parse(l,t)}function o(e,t,r,o,i){var a=e&&e instanceof n(6).Worksheet&&e,s=new v.Parser;r=r===E?0:r,o=o===E?0:o;var l=new D(a,!!i,v._createCellIdentity(r,o));return s.unparse(l,t)}function i(e,t,n,o,i){var a=r(e,t,n,o,i);return b.evaluateExpression(e,a,n,o)}function a(e){return(new v.Parser).parseToTokens(null,e)}function s(e,t,n,r){var o=e._getCalcServiceInternal();n===E&&(n=e.getActiveRowIndex()),r===E&&(r=e.getActiveColumnIndex());var i=e._getSheetSource();return o._evaluateParsedFormula(i,t,v._createCellIdentity(n,r),!1,!0)}function l(e,t,n,r,o){var i=e.row,a=e.col,s=e.row+e.rowCount-1,l=e.col+e.colCount-1,f=!1,d=!1,p=!1,h=!1;arguments.length>=4&&(f=0!=(1&r),d=0!=(4&r),p=0!=(2&r),h=0!=(8&r),i-=f?t:0,s-=d?t:0,a-=p?n:0,l-=h?n:0);var m;if(o){var g=u(e,o,t),_=c(e,o,t);if(g&&_)return m=v.StructureReferenceResolver.create(o,g,_,e.col-o.dataRange().col,e.col+e.colCount-o.dataRange().col-1)}return 1===e.rowCount&&1===e.colCount?m=v._createCellExpression(T,T,i,a,f,p):(e.row<0&&(i=s=v.BAND_INDEX_CONST),e.col<0&&(a=l=v.BAND_INDEX_CONST),m=v._createRangeExpression(T,T,i,a,s,l,f,p,d,h)),m}function u(e,t,n){if(1===e.rowCount){if(t.hasHeadersRow()&&e.row===t.startRow())return 2;if(t.hasTotalsRow()&&e.row===t.endRow())return 8;if(n===e.row)return 1}else{if(t.hasHeadersRow()&&e.row===t.startRow()){if(e.rowCount===t.dataRange().rowCount+1)return 6;if(t.hasTotalsRow()&&e.rowCount===t.dataRange().rowCount+1+1)return 14}if(e.row===t.dataRange().row){if(e.rowCount===t.dataRange().rowCount)return 3;if(t.hasTotalsRow()&&e.rowCount===t.dataRange().rowCount+1)return 12}}return E}function c(e,t,n){return e.col===t.startColumn()&&e.colCount===t.dataRange().colCount?1:1===e.colCount?2:e.col>=t.startColumn()&&e.col+e.colCount-1<=t.endColumn()?4:E}function f(e,t,n,r,o){var i=b.rangeToExpression(e,t,n,r),a=new D(T,!!o,v._createCellIdentity(t,n));return(new v.Parser).unparse(a,i)}function d(e,t,n,r,o,i,a){var s=b.rangeToExpression(t,n,r,o,a),l=new D(e,!!i,v._createCellIdentity(n,r));return(new v.Parser).unparse(l,s)}function p(e,t,n,r){if(!t)return null;n=n||0,r=r||0;var o,i=e._getCalcServiceInternal(),a=i.parse(e._getSheetSource(),t,n,r,!0,!0);if(a)if((o=a.source)&&13===a.type)o=a.source();else if(1===a.type&&a.endSource){for(var s=a.source,l=a.endSource,u=s.getSources(l),c=!1,f=0;f<u.length;f++)if(u[f]===e._getSheetSource()){c=!0;break}a=c&&a}if(a&&a.getRange&&(!o||o===e._getSheetSource())){var d=a.getRange(n,r);return d?new y.Range(d.row,d.col,d.rowCount,d.colCount):null}return null}function h(e,t,n,r){var o=[],i=[];if(!t)return o;var a={};n=n||0,r=r||0;for(var s=new v.Parser,l=s.parseReferenceExpressionInfos(t,e,n,r),u=0;u<l.length;u++)for(var c=l[u].sheetRanges,f=0;c&&f<c.sheets.length;f++){var d=c.sheets[f];i=a[d],i||(a[d]=i=[],o.push({sheetName:d,ranges:i}));for(var p=c[d],h=0;h<p.length;h++){var m=p[h];i.push(new y.Range(m.row,m.col,m.rowCount,m.colCount))}}return o}function m(e,t,n,r,o){for(var i="",a=new v.Parser,s=new D(T,!!o,v._createCellIdentity(t,n)),l=0;l<e.length;l++){var u=b.rangeToExpression(e[l],t,n,r),c=a.unparse(s,u);i+=l>0?", "+c:c}return i}function g(e,t,n,r,o,i,a){var s,l,u,c,f,d=r.getValue(t,n),p=!1,h=100,m=.001,g=.01;if(l=(R(d)?+d:0)-a,s=r.getValue(o,i),c=(R(s)?+s:0)-a,R(s)&&Math.abs(c)<m)p=!0;else if(I(s))p=!1;else{u=l+(0===l?g:g*l);for(var _=0;!p&&_<h;_++)if(u=u.toString().length>=13?+u.toPrecision(13):u,e.setValue(t,n,u),s=r.getValue(o,i),f=(R(s)?+s:0)-a,R(s)&&Math.abs(f)<m)p=!0;else if(I(s))u=(l+u)/2;else if(l-u==0)u=l+(0===l?g:g*l);else if(c-f==0)u=l+2*(u-l);else{var v=u-f*(l-u)/(c-f);l=u,c=f,u=v}}return p||e.setValue(t,n,d),p}var _=n(0),v=n(5),y=n(2),b=y.CalcEngine={};y._supportsCalc=!0;var w=_._Types,C=_._StringHelper,S=w._extend,x=w._isEmptyObject,T=null,E=void 0,M=["v","n","s","b","d"],A=v.Errors.Value,k=w._inherit,R=function(e){return v.Convert._isNumber(e,!0)},I=v.Convert._isError,O=b.SheetSource=function(e){function t(t){e.call(this,T),this._sheet=t}return k(t,e),t}(v.CalcSource);S(O.prototype,{startCalculation:function(){if(!this._valueCaches){var e=this.getRowCount(),t=this.getColumnCount();this._valueCaches={rowCount:e,colCount:t},this._changedCells=[]}},endCalculation:function(){this._valueCaches=T;var e=this._changedCells;e&&e.length>0&&this._sheet._trigger(n(6).Events.RangeChanged,{sheet:this._sheet,sheetName:this._sheet.name(),row:0,col:0,rowCount:this._sheet.getRowCount(),colCount:this._sheet.getColumnCount(),changedCells:e,action:6}),this._changedCells=T},getValue:function(e,t){var n,r,o=this,i=o._sheet,a=["YYYY/MM/DD","YYYY/MM/DD HH:mm:ss","HH:mm:ss","YYYY-MM-DD"];if(e.row!==E?(n=e.row,r=e.col):(n=arguments[0],r=arguments[1],t=arguments[2]),t=t||0,n<0||r<0)return A;if(i._isValidatingCell&&i._validatingRow===n&&i._validatingColumn===r)return i._validatingValue;var s=o._valueCaches,l=M[t];if(s){var u,c,f,d=s.rowCount,p=s.colCount;if(n>=d)return T;if(r>=p)return T;if(u=s[n],u||(u=s[n]={}),!(c=u[r])){var h,m=i.getFormatter(n,r);h=a.indexOf(m)>-1?i.getText(n,r):i.getValue(n,r),c=u[r]={v:h}}return f=c[l],f===E&&(f=v.Convert._convertValue(c.v,t,!0),c[l]=f),f}return n>=o.getRowCount()?T:r>=o.getColumnCount()?T:o._sheet.getValue(n,r)},getReference:function(e){var t=this;return-1===e.row&&(e.row=0,e.rowCount=t.getRowCount()),-1===e.col&&(e.col=0,e.colCount=t.getColumnCount()),new v.CalcReference(t,[e])},getSheetRangeReference:function(e){if(e.endSource&&this._sheet&&this._sheet.parent&&this._sheet.parent.sheets&&e.endSource instanceof O){for(var t,n=this._sheet.parent.sheets,r=!1,o=[],i=0;i<n.length;i++){if((t=n[i]._getSheetSource())===this)r=!0;else if(t===e.endSource){o.push(t.getReference(e));break}r&&o.push(t.getReference(e))}return new P(o)}},getSources:function(e){if(this._sheet&&this._sheet.parent&&this._sheet.parent.sheets&&e instanceof O){for(var t,n=this._sheet.parent.sheets,r=!1,o=[],i=0;i<n.length;i++){if(t=n[i]._getSheetSource(),t===this&&(r=!0),t===e){o.push(t);break}r&&o.push(t)}return o}},referenceToArray:function(e,t,n,r,o,i){var a,s,l,u,c,f,d,p,h,m=this,g=1,_=1,y=[],b=m._sheet,w=m._valueCaches,C=M[t];if(0===(c=e.getRangeCount()))return y.isError=!0,[];if(w&&(h=e.getRangeCount()+"_"+e.getRow(0)+"_"+e.getColumn(0)+"_"+e.getRowCount(0)+"_"+e.getColumnCount(0)+"_"+t+"_"+n,f=w[h]))return y=f,y.rowCount=f.rowCount,y.colCount=f.colCount,y.rangeCount=f.rangeCount,y;var S=this.getRowCount(),x=this.getColumnCount();n=n===E||n;for(var k=0;k<c;k++){if(n||(d=[],y.push(d)),0===(g=e.getRowCount(k)))return y.isError=!0,[];if(0===(_=e.getColumnCount(k)))return y.isError=!0,[];if(l=e.getRow(k),u=e.getColumn(k),l>=S||u>=x)return y=[T],y.rowCount=1,y.colCount=1,y.rangeCount=1,y;l+g>S&&(g=S-l),u+_>x&&(_=x-u);for(var R,I,O=b._isValidatingCell,D=0;D<g;D++){a=l+D,n||(R=[],d.push(R)),w&&((p=w[a])||(p=w[a]={}));for(var P=0;P<_;P++){if(s=u+P,O&&b._validatingRow===a&&b._validatingColumn===s)f=b._validatingValue,O=!1;else{if(w?(I=p[s],I?f=I.v:(f=b.getValue(a,s),I=p[s]={v:f})):f=b.getValue(a,s),r&&v.Convert._isError(f))return y=[f],y.isError=!0,y;if(I&&I[C]!==E)f=I[C];else if(f=v.Convert._convertValue(f,t,!0,i),I&&(I[C]=f),o&&I===f)return y=[A],y.isError=!0,y}f===T&&i||(n?y.push(f):R.push(f))}}}return n||1!==c||(y=y[0]),y.rowCount=g,y.colCount=_,y.rangeCount=c,w&&(w[h]=y,w[h].rowCount=g,w[h].colCount=_,w[h].rangeCount=c),y},getColumnCount:function(){return this._sheet.getColumnCount()},getRowCount:function(){return this._sheet.getRowCount()},isHiddenRow:function(e,t){var n=this._sheet;return!((!n._hasRowFilterOut||!n._hasRowFilterOut())&&t)&&0===n.getRowHeight(e)},getName:function(){return this._sheet.name()},setValue:function(e,t,r){var o=this,i=o._sheet,a=o._valueCaches;if(a){var s=a[e];if(s){var l=s[t];l&&(l.v=r,void 0!==l.b&&(l.b=void 0),void 0!==l.d&&(l.d=void 0),void 0!==l.n&&(l.n=void 0),void 0!==l.s&&(l.s=void 0))}}var u=i._getModel(),c=i.getValue(e,t),f=!1,d=i.tables,p=d&&d.find(e,t);if(p){var h=p.showHeader()&&e===p.headerIndex(),m=p.showFooter()&&e===p.footerIndex();h||m||(f=p._setValue(e,t,r))}var g=i._bindingManager;if(!f&&g&&g._dataSource){var _=g.getValue(e,t);if(_.hasBinding){var v=S({},i.getDataItem(e));u._updateDirty(e,t,{_originalItem:v,_oldValue:g.getValue(e,t).value}),g.setValue(e,t,r)}f=_.hasBinding}f||u.setValue(e,t,r),this._changedCells?this._changedCells.push({row:e,column:t}):this._sheet._trigger(n(6).Events.CellChanged,{sheet:this._sheet,sheetName:this._sheet.name(),row:e,col:t,sheetArea:3,propertyName:"value",oldValue:c,newValue:r})},setAutoFormat:function(e,t,n){this._sheet.getCell(e,t)._setStyleProperty("_autoFormatter",n)},getCustomFunction:function(e){return this._sheet?this._sheet._findCustomFunction(e):T},getCustomName:function(e){var t=this._sheet?this._sheet.getCustomName(e):T;return t?t.getExpression():T},getSheet:function(){return this._sheet},getParserContext:function(e,t,n){return t=t||v._createCellIdentity(0,0),new D(this._sheet,e,t,n)},setFormula:function(e,t,n){},setArrayFormula:function(e,t,n,r,o){},setFormulaByName:function(e,t){},refresh:function(){this._sheet.repaint()},toJSON:function(e,t,n,r){for(var o,i,a,s,l,u=t,c=e.data||{},f=!0,d=0;d<=n;d++)if(o=c.dataTable||{},i=u[d]){s=o[d],f=!s,s=s||{};for(var p=0;p<=r;p++)if((a=i[p])&&a._expr){l=s[p]||{};try{var h=this._getCalcServiceInternal().unparse(this,a._expr,d,p,!1,!0);a._arrayInfo?a._arrayInfo.row===d&&a._arrayInfo.col===p&&(l.arrayInfo=a._arrayInfo,l.formula=h):l.formula=h,f=!1,s[p]=l}catch(e){}}f||(o[d]=s),x(o)||(c.dataTable=o)}x(c)||(e.data=c)}}),b.SpreadSource=function(e){function t(t){e.call(this,T),this._spread=t}return k(t,e),t.prototype.getCustomFunction=function(e){return this._spread?this._spread.getCustomFunction(e):T},t.prototype.getCustomName=function(e){var t=this._spread?this._spread.getCustomName(e):T;return t?t.getExpression():T},t}(v.CalcSource);var D=b.SheetParserContext=function(e){function t(t,n,r,o){e.call(this,t&&t._getSheetSource(),n,r,o),this._sheet=t,this.addResolver(new v.SheetReferenceResolver(t)),this.addResolver(new v.StructureReferenceResolver(t))}return k(t,e),t}(v.ParserContext);S(D.prototype,{getExternalSource:function(e,t){var n=this,r=n._sheet.parent;if(e&&(!r||r.name!==e))return T;if(!r)return C._compareStringIgnoreCase(n._sheet._name,t)?n._sheet._getSheetSource():T;var o=r.sheets;if(o&&o.length>0)for(var i=0;i<o.length;i++){var a=o[i];if(C._compareStringIgnoreCase(a._name,t))return a._getSheetSource()}return v.ParserContext.prototype.getExternalSource.call(this,e,t)},getExternalSourceToken:function(e){return e.getName()},getTableByName:function(e){var t,n=this._sheet.tables;if(!(t=n?n.findByName(e):T)){var r=this._sheet.parent&&this._sheet.parent.sheets;if(r)for(var o=0;o<r.length&&(!(n=r[o].tables)||!(t=n.findByName(e)));o++);}return t},getTableByIndex:function(e,t){var n=this._sheet.tables;return n?n.find(e,t):T},setSource:function(e){this.source=e,e&&e.getSheet&&(this._sheet=e.getSheet())}});var P=b.SheetRangeReference=function(e){function t(t){e.call(this,T),this.references=t}return k(t,e),t.prototype.toArray=function(e,t,n,r,o){for(var i=this.references,a=[],s=0;s<i.length;s++){var l=i[s]._source.referenceToArray(i[s],e,t,n,r,o);if(l.isError&&n)return l;t?Array.prototype.push.apply(a,l):a.push(l[0]),s||(a.rowCount=l.rowCount,a.colCount=l.colCount)}return a.rangeCount=i.length,a},t}(v.CalcReference);b.formulaToExpression=r,b.expressionToFormula=o,b.evaluateFormula=i,b.parseFormulaToTokens=a,b.evaluateExpression=s,b.rangeToExpression=l,b.rangeToFormula=f,b.rangeToFormulaWithStructReference=d,b.formulaToRange=p,b.formulaToRanges=h,b.rangesToFormula=m,b.RangeReferenceRelative={allAbsolute:0,startRowRelative:1,startColRelative:2,endRowRelative:4,endColRelative:8,rowRelative:5,colRelative:10,allRelative:15},b.GoalSeek=g,e.exports=v},function(e,t,n){function r(e,t,n,r,o,i,a,s,l,u){if(n>=0||!o){var c=r+(o?n:0),f=i+(a?n:0);return s===e&&l+u<=n&&(c-=o?u:0,f-=a?u:0),s===t&&(l<=c?(c+=u,f+=u):l<=f&&(f+=u)),c-=o?n:0,f-=a?n:0,{index:c,endIndex:f}}return{index:r,endIndex:i}}function o(e,t,n,o,i,a,s,l,u,f){if(t){var d,p=u?i.row:i.column,h=u?i.rowRelative:i.columnRelative;if(u&&n>=0||!u&&o>=0||!h){if(f)d=r(e,t,u?n:o,p,h,-1,!1,a,s,l).index;else if(d=c(e,t,u?n:o,p,h,a,s,l),I(d))return P(d);d!==p&&(i=i.offset(u?d-p:0,u?0:d-p,!0))}}return i}function i(e,t,n,o,i,a,s,l,u,c){if(t){var d=i._getRangeType();if(3===d||u&&2===d||!u&&1===d)return i;var p,h=u?i.rowRelative:i.columnRelative,m=u?i.endRowRelative:i.endColumnRelative,g=u?i.row:i.column,_=u?i.endRow:i.endColumn;if(u&&n>=0||!u&&o>=0||!h||!m){if(c)p=r(e,t,u?n:o,g,h,_,m,a,s,l);else if(p=f(e,t,u?n:o,g,h,_,m,a,s,l),I(p))return new P(p);var v=p.index,y=p.endIndex;v===g&&y===_||(i=i.offset2(u?v-g:0,u?0:v-g,u?y-_:0,u?0:y-_))}}return i}function a(e,t,n,r,o,i,a,s,l){if(t){var u=o;if(u&&t===u.source())return u.offsetWhenInsertRemoveColumn(a,s,l)}return o}function s(e,t,n,r,l,u,c,f,d){var p,h=s,m=r;if(1===r.type&&r._isCell)m=o(e,r.source||e,t,n,r,l,u,c,f,d);else if(1===r.type)m=i(e,r.source||e,t,n,r,l,u,c,f,d);else if(10===r.type)(p=h(e,t,n,r.value,l,u,c,f,d))!==r.value&&(m=N(p));else if(9===r.type){var g=h(e,t,n,r.value,l,u,c,f,d),_=r.value2&&h(e,t,n,r.value2,l,u,c,f,d);g===r.value&&_===r.value2||(m=F(r.operatorType,g,_))}else if(7===r.type){var v,y,b=k,w=r,C=w.arguments.length;for(y=0;y<C;y++)if(v=w.arguments[y],(p=h(e,t,n,v,l,u,c,f,d))!==v){b=[],b[y]=p;break}if(b){for(y=0;y<C;y++)v=w.arguments[y],b[y]!==A&&b[y]!==k||(b[y]=h(e,t,n,v,l,u,c,f,d));m=L(w.function,b)}}else f||13!==r.type||(m=a(e,e,t,n,r,l,u,c,d));return m}function l(e,t,n,r,o,i,a,s,l,c){u(function(u,f){var d=a,p=s;u!==e&&(d=o,p=i);var h=u._getCalcServiceInternal().parse(e,f,o,i),m=t.call(this,u,d,p,h,e,n,r,l,c);return h!==m||o!==a||i!==s?u._getCalcServiceInternal().unparse(e,m,d,p):A},l)}function u(e,t){var r=n(2),o=r&&r._DataValidatorCache;if(o)for(var i,a,s,l,u,c,f,d=o._getAllValidators(),p=S.maxRowCount-1,h=S.maxColumnCount-1,m=0;m<d.length;m++){var g=!0,_=!0;for(var v in d[m])if(!isNaN(parseFloat(v))){for(var y in d[m][v]){var b=y.split("_");if(c=parseInt(b[0],10),f=parseInt(b[1],10),-1!==c&&(_=!1,p=p>c?c:p),-1!==f&&(g=!1,h=h>f?f:h),!g&&!_)break}if(!g&&!_)break}if(!(t&&_||!t&&g)){i=d[m].validator,u=d[m].sheet;var w=u._getSheetSource();if(a=i.condition(),(s=a.getFormulas())&&s.length>0){for(var C=0;C<s.length;C++){l=s[C];var x=e(w,l,p,h);x&&(s[C]=x)}a.setFormulas(s)}}}}function c(e,t,n,r,o,i,a,s){if(n>=0||!o){var l=r+(o?n:0);if(i===e&&a<=n&&(l+=o?s:0),i===t)if(a+s<=l)l-=s;else if(a<=l)return H;return l-=o?n:0}return r}function f(e,t,n,r,o,i,a,s,l,u){if(n>=0||!o){var c=r+(o?n:0),f=i+(a?n:0),d=l+u-1;if(s===e&&l<=n&&(c+=o?u:0,f+=a?u:0),s===t)if(d<c)c-=u,f-=u;else{if(l<=c&&d>=f)return H;l>f||(d<=f?(c=l>=c?c:l,f-=u):f=l-1)}return c-=o?n:0,f-=a?n:0,{index:c,endIndex:f}}return{index:r,endIndex:i}}function d(e,t,n){var r,o,i,a=d,s=t;if(t.source){var l=t.source;(e!==n&&l===n||e===n&&l!==n)&&(s=V)}else if(10===t.type)(r=a(e,t.value,n))!==t.value&&(s=N(r));else if(9===t.type){var u=a(e,t.value,n),c=t.value2&&a(e,t.value2,n);u===t.value&&c===t.value2||(s=F(t.operatorType,u,c))}else if(7===t.type){var f=k,p=t.arguments.length;for(i=0;i<p;i++)if(o=t.arguments[i],(r=a(e,o,n))!==o){f=[],f[i]=r;break}if(f){for(i=0;i<p;i++)o=t.arguments[i],f[i]!==A&&f[i]!==k||(f[i]=a(e,o,n));s=L(t.function,f)}}return s}function p(e,t,n,r,o){return d(e,r,o)}function h(e,t,n,r,o){var i,a,s,l,u=!!r.source,c=u?r.source:e,f=r.rowRelative,d=r.columnRelative,p=o._rowOffset(),h=o._colOffset();if((t>=0||!f)&&(n>=0||!d)){if(i=r.row+(f?t:0),a=r.column+(d?n:0),l=o._destinationContains(e,t,n,1,1),c===o._toModel&&o._destinationContains(c,i,a,1,1)&&!o._sourceContains(c,i,a,1,1)&&(!f&&!d||!l))return V;if(s=(u&&c===o._fromModel||!u&&e===o._fromModel)&&(!l&&o._sourceContains(o._fromModel,i,a,1,1)||l&&o._destinationContains(o._toModel,i,a,1,1)),l&&(i-=f?p:0,a-=d?h:0),s&&(i+=p,a+=h),i-=f?t:0,a-=d?n:0,o._fromModel===o._toModel?c=u?r.source:A:(c=A,s&&l&&u?c=o._toModel:s&&l||(s?c=o._toModel:l&&!u&&(c=o._fromModel))),i!==r.row||a!==r.column||c!==r.source)return O(c,k,i,a,f,d)}else if((t>=0||!f)&&-1===n){if(i=r.row+(f?t:0),o._destinationContains(e,t,n,1,1)&&(i-=f?p:0),o._sourceContains(c,i,-1,f,-1))i+=p;else if(o._destinationContains(c,i,-1,1,-1))return V;if((i-=f?t:0)!==r.row)return O(r.source,k,i,r.column,f,r.columnRelative)}else if(-1===t&&n>=0&&!d){if(a=r.column+(d?n:0),o._destinationContains(e,t,n,1,1)&&(a-=d?h:0),o._sourceContains(c,i,a,1,1))a+=h;else if(o._destinationContains(c,i,a,1,1))return V;if(a-=d?n:0,i!==r.row||a!==r.column)return O(r.source,r.endSource,r.row,a,r.rowRelative,d)}return r}function m(e,t,n,r,o){var i,a,s,l,u,c,f,d,p,h,m,g,_,v,y,b,w,C,S=!!r.source,x=S?r.source:e,T=r._getRangeType(),E=o._rowOffset(),M=o._colOffset();if(0===T)if(i=r.rowRelative,a=r.columnRelative,s=r.endRowRelative,l=r.endColumnRelative,t>=0||!i||!s||n>=0||!a||!l){if(u=r.row+(i?t:0),c=r.endRow+(s?t:0),f=r.column+(a?n:0),d=r.endColumn+(l?n:0),p=c-u+1,h=d-f+1,C=o._destinationContains(e,t,n,1,1)){var R=o._toRow-o._toColumn,I=o._toColumn-o._toRow;p+=(i?-R:0)+(s?R:0),h+=(a?-I:0)+(l?I:0)}if(x===o._toModel&&o._destinationContains(x,u,f,p,h)&&!h&&(!i&&!a&&!s&&!l||!C))return V;w=(S&&x===o._fromModel||!S&&e===o._fromModel)&&(!C&&o._sourceContains(o._fromModel,u,f,p,h)||C&&o._destinationContains(o._toModel,u,f,p,h)),C&&(_=i?E:0,v=s?E:0,y=a?M:0,b=l?M:0,u-=_,c-=v,f-=y,d-=b);var O=!1;if(w)m=E,g=M,u+=m,c+=m,f+=g,d+=g;else if(o._destinationContains(x,u,f,p,h)){var P=o.intersectWith(x,u,f,p,h);if(!P||P.rowCount!==p&&P.colCount!==h)return V;u=P.row+E,f=P.col+M,c=u+P.rowCount,d=f+P.colCount,O=!0}if(u-=i?t:0,c-=s?t:0,f-=a?n:0,d-=l?n:0,o._fromModel===o._toModel?x=S?r.source:A:(x=A,w&&C&&S?x=o._toModel:w&&C||(w?x=o._toModel:C&&!S&&(x=o._fromModel))),u!==r.row||f!==r.column||c!==r.endRow||d!==r.endColumn||O||x!==r.source)return D(x,k,u,f,c,d,i,a,s,l)}else if(!(t>=0)&&i&&s||-1!==n){if(-1===t&&(n>=0||!a||!l)){if(f=r.column+(a?n:0),d=r.endColumn+(l?n:0),f>d)return V;if(o._destinationContains(e,t,n,1,1)&&(y=a?M:0,b=l?M:0,f-=y,d-=b),h=d-f,o._sourceContains(x,-1,f,-1,h))g=M,f+=g,d+=g;else if(o._destinationContains(x,-1,f,-1,h))return V;if(f-=a?n:0,d-=l?n:0,f!==r.column||d!==r.endColumn)return D(r.source,k,r.row,f,r.endRow,d,r.rowRelative,a,r.endRowRelative,l)}}else{if(u=r.row+(i?t:0),c=r.endRow+(s?t:0),u>c)return V;if(o._destinationContains(e,t,n,1,1)&&(_=i?E:0,v=s?E:0,u-=_,c-=v),p=c-u,o._sourceContains(x,u,-1,p,-1))m=E,u+=m,c+=m;else if(o._destinationContains(x,u,-1,p,-1))return V;if(u-=i?t:0,c-=s?t:0,u!==r.row||c!==r.endRow)return D(r.source,k,u,r.column,c,r.endColumn,i,r.columnRelative,s,r.endColumnRelative)}else if(1===T){if(i=r.rowRelative,s=r.endRowRelative,t>=0||!i||!s){if(u=r.row+(i?t:0),c=r.endRow+(s?t:0),u>c)return V;if(o._destinationContains(e,t,n,1,1)&&(_=i?E:0,v=s?E:0,u-=_,c-=v),p=c-u,o._sourceContains(x,u,-1,p,-1))m=E,u+=m,c+=m;else if(o._destinationContains(x,u,-1,p,-1))return V;if(u-=i?t:0,c-=s?t:0,u!==r.row||c!==r.endRow)return D(r.source,r.endSource,u,j,c,j,i,!1,s,!1)}}else if(2===T){if(a=r.columnRelative,l=r.endColumnRelative,f=r.column+(a?n:0),d=r.endColumn+(l?n:0),f<d)return V;if(o._destinationContains(e,t,n,1,1)&&(y=a?M:0,b=l?M:0,f-=y,d-=b),h=d-f,o._sourceContains(x,-1,f,-1,h))g=M,f+=g,d+=g;else if(o._destinationContains(x,-1,f,-1,h))return V;if(f-=a?n:0,d-=l?n:0,f!==r.column||d!==r.endColumn)return D(r.source,r.endSource,j,f,j,d,!1,a,!1,l)}return r}function g(e,t,n,r,o,i){var a,s=g,l=r;if(1===r.type&&r._isCell)l=i?h(e,t,n,r,o):v(e,t,n,r,o);else if(1===r.type)l=i?m(e,t,n,r,o):y(e,t,n,r,o);else if(10===r.type)(a=s(e,t,n,r.value,o,i))!==r.value&&(l=N(a));else if(9===r.type){var u=s(e,t,n,r.value,o,i),c=r.value2&&s(e,t,n,r.value2,o,i);u===r.value&&c===r.value2||(l=F(r.operatorType,u,c))}else if(7===r.type){var f,d,p=k,_=r.arguments.length;for(d=0;d<_;d++)if(f=r.arguments[d],(a=s(e,t,n,f,o,i))!==f){p=[],p[d]=a;break}if(p){for(d=0;d<_;d++)f=r.arguments[d],p[d]!==A&&p[d]!==k||(p[d]=s(e,t,n,f,o,i));l=L(r.function,p)}}return l}function _(e,t){var r=e._fromModel._getCalcServiceInternal(),o=n(2),i=o&&o._DataValidatorCache;if(i){var a,s,l,u,c,f=i._getAllValidators(),d=0,p=0;(0===e._fromRow&&0===e._fromColumn||0===e._toRow||0===e._toColumn)&&(d=e._rowCount,p=e._columnCount,d>=e._toRow&&d<e._toRow+e._rowCount&&p>=e._toColumn&&p<e._toColumn+e._columnCount?d=e._toRow+e._rowCount:d>=e._fromRow&&d<e._fromRow+e._rowCount&&p>=e._fromColumn&&p<e._fromColumn+e._columnCount&&(d=e._fromRow+e._rowCount));for(var h=0;h<f.length;h++){a=f[h].validator,c=f[h].sheet;var m=c._getSheetSource();if(s=a.condition(),(l=s.getFormulas())&&l.length>0){for(var _=0;_<l.length;_++){u=l[_];var v=r.parse(e._fromModel,u,d,p),y=g(m,d,p,v,e,t);if(v!==y){var b=r.unparse(e._fromModel,y,d,p);l[_]=b}}s.setFormulas(l)}}}}function v(e,t,n,r,o){var i,a,s=r.source||e,l=r.rowRelative,u=r.columnRelative,c=o._rowOffset(),f=o._colOffset();if((t>=0||!l)&&(n>=0||!u)){if(i=r.row+(l?t:0),a=r.column+(u?n:0),o._destinationContains(e,t,n,1,1)?(i-=l?c:0,a-=u?f:0):o._sourceContains(e,i,a,1,1)&&(i+=l?c:0,a+=u?f:0),o._sourceContains(s,i,a,1,1)?(i+=c,a+=f):o._destinationContains(s,i,a,1,1)&&(i-=c,a-=f),i-=l?t:0,a-=u?n:0,i!==r.row||a!==r.column)return O(r.source,k,i,a,l,u)}else if((t>=0||!l)&&-1===n){if(i=r.row+(l?t:0),o._destinationContains(e,t,-1,1,-1)?i-=l?c:0:o._sourceContains(e,i,-1,1,-1)&&(i+=l?c:0),o._sourceContains(s,i,-1,1,-1)?i+=c:o._destinationContains(s,i,-1,1,-1)&&(i-=c),(i-=l?t:0)!==r.row||a!==r.column)return O(r.source,k,i,r.column,l,r.columnRelative)}else if(-1===t&&n>=0&&!u&&(a=r.column+(u?n:0),o._destinationContains(e,-1,n,-1,1)?a-=u?f:0:o._sourceContains(e,-1,a,-1,1)&&(a+=u?f:0),o._sourceContains(s,-1,a,-1,1)?a+=f:o._destinationContains(s,-1,a,-1,1)&&(a-=f),a-=u?n:0,i!==r.row||a!==r.column))return O(r.source,k,r.row,a,r.rowRelative,u);return r}function y(e,t,n,r,o){var i,a,s,l,u,c,f,d,p,h,m,g,_,v,y,b,w=r.source||e,C=r._getRangeType(),S=o._rowOffset(),x=o._colOffset();if(0===C){if(f=r.rowRelative,d=r.columnRelative,p=r.endRowRelative,h=r.endColumnRelative,!(t>=0)&&f&&p||!(n>=0)&&d&&h)if(!(t>=0)&&f&&p||-1!==n){if(-1===t&&(n>=0||!d||!h)){if(s=r.column+(d?n:0),l=r.endColumn+(h?n:0),s<l)return V;if(o._destinationContains(e,-1,n,-1,1)?(v=d?x:0,b=h?x:0,s-=v,l-=b):o._sourceContains(e,-1,n,-1,1)&&(v=d?x:0,b=h?x:0,s+=v,l+=b),c=l-s,o._sourceContains(w,-1,s,-1,c)?(g=x,s+=g,l+=g):o._destinationContains(w,-1,s,-1,c)&&(g=x,s-=g,l-=g),s-=d?n:0,l-=h?n:0,s!==r.column||l!==r.endColumn)return D(r.source,k,s,r.endRow,l,r.rowRelative,d,r.endRowRelative,h)}}else{if(i=r.row+(f?t:0),a=r.endRow+(p?t:0),i<a)return V;if(o._destinationContains(e,t,-1,1,-1)?(_=f?S:0,y=f?S:0,i-=_,a-=y):o._sourceContains(e,t,-1,1,-1)&&(_=f?S:0,y=f?S:0,i+=_,a+=y),u=a-i,o._sourceContains(w,i,-1,u,-1)?(m=S,i+=m,a+=m):o._destinationContains(w,i,-1,u,-1)&&(m=S,i-=m,a-=m),i-=f?t:0,a-=p?t:0,i!==r.row||a!==r.endRow)return D(r.source,k,i,r.column,a,r.endColumn,f,r.columnRelative,p,r.endColumnRelative)}else if(i=r.row+(f?t:0),a=r.endRow+(p?t:0),s=r.column+(d?n:0),l=r.endColumn+(h?n:0),u=a-i,c=l-s,o._destinationContains(e,t,n,1,1)?(_=f?S:0,v=d?x:0,y=p?S:0,b=h?x:0,i-=_,a-=y,s-=v,l-=b):o._sourceContains(e,i,s,u,c)&&(_=f?S:0,v=d?x:0,y=p?S:0,b=h?x:0,i+=_,a+=y,s+=v,l+=b),o._sourceContains(w,i,s,u,c)?(m=S,g=x,i+=m,a+=m,s+=g,l+=g):o._destinationContains(w,i,s,u,c)&&(m=S,g=x,i-=m,a-=m,s-=g,l-=g),i-=f?t:0,a-=p?t:0,s-=d?n:0,l-=h?n:0,i!==r.row||s!==r.column||a!==r.endRow||l!==r.endColumn)return D(r.source,k,i,s,a,l,f,d,p,h)}else if(1===C){if(f=r.rowRelative,p=r.endRowRelative,t>=0||!f||!p){if(i=r.row+(f?t:0),a=r.endRow+(p?t:0),i<a)return V;if(o._destinationContains(e,t,-1,1,-1)?(_=f?S:0,y=p?S:0,i-=_,a-=y):o._sourceContains(e,t,-1,1,-1)&&(_=f?S:0,y=p?S:0,i+=_,a+=y),u=a-i,o._sourceContains(w,i,-1,u,-1)?(m=S,i+=m,a+=m):o._destinationContains(w,i,-1,u,-1)&&(m=S,i-=m,a-=m),i-=f?t:0,a-=p?t:0,i!==r.row||a!==r.endRow)return D(r.source,k,i,j,a,j,f,!1,p,!1)}}else if(2===C){if(d=r.columnRelative,h=r.endColumnRelative,s=r.column+(d?n:0),l=r.endColumn+(h?n:0),s>l)return V;if(o._destinationContains(e,-1,n,-1,1)?(v=d?x:0,b=h?x:0,s-=v,l-=b):o._sourceContains(e,-1,n,-1,1)&&(v=d?x:0,b=h?x:0,s+=v,l+=b),c=l-s,o._sourceContains(w,-1,s,-1,c)?(g=x,s+=g,l+=g):o._destinationContains(w,-1,s,-1,c)&&(g=x,s-=g,l-=g),s-=d?n:0,l-=h?n:0,s!==r.column||l!==r.endColumn)return D(r.source,k,j,s,j,l,!1,d,!1,h)}return r}function b(e,t,n,r,o){e._addDependents(t,n,r,o,!0,!1)}function w(e,t,n){var r,o,i,a=w,s=t;if(8===t.type){if(t.value===n&&(!t.source||t.source===e.getSource()))return P(H,t.source)}else if(10===t.type)(r=a(e,t.value,n))!==t.value&&(s=N(r));else if(9===t.type){var l=a(e,t.value,n),u=t.value2&&a(e,t.value2,n);l===t.value&&u===t.value2||(s=F(t.operatorType,l,u))}else if(7===t.type){var c=k,f=t.arguments.length;for(i=0;i<f;i++)if(o=t.arguments[i],(r=a(e,o,n))!==o){c=[],c[i]=r;break}if(c){for(i=0;i<f;i++)o=t.arguments[i],c[i]!==A&&c[i]!==k||(c[i]=a(e,o,n));s=L(t.function,c)}}return s}function C(e,t){t||(t=this);var n=E(e.row,t.row),r=E(e.column,t.col),o=T(e.row+e.rowCount,t.row+t.rowCount),i=T(e.column+e.colCount,t.col+t.colCount);return n>=o||r>=i?k:{row:n,col:r,rowCount:o-n,colCount:i-r,intersectWith:C}}var S=n(5),x=S.Errors,T=Math.min,E=Math.max,M=S._createRange,A=void 0,k=null,R=S.Convert,I=R._isError,O=S._createCellExpression,D=S._createRangeExpression,P=S._createErrorExpression,N=S._createParenthesesExpression,F=S._createOperatorExpression,L=S._createFunctionExpression,H=x.Reference,V=S._referenceErrorExpr,j=S.BAND_INDEX_CONST,B=S.CalcOperatorAdjustor=function(){function e(){}return e._copyExpression=function(t,n,r,o,i){var a=t,s=e,l=s._copyExpression;if(!t)return a;var u=S.MAX_ROW_COUNT,c=S.MAX_COLUMN_COUNT;if(10===t.type)a=S._createParenthesesExpression(l.call(s,t.value,n,r,o,i));else if(1===t.type&&t._isCell){if(t.rowRelative&&(t.row+n<0||t.row+n>u)||t.columnRelative&&(t.column+r<0||t.column+r>c))return P(H,t.source);a=t.offset(0,0,!1)}else if(1===t.type){var f=t;if(f.rowRelative&&(f.row+n<0||f.row+n>u)||f.columnRelative&&(f.column+r<0||f.column+r>c)||f.endRowRelative&&(f.endRow+n<0||f.endRow+n>u)||f.endColumnRelative&&(f.endColumn+r<0||f.endColumn+r>c))return P(H,t.source,t.endSource);a=t.offset(0,0,!1)}else if(9===t.type)a=S._createOperatorExpression(t.operatorType,l.call(s,t.value,n,r,o,i),t.value2&&l.call(s,t.value2,n,r,o,i));else if(7===t.type){var d=[];if(t.arguments&&t.arguments.length>0)for(var p=0;p<t.arguments.length;p++)d[p]=l.call(s,t.arguments[p],n,r,o,i);a=S._createFunctionExpression(t.function,d)}else 13===t.type&&(a=t.offsetWhenCopy(o,i));return a},e.copyFormula=function(t,n,r,o,i,a,s,l,u){var c=t,f=o,d=t.getSource(),p=o.getSource(),h=e;if(c&&f){var m,g={},_=n,v=r,y=i,b=a,w=s,C=l;n<0&&(_=0,w=T(t.rC(),o.rC())),r<0&&(v=0,C=T(t.cC(),o.cC())),i<0&&(y=0),a<0&&(b=0),c&&c._unlinkCellExpression(y,b,w,C);var x,E,M=new S.CalcSourceModel(t._getCalcServiceInternal(),d);for(x=0;x<w;x++)for(E=0;E<C;E++){c._copyExpr(M,x+_,E+v,x,E);var k=t.getSource().getSheet()._getStyleObject(x+y,E+b);k&&k.validator&&(m=k.validator.condition())&&m.getFormulas&&m.getFormulas().length>0&&(g[k.validator.id]=m)}var R={},I=o._getCalcServiceInternal();for(x=0;x<w;x++)if(!u||!p.isHiddenRow(x+y)){var O=x+y;for(E=0;E<C;E++){var D=E+b,P=M._getExpr(x,E);if(P){if(P===R)continue;P=h._copyExpression(M._getExpr(x,E),O,D,i-n,a-r);var N=M._getArrayInfo(x,E);if(p)if(N){for(var F=w-x<N.rowCount?w-x:N.rowCount,L=C-E<N.colCount?C-E:N.colCount,H=0;H<F;H++)for(var V=0;V<L;V++)M._setExpr(x+H,E+V,P);o.setArrayFormula(O,D,F,L,I.unparse(p,P,O,D))}else{var j=P?I.unparse(p,P,O,D):A;p.setFormula(O,D,j);var B=M._getWorkingExpr(x,E);if(B){B=h._copyExpression(B,O,D,i-n,a-r);var U=new S.EvaluateContext(p,S._createCellIdentity(O,D),!1);B=S._mappingArray(U,P,!1,0,0),B=B===P?A:B}f._setCellExpression(O,D,P,B,N)}else f._setExpr(x+y,E+b,P),f._setArrayInfo(x+y,E+b,N)}else f&&f.getExpression(O,D)&&f._clearAllExpr(O,D)}}for(var W in g){m=g[W];var z=m.getFormulas();for(H=0;H<z.length;H++)j=z[H],P=I.parse(t.getSource(),j,_,v),j=I.unparse(t.getSource(),P,y,b),z[H]=j;m.setFormulas(z)}}},e.moveFormula=function(e,t,n,r,o,i,a,s){var l=e._getCalcModel(),u=r._getCalcModel(),c=l._getCalcServiceInternal();if(l&&u){var f=c._getOperatorAdjustor();t<0&&(t=0,a=T(e.getRowCount(),r.getRowCount())),o<0&&(o=0),n<0&&(n=0,s=T(e.getColumnCount(),r.getColumnCount())),i<0&&(i=0);var d=!(e===r&&e._name===r._name);l._unlinkCellExpression(t,n,a,s),b(l,t,n,a,s),u._unlinkCellExpression(o,i,a,s),b(u,o,i,a,s);var p,h,m=[];for(p=0;p<a;p++)for(h=0;h<s;h++){var g=l._getExpr(p+t,h+n),_=l._getArrayInfo(p+t,h+n),v=l._getWorkingExpr(p+t,h+n);g?(m.push({_expr:g,_arrayInfo:_,_workingExpr:v}),l._clearAllExpr(p+t,h+n)):m.push(k)}var y;for(p=0;p<a;p++)for(h=0;h<s;h++){var w=m.shift();w?(g=w._expr,_=w._arrayInfo,c&&_&&_.row===t+p&&_.col===n+h&&(y=M(p+o,h+i,_.rowCount,_.colCount)),_&&(_.row=p+o,_.col=h+i),u._setExpr(p+o,h+i,g),u._setArrayInfo(p+o,h+i,_?y:A),u._setWorkingExpr(p+o,h+i,w._workingExpr)):(u._setExpr(p+o,h+i,A),u._setArrayInfo(p+o,h+i,A))}f._addCellsToAdjust(l,t,n,a,s),f._addCellsToAdjust(u,o,i,a,s),f._adjustFormulasOnMoveSwap(l.getSource(),t,n,u.getSource(),o,i,a,s,!0),!0===d&&f._adjustFormulasOnMoveSwap(l.getSource(),t,n,u.getSource(),o,i,a,s,!0)}},e}();B.prototype={isAdjustCell:function(e){return e.preAdj||e===this._head},isAdjust:function(e){return e.preAdj||e===this._head},_addAdjust:function(e,t){var n,r,o=this;if(0===t)n=o._head,r=o._tail;else if(1===t)n=o._headRows,r=o._tailRows;else if(2===t)n=o._headCols,r=o._tailCols;else{if(3!==t)return;n=o._headNamIDs,r=o._tailNameIDs}e&&!e.preAdj&&e!==n&&(n?r.nextAdj=e:0===t?o._head=e:1===t?o._headRows=e:2===t?o._headCols=e:o._headNamIDs=e,e.preAdj=r,e.nextAdj=k,0===t?o._tail=e:1===t?o._tailRows=e:2===t?o._tailCols=e:o._tailNameIDs=e)},_removeAdjust:function(e,t){var n,r=this;if(0===t)n=r._head;else if(1===t)n=r._headRows;else if(2===t)n=r._headCols;else{if(3!==t)return;n=r._headNamIDs}if(e&&(e.preAdj||e===n)){var o=e.preAdj,i=e.nextAdj;o?o.nextAdj=i:0===t?r._head=i:1===t?r._headRows=i:2===t?r._headCols=i:r._headNamIDs=i,i?i.preAdj=o:0===t?r._tail=o:1===t?r._tailRows=o:2===t?r._tailCols=o:r._tailNameIDs=o,e.preAdj=k,e.nextAdj=k}},_adjustFormulasOnAddRemove:function(e,t,n,r,o){this._adjustFormulasOnOperator(e,s,t,n,r,o);var i=0,a=0,u=0,c=0;0===t&&(r&&o?u=n:r&&!o?i=n:!r&&o?c=n:a=n),l(e,s,t,n,i,a,u,c,r,o)},_adjustFormulasOnOperator:function(e,t,n,r,o,i){for(var a,s,l,u,c=this,f={};c._head;){a=c._head._sourceModel;var d=a.getSource();if(s=c._head.row,l=c._head.column,f[s]&&f[s][l])c._removeAdjust(c._head,0);else{if(u=a._getExpr(s,l)){u=t.call(c,d,s,l,u,e,n,r,o,i);var p=a._getArrayInfo(s,l);if(p){p=M(s,l,p.rowCount,p.colCount);for(var h=s;h<s+p.rowCount;h++){f[h]||(f[h]={});for(var m=l;m<l+p.colCount;m++)a._setExpression(h,m,u,p,h===s&&m===l),f[h][m]=!0}}else a._setExpression(s,l,u,p,!0)}else(a.getRowExpression&&a.getRowExpression(s)||a.getColumnExpression&&a.getColumnExpression(l))&&a._addCellsToDirty(s,l,1,1);c._removeAdjust(c._head,0)}}for(;c._headRows;)a=c._headRows._sourceModel,s=c._headRows.row,a.getRowExpression&&(u=a.getRowExpression(s))&&a._setExpression&&a._setExpression(s,-1,t.call(c,d,s,-1,u,e,n,r,o,i),A,!0),c._removeAdjust(c._headRows,1);for(;c._headCols;)a=c._headCols._sourceModel,l=c._headCols.column,a.getColumnExpression&&(u=a.getColumnExpression(l))&&a._setExpression&&a._setExpression(-1,l,t.call(c,d,-1,l,u,e,n,r,o,i),A,!0),c._removeAdjust(c._headCols,2)},_adjustFormulasOnRemoveSheet:function(e){var t=this;b(e.getCalcSourceModel(),0,0,e.getRowCount(),e.getColumnCount()),t._adjustFormulasOnOperator(e,p),l(e,p,0,0,0,0,0,0,!0,!1)},_adjustFormulasOnMoveSwap:function(e,t,n,r,o,i,a,s,l){var u,c,f,d,p=this,h=g,m=new W(e,t,n,r,o,i,a,s),v={};for(_(m,l);p._head;)if(u=p._head._sourceModel,c=p._head.row,f=p._head.column,v[c]&&v[c][f])p._removeAdjust(p._head,0);else{if(d=u.getExpression(c,f)){d=h.call(p,u.getSource(),c,f,d,m,l);var y=u._getArrayInfo(c,f);if(y){y=M(c,f,y.rowCount,y.colCount);for(var b=c;b<c+y.rowCount;b++){v[b]||(v[b]={});for(var w=f;w<f+y.colCount;w++)u._setExpression(b,w,d,y,b===c&&w===f),v[b][w]=!0}}else u._setExpression(c,f,d,y,!0)}else(u.getRowExpression&&u.getRowExpression(c)||u.getColumnExpression&&u.getColumnExpression(f))&&u._addCellsToDirty(c,f,1,1);p._removeAdjust(p._head,0)}for(;p._headRows;)u=p._headRows._sourceModel,c=p._headRows.row,u.getRowExpression&&(d=u.getRowExpression(c))&&u._setRowExpression&&u._setRowExpression(c,h.call(p,u.getSource(),c,-1,d,m,l),A),p._removeAdjust(p._headRows,1);for(;p._headCols;)u=p._headCols._sourceModel,f=p._headCols.column,u.getColumnExpression&&(d=u.getColumnExpression(f))&&u._setColumnExpression&&u._setColumnExpression(f,h.call(p,u.getSource(),-1,f,d,m,l),A),p._removeAdjust(p._headCols,2)},_addCellsToAdjust:function(e,t,n,r,o){for(var i,a,s=this,l=t+r,u=n+o,c=t;c<l;c++)for(var f=n;f<u;f++)if(i=e._getCalc(c,f),a=e._getExpr(c,f),i||a){e._removeCalc(c,f,0);var d=e._getCellCalc(c,f,!0);s._addAdjust(d,0)}},_addColumnsToAdjust:function(e,t,n){for(var r=this,o=t;-1!==o&&o<t+n;o++)if(e._getCalc(-1,o)||e._getExpr(-1,o)){e._removeCalc(-1,o,2);var i=e._getColumnCalc(o,!0);r._addAdjust(i,2)}},_addRowsToAdjust:function(e,t,n){for(var r=this,o=t;-1!==o&&o<t+n;o++)if(e._getCalc(o,-1)||e._getExpr(o,-1)){e._removeCalc(o,-1,1);var i=e._getRowCalc(o,!0);r._addAdjust(i,1)}},_addVolatitleToAdjust:function(e){for(var t,n,r,o=this,i=e._getCalcServiceInternal().getAllSouceModels(),a=0;a<i.length;a++){t=i[a],n=t._getAllVolatitles();for(var s=0;s<n.length;s++)(r=n[s])&&r.isVolatile&&r instanceof S.CellCalc&&!o.isAdjustCell(r)&&o._addAdjust(r,0)}},onBeforeAddRemoveRows:function(e,t){var n=e.rC(),r=e.cC();e._unlinkCellExpression(t,0,n-t,r),e._unlinkRowExpression(t,n-t),b(e,t,-1,n-t,-1)},onAfterAddRemoveRows:function(e,t,n,r){var o=this,i=e.rC(),a=e.cC();r?e._addCellsToDirty(t,0,n,a):i+=n,o._addCellsToAdjust(e,t,0,i-t,a),o._addRowsToAdjust(e,t,i-t),o._addVolatitleToAdjust(e),o._adjustFormulasOnAddRemove(e.getSource(),t,n,!0,r),e._getCalcServiceInternal().autoCalculation&&e._getCalcServiceInternal().recalculateAll(!1)},onAfterAddRemoveColumns:function(e,t,n,r){var o=this,i=e.rC(),a=e.cC();r?e._addCellsToDirty(0,t,i,n):a+=n,o._addCellsToAdjust(e,0,t,i,a-t),o._addColumnsToAdjust(e,t,a-t),o._addVolatitleToAdjust(e),o._adjustFormulasOnAddRemove(e.getSource(),t,n,!1,r),e._getCalcServiceInternal().autoCalculation&&e._getCalcServiceInternal().recalculateAll(!1)},onBeforeAddRemoveColumns:function(e,t){var n=e.rC(),r=e.cC();e._unlinkCellExpression(0,t,n,r-t),e._unlinkColumnExpression(t,r-t),b(e,-1,t,-1,r-t)},onAfterRemoveName:function(e,t){var n=e._getNameCalc(t,!1);n&&(n.updateListening(!0,!1),n._addToDirty(),n.updateListeningOnRemoved())},adjustFormulaOnRemoveName:function(e,t,n){return w(e,t,n)},invalidName:function(e,t){if(t){var n=e.getCalcSourceModel(),r=n._getNameCalc(t.toUpperCase(),!0);r&&r._addListenersToAdjust()}},onAfterRemoveTable:function(e,t){for(var n,r,o,i,a=this,s=0;s<e.length;s++){var l=e[s];b(l.source().getCalcSourceModel(),l.startRow(),l.startColumn(),l.endRow()-l.startRow()+1,l.endColumn()-l.startColumn()+1)}for(var u={};a._head;)if(n=a._head._sourceModel,r=a._head.row,o=a._head.column,u[r]&&u[r][o])a._removeAdjust(a._head,0);else{if(i=n._getExpr(r,o)){i=U(i,e,r,o,t);var c=n._getArrayInfo(r,o);if(c){c=M(r,o,c.rowCount,c.colCount);for(var f=r;f<r+c.rowCount;f++){u[f]||(u[f]={});for(var d=o;d<o+c.colCount;d++)n._setExpression(f,d,i,c,f===r&&d===o),u[f][d]=!0}}else n._setExpression(r,o,i,c,!0)}else(n.getRowExpression&&n.getRowExpression(r)||n.getColumnExpression&&n.getColumnExpression(o))&&n._addCellsToDirty(r,o,1,1);a._removeAdjust(a._head,0)}},_adjustFormulasOnChangeReferenceStyle:function(e){var t,n=e._getCalcServiceInternal(),r=function(e,t,r,o){n.useR1C1=!n.useR1C1;var i=n.parse(e,t,r,o);return n.useR1C1=!n.useR1C1,n.unparse(e,i,r,o)};for(u(r),t=0;t<e.sheets.length;t++)for(var o=e.sheets[t],i=o._getSheetSource(),a=o.conditionalFormats._getAllRules(),s=0;s<a.length;s++){var l=a[s];l.initCondition();for(var c=l.condition(),f=l.ranges(),d=f[0].row,p=f[0].col,h=1;h<f.length;h++)d=d>f[h].row?f[h].row:d,p=p>f[h].col?f[h].row:p;var m=c&&c.getFormulas();if(m&&m.length>0){for(var g=0;g<m.length;g++){var _=m[g];m[g]=r(i,_,d,p)}c.setFormulas(m)}}}};var U=B.adjustExpressionOnRemoveTable=function(e,t,n,r,o){var i=U;if(9===e.type){var a=e.value,s=e.value2,l=i(a,t,n,r,o),u=s&&i(s,t,n,r,o);if(a!==l||s!==u)return S._createOperatorExpression(e.operatorType,l,u)}else if(7===e.type){for(var c=!1,f=[],d=0;d<e.arguments.length;d++){var p=e.arguments[d],h=i(p,t,n,r,o);c=c||p!==h,f.push(h)}if(c)return S._createFunctionExpression(e.function,f)}else if(10===e.type){var m=e,g=m.value,_=i(g,t,n,r,o);if(g!==_)return S._createParenthesesExpression(_)}else if(13===e.type){var v=e;for(d=0;d<t.length;d++)if(v.baseTable()===t[d]){if(o)return S._referenceErrorExpr;var y=v.getRange(0,0,!0),b=-1===n||1===v.referencePortions(),w=1===y.rowCount&&1===y.columnCount,C=v.source();return w?S._createCellExpression(C,k,y.row,y.col,b,!1):new S._createRangeExpression(C,k,y.row,y.col,y.row+y.rowCount-1,y.col+y.colCount-1,b,!1,b,!1)}}return e},W=function(){function e(e,t,n,r,o,i,a,s){var l=this;l._fromModel=e,l._fromRow=t,l._fromColumn=n,l._toModel=r,l._toRow=o,l._toColumn=i,l._rowCount=a,l._columnCount=s}return e}();W.prototype={_rowOffset:function(){return this._toRow-this._fromRow},_colOffset:function(){return this._toColumn-this._fromColumn},_sourceContains:function(e,t,n,r,o){var i=this;return i._fromModel===e&&(-1===i._fromRow||i._fromRow<=t&&t+r<=i._fromRow+i._rowCount)&&(-1===i._fromColumn||i._fromColumn<=n&&n+o<=i._fromColumn+i._columnCount)},_destinationContains:function(e,t,n,r,o){var i=this;return i._toModel===e&&(-1===i._toRow||i._toRow<=t&&t+r<=i._toRow+i._rowCount)&&(-1===i._toColumn||i._toColumn<=n&&n+o<=i._toColumn+i._columnCount)},intersectWith:function(e,t,n,r,o){var i=this;if(i._toModel!==e)return k;var a=i._createValidCellRange(e,t,n,r,o);return i._createValidCellRange(e,i._fromRow,i._fromColumn,r,o).intersectWith(a)},_createValidCellRange:function(e,t,n,r,o){var i=-1===t?0:t,a=-1===t||-1===r?e.rowCount:r;return{row:i,column:-1===n?0:n,rowCount:a,columnCount:-1===n||-1===o?e.colCount:o,intersectWith:C}}}},function(e,t,n){var r=n(4).GC$,o=n(6).Worksheet,i=n(9).Style,a=n(3);r.extend(o.prototype,{getFormatter:function(e,t,n){return this._getStyleProperty(e,t,"formatter",n)},setFormatter:function(e,t,n,r){var o=this._getStyleImp(e,t,r);o||(o=new i),o.formatter=n,this.setStyle(e,t,o,r)}}),o._registerFeature("formatter",{settingText:function(e){var t=a._util._isStringNumber(e.value),r=n(10),o=r&&r.GeneralFormatter;if(o&&t){var i={};(new o).getPreferredDisplayFormatter(e.value,i),"number"==typeof i.value&&(e.value=i.value)}}})},function(e,t,n){function r(e,t,n){var r,a=this,s=a._eventHandler,l=a._editor,c=a._name,p=a._activeRowIndex,m=a._activeColIndex,g=a.getCellType(p,m),_={sheet:a,row:p,col:m,sheetArea:3};if(g.isImeAware(_)||s._changeFocusHolder(),l&&l.parentNode){var v=g.getEditorValue(l,_),y={sheet:a,sheetName:c,row:p,col:m,editor:l,editingText:v,cancel:!1};if(a._trigger(f.EditEnd,y),y.cancel)return;if(a._trigger(f.EditEnding,y),y.cancel)return;var b=a.parent,w=b&&b._attachedFormulaTextBox;if(document.activeElement===(w&&w._host)&&s._changeFocusHolder(),p>=0&&m>=0){var C=l._oldValue;if(g.isEditingValueChanged(C,v,_)||1===t)if(e)g.setEditorValue(l,C,_),g.selectAll(l,_);else{var S=g._autoFormatValue;d(S)&&(S=!0);var x={cmd:"editCell",sheetName:c,row:p,col:m,newValue:v,autoFormat:S};if(1===t&&(x.ranges=[a._getActiveSelectedRange()],x.endEditType=t),a._commandManager().execute(x),2===(r=x.applyResult))return g.focus(l,_),!1}}if(a._dirty=!0,g.deactivateEditor(l,_),g.isImeAware(_))u.msie&&9===parseFloat(u.version)?s._changeFocusHolder():i(l.parentNode.parentNode).css({width:0,height:0,overflow:"hidden",border:"none"});else for(var T=a._getHost(),E=l;E;)E.parentNode===T?T.removeChild(E):E=E.parentNode}a._editingTimeValue=!1;var M={sheet:a,sheetName:c,row:p,col:m,editingText:v},A=i.extend({},M);if(a._trigger(f.EditEnded,M),a._trigger(f.FormulatextboxEditEnded,A),!0!==n&&A.ignore)return!1;if(0!==a._editorStatus){var k=a._editorStatus;a._editorStatus=0,a._raiseEditorStatusChanged(k,0)}return o._callFeatureHandler(a,"endEdit"),a._editor=h,1!==r}var t=n(2),o=n(6).Worksheet,i=n(4).GC$,a=n(3),s=n(0),l=a._util,u=l._browser,c=l._device(),f=a.Events,d=s._Types._isNullOrUndefined,p=a._FocusHelper,h=null,m=void 0;t.EditorStatus={ready:0,enter:1,edit:2};var g={startEdit:function(e,t){var n=this;n._startEditImp(n._getCanvas(),n._activeRowIndex,n._activeColIndex,h,h,e,t)},editorStatus:function(){return this._editorStatus||0},isEditing:function(){var e=this._editorStatus;return 1===e||2===e},endEdit:function(e){return this._endEditImp(e)},_endEditImp:function(e,t,n){var o=this;if(!o.isEditing())return!0;o.suspendPaint();try{return r.call(o,e,t,n)}finally{o.resumePaint()}},_doStartEdit:function(e,t,n){var r=this,o=r.hitTest(t,n);if(o){var i=o.row,a=o.col;if(i>=0&&a>=0&&o.rowViewportIndex>=0&&o.colViewportIndex>=0&&!o.resizeInfo&&!o.dragInfo&&i===r._activeRowIndex&&a===r._activeColIndex){var s=r.isEditing();if(r._startEditImp(e,i,a,null,null,null,null,!0),!s&&r.isEditing()){var l=o.hitTestType,u=r.getCellType(i,a);if(u._triggerButtonClicked){var c=r.getCellRect(i,a,1===l?-1:m,2===l?-1:m),f=r.getActualStyle(i,a,l),d=u._getHitInfoWrapper(t,n,f,c,{sheet:r,row:i,col:a,sheetArea:l});d&&d.isReservedLocation&&u._triggerButtonClicked(r,i,a,3)}}}}},_startEditImp:function(e,n,r,i,a,s,l,u){if(!(n<0||r<0)){var d=this,m=d._name,g=d.options;if(!d.isEditing()){var _=d._eventHandler;_._setFocus();var v=d.getCellRect(n,r);if(!(!v||v.width<=0||v.height<=0)){d.showCell(d._activeRowIndex,d._activeColIndex,3,3);var y=d.getActualStyle(n,r);if(g.isProtected&&!1!==y.locked)return void(d.parent.options.lockCallback&&d.parent.options.lockCallback());var b=d.getCellType(n,r);if(b){var w,C={sheet:d,row:n,col:r,sheetArea:3};w=b.isImeAware(C)?_._cellTypeFocusHolder:b._createCellTypeElement(C);var S;if(w&&w.firstChild&&(S=w.firstChild.firstChild),S){d._editor=S;var x={sheet:d,sheetName:m,row:n,col:r,cancel:!1};if(d._trigger(f.EditStarting,x),x.cancel)return void(c.ipad&&_._changeFocusHolder());var T=(d.getValue(n,r),t._supportsCalc&&d.getFormula(n,r),d._editorStatus);d._startEditByKeydown?d._editorStatus=1:d._editorStatus=2,d._raiseEditorStatusChanged(T,d._editorStatus);var E=d._getSheetLayout();v=d.getCellRect(n,r,i,a),b.isImeAware(C)&&_._resetFocusHolder(),b._activateEditorWrapper(w,y,v,C),d._needSelectInput=!0,d._setEditorValue(b,S,n,r,y,l,u);var M=d._getHost();if(b.isImeAware(C)||M.insertBefore(w,h),b._updateEditorWrapper(w,y,v,C),b.isImeAware(C)&&s||b.focus(S,C),d._needSelectInput&&s&&b.selectAll(S,C),g.allowCellOverflow){var A=v.clone();A.y-=2,A.height+=4,A.x=E._frozenX,A.width=E._viewportWidth,d.repaint(A)}o._callFeatureHandler(d,"startEdit",{element:b.getEditingElement()}),p._setActiveElement(d);var k={sheet:d,sheetName:m,row:n,col:r};d._trigger(f.EditStarted,k),d._trigger(f.FormulatextboxEditStarted,k)}}}}}},_setEditorValue:function(e,n,r,o,i,a,s){var l=this,u=t._supportsCalc&&l.getFormula(r,o,!0);u&&(u="="+u);var c=u,f={sheet:l,row:r,col:o,sheetArea:3};if(!u||0===u.length){u=l.getValue(r,o);var p=l.parent;t._supportsCalc&&p&&p.options.allowUserEditFormula;u&&u.length>0&&/^=/gi.test(u),c=u,u=e._formatEditorValue(n,i,u,f)}n._oldValue=u,d(a)||(u=a),e.setEditorValue(n,u,f,l,s),n._originalValue=c}};i.extend(o.prototype,g),e.exports=t},function(e,t,n){function r(e,t){var n=3;return f(t)<0&&(n=1),d(t)<0&&(n=2),!(3===n||!e._isSelected(t.row,t.col,n,!0))}function o(e,t,n){var o=!1,i=e._getSheetLayout();if(t){var a=f(t),s=d(t);if(a<0||s<0){var l=e.getCellRect(t.row,t.col,a,s);if(l&&l.width>0&&l.height>0){var u=i.x,c=i.y;if(l.x<i._rowHeaderWidth+u||l.y<i._colHeaderHeight+c||l.y>=i.height-i._footerHeight){var p,h=new D.Rect(l.x-2,l.y-2,l.width+4,l.height+4);p=a<0&&s<0?i._headerCornerRect():a<0?i._colHeaderRect(s):i._rowHeaderRect(a),h=h.getIntersectRect(p),n._update(h.x,h.y,h.width,h.height),o=r(e,t)}}}}return o}function i(e){return e.isEditing()}function a(e){return e.endEdit()}function s(e){return e.frozenRowCount()}function l(e){return e.frozenColumnCount()}function u(e,t){return e.getRowCount(t)}function c(e,t){return e.getColumnCount(t)}function f(e){return e.rowViewportIndex}function d(e){return e.colViewportIndex}function p(e){return e.hitTestType}function h(e){return e.getActiveRowIndex()}function m(e){return e.getActiveColumnIndex()}function g(e){return e.keyCode}function _(e){return e.ctrlKey}function v(e){return e.shiftKey}function y(e){return e.altKey}function b(e){return e.metaKey}function w(e){return e.colCount}function C(e){return e.rowCount}function S(e,t,n){return{action:e,index:t,sheetArea:n}}function x(e,t,n,r,o,i){var a={sheet:e,sheetName:t,sheetArea:o,row:n,col:r};return i&&(a.cancel=!1),a}function T(e,t,n,r,o,i){var a=e._sheet,s=x(a,a._name,a._activeRowIndex,a._activeColIndex,re,!0);if(a._trigger(G.LeaveCell,s),s&&!0===s.cancel)return!0;a._setActiveCellImp(t,n,r,o,i),a._trigger(G.EnterCell,x(a,a._name,t,n)),a._trigger(G.FormulatextboxEnterCell,x(a,a._name,t,n)),e._updateValidationUI&&e._updateValidationUI(t,n)}function E(e,t,n,r,o,i,a){var s=e._sheet,l=t.call(s,i.sheetArea);(a&&!s.getRowVisible(i.index)||!a&&!s.getColumnVisible(i.index))&&(i.index=n.call(e,i.index,i.sheetArea));var u=r.call(l,i.index);return u||(u=r.call(l,o)),u}function M(e,t,n,r){var o=r?"movingY":"movingX",i=r?"startY":"startX";e[o]=t,e[o]<e[i]&&(e[o]=e[i]);var a=r?n.y+n.height:n.x+n.width;e[o]>a&&(e[o]=a)}function A(e){var t=this;t._host=e,t._interval=ne,t._action=ne,t._intervalId=ne,t._result=ne,t._working=!1,t._needIncrease=!1}var t=n(2),k=n(6).Worksheet,R=n(0),I=n(13)._LayoutModel,O=n(4).GC$,D=n(3),P=D.Range,N=window,F=document,L=O.each,H=D._util,V=H._browser,j=H._device(),B=H._cancelDefault,U=H._createElement,W=R._StringHelper._format,z=D._createRange,Y=R._Types._isNullOrUndefined,G=D.Events,K=D._FocusHelper,X=".handler",q="mousedown"+X,J="mouseup"+X,Z="mousemove"+X,Q="mousewheel"+X,$="DOMMouseScroll"+X,ee="mouseout"+X,te="dblclick"+X,ne=null,re=void 0,oe=isNaN,ie=parseInt,ae=Math.round,se=Math.max,le=Math.min,ue=Math.abs,ce=Math.ceil,fe="function",de="position",pe="absolute",he="border",me="overflow",ge="top",_e="left",ve="width",ye="height",be="resize",we="hidden",Ce="visible",Se="none",xe="tabindex",Te="gcUIElement",Ee="corner",Me="sizeHiddenRow",Ae="sizeRow",ke="sizeCol",Re="sizeHiddenCol",Ie="default",Oe=j.iphone||j.ipad||j.android,De=function(){return R._getResource(t.SR)()},Pe=30;k._registerFeature("eventHandler",{dispose:function(e){var t=this;O(t._getCanvas()).unbind(q).unbind(J).unbind(Z).unbind(Q).unbind($).unbind(ee).unbind(te);var n=t._eventHandler;n&&(n._dispose(),n._disposeFocusHolders());var r=t._editor;r&&O(r).remove();var o=t._fillDialog;o&&o.close(),!1!==e&&(t._mouseDownDelegate=ne,t._mouseMoveDelegate=ne,t._mouseUpDelegate=ne,t._mouseWheelDelegate=ne,t._mouseOutDelegate=ne,t._dblClickDelegate=ne,t._eventHandler=ne)},setHost:function(e){if(e){var t=this,n=t._eventHandler;t._mouseDownDelegate=function(e){var r={e:e,r:ne};if(k._callFeatureHandler(t,"preProcessMouseDown",r),!r.r)return n._doMouseDown(e)},t._mouseMoveDelegate=function(e){var r={e:e,r:ne};k._callFeatureHandler(t,"preProcessMouseMove",r),r.r||n._isMouseCapture||n._doMouseMove(e)},t._mouseUpDelegate=function(e){var r={e:e,r:ne};if(k._callFeatureHandler(t,"preProcessMouseUp",r),!r.r&&!t._continueMouseUpBubble){if(n._isMouseCapture)return;return n._doMouseUp(e)}},t._mouseWheelDelegate=function(e){e=e||N.event;var n={e:e,r:ne};if(k._callFeatureHandler(t,"preProcessMouseWheel",n),!n.r){var r=e.detail?e.detail:e.wheelDelta/-40,o=0;if(H._isMacOS()){var i,a=e.wheelDeltaY,s=e.wheelDeltaX,l=e.deltaY,u=e.deltaX,c="y",f=130,d=(new Date).getTime();if(ue(a)>=ue(s)?i=a:(c="x",i=s),V.safari&&(i*=10,f=200),Math.abs(i)<f&&this.deltaDir&&Math.abs(this.deltaDir)<f&&this.scrollTime&&d-this.scrollTime<100&&this.direction===c)return;if(this.direction=c,this.scrollTime=d,this.deltaDir=i,ue(i)<f&&ue(i)>0&&(i/=3),V.chrome&&(ue(i)<1e3&&ue(i)>130?i/=2:ue(i)<2e3&&ue(i)>1e3&&(i/=1.5)),V.safari){i/=10;var p="x"===c?u:l;Y(i)||Y(p)||(i=ae(-i/ue(p)))}else V.chrome&&(Y(i)||(i/=-40,i=(i>=0?1:-1)*ce(ue(i))));(V.safari||V.chrome)&&("y"===c?(r=i,o=0):(o=i,r=0))}return!!t.parent._scrollService._doMouseWheel(e,ie(r,10)||0,ie(o,10)||0)&&void 0}},t._mouseOutDelegate=function(e){var r={e:e,r:ne};if(k._callFeatureHandler(t,"preProcessMouseOut",r),!r.r)return n._doMouseOut(e)},t._dblClickDelegate=function(e){function r(e,t,n,r,o,i){var a={sheet:e,sheetName:t,sheetArea:o,row:n,col:r};return i&&(a.cancel=!1),a}function o(e,t){e._startEdit(t)}function i(e,t){var n=e._sheet,r=t.resizeInfo;if(r){if(r.action===Ae||r.action===Me){var o=[];n._isRowSelected(r.index)?L(n._selectionModel,function(e,t){if(-1===t.col)for(var r=n._getActualRange(t),i=0;i<C(r);i++)o.push({row:r.row+i})}):o.push({row:r.index}),n._commandManager().execute({cmd:"autoFitRow",sheetName:n.name(),rows:o,columnHeader:1===r.sheetArea})}else{var i=[];n._isColumnSelected(r.index)?L(n._selectionModel,function(e,t){if(-1===t.row)for(var r=n._getActualRange(t),o=0;o<w(r);o++)i.push({col:r.col+o})}):i.push({col:r.index}),n._commandManager().execute({cmd:"autoFitColumn",sheetName:n.name(),columns:i,rowHeader:2===r.sheetArea})}return!0}return!1}var a={e:e,r:ne};if(k._callFeatureHandler(t,"preProcessMouseDbClick",a),!a.r){var s=t._currentTarget;if(s){var l=!1;3===p(s)?o(n,e,s):l=i(n,s),l||t._trigger(G.CellDoubleClick,r(t,t._name,s.row,s.col,p(s)))}}},e.bind(q,function(e){return t._mouseDownDelegate(e)}).bind(J,function(e){return t._mouseUpDelegate(e)}).bind(Z,function(e){return t._mouseMoveDelegate(e)}).bind(Q,function(e){return t._mouseWheelDelegate(e)}).bind($,function(e){return t._mouseWheelDelegate(e)}).bind(ee,function(e){return t._mouseOutDelegate(e)}).bind(te,function(e){return t._dblClickDelegate(e)})}}}),t.ImeMode={auto:1,active:2,inactive:4,disabled:0};var Ne=function(){function e(e){var t=this;t._repeatKeyDownTimeoutID=0,t._focusReleased=!1,t._dragRect={},t._sheet=e}return e.prototype={_dispose:function(){var e=this;e._hScrollTimer&&e._hScrollTimer._dispose(),e._vScrollTimer&&e._vScrollTimer._dispose(),e._mousePosition=ne},_getHScrollTimer:function(){var e=this;return e._hScrollTimer||(e._hScrollTimer=new A(e)),e._hScrollTimer},_getVScrollTimer:function(){var e=this;return e._vScrollTimer||(e._vScrollTimer=new A(e)),e._vScrollTimer},_getCanvasOffset:function(){return this._sheet._getCanvasOffset()},_getCanvasPosition:function(){var e=O(this._sheet._getCanvas()).position();return e||(e={top:0,left:0}),e},_doMouseDown:function(e){if(2===e.button)return!0;var t=this,n=t._sheet;if(t._handleDocumentMouseMove(),V&&V.msie&&e.offsetX!==re&&e.offsetY!==re){var r=0,o=0;if(e.target!==n._canvas){var a=H._getRelativeOffset(e.target,n._canvas);r=a._left,o=a._top}var s=e.pageX-(e.offsetX+r),l=e.pageY-(e.offsetY+o);N._gcGlobal.canvasOffset={top:l,left:s}}var u=n._getCanvasOffset(),c=t._doMouseDownImp(e,e.pageX-u.left,e.pageY-u.top);return i(n)||c||t._setFocus(),n._isMouseDownInSheet=!0,!1},_handleDocumentMouseMove:function(){var e=this;e._isMouseCapture||(O(F).bind("mousemove.gcSheet",function(t){e._doMouseMove(t)}).bind("mouseup.gcSheet",function(t){e._doMouseUp(t)}),e._isMouseCapture=!0)},_unhandleDocumentMouseMove:function(){this._isMouseCapture&&(this._isMouseCapture=!1,O(F).unbind("mousemove.gcSheet").unbind("mouseup.gcSheet"))},_doMouseDownImp:function(e,t,n){var r=this,o=r._sheet,s=o.hitTest(t,n),l=s.row,u=s.col,c=s.dragInfo,g=s.formulaRangeHitInfo,_=s.cellTypeHitInfo,v=o._getSheetLayout();if(t>=v.x&&n>=v.y)if(o._currentTarget=s,r._isMouseDown=!0,s.resizeInfo){if(!a(o))return;r._startResizing(s)}else if(c&&c.side&&c.side!==Ee){if(!a(o))return;r._startDragDropping&&r._startDragDropping(s)}else if(c&&c.side===Ee){if(!a(o))return;r._startDragFill&&r._startDragFill(s)}else if(s.filterButtonHitInfo)a(o);else if(g)g.inBorder?r._startFormulaRangeMoving(s):(g.inTopLeft||g.inTopRight||g.inBottomLeft||g.inBottomRight)&&r._startFormulaRangeResizing(s);else if(o._canSelect(f(s)<0?-1:l,d(s)<0?-1:u)){if(r._dealMouseDownInFormulatextbox&&r._dealMouseDownInFormulatextbox(o,s))return;var y=h(o),b=m(o);if(_){var w=_.sheetArea;if((Y(w)||3===w)&&(l!==y||u!==b)){o.suspendPaint();try{if(!a(o))return;var C=x(o,o._name,y,b,re,!0);if(o._trigger(G.LeaveCell,C),C&&!0===C.cancel)return;var S=o._selectionModel.toArray(),T=o._getSpanModel().get(l,u),E=[new P(T.row,T.col,T.rowCount,T.colCount)];o._raiseSelectionChanging(S,E),o._setActiveCellAndSelection(l,u,re,re,1),o._trigger(G.EnterCell,x(o,o._name,l,u)),o._trigger(G.FormulatextboxEnterCell,x(o,o._name,l,u)),o._raiseSelectionChanged(S),r._updateValidationUI&&r._updateValidationUI(l,u)}finally{o.resumePaint()}}var M=o.getCellType(_.row,_.col,p(s));_.sheet||(_.sheet=o),M.processMouseDown(_)}if(_&&_.isReservedLocation)return!0;r._setMetaKeyState(e);try{if(r._hitTestResult=s,i(o)&&y===h(o)&&b===m(o)&&!a(o))return}finally{r._hitTestResult=ne}if(Y(l)||Y(u))return;3===p(s)&&r._updateValidationUI&&r._updateValidationUI(l,u);var A=o._selectionModel.toArray();r._startSelecting(s);var k=o._selectionModel.toArray();o._raiseSelectionChanging(A,k)}},_isInvalidRect:function(e){var t=this._sheet;if(!t)return!0;var n=t._getSheetLayout();return Y(e.x)||Y(e.y)||Y(e.width)||Y(e.height)||e.x+e.width>n._viewportX+n._viewportWidth+n._frozenTrailingWidth||e.y+e.height>n._viewportY+n._viewportHeight+n._frozenTrailingHeight},_commitSelectValue:function(e,t,n,r){for(var o,i=this._sheet,a=0,s=e.options,l=s.length;a<l;a++){if(s[a].selected){o=r[a].value;break}}var u=!1;if(i.options.isProtected){var c=i.getActualStyle(t,n);c&&(u=c.locked)}if(!Y(o)&&!u){var f={cmd:"editCell",sheetName:i.name(),row:t,col:n,newValue:o,autoFormat:!0};i._commandManager().execute(f)}O(e).hide()},_startScroll:function(){var e=this;if(e._startHitInfo){var t=e._startHitInfo._hitTestType;3!==t&&2!==t||e._getVScrollTimer()._setAction(e._processVSScrolled),3!==t&&1!==t||e._getHScrollTimer()._setAction(e._processHSScrolled)}},_checkContinueScroll:function(){var e=this;e._isSelecting&&e._continueSelecting(),e._isDragDropping&&e._continueDragDropping&&e._continueDragDropping(),e._isDraggingFill&&e._continueDragFill&&e._continueDragFill(),e._isFormulaRangeAppending&&e._continueFormulaRangeAppending(),e._isFormulaRangeMoving&&e._continueFormulaRangeMoving(),e._isFormulaRangeResizing&&e._continueFormulaRangeResizing()},_processVSScrolled:function(e){var t=this;if(!t._adjustScrollRowViewport()){var n=t._startHitInfo,r=t._sheet,o=n._scrollRowViewportIndex,i=r.getViewportTopRow(o),a=r.getViewportBottomRow(o);if(e)if(a<u(r)-r.frozenTrailingRowCount()-1)r._setTopRow(r._getNextVisualRow(i));else{var l=r._getRowLayout(o);if(l&&l.length>0){var c=r._getSheetLayout(),f=l[l.length-1];f.y+f.height>=c._viewportY+c._viewportHeight&&r._setTopRow(r._getNextVisualRow(i))}}else i>s(r)&&r._setTopRow(r._getPrevVisualRow(i))}t._checkContinueScroll()},_processHSScrolled:function(e){var t=this;if(!t._adjustScrollColViewport()){var n=t._sheet,r=t._startHitInfo,o=r._scrollColViewportIndex,i=n.getViewportLeftColumn(o),a=n.getViewportRightColumn(o);if(e)if(a<c(n)-n.frozenTrailingColumnCount()-1)n._setLeftColumn(n._getNextVisualColumn(i));else{var s=n._getColumnLayout(o);if(s&&s.length>0){var u=n._getSheetLayout(),f=s[s.length-1];f.x+f.width>=u._viewportX+u._viewportWidth&&n._setLeftColumn(n._getNextVisualColumn(i))}}else i>l(n)&&n._setLeftColumn(n._getPrevVisualColumn(i))}t._checkContinueScroll()},_adjustScrollRowViewport:function(){var e=this._sheet,t=e._getSheetLayout(),n=s(e),r=e.frozenTrailingRowCount(),o=this._mousePosition,i=this._startHitInfo,a=i._scrollRowViewportIndex;if(0===a){if(o.y>t._viewportY)return e._setTopRow(e._getFirstPageTopRow()),i._scrollRowViewportIndex=1,!0}else if(1===a){var l=e._getRowLayout(1);if(l&&l.length>0){var c=l[0];if(n>0&&o.y<t._viewportY&&c.row<=e._getFirstPageTopRow())return i._scrollRowViewportIndex=0,!0;if(c=l[l.length-1],r>0&&o.y>t._frozenTrailingY&&c.row>=e._getLastVisualRow()&&c.y+c.height<=t._frozenTrailingY)return i._scrollRowViewportIndex=2,!0}}else if(2===a&&(l=e._getRowLayout(1))&&l.length>0&&o.y<t._frozenTrailingY){if(c=l[l.length-1],c.y+c.height>t._frozenTrailingY){for(var f=t._viewportHeight,d=u(e)-r-1,p=0,h=d;h>=n;h--)if((p+=e._getZoomRowHeight(h))>f){d=le(h+1,d);break}e._setTopRow(e._getNextVisualRow(d-1))}return i._scrollRowViewportIndex=1,!0}return!1},_adjustScrollColViewport:function(){var e=this._sheet,t=e.frozenTrailingColumnCount(),n=l(e),r=e._getSheetLayout(),o=this._mousePosition,i=this._startHitInfo,a=i._scrollColViewportIndex;if(0===a){if(o.x>r._viewportX)return e._setLeftColumn(e._getFirstPageLeftColumn()),i._scrollColViewportIndex=1,!0}else if(1===a){var s=e._getColumnLayout(1);if(s&&s.length>0){var u=s[0];if(n>0&&o.x<r._viewportX&&u.col<=e._getFirstPageLeftColumn())return i._scrollColViewportIndex=0,!0;if(u=s[s.length-1],t>0&&o.x>r._frozenTrailingX&&u.col>=e._getLastVisualColumn()&&u.x+u.width<=r._frozenTrailingX)return i._scrollColViewportIndex=2,!0}}else if(2===a&&(s=e._getColumnLayout(1))&&s.length>0&&o.x<r._frozenTrailingX){if(u=s[s.length-1],u.x+u.width>r._frozenTrailingX){for(var f=r._viewportWidth,d=c(e)-t-1,p=0,h=d;h>=n;h--)if((p+=e._getZoomColumnWidth(h))>f){d=le(h+1,d);break}e._setLeftColumn(e._getNextVisualColumn(d-1))}return i._scrollColViewportIndex=1,!0}return!1},_continueScroll:function(){var e=this;if(e._isWorking||e._isFloatingObjectWorking||e._isCommentWorking){var t=e._sheet,n=t._getSheetLayout(),r=e._startHitInfo,o=r._scrollRowViewportIndex,i=r._scrollColViewportIndex,a=e._mousePosition,s=ne;if(o>=0&&i>=0?s=n._viewportRect(o,i):o>=0?s=n._rowHeaderRect(o):i>=0&&(s=n._colHeaderRect(i)),s){var l=0,u=0;a.x<=s.x?l=a.x-s.x:a.x>=s.x+s.width&&(l=a.x-(s.x+s.width)),a.y<=s.y?u=a.y-s.y:a.y>=s.y+s.height&&(u=a.y-(s.y+s.height)),e._getHScrollTimer()._setInterval(e._getIntervalFromDistance(l)),e._getVScrollTimer()._setInterval(e._getIntervalFromDistance(u))}}},_stopScroll:function(){this._getHScrollTimer()._stop(),this._getVScrollTimer()._stop()},_startResizing:function(e){var t,n,r=this,o=I.prototype,i=r._sheet,a=e.resizeInfo;a.action===Ae||a.action===Me?(t=E(r,i._getAllRowLayout,r._getPreVisualRow,o.findRow,e.row,a,!0),a.startY=t.y):(n=E(r,i._getAllColumnLayout,r._getPreVisualCol,o.findCol,e.col,a,!1),a.startX=n.x);var s=i.parent,l=e.x,u=e.y;if(s){var c=s.options.showResizeTip;(1!==c||a.action!==ke&&a.action!==Re)&&(2!==c||a.action!==Ae&&a.action!==Me)&&3!==c||(u-Pe<0?u+=Pe/2:u-=Pe,s._showTooltip(r._getMouseDownResizeTooltipContent(),l,u))}r.isResizing=!0,r._isWorking=!0},_continueResizing:function(){var e=this,t=e._sheet,n=t._currentTarget,r=n.resizeInfo,o=e._mousePosition,i=o.x,a=o.y,s=t._getSheetLayout();if(r&&e._isWorking&&e.isResizing&&(n.x!==i||n.y!==a)){r.action===Ae||r.action===Me?M(r,a,s,!0):M(r,i,s,!1);var l=t._render,u=l._getCtx();l._copyDoubleBuffer(s.x,s.y,s.width,s.height),l._paintAdornment(u);var c=t.parent;if(c){var f=c.options.showResizeTip;(1!==f||r.action!==ke&&r.action!==Re)&&(2!==f||r.action!==Ae&&r.action!==Me)&&3!==f||c._refreshTooltip(e._getMouseMoveResizeTooltipContent(r))}}},_stopResizing:function(){var e=this;e.isResizing=!1,e._isWorking=!1;var t,n=!0,r=e._sheet,o=r._currentTarget,i=o.resizeInfo;if(i){if(e._removeTooltip(),i.action===Ae||i.action===Me)if(Y(i.movingY))n=!1;else{t=se(0,(i.movingY-i.startY)/r._zoomFactor);var a=[];r._isRowSelected(i.index)?O.each(r._selectionModel,function(e,t){if(-1===t.col){var n=r._getActualRange(t);a.push({firstRow:n.row,lastRow:n.row+C(n)-1})}}):a.push({firstRow:i.index,lastRow:i.index});var s=1===i.sheetArea;r._commandManager().execute({cmd:"resizeRow",sheetName:r.name(),rows:a,size:t,columnHeader:s})}else if(Y(i.movingX))n=!1;else{t=se(0,(i.movingX-i.startX)/r._zoomFactor);var l=[];r._isColumnSelected(i.index)?O.each(r._selectionModel,function(e,t){if(-1===t.row){var n=r._getActualRange(t);l.push({firstCol:n.col,lastCol:n.col+w(n)-1})}}):l.push({firstCol:i.index,lastCol:i.index});var u=2===i.sheetArea;r._commandManager().execute({cmd:"resizeColumn",sheetName:r.name(),columns:l,size:t,rowHeader:u})}var c=r.hitTest(e._mousePosition.x,e._mousePosition.y);c&&e._updateCanvasCursor(c),n||r.repaint()}},_startSelectingCore:function(e,t){var n=0,r=0,o=0,a=0,h=this,m=h._sheet,g=m._bindingManager,_=s(m),v=l(m);h._oldSelections=h._lastSelections=m._selectionModel.toArray(),h.ctrl||h.shift||m._clearSelectionImp();var y,b,S;if(0===p(e)){if(!h.shift){y=_?m._getFirstVisualRow():m._scrollTopRow;var x=v?m._getFirstVisualColumn():m._scrollLeftCol,E=T(h,y,x,1,1,t);if(E)return}h.ctrl||m._clearSelectionImp(),m._setSelectedRange(-1,-1,u(m),c(m),!0)}else if(1===p(e)){if(!h.shift&&(y=_?m._getFirstVisualRow():m._scrollTopRow,b=h._getAvailableActiveCell(y,e.col,!1),E=T(h,b.row,b.col,1,d(e),t)))return;h.shift?(n=le(m._activeColIndex,e.col),a=ue(m._activeColIndex-e.col)+1,m._replaceActiveSelectedRange(-1,n,u(m),a,!0)):m._setSelectedRange(-1,m._activeColIndex,u(m),1,!0)}else if(2===p(e)){if(!h.shift){var M=v?m._getFirstVisualColumn():m._scrollLeftCol;if(b=h._getAvailableActiveCell(e.row,M,!0),S=m._activeRowIndex!==b.row,E=T(h,b.row,b.col,f(e),1,t))return;S&&g&&g._doDataItemChanged()}h.shift?(r=le(m._activeRowIndex,e.row),o=ue(m._activeRowIndex-e.row)+1,m._replaceActiveSelectedRange(r,-1,o,c(m),!0)):m._setSelectedRange(m._activeRowIndex,-1,1,c(m),!0)}else if(3===p(e))if(oe(e.row)||oe(e.col)){if(i(m)){var A=m.getCellRect(m._activeRowIndex,m._activeColIndex,m._activeRowViewportIndex,m._activeColViewportIndex);m._render._update(A.x,A.y,A.width,A.height)}}else{if(!h.shift&&(m._activeRowIndex!==e.row||m._activeColIndex!==e.col)){if(S=m._activeRowIndex!==e.row,E=T(h,e.row,e.col,f(e),d(e),t))return;S&&g&&g._doDataItemChanged()}if(h.shift)m._extendSelectedRange(e.row,e.col,!0);else{var k=m._getSpanModel().get(e.row,e.col);m._setSelectedRange(k.row,k.col,C(k),w(k),!0)}}},_startSelectingScroll:function(e){if(e&&(3!==p(e)||!oe(e.row)&&!oe(e.col))){var t=this;t._isWorking=!0,t._isSelecting=!0,t._startHitInfo={_scrollRowViewportIndex:f(e),_scrollColViewportIndex:d(e),_hitTestType:p(e)},t._startScroll()}},_startSelecting:function(e){this._startSelectingCore(e),this._startSelectingScroll(e)},_continueSelecting:function(){var e=this;if(e._startHitInfo&&e._isWorking&&!0!==e._forceCancelSelectiong){var t=e._startHitInfo._hitTestType;3===t?e._continueCellSelecting():2===t?e._continueRowSelecting():1===t&&e._continueColumnSelecting()}},_continueCellSelecting:function(){var e=this,t=e._sheet,n=e._getHitRowIndex(),r=e._getHitColumnIndex();if(n>=0&&r>=0&&t._canSelect(n,r)){var o=t._selectionModel.toArray();t._extendSelectedRange(n,r,!0);var i=t._selectionModel.toArray();t._raiseSelectionChanging(o,i),e._continueScroll()}},_continueRowSelecting:function(){var e=this,t=e._sheet,n=e._getHitRowIndex();if(n>=0&&t._canSelect(n,-1)){var r=le(t._activeRowIndex,n),o=se(t._activeRowIndex,n)-r+1,i=-1,a=c(t);if(0===t.selectionPolicy())return;2===t.selectionUnit()&&(r=-1,o=-1);var s=t._selectionModel.toArray();t._replaceActiveSelectedRange(r,i,o,a,!0);var l=t._selectionModel.toArray();t._raiseSelectionChanging(s,l)}e._continueScroll()},_continueColumnSelecting:function(){var e=this,t=e._sheet,n=e._getHitColumnIndex();if(n>=0&&t._canSelect(-1,n)){var r=le(t._activeColIndex,n),o=se(t._activeColIndex,n)-r+1,i=-1,a=u(t);if(0===t.selectionPolicy())return;1===t.selectionUnit()&&(r=-1,o=-1);var s=t._selectionModel.toArray();t._replaceActiveSelectedRange(i,r,a,o,!0);var l=t._selectionModel.toArray();t._raiseSelectionChanging(s,l)}e._continueScroll()},_stopSelecting:function(){var e=this;e._startHitInfo=ne,e._stopScroll(),e._forceCancelSelectiong=ne,e._isWorking=!1,e._isSelecting=!1;var t=e._sheet;if(t._selectionModel){var n=!e._lastSelections;if(!n){var r=t._selectionModel.toArray();n=e._notEqualSelecions(e._lastSelections,r)}n&&t._raiseSelectionChanged(e._oldSelections),e._lastSelections=t._selectionModel.toArray()}},_getHitRowViewportIndex:function(){function e(e,t){var n=e._getSheetLayout();return s(e)>0&&t<n._frozenY+n._frozenHeight?0:e.frozenTrailingRowCount()>0&&t>n._frozenTrailingY?2:1}var t=this._sheet,n=e(t,this._mousePosition.y),r=this._startHitInfo._scrollRowViewportIndex,o=t._getRowLayout(1);return 0===n&&r>0&&o.length>0&&o[0].row>t._getFirstPageTopRow()?n=1:2===n&&r<2&&o.length>0&&o[o.length-1].row<t._getLastVisualRow()&&(n=1),n},_getHitColumnViewportIndex:function(){function e(e,t){var n=e._getSheetLayout();return l(e)>0&&t<n._frozenX+n._frozenWidth?0:e.frozenTrailingColumnCount()>0&&t>n._frozenTrailingX?2:1}var t=this._sheet,n=e(t,this._mousePosition.x),r=this._startHitInfo._scrollColViewportIndex,o=t._getColumnLayout(1);return 0===n&&r>0&&o.length>0&&o[0].col>t._getFirstPageLeftColumn()?n=1:2===n&&r<2&&o.length>0&&o[o.length-1].col<t._getLastVisualColumn()&&(n=1),n},_getHitRowIndex:function(){function e(e,t,n){var r=e._getRowLayout(t);return r?r.findNearY(n):ne}var t=this._sheet,n=this._mousePosition.y,r=this._getHitRowViewportIndex(),o=e(t,r,n);if(o){var i=t._getSheetLayout(),a=o.row;return 1===r&&n<i._viewportY&&a>t._getFirstPageTopRow()?t._getNextVisualRow(a-1)||a:1===r&&n>i._frozenTrailingY&&a>t._getLastFullyVisibleRow()?t._getPrevVisualRow(a)||a:a}return-1},_getHitColumnIndex:function(){function e(e,t,n){var r=e._getColumnLayout(t);return r?r.findNearX(n):ne}var t=this._sheet,n=this._mousePosition.x,r=this._getHitColumnViewportIndex(),o=e(t,r,n);if(o){var i=t._getSheetLayout(),a=o.col;return 1===r&&n<i._viewportX&&a>t._getFirstPageLeftColumn()?t._getNextVisualColumn(a-1)||a:1===r&&n>i._frozenTrailingX&&a>t._getLastFullyVisibleColumn()?t._getPrevVisualColumn(a)||a:a}return-1},_getIntervalFromDistance:function(e){var t=0;if(!oe(e)&&0!==e){var n=e<0;t=ce(500/ue(e)),t=se(20,10*t),t>200&&(t=200),n&&(t=-t)}return t},_getPreVisualRow:function(e,t){var n=this._sheet,r=n._getPrevVisualRow(e,t);return r!==ne?r:e},_getPreVisualCol:function(e,t){var n=this._sheet,r=n._getPrevVisualColumn(e,t);return r!==ne?r:e},_getPreVisibleRow:function(e,t,n){for(var r=this._sheet;e>t;)if(e--,r.getRowVisible(e,n))return e;return e},_getPreVisibleCol:function(e,t,n){for(var r=this._sheet;e>t;)if(e--,r.getColumnVisible(e,n))return e;return e},_getResizeRowInfo:function(e,t,n,r,o){function i(e){return!e.options.isProtected||e.options.protectionOptions.allowResizeRows}var a=ne;if(!i(e))return a;var s=this,l=e._getRowLayout(f(t),r);if(l&&!oe(t.row)&&!oe(t.col)){e.getRowVisible(t.row,r)||(t.row=this._getPreVisualRow(t.row,r));var u=l.findRow(t.row);if(u)if(u.y+u.height-n<=o&&o<=u.y+u.height+n){a=S(Ae,t.row,r);var c=l[l.length-1].row;if(c>=0){var d=e._getLastVisualRow(r);a.index===d&&a.index!==c&&u.y+u.height-n/2<=o&&(a=S(s._getResizeRowAction(e,c,r),c,r))}}else if(u.y-n<=o&&o<=u.y+n&&R._ArrayHelper._indexOf(l,u)>0){var p=s._getPreVisibleRow(t.row,0,r);a=S(s._getResizeRowAction(e,p,r),p,r)}if(!a&&1===f(t)&&l.length>0&&(u=l[0],se(0,u.y-n)<=o&&o<=u.y+n)){var h=t.row-1,m=e._getRowLayout(f(t)-1,r);if(h>=0&&m){var g=m[m.length-1];m.findRow(h)&&h!==(g&&g.row)||(a=S(s._getResizeRowAction(e,h,r),h,r))}}}return a&&!e.getRowResizable(a.index,r)&&(a=ne),a},_getResizeRowAction:function(e,t,n){var r=e.parent;return r&&1===r.options.resizeZeroIndicator&&e.getRowVisible(t)&&0===e._getActualRowHeight(t,n)?Me:Ae},_getResizeColInfo:function(e,t,n,r,o){function i(e){return!e.options.isProtected||e.options.protectionOptions.allowResizeColumns}var a=ne;if(!i(e))return a;var s=this,l=e._getColumnLayout(d(t),r);if(l&&!oe(t.col)&&!oe(t.row)){e.getColumnVisible(t.col,r)||(t.col=this._getPreVisualCol(t.col,r));var u=l.findCol(t.col);if(u)if(u.x+u.width-n<=o&&o<=u.x+u.width+n){a=S(ke,t.col,r);var c=l[l.length-1].col;if(c>=0){var f=e._getLastVisualColumn(r);a.index===f&&a.index!==c&&u.x+u.width-n/2<=o&&(a=S(s._getResizeColAction(e,c,r),c,r))}}else if(u.x-n<=o&&o<=u.x+n&&R._ArrayHelper._indexOf(l,u)>0){var p=s._getPreVisibleCol(t.col,0,r);a=S(s._getResizeColAction(e,p,r),p,r)}if(!a&&1===d(t)&&l.length>0&&(u=l[0],se(0,u.x-n)<=o&&o<=u.x+n)){var h=t.col-1,m=e._getColumnLayout(d(t)-1,r);if(h>=0&&m){var g=m[m.length-1];m.findCol(h)&&h!==(g&&g.col)||(a=S(s._getResizeColAction(e,h,r),h,r))}}}return a&&!e.getColumnResizable(a.index,r)&&(a=ne),a},_getResizeColAction:function(e,t,n){var r=e.parent;return r&&1===r.options.resizeZeroIndicator&&e.getColumnVisible(t)&&0===e._getActualColumnWidth(t,n)?Re:ke},_getResizingRowCol:function(e,t,n,r){var o,i,a=this,s=a._sheet,l=s.parent,p=s.options,h=p.colHeaderVisible,m=p.rowHeaderVisible,g=ne;if(!l||l.options.allowUserResize){var _=s._getSheetLayout();if(f(e)<0&&d(e)>=0&&h)(g=a._getResizeColInfo(s,e,r,1,t))||(g=a._getResizeRowInfo(s,e,r,1,n));else if(f(e)>=0&&d(e)<0&&m)(g=a._getResizeRowInfo(s,e,r,2,n))||(g=a._getResizeColInfo(s,e,r,2,t));else if(f(e)<0&&d(e)<0){if(s._getLastVisualRow(2)===ne&&ue(n-_._colHeaderHeight)<=r){var v=s._getRowLayout(1);v&&v.length>0&&(o=v[v.length-1].row),o>=0&&s.getRowResizable(o,2)&&(g=S(a._getResizeRowAction(s,o,2),o,2))}else if(s._getLastVisualColumn(1)===ne&&ue(t-_._rowHeaderWidth)<=r){var y=s._getColumnLayout(1);y&&y.length>0&&(i=y[y.length-1].col),i>=0&&s.getColumnResizable(i,1)&&(g=S(a._getResizeColAction(s,i,1),i,1))}}else f(e)>=0&&d(e)>=0&&(o=u(s,1)-1,i=c(s,2)-1,o>=0&&0===_._colHeaderHeight&&n<=r&&h?g=S(a._getResizeRowAction(s,o,1),o,1):i>=0&&0===_._rowHeaderWidth&&t<=r&&m&&(g=S(a._getResizeColAction(s,i,2),i,2)))}return g},_inGrayArea:function(e,t,n,r){var o=this._sheet,i=o._getSheetLayout(),a=i._viewportRect(1,1);if(1===t){var s=o._getColumnLayout(t);if(s&&s.length>0){var l=s[s.length-1];if(l.x+l.width<=n&&n<a.x+a.width)return!0}else if(a.contains(n,r))return!0}if(1===e){var u=o._getRowLayout(e);if(u&&u.length>0){var c=u[u.length-1];if(c.y+c.height<=r&&r<a.y+a.height)return!0}else if(a.contains(n,r))return!0}return!1},_doMouseMove:function(e){var t=this._getCanvasOffset();this._doMouseMoveImp(e,e.pageX-t.left,e.pageY-t.top)},_doMouseOut:function(){var e=this._sheet,t=e._currentTarget;if(t){var n=t.cellTypeHitInfo;if(n){e.getCellType(n.row,n.col,p(t)).processMouseLeave(n)}}if(!this._isWorking){var r={x:-1e4,y:-1e4,rowViewportIndex:ne,colViewportIndex:ne,row:-1,col:-1,resizeInfo:ne,hitTestType:ne};this._setHoverCell(r)}},_doMouseMoveImp:function(e,t,n){var r=this;r._mousePosition={e:e,x:t,y:n};var o=r._sheet;if(r._isMouseDown&&(K._isActiveElement(o)||K._setActiveElement(o)),r._isMouseDown&&r._isWorking)return void(r.isResizing?r._continueResizing():r._isDragDropping?r._continueDragDropping&&r._continueDragDropping():r._isDraggingFill?r._continueDragFill&&r._continueDragFill():r._isFormulaRangeAppending?r._continueFormulaRangeAppending():r._isFormulaRangeMoving?r._continueFormulaRangeMoving():r._isFormulaRangeResizing?r._continueFormulaRangeResizing():r._isSelecting&&r._continueSelecting());var i=o.hitTest(t,n);i&&(r._updateCanvasCursor(i),r._setHoverCell(i))},_updateCanvasCursor:function(e){var t=this,n=t._sheet,r=n._getCanvas();if(r){var o=n._currentTarget,i=!o||e.row!==o.row||e.col!==o.col||p(e)!==p(o)||e.resizeInfo&&!o.resizeInfo||!e.resizeInfo&&o.resizeInfo||e.resizeInfo&&e.resizeInfo.action!==o.resizeInfo.action||e.dragInfo&&!o.dragInfo||!e.dragInfo&&o.dragInfo||e.dragInfo&&e.dragInfo.action!==o.dragInfo.action;if(o&&i){var a=o.cellTypeHitInfo;if(a){var s=n.getCellType(a.row,a.col,p(o));s.processMouseLeave(a)}}var l=e.resizeInfo,u=e.dragInfo,c=e.formulaRangeHitInfo,f=e.cellTypeHitInfo,d=n._render;if(l){var h=D.CursorResource;l.action===ke?r.style.cursor=h.ResizeCol:l.action===Ae?r.style.cursor=h.ResizeRow:l.action===Re?r.style.cursor=h.ResizeHiddenCol:l.action===Me?r.style.cursor=h.ResizeHiddenRow:r.style.cursor=Ie}else if(u&&"drag"===u.action)u.side===Ee?r.style.cursor="crosshair":u.side?r.style.cursor="move":r.style.cursor=Ie;else if(c){c.inBorder?r.style.cursor="move":c.inTopLeft?r.style.cursor="nw-resize":c.inTopRight?r.style.cursor="ne-resize":c.inBottomLeft?r.style.cursor="sw-resize":c.inBottomRight&&(r.style.cursor="se-resize");var m=t.isFormulaRangeHoving,g=t._formulRangeHovingInfo,_=g&&g.paramRange,v=c.paramRange;t.isFormulaRangeHoving=!0,t._formulRangeHovingInfo={paramRange:v},m&&v.index===_.index||d._paintFormulaTextBox()}else f&&(s=n.getCellType(f.row,f.col,p(e)),f.sheet=n,i&&s.processMouseEnter(f),s.processMouseMove(f)),!i&&f&&f.isReservedLocation||(r.style.cursor=Ie),t.isFormulaRangeHoving&&(t.isFormulaRangeHoving=!1,t._formulRangeHovingInfo=ne,d._paintFormulaTextBox())}},_doMouseUp:function(e){var t=this,n=t._sheet;t._unhandleDocumentMouseMove();var r=n._getCanvasOffset();return!n._isMouseDownInSheet||(n._isMouseDownInSheet=!1,t._doMouseUpImp(e,e.pageX-r.left,e.pageY-r.top),!1)},_doMouseUpImp:function(e){var t=this,n=t._sheet,r=K._getActiveElement();if(t._isMouseDown=!1,r&&r!==n&&r.endEdit&&(r._formulaTextBox&&r._formulaTextBox._isSelectMode||(r.endEdit(),r.repaint())),K._setActiveElement(n),t.isResizing)t._stopResizing();else if(t._isDragDropping)t._stopDragDrop&&t._stopDragDrop();else if(t._isDraggingFill)t._endDragFill&&t._endDragFill();else if(t._isFormulaRangeAppending)t._stopFormulaRangeAppending();else if(t._isFormulaRangeMoving)t._stopFormulaRangeMoving();else if(t._isFormulaRangeResizing)t._stopFormulaRangeResizing();else if(n._currentTarget){var o=n._currentTarget,i=o.cellTypeHitInfo;if(i){var a=n.getCellType(i.row,i.col,p(o));i.sheet||(i.sheet=n),a.processMouseUp(i)}i&&i.isReservedLocation||n._trigger(G.CellClick,x(n,n._name,o.row,o.col,p(o)))}t._stopSelecting(),t._setMetaKeyState(e)},_startEdit:function(e){var t=this._sheet;if(t.isEditing){var n=t._getCanvas(),r=t._getCanvasOffset();v(e)||_(e)||t._doStartEdit(n,e.pageX-r.left,e.pageY-r.top)}},_doKeyDown:function(e){var t=this,n=t._sheet;if(n){var r=h(n),o=m(n),a=n.getCellType(r,o),s={isEditing:i(n),sheet:n,row:r,col:o,sheetArea:3},l={sheet:n,row:r,col:o,sheetArea:3};if(a&&a.isReservedKey(e,s))return void(i(n)||a.processKeyDown(e,l));var u=n._formulaTextBox;if(u&&u._isReservedKey(e))return;var c=n.parent&&n.parent._attachedFormulaTextBox;if(c&&c._isReservedKey(e))return}var f=!(i(n)||_(e)||b(e)||34!==g(e)&&33!==g(e)&&37!==g(e)&&39!==g(e)&&9!==g(e)&&13!==g(e)&&38!==g(e)&&40!==g(e));n._isTouchMode&&(n._isTouchMode=!1,n._render._refreshTouchSelectionIndicator());var d=t._keyDownImp(e);if(f&&d&&K._isActiveElement(n)){if(t._keyPressed)return t._keyPressedCount<25&&t._keyPressedCount++,void B(e);t._keyPressed=!0,t._keyPressedCount=1,t._repeatKeyDown(e,!0)}},_getMouseDownResizeTooltipContent:function(){var e=this._sheet,t=e._currentTarget,n=t.resizeInfo;if(n.action===Ae||n.action===Me){var r=e._getAllRowLayout(n.sheetArea);e.getRowVisible(n.index)||(n.index=this._getPreVisualRow(n.index,n.sheetArea));var o=r.findRow(n.index);return o||(o=r.findRow(t.row)),W(De().Tip_Height,[o.height.toFixed(0)])}var i=e._getAllColumnLayout(n.sheetArea);e.getColumnVisible(n.index)||(n.index=this._getPreVisualCol(n.index,n.sheetArea));var a=i.findCol(n.index);return a||(a=i.findCol(t.col)),W(De().Tip_Width,[a.width.toFixed(0)])},_getMouseMoveResizeTooltipContent:function(e){return e.action===Ae||e.action===Me?W(De().Tip_Height,[(e.movingY-e.startY).toFixed(0)]):W(De().Tip_Width,[(e.movingX-e.startX).toFixed(0)])},_repeatKeyDown:function(e,t){var n=this;n._keyPressed&&(t||n._keyDownImp(e),n._keyPressed&&(n._repeatKeyDownTimeoutID=setTimeout(function(){n._repeatKeyDown(e)},500/n._keyPressedCount)))},_startEditByKeyboard:function(e){var t=this._sheet,n=t._getCanvas();if(n){t._startEditByKeydown=!0;try{var r=i(t);if(t._startEditImp&&t._startEditImp(n,t._activeRowIndex,t._activeColIndex,ne,ne,!0),!r&&i(t)){var o=t.getCellType(t._activeRowIndex,t._activeColIndex);!o._triggerButtonClicked||32!==g(e)||_(e)||v(e)||y(e)||o._triggerButtonClicked(t,t._activeRowIndex,t._activeColIndex,3),o._cancelDefaultKeydown&&o._cancelDefaultKeydown(e)}}finally{t._startEditByKeydown=!1}}},_keyDownImp:function(e){var t=this,n=t._sheet;t._setMetaKeyState(e),i(n)||27!==g(e)||y(e)||_(e)||v(e)||!n._validationInputMessage||(O(n._validationInputMessage).remove(),n._validationInputMessage=ne),i(n)||34!==g(e)&&33!==g(e)&&35!==g(e)&&36!==g(e)&&38!==g(e)&&40!==g(e)||B(e),i(n)||37!==g(e)&&39!==g(e)||B(e);var r=e.keyCode,o=e.key,a=e.code,s="("===o&&"Digit9"===a||"<"===o&&"Comma"===a||"["===o&&"BracketLeft"===a||"'"===o&&"Quote"===a,l=n._editor&&0===n._editor.value.indexOf("=");0!==n._editorStatus&&(229===r&&s||l)&&(n._editorStatus=2);var u=n._commandManager(),c=u.getShortcutKey(g(e),_(e),v(e),y(e),b(e)),f=u.getCommands(c);if(f)for(var d=0;d<f.length;d++){var p=f[d].execute(n.parent,{sheetName:n.name()},null,e);if(p)return p.ignoreCancelDefault||B(e),!0}var h={e:e,r:ne};if(k._callFeatureHandler(n,"processKeyDown",h),h.r)return!0;var m="Win32"==navigator.platform||"Windows"==navigator.platform,w=!m&&!H._browser.safari&&229===g(e)||0===g(e);if(n._keydownCode=g(e),t._allowEnterEditing(e)&&!w){var C=n._formulaTextBox;C&&C._isAppending&&C._stopAppending();if(!i(n)){var S=N._gcGlobal._getUIElement(e.target);S&&"gcAttachedFormulaTextBox"===S.getAttribute(Te)||t._startEditByKeyboard(e)}}return!1},_clearRepeatKeyDownTimeout:function(){var e=this;e._keyPressed=!1,e._repeatKeyDownTimeoutID>0&&(clearTimeout(e._repeatKeyDownTimeoutID),e._repeatKeyDownTimeoutID=0)},_doKeyUp:function(e){var t=this;t._clearRepeatKeyDownTimeout();var n=t._sheet;if(n){var r=h(n),o=m(n),a=n.getCellType(r,o),s={isEditing:i(n),sheet:n,row:r,col:o,sheetArea:3},l={sheet:n,row:r,col:o,sheetArea:3};if(a&&a.isReservedKey(e,s))return void(i(n)||a.processKeyUp(e,l));var u=n._formulaTextBox;if(u&&u._isReservedKey(e))return;var c=n.parent&&n.parent._attachedFormulaTextBox;if(c&&c._isReservedKey(e))return}t._setMetaKeyState(e)},_doCompositionStart:function(e){this._startEditByKeyboard(e)},_allowEnterEditing:function(e){return!(_(e)||y(e)||b(e))&&(g(e)>=65&&g(e)<=90||g(e)>=48&&g(e)<=57||g(e)>=96&&g(e)<=105||g(e)>=186&&g(e)<=192||g(e)>=220&&g(e)<=222||219===g(e)||g(e)>=106&&g(e)<=111||32===g(e)||61===g(e)||173===g(e)||229===g(e)||0===g(e)||8===g(e))},_setMetaKeyState:function(e){var t=this,n=t._sheet,r=H._isMacOS(),o=r?b(e):_(e);if(t.ctrl=o&&!v(e),t.shift=v(e)&&!o,n._isNavigateInSelection=!1,9===g(e))if(n._selectionModel.length>1)n._isNavigateInSelection=!0;else{var i=n._getActiveSelectedRange();i&&n._selectionModel.length>0&&(n._isNavigateInSelection=!(n._activeRowIndex===i.row&&n._activeColIndex===i.col&&n._activeRowCount===C(i)&&n._activeColCount===w(i)))}if(!0===t._isDragDropping){var a=n._getActiveSelectedRange(),s=t._isDragInsert,l=t._isDragCopy;-1===a.row||-1===a.col?t._isDragInsert=v(e):t._isDragInsert=!1,t._isDragCopy=_(e),s===t._isDragInsert&&l===t._isDragCopy||n._render._refreshDragDropIndicator&&n._render._refreshDragDropIndicator()}t._isControlPressed=_(e)},_resetMetaKeyState:function(){var e=this;e.shift=!1,e.ctrl=!1,e._sheet._isNavigateInSelection=!1,e._isDragDropping=!1,e._isDragInsert=!1,e._isDragCopy=!1,e._isControlPressed=!1},_updateEditingEditor:function(e){var t,n,r;if(e&&e.sheet?(t=e.sheet,n=e.editor,r=e.canvasOffset):(t=this._sheet,n=t._editor),i(t)){var o=t._activeRowIndex,a=t._activeColIndex,s=t.getCellType(o,a),l=t._getSheetLayout(),u=t.getActualStyle(o,a),c=t.getCellRect(o,a);if(n&&n.parentNode){var f=n.parentNode.parentNode;if(c&&c.width>0&&c.height>0&&c.x>=l._frozenX&&c.y>=l._frozenY&&c.x+c.width<=l._frozenTrailingX+l._frozenTrailingWidth&&c.y+c.height<=l._frozenTrailingY+l._frozenTrailingHeight){var d={sheet:t,row:o,col:a,sheetArea:3,canvasOffset:r};s._updateEditorWrapper(f,u,c,d,!0)}else O(f).css({top:-1e4,left:-1e4})}var p=t._formulaTextBox;p&&p._position()}},_getElementById:function(e,t){if(!e)return ne;for(var n=e.firstChild;n;){if(n.id===t||n.name===t)return n;var r=this._getElementById(n,t);if(r)return r;n=n.nextSibling}return ne},_notEqualSelecions:function(e,t){var n=!0;if(e.length===t.length)for(var r=0;r<e.length;r++){var o=e[r],i=t[r];if(o.row!==i.row||o.col!==i.col||C(o)!==C(i)||w(o)!==w(i)){n=!0;break}n=!1}return n},_createFocusHolder:function(e,t,n,r){var o,i=this,a=i._sheet,s={sheet:a,row:t,col:n,sheetArea:3},l=a._getHost(),u=e.isImeAware(s),c=Oe?pe:"fixed";if(r&&i._destroyFocusHolder(),u&&!i._cellTypeFocusHolder){if(o=e._createCellTypeElement(s),i._focusHolderOldCss||(i._focusHolderOldCss={overflow:Ce,border:Se,position:pe}),i._focusHolderOldCss.overflow=o.style.overflow,i._focusHolderOldCss.border=o.style.border,i._focusHolderOldCss.position=o.style.position,O(o).css(de,c).css(me,we).css(ge,"0px").css(_e,"0px").css(ve,"0px").css(ye,"0px").css(he,Se),a._setEditorValue&&o.firstChild){var f=o.firstChild.firstChild;a._setEditorValue(e,f,t,n,a.getActualStyle(t,n));var d=e.getEditorValue(f,s);V.safari&&(""===d||Y(d))&&e.setEditorValue(f," ",s)}l&&l.insertBefore(o,ne),i._cellTypeFocusHolder=o}if(!i._originalFocusHolder){o=U("div"),O(o).css(de,c).css(me,we).css(ge,"0px").css(_e,"0px").css(ve,"0px").css(ye,"0px"),i._originalFocusHolder=o;var p=U("textarea");O(p).attr(Te,"gcSheetFocusInput").attr(xe,-1).css(de,pe).css(me,we).css(he,Se).css(be,Se),p.value=" ",o.insertBefore(p,ne),i._focusElem=p;var h=U("div");O(h).css(de,pe).css(me,we).attr(Te,"gcSheetFocusInput").attr(xe,-1),o.insertBefore(h,ne),i._readonlyFocusElem=h,l&&l.insertBefore(o,ne)}return Oe&&(i._cellTypeFocusHolder&&i._setVisibleLocation(a,i._cellTypeFocusHolder),i._setVisibleLocation(a,i._originalFocusHolder)),u?i._cellTypeFocusHolder:i._focusElem},_resetFocusHolder:function(){var e=this;e._cellTypeFocusHolder&&e._focusHolderOldCss&&O(e._cellTypeFocusHolder).css(me,e._focusHolderOldCss.overflow).css(he,e._focusHolderOldCss.border).css(de,e._focusHolderOldCss.position)},_destroyFocusHolder:function(){var e=this;e._cellTypeFocusHolder&&(e._cellTypeFocusHolder.parentElement&&e._cellTypeFocusHolder.parentElement.removeChild(e._cellTypeFocusHolder),e._cellTypeFocusHolder=ne)},_setFocus:function(e){K._isActiveElement(this._sheet)||this._setFocusCore(!0,!0,e)},_setFocusToReadonlyFocusElem:function(){var e=this._readonlyFocusElem;e&&e.focus()},_changeFocusHolder:function(){this._setFocusCore(!0,!0)},_clearTouchSetFocusTimeout:function(){this._touchSetFocusTimeout&&(clearTimeout(this._touchSetFocusTimeout),this._touchSetFocusTimeout=ne)},_setFocusCore:function(e,t,n){0===arguments.length&&(e=!0);var r=this;r._focusReleased=!1,r._clearTouchSetFocusTimeout();var o,a,s=r._sheet;o=h(s),a=m(s);var l=s.getCellType(o,a);r._createFocusHolder(l,o,a,t);var u,c={sheet:s,row:o,col:a,sheetArea:3};u=l.isImeAware(c)&&r._cellTypeFocusHolder.firstChild?r._cellTypeFocusHolder.firstChild.firstChild:r._focusElem;var f=u;t&&!V.msie&&l.setImeMode(f,s.getActualStyle(o,a).imeMode,c),F.body.focus();var d=function(){var e=function(){try{l.isImeAware(c)?(l.focus(f,c),l.selectAll(f,c)):(u.focus(),u.select())}catch(e){}};e(),t&&V.msie&&(l.setImeMode(f,s.getActualStyle(o,a).imeMode,c),e())},p=j;if(!s._isTouchMode&&!p.ipad||!e&&l.isImeAware(c))!1===s._enhanceIme||n||d();else if(r._cellTypeFocusHolder&&!i(s)&&(V.metroMode||p.ipad||p.iphone||p.android)){var g=r._cellTypeFocusHolder.firstChild;t&&g&&g.firstChild&&l.setImeMode(g.firstChild,s.getActualStyle(o,a).imeMode,c)}else r._touchSetFocusTimeout=setTimeout(function(){r._clearTouchSetFocusTimeout(),i(s)||!1===s._enhanceIme||n||d()},200);K._isActiveElement(s)||K._setActiveElement(s),r._updateValidationUI&&r._updateValidationUI(s._activeRowIndex,s._activeColIndex)},_setVisibleLocation:function(e,t){var n,r,o=h(e),i=m(e),a=e._activeRowViewportIndex,s=e._activeColViewportIndex,l=e.getCellRect(o,i,a,s),u=this,c=e._getCanvasOffset(),f=u._getCanvasPosition(),d=u._cellTypeFocusHolder,p=0,g=0,_=0,v=0;if(d){var y=O(d);p=parseInt(y.css(ge),10),g=parseInt(y.css(_e),10),_=parseInt(y.css(ye),10),v=parseInt(y.css(ve),10)}u._isInvalidRect(l)?(n=p,r=g):(n=l.y+f.top-2,r=l.x+f.left-2);var b=N.pageYOffset-c.top+f.top,w=N.innerHeight+b-_,C=N.pageXOffset-c.left+f.left,S=N.innerWidth+C-v;(oe(n)||n<b||n>w)&&(n=b),(oe(r)||r<C||r>S)&&(r=C),O(t).css(ge,n).css(_e,r)},_releaseFocus:function(e){var t=this;if(t._clearTouchSetFocusTimeout(),!(i(t._sheet)||t._focusReleased&&F.activeElement===t._readonlyFocusElem)){var n,r,o=t._sheet;e?(n=e.row,r=e.col):(n=o._activeRowIndex,r=o._activeColIndex);var a=o.getCellType(n,r);t._createFocusHolder(a,n,r,!1),t._readonlyFocusElem.focus(),t._focusReleased=!0}},_resumeFocus:function(e){var t=this;0===arguments.length&&(e=!0),t._focusReleased&&(t._focusReleased=!1,t._setFocusCore(e))},_switchFocusForClipboard:function(e){var t=this._sheet,n=t._getClipboardHelper();n&&(n._setClipboardHtml(e),n._focus(),e&&n._select())},_switchBackFocusAfterClipboard:function(){var e=this,t=e._sheet._getClipboardHelper();t&&t._setClipboardHtml(""),e._setFocusCore(!0,!1)},_disposeFocusHolders:function(){var e=this;e._clearTouchSetFocusTimeout();var t=e._cellTypeFocusHolder;t&&(O(t).remove(),e._cellTypeFocusHolder=re),(t=e._originalFocusHolder)&&(O(t).remove(),e._focusElem=re,e._originalFocusHolder=ne,e._readonlyFocusElem=ne)},_showTooltip:function(e,t,n,r){var o=this._sheet.parent;o&&o._showTooltip(e,t,n,r)},_refreshTooltip:function(e,t,n,r){var o=this._sheet.parent;o&&o._refreshTooltip(e,t,n,r)},_removeTooltip:function(){var e=this._sheet.parent;e&&e._removeTooltip()},_setHoverCell:function(e){function t(e,t){var n=!1;return e||t?e&&t&&(n=e.action===t.action&&e.index===t.index&&e.sheetArea===t.sheetArea):n=!0,n}var n=this,r=n._sheet,i=!1,a=r._currentTarget;if(a||(i=!0),i||e||(i=!0),i||(i=e.col!==a.col||e.row!==a.row||d(e)!==d(a)||f(e)!==f(a)||p(e)!==p(a)||!t(e.resizeInfo,a.resizeInfo)),r._currentTarget=e,i){r._hoverCell=!0;var s=r._render,l=o(r,a,s),u=o(r,e,s);l=l||u,r._hoverCell=!1,l&&s._repaintSelection()}},_getAvailableActiveCell:function(e,t,n){var r=this._skipSpanCell(e,t,n);return this._skipInvisibleCell(r)},_skipSpanCell:function(e,t,n){var r=this._sheet._getSpanModel().get(e,t),o=C(r),i=w(r);return 1===o&&1===i?r:n&&1===o||!n&&1===i?r:(n?t++:e++,this._skipSpanCell(e,t,n))},_skipInvisibleCell:function(e){var t,n=this._sheet,r=e.row,o=u(n);for(t=r;t<o&&!0!==n.getRowVisible(t);t++);t<o&&(r=t);var i=e.col,a=c(n);for(t=i;t<a&&!0!==n.getColumnVisible(t);t++);return t<a&&(i=t),z(r,i,C(e),w(e))}},e}();t._SheetEventHandler=Ne,A.prototype={_setAction:function(e){typeof e===fe&&(this._action=e)},_setInterval:function(e){var t=this;if(oe(e)||0===e)t._stop();else{t._needIncrease=e>0,e=ue(e);var n=t._interval;t._interval=e,n!==e&&t._start()}},_start:function(){var e=this;e._clear(),oe(e._interval)||(e._intervalId=setInterval(function(){e._run()},e._interval))},_run:function(){var e=this,t=e._action;e._working=!0,typeof t===fe&&(e._result=t.call(e._host,e._needIncrease))},_stop:function(){var e=this;e._clear(),e._interval=ne,e._intervalId=ne,e._result=ne,e._working=!1},_clear:function(){var e=this._intervalId;e&&clearInterval(e)},_dispose:function(){this._stop()}},e.exports=t},function(e,t,n){function r(e,t){if(e){for(var n=[],r=0;r<t;r++)d(e[r])&&(n[r]=e[r]);return n}}var o=n(0),i=n(6).Worksheet,a=n(9).Style,s=n(3),l=n(23),u=n(4).GC$,c=o.CultureManager,f=i._features,d=s._util._isDefined,p=u.each,h=u.isEmptyObject,m=o._hasOwnProperty,g="columns",_="rows",v="rowHeaderColInfos",y="colHeaderRowInfos",b="data",w="rowHeaderData",C="colHeaderData",S="selections",x="theme",T="spans",E="rowHeaderSpan",M="colHeaderSpan",A="string",k=parseInt,R=isNaN,I=void 0;u.extend(i.prototype,{_setValueToDataTable:function(e,t,n,r){var o=e[t]||(e[t]={});(o[n]||(o[n]={})).value=r},toJSON:function(e){function t(e,t){switch(e){case"defaults":return t.rowHeight===i._defaultRowHeight&&t.colWidth===i._defaultColWidth&&t.rowHeaderColWidth===i._defaultRowHeaderColWidth&&t.colHeaderRowHeight===i._defaultColHeaderRowHeight;case g:case _:case v:case y:return!t||0===t.length;case"frozenRowCount":case"frozenColCount":case"frozenTrailingRowCount":case"frozenTrailingColCount":case"activeRow":case"activeCol":return 0===t;case"rowCount":return 200===t;case"columnCount":return 20===t;case"zoomFactor":case"rowHeaderColCount":case"colHeaderRowCount":return 1===t;case"visible":return!0===t;case b:case w:case C:return h(t);case"tag":return null===t}return!1}function n(e,t,n,r){e[t]=n.toJSON(r)}function o(e,t,n,o){e[t]=r(n._getItems(),o)}var a=this,l=a.getRowCount(),u=a.getColumnCount(),c=a.getRowCount(1),d=a.getColumnCount(2),A={name:a._name,defaults:a.defaults,frozenRowCount:a.frozenRowCount(),frozenColCount:a.frozenColumnCount(),frozenTrailingRowCount:a.frozenTrailingRowCount(),frozenTrailingColCount:a.frozenTrailingColumnCount(),rowCount:l,columnCount:u,activeRow:a._activeRowIndex,activeCol:a._activeColIndex,zoomFactor:a._zoomFactor,rowHeaderColCount:d,colHeaderRowCount:c,visible:a.visible(),tag:a._tag};n(A,T,a._getSpanModel()),n(A,E,a._getSpanModel(2)),n(A,M,a._getSpanModel(1)),n(A,b,a._getModel(),3),n(A,w,a._getModel(2),2),n(A,C,a._getModel(1),1),n(A,S,a._selectionModel),n(A,x,a._currentTheme),o(A,_,a._getRowInfos(),l),o(A,g,a._getColInfos(),u),o(A,v,a._getColInfos(2),d),o(A,y,a._getRowInfos(1),c),f&&p(f,function(t,n){n.toJson&&n.toJson.call(a,A,e)});var k={};for(var R in A)if(m(A,R)){var I=A[R];t(R,I)||(k[R]=I)}p(a.options,function(e,t){var n=t;if("gridline"===e){n={};var r=t.color,o=t.showHorizontalGridline,a=t.showVerticalGridline;r!==s._ThemeStyleHelper._getCssClassThemeStyle("gc-gridlineColor").borderTopColor&&(n.color=r),!0!==o&&(n.showHorizontalGridline=o),!0!==a&&(n.showVerticalGridline=a)}"_ps"!==e&&i._defaultOptions[e]!==n&&("object"==typeof n&&h(n)||(k[e]=n))});var O=[],D=a._namedStyles;if(D){for(var P in D)if(m(D,P)){var N=D[P];N&&O.push(N.toJSON())}O.length>0&&(k.namedStyles=O)}return k},fromJSON:function(e,t,n){function r(e,t,n,r){t&&e.fromJSON(t,n,r)}function o(e,t,n){t&&e._setItems(t,n)}function u(e,t){return d(e)?e:t}function h(e,t,n){d(n)&&t.call(e,n,!1)}if(e){var O=this,D={sheet:O,setStyle:function(e,t,n){s._DataValidatorCache._setStyle(n,this.sheet,e,t)}};O._initOptions(),i._callFeatureHandler(O,"preFromJson"),O.suspendPaint();var P=c.culture();c.culture("");var N=u(e.rowCount,i._defaultRowCount),F=u(e.columnCount,i._defaultColCount);try{O._name=e.name,O.defaults=u(e.defaults,O.defaults),O.setRowCount(N),O.setColumnCount(F),O._namedStyles={};var L=e.namedStyles;if(L)for(var H=0;H<L.length;H++){var V=L[H],j=new a;j.fromJSON(V,n),O._addNamedStyleImp(j)}var B=O.options;for(var U in B)if(m(B,U)){var W=e[U];if("protectionOptions"===U&&(W=W||e.protectionOption),d(W))if("object"==typeof W)for(var z in W)m(W,z)&&(O.options[U][z]=W[z]);else O.options[U]=W}var Y=u(e.activeRow,O._activeRowIndex),G=u(e.activeCol,O._activeColIndex);O._setActiveCellImp(Y,G,I,I,!0),h(O,O.frozenRowCount,e.frozenRowCount),h(O,O.frozenColumnCount,e.frozenColCount),h(O,O.frozenTrailingRowCount,e.frozenTrailingRowCount),h(O,O.frozenTrailingColumnCount,e.frozenTrailingColCount);var K=e.tag;if(d(K)){var X=K.typeName;if(typeof X===A){var q=s.getTypeFromString(X);q&&(K=new q,K.fromJSON&&K.fromJSON(e.tag))}O.tag(K)}var J=e.colStyles;if(J)for(var Z in J)R(Z)||O.setStyle(-1,k(Z,10),J[Z],3);var Q=e.rowStyles;if(Q)for(var $ in Q)R($)||O.setStyle(k($,10),-1,Q[$],3);var ee=u(e.rowHeaderColCount,i._defaultRowHeaderColumnCount),te=u(e.colHeaderRowCount,i._defaultColHeaderRowCount);O.setColumnCount(ee,2),O.setRowCount(te,1),O._zoomFactor=u(e._zoomFactor||e.zoomFactor,O._zoomFactor),h(O,O.visible,e.visible),r(O._getSpanModel(),e[T],n),r(O._getSpanModel(2),e[E],n),r(O._getSpanModel(1),e[M],n),r(O._getModel(),e[b],n,D),r(O._getModel(2),e[w],n),r(O._getModel(1),e[C],n),r(O._selectionModel,e[S],n),o(O._getRowInfos(),e[_],N),o(O._getColInfos(),e[g],F),o(O._getColInfos(2),e[v],ee),o(O._getRowInfos(1),e[y],te);var ne=e[x];if(ne){var re=ne;if(typeof re!==A&&d(re)){var oe=re.themeColor||re._themeColor,ie=new l.ColorScheme(oe.name||oe._name);ie.fromJSON(oe,n),re=new l.Theme(re.name||re._name,ie,re.headingFont||re._headingFont,re.bodyFont||re._bodyFont)}O.currentTheme(re)}f&&p(f,function(r,o){var i=o.fromJson;i&&i.call(O,e,n,!d(t)||t)}),O.clearPendingChanges()}finally{c.culture(P),O.resumePaint()}}}})},function(e,t,n){function r(e){return e.height}function o(e){return e.width}function i(e){var t=e.parent;return A._isActiveElement(e)||t&&!t.options.hideSelection}function a(e){var t=e.parent;return t&&t.options.backColor||J}function s(e){this._init(e)}function l(e,t,n,r){function o(e,t){var n=0;if("string"==typeof e){var r=e.split(" ",4),o=r.length;1===o?n=2*r[0]:2===o||3===o?n=2*r[1]:4===o&&(n=r[1]+r[3])}return n*t}var i=t.font,a=t.textIndent;return i=i?F(i,r).font:n,M._measureText(e,i)+(a?8*a:0)+Z+o(t.cellPadding,r)}function u(e,t,n,r,i,a,s,u,c){var f,d,p,h=e._cachePool,m=o(i),g=o(i),_=i.data,v=i.style,y=i.text,b=v.watermark;if(t.findCell(a,s))return j;if(!(v.cellType||n).allowOverflow||!y&&!b)return j;if(!y&&b&&(y=b),(d=l(y,v,r,e._zoomFactor))<=g)return j;var w=s,C=s;for(f=s+(c?1:-1);(c?f<=u:f>=u)&&!t.findCell(a,f)&&(_=h._getValue(a,f),D(_))&&(p=h._getActualStyle(a,f),!p.watermark)&&(c?C=f:w=f,g+=h._getZoomColWidth(f),!(d<=g));f+=c?1:-1);return c&&C===s||!c&&w===s?j:new L(s,w,C,d,m,g,c?-1:g,c?g:-1)}function c(e,t,n){var r=this;r._sheet=e,r._colLayoutModel=e._getColumnLayout(n),r._cellLayoutModel=e._getCellLayout(t,n),r._defaultFont=F(e._render._getDefaultFont(),e._zoomFactor).font,r._defaultCellType=e._getDefaultCellType(),r._cachedCellOverflowModels={}}function f(e){var t=this;t._needPaint=!1,t._pasteInternal=!1,t._sheet=e,t._bindEvents()}var d=n(0)._ArrayHelper,p=n(6).Worksheet,h=n(3),m=n(8),g=n(13),_=n(54),v=n(7),y=function(){return n(30)},t=n(2),b=n(0),w=t._CanvasHelper,C=h._util,S=C._browser,x=C._getHAlignByValueType,T=h._DPIHelper,E=h._CacheMgr,M=h._WordWrapHelper,A=h._FocusHelper,k=h.Rect,R=h.Events,I=h._ThemeContext,O=h._createRange,D=b._Types._isNullOrUndefined,P=h._ThemeStyleHelper,N=m._DefaultFontSize,F=m._StyleHelper._scaleFont,L=g._CellOverflowLayout,H=g._CellOverflowLayoutModel,V=_._Borders,j=null,B=Math.min,U=Math.max,W=Math.abs,z=Math.floor,Y=Math.ceil,G="black",K="transparent",X="rowHeader",q="columnHeader";p._registerFeature("render",{init:function(){var e=this;e._render=new s(e),e._cutCopyIndicatorManager=new f(e)},dispose:function(e){var t=this;if(!1!==e){t._render=j;var n=t._cutCopyIndicatorManager;n&&(n._dispose(),t._cutCopyIndicatorManager=j)}},onLayoutChanged:function(e){var t=this,n=e.changeType,r=t._cutCopyIndicatorManager;"addRows"===n?r&&r._onRowsAdded():"deleteRows"===n?r&&r._onRowsDeleted():"addColumns"===n?r&&r._onColumnsAdded():"deleteColumns"===n&&r&&r._onColumnsDeleted()}});var J="white";s.prototype={constructor:s,_init:function(e){this._sheet=e},_getCtx:function(){var e=this._sheet,t=j,n=e._getCanvas();return n&&n.getContext&&(t=n.getContext("2d")),t},_getBufferCtx:function(){var e,t=this,n=t._sheet,i=n._getBounds(),a=n._canvas,s=o(a),l=r(a),u=t._buffer;return u&&o(u)===s&&r(u)===l||(u&&T._disposeCanvasForSheet(n,u),t._buffer=u=h._util._createElement("canvas"),u.getContext&&(t._bufferCtx=u.getContext("2d"),T._adjustDevicePixel(u,j,n),T._setSize(u,o(i),r(i)))),e=t._bufferCtx,e&&(e.beginPath(),e.font=t._getZoomFont(t._getDefaultFont()),e.name="bufferContext"),e},_getDefaultFont:function(){return this._defaultFont||(this._defaultFont=N+" "+this._sheet.currentTheme().bodyFont())},_resetDefaultFont:function(){this._defaultFont=j},_getGrayAreaBackColor:function(e){var t=this._sheet,n=t.parent,r=n?n.options.grayAreaBackColor||P._getContentThemeStyle("gc-grayArea").backgroundColor:"gray",o=I._getColor(t,r);return e?((n?n.options.backgroundImage:j)&&(o=K),o):o},_getZoomFont:function(e){var t=this._sheet,n=t._zoomFactor;return 1===n?e:F(e,n).font},_copyDoubleBuffer:function(e,t,n,i,a){var s=this,l=s._buffer,u=s._getCtx();if(!(n<=0||i<=0)&&l&&u){a||(a=s._sheet._getBounds());var c=T._getScaleX(l),f=T._getScaleY(l);1!==c&&(e*=c,t*=f,n*=c,i*=f,a=new k(a.x*c,a.y*f,o(a)*c,r(a)*f));var d=a.getIntersect(e,t,n,i);if(d){d.round(),e=d.x,t=d.y,n=o(d),i=r(d);var p=o(l);p&&e+n>p&&(e=p-n)<0&&(n+=e,e=0);var h=r(l);h&&t+i>h&&(t=h-i)<0&&(i+=t,t=0),S.qtMode&&(e>0&&n--,t>0&&i--),w._scaleTo(u,1,1),u.clearRect(e,t,n,i),u.drawImage(l,e,t,n,i,e,t,n,i),w._scaleTo(u,c,f)}}},_copyDoubleBufferRect:function(e,t){e&&this._copyDoubleBuffer(e.x,e.y,o(e),r(e),t)},_copyScreen:function(e,t,n,i,a,s){if(n>0&&i>0)try{var l=this,u=l._sheet,c=l._getCtx(),f=u._getCanvas(),d=l._getBufferCtx(),p=l._buffer,h=n,m=i,g=a,_=s,v=h,y=m,b=T._getScaleX(f),C=T._getScaleY(f);e=z(e*b),t=z(t*C),n=Y(n*b),i=Y(i*C),g=z(g*b),_=z(_*C),v=Y(v*b),y=Y(y*C);var S=o(p),x=r(p);S&&e+n>S&&(e=S-n)<0&&(n+=e,e=0),x&&t+i>x&&(t=x-i)<0&&(i+=t,t=0),S&&g+v>S&&(g=S-v)<0&&(v+=g,g=0),x&&_+y>x&&(_=x-y)<0&&(y+=_,_=0),w._scaleTo(c,1,1),w._scaleTo(d,1,1),c.clearRect(g,_,v,y),c.drawImage(p,e,t,n,i,g,_,v,y),d.clearRect(g,_,v,y),d.drawImage(f,g,_,v,y,g,_,v,y),w._scaleTo(c,b,C),w._scaleTo(d,b,C)}catch(e){}},_repaintSelection:function(e,t,n,i){var a=this;n||(n=a._getCtx());var s,l,u=!1,c=a._sheet,f=O(-1,-1,-1,-1),d=c._isNavigateInSelection;if(e&&(f=c.options.allowCellOverflow?O(e.row,0,e.rowCount,c.getColumnCount()):O(e.row,e.col,e.rowCount,e.colCount),!d)){if(f.col>=0){var p=f.col,h=f.col+f.colCount-1,m=c.getRowCount(1);s=c._getSpanModel(1);for(var g=0;g<m;g++)l=s.find(g,f.col),l&&(p=B(l.col,p)),(l=s.find(g,f.col+f.colCount-1))&&(h=U(l.col+l.colCount-1,h));f.col=p,f.colCount=h-p+1}if(f.row>=0){var _=f.row,v=f.row+f.rowCount-1,y=c.getColumnCount(2);s=c._getSpanModel(2);for(var b=0;b<y;b++)l=s.find(f.row,b),l&&(_=B(l.row,_)),(l=s.find(f.row+f.rowCount-1,b))&&(v=U(l.row+l.rowCount-1,v));f.row=_,f.rowCount=v-_+1}}var w=c._getRangeWholeRect(f),C=o(w),S=r(w);if(C>=0||S>=0){if(w.x-=9,w.y-=9,w.width+=18,w.height+=30,t&&!(w=w.getIntersectRect(t)))return;var x=c._getSheetLayout();S>0&&!d&&(c._dirty=!0,a._paint(n,new k(x.x,U(x._frozenY,w.y),x._rowHeaderWidth,r(w)),i)),C>0&&!d&&(c._dirty=!0,a._paint(n,new k(U(x._frozenX,w.x),x.y,o(w),x._colHeaderHeight),i)),-1!==f.row||-1!==f.col||d||(c._dirty=!0,a._paint(n,x._headerCornerRect(),i)),C>0&&S>0&&a._paint(n,w),u=!0}return u},_update:function(e,t,n,r,o){var i=this,a=i._sheet;if(a._layoutSuspended<=0){var s=i._getCtx();s&&(o||(a._dirty=!0),i._paint(s,new k(e,t,n,r)))}},repaint:function(e){var t=this,n=t._sheet;if(!(n._layoutSuspended>0)){var r=t._getCtx();r&&(n._dirty=!0,t._paint(r,e))}},_paint:function(e,t,n){var r=this;e&&r._sheet._layoutSuspended<=0&&(n||r._paintBody(e,t),r._paintAdornment(e,t))},_paintBody:function(e,t,n){var i=this,a=i._sheet;if(e&&a._layoutSuspended<=0){var s=i._getBufferCtx(),l=s||e,u=a._getBounds();t||(t=u),t&&t.round(),n&&n.round(),a._dirty&&(a._dirty=!1,s&&(s.clearRect(t.x,t.y,o(t),r(t)),n&&s.clearRect(n.x,n.y,o(n),r(n)),w._translate(s,-u.x,-u.y)),i._paintSheet(l,t),n&&i._paintSheet(l,n),s&&w._translate(s,u.x,u.y)),s&&(i._copyDoubleBufferRect(t),n&&i._copyDoubleBufferRect(n))}},_paintAdornment:function(e,t){var n=this,i=n._sheet,a=i._isTouchMode;if(e&&!(i._layoutSuspended>0)){t&&t.round();var s,l,u,c,f=i._getSheetLayout();if(!i._hoverCell){if(a){for(s=f._headerCornerRect(),n._copyDoubleBufferRect(s),u=0;u<=2;u++)(s=f._rowHeaderRect(u))&&0!==o(s)&&0!==r(s)&&n._copyDoubleBufferRect(s);for(c=0;c<=2;c++)(s=f._colHeaderRect(c))&&0!==o(s)&&0!==r(s)&&n._copyDoubleBufferRect(s)}for(u=0;u<=2;u++)for(c=0;c<=2;c++)(s=f._viewportRect(u,c))&&0!==o(s)&&0!==r(s)&&(l=t,!a||1===u&&1===c||(n._copyDoubleBufferRect(s),l=s),l&&!s.intersectRect(l)||n._paintSelection(e,u,c,l));n._paintResizeLine(e),p._callFeatureHandler(i,"paintAdornment",{ctx:e,clipRect:t})}}},_paintBackground:function(e,t){var n=this._sheet,i=n.parent,s=i?i.options:{},l=a(n),u=I._getColor(n,l);s.backgroundImage&&(u=K),e.save(),e.fillStyle=u,e.fillRect(t.x,t.y,o(t),r(t)),e.restore()},_paintHeadersAndViewport:function(e,t,n){var r,o,i,a=this,s=a._sheet,l=s._getSheetLayout();for(o=0;o<=2;o++){var u=l._colHeaderRect(o);u&&(t?(i=u.getIntersectRect(t))&&a._paintColHeader(e,o,i,n):a._paintColHeader(e,o,u,n))}for(r=0;r<=2;r++){var c=l._rowHeaderRect(r);for(c&&(t?(i=c.getIntersectRect(t))&&a._paintRowHeader(e,r,i,n):a._paintRowHeader(e,r,c,n)),o=0;o<=2;o++){var f=l._viewportRect(r,o);f&&(t?(i=f.getIntersectRect(t))&&a._paintViewport(e,r,o,i,n):a._paintViewport(e,r,o,f,n))}}var d=l._headerCornerRect();d&&(t?(i=d.getIntersectRect(t))&&a._paintColHeaderCorner(e,i,n):a._paintColHeaderCorner(e,d,n))},_paintGrayArea:function(e){var t=this,n=t._sheet,i=n._getSheetLayout(),a=i._headerX,s=i._headerY,l=i._frozenTrailingX,u=i._frozenTrailingY,c=o(i),f=r(i),d=i._viewportY,p=i._viewportX,h=n._getRowLayout(1);if(h.length>0){var m=h[h.length-1],g=m.y+r(m);g<u&&(e.fillStyle=t._getGrayAreaBackColor(!1),e.fillRect(a,g,c,u-g))}else 0===h.length&&(e.fillStyle=t._getGrayAreaBackColor(!1),e.fillRect(a,d,c,u-d));var _=n._getColumnLayout(1);if(_.length>0){var v=_[_.length-1],y=v.x+o(v);y<l&&(e.fillStyle=t._getGrayAreaBackColor(!1),e.fillRect(y,s,l-y,f))}else 0===_.length&&(e.fillStyle=t._getGrayAreaBackColor(!1),e.fillRect(p,s,l-p,f))},_paintSheetBorder:function(e,t){var n=this,i=n._sheet,a=i.options,s=a.borderWidth;s>0&&(e.strokeStyle=a.borderColor,e.lineWidth=s,e.strokeRect(t.x+s/2,t.y+s/2,U(0,o(t)-s),U(0,r(t)-s)))},_paintSheet:function(e,t){var n=this,i=n._sheet;if(e&&!(i._layoutSuspended>0)){E._startCache(i,0,0,i.getRowCount()-1,i.getColumnCount()-1);var a=i._getBounds();e.save(),t?e.rect(t.x,t.y,o(t),r(t)):e.rect(a.x,a.y,o(a),r(a)),e.clip(),e.beginPath(),n._paintBackground(e,a),p._callFeatureHandler(i,"paint",{ctx:e,clipRect:t}),n._paintHeadersAndViewport(e,t,!1),n._paintGrayArea(e),n._paintFrozenLine(e),n._paintSheetBorder(e,a),E._clearCache(),e.beginPath(),e.restore()}},_paintSheetForPrint:function(e,t){var n=this,i=n._sheet;if(e){E._startCache(i,0,0,i.getRowCount()-1,i.getColumnCount()-1);var a=i._getBounds();e.save(),t?e.rect(t.x,t.y,o(t),r(t)):e.rect(a.x,a.y,o(a),r(a)),e.clip(),e.beginPath(),n._paintBackground(e,a),n._paintHeadersAndViewport(e,t,!0),E._clearCache(),e.beginPath(),e.restore()}},_paintResizeLine:function(e){var t,n,i,a,s,l,u=this._sheet,c=u._eventHandler,f=u._currentTarget;if(c&&c.isResizing&&f){var d=f.resizeInfo;if(d){var p=u._getSheetLayout(),h=v.BLUE_COLOR;if(e.save(),e.strokeStyle!==h&&(e.strokeStyle=h),1!==e.lineWidth&&(e.lineWidth=1),e.beginPath(),"sizeRow"===d.action||"sizeHiddenRow"===d.action)for(n=U(0,d.startY-.5),a=d.movingY-.5,s=p.x+o(p),e.moveTo(p.x,n),e.lineTo(s,n),t=p.x;t<s;t+=2)e.moveTo(t,a),e.lineTo(t+1,a);else for(t=U(0,d.startX-.5),i=d.movingX-.5,l=p.y+r(p),e.moveTo(t,p.y),e.lineTo(t,l),n=p.y;n<l;n+=2)e.moveTo(i,n),e.lineTo(i,n+1);e.stroke(),e.beginPath(),e.restore()}}},_paintColHeaderCorner:function(e,t,n){var i=this._sheet;e.beginPath();var a=i._getSheetLayout()._headerCornerRect(),s=a.x,l=a.y,u=o(a),c=r(a),f=i.getActualStyle(-1,-1,0);this._paintCells(e,[{data:j,row:-1,col:-1,x:s,y:l,width:u,height:c,style:f.clone()}],0,n);var d=new V(i,0,0,0);d._addCellLines(0,0,s,l,u,c),d.paint(e,t)},_paintFrozenLine:function(e){var t=this._sheet,n=t.frozenRowCount(),i=t.frozenColumnCount(),a=t.frozenTrailingRowCount(),s=t.frozenTrailingColumnCount();if(n||i||a||s){var l=t._getSheetLayout(),u=l._viewportX,c=l._viewportY,f=l._frozenTrailingX,d=l._frozenTrailingY,p=l.x,h=l.y,m=o(l),g=r(l);e.save(),e.strokeStyle=I._getColor(t,t.options.frozenlineColor),e.lineWidth=1,e.beginPath(),i&&(e.moveTo(u-.5,h),e.lineTo(u-.5,h+g)),n&&(e.moveTo(p,c-.5),e.lineTo(p+m,c-.5)),s&&(e.moveTo(f-.5,h),e.lineTo(f-.5,h+g)),a&&(e.moveTo(p,d-.5),e.lineTo(p+m,d-.5)),e.stroke(),e.restore()}},_paintColHeader:function(e,t,n,r){this._paintViewportImp(e,-1,t,1,n,r)},_paintRowHeader:function(e,t,n,r){this._paintViewportImp(e,t,-1,2,n,r)},_paintViewport:function(e,t,n,r,o){this._paintViewportImp(e,t,n,3,r,o);var i=this._sheet._cutCopyIndicatorManager;i&&i._paintCutCopyIndicator(e,r,t,n)},_paintSelection:function(e,t,n,a){var s=this,l=s._sheet;if(l.addSelection&&i(l)){var u=l._eventHandler,c=l._selectionModel,f=c.length;if(!(a=s._getClipRect(t,n,a)))return;var d=P._getCssClassThemeStyle("gc-selection"),p=parseInt(d.zIndex);p>2007&&s._paintHeaderSelection(e,t,n,a);var h,m=s._getPaintingRects(t,n,c,a),g=m.length;if(g<=0)return;var _,y=!1;for(_=0;_<g;_++)if(h=m[_],!a.containsRect(h)){y=!0;break}if(e.save(),y&&(e.rect(a.x,a.y,o(a),r(a)),e.clip()),e.beginPath(),g>0){var b=I._getColor(l,l.getSelectionBackColor());e.fillStyle!==b&&(e.fillStyle=b);var w=0,C=0;for(_=0;_<g;_++)h=m[_],e.fillRect(h.x+w,h.y+w,o(h)+C,r(h)+C)}var S,x,T,E,M=l.getCellRect(l._activeRowIndex,l._activeColIndex,t,n);if(M&&M.intersectRect(a)&&(S=M.x,x=M.y,T=o(M),E=r(M),w=1,C=-2,p>2007&&(w=0,C=0),s._copyDoubleBuffer(S+w,x+w,T+C,E+C),f>1&&(e.strokeStyle=v.SELECTION_RECT_COLOR,e.lineWidth=1,e.strokeRect(S+.5,x+.5,T-2,E-2))),e.restore(),e.save(),y&&(s._adjustClipRect(a,l,t,n,p),e.rect(a.x,a.y,o(a),r(a)),e.clip()),e.beginPath(),1===f){if(u&&u._isDraggingFill&&u._isDragClear&&u._isDragClear()&&!u._isDragAroundIndicator){var A=u._getCurrentFillRange&&u._getCurrentFillRange(),k=l.getRangeRect(t,n,A),R=o(k),O=r(k);k&&R>0&&O>0&&(e.fillStyle=d&&d.color,e.fillRect(k.x,k.y,R,O))}h&&o(h)>=0&&r(h)>=0&&s._paintSelectionBorder(e,t,n,h,a)}e.beginPath(),e.restore()}},_adjustClipRect:function(e,t,n,i,a){var s=t.frozenTrailingRowCount(),l=t.frozenTrailingColumnCount(),u=t.getSelections(),c=t._getSheetLayout(),f=t.getRowCount()-s-1,d=t.getColumnCount()-l-1,p=t._getColumnLayout(1,3),h=t._getRowLayout(1,3);if(1===u.length&&a>2007){var m=t.frozenRowCount(),g=t.frozenColumnCount(),_=u[0],v=_.row,y=_.col,b=_.rowCount,w=_.colCount;m>0&&(v===m?(e.y-=2,e.height+=2):v+b===m&&m===t._scrollTopRow&&(e.height+=2)),g>0&&(y===g?(e.x-=2,e.width+=2):y+w===g&&g===t._scrollLeftCol&&(e.width+=2)),0===v&&0===y&&(e.x-=2,e.y-=2,e.width+=2,e.height+=2),-1===v&&(v=0,b=t.getRowCount()),-1===y&&(y=0,w=t.getColumnCount());var C=!1,S=!1,x=h.findRow(f),T=p.findCol(d);x&&x.y+r(x)<c._viewportY+c._viewportHeight&&(C=!0),T&&T.x+o(T)<c._viewportX+c._viewportWidth&&(S=!0),C&&v+b-1===f&&(e.height+=2),S&&y+w-1===d&&(e.width+=2)}},_paintHeaderSelection:function(e,t,n,i){var a=this,s=a._sheet,l=s._selectionModel,u=s._getSheetLayout(),c=u._frozenX,f=u._frozenY,d=l.length;if(!(d<=0)){var p=l[0],h=p.row,m=p.rowCount,g=p.col,_=p.colCount;-1===h&&(h=0),-1===g&&(g=0),-1===m&&(m=s.getRowCount()),-1===_&&(_=s.getColumnCount()),e.save(),e.beginPath(),e.lineWidth=2,e.strokeStyle=s.getSelectionBorderColor();var v=i.x,y=i.y,b=o(i),w=r(i),C=s.frozenRowCount();if(1!==d||0!==C||s._scrollTopRow<=h||s._scrollTopRow>=h+m)for(var S=a._getColumnHeaderSelectionRects(n),x=0,T=S.length;x<T;x++){var E=S[x],M=0,A=0,k=E.x,R=E.x+o(E);E.x<v+b&&v<E.x+o(E)&&(1===d&&(0===C&&s._scrollTopRow===h||C>0&&0===h)&&(M=-1,A=1),E.x<v&&(M=0,k=v),E.x+o(E)>v+b&&(A=0,R=v+b),e.moveTo(k+M-1,f-1),e.lineTo(R+A,f-1),e.stroke())}var I=s.frozenColumnCount();if(1!==d||0!==I||s._scrollLeftCol<=g||s._scrollLeftCol>=g+_)for(var O=a._getRowHeaderSelectionRects(t),D=0,P=O.length;D<P;D++){var N=O[D],F=0,L=0,H=N.y,V=N.y+r(N);N.y<y+w&&y<N.y+r(N)&&(1===d&&(0===I&&s._scrollLeftCol===g||I>0&&0===g)&&(F=-1,L=1),N.y<y&&(F=0,H=y),N.y+r(N)>y+w&&(L=0,V=y+w),e.moveTo(c-1,H+F-1),e.lineTo(c-1,V+L),e.stroke())}e.beginPath(),e.restore()}},_getColumnHeaderSelectionRects:function(e){for(var t=this._sheet,n=t._selectionModel,r=n.length,i=t._getColumnLayout(e),a=[],s=0;s<r;s++){var l=n[s];if(l){var u=l.col;if(-1===u){var c=t._getColumnLayout(0,3),f=t._getColumnLayout(1,3),d=t._getColumnLayout(2,3),p=-1,h=-1;c.length>0&&(p=c[0].x,h=c[c.length-1].x+c[c.length-1].width-p,a.push(new k(p,-1,h,-1))),f.length>0&&(p=f[0].x,h=f[f.length-1].x+f[f.length-1].width-p,a.push(new k(p,-1,h,-1))),d.length>0&&(p=d[0].x,h=d[d.length-1].x+d[d.length-1].width-p,a.push(new k(p,-1,h,-1)))}else if(i){var m=i.findCol(u),g=i.findCol(u+l.colCount-1);if(m||g){var _=new k(-1,-1,-1,-1);_.x=m?m.x:i[0].x,_.width=g?g.x+o(g)-_.x:i[i.length-1].x+i[i.length-1].width-_.x,a.push(_)}}}}return a},_getRowHeaderSelectionRects:function(e){for(var t=this._sheet,n=t._selectionModel,o=n.length,i=t._getRowLayout(e),a=[],s=0;s<o;s++){var l=n[s];if(l){var u=l.row;if(-1===u){var c=t._getRowLayout(0,3),f=t._getRowLayout(1,3),d=t._getRowLayout(2,3),p=-1,h=-1;c.length>0&&(p=c[0].y,h=c[c.length-1].y+c[c.length-1].height-p,a.push(new k(-1,p,-1,h))),f.length>0&&(p=f[0].y,h=f[f.length-1].y+f[f.length-1].height-p,a.push(new k(-1,p,-1,h))),d.length>0&&(p=d[0].y,h=d[d.length-1].y+d[d.length-1].height-p,a.push(new k(-1,p,-1,h)))}else if(i){var m=i.findRow(u),g=i.findRow(u+l.rowCount-1);if(m||g){var _=new k(-1,-1,-1,-1);_.y=m?m.y:i[0].y,_.height=g?g.y+r(g)-_.y:i[i.length-1].y+i[i.length-1].height-_.y,a.push(_)}}}}return a},_paintSelectionBorder:function(e,t,n,i,a){var s=this,l=s._sheet,u=l.parent,c=l._eventHandler,f=i.x,d=i.y,p=o(i),h=r(i);if(p>=0&&h>=0&&(!a||i.intersect(a.x-1,a.y-1,o(a)+2,r(a)+2))){if(e.save(),a&&!a.containsRect(i)&&(e.rect(a.x,a.y,o(a),r(a)),e.clip()),e.beginPath(),e.strokeStyle=I._getColor(l,l.getSelectionBorderColor()),e.lineWidth=2,p>0&&h>0){if(c&&c._isDraggingFill){var m=c._currentFillDirection;2===m?(e.moveTo(f+.5,d-.5),e.lineTo(f+p-1,d-.5)):3===m?(e.moveTo(f+.5,d+h-.5),e.lineTo(f+p-1,d+h-.5)):0===m?(e.moveTo(f-.5,d+.5),e.lineTo(f-.5,d+h-1)):1===m&&(e.moveTo(f+p-.5,d+.5),e.lineTo(f+p-.5,d+h-1))}else{(u&&u._themeVersion)>2007?e.rect(f-1,d-1,p+1,h+1):e.rect(f-.5,d-.5,p,h)}e.stroke(),u&&u.options.allowUserDragFill&&s._paintDragFillIndicator&&s._paintDragFillIndicator(e,t,n,i,a)}else 0!==p&&0!==h||e.strokeRect(f-1,d-1,p+1,h+1);e.beginPath(),e.restore()}},_getClipRect:function(e,t,n){var i=this._sheet,a=i._getSheetLayout(),s=a._viewportRect(e,t);if(1===t){var l=i._getColumnLayout(t),u=l.length>0?l[l.length-1]:j;u&&(s.width=B(o(s),u.x+o(u)-a._viewportX))}if(1===e){var c=i._getRowLayout(e),f=c.length>0?c[c.length-1]:j;f&&(s.height=B(r(s),f.y+r(f)-a._viewportY))}return n=n?n.getIntersect(s.x,s.y,o(s),r(s)):s},_getPaintingRects:function(e,t,n,i){for(var a,s,l,u=this._sheet,c=u._getSpanModel(),f=n.length,d=[],p=0;p<f;p++)(s=n[p])&&(a=c.find(s.row,s.col),a&&a.containsRange(s)&&(s=a),(l=u.getRangeRect(e,t,s))&&l.x<=i.x+o(i)&&l.y<=i.y+r(i)&&i.x<=l.x+o(l)&&i.y<=l.y+r(l)&&d.push(l));return d},_paintDashRect:function(e,t,n){e.save();var i=t.x,a=t.y,s=o(t),l=r(t),u=[6,6];if(e.setLineDash&&!S.qtMode)e.beginPath(),e.lineWidth=2,e.strokeStyle=n,e.setLineDash(u),e.rect(i,a,s-1,l-1),e.stroke();else{e.beginPath(),e.lineWidth=2,e.strokeStyle=n;var c,f,d,p,h=u[0],m=u[1];for(c=i,f=a,d=s;d>0;)if(d>=h+m)e.moveTo(c,f),e.lineTo(c+h,f),c=c+h+m,d=d-h-m;else{if(d>=h){e.moveTo(c,f),e.lineTo(c+h,f),d=d-h-m;break}if(d>0){e.moveTo(c,f),e.lineTo(c+d,f),d=d-h-m;break}}for(c=i+s-1,f=a+1,p=l-1,d<0&&(d=W(d),d>m&&(e.moveTo(c,f-2),e.lineTo(c,f+(d-m))),f+=d,p-=d);p>0;)p>=h+m?(e.moveTo(c,f),e.lineTo(c,f+h),f=f+h+m,p=p-h-m):p>=h?(e.moveTo(c,f),e.lineTo(c,f+h),p=p-h-m):p>0&&(e.moveTo(c,f),e.lineTo(c,f+p),p=p-h-m);for(c=i+s-2,f=a+l-1,d=s-1,p<0&&(p=W(p),p>m&&(e.moveTo(c+2,f),e.lineTo(c-(p-m),f)),c-=p,d-=p);d>0;)if(d>=h+m)e.moveTo(c,f),e.lineTo(c-h,f),c=c-h-m,d=d-h-m;else{if(d>=h){e.moveTo(c,f),e.lineTo(c-h,f),d=d-h-m;break}if(d>0){e.moveTo(c,f),e.lineTo(c-d,f),d=d-h-m;break}}for(c=i,f=a+l-2,p=l-1,d<0&&(d=W(d),d>m&&(e.moveTo(c,f+2),e.lineTo(c,f-(d-m))),f-=d,p-=d);p>0;)p>=h+m?(e.moveTo(c,f),e.lineTo(c,f-h),f=f-h-m,p=p-h-m):p>=h?(e.moveTo(c,f),f-h===a?e.lineTo(c,f-h-1):e.lineTo(c,f-h),p=p-h-m):p>0&&(f>a&&(e.moveTo(c,f),e.lineTo(c,f-p)),p=p-h-m);e.stroke()}e.beginPath(),e.restore()},_paintViewportImp:function(e,t,n,i,a,s){D(i)&&(i=3);var l=this,u=l._sheet,f=u.parent,h=f&&f.options.resizeZeroIndicator,m=u._getRowLayout(t,i),g=u._getColumnLayout(n,i),_=m.length,v=g.length;if(!(_<0||v<0)){var y,b,w,C,S=u._getCellLayout(t,n,i),x=S.length>0,T=j,E=j,M=j,A=u._cachePool,k=0,R=0,I=0,O=0,P=new V(u,t,n,i),N=[],F=[],L=3===i&&u.options.allowCellOverflow,H=[],B=!s&&3===i&&f&&f.options.highlightInvalidData;e.save(),a&&(e.rect(a.x,a.y,o(a),r(a)),e.clip()),e.beginPath();for(var U=[],W=-1,z=-1,Y=0;Y<_;Y++){T=m[Y];for(var G=0;G<v;G++)E=g[G],M=x&&S.findCell(T.row,E.col),M?(y=M.row,b=M.col,k=M.x,R=M.y,I=o(M),O=r(M)):(y=T.row,b=E.col,k=E.x,R=T.y,I=o(E),O=r(T)),1===h&&(-1===t&&u.getColumnVisible(b)&&0===u._getActualColumnWidth(b)&&((z<0||z!==b-1)&&U.push({x1:k,y1:R,x2:k,y2:R+O,horizontal:!1}),z=b),-1===n&&u.getRowVisible(y)&&0===u._getActualRowHeight(y)&&((W<0||W!==y-1)&&U.push({x1:k,y1:R,x2:k+I,y2:R,horizontal:!0}),W=y)),a&&(k+I<=a.x||k>=a.x+o(a)||R+O<=a.y||R>=a.y+r(a))||0!==I&&0!==O&&(M&&d._contains(N,M)||(w=A._getValue(y,b,i),C=A._getActualStyle(y,b,i),B&&u.isValid&&!u.isValid(y,b,w)&&H.push({x:k,y:R,width:I,height:O}),P._addCellLines(y,b,k,R,I,O,C,M),F.push({data:w,row:y,col:b,x:k,y:R,width:I,height:O,style:C,cellLayout:M}),M&&N.push(M)))}if(F.length>0){if(L){var K=A._getCellOverflowBuilder(t,n,function(){return new c(u,t,n)});l._buildCellOverflowValueLayout(K,F,P)}l._paintCells(e,F,i,s)}p._callFeatureHandler(u,"paintViewport",{ctx:e,rowViewportIndex:t,colViewportIndex:n,sheetArea:i,clipRect:a,isPrinting:s}),P.paint(e,a),U.length>0&&l._paintDoubleGridLines(e,U,1,3),H.length>0&&l._paintValidationUI(e,H),e.restore()}},_paintDoubleGridLines:function(e,t,n,r){if(0!==t.length)for(var o=0,i=t.length;o<i;o++){var a=t[o],s=a.x1,l=a.y1,u=a.x2,c=a.y2,f=a.horizontal;if(e.beginPath(),e.save(),e.lineWidth=n,e.strokeStyle=this._getHeaderGridLineColor(e,f,s,l,u,c),e.fillStyle=this._getHeaderBackColor(e,f,s,l,u,c),f){var d=-3,p=1,h=-1,m=-2;e.fillRect(s,l+d,u-s-1,r+2*n),w._translate(e,.5,.5),e.moveTo(s+h,l+d),e.lineTo(u+m,c+d),e.moveTo(s+h,l+p),e.lineTo(u+m,c+p)}else{var g=-3,_=1,v=0,y=-1;e.fillRect(s+g,l+v,r+2*n,c-l-1),w._translate(e,.5,.5),e.moveTo(s+g,l+v),e.lineTo(u+g,c+y),e.moveTo(s+_,l+v),e.lineTo(u+_,c+y)}w._translate(e,-.5,-.5),e.stroke(),e.restore()}},_getHeaderBackColor:function(e,t,n,r,o,i){var a,s=t?X:q,l=P._getVisualStateThemeStyle(0,"gc-"+s+"-normal"),u=l&&l.backgroundColor,c=l&&l.backgroundImage;if(!t&&c&&-1!==c.indexOf("linear-gradient")){var f=C._getLinearGradientColors(c);a=e.createLinearGradient(n,r,o,i);for(var d=0,p=f.length;d<p;d++){var h=f[d];a.addColorStop(h.point,h.color)}}else u&&(a=u);return a},_getHeaderGridLineColor:function(e,t,n,r,o,i){var a=e.createLinearGradient(n,r,o,i),s=t?X:q,l=P._getVisualStateThemeStyle(0,"gc-"+s+"-normal");return t?(a.addColorStop(0,l.borderTopColor),a.addColorStop(1,l.borderBottomColor)):(a.addColorStop(0,l.borderLeftColor),a.addColorStop(1,l.borderRightColor)),a},_paintValidationUI:function(e,t){if(t)for(var n=t.length,i=0;i<n;i++){var a=t[i],s=a.x-4,l=a.y-4,u=o(a)+8,c=r(a)+8,f=.5522848,d=u/2*f,p=c/2*f,h=s+u,m=l+c,g=s+u/2,_=l+c/2;e.save(),e.lineWidth=2,e.strokeStyle="red",e.beginPath(),e.moveTo(s,_),e.bezierCurveTo(s,_-p,g-d,l,g,l),e.bezierCurveTo(g+d,l,h,_-p,h,_),e.bezierCurveTo(h,_+p,g+d,m,g,m),e.bezierCurveTo(g-d,m,s,_+p,s,_),e.closePath(),e.stroke(),e.restore()}},_paintCells:function(e,t,n,i){var s=this,l=s._sheet,u=3===n,c=l._zoomFactor,f=F(s._getDefaultFont(),c),d=l.getDefaultStyle(n),m=l._getDefaultCellType(n),g=l.conditionalFormats,_=a(l),v=l._getImageLoader();e.save(),e.beginPath(),e.fillStyle=d&&d.foreColor||G,e.font=f.font,e.textAlign=u?"right":"center";var b,w,C,S,x,T,E,M,A,k,R,I,O,D,P,N,L,H,V=t.length,B=!!y(),W=[],z={sheet:l,row:-1,col:-1,fontInfo:j,lineHeight:-1,imageLoader:v,conditionalFormats:g,sheetArea:n,parentBackColor:_};for(s._sheet.parent.options.lockCellBg&&(H=e.createPattern(s._sheet.parent.options.lockCellBg,"repeat")),b=0;b<V;b++){w=t[b],S=w.data,x=w.row,T=w.col,E=w.x,M=w.y,A=o(w),k=r(w),R=w.style,I=w.cellOverflowLayout,D=R.font?F(R.font,c):f;var Y=!R.wordWrap&&R.shrinkToFit;if(Y){var K=l.getText(x,T,n),X=R.watermark;if(X&&!K&&(K=X),K)for(var q={value:!1},J=0;J<3&&!1===q.value;J++){var Z=l._getStringWidthByCanvas(K,D.font),Q=U(0,A-4);if(1!==R.hAlign&&R.textIndent&&(Q=U(0,Q-8*R.textIndent)),!(Q<Z))break;D=F(D.font,Q/Z,q,!0)}}if(R.font=D.font,A>0&&k>0){C=R.cellType||m,E--,M--,A++,k++,u?(N=B&&l.getSparkline(x,T),z.sparkline=N):(O=i?0:s._getVisualState(x,T,n),z.visualState=O),P=l._getFontHeight(D.font,Y),z.lineHeight=P,z.row=x,z.col=T,z.fontInfo=D,z.cellOverflowLayout=I;var $=s._sheet.getTag(x,T);if("1"===C.typeName&&$&&$.locked?z.lockCellBgPattern=H:z.lockCellBgPattern=null,C.paint(e,S,E,M,A,k,R,z),I&&!z.showBarIconOnly){var ee=new h.Rect(E,M,A,k),te=C._getContentRect?C._getContentRect(ee,R):ee;W.push({cellType:C,data:S,x:te.x,y:te.y,width:te.width,height:te.height,style:R,options:{sheet:l,row:x,col:T,fontInfo:D,lineHeight:P,cellOverflowLayout:I,parentBackColor:_}})}}}if((V=W.length)>0)for(var ne=l.isEditing(),re=l._activeRowIndex,oe=l._activeColIndex,ie=0;ie<V;ie++)if(L=W[ie],C=L.cellType,S=L.data,E=L.x,M=L.y,A=o(L),k=r(L),R=L.style,z=L.options,!ne||z.row!==re||z.col!==oe){var ae=y();ae&&S instanceof ae.SparklineExValue||C.paintValue&&C.paintValue(e,S,E,M,A,k,R,z)}for(e.restore(),b=0,V=t.length;b<V;b++)w=t[b],p._callFeatureHandler(l,"paintCell",{ctx:e,sheetArea:n,cell:w,isPrinting:i})},_getVisualState:function(e,t,n){var r=this._sheet,o=0;return i(r)&&(3===n||D(n)?!r.isEditing()&&r._isActiveCell(e,t)?o=3:r._isSelected(e,t,n)&&(o=2):(r._isSelected(e,t,n)&&(o=1,r._isAllSelected(e,t,n)&&(o=2)),r._isHover(e,t,n)&&(o=4))),o},_buildCellOverflowValueLayout:function(e,t,n){for(var i,a,s,l,u,c,f,d,p,h,m,g,_,v,y,b,w,C=this._sheet,S=C._cachePool,x=t.length,T={},E=[],M=0;M<x;M++){if(i=t[M],l=i.row,u=i.col,c=i.x,f=i.y,p=r(i),v=e._getCellOverflowLayoutModel(l),y=v.headingOverflowlayout,b=v.trailingOverflowLayout,!T[l]){for(var A={},R=0;R<v.length;R++)A[v[R].column]=!1;y&&(A[y.column]=!1),b&&(A[b.column]=!1),T[l]=A}var I=T[l];if(w=v.find(u)){if(w.column===u)d=o(i),h=w.backgroundWidth,m=w.backgroundLeftWidth<0?c:w.backgroundRightWidth<0?c+d-h:c+d/2-w.backgroundLeftWidth,i.cellOverflowLayout=w,I[w.column]&&E.push(M);else if(!I[w.column]){u=w.column,s=S._getActualStyle(l,u),a=C.getValue(l,u),d=w.columnWidth,h=w.backgroundWidth;var O=C.getCellRect(l,w.column);m=w.backgroundLeftWidth<0?O.x:w.backgroundRightWidth<0?O.x+o(O)-h:O.x+o(O)/2-w.backgroundLeftWidth,_={data:a,row:l,col:u,x:O.x,y:f,width:d,height:p,style:s,cellOverflowLayout:w},t.push(_)}w.layout=new k(m,f,h,p),n._addCellOverlfowLayout(l,w),I[w.column]=!0}else if(y&&!I[y.column]&&y.contains(u)){u=y.column,s=S._getActualStyle(l,u),a=C.getValue(l,u),d=y.columnWidth,h=y.backgroundWidth;var D=C.getCellRect(l,y.endColumn);m=D.x+o(D)-h,_={data:a,row:l,col:u,x:m,y:f,width:d,height:p,style:s,cellOverflowLayout:y},t.push(_),y.layout=new k(m,f,h,p),n._addCellOverlfowLayout(l,y),I[y.column]=!0}else if(b&&!I[b.column]&&b.contains(u)){u=b.column,s=S._getActualStyle(l,u),a=C.getValue(l,u),d=b.columnWidth,h=b.backgroundWidth;var P=C.getCellRect(l,b.startColumn);m=P.x,g=P.x+h-d,_={data:a,row:l,col:u,x:g,y:f,width:d,height:p,style:s,cellOverflowLayout:b},t.push(_),b.layout=new k(m,f,h,p),n._addCellOverlfowLayout(l,b),I[b.column]=!0}}if(E.length>0)for(var N=E.length-1;N>=0;N--)t.splice(E[N],1)}},t._SheetRender=s;var Z=2,Q=100;c.prototype={constructor:c,_getCellOverflowLayoutModel:function(e){var t=this,n=t._cachedCellOverflowModels[e];if(n)return n;var r,i,a,s,l,u,c,f,d=t._sheet,p=d._cachePool,h=t._colLayoutModel,m=h.length,g=new H;if(m>0){g.headingOverflowlayout=t._buildHeadingCellOverflowLayout(e);for(var _=h[0].col,v=h[m-1].col,y=0;y<m;y++)r=h[y],o(r)<=0||(i=r.col,s=p._getValue(e,i),a=p._getActualStyle(e,i),D(s)&&!a.watermark||a.shrinkToFit||a.wordWrap||(l=p._getZoomColWidth(i),c=E._getFormattedTextByStyle(d,a,s),u=a.hAlign,3===u&&(u=x(u,s,a.formatter)),0===u?(f=t._buildCellOverflowLayoutForLeft({data:s,style:a,width:l,text:c},e,i,v))&&g.push(f):2===u?(f=t._buildCellOverflowLayoutForRight({data:s,style:a,width:l,text:c},e,i,_))&&g.push(f):1===u&&(f=t._buildCellOverflowLayoutForCenter({data:s,style:a,width:l,text:c},e,i,_,v))&&g.push(f)));g.trailingOverflowLayout=t._buildTrailingCellOverflowLayout(e)}return t._cachedCellOverflowModels[e]=g,g},_buildCellOverflowLayoutForLeft:function(e,t,n,r){var o=this;return u(o._sheet,o._cellLayoutModel,o._defaultCellType,o._defaultFont,e,t,n,r,!0)},_buildCellOverflowLayoutForRight:function(e,t,n,r){var o=this;return u(o._sheet,o._cellLayoutModel,o._defaultCellType,o._defaultFont,e,t,n,r)},_buildCellOverflowLayoutForCenter:function(e,t,n,r,i){var a,s,u,c=this,f=c._sheet,d=f._cachePool,p=c._cellLayoutModel,h=o(e),m=o(e),g=e.data,_=e.style,v=e.text,y=_.watermark;if(p.findCell(t,n))return j;if(!(_.cellType||c._defaultCellType).allowOverflow||!v&&!y)return j;if(!v&&y&&(v=y),(s=l(v,_,c._defaultFont,f._zoomFactor))<=m)return j;var b=n,w=m/2;for(a=n-1;a>=r&&!p.findCell(t,a)&&(g=d._getValue(t,a),D(g))&&(u=d._getActualStyle(t,a),!u.watermark)&&(b=a,w+=d._getZoomColWidth(a),!(s/2<=w));a--);var C=n,S=m/2;for(a=n+1;a<=i&&!p.findCell(t,a)&&(g=d._getValue(t,a),D(g))&&(C=a,S+=d._getZoomColWidth(a),!(s/2<=S));a++);return b===C?j:new L(n,b,C,s,h,w+S,w,S)},_buildHeadingCellOverflowLayout:function(e){for(var t,n,r,o,i,a,s,l,u=this,c=u._sheet,f=c._cachePool,d=u._colLayoutModel,p=d[0].col,h=d[d.length-1].col,m=c._getSpanModel(),g=Q,_=p,v=1;v<g;v++){if((i=_-v)<0)return j;if(m.find(e,i))return j;if(t=f._getActualStyle(e,i),t.wordWrap)return j;if(n=f._getValue(e,i),(r=f._getZoomColWidth(i))>0&&!D(n))return o=t.hAlign,3===o&&(o=x(o,n)),s=E._getFormattedTextByStyle(c,t,n),l={data:n,style:t,width:r,text:s},0===o?a=u._buildCellOverflowLayoutForLeft(l,e,i,h):1===o&&(a=u._buildCellOverflowLayoutForCenter(l,e,i,p,h)),a&&a.endColumn>=p?a:j}},_buildTrailingCellOverflowLayout:function(e){for(var t,n,r,o,i,a,s,l,u=this,c=u._sheet,f=c._cachePool,d=u._colLayoutModel,p=d[0].col,h=d[d.length-1].col,m=c._getSpanModel(),g=Q,_=c.getColumnCount(),v=h,y=1;y<g;y++){if((i=v+y)>=_)return j;if(m.find(e,i))return j;if(n=f._getValue(e,i),(r=f._getZoomColWidth(i))>0&&!D(n))return t=f._getActualStyle(e,i),o=t.hAlign,3===o&&(o=x(o,n)),s=E._getFormattedTextByStyle(c,t,n),l={data:n,style:t,width:r,text:s},2===o?a=u._buildCellOverflowLayoutForRight(l,e,i,p):1===o&&(a=u._buildCellOverflowLayoutForCenter(l,e,i,p,h)),a&&a.startColumn<=h?a:j}}},t._CellOverflowLayoutBuilder=c;var $=".cutCopyIndicator",ee=R.CellChanged,te=R.ClipboardChanged,ne=R.ValueChanged,re=R.ColumnChanged,oe=R.RowChanged,ie=R.RangeChanged,ae=R.ClipboardPasting,se=R.ClipboardPasted;f.prototype={constructor:f,_isPastedInternal:function(e){var t=this;if(0===arguments.length)return t._pasteInternal;t._pasteInternal=e},_needPaintIndicator:function(e){var t=this;if(0===arguments.length)return t._needPaint;if(t._needPaint!==e||e){t._needPaint=e;var n=t._sheet;n&&n._invalidate()}},_bindEvents:function(){function e(){t._needPaintIndicator(!1)}var t=this,n=t._sheet,r=!1,o="resizable",i="isVisible";n._bind(te+$,function(){t._needPaintIndicator(!0)}),n._bind(ne+$,e),n._bind(ee+$,e),n._bind(re+$,function(t,n){var r=n.propertyName;r!==o&&"width"!==r&&r!==i&&e()}),n._bind(oe+$,function(t,n){var r=n.propertyName;r!==o&&"height"!==r&&r!==i&&e()}),n._bind(ie+$,e),n._bind(ae+$,function(){r=t._needPaintIndicator()}),n._bind(se+$,function(e,n){var o=n.cellRange,i=n.sheet,a=i._getClipboardHelper(),s=a._ranges,l=r;if(o&&s&&a._fromSheet){if(t._isPastedInternal()){for(var u=0;u<s.length;u++)if(s[u].intersect(o.row,o.col,o.rowCount,o.colCount)){l=!1;break}}else l=!1;t._needPaintIndicator(l)}})},_paintCutCopyIndicator:function(e,t,n,i){var a=this;if(a._needPaint){var s=a._sheet,l=s._render,u=s.parent,c=u?u.options:{},f=s._getClipboardHelper(),d=f._ranges,p=c.cutCopyIndicatorVisible;D(p)&&(p=!0);var h=I._getColor(s,c.cutCopyIndicatorBorderColor||"blue");if(p&&f._fromSheet===s&&d){var m=s._getSheetLayout(),g=m._viewportRect(n,i),_=l._getPaintingRects(n,i,d,t);if(_&&g){e.save(),e.rect(g.x,g.y,o(g),r(g)),e.clip();for(var v=0;v<_.length;v++)l._paintDashRect(e,_[v],h);e.beginPath(),e.restore()}}}},_onRowsAdded:function(){this._needPaintIndicator(!1)},_onRowsDeleted:function(){this._needPaintIndicator(!1)},_onColumnsAdded:function(){this._needPaintIndicator(!1)},_onColumnsDeleted:function(){this._needPaintIndicator(!1)},_cancelIndicator:function(){this._needPaintIndicator(!1)},_dispose:function(){var e=this._sheet;e._unbind(ee+$),e._unbind(te+$),e._unbind(ne+$),e._unbind(re+$),e._unbind(oe+$),e._unbind(ie+$),e._unbind(ae+$),e._unbind(se+$)}},t._CutCopyIndicatorManager=f,e.exports=t},function(e,t,n){function r(e,t){return e.getColumnCount(t)}function o(e,t){return e.getRowCount(t)}function i(e){return e.rowCount}function a(e){return e.colCount}var t=n(2),s=n(6).Worksheet,l=n(13)._SelectionModel,u=n(3),c=n(0),f=n(4).GC$,d=u._createRange,p=u._ThemeStyleHelper,h=u._FocusHelper,m=c._Types._isNullOrUndefined,g=c._ArrayHelper._getLength,_=null,v=Math.max,y=Math.min,b="gc-selection";t.SelectionPolicy={single:0,range:1,multiRange:2},t.SelectionUnit={cell:0,row:1,column:2},f.extend(s.prototype,{addSelection:function(e,t,n,r){var o=this,s=e,l=t,u=n,c=r;if(-1!==s&&-1!==l){var f=o._getSpanModel().getSpans();if(f&&g(f)>0){var p=o._cellRangeInflate(f,d(e,t,n,r));s=p.row,l=p.col,u=i(p),c=a(p)}}o._selectionModel.add(s,l,u,c),o._invalidate()},setSelection:function(e,t,n,r){this._setSelectionImp(e,t,n,r,2)},_setSelectionImp:function(e,t,n,i,a){var s=this,l=o(s),u=r(s);e>=l&&(e=l-1),t>=u&&(t=u-1);var c=v(0,e),f=v(0,t);s._clearSelectionImp();var d=2===a?h._isActiveElement(s):1===a;s._setActiveCellImp(c,f,s._getRowViewportIndex(c),s._getColumnViewportIndex(f),!d),s.addSelection(e,t,n,i)},getSelections:function(){return this._selectionModel.toArray()},clearSelection:function(){var e=this;e._clearSelectionImp(),e._setActiveCellImp(0,0),s._callFeatureHandler(e,"clearSelection"),e._invalidate()},_clearSelectionImp:function(){this._selectionModel.clear()},_canSelect:function(e,t,n){var i=this,a=i.options,s=a.protectionOptions,l=!1!==s.allowSelectLockedCells,u=!1!==s.allowSelectUnlockedCells;if(!a.isProtected||l&&u)return!0;if(!l&&!u)return!1;var c=n?n.locked:i._getStyleProperty(e,t,"locked"),f=t<0,d=e<0;if(l===c&&(d||f)){var p=d?o(i):1;e=d?0:e;var h=f?r(i):1;t=f?0:t;var m,g,_=i._getModel(),v=_.dataTable,y=e+p-1,b=t+h-1;for(m=e;m<=y;m++){var w=v[m];if(w)for(g=t;g<=b;g++){var C=w[g];if(C&&C.style&&l!==C.style.locked)return!1}}if(d)for(m=e;m<=y;m++)if((n=_.getStyle(m,-1))&&l!==n.locked)return!1;if(f)for(g=t;g<=b;g++)if((n=_.getStyle(-1,g))&&l!==n.locked)return!1}return l===c},selectionPolicy:function(e){var t=this,n=t._selectionModel;return 0===arguments.length?n._selectionPolicy:(n._selectionPolicy=e,t)},selectionUnit:function(e){var t=this,n=t._selectionModel;return 0===arguments.length?n._selectionUnit:(n._selectionUnit=e,t)},getSelectionBackColor:function(){return this.options.selectionBackColor||p._getCssClassThemeStyle(b).backgroundColor},getSelectionBorderColor:function(){return this.options.selectionBorderColor||p._getCssClassThemeStyle(b).borderTopColor},_saveAndClearSheetSelections:function(){var e=this,t=e._selectionModel;g(t)>0&&(e._selectionModelCache=t.toJSON(),e._clearSelectionImp(),e._render._repaintSelection())},_loadAndSetSheetSelections:function(){var e=this,t=e._selectionModelCache;t&&e._selectionModel.fromJSON(t)},_moveActiveCellUp:function(e,t,n){var r=this,o=r._getMoveUpCell(e,t,n,r._leadingCellCol||0);if(o){var i=o.row,a=o.col,s=o.leadingCellCol;r._canMoveCurrentTo(i,a)&&(r._leadingCellRow=i,r._leadingCellCol=s,r._setActiveCellCore(i,a))}},_getMoveUpCell:function(e,t,n,i){var a=this,s=o(a),l=r(a),u=e,c=t;if(0===u&&!n||0===s||0===l)return _;var f=a._getPrevRow(u,i);return n||a._adjustCell(f),u=f.r,c=f.c,u<0&&n&&(c=a._getPrevVisualColumn(c),(c<0||m(c))&&(c=a._getPrevVisualColumn(l)),i=c,f=a._getPrevRow(s,c),u=f.r,(c=f.c)===t&&u<=e)?_:{row:u,col:c,leadingCellCol:i}},_moveActiveCellDown:function(e,t,n){var r=this,o=r._getMoveDownCell(e,t,n,r._leadingCellCol||0);if(o){var i=o.row,a=o.col,s=o.leadingCellCol;r._canMoveCurrentTo(i,a)&&(r._leadingCellRow=i,r._leadingCellCol=s,r._setActiveCellCore(i,a))}},_getMoveDownCell:function(e,t,n,i){var a=this,s=o(a),l=r(a),u=e,c=t;if((u!==s-1||n)&&0!==s&&0!==l){var f=a._getNextRow(u,i);if(n||a._adjustCell(f),u=f.r,c=f.c,!(u===s&&n&&(c=a._getNextVisualColumn(c),(c>=l||m(c))&&(c=a._getNextVisualColumn(-1)),i=c,f=a._getNextRow(-1,c),u=f.r,(c=f.c)===t&&u>=e)))return{row:u,col:c,leadingCellCol:i}}},_moveActiveCellLast:function(){var e=this,t=e._getMoveLastCell();if(t){var n=t.row,r=t.col;e._leadingCellRow=n,e._leadingCellCol=r,e._setActiveCellCore(n,r)}},_getMoveLastCell:function(){var e=this,t=e._getLastVisualRow(),n=e._getLastVisualColumn(),r=n;if(!t&&!r)return _;var o=e.options,i=o.protectionOptions,a=!1!==i.allowSelectLockedCells,s=!1!==i.allowSelectUnlockedCells;if(!o.isProtected||a&&s)return{row:t,col:r};if(!a&&!s)return _;for(;t!==_&&t>=0;t=e._getPrevVisualRow(t))for(r=n;r!==_&&r>=0;r=e._getPrevVisualColumn(r)){var l=e._getStyleProperty(t,r,"locked");if(a===l)return{row:t,col:r}}return _},_moveActiveCellFirst:function(){var e=this,t=e._getMoveFirstCell();if(t){var n=t.row,r=t.col;e._leadingCellRow=n,e._leadingCellCol=r,e._setActiveCellCore(n,r)}},_getMoveFirstCell:function(){var e=this,t=e._getNextVisualRow(e.frozenRowCount()-1),n=e._getNextVisualColumn(e.frozenColumnCount()-1),r=n,o=e._getLastVisualRow(),i=e._getLastVisualColumn();if(t===_||r===_)return _;var a=e.options,s=a.protectionOptions,l=!1!==s.allowSelectLockedCells,u=!1!==s.allowSelectUnlockedCells;if(!a.isProtected||l&&u)return{row:t,col:r};if(!l&&!u)return _;for(;t!==_&&t<=o;t=e._getNextVisualRow(t))for(r=n;r!==_&&r<=i;r=e._getNextVisualColumn(r)){var c=e._getStyleProperty(t,r,"locked");if(l===c)return{row:t,col:r}}return _},_moveActiveCellLeft:function(e,t,n){var r=this,o=r._getMoveLeftCell(e,t,n,r._leadingCellRow||0);if(o){var i=o.row,a=o.col,s=o.leadingCellRow;r._canMoveCurrentTo(i,a)&&(r._leadingCellRow=s,r._leadingCellCol=a,r._setActiveCellCore(i,a))}},_getMoveLeftCell:function(e,t,n,i){var a=this,s=o(a),l=r(a),u=e,c=t;if(0===c&&!n||0===s||0===l)return _;var f=a._getPrevColumn(i,c),d=i;for(n||a._adjustCell(f),u=f.r,c=f.c;c<0&&n;){if(u=a._getPrevVisualRow(u,3,!0),(u<0||m(u))&&(u=a._getPrevVisualRow(s,3,!0)),i=u,f=a._getPrevColumn(i,l),u=f.r,c=f.c,u===e&&c<t)return _;if(u===e&&c===t){if(i===d)return _;f=a._getPrevColumn(i,c),u=f.r,c=f.c}}return{row:u,col:c,leadingCellRow:i}},_adjustCell:function(e){var t=this;e.r<0?e.r=t._getFirstVisualRow():e.r>=o(t)&&(e.r=t._getLastVisualRow()),e.c<0?e.c=t._getFirstVisualColumn():e.c>=r(t)&&(e.c=t._getLastVisualColumn())},_moveActiveCellLeftInSelection:function(e,t){for(var n,r=this,o=r._selectionModel,s=o._activeSelectedRangeIndex,l=-1,u=r._getActualRange(r._getActiveSelectedRange()),c=u.row,f=u.col,d=u.col+a(u)-1,p=e,h=t;n=r._getPrevColumnInSelection(p,h),p=n.r,!((h=n.c)>=f);){if(l===s&&p===e&&h<=t)return;if(--p>=c)h=d+1;else{var m=r._getActualRange(r._getActiveSelectedRange(3));l=o._activeSelectedRangeIndex,c=m.row,f=m.col,d=m.col+a(m)-1,p=m.row+i(m)-1,h=m.col+a(m)}}p>=0&&(r._setActiveCellCore(p,h),r._leadingCellRow=p,r._leadingCellCol=h)},_moveActiveCellRightInSelection:function(e,t){for(var n,r=this,o=r._selectionModel,s=o._activeSelectedRangeIndex,l=-1,u=r._getActualRange(r._getActiveSelectedRange()),c=u.col,f=u.row+i(u)-1,d=u.col+a(u)-1,p=e,h=t;n=r._getNextColumnInSelection(p,h),p=n.r,!((h=n.c)<=d);){if(l===s&&p===e&&h>=t)return;if(++p<=f)h=c-1;else{var m=r._getActualRange(r._getActiveSelectedRange(4));l=o._activeSelectedRangeIndex,c=m.col,f=m.row+i(m)-1,d=m.col+a(m)-1,p=m.row,h=m.col-1}}p>=0&&(r._setActiveCellCore(p,h),r._leadingCellRow=p,r._leadingCellCol=h)},_moveActiveCellRight:function(e,t,n){var r=this,o=r._getMoveRightCell(e,t,n,r._leadingCellRow||0);if(o){var i=o.row,a=o.col,s=o.leadingCellRow;r._canMoveCurrentTo(i,a)&&(r._leadingCellRow=s,r._leadingCellCol=a,r._setActiveCellCore(i,a))}},_getMoveRightCell:function(e,t,n,i){var a=this,s=o(a),l=r(a),u=e,c=t;if(c===l-1&&!n||0===s||0===l)return _;var f=a._getNextColumn(i,c),d=i;if(!n){if(f.c===l)return _;a._adjustCell(f)}for(u=f.r,c=f.c;c===l&&n;){if(u=a._getNextVisualRow(u,!0),(u>=s||m(u))&&(u=a._getNextVisualRow(-1,!0)),i=u,f=a._getNextColumn(i,-1),u=f.r,c=f.c,u===e&&c>t)return _;if(u===e&&c===t){if(i===d)return _;f=a._getNextColumn(i,c),u=f.r,c=f.c}}return{row:u,col:c,leadingCellRow:i}},_getPrevColumn:function(e,t){for(var n,r=this,o=t;o>=0&&(n=e,!(--o<0));){var i=r.getSpans(d(n,o,1,1));if(i&&g(i)>0){var a=i[0];o>=a.col&&(o=a.col,n=a.row)}if(r._canMoveCurrentTo(n,o))return{r:n,c:o}}return{r:n,c:o}},_getPrevColumnInSelection:function(e,t){for(var n=this;t>=0&&!(--t<0);){var r=n._getSpanModel().find(e,t);if(r){var o=n._getActiveSelectedRange();if(!(o.row<=r.row&&r.row+i(r)<=o.row+i(o)&&o.col<=r.col&&r.col+a(r)<=o.col+a(o)))continue;if(r.row!==e||r.col!==t)continue;t>=r.col&&(t=r.col,e=r.row)}if(n._canMoveCurrentTo(e,t))return{r:e,c:t}}return{r:e,c:t}},_getNextColumn:function(e,t){for(var n,o=this,i=r(o),s=t;s<i;){n=e;if((s+=a(o._getSpanModel().get(n,s)))>=i)break;var l=o.getSpans(d(n,s,1,1));if(l&&g(l)>0){var u=l[0];s>u.col?s=v(s,u.col+a(u)):n=u.row}if(o._canMoveCurrentTo(n,s))return{r:n,c:s}}return{r:n,c:s}},_getNextColumnInSelection:function(e,t){for(var n=this,o=n._getSpanModel(),s=r(n);t<s;){var l=o.get(e,t);if((t=l.col+a(l))>=s)break;var u=o.find(e,t);if(u){var c=n._getActiveSelectedRange();if(!(c.row<=u.row&&u.row+i(u)<=c.row+i(c)&&c.col<=u.col&&u.col+a(u)<=c.col+a(c)))continue;if(u.row!==e||u.col!==t)continue;t>u.col?t=v(t,u.col+a(u)):e=u.row}if(n._canMoveCurrentTo(e,t))return{r:e,c:t}}return{r:e,c:t}},_canMoveCurrentTo:function(e,t){var n=this;if(!n._canSelect(e,t))return!1;var i=e>=0&&e<o(n)&&t>=0&&t<r(n)&&n.getRowVisible(e)&&n.getColumnVisible(t)&&n._getZoomRowHeight(e)>0&&n._getZoomColumnWidth(t)>0,a=!!n._isTabNavigation;if(!0===i&&!0===a){!1===n._getStyleProperty(e,t,"tabStop")&&(i=!1)}return i},_getPrevRow:function(e,t){for(var n=this;e>=0&&!(--e<0);){var r=n.getSpans(d(e,t,1,1));if(r&&g(r)>0){var o=r[0];e>=o.row&&(e=o.row,t=o.col)}if(n._canMoveCurrentTo(e,t))return{r:e,c:t}}return{r:e,c:t}},_getNextRow:function(e,t){for(var n=this,r=o(n);e<r;){if((e+=i(n._getSpanModel().get(e,t)))>=r)break;var a=n.getSpans(d(e,t,1,1));if(a&&g(a)>0){var s=a[0];e>s.row?e=v(e,s.row+i(s)):t=s.col}if(n._canMoveCurrentTo(e,t))return{r:e,c:t}}return{r:e,c:t}},_setSelectedRange:function(e,t,n,r,o){var i=this;i._selectionModel.add(e,t,n,r),o&&i._layoutSuspended<=0&&i._render._repaintSelection()},_extendSelectedRange:function(e,t,n){var r=this,o=r._getExtendedRange(e,t,r._activeRowIndex,r._activeColIndex),s=o.row,l=o.col,u=i(o),c=a(o),f=r.selectionPolicy(),d=r.selectionUnit();0!==f&&(1===f&&r._selectionModel.clear(),1===d?(l=-1,c=-1):2===d&&(s=-1,u=-1),r._replaceActiveSelectedRange(s,l,u,c,n))},_getExtendedRange:function(e,t,n,r){var o=this;m(n)&&(n=o._activeRowIndex),m(r)&&(r=o._activeColIndex);var i=o._getSpanModel(),a=i.get(n,r),s=i.get(e,t),l=a.union(s),u=o.getSpans();return u&&g(u)>0&&(l=o._inflateRangeToCoverSpans(u,l)),l},_replaceActiveSelectedRange:function(e,t,n,r,o){var s=this,l=s._selectionModel,u=s._getActiveSelectedRange();if(g(l)>0?l.splice(l._activeSelectedRangeIndex,1,d(e,t,n,r)):l.add(e,t,n,r),o&&s._layoutSuspended<=0){var c=s._getActiveSelectedRange();if(c.row===u.row&&c.col===u.col&&i(c)===i(u)&&a(c)===a(u))return;var f=s._render;u.containsRange(c)?f._repaintSelection(u):c.containsRange(u)?f._repaintSelection(c):(f._repaintSelection(u),f._repaintSelection(c))}},_changeActiveSelectedRange:function(e,t){var n=this;if(!(g(n._selectionModel)<=0)){var r=n._getActiveSelectedRange(),o=n._getKeyboardSelectedRange(r,e,t);if(o){var s=n._selectionModel.toArray(),l=o.row,u=o.col,c=i(o),f=a(o),d=n.selectionPolicy(),p=n.selectionUnit();if(0===d)return;1===d&&n._selectionModel.clear(),1===p?(u=-1,f=-1):2===p&&(l=-1,c=-1),n._replaceActiveSelectedRange(l,u,c,f,!0);var h=n._selectionModel.toArray();n._eventHandler._notEqualSelecions(s,h)&&(n._raiseSelectionChanging(s,h),n._raiseSelectionChanged(s))}}},_getKeyboardSelectedRange:function(e,t,n,r,o){var i=this,a=i._getActualRange(e),s=_;return 37===t?s=n?i._searchSelectedRangebyLeftCtrl(a,!1,r,o):i._searchSelectedRangebyLeft(a,r,o):39===t?s=n?i._searchSelectedRangebyRightCtrl(a,!1,r,o):i._searchSelectedRangebyRight(a,r,o):38===t?s=n?i._searchSelectedRangebyUpCtrl(a,!1,r,o):i._searchSelectedRangebyUp(a,r,o):40===t?s=n?i._searchSelectedRangebyDownCtrl(a,!1,r,o):i._searchSelectedRangebyDown(a,r,o):36===t?s=n?i._searchSelectedRangebyHomeCtrl(a,r,o):i._searchSelectedRangebyHome(a,r,o):35===t?s=n?i._searchSelectedRangebyEndCtrl(a,r,o):i._searchSelectedRangebyEnd(a,r,o):33===t?s=i._searchSelectedRangebyPageUp(a,r,o):34===t&&(s=i._searchSelectedRangebyPageDown(a,r,o)),s&&(e.row<0&&(s.row=-1,s.rowCount=-1),e.col<0&&(s.col=-1,s.colCount=-1)),s},_searchSelectedRangebyLeft:function(e,t,n){for(var r,o,s,l,u,c,f,p=this,h=e.row,m=e.col,g=i(e),b=a(e),w=m+b-1,C=0,S=h+g-1;w>C;)if(w--,p._canMoveCurrentTo(S,w)&&(r=p._getExtendedRange(S,w,t,n),o=y(h,r.row),s=y(m,r.col),l=v(h+g-1,r.row+i(r)-1),u=y(m+b-1,r.col+a(r)-1),c=l-o+1,f=u-s+1,o!==h||s!==m||c!==g||f!==b)){var x=p._scrollLeftCol,T=p._activeColIndex;return m<T?s<=x&&p._setLeftColumn(s):m===T&&u<=x&&p._setLeftColumn(u),d(o,s,c,f)}return _},_searchSelectedRangebyLeftCtrl:function(e,t,n,r){var o=this,s=e.row,l=e.col,u=o.frozenColumnCount(),c=u?o._getNextVisualColumn(u-1):o._getFirstVisualColumn(),f=t?c:o._getFirstVisualColumn();if(!m(f)){(u<=0||t)&&o._setLeftColumn(f);var p,h,g,_,b,w,C;return p=o._getExtendedRange(s,f,n,r),h=y(s,p.row),g=y(l,p.col),_=v(s+i(e)-1,p.row+i(p)-1),b=y(l+a(e)-1,p.col+a(p)-1),w=_-h+1,C=b-g+1,d(h,g,w,C)}},_searchSelectedRangebyRight:function(e,t,n){for(var o,s,l,u,c,f,p,h=this,m=e.row,g=e.col,b=i(e),w=a(e),C=g,S=r(h)-1,x=m+b-1;C<S;)if(C++,h._canMoveCurrentTo(x,C)&&(o=h._getExtendedRange(x,C,t,n),s=y(m,o.row),l=v(g,o.col),u=v(m+b-1,o.row+i(o)-1),c=v(g+w-1,o.col+a(o)-1),f=u-s+1,p=c-l+1,s!==m||l!==g||f!==b||p!==w)){var T=h._getPageRightColumn(),E=h._activeColIndex;return g<E?l>=T&&h._setLeftColumn(h._getNewLeftColumn(l,2)):g===E&&c>=T&&h._setLeftColumn(h._getNewLeftColumn(c,2)),d(s,l,f,p)}return _},_searchSelectedRangebyRightCtrl:function(e,t,n,r){var o=this,s=e.row,l=e.col,u=o._getLastPageLeftColumn();if(!m(u)){o._setLeftColumn(u);var c=o._getLastVisualColumn();t||(c+=o.frozenTrailingColumnCount());var f,p,h,g,_,b,w;return f=o._getExtendedRange(s,c,n,r),p=y(s,f.row),h=v(l,f.col),g=v(s+i(e)-1,f.row+i(f)-1),_=v(l+a(e)-1,f.col+a(f)-1),b=g-p+1,w=_-h+1,d(p,h,b,w)}},_searchSelectedRangebyUp:function(e,t,n){for(var r,o,s,l,u,c,f,p=this,h=e.row,m=e.col,g=i(e),b=a(e),w=h+g-1,C=0,S=m+b-1;w>C;)if(w--,p._canMoveCurrentTo(w,S)&&(r=p._getExtendedRange(w,S,t,n),o=y(h,r.row),s=y(m,r.col),l=y(h+g-1,r.row+i(r)-1),u=v(m+b-1,r.col+a(r)-1),c=l-o+1,f=u-s+1,o!==h||s!==m||c!==g||f!==b)){var x=p._scrollTopRow,T=p._activeRowIndex;return h<T?o<=x&&p._setTopRow(o):h===T&&l<=x&&p._setTopRow(l),d(o,s,c,f)}return _},_searchSelectedRangebyUpCtrl:function(e,t,n,r){var o=this,s=e.row,l=e.col,u=o.frozenRowCount(),c=u?o._getNextVisualRow(u-1):o._getFirstVisualRow(),f=t?c:o._getFirstVisualRow();if(!m(f)){(u<=0||t)&&o._setTopRow(f);var p,h,g,_,b,w,C;return p=o._getExtendedRange(f,l,n,r),h=y(s,p.row),g=y(l,p.col),_=y(s+i(e)-1,p.row+i(p)-1),b=v(l+a(e)-1,p.col+a(p)-1),w=_-h+1,C=b-g+1,d(h,g,w,C)}},_searchSelectedRangebyDown:function(e,t,n){for(var r,s,l,u,c,f,p,h=this,m=e.row,g=e.col,b=i(e),w=a(e),C=m,S=o(h)-1,x=g+w-1;C<S;)if(C++,h._canMoveCurrentTo(C,x)&&(r=h._getExtendedRange(C,x,t,n),s=v(m,r.row),l=y(g,r.col),u=v(m+b-1,r.row+i(r)-1),c=v(g+w-1,r.col+a(r)-1),f=u-s+1,p=c-l+1,s!==m||l!==g||f!==b||p!==w)){var T=h._getPageBottomRow(),E=h._activeRowIndex;return m<E?s>=T&&h._setTopRow(h._getNewTopRow(s,2)):m===E&&u>=T&&h._setTopRow(h._getNewTopRow(u,2)),d(s,l,f,p)}return _},_searchSelectedRangebyDownCtrl:function(e,t,n,r){var o=this,s=e.row,l=e.col,u=o._getLastPageTopRow();if(!m(u)){o._setTopRow(u);var c=o._getLastVisualRow();t||(c+=o.frozenTrailingRowCount());var f,p,h,g,_,b,w;return f=o._getExtendedRange(c,l,n,r),p=v(s,f.row),h=y(l,f.col),g=v(s+i(e)-1,f.row+i(f)-1),_=v(l+a(e)-1,f.col+a(f)-1),b=g-p+1,w=_-h+1,d(p,h,b,w)}},_searchSelectedRangebyHome:function(e,t,n){for(var r,o,s,l,u,c,f,p=this,h=e.row,m=e.col,g=i(e),b=a(e),w=p.frozenColumnCount()-1,C=p._activeColIndex,S=h+g-1;w<C;)if(w++,p._canMoveCurrentTo(S,w)){if(m<=w&&m+b-1===p._activeColIndex)break;return r=p._getExtendedRange(S,w,t,n),o=y(h,r.row),s=y(m,r.col),l=v(h+g-1,r.row+i(r)-1),u=y(m+b-1,r.col+a(r)-1),c=l-o+1,f=u-s+1,p._setLeftColumn(p._getFirstVisualColumn()),d(o,s,c,f)}return _},_searchSelectedRangebyHomeCtrl:function(e,t,n){return e=this._searchSelectedRangebyLeftCtrl(e,!0,t,n),e=this._searchSelectedRangebyUpCtrl(e,!0,t,n)},_searchSelectedRangebyEnd:function(e,t,n){for(var o,s,l,u,c,f,p,h=this,m=e.row,g=e.col,b=i(e),w=a(e),C=r(h),S=h._activeColIndex,x=m+b-1;C>S;)if(C--,h._canMoveCurrentTo(x,C)){if(g+w-1>=C&&g===h._activeColIndex)break;return o=h._getExtendedRange(x,C,t,n),s=y(m,o.row),l=v(g,o.col),u=v(m+b-1,o.row+i(o)-1),c=v(g+w-1,o.col+a(o)-1),f=u-s+1,p=c-l+1,h._setLeftColumn(h._getLastPageLeftColumn()),d(s,l,f,p)}return _},_searchSelectedRangebyEndCtrl:function(e,t,n){return e=this._searchSelectedRangebyRightCtrl(e,!0,t,n),e=this._searchSelectedRangebyDownCtrl(e,!0,t,n)},_searchSelectedRangebyPageUp:function(e,t,n){var r=this,o=e.row,s=e.col,l=i(e),u=r._getPrevPageTopRow();if(m(u))return _;var c=r._getRowLayout(1),f=r._setTopRow(u),p=-1;f?p=r._getNextVisualRow(o+l-1-g(c)):r.frozenRowCount()<=0&&(p=r._getFirstVisualRow()),p<r._scrollTopRow?p=r._scrollTopRow:p>=r._getPageBottomRow()&&(p=r._getPrevVisualRow(r._getPageBottomRow()));var h,b,w,C,S,x,T;return h=r._getExtendedRange(p,s,t,n),b=y(o,h.row),w=y(s,h.col),C=y(o+l-1,h.row+i(h)-1),S=v(s+a(e)-1,h.col+a(h)-1),x=C-b+1,T=S-w+1,d(b,w,x,T)},_searchSelectedRangebyPageDown:function(e,t,n){var r=this,o=e.row,s=e.col,l=i(e),u=r._getNextPageTopRow();if(m(u))return _;var c=r._getRowLayout(1);r._setTopRow(u);var f=r._getPrevVisualRow(o+l-1+g(c));f<r._scrollTopRow?f=r._scrollTopRow:f>=r._getPageBottomRow()&&(f=r._scrollTopRow>=r._getLastPageTopRow()?r._getPageBottomRow():r._getPrevVisualRow(r._getPageBottomRow()));var p,h,b,w,C,S,x;return p=r._getExtendedRange(f,s,t,n),h=v(o,p.row),b=y(s,p.col),w=v(o+l-1,p.row+i(p)-1),C=v(s+a(e)-1,p.col+a(p)-1),S=w-h+1,x=C-b+1,d(h,b,S,x)},_getPrevPageTopRow:function(){var e=this,t=e._getRowLayout(1);if(!t||g(t)<=0)return _;for(var n=e.frozenRowCount(),r=n?e._getNextVisualRow(n-1):e._getFirstVisualRow(),o=0,i=e._scrollTopRow,a=e._getSheetLayout();i>r&&(i--,!((o+=e._getZoomRowHeight(i))>a._viewportHeight)););return i},_getPrevPageLeftColumn:function(){var e=this,t=e._getColumnLayout(1);if(!t||g(t)<=0)return _;for(var n=e.frozenColumnCount(),r=n?e._getNextVisualColumn(n-1):e._getFirstVisualColumn(),o=0,i=e._scrollLeftCol,a=e._getSheetLayout();i>r&&(i--,!((o+=e._getZoomColumnWidth(i))>a._viewportWidth)););return i},_getNextPageTopRow:function(){var e,t=this._getRowLayout(1);if(t&&(e=g(t))>0){var n=t[e-1].row;return this._getLastVisualRow()===n?this._scrollTopRow:n}return _},_getLastPageTopRow:function(){var e=this;if(e._getLastVisualRow()===e._getPageBottomRow()){var t,n=e._getSheetLayout(),r=e._getRowLayout(1);if(r&&(t=g(r))>=1){var o=r[t-1];if(o.y+o.height<=n._viewportY+n._viewportHeight)return e._scrollTopRow}}var i=e._scrollTopRow;try{e._scrollTopRow=e._getLastVisualRow();var a=e._getPrevPageTopRow();return a=e._getNextVisualRow(a)}catch(e){}finally{e._scrollTopRow=i}},_getLastPageLeftColumn:function(){var e,t=this;if(t._getLastVisualColumn()===t._getPageRightColumn()){e=t._getSheetLayout();var n,r=t._getColumnLayout(1);if(r&&(n=g(r))>=1){var o=r[n-1];if(o.x+o.width<=e._viewportX+e.width)return t._scrollLeftCol}}e=t._getSheetLayout();for(var i=0,a=t._getLastVisualColumn();a>0&&!((i+=t._getZoomColumnWidth(a))>e._viewportWidth);)a--;return a>0&&(a=t._getNextVisualColumn(a)),a},_getPageBottomRow:function(){var e,t=this._getRowLayout(1);return t&&(e=g(t))>0?t[e-1].row:_},_getPageRightColumn:function(){var e,t=this._getColumnLayout(1);return t&&(e=g(t))>0?t[e-1].col:_},_getLastFullyVisibleRow:function(){var e,t=this._getRowLayout(1);if(t&&(e=g(t))>0){var n=this._getSheetLayout(),r=e-1;return t[r].y+t[r].height<=n._viewportY+n._viewportHeight?t[r].row:t[v(r-1,0)].row}return _},_getLastFullyVisibleColumn:function(){var e,t=this._getColumnLayout(1);if(t&&(e=g(t))>0){var n=this._getSheetLayout(),r=e-1;return t[r].x+t[r].width<=n._viewportX+n._viewportWidth?t[r].col:t[v(r-1,0)].col}return _},_getLastVisualRow:function(e){m(e)&&(e=3);var t=o(this,e);return 3!==e&&2!==e||(t-=this.frozenTrailingRowCount()),this._getPrevVisualRow(t,e)},_getLastVisualColumn:function(e){m(e)&&(e=3);var t=r(this,e);return 3!==e&&1!==e||(t-=this.frozenTrailingColumnCount()),this._getPrevVisualColumn(t,e)},_inflateRangeToCoverSpans:function(e,t){if(e)for(var n=0,r=g(e);n<r;n++){var o=e[n];if(t.intersect(o.row,o.col,i(o),a(o)))return e.splice(n--,1),this._inflateRangeToCoverSpans(e,t.union(o))}return t},_getActiveSelectedRange:function(e){var t=this,n=t._selectionModel,r=g(n),o=d(-1,-1,0,0);return r<=0?o:(3===e?--n._activeSelectedRangeIndex<0&&(n._activeSelectedRangeIndex=r-1):4===e&&++n._activeSelectedRangeIndex>=r&&(n._activeSelectedRangeIndex=0),n._activeSelectedRangeIndex>=0&&(o=n[n._activeSelectedRangeIndex]),o)}}),s._registerFeature("selection",{init:function(){var e=new l;e.add(0,0,1,1),this._selectionModel=e}}),e.exports=t},function(e,t,n){function r(e,t){var n=e,r=t;return function(e){var t=this,i=t.sheet,a=t.row,s=t.col,l=t.sheetArea;if(0===arguments.length)return n.call(i,a,s,l);if(a>=0&&s>=0)for(var u=a;u<a+t.rowCount;u++)for(var c=s;c<s+t.colCount;c++)o(i,u,c,l)&&r.call(i,u,c,e,l);return t}}function o(e,t,n,r){var o=e.getRowCount(r),i=e.getColumnCount(r);return n<0&&0<=t&&t<o||t<0&&0<=n&&n<i||0<=t&&t<o&&0<=n&&n<i}function i(e,t,n,r,o,i){var a=this;t<0&&(t=r=-1),n<0&&(n=o=-1),a.sheet=e,a.row=t,a.rowCount=c(r)?1:r,a.col=n,a.colCount=c(o)?1:o,a.sheetArea=c(i)?3:i}var t=n(2),a=n(6).Worksheet,s=n(9).Style,l=n(4).GC$,u=n(3).Range,c=n(0)._Types._isNullOrUndefined,f=a.prototype,d=i.prototype={constructor:i,value:r(f.getValue,f.setValue),text:r(f.getText,f.setText),formula:r(function(e,n){return t._supportsCalc&&this.getFormula(e,n)},function(e,n,r,o){t._supportsCalc&&this.setFormula(e,n,r,o)}),tag:function(e){var t,n,r=this,o=r.sheet,i=r.row,a=r.col,s=r.rowCount,l=r.colCount,u=r.sheetArea;if(0===arguments.length)return o.getTag(i,a,u);if(i>=0&&a>=0)for(t=i;t<i+s;t++)for(n=a;n<a+l;n++)o.setTag(t,n,e,u);else if(i>=0)for(t=i;t<i+s;t++)o.setTag(t,-1,e,u);else if(a>=0)for(n=a;n<a+l;n++)o.setTag(-1,n,e,u);return r},width:function(e){var t=this,n=t.sheet,r=t.row,o=t.col,i=t.sheetArea;if(0!==arguments.length){if(r<0)for(var a=0;a<t.colCount;a++)n.setColumnWidth(a+o,e,i);return t}if(r<0)return n.getColumnWidth(o,i)},height:function(e){var t=this,n=t.sheet,r=t.row,o=t.col,i=t.sheetArea;if(0!==arguments.length){if(o<0)for(var a=0;a<t.rowCount;a++)n.setRowHeight(a+r,e,i);return t}if(o<0)return n.getRowHeight(r,i)},visible:function(e){var t=this,n=t.sheet,r=t.row,o=t.col,i=t.sheetArea;if(0!==arguments.length){if(o<0&&r>=0)for(var a=0;a<t.rowCount;a++)n.setRowVisible(a+r,e,i);else if(o>=0&&r<0)for(var s=0;s<t.colCount;s++)n.setColumnVisible(s+o,e,i);return t}return o<0&&r>=0?n.getRowVisible(r,i):o>=0&&r<0?n.getColumnVisible(o,i):void 0},resizable:function(e){var t=this,n=t.sheet,r=t.row,o=t.col,i=t.sheetArea;if(0!==arguments.length){if(o<0&&r>=0)for(var a=0;a<t.rowCount;a++)n.setRowResizable(a+r,e,i);else if(o>=0&&r<0)for(var s=0;s<t.colCount;s++)n.setColumnResizable(s+o,e,i);return t}return o<0&&r>=0?n.getRowResizable(r,i):o>=0&&r<0?n.getColumnResizable(o,i):void 0},_getStyleProperty:function(e){var t=this;return t.sheet._getStyleProperty(t.row,t.col,e,t.sheetArea)},_setStyleProperty:function(e,t){function n(e,t,n,r,i,a){if(o(e,t,n,a)){var l=e._getStyleImp(t,n,a);l||(l=new s),l[r]=i,e.setStyle(t,n,l,a)}}var r,i,a=this,l=a.sheet,u=a.row,c=a.col,f=a.rowCount,d=a.colCount,p=a.sheetArea;if(u>=0&&c>=0)for(r=u;r<u+f;r++)for(i=c;i<c+d;i++)n(l,r,i,e,t,p);else if(u>=0)for(i=-1,r=u;r<u+f;r++)n(l,r,i,e,t,p);else if(c>=0)for(r=-1,i=c;i<c+d;i++)n(l,r,i,e,t,p);return a},styleName:r(f.getStyleName,f.setStyleName),clear:function(e){var t=this;t.sheet.clear(t.row,t.col,t.rowCount,t.colCount,t.sheetArea,e)},setBorder:function(e,t){var n=this,r=n.sheet,o=n.sheetArea;r.suspendPaint();try{var i,a,s=new u(n.row,n.col,n.rowCount,n.colCount),l=r._getActualRange(s,o),c=l.row,f=l.col,d=l.rowCount,p=l.colCount,h=t.all,m=t.outline,g=t.inside;if(t.left||h||m)for(i=0;i<d;i++)r.getCell(c+i,f,o).borderLeft(e);if(t.top||h||m)for(a=0;a<p;a++)r.getCell(c,f+a,o).borderTop(e);if(t.right||h||m)for(i=0;i<d;i++)r.getCell(c+i,f+p-1,o).borderRight(e);if(t.bottom||h||m)for(a=0;a<p;a++)r.getCell(c+d-1,f+a,o).borderBottom(e);if(t.innerHorizontal||h||g)for(i=0;i<d-1;i++)for(a=0;a<p;a++)r.getCell(c+i,f+a,o).borderBottom(e),r.getCell(c+i+1,f+a,o).borderTop(e);if(t.innerVertical||h||g)for(a=0;a<p-1;a++)for(i=0;i<d;i++)r.getCell(c+i,f+a,o).borderRight(e),r.getCell(c+i,f+a+1,o).borderLeft(e)}finally{r.resumePaint()}}};l.each(["backColor","foreColor","hAlign","vAlign","themeFont","font","formatter","borderLeft","borderTop","borderRight","borderBottom","locked","textIndent","wordWrap","shrinkToFit","backgroundImage","backgroundImageLayout","validator","cellType","tabStop","textDecoration","imeMode","watermark","cellPadding","labelOptions"],function(e,t){d[t]=function(e){return 0===arguments.length?this._getStyleProperty(t):this._setStyleProperty(t,e)}}),i._defProperty=r,t.CellRange=i,l.extend(f,{getRange:function(e,t,n,r,o){return new i(this,e,t,n,r,o)},getCell:function(e,t,n){return new i(this,e,t,1,1,n)}}),e.exports=t},function(e,t,n){var t=n(2),r=n(4).GC$,o=n(3),i=n(5),a=n(31).NameInfo,s=n(24).Workbook,l=n(0),u=l._StringHelper._toUpperCase,c=function(){return l._getResource(t.SR)()},f=o._util._isDefined,d=void 0,p=null,h={_initCalcService:function(e){var n=this,r=n._calcService;n._calcService=new i.CalcService,e&&r&&n._calcService.cloneFrom(r),n._spreadSource=new t.CalcEngine.SpreadSource(n),n._spreadSourceModel=n._calcService.getGlobalSourceModel(n._spreadSource)},addCustomFunction:function(e){this._addCustomFunctionCore(e)},_addCustomFunctionCore:function(e){if(!(e&&e instanceof i.Functions.Function))throw new Error(c.Exp_InvalidCustomFunction);this._functions[u(e.name)]=e},getCustomFunction:function(e){return e?this._functions[u(e)]:d},removeCustomFunction:function(e){e&&(delete this._functions[u(e)],this._recalcAll())},clearCustomFunctions:function(){this._functions={}},addCustomName:function(e,t,n,r){this._addCustomNameCore(e,t,n,r,!1)},_addCustomNameCore:function(e,t,n,r,o){if(!e||!t)throw new Error(c().Exp_InvalidCustomName);var i=this;if(i._calcService){var s=this.getActiveSheet(),l=s?s._getSheetSource():p;if(o)try{f=i._calcService.parse(l,t,n,r,!1,!1,!0)}catch(e){}else var f=i._calcService.parse(l,t,n,r);i._nameInfos[u(e)]=new a(e,f,n,r);var d={};d[e]=e,this._updateCalc(d,!0)}},getCustomName:function(e){return e?this._nameInfos[u(e)]:d},getCustomNames:function(){var e=[];return r.each(this._nameInfos,function(t,n){e.push(n)}),e},removeCustomName:function(e){if(e){delete this._nameInfos[u(e)];var t={};t[e]=e,this._updateCalc(t,!1)}},clearCustomNames:function(){var e=this._nameInfos;this._nameInfos={},this._updateCalc(e,!1)},_updateCalc:function(e,t){if(e&&0!==e.length){var n=this._spreadSourceModel;for(var r in e)if(n){var o=n._getNameCalc(u(r));o&&(o.updateListening(!0,t),o._addToDirty())}this._recalcAll()}},_recalcAll:function(){if(this._calcService&&!this._calcService.IsSuspended()){var e=this.getActiveSheet();e&&(e.suspendPaint(),this._calcService.recalculateAll(),e.resumePaint())}},getCalcService:function(){return this._calcService},_getCalcServiceInternal:function(){return this._calcService},suspendCalcService:function(e){this._calcService&&this._calcService.suspend(e)},resumeCalcService:function(e){this._calcService&&this._calcService.resume(e)}};r.extend(s.prototype,h),s._registerFeature("calc",{priority:1e3,init:function(){this._functions={},this._nameInfos={}},toJson:function(e){var t=this,n=t._functions;r.isEmptyObject(n)||(e.customFunctions=n);var o=[],i=t.getCustomNames(),a=t._calcService;i&&a&&(r.each(i,function(e,t){var n=t.getName(),r=t.getRow(),i=t.getColumn(),s=t.getExpression(),l=a.unparse(null,s,r,i,!1,!0);o.push({name:n,formula:l,row:r,col:i})}),o.length>0&&(e.names=o))},fromJson:function(e,t){var n=this,r=n._calcService;r&&r.suspend(),n.clearCustomNames();var i=e.names;if(i)for(var a=0;a<i.length;a++){var s=i[a];n._addCustomNameCore(s.name,s.formula,s.row,s.col,!0)}n.clearCustomFunctions();var l=e.customFunctions;if(l)for(var u in l)if(l.hasOwnProperty(u)){var c=l[u],d=o.getTypeFromString(c.typeName);if(d){var p=new d;p.fromJSON(c,t),n._addCustomFunctionCore(p)}}var h,m,g=e.sheets;if(g){h=0;for(var _ in g)if("string"==typeof _){var v=g[_],y=f(v.index)?v.index:v._index;m=n.sheets[f(y)?y:h],m.formulaFromJSON(v,t),h++}}r&&(e.noRecalc?r.resumeWithoutCalc():r.resume(!0))}}),e.exports=t},function(e,t,n){function r(e,t){return e.hasOwnProperty(t)}function o(e){if(!e||"string"!=typeof e)return 1;var t,n=e.split(".");if(!n||0===(t=n.length))return 1;if(t>3)return 3;var r=p(n[0]);if(t<=2)return isNaN(r)?1:r;var o=p(n[1]);if(r>=10)return r;if(r>=3){if(o>=20143)return 3;if(o>=20142)return 2}return 1}var t=n(2),i=n(24).Workbook,a=n(9).Style,s=n(4).GC$,l=n(3),u=n(0).CultureManager,c=i._features,f=s.each,d=l._util._isDefined,p=parseFloat;s.extend(i.prototype,{toJSON:function(e){var t=this,n={version:l.productInfo.productVersion},o=t.startSheetIndex();o&&(n.startSheetIndex=o),f(t.options,function(e,t){"_ps"!==e&&i._defaultOptions[e]!==t&&(n[e]=t)});var a=t.getSheetCount();a!==i._defaultSheetCount&&(n.sheetCount=a);var u=t.getActiveSheetIndex();u!==i._defaultActiveSheetIndex&&(n.activeSheetIndex=u);for(var d={},p=0;p<a;p++){var h=t.getSheet(p);d[h._name]=h.toJSON(e),d[h._name].index=p}s.isEmptyObject(d)||(n.sheets=d);var m=[],g=t._namedStyles;if(g){for(var _ in g)r(g,_)&&m.push(g[_]);m.length>0&&(n.namedStyles=m)}return c&&f(c,function(r,o){o.toJson&&o.toJson.call(t,n,e)}),n},fromJSON:function(e){if(e){var n=this,s=o(e.version)<3,p=l._FocusHelper._getActiveElement();n._suspendSetFocus=!0,n.suspendPaint(),n.suspendEvent();var h=u.culture();u.culture("");try{n._initOptions(),t._supportsCalc&&n._initCalcService(!0),n._availableSheetIndex=-1,n.clearSheets();var m=n.options,g=e.canUserEditFormula;d(g)&&(m.allowUserEditFormula=g);var _=e.allowDragDrop;d(_)&&(m.allowUserDragDrop=_);var v=e.allowDragFill;d(v)&&(m.allowUserDragFill=v);for(var y in m)if(r(m,y)){var b=e[y];d(b)&&(m[y]=b)}var w=e.sheetCount;d(w)||(w=i._defaultSheetCount),n._setSheetCountImp(w,0),n._namedStyles={};var C=e.namedStyles;if(C)for(var S=0;S<C.length;S++){var x=C[S],T=new a;T.fromJSON(x,s),n._addNamedStyleImp(T)}var E,M,A,k=0,R=e.sheets,I=!1,O=!0;if(R)for(var D in R)if("string"==typeof D){var P=R[D],N=d(P.index)?P.index:P._index;E=n.sheets[d(N)?N:k],E.fromJSON(P,!1,s),k++,A=P.allowUndo,I?O=O&&A===M:(M=A,I=!0)}d(M)&&O&&(m.allowUndo=M);var F=e.activeSheetIndex;d(F)||(F=i._defaultActiveSheetIndex),n._setActiveSheetIndexImp(F,0);var L=e.startSheetIndex;d(L)&&n.startSheetIndex(L),c&&f(c,function(t,r){var o=r.fromJson;o&&o.call(n,e,s)})}finally{u.culture(h),n._suspendSetFocus=!1;var H=n.getActiveSheet();p&&H&&H._setFocus(),n.resumeEvent(),n._doResize(),n.resumePaint()}}}})},function(e,t,n){function r(e,t){return e=e||0,_._getVisualStateThemeStyle(e,"gc-"+t+"-"+_._getString(e))}function o(e,t,n,r,o,i){var a=new Image,s=i;s=s.replace('url("',""),s=s.replace('")',""),a.src=s,e.drawImage(a,t,n,r,o)}function i(e,t,n,r,i,a,s,l,u){if(!m._Types._isNullOrUndefined(l)){e.save(),e.beginPath();var c;if(0===l&&a.backColor)c=a.backColor,e.fillStyle!==c&&(e.fillStyle=c),e.fillRect(t+1,n+1,r-1,i-1);else try{var f=u&&u.backgroundColor,d=u&&u.backgroundImage;if(d&&-1!==d.indexOf("linear-gradient")){var p=y(d);c=e.createLinearGradient(t+r/2,n,t+r/2,n+i);for(var h=0,g=p.length;h<g;h++){var _=p[h];c.addColorStop(_.point,_.color)}e.fillStyle=c,e.fillRect(t+1,n+1,r-1,i-1)}else f?(e.fillStyle=f,e.fillRect(t+1,n+1,r-1,i-1)):d&&d!==C&&o(e,t+1,n+1,r-1,i-1,d)}catch(e){}w._paintBackgroundImage(e,t,n,r,i,a.backgroundImage,a.backgroundImageLayout,s.imageLoader),e.restore()}}function a(e,t,n,o,a,s,l,u,c,f,p){if(t){var h=c.visualState||0,m=r(h,f);i(t,o,a,s,l,u,c,h,m),w._paintHeaderCellGridline(t,o,a,s,l,u,f,m,p);var g=new d.Rect(o,a,s,l);e._paintLabel&&(e._paintLabel(t,g,u,c),g=e._getContentRect(g,u)),g.width>0&&g.height>0&&e.paintContent(t,n,g.x,g.y,g.width,g.height,u,c)}}function s(e,t,n,r,o,i,a,s,l,u,c){function f(e,t,n,r,o,i){var a={font:t,fillStyle:n},s=r.sheet;if(0!==r.visualState&&parseInt(i.zIndex)>2007&&s._isSelected(r.row,r.col,o)){var l;l=s._isAllSelected(r.row,r.col,o)?e(r.visualState,"gc-columnHeader-selected"):e(r.visualState,"gc-columnHeader-highlight"),a.fillStyle=l.color,a.font=p._setStringFont(a.font,"bold")}return a}var h=e.format(n,s.formatter);if(h){t.save(),t.beginPath();var m=l.sheet,g=m.rowFilter&&m.rowFilter();!!(g&&g._isFilterHeader(l.row,l.col,u)&&g.filterButtonVisible(l.col))&&(i-=m._getFilterButtonRect(new d.Rect(r,o,i,a),u).width);var _={x:r,y:o,width:i,height:a},y=s.foreColor;y||(y=c.color),y&&t.fillStyle!==y&&(t.fillStyle=y);var b=f(e.getThemeStyle,s.font||t.font,t.fillStyle,l,u,c);t.font=b.font,t.fillStyle=b.fillStyle;var w=0,C=s.textIndent;C>0&&(w=8*C);var x=s.hAlign,T=s.vAlign,E="left",M=2;M+=w,1===x?(M=i/2,E="center"):2===x&&(M=i-1,M-=w,E="right"),t.textAlign!==E&&(t.textAlign=E);var A=0,k="alphabetic",R=2,I=s.wordWrap,O=l.lineHeight,D=l.fontInfo.fontSize,P=[],N=0;if(I){var F=i-3-w;F-=1,P=v._getWrapInfo(h,F,b.font),N=P.length,N>1&&0!==T&&(A=(N-1)*O)}var L=D>8?S((D-8)/5+2):1,H=O/2-D/2+L-1;R+=O-H,1===T?R=(a-A)/2+O/2-H:2===T&&(R=a-A-2-H),t.textBaseline!==k&&(t.textBaseline=k);var V=s.textDecoration;if(s.wordWrap){t.rect(_.x,_.y,_.width,_.height),t.clip(),t.beginPath();for(var j=o+R,B=0;B<N;B++){if(t.fillText(P[B],r+M,j),V){var U=t.measureText(P[B]).width;e._renderTextDecoration(t,V,r+M,j,U,D,L)}j+=O}}else{var W=t.measureText(h).width;(W>_.width||O>_.height)&&(t.rect(_.x,_.y,_.width,_.height),t.clip(),t.beginPath()),t.fillText(h,r+M,o+R),V&&e._renderTextDecoration(t,V,r+M,o+R,W,D,L)}t.restore()}}function l(){b.call(this),this.typeName="2"}function u(){b.call(this),this.typeName="3"}function c(){b.call(this),this.typeName="4"}var f=n(4).GC$.inherit,d=n(3),p=n(8)._StyleHelper,h=n(12).CellTypes,m=n(0),t=n(2),g=t.CellTypes||(t.CellTypes={}),_=d._ThemeStyleHelper,v=d._WordWrapHelper,y=d._util._getLinearGradientColors,b=h.Base,w=h.Context,C="none",S=Math.floor;f(l,b),l.prototype.paint=function(e,t,n,r,o,i,s,l){a(this,e,t,n,r,o,i,s,l,"columnHeader",1)},l.prototype.paintContent=function(e,t,n,o,i,a,l,u){s(this,e,t,n,o,i,a,l,u,1,r(u.visualState,"columnHeader"))},g.ColumnHeader=l,g._typeDict[2]=l,f(u,b),u.prototype.paint=function(e,t,n,r,o,i,s,l){a(this,e,t,n,r,o,i,s,l,"rowHeader",2)},u.prototype.paintContent=function(e,t,n,o,i,a,l,u){s(this,e,t,n,o,i,a,l,u,2,r(u.visualState,"rowHeader"))},g.RowHeader=u,g._typeDict[3]=u,f(c,b),c.prototype.paint=function(e,t,n,r,i,a,s,l){if(e){e.save(),e.rect(n,r,i,a),e.clip(),e.beginPath();var u=this,c=l.visualState||0;try{var f=u.getThemeStyle(l.visualState,"gc-corner-"+_._getString(c)),d=f&&f.backgroundColor,p=f&&f.backgroundImage;d?(e.fillStyle=d,e.fillRect(n,r,i,a)):p&&p!==C&&o(e,n,r,i,a,p)}catch(e){}var h=u.getThemeStyle(4,"gc-corner-triangle-"+_._getString(c)),m=h&&h.backgroundImage,g=h&&h.backgroundColor,v=e.createLinearGradient(n+i/2,r,n+i/2,r+a);if(m&&-1!==m.indexOf("linear-gradient")){for(var b=y(m),w=0,S=b.length;w<S;w++){var x=b[w];v.addColorStop(x.point,x.color)}e.fillStyle=v}else g&&(v.addColorStop(.125,"#f6fafb"),v.addColorStop(1,g),e.fillStyle=v);var T=e.createLinearGradient(n+i,r+1,n+i,r+a-2);T.addColorStop(0,h.borderLeftColor),T.addColorStop(1,h.borderRightColor),e.beginPath(),e.strokeStyle=T,e.moveTo(n+i-.5,r),e.lineTo(n+i-.5,r+a),e.stroke();var E=e.createLinearGradient(n,r,n+i-2,r);E.addColorStop(0,h.borderTopColor),E.addColorStop(1,h.borderBottomColor),e.beginPath(),e.strokeStyle=E,e.moveTo(n,r+a-.5),e.lineTo(n+i,r+a-.5),e.stroke(),e.beginPath();var M=3,A=a;i<a&&(A=i),e.moveTo(n+i-A+M,r+a-M),e.lineTo(n+i-M,r+a-M),e.lineTo(n+i-M,r+a-A+M),e.fill(),e.restore()}},g.Corner=c,g._typeDict[4]=c,e.exports=t},function(e,t,n){n(108),n(109),n(49),e.exports=n(110)},function(e,t,n){function r(e){delete e._isFirstMouseUp;var t=e._mouseupToken;t&&(clearTimeout(t),delete e._mouseupToken)}function o(){var e=this;_.call(e),e.typeName="5",y(F,function(t,n){e["_"+t]=n})}function i(e){return 5*e}function a(e,t,n,r,o){var a=i(o),s=t.hAlign,l=n.x-1,u=n.width+1,c=0,f=0;return 0===e||1===e?(f=l+a,1===s?f=l+u/2-N/2:2===s&&(f=l+u-a-N)):2===e?(c=N+r,f=l+a+r,1===s?f=l+u/2-c/2+r:2===s&&(f=l+u-a-c+r)):(c=N+r,f=l+a,1===s?f=l+u/2-c/2:2===s&&(f=l+u-a-c)),f-l}function s(e,t,n,r,o){var a=i(o),s=t.vAlign,l=n.y-1,u=n.height+1,c=0,f=0;return 0===e?(c=N+r,f=l+a+r,1===s?f=l+u/2-c/2+r:2===s&&(f=l+u-a-c+r)):1===e?(c=N+r,f=l+a,1===s?f=l+u/2-c/2:2===s&&(f=l+u-a-c)):(f=l+a,1===s?f=l+u/2-N/2:2===s&&(f=l+u-a-N)),f-l}function l(e,t,n,r,o){var i=t.getValue(n,r,o),a=e._getNextState(i),s={cmd:"editCell",sheetName:t.name(),row:n,col:r,newValue:a,autoFormat:!0};t._commandManager().execute(s),e._triggerButtonClicked(t,n,r,o)}var u=n(1),c=n(0),f=u._util._createElement,d=c._Types._isNullOrUndefined,p=u._util,h=p._cancelDefault,m=u.CellTypes,g=m.Context,_=m.Base,v=u.GC$,y=v.each,b=null,w=Math.max,C=parseInt,S="position",x="absolute",T="font",E="left",M="right",A="top",k="alphabetic",R=".gcEditingInput",I="background-color",O="white",D="green",P="div";m.CheckBoxTextAlign={top:0,bottom:1,left:2,right:3},v.inherit(o,_);var N=12,F={caption:"",textTrue:"",textIndeterminate:"",textFalse:"",textAlign:3,isThreeState:!1},L={paintValue:function(e,t,n,r,o,i,l,c){if(e){e.save(),e.rect(n,r,o,i),e.clip(),e.beginPath();var f=l.hAlign,p=l.font,h=l.foreColor,m=this,g=m._textAlign,_=m.getText(t,c),v=0,y=0,b=c.sheet;if(b&&(v=b._getStringWidthByCanvas(_,p),y=b._getFontHeight(p),_)){y*=_.split(/\r\n|\r|\n/).length}var w=N/2,S=new u.Rect(++n,++r,--o,--i),x=C((n+a(g,l,S,v,b._zoomFactor)).toString()),T=C((r+s(g,l,S,y,b._zoomFactor)).toString()),A=E,R=x+1;1===f?(A="center",R+=w):2===f&&(A=M,R+=2*w),p&&e.font!==p&&(e.font=p),h&&(e.fillStyle=h);var I=l.textDecoration,P=c.fontInfo.fontSize,F=P>8?Math.floor((P-8)/5+2):1,L=y/2-P/2+F-1;e.textBaseline!==k&&(e.textBaseline=k),2===g?(e.textAlign=M,e.fillText(_,x+1-2,T+w+y/2-L),I&&m._renderTextDecoration(e,I,x+1-2,T+w+y/2-L,v,P,F)):0===g&&(e.textAlign=A,e.fillText(_,R,T-2-L),I&&m._renderTextDecoration(e,I,R,T-2-L,v,y)),e.save(),e.strokeStyle="black",e.strokeRect(x+.5,T+.5,2*w+.05,2*w+.05),e.fillStyle=O,e.fillRect(x+1,T+1,2*w-1,2*w-1),m._isThreeState&&d(t)?(e.beginPath(),e.fillStyle=D,e.rect(x+3,T+3,2*(w-2.5),2*(w-2.5)),e.fill()):!0==!!t&&(e.beginPath(),e.lineWidth=2.5,e.moveTo(x+3,T+w),e.lineTo(x+w,T+2*w-3.5),e.lineTo(x+2*w-1.5,T+3),e.stroke()),e.restore(),h&&(e.fillStyle=h),3===g?(e.textAlign=E,e.fillText(_,x+1+2*w+2,T+w+y/2-L),I&&m._renderTextDecoration(e,I,x+1+2*w+2,T+w+y/2-L,v,P,F)):1===g&&(e.textAlign=A,e.fillText(_,R,T+2*w+2+y-L),I&&m._renderTextDecoration(e,I,R,T+2*w+2+y-L,v,P,F)),e.restore()}},getText:function(e,t){return this._getDisplayText(e)},focus:function(e,t){e&&e.parentNode.focus()},createEditorElement:function(e){var t=e&&e.sheet&&e.sheet.parent&&e.sheet.parent._host,n=p._getPreferredZIndex(t)+1e3;v(this._cellWrapperElement).css("z-index",n).attr("tabindex",1).attr("gcUIElement","gcEditingInput"),v(this._contentContainer).css("overflow","hidden");var r=v(this._contentContainer),o=v(f("input"));o.attr("type","checkbox"),r.append(o);var i=v(f("span"));i.css(S,x).css(T,"normal 11pt calibri").css("cursor","default").css("white-space","nowrap"),r.append(i);var a=v(f(P));return a.css(S,x).css(I,D).css("width",2*(N/2-2.5)).css("height",2*(N/2-2.5)),r.append(a),b},_getNextState:function(e){return this._isThreeState?!d(e)&&(!0!=!!e||b):!e},setEditorValue:function(e,t,n){if(e){var r=e.parentNode.children,o=r[0],i=r[1],a=r[2];if(o&&i&&a){var s,l=this,u=n&&n.sheet,c=u&&u._startEditByKeydown;c||(t=l._getNextState(t)),l._isThreeState?d(t)?(s=!1,v(a).show()):(s=!!t,v(a).hide()):s=!!t,o.checked=s,v(i).text(l._getDisplayText(t))}}},getEditorValue:function(e,t){if(e){var n=e.parentNode.children,r=n[0],o=n[1],i=n[2];if(r&&o&&i&&(!this._isThreeState||!v(i).isVisible()))return r.checked}return b},_triggerButtonClicked:function(e,t,n,r){var o=e.parent;o&&o._triggerButtonClicked(e,t,n,r)},activateEditor:function(e,t,n,r){function o(e,t,n,r,o){var i=o&&o.sheet,a=e.getEditorValue(t,o);e.setEditorValue(t,a,o),e.updateEditor(t,n,r,o),e._triggerButtonClicked(i,i._activeRowIndex,i._activeColIndex,o.sheetArea)}var i=r&&r.sheet;if(e&&i){var a=v(e.parentNode.parentNode),s=this;a.bind("mousedown"+R,function(e){h(e)}),a.bind("mouseup"+R,function(){o(s,e,t,n,r)}),a.bind("keydown"+R,function(e){var t=e.keyCode;if(!e.ctrlKey&&!e.shiftKey&&!e.altKey){if(32===t)return s._isKeyDown=!0,h(e),!1;8===t&&h(e)}}),a.bind("keyup"+R,function(i){!s._isKeyDown||32!==i.keyCode||i.ctrlKey||i.shiftKey||i.altKey||(s._isKeyDown=!1,o(s,e,t,n,r))});var l=e;l&&v(l).bind("click",function(e){h(e)})}},updateEditor:function(e,t,n,r){var o=r&&r.sheet;if(e&&o){var i=o._render,l=e.parentNode,u=l.children,c=u[0],f=u[1],d=u[2];if(c&&f&&d){v(l).width(n.width).height(n.height);var p=v(f),h=p.text(),m=t.foreColor,g=t.font,_=t.hAlign,y=t.textDecoration;m&&p.css("color",m);var w=b;w=g||i._getDefaultFont(),o._zoomFactor>1&&(w=i._getZoomFont(w)),p.css(T,w);var C=o._getStringWidth(h,w),S=o._getFontHeight(w);if(h){S*=h.split(/\r\n|\r|\n/).length}var x=this,M=x._textAlign,k=a(M,t,n,C,o._zoomFactor),R=s(M,t,n,S,o._zoomFactor);v(c).css("margin-left",k).css("margin-top",R);var I=c.offsetLeft,O=c.offsetTop,D=c.offsetWidth,P=c.offsetHeight,F=0,L=0;if(0===M?(F=I,1===_?F=I+N/2-C/2:2===_&&(F=I+N-C),L=O-S):1===M?(F=I,1===_?F=I+N/2-C/2:2===_&&(F=I+N-C),L=O+P):2===M?(F=I-C-2,L=O+N/2-S/2):(F=I+D+2,L=O+N/2-S/2),p.css(E,F).css(A,L),x._isThreeState){var H=I+(D-d.offsetWidth)/2,V=O+(P-d.offsetHeight)/2;v(d).css(E,H).css(A,V).toggle().toggle()}else v(d).hide();y&&x._setTextDecoration(p,y)}}},_getDisplayText:function(e){var t=this,n=t._caption;return t._isThreeState&&d(e)?t._textIndeterminate||n:!0==!!e?t._textTrue||n:t._textFalse||n},getHitInfo:function(e,t,n,r,o){if(o){var i=o.sheetArea;if(d(i)||3===i)return{x:e,y:t,row:o.row,col:o.col,cellRect:r,sheetArea:3,isReservedLocation:!0,sheet:o.sheet}}return b},processMouseDown:function(e){if(!e)return!1;e.isReservedLocation&&(this._isMouseDownReservedLocation=!0)},processMouseUp:function(e){var t=this,n=e&&e.sheet;if(n&&t._isMouseDownReservedLocation&&e.isReservedLocation){t._isMouseDownReservedLocation=!1;var o=e.row,i=e.col,a=e.sheetArea,s=n._getModel(a).getNode(o,i,!0);if(!s._isFirstMouseUp)return l(t,n,o,i,a),s._isFirstMouseUp=!0,s._mouseupToken=setTimeout(function(){r(s)},250),!0;r(s)}return!1},processMouseLeave:function(e){if(!e)return!1;this._isMouseDownReservedLocation=!1},isReservedKey:function(e,t){return 32===e.keyCode&&!e.ctrlKey&&!e.shiftKey&&!e.altKey},processKeyUp:function(e,t){return l(this,t.sheet,t.row,t.col,t.sheetArea),!0},getAutoFitWidth:function(e,t,n,r,o){var i=this,a=i._textAlign,s=g._getAutoFitWidth(e,i._getDisplayText(e),n,r,o);return 0===a||1===a?s=w(s,N):s+=N,s+5+2},getAutoFitHeight:function(e,t,n,r,o){var i=this,a=i._textAlign,s=g._getAutoFitHeight(e,i._getDisplayText(e),n,r,o);return 0===a||1===a?s+=N:s=w(s,N),s+5},_cancelDefaultKeydown:function(e){this.isReservedKey(e)&&h(e)},isImeAware:function(e){return!1},toJSON:function(){var e,t=this,n={typeName:t.typeName};return y(F,function(r,o){(e=t["_"+r])!==o&&(n[r]=e)}),n},fromJSON:function(e){var t=this;y(F,function(n){var r=e[n];d(r)||(t["_"+n]=r)})}};y(F,function(e){L[e]=function(t){return 0===arguments.length?this["_"+e]:(this["_"+e]=t,this)}}),v.extend(o.prototype,L),m.CheckBox=o,m._typeDict[5]=o,e.exports=m},function(e,t,n){function r(e){delete e._isFirstMouseUp;var t=e._mouseupToken;t&&(clearTimeout(t),delete e._mouseupToken)}function o(){var e=this;g.call(e),e.typeName="6",v(L,function(t,n){e["_"+t]=n})}function i(e,t){e.removeClass(F),t?e.css(R,t):e.addClass(F)}var a=n(1),s=n(0),l=a.Events.SelectionChanged,u=a._util._createElement,c=s._Types._isNullOrUndefined,f=a._util,d=f._cancelDefault,p=a.CellTypes,h=p.Context,m=p.Text,g=p.Base,_=a.GC$,v=_.each,y=null,b="position",w="absolute",C="font",S="left",x="top",T="none",E=".gcEditingInput",M="hidden",A="overflow",k="border",R="background-color",I="div";_.inherit(o,g);var O="#707070",D="#A6F4FF",P="#34B4E3",N=".buttonCellType",F="gc-gradientButton",L={marginTop:2,marginRight:2,marginBottom:2,marginLeft:2,text:"",buttonBackColor:y,buttonState:0},H={paintValue:function(e,t,n,r,o,i,a,s){if(e){var l=this,u=l._marginLeft,c=l._marginTop,f=n+u,d=r+c,p=o-u-l._marginRight,h=i-c-l._marginBottom,g=f+p>n&&f<n+o&&d+h>r&&d<r+i;if(p-2>0&&h-2>0&&g){e.save(),(f<n||f+p>n+o||d<r||d+h>r+i)&&(e.rect(n,r,o,i),e.clip()),e.beginPath();var _=O;_&&e.strokeStyle!==_&&(e.strokeStyle=_),e.strokeRect(f+.5,d+.5,p-1,h-1);var v,y=l._buttonState,b=l._text;if(2===y)v=P;else if(1===y)v=D;else if(!(v=l._buttonBackColor)){var w=e.createLinearGradient(n+o/2,r,n+o/2,r+i);w.addColorStop(.125,"#F6FAFB"),w.addColorStop(1,"#D2DBEB"),v=w}e.fillStyle!==v&&(e.fillStyle=v),e.fillRect(f+1,d+1,p-2,h-2),e.restore(),b&&m.prototype.paintValue.call(l,e,b,f,d,p,h,a,s)}}},getText:function(e,t){return e},focus:function(e,t){e&&e.focus()},createEditorElement:function(e){var t=e&&e.sheet&&e.sheet.parent&&e.sheet.parent._host,n=f._getPreferredZIndex(t)+1e3;_(this._cellWrapperElement).css("user-select",T).css("z-index",n).attr("tabindex",1).attr("gcUIElement","gcEditingInput");var r=_(u(I));r.css(b,w).css(A,M).css(k,"1px "+O+" solid");var o=_(u("span"));return o.css(b,w).css("white-space","nowrap").css(C,"normal 11pt calibri").css("cursor","default"),r.append(o),r[0]},setEditorValue:function(e,t,n){if(e){var r=e.firstChild;r&&_(r).html(this._text)}},getEditorValue:function(e,t){return e?e._oldValue:y},_triggerButtonClicked:function(e,t,n,r){var o=e.parent;o&&o._triggerButtonClicked(e,t,n,r)},activateEditor:function(e,t,n,r){var o=r&&r.sheet;if(e&&o){var a=_(e.parentNode),s=this,l=e;if(l){var u=_(l);a.bind("keydown"+E,function(e){var t=e.keyCode;if(!e.ctrlKey&&!e.shiftKey&&!e.altKey){if(32===t)return s._isKeyDown||i(u,P),s._isKeyDown=!0,d(e),!1;8===t&&d(e)}}),a.bind("keyup"+E,function(e){!s._isKeyDown||32!==e.keyCode||e.ctrlKey||e.shiftKey||e.altKey||(s._isKeyDown=!1,i(u,s._buttonBackColor),s._triggerButtonClicked(o,o._activeRowIndex,o._activeColIndex,r.sheetArea))}),u.bind("mousedown"+E,function(e){2!==e.button&&(s._isMouseDown=!0,i(u,P))}),u.bind("mouseup"+E,function(e){2!==e.button&&(s._isMouseDown=!1,i(u,D))}),u.bind("click"+E,function(){s._triggerButtonClicked(o,o._activeRowIndex,o._activeColIndex,r.sheetArea)}),u.bind("mousemove"+E,function(){s._isMouseDown?i(u,P):i(u,D)}),u.bind("mouseout"+E,function(e){var t=e.relatedTarget;t!==l&&t!==l.firstChild&&i(u,s._buttonBackColor)})}}},updateEditor:function(e,t,n,r){var o=e&&r&&r.sheet;if(o){var a=o._render,s=e;if(s){var l=this,u=l._marginLeft,c=l._marginTop,f=l._text,d=_(s);d.width(n.width-u-l._marginRight).height(n.height-c-l._marginBottom).css("margin-top",c-1).css("margin-left",u-1),i(d,l._buttonBackColor);var p=t.foreColor,h=t.font,m=t.vAlign,g=t.hAlign,v=t.textDecoration,b=s.firstChild;if(b){var w=_(b);p&&w.css("color",p);var T=y;T=h||a._getDefaultFont(),o._zoomFactor>1&&(T=a._getZoomFont(T)),w.css(C,T);var E=o._getStringWidth(f,T),M=o._getFontHeight(T);if(f){M*=f.split(/\r\n|\r|\n/).length}var A=0;1===m?A=d.height()/2-M/2:2===m&&(A=d.height()-M);var k=0;1===g?k=d.width()/2-E/2:2===g&&(k=d.width()-E),w.css(x,A).css(S,k),v&&l._setTextDecoration(w,v)}}}},getHitInfo:function(e,t,n,r,o){var i=this;if(o){var a=o.sheetArea;if((c(a)||3===a)&&r){var s=r.x+i._marginLeft,l=r.x+r.width-i._marginRight,u=r.y+i._marginTop,f=r.y+r.height-i._marginBottom,d={x:e,y:t,row:o.row,col:o.col,cellRect:r,sheetArea:a,sheet:o.sheet};return s<=e&&e<=l&&u<=t&&t<=f&&(d.isReservedLocation=!0),d}}return y},processMouseDown:function(e){var t=this,n=e&&e.sheet;return!(!n||!e.isReservedLocation||t._isMouseDownReservedLocation)&&(t._isMouseDownReservedLocation=!0,t._buttonState=2,n.repaint(e.cellRect),!0)},processMouseUp:function(e){var t=this,n=e&&e.sheet;if(t._isMouseDownReservedLocation&&n&&e.isReservedLocation){t._buttonState=0,n.repaint(e.cellRect),t._isMouseDownReservedLocation=!1;var o=e.row,i=e.col,a=e.sheetArea,s=n._getModel(a).getNode(o,i,!0);if(!s._isFirstMouseUp)return t._triggerButtonClicked(n,o,i,a),s._isFirstMouseUp=!0,s._mouseupToken=setTimeout(function(){r(s)},250),!0;r(s)}return!1},processMouseLeave:function(e){var t=this,n=e&&e.sheet;n&&t._isMouseDownReservedLocation&&(t._buttonState=0,n.repaint(e.cellRect),t._isMouseDownReservedLocation=!1)},processKeyDown:function(e,t){var n=t.sheet,r=this;if(n&&!r._isKeyPressed){var o=n.getCellRect(t.row,t.col);return r._buttonState=2,n.repaint(o),n._bind(l+N,function(){n._unbind(l+N),r._isKeyPressed=!1,r._buttonState=0,n.repaint(o)}),r._isKeyPressed=!0,!0}return!1},processKeyUp:function(e,t){var n=t.sheet,r=this;if(n&&r._isKeyPressed){var o=t.row,i=t.col,a=n.getCellRect(o,i);return r._buttonState=0,n.repaint(a),n._unbind(l+N),r._triggerButtonClicked(n,o,i,t.sheetArea),r._isKeyPressed=!1,!0}return!1},isReservedKey:function(e,t){return 32===e.keyCode&&!e.ctrlKey&&!e.shiftKey&&!e.altKey},getAutoFitWidth:function(e,t,n,r,o){var i=this;return h._getAutoFitWidth(e,i._text,n,r,o)+i._marginLeft+i._marginRight},getAutoFitHeight:function(e,t,n,r,o){var i=this;return h._getAutoFitHeight(e,i._text,n,r,o)+i._marginTop+i._marginBottom},_cancelDefaultKeydown:function(e){this.isReservedKey(e)&&d(e)},isImeAware:function(e){return!1},toJSON:function(){var e,t=this,n={typeName:t.typeName};return v(L,function(r,o){"buttonState"!==r&&(e=t["_"+r])!==o&&(n[r]=e)}),n},fromJSON:function(e){var t=this;v(L,function(n){var r=e[n];c(r)||(t["_"+n]=r)})}};v(L,function(e){H[e]=function(t){return 0===arguments.length?this["_"+e]:(this["_"+e]=t,this)}}),_.extend(o.prototype,H),p.Button=o,p._typeDict[6]=o,e.exports=p},function(e,t,n){function r(e,t){e.appendChild(t)}function o(e,t){e.removeChild(t)}function i(e){return e&&e.parentNode.parentNode.comboBox}function a(){var e=this;_.call(e),e.typeName="7",e._autoFormatValue=!1,e._hasInPlaceEditor=!1,b(fe,function(t,n){e["_"+t]=n})}function s(e,t){return e.hasOwnProperty(t)}function l(e,t,n,o,i,a){var s=this;s._DOMObject=e;var l=e.firstChild;v(e).bind(M,function(e){s._onKeydown(e)}).css(z,a||0).css(D,t).css(P,n).css(H,o).css(V,i).css("overflow","visible").attr(N,"gcComboBox");var f,h,m=x(0,o-te);s._editable=!1,s._divObject=f=d(J),s._textareaObject=h=d("textarea"),s._EDITOR=f,r(l,f),u(f),u(h),v(h).bind("keyup",function(){var e=s._EDITOR.value;s._text=e;var t=s._textToValue(e);s.editorValue(t),s._selectByText(e),s._removeTip()}).bind(A,function(){s._updateTip()}).bind(k,function(){s._removeTip()}),v(f).bind(E,function(){s._isDisplayMode?s._trigger(se,{isMouse:!0}):s._toggleDropDownList()}).bind(A,function(){s._updateTip()}).bind(k,function(){s._removeTip()}),s._updateEditor(0,0,m,i);var g=s._BUTTON=d(J);r(l,g),v(g).css(ee,L).css(R,I).css(W,K).css(B,G).attr(N,"gcDropDownButton").bind(E,function(){if(!p(s._showTime)){var e=s._showTime;s._showTime=S;if((new Date).valueOf()-e<100)return}s._isDisplayMode?s._trigger(se,{isMouse:!0}):s._toggleDropDownList()});var _=d("canvas");s._canvas=_,s._updateButton(m,0,o-m,i),r(g,_);var y=s._LIST=d(J);r(l,y),s._isShown=!1,v(y).css(R,I).css(ee,"1px solid").css(W,K).css(z,a||0).css(j,L).css(Y,L).css("cursor","default").css(B,G).attr(N,"gcDropDownWindow").attr(F,-1).css(H,o-2*re).css(V,i),s._updateList(0,i-2*re),s._itemCount=0;var b=s._divList=d(J);r(y,b),s._scrollablePanel=new c._ScrollablePanel(y,b),s._itemHeight=22,s._itemCountPerPage=ne,s._selectedIndex=-1,s._editorValueType=0,s._items=[]}function u(e){v(e).css("margin",0).css("overflow","hidden").css("resize",L).css(R,I).css("padding",ie+"px 0px 0px "+oe+"px").css(j,L).css(W,K).css("white-space","nowrap").css(B,G).css(ee,L).attr(N,"gcComboBoxEditor").attr(F,-1)}var c=n(1),f=n(0),d=c._util._createElement,p=f._Types._isNullOrUndefined,h=c._util,m=h._cancelDefault,g=c.CellTypes,_=g.Base,v=c.GC$,y=v.extend,b=v.each,w=document,C=null,S=void 0,x=Math.max,T=parseInt,E="click",M="keydown",A="mouseover",k="mouseout",R="position",I="absolute",O="font",D="left",P="top",N="gcUIElement",F="tabindex",L="none",H="width",V="height",j="outline",B="box-sizing",U="color",W="background-color",z="z-index",Y="display",G="content-box",K="white",X="black",q="title",J="div",Z="span",Q="text",$="value",ee="border";g.EditorValueType={text:0,index:1,value:2};var te=17,ne=20,re=0,oe=1,ie=1,ae=oe,se="EndEdit.gcEditingInput",le=18,ue="lightgrey",ce="#1E90FF",fe={editorValueType:0,items:[],itemHeight:22,editable:!1,maxDropDownItems:ne};v.inherit(a,_);var de={isReservedKey:function(e,t){return this._hasInPlaceEditor},paintValue:function(e,t,n,r,o,i,a,s){var l=this,u=te,c=x(0,o-u-1);3===a.hAlign&&(a.hAlign=0),a.wordWrap&&(a.wordWrap=!1),c>0&&i>0&&_.prototype.paintValue.call(l,e,l.getText(t,s),n,r,c,i,a,s),e.save(),(u>o||u>i)&&(e.rect(n,r,o,i),e.clip()),e.beginPath(),e.lineWidth=2,e.fillStyle=X,e.moveTo(n+o-u+3,r+(i-2)/2-2.5),e.lineTo(n+o-u+6,r+(i-2)/2+3.5),e.lineTo(n+o-u+9,r+(i-2)/2-2.5),e.fill(),e.restore()},getText:function(e,t){return e},createEditorElement:function(e){var t=e&&e.sheet,n=t&&t.parent,r=n&&n._host,o=h._getPreferredZIndex(r)+1e3,i=t.defaults,a=this,s=new l(a._cellWrapperElement,0,0,i.colWidth,i.rowHeight,o);s.editorValueType(a._editorValueType),s.items(a._items),s.itemHeight(a._itemHeight),s.itemCountPerPage(a._maxDropDownItems),s.editable(a._editable);var u=s.getComboBox();return Object.defineProperty(u,"comboBox",{value:s,writable:!1}),C},getEditorValue:function(e,t){var n=i(e);return n&&(this._autoFormatValue=!n._isEditorValueInItems),n&&n.editorValue()},setEditorValue:function(e,t,n){var r=i(e);r&&r.editorValue(t)},focus:function(e,t){var n=i(e);n&&n.focus()},selectAll:function(e,t){var n=i(e);n&&n.selectAll()},activateEditor:function(e,t,n,r){var o=this,a=r.sheet,s=i(e);s&&(s.editorValueType(o._editorValueType),s.items(o._items),s.itemHeight(o._itemHeight),s.itemCountPerPage(o._maxDropDownItems),s.editable(o._editable),s.bind(se,function(e,t){var n=t.keyCode;if(n){var r=a._commandManager(),o=r.getShortcutKey(n,!1,!1,!1,!1),i=r.getCommands(o);if(i)for(var l=0,u=i.length;l<u;l++)if("navigationLeft"!==i[l].name&&"navigationRight"!==i[l].name||(a._editorStatus=1),i[l].execute(a.parent,{sheetName:a.name()}))return!0}else t.isMouse&&s._isDisplayMode&&a.endEdit()})),o._hasInPlaceEditor=!0},deactivateEditor:function(e,t){if(e){var n=i(e);n&&(n.unbind(se),n.closeDropDownList(),n._isDisplayMode=!1)}this._hasInPlaceEditor=!1},updateEditor:function(e,t,n,r){var o=e&&r&&r.sheet;if(o){var a=i(e);if(t&&a){var s=o._render;a.updateStyle(t.backColor,t.foreColor,s._getZoomFont(t.font||s._getDefaultFont()))}n&&a&&a.updateLocationAndSize(n.x,n.y,n.width,n.height)}},format:function(e,t,n,r){if(p(e))return"";var o,i=this,a=i._editorValueType,l=i._items;if(l){var u=l.length;if(1===a){var c=T(e);0<=c&&c<u&&(o=l[c])!==S&&o!==C&&(e=s(o,Q)?o.text:o)}else if(2===a)for(var f=0;f<u;f++)if((o=l[f])&&s(o,$)&&o.value===e){e=o.text;break}}return _.prototype.format.call(i,e,t,n)},parse:function(e,t,n){var r,o,i=this,a=i._editorValueType,l=i._items,u=_.prototype.parse.call(i,e,t);if(l){var c=l.length;if(0===a)return u;if(1===a){for(o=0;o<c;o++)if((r=l[o])&&s(r,Q)&&r.text===u||r===u)return o}else if(2===a)for(o=0;o<c;o++)if((r=l[o])&&s(r,Q)&&r.text===u)return r.value}return u},getHitInfo:function(e,t,n,r,o){if(!o)return C;var i=o.sheetArea,a=o.sheet;if((p(i)||3===i)&&r){var s=r.x+r.width,l={x:e,y:t,row:o.row,col:o.col,cellStyle:n,cellRect:r,sheetArea:i,sheet:a};return s-te<=e&&e<s&&(l.isReservedLocation=!0),l}return C},processMouseDown:function(e){var t=e.sheet,n=e.sheetArea;if((p(n)||3===n)&&e.isReservedLocation&&t){t.startEdit();var r=i(t._editor);r&&(h._browser.mozilla&&(r._showTime=(new Date).valueOf()),r.showDropDownList(),r._isDisplayMode=!0)}},getAutoFitWidth:function(e,t,n,r,o){return n&&n.wordWrap&&(n.wordWrap=!1),g.Context._getAutoFitWidth(e,t,n,r,o)+te},getAutoFitHeight:function(e,t,n,r,o){return n&&n.wordWrap&&(n.wordWrap=!1),g.Context._getAutoFitHeight(e,t,n,r,o)},isImeAware:function(e){return!0},toJSON:function(){var e,t=this,n={typeName:t.typeName};return b(fe,function(r,o){(e=t["_"+r])!==o&&(n[r]=e)}),n},fromJSON:function(e){var t=this;b(fe,function(n){var r=e[n];p(r)||(t["_"+n]=r)})}};b(fe,function(e){de[e]=function(t){return 0===arguments.length?this["_"+e]:(this["_"+e]=t,this)}}),y(a.prototype,de),g.ComboBox=a,g._typeDict[7]=a,y(l.prototype,{getComboBox:function(){return this._DOMObject},updateLocationAndSize:function(e,t,n,r){var o=this,i=x(0,n-te);o._updateEditor(0,0,i,r),o._updateButton(i,0,n-i,r),o._updateList(0,r-2*re),o.listWidth(n-2*re),o._updateItemWidth()},updateStyle:function(e,t,n){var r=this;v(r._EDITOR).css(W,e).css(U,t).css(O,n),v(r._BUTTON).css(W,e).css(U,t).css(O,n),v(r._LIST).css(W,e).css(U,t).css(O,n)},editorValueType:function(e){return 0===arguments.length?this._editorValueType:(this._editorValueType=e,this)},editorValue:function(e){var t=this;if(0===arguments.length)return t._editorValue;if(e!==t._editorValue){t._editorValue=e;var n=t._valueToText(e);t.text(n),t._selectByText(n,!0)}return t},_valueToText:function(e){var t,n,r=this,o=r._items,i=o.length,a=r._editorValueType;if(r._isEditorValueInItems=!0,1===a)n=o[e],(t=n&&s(n,Q)?n.text:n)===S&&(t=e,r._isEditorValueInItems=!1);else if(0===a){t=e;for(var l=0;l<i&&!((n=o[l])&&s(n,Q)&&n.text===e||n===e);l++);l>=i&&(r._isEditorValueInItems=!1)}else if(2===a){for(var u=0;u<i;u++)if((n=o[u])&&s(n,$)&&n.value===e){t=n.text;break}u>=i&&(t=e,r._isEditorValueInItems=!1)}return p(e)&&(t=""),t},_textToValue:function(e){var t,n=this,r=n._items,o=r.length,i=n._editorValueType,a=e;if(1===i)for(var l=0;l<o;l++)((t=r[l])&&s(t,Q)&&t.text===e||t===e)&&(a=l);else if(2===i)for(var u=0;u<o;u++)t=r[u],t&&s(t,Q)&&t.text===e?a=t.value:t===e&&(a=S);return a},_selectByText:function(e,t){var n;if(e){var r=this._items,o=r.length;for(n=0;n<o;n++){var i=r[n];if(s(i,Q)&&(i=i.text),(t?i:i.toString().substr(0,e.length))===e)break}n>=o&&(n=-1)}else n=-1;this._setSelectedIndexInternal(n)},_removeTip:function(){v(this._EDITOR).removeAttr(q)},_updateTip:function(){var e=this,t=e._measureText(e._text),n=v(e._EDITOR);t>n.width()+oe?n.attr(q,e._text):n.removeAttr(q)},_updateEditor:function(e,t,n,r){n-=re,r-=2*re,v(this._EDITOR).css(D,e).css(P,t).css(H,n-oe).css(V,r-ie)},updateImeMode:function(e,t){if(this.isImeAware()){var n=i(e);n&&n._EDITOR&&v(n._EDITOR).css("ime-mode",t)}},editable:function(e){var t=this;if(0===arguments.length)return t._editable;if(t._editable!==e){t._editable=e;var n=t._DOMObject.firstChild,i=t._EDITOR,a=v(i),s={left:T(a.css(D)),top:T(a.css(P)),width:T(a.css(H)),height:T(a.css(V))},l={backColor:a.css(W),foreColor:a.css(U),font:a.css(O)};return o(n,i),r(n,t._EDITOR=e?t._textareaObject:t._divObject),v(t._EDITOR).css(W,l.backColor).css(U,l.foreColor).css(O,l.font),t._updateEditor(s.left,s.top,s.width,s.height),t}},text:function(e){var t=this,n=t._EDITOR;if(0===arguments.length)return t._text;e!==t._text&&(t._text=e,t._editable?n.value=e:n.textContent=e)},focus:function(){var e=this,t=e._EDITOR;t.focus(),e._editable&&(t.selectionStart=t.value.length)},selectAll:function(){var e=this;e._editable&&e._EDITOR.select()},_updateButton:function(e,t,n,r){n-=re,r-=2*re;var o=this,i=o._canvas;v(o._BUTTON).css(D,e).css(P,t).css(H,n).css(V,r),v(i).attr(H,n).attr(V,r);var a=i.width,s=i.height,l=i.getContext("2d");l.beginPath(),l.lineWidth=2,l.fillStyle=X,l.moveTo(a-te+4,(s-2)/2-2.5),l.lineTo(a-te+7,(s-2)/2+3.5),l.lineTo(a-te+10,(s-2)/2-2.5),l.fill()},showDropDownList:function(){var e=this,t=e._scrollablePanel;e._isShown=!0,v(e._LIST).bind(M,function(t){e._onKeydown(t)}).show(),e._isNeedVScrollbar=!1,e._updateItemHeight(),e._updateItemWidth(),e._isNeedVScrollbar&&(t._verticalSmallChange(v(e._divList.children).height()),t._refreshLayout(!1)),e._setSelectedItemBackColor(ce),e._scrollToIndex(e._selectedIndex),e.focus()},closeDropDownList:function(){var e=this;e._isShown=!1,v(e._LIST).unbind(M).hide(),e._setSelectedItemBackColor(""),e.focus()},_toggleDropDownList:function(){this._isShown?this.closeDropDownList():this.showDropDownList()},listWidth:function(e){var t=this,n=v(t._LIST);if(0===arguments.length)return n.width();e>0&&(n.width(e),t._scrollablePanel._refreshLayout(!1))},listHeight:function(e){var t=this,n=v(t._LIST);if(0===arguments.length)return n.height();e>0&&(n.height(e),t._scrollablePanel._refreshLayout(!1))},_updateList:function(e,t){v(this._LIST).css(D,e).css(P,t)},items:function(e){var t=this;if(0===arguments.length)return t._items;if(e){t._items=e;for(var n,r=t._divList;n=r.firstChild;)o(r,n);t._itemCount=0;for(var i=0,a=e.length;i<a;i++){var l=e[i];t._addItem(s(l,Q)?l.text:l)}return t}},_addItem:function(e){var t=this,n=d(J),o=d(Z);o.textContent=e.toString(),o.style.paddingLeft=ae+"px",r(n,o),r(t._divList,n),t._itemCount++,v(n).bind(E,function(){var e=v(n).index();t.selectedIndex(e),t.closeDropDownList(),t._trigger(se,{isMouse:!0})}).bind(A,function(){var e=v(n);n.oldBackColor=e.css(W),e.css(W,ue)}).bind(k,function(){v(n).css(W,n.oldBackColor||"")})},_addMeasureSpan:function(){var e=this;v(e._measureSpan=d(Z)).css(Y,L).css(O,v(e._LIST).css(O)).appendTo(w.body)},_removeMeasureSpan:function(){o(w.body,this._measureSpan)},_measureTextWidth:function(e){return this._measureSpan.textContent=e,v(this._measureSpan).width()+2+ae},_setSelectedItemBackColor:function(e){var t=this,n=t._selectedIndex;0<=n&&n<t._itemCount&&v(t._divList.children[n]).css(W,e)},_onKeydown:function(e){if(!(e.ctrlKey||e.shiftKey||e.altKey||e.metaKey)){var t=this,n=t._itemCount,r=t._selectedIndex,o=e.keyCode,i=e.which,a=0;38===i||40===i?(r>=0&&r<n&&(a=r+(38===i?-1:1)),a>=0&&a<n&&t.selectedIndex(a),t._isShown&&t._scrollToIndex(a),m(e)):13===i||37===i||39===i||9===i?(t.selectedIndex(t._selectedIndex),t.closeDropDownList(),t._trigger(se,{keyCode:o}),m(e)):27===i&&(t.closeDropDownList(),t._trigger(se,{keyCode:o}),m(e))}},getSelectedValue:function(e,t,n){var r,o=t[e];return p(o)||(1===n?r=e:0===n?r=s(o,Q)?o.text:o:2===n&&s(o,$)&&(r=o.value)),r},_setSelectedIndexInternal:function(e){var t=this;t._setSelectedItemBackColor(""),t._selectedIndex=e,t._setSelectedItemBackColor(ce),t._scrollToIndex(e)},selectedIndex:function(e){var t=this;if(0===arguments.length)return t._selectedIndex;if(0<=e&&e<t._itemCount){t._setSelectedIndexInternal(e);var n=t.getSelectedValue(t._selectedIndex,t._items,t._editorValueType);p(n)||t.editorValue(n)}},itemCountPerPage:function(e){if(0===arguments.length)return this._itemCountPerPage;e>0&&(this._itemCountPerPage=e)},_measureText:function(e){this._addMeasureSpan();var t=this._measureTextWidth(e);return this._removeMeasureSpan(),t},itemHeight:function(e){if(0===arguments.length)return this._itemHeight;e>0&&(this._itemHeight=e)},_updateItemHeight:function(){var e=this;e._addMeasureSpan();var t=e._items[0],n=x(e._itemHeight,v(e._measureSpan).text(p(t)?"":t).height());v(e._divList.children).css(V,n);var r,o=e._itemCount,i=e._itemCountPerPage;o<=i?r=o*n:(r=i*n,e._isNeedVScrollbar=!0),e.listHeight(r),e._removeMeasureSpan()},_updateItemWidth:function(){var e=this;e._addMeasureSpan();var t,n=0,r=e._items;if(r)for(var o=0,i=r.length;o<i;o++){var a=r[o];t=e._measureTextWidth(s(a,Q)?a.text:a),n<t&&(n=t)}e._removeMeasureSpan(),e.listWidth()<n+le&&e.listWidth(n+le)},_scrollToIndex:function(e){if(e>=0&&e<this._itemCount){var t=this._divList.children[e];this._scrollablePanel._scrollChildIntoView(t)}},bind:function(e,t,n){v(this._DOMObject).bind(e,t,n)},unbind:function(e,t){v(this._DOMObject).unbind(e,t)},_trigger:function(e,t){v(this._DOMObject).trigger(e,t)}}),e.exports=g},function(e,t,n){function r(e){return e._getColInfos()}function o(e,t,n){"string"==typeof n&&(n={name:n}),r(e)._setItem(t,n);var o=n&&n.formatter,i=n&&n.cellType;o&&e.setFormatter&&e.setFormatter(-1,t,o),i&&e.setCellType(-1,t,i),n&&n.width&&e.setColumnWidth(t,n.width)}var i=n(25)._BindingManager,a=n(0)._Types._isNullOrUndefined,s=n(1),l=s.Worksheet,u=s.GC$.isEmptyObject,c=l.prototype,f=null,d="bindingPath",p={getDataSource:function(){var e=this._bindingManager;return e?e.getSource():f},setDataSource:function(e,t){var n=this,o=n._bindingManager;if(o&&o.getSource()!==e){if(t&&n._resetImp(),e){o=n._bindingManager;if(!o.bind(e)&&(n.setRowCountCore(o.getRowCount()),n.autoGenerateColumns)){n.setColumnCount(o.getColumnCount());var a=r(n),l=o._getFields();if(l)for(var u=0,c=l.length;u<c;u++)a._setItem(u,{name:l[u]})}}else n._bindingManager=new i(n);n.clearPendingChanges(),s._supportsCalc&&n.recalcAll(),n._invalidate()}},bindColumn:function(e,t){var n=this;n.suspendPaint();try{o(n,e,t)}finally{n.resumePaint()}},bindColumns:function(e){var t=this;t.suspendPaint();try{if(e){var n=e.length;isNaN(n)||t.setColumnCount(n);for(var r=0;r<n;r++)o(t,r,e[r])}}finally{t.resumePaint()}},getDataItem:function(e){var t=this,n=t._bindingManager,o=r(t);if(!n||0===n.getRowCount())return f;var i=t.getColumnCount(),a={},s=n._getDataItem(e);if(s)for(var l in s)s.hasOwnProperty(l)&&"function"!=typeof l&&(a[l]=s[l]);for(var u=0;u<i;u++){var c=o._getItem(u);c&&c.name&&c.name.length>0&&(a[c.name]=t.getValue(e,u))}return a},getDataColumnName:function(e){var t=this;if(0<=e&&e<t.getColumnCount()&&t.getDataSource()){var n=r(t)._getItem(e);return n&&(n.displayName||n.name)}return f},getBindingPath:function(e,t){return this._getModel().getValueForKey(e,t,d)},setBindingPath:function(e,t,n){var r=this;return r._getModel().setValueForKey(e,t,d,n),r._invalidate(),r}};s.GC$.extend(c,p);var h=s.CellRange;h.prototype.bindingPath=h._defProperty(c.getBindingPath,c.setBindingPath),l._registerFeature("binding",{init:function(){var e=this;e.autoGenerateColumns=!0,e._bindingManager=new i(e)},dispose:function(e){var t=this;!1!==e&&(t._bindingManager=f)},onLayoutChanged:function(e){var t=this,n=e.changeType,r=e.row,o=e.rowCount,i=e.sheetArea,a=t._bindingManager;if("addingRows"===n)a&&!1===a._canAdd()?e.canAdd=!1:a&&!1===a._canInsert()&&(e.newRow=t.getRowCount());else if("addRows"===n)a&&a._addItems(r,o);else if("deletingRows"===n){if(a)if(!1===a._canRemove())e.canDelete=!1;else for(var s=t._deletedRows||(t._deletedRows=[]),l=t._getModel(),u=a.getRowCount(),c=0;c<o&&r+c<l.getRowCount();c++){var d=f;r+c<u&&(d=a._getDataItem(r+c));var p=f,h=l.dataTable;h&&h[r+c]&&(p=h[r+c].key),s.push({row:r+c,data:d,key:p})}}else"deleteRows"===n?a&&a._removeItems(r,o):"settingRowCount"===n&&(!a.getSource()||a._isCellBindingSource()||3!==i&&2!==i||(e.canSet=!1))},toJson:function(e,t){function n(e,t,n,r){for(var o=e._bindingManager,i=0;i<n;i++)for(var s=0;s<r;s++){var l=o.getValue(i,s).value;a(l)||e._setValueToDataTable(t,i,s,l)}}function r(e,t,n,r){for(var o=e._getColInfos()._getItems(),i=e.options.colHeaderAutoTextIndex,s=0;s<n;s++)if(i>=0&&s===i||-1===i&&s===n-1)for(var l=0;l<r;l++){var u=t[s]&&t[s][l]&&t[s][l].value,c=o[l];if(a(u)&&c){var f=c.displayName||c.name;f&&e._setValueToDataTable(t,s,l,f)}}}var o=this,i=o.getColumnCount(),s=o.getDataSource();if(t&&t.includeBindingSource&&s){var l=e.data.dataTable||{};n(o,l,o.getRowCount(),i),u(l)||(e.data.dataTable=l);var c=e.colHeaderData.dataTable||{};r(o,c,o.getRowCount(1),i),u(c)||(e.colHeaderData.dataTable=c)}!0!==o.autoGenerateColumns&&(e.autoGenerateColumns=o.autoGenerateColumns)},fromJson:function(e,t){var n=this;if(n._bindingManager=new i(n),t){var r=n._bindingManager,o=e.dataSource,s=e.dataBinding;o&&r.bind(o),s&&r.fromJSON(s,t)}var l=e.autoGenerateColumns;a(l)||(n.autoGenerateColumns=l)},preFromJson:function(){this._bindingManager=new i(this)}})},function(e,t,n){function r(){}var o=n(0),i=n(25),a=o._Types._isNullOrUndefined,s=null;r.prototype={isDataSource:function(e){var t=window.wijmo;return t&&t.data&&t.data.isDataView&&t.data.isDataView(e)},getDataLength:function(e){return e.count()},getDataItem:function(e,t){return e.item(t)},addItems:function(e,t,n,r){if(r){for(var o=0;o<n;o++)e.add(r.createEntity?r.createEntity():new r);e.commitEdit()}},removeItems:function(e,t,n){var r=this.getDataLength(e);if(t<r)for(var o=Math.min(n,r-t),i=0;i<o;i++)e.remove(e.item(t))},getProperties:function(e){var t=0,n=s,r=e.getProperties();if(r&&r.length>0){t=r.length,n=[];for(var o=0;o<t;o++)n.push(r[o].name)}return n},canInsert:function(){return!1},getValue:function(e,t,n,r,o){var i=s,l=!1,u=this.getDataItem(e,r);return a(u)||(t?(i=t(u),l=!0):n&&(i=e.getProperty(u,n),l=!0)),{value:i,hasBinding:l}},setValue:function(e,t,n,r,o,i){var s=!1,l=this.getDataItem(e,r);return a(l)||(t?(t(l,i),s=!0):n&&(e.setProperty(l,n,i),s=!0)),s},fromJSON:function(e){return e},toJSON:function(e){return e.local}},i._dataProviders.dataViewBinding=new r,e.exports=i},function(e,t,n){function r(){}var o=n(1),i=n(0),a=n(25),s=i._Types._isNullOrUndefined,l=o.GC$,u=l.isFunction,c=l.getType,f=l.isNumeric,d=null,p="string",h=window.ko;if(r.prototype={isDataSource:function(e){return h&&h.isObservable(e)},getDataLength:function(e){return e().length},getDataItem:function(e,t){return e()[t]},addItems:function(e,t,n,r){for(var o=0;o<n;o++){var i=d;r&&(i=r.createEntity?r.createEntity():new r),e.splice(t,0,i)}},removeItems:function(e,t,n){var r=this.getDataLength(e);t<r&&e.splice(t,Math.min(n,r-t))},getProperties:function(e){var t=e(),n=t.length,r=[];if(n>0){var o=t[0];for(var i in o)u(o[i])?h&&h.isObservable(o[i])&&r.push(i):r.push(i)}return r},getValue:function(e,t,n,r,o){var i=d,l=!1,u=this.getDataItem(e,r);return s(u)||(t?(i=t(u),l=!0):n?(i=a._getValueByPath(u,n),l=!0):(c(u)===p||f(u))&&0===o&&(i=u,l=!0)),{value:i,hasBinding:l}},setValue:function(e,t,n,r,o,i){var l=!1,u=this.getDataItem(e,r);return s(u)||(t?(t(u,i),l=!0):n?(a._setValueByPath(u,n,i),l=!0):(c(u)===p||f(u))&&0===o&&(e()[r]=i,l=!0)),l},fromJSON:function(e){return h?h.observableArray(e):d},toJSON:function(e){return e()}},a._dataProviders.koBinding=new r,h){var m=h.bindingHandlers;m["gc-spread-sheets"]=m["gcspread-sheets"]=m.wijspread={init:function(e,t,n,r){var i=t(),a=i&&i.sheets,s=new o.Workbook(l("#"+e.id)[0],i);if(a){for(var u,c,f=a.length,d=s.getSheetCount();d<f;)u=s._createSheet(s._getDefaultSheetName(d)),s._addSheetImp(d,0,u),d=s.getSheetCount();for(var h=0;h<f;h++){u=s.getSheet(h),c=a[h];var m=c.name,g=c.autoGenerateColumns,_=c.data,v=c.columns;typeof m===p&&m.length>0&&(u._name=m),"boolean"==typeof g&&(u.autoGenerateColumns=g),_&&u.setDataSource(_),v&&v.length>0&&(u.autoGenerateColumns=!1,u.bindColumns(v))}}},update:function(e,t,n,r){}}}e.exports=a},function(e,t,n){function r(e,t,n){if(!e)return!1;if(e=e.toString(),t=t.toString(),0===n)return e.indexOf(t)>-1;var r,o=(2&n)>0,i=(1&n)>0,s=(4&n)>0;return s?(r=o?a._getWildcardCriteriaFullMatch(t):a._getWildcardCriteria(t),t=r||t,r=i?a._getRegIgnoreCase(t):a._getReg(t),r.test(e)):(i&&(t=t.toLowerCase(),e=e.toLowerCase()),o?t===e:e.indexOf(t)>=0)}function o(e,t,n,r,o,i,a,l){var u=s,c=e+1,f=t+1;return 0===n?f>=0&&f<=l?u={r:e,c:f}:c>=0&&c<=i&&(u={r:c,c:r?a:0}):c<=i?u={r:c,c:t}:f<=l&&(u={r:r?o:0,c:f}),u}var i=n(1),a=n(0)._RegexHelper,s=null,l=Math.max,u="string",c={};i.Worksheet.prototype.search=function(e){if(!e)return s;var t=this,n=e.sheetArea,a=e.searchString,f=e.searchTarget,d=e.searchFlags,p=t.getRowCount(n),h=t.getColumnCount(n),m=new c.SearchResult;if(!a||0===f||p<=0&&h<=0)return m;var g=l(0,e.rowStart),_=l(0,e.columnStart),v=e.rowEnd,y=e.columnEnd,b=(8&d)>0;(v<0||!b)&&(v=p-1),(y<0||!b)&&(y=h-1);for(var w=e.findBeginRow,C=e.findBeginColumn,S=w<0?g:w,x=C<0?_:C;S>=0&&x>=0;){var T,E=t.getCell(S,x,n);if((1&f)>0&&""!==(T=E.cellType()instanceof i.CellTypes.HyperLink?E.cellType().text():E.text())&&r(T,a,d)&&(m.searchFoundFlag|=1,m.foundString=T),i._supportsCalc&&(8&f)>0&&typeof(T=E.formula())===u&&""!==T&&r(T,a,d)&&(m.searchFoundFlag|=8,m.foundString=T),(4&f)>0&&typeof(T=E.tag())===u&&""!==T&&r(T,a,d)&&(m.searchFoundFlag|=4,m.foundString=T),0!==m.searchFoundFlag)return m.foundRowIndex=S,m.foundColumnIndex=x,m;var M=o(S,x,e.searchOrder,b,g,v,_,y);if(!M)break;S=M.r,x=M.c}return m},i.Workbook.prototype.search=function(e){if(!e)return s;var t=this,n=0,r=t.getSheetCount(),o=new c.SearchResult;if(!e.searchString||e.searchTarget===n||r<=0)return o;-1===e.startSheetIndex&&(e.startSheetIndex=0),-1===e.endSheetIndex&&(e.endSheetIndex=r-1);var i,a,l,u=e.startSheetIndex,f=e.endSheetIndex;if(f>=u&&0<=u&&u<r&&0<=f&&f<r)for(i=u;i<=f;i++)if(a=t.getSheet(i),(l=a.search(e))&&l.searchFoundFlag!==n)return l.foundSheetIndex=i,l;return o},c.SearchCondition=function(){return{startSheetIndex:-1,endSheetIndex:-1,searchString:s,searchFlags:0,searchOrder:0,searchTarget:1,sheetArea:3,rowStart:-1,columnStart:-1,rowEnd:-1,columnEnd:-1,findBeginRow:-1,findBeginColumn:-1}},c.SearchResult=function(){return{searchFoundFlag:0,foundSheetIndex:-1,foundRowIndex:-1,foundColumnIndex:-1,foundString:s}},c.SearchFlags={none:0,ignoreCase:1,exactMatch:2,useWildCards:4,blockRange:8},c.SearchOrder={zOrder:0,nOrder:1},c.SearchFoundFlags={none:0,cellText:1,cellTag:4,cellFormula:8},e.exports=c},function(e,t,n){n(59);var t=n(116);t.SR={},t.SR.en=n(60),e.exports=t},function(e,t,n){function r(e,t){e._trigger(A.Events.RangeGroupStateChanging,t)}function o(e,t){e._trigger(A.Events.RangeGroupStateChanged,t)}function i(e,t){if(!e.isEditing||!e.isEditing()){var n=t.info.index,i=t.what===q,a=i?"expandRowOutlineForLevel":"expandColumnOutlineForLevel",l=s(e,i,-1,n,!0);r(e,l),l&&!1===l.cancel&&(e._commandManager().execute({cmd:a,sheetName:e.name(),level:n}),o(e,s(e,i,-1,n,!1)))}}function a(e,t){var n=t.what===Z;if(d(n,e)){var i,a=t.info,l=a.index,u=l,c=a.level,f=n?"expandRowOutline":"expandColumnOutline";1===a.lineDirection?l--:l++,i=s(e,n,l,c,!0),r(e,i),i&&!1===i.cancel&&(e._commandManager().execute({cmd:f,sheetName:e.name(),index:u,level:c,collapsed:a.isExpanded}),o(e,s(e,n,l,c,!1)))}}function s(e,t,n,r,o){var i={sheet:e,sheetName:e._name,isRowGroup:t,index:n,level:r};return o&&(i.cancel=!1),i}function l(e,t){var n=this,r=n._getOutlineLayout(),o=r.width,i=r.height;if(!o&&!i)return I;var a=n._getSheetLayout(),s=new H(r.x,r.y,o,a.height),l=new H(r.x,r.y,a.width,i);if(!s.contains(e,t)&&!l.contains(e,t))return I;var c=u(n,e,t,r.rowMaxLevel,!0);return c||(c=u(n,e,t,r.colMaxLevel,!1)),c||{what:"empty",info:I}}function u(e,t,n,r,o){var i=new E(e,o,r),a=i._getGroupHeaderButton(t,n,o);if(a)return{what:o?q:J,info:a};var s,l=c(e,o,r);for(s=0;s<=2;s++)if(a=l[s]._getGroupButton(t,n,o))return{what:o?Z:Q,info:a};return I}function c(e,t,n){var r,o=[new T(e,t,0,n),new T(e,t,1,n),new T(e,t,2,n)];for(r=0;r<=2;r++)o[r]._createGroupInfo();return o}function f(e,t){var n=t?e.width:e.height;return D(0,(n-2*this.PADDING)/(this._maxLevel+2))}function d(e,t){return e?t.rowOutlines:t.columnOutlines}function p(e,t,n){if(n>0){var r,o,i=e.items,a=[t,0];for(r=0;r<n;r++)a.push(I);if(i.splice.apply(i,a),e._suspendAddingGroup<=0&&t>0&&(o=i[t-1]))for(r=0;r<n;r++)i[t+r]=new x(o);y(e)}}function h(e,t,n){n>0&&(e.items.splice(t,n),y(e))}function m(e,t,n){var r,o,i,a=I,s=e.items;for(o=t;o<U(s)&&(!(r=s[o])||r.level<n||(a||(a=new re(e,o,o,n)),r.level>n&&(i=m(e,o,n+1),o=i.index,a.addChild(i.g)),o>a.end&&(a.end=o),!e.isGroupEnd(o,n)));o++);return{g:a,index:o}}function g(e,t){return t>=-1&&t<U(e.items)}function _(e,t,n){if(e){var r,o=[];for(o.unshift(e);U(o);){if(e=o.pop(),e.level===n&&e.contains(t))return e;r=e.children,F(r,function(e,t){o.unshift(t)})}}return I}function v(e,t){switch(e){case"head":case"tail":return t===I;case"direction":return 1===t;case"itemsData":return 0===U(t);default:return!1}}function y(e){e._rootCached=I,e.refresh()}function b(e){e._rootCached=e.createRangeGroup(),w(e)}function w(e,t){e.groupChangeHandler&&e.groupChangeHandler(t)}function C(e,t,n){if(S(e,t),!g(e,t+n-1))throw new Error($().Exp_InvalidCount)}function S(e,t){if(!g(e,t))throw new Error($().Exp_InvalidIndex)}function x(e){return{level:e?e.level:0,collapsed:!!e&&e.collapsed,viewCollapsed:!!e&&e.viewCollapsed}}function T(e,t,n,r){var o=this;o.PADDING=2,o.LINE_SIZE=2,o.START_LINE_SIZE=6,o._groupLineInfos=[],o._groupDotInfos=[],o._groupButtonInfos=[],o._sheet=e,o._isRowGroup=t,o._viewportIndex=n,o._maxLevel=W(r)?r:d(t,e).getMaxLevel()}function E(e,t,n){var r=this;r.PADDING=2,r._sheet=e,r._isRowGroup=t,r._maxLevel=W(n)?n:d(t,e).getMaxLevel()}var M=n(0),A=n(1),k=n(59),R={},I=null,O=void 0,D=Math.max,P=Math.min,N=A.GC$,F=N.each,L=A._ThemeStyleHelper._getCssClassThemeStyle,H=A.Rect,V=M._ArrayHelper,j=V._nextNonEmptyIndex,B=V._clear,U=V._getLength,W=A._util._isDefined,z=M._Types._isNullOrUndefined,Y=A._util._defProperty,G="rangegroup",K="gc-group",X=K+"-box",q="rgh",J="cgh",Z="rg",Q="cg",$=function(){return M._getResource(R.SR)()},ee={_getOutlineLayout:function(){var e=this,t=e._cachedGroupLayout;if(t)return t;var n,r={x:0,y:0,width:0,height:0,rowMaxLevel:-1,colMaxLevel:-1},o=e.rowOutlines,i=e.columnOutlines,a=17,s=4,l=P(a,a*e._zoomFactor);return e.showRowOutline()&&o&&!o._isEmpty()&&(n=o.getMaxLevel())>=0&&(r.width=l*(n+2)+s,r.rowMaxLevel=n),e.showColumnOutline()&&i&&!i._isEmpty()&&(n=i.getMaxLevel())>=0&&(r.height=l*(n+2)+s,r.colMaxLevel=n),e._cachedGroupLayout=r},showRowOutline:Y("showRowOutline",!0,function(){this._invalidate()}),showColumnOutline:Y("showColumnOutline",!0,function(){this._invalidate()})};N.extend(A.Worksheet.prototype,ee);var te={init:function(){var e=this;e.rowOutlines=new oe(e.getRowCount()),e.columnOutlines=new oe(e.getColumnCount()),e.rowOutlines.groupChangeHandler=function(t){t&&t.indexes&&e.recalcRows&&e.recalcRows(t.indexes),e._invalidateVScrollbar()},e.columnOutlines.groupChangeHandler=function(){e._invalidateHScrollbar()},e._rowStateProviders.push(e.rowOutlines),e._colStateProviders.push(e.columnOutlines)},dispose:function(){N(this._getCanvas()).unbind("mousedown.group")},setHost:function(e){if(e){var t=this;e.bind("mousedown.group",function(e){var n=t._getCanvasOffset(),r=l.call(t,e.pageX-n.left,e.pageY-n.top);if(r){var o=r.what;o===Z||o===q?t.rowOutlines._doClick(t,r):o!==Q&&o!==J||t.columnOutlines._doClick(t,r)}})}},onLayoutChanged:function(e){var t=this,n=e.changeType,r=e.row,o=e.rowCount,i=e.col,a=e.colCount,s=e.sheetArea,l=t.rowOutlines,u=t.columnOutlines;"addRows"===n?p(l,r,o):"deleteRows"===n?h(l,r,o):"addColumns"===n?p(u,i,a):"deleteColumns"===n?h(u,i,a):"invalidateLayout"===n?t._cachedGroupLayout=I:"setColumnCount"===n?3!==s&&1!==s||u._setCount(a):"setRowCount"===n&&(3!==s&&2!==s||l._setCount(o))},paint:function(e){var t=e.ctx,n=e.clipRect,r=this,o=r.rowOutlines,i=r.columnOutlines;o&&o._paint(r,t,n,!0),i&&i._paint(r,t,n,!1)},fromJson:function(e){if(e){var t,n=this,r=e.showRowRangeGroup,o=e.showColumnRangeGroup,i=W(r)?r:e.showRowOutline,a=W(o)?o:e.showColumnOutline;z(i)||n.showRowOutline(i),z(a)||n.showColumnOutline(a),t=e.rowRangeGroup||e.rowOutlines,t&&n.rowOutlines.fromJSON(t),t=e.colRangeGroup||e.columnOutlines,t&&n.columnOutlines.fromJSON(t)}},toJson:function(e){var t=this,n=t.rowOutlines,r=t.columnOutlines,o=t.showRowOutline();!0!==o&&(e.showRowOutline=o);var i=t.showColumnOutline();!0!==i&&(e.showColumnOutline=i),e.rowOutlines=n?n.toJSON():O,e.columnOutlines=r?r.toJSON():O}};A.Worksheet._registerFeature(G,te);var ne={init:function(){k._initOutlineDefaultCommands(this.commandManager())}};A.Workbook._registerFeature(G,ne),R.OutlineDirection={backward:0,forward:1},R.OutlineState={expanded:0,collapsed:1};var re=function(){function e(e,t,n,r){var o=this;o.children=[],o.parent=I,o.model=e,o.start=t,o.end=n,o.level=r}return e.prototype={state:function(e){var t=this,n=t.model;if(!arguments.length)return n?n.getState(t):0;n&&n.expand(t.level,0===e)},contains:function(e){return this.start<=e&&e<=this.end},addChild:function(e){e&&(this.children.push(e),e.parent=this)}},e}();R.OutlineInfo=re;var oe=function(){function e(e){var t=this;t.head=I,t.tail=I,t._rootCached=I,t.items=new Array(e),t._suspendAddingGroup=0,t._empty=!0}return e.prototype={direction:Y("direction",1),group:function(e,t){var n,r,o=this;for(C(o,e,t),n=0;n<t;n++)r=e+n,o.items[r]?o.items[r].level++:o.items[r]=new x;b(o),o._empty=!1},ungroupRange:function(e,t){var n,r,o=this;for(C(o,e,t),n=0;n<t;n++)(r=o.items[e+n])&&r.level>-1&&r.level--;b(o)},ungroup:function(){var e=this,t=U(e.items);e.items=new Array(t),b(e),e._empty=!0},expand:function(e,t){if(e<-1)throw new Error($().Exp_InvalidLevel);var n,r,o=this,i=o.items;for(n in i)i[n]&&(r=o.find(n,e))&&o.expandGroup(r,t)},expandGroup:function(e,t){if(!e)throw new Error($().Exp_GroupInfoIsNull);var n=this,r=n.direction(),o=-1;0===r?o=e.start-1:1===r&&(o=e.end+1),n.setCollapsed(o,!t)},_isVisible:function(e){return!g(this,e)||!this.isCollapsed(e)},isCollapsed:function(e){var t=this.items[e];return t&&t.viewCollapsed&&t.level>-1},find:function(e,t){var n=this,r=n._rootCached,o=I;return r&&(-1===t?o=r:(S(n,e),o=_(r,e,t))),o},getLevel:function(e){var t=this.items[e];return t?t.level:-1},getCollapsed:function(e){var t=this.items[e];return!!t&&!!t.collapsed},_setViewCollapsed:function(e,t,n,r){for(var o=t;o<=n;o++){var i=e[o];i||(i=e[o]=new x,i.level=-1),i.viewCollapsed=r}},setCollapsed:function(e,t){var n,r=this,o=!1,i=r.items;e<0?(n=r.head)||(n=r.head=new x):e<U(i)?(n=i[e])||(n=i[e]=new x,n.level=-1):(n=r.tail)||(n=r.tail=new x);var a=1===r.direction();n.collapsed!==t&&(n.collapsed=t,o=!0,r._updateViewCollapsed(e,t));var s;if(o){y(r),e+=a?-1:1;for(var l=[],u=r.find(e,r.getLevel(e)),c=u.start;c<=u.end;c++)l.push(c);s={indexes:l}}w(r,s)},_updateViewCollapsed:function(e,t){var n=this,r=n.items,o=1===n.direction(),i=o?-1:1,a=_(n._rootCached,e+i,n.getLevel(e+i));if(a)if(t)n._setViewCollapsed(r,a.start,a.end,!0);else{for(var s=!1,l=a.parent;l;){var u=o?l.end+1:l.start-1;if(r[u]&&r[u].collapsed&&r[u].level>-1){s=!0;break}l=l.parent}if(!s){n._setViewCollapsed(r,a.start,a.end,!1);for(var c=[a],f=0;f>=0;){var d=c[f--];if(u=o?d.end+1:d.start-1,r[u]&&r[u].collapsed&&-1!==r[u].level)n._setViewCollapsed(r,d.start,d.end,!0);else for(var p=d.children,h=0;p&&h<p.length;h++)c[++f]=p[h]}}}},getMaxLevel:function(){var e,t=-1,n=this.items;return F(n,function(n,r){r&&(e=r.level)>t&&(t=e)}),t},_moveOrCopy:function(e,t,n,r){if(!(n<=0||e===t)){e<0&&(e=0),t<0&&(t=0);for(var o,i=this,a=[],s=i.items,l=j(s,e-1);l>=0&&l<e+n;)o=new x(s[l]),a.push({index:l-e,value:o}),l=j(s,l);r&&B(s,e,n),B(s,t,n),F(a,function(e,n){s[t+n.index]=n.value}),y(i)}},_exMoveOrCopy:function(e,t,n,r,o){t<0&&(t=0),n<0&&(n=0);var i=[];if(e)for(var a=j(e.items,t-1);a>=0&&a<t+r;)i[a-t]=new x(e.items[a]),a=j(e.items,a);if(B(this.items,n,r),i.length>0)for(var s in i)i.hasOwnProperty(s)&&(this.items[n+s]=i[s]);o&&B(e.items,t,r)},refresh:function(){this._empty||b(this)},_setCount:function(e){var t=this,n=t.items,r=U(n),o=e-r;if(o<0)n.splice(e,-o);else{var i,a=n[r-1];if(a)for(i=0;i<o;i++)n.push(new x(a));else t.items=n.concat(new Array(o))}y(t)},getState:function(e){var t,n=this,r=n.items,o=n.direction(),i=-1;return 0===o?i=e.start-1:1===o&&(i=e.end+1),t=i<0?n.head:i<U(r)?r[i]:n.tail,t&&t.collapsed?1:0},_setLevel:function(e,t){var n=this,r=n.items;e<0?(n.head||(n.head=new x),n.head.level=t):e<U(r)?(r[e]||(r[e]=new x),r[e].level=t):(n.tail||(n.tail=new x),n.tail.level=t),y(n)},suspendAdding:function(){this._suspendAddingGroup++},resumeAdding:function(){this._suspendAddingGroup--},createRangeGroup:function(){for(var e=this,t=U(e.items),n=new re(e,0,t-1,-1),r=0;r<t;){var o=m(e,r,0),i=o.g;r=o.index+1,i&&i.level>-1&&n.addChild(i)}return n},isGroupEnd:function(e,t){var n,r=this,o=r.items,i=e+1;if(!g(r,i))return!0;if(!(n=o[i]))return!0;var a=n.level,s=o[e].level,l=!1;if(a<s){var u=s-a,c=s-t;c>=0&&c<u&&(l=!0)}return l},hitTest:function(e,t,n){return l.call(e,t,n)},_paint:function(e,t,n,r){var o=e._getOutlineLayout(),i=e._getSheetLayout(),a=e._cachePool,s=o.width,l=o.height;if(s||l){var u=r?s:i.width,f=r?i.height:l,d=r?o.rowMaxLevel:o.colMaxLevel,p=r?a._getRowGroups:a._getColGroups;if(t.save(),t.beginPath(),!n||n.intersect(o.x,o.y,u,f)){var h,m,g=new E(e,r,d);for(g._paintGroupHeader(t),h=p.call(e._cachePool,function(){return c(e,r,d)}),m=0;m<=2;m++)h[m]._paintGroups(t)}t.beginPath(),t.restore()}},_doClick:function(e,t){if(t){var n=t.what;n===q||n===J?i(e,t):n!==Z&&n!==Q||a(e,t)}},_isEmpty:function(){return this._empty},fromJSON:function(e){if(e){var t,n,r,o=this,i=o.items,a=e.itemsData,s=e.direction,l=e.head,u=e.tail,c=[];F(a,function(e,a){if(t=a.index,n=a.info,t>=0&&n){for(r=0;r<a.count&&!(t+r>=U(i));r++)a.info.collapsed&&c.push(a),i[t+r]=new x(n);o._empty=!1}}),z(s)||o.direction(s),l&&(o.head=l),u&&(o.tail=u),y(o);for(var f=0;f<c.length;f++)o._updateViewCollapsed(c[f].index,!0)}},toJSON:function(){var e,t=this,n=[],r=t.items,o=-1;for(e=0;e<U(r);e++){var i=n[o],a=r[e];a&&(o>=0&&e===i.count+i.index&&a.level===i.info.level&&a.collapsed===i.info.collapsed?n[o].count++:n[++o]={index:e,count:1,info:{level:a.level,collapsed:a.collapsed}})}var s={itemsData:n,direction:t.direction(),head:t.head,tail:t.tail},l={};return F(s,function(e,t){v(e,t)||(l[e]=t)}),N.isEmptyObject(l)?O:l}},e}();R.Outline=oe,T.prototype={_createGroupInfo:function(){var e=this;if(-1!==e._maxLevel){var t=e._getGroupInfosByLevel(0,e._isRowGroup);F(t,function(t,n){e._measureGroups(n)})}},_measureGroups:function(e){var t,n=this,r=n._sheet,o=n._isRowGroup,i=d(o,r).direction(),a=1===i,s=0===i,l=n._getViewportIndex(!0,o),u=n._getViewportIndex(!1,o),c=e.start,f=e.end,p=e.level;if(a?t=f+1:s&&(t=c-1),0===e.state()){var h=!0,m=e.parent;if(m&&(s&&c===m.start||a&&f===m.end)&&(h=!1),h&&n._addButtonInfo(!0,p,t,l,u,i),c<=u&&f>=l){var g,_,v,y=D(l,c),b=P(u,f);h&&(g={start:y,end:b,level:p,startLine:I},(a&&y===c||s&&b===f)&&(g.startLine=!0),n._groupLineInfos.push(g));var w=[],C=e.children;for(_=y;_<=b;_++)w.push(!1);F(C,function(e,t){var r,o=t.start,i=t.end;if(1===t.state())for(v=o;v<=i;v++)w[v-y]=!0;a?r=i+1:s&&(r=i-1),w[r-y]=!0,n._measureGroups(t)});var S=!0;for(_=0;_<U(C);_++){var x=C[_],T=x.start,E=x.end,M=T===c,A=E===f;if(M&&A){S=!1;break}if(a&&A||s&&M)for(v=T;v<=E;v++)w[v-y]=!0}if(S)for(var k=y;k<=b;k++)if(!w[k-y]){var R={index:k,level:p+1};n._groupDotInfos.push(R)}}}else 1===e.state()&&n._addButtonInfo(!1,p,t,l,u,i)},_addButtonInfo:function(e,t,n,r,o,i){var a={isExpanded:e,level:t};e&&(a.paintLine=!0),n>=r&&n<=o&&(a.index=n,a.lineDirection=i,this._groupButtonInfos.push(a))},_getIndexRowOrColumnLayout:function(e){var t=this,n=t._sheet,r=t._viewportIndex;return t._isRowGroup?n._getRowLayout(r).findRow(e):n._getColumnLayout(r).findCol(e)},_paintGroups:function(e){var t=this;if(-1!==t._maxLevel){var n=t._sheet._getOutlineLayout(),r=t._isRowGroup,o=f.call(t,n,r);if(o){var i=t.START_LINE_SIZE,a=t.PADDING,s=t.LINE_SIZE,l=D(0,(o-i)/2)+a;e.save(),e.fillStyle=L(K).color,t._paintOutlineDots(e,t._groupDotInfos,r,n,o,l,s),t._paintOutlineLine(e,t._groupLineInfos,r,n,o,l,s,i),t._paintOutlineButton(e,t._groupButtonInfos,r,n,o,l,s,a),e.beginPath(),e.restore()}}},_paintOutlineDots:function(e,t,n,r,o,i,a){var s,l,u=this;F(t,function(t,c){var f=u._getIndexRowOrColumnLayout(c.index);if(f){var d=n?f.y:f.x,p=(n?f.height:f.width)-a;p>=0&&(s=d+D(0,p/2),l=c.level*o+i,n?s=[l,l=s][0]+.5:l+=.5,e.fillRect(r.x+s,r.y+l,a,a))}})},_paintOutlineLine:function(e,t,n,r,o,i,a,s){var l,u=this,c=u._sheet,f=d(n,c).direction();for(l=0;l<U(t);l++){var p,h,m=t[l],g=m.start,_=m.end;do{p=u._getIndexRowOrColumnLayout(g),g++}while(!p&&g<=_);do{h=u._getIndexRowOrColumnLayout(_),_--}while(!h&&_>=g);if(p||h){!p&&h?p=h:p&&!h&&(h=p);var v=n?p.y:p.x,y=m.level*o+i,b=n?a:D(0,h.x+h.width-p.x),w=n?D(0,h.y+h.height-p.y):a;if(1===f&&(v+=1),n?v=[y,y=v][0]+.5:y+=.5,e.fillRect(r.x+v,r.y+y,b,w),m.startLine){var C=P(s,o-a);C>0&&(0===f&&(n?y=y+w-a:v=v+b-a),n&&y>=p.y&&y<h.y+h.height?e.fillRect(r.x+v,r.y+y,C,a):!n&&v>=p.x&&v<h.x+h.width&&e.fillRect(r.x+v,r.y+y,a,C))}}}},_paintOutlineButton:function(e,t,n,r,o,i,a,s){var l,u=this;for(l=0;l<U(t);l++){var c=t[l],f=u._getIndexRowOrColumnLayout(c.index);if(f){var d=n?f.height:f.width;if(!(d<=0)){var p,h,m,g,_,v=D(0,(d-o)/2),y=(n?f.y:f.x)+v,b=c.level*o+s,w=P(o,d),C=o;if(_=d-w,n?(y=[b,b=y][0],w=[C,C=w][0],m=.5,g=0):(m=0,g=.5),e.strokeStyle=L(X).borderTopColor,e.lineWidth=1,e.fillStyle=L(X).backgroundColor,e.fillRect(r.x+y,r.y+b,w,C),p=r.x+y+m,h=r.y+b+g,e.strokeRect(p,h,w,C),e.fillStyle=L(K).color,u._paintButtonIcon(e,c.isExpanded,p,h,w,C),c.paintLine&&_>0){y=n?f.y:f.x,b=c.level*o+i;var S=0===c.lineDirection,x=n?a:v,T=n?v:a;n?(y=[b,b=y][0],S&&(b+=v+C,T=_-v)):S&&(y+=v+w,x=_-v),e.fillRect(r.x+y+m,r.y+b+g,x,T)}}}}},_paintButtonIcon:function(e,t,n,r,o,i){t||e.fillRect(n+o/2-1,r+4,2,i-8),e.fillRect(n+4,r+i/2-1,o-8,2)},_getGroupInfosByLevel:function(e,t){var n,r=this,o=r._sheet,i=[],a=-1,s=-1,l=d(t,o),u=t?o._getRowLayout:o._getColumnLayout,c=u.call(o,r._viewportIndex),f=U(c);if(f){var p=c[0],h=c[f-1];a=D(0,(t?p.row:p.col)-1),s=t?P(o.getRowCount(),h.row+2):P(o.getColumnCount(),h.col+2)}for(;a<s;)n=l.find(a,e),n?(a=n.end+1,i.push(n)):a++;return i},_getViewportIndex:function(e,t){var n=-1,r=this,o=r._sheet,i=r._viewportIndex,a=o.frozenRowCount(),s=o.frozenColumnCount(),l=o.frozenTrailingRowCount(),u=o.frozenTrailingColumnCount(),c=o.getRowCount(),f=o.getColumnCount();return 0===i?n=e?0:(t?a:s)-1:1===i?n=e?t?a:s:(t?c-l:f-u)-1:2===i&&(n=e?t?c-l:f-u:(t?c:f)-1),n},_processTouch:function(e){e&&this._sheet._isTouchMode&&(e.x-=2,e.y-=2,e.width+=4,e.height+=4)},_getGroupButton:function(e,t,n){var r=this;if(r._maxLevel<0)return I;var o=r._sheet,i=o._getOutlineLayout(),a=f.call(r,i,n);if(!a)return I;var s,l,u,c=r._groupButtonInfos;for(u=0;u<U(c);u++){var d=c[u],p=d.index,h=d.level*a+r.PADDING,m=r._getIndexRowOrColumnLayout(p);if(m&&!((s=n?m.height:m.width)<=0)){var g=P(a,s),_=a,v=(n?m.y:m.x)+D(0,(s-a)/2),y=h;if(n&&(g=[_,_=g][0],v=[y,y=v][0]),l=new H(i.x+v+.5,i.y+y+.5,g,_),r._processTouch(l),l.contains(e,t))return d}}return I}},E.prototype={_paintGroupHeader:function(e){var t=this,n=t._sheet,r=t._maxLevel;if(!(r<0)){var o=t._isRowGroup,i=n._getOutlineLayout(),a=f.call(t,i,o);if(a){var s,l,u,c,d=r+2,p=t.PADDING,h=n.options,m=i.width,g=i.height,_=i.x,v=i.y,y=n._getSheetLayout(),b=y.width,w=y.height,C=y._colHeaderHeight,S=y._rowHeaderWidth,x=y._headerX,T=y._headerY;if(e.fillStyle=L(K).backgroundColor,e.strokeStyle=L(X).borderTopColor,e.font="8.25pt Arial",e.lineWidth=1,e.fillRect(_,v,o?m:b,o?w:g),e.strokeRect(_-.5,v-.5,o?m:b+1,o?w+1:g),o?e.strokeRect(_-.5,T-.5,m,C):e.strokeRect(x-.5,v-.5,S,g),s=(o?C:S)-a,l=D(0,(o?T:x)+s/2),u=p,o&&(l=[u,u=l][0]),(o?h.colHeaderVisible:h.rowHeaderVisible)&&s>=0)for(c=0;c<d;c++){var E,M=a-1,A=_+l,k=v+u;o?A+=.5:k+=.5,e.fillStyle=L(X).backgroundColor,e.fillRect(A,k,M,M),e.strokeRect(A,k,M,M),e.fillStyle=L(X).color,E=n._getFontHeight(e.font),t._paintHeaderIcon(e,A,k,M,a,c+1,E),o?l+=a:u+=a}}}},_paintHeaderIcon:function(e,t,n,r,o,i,a){var s=""+i,l=e.measureText(s).width;l<=r&&a<=o&&(e.textBaseline="middle",e.fillText(s,t+(r-l)/2,n+r/2))},_getGroupHeaderButton:function(e,t,n){var r=this,o=r._sheet,i=r._maxLevel;if(i<0)return I;var a=i+2,s=o._getSheetLayout(),l=o.options;return n?r._getHeaderIndex(o,e,t,n,l.colHeaderVisible,s._colHeaderHeight,s._headerY,a):r._getHeaderIndex(o,e,t,n,l.rowHeaderVisible,s._rowHeaderWidth,s._headerX,a)},_getHeaderIndex:function(e,t,n,r,o,i,a,s){var l,u,c,d,p=this,h=e._getOutlineLayout(),m=f.call(p,h,r),g=i-m;if(m&&o&&g>=0)for(l=D(0,a+g/2),u=p.PADDING,r&&(l=[u,u=l][0]),d=0;d<s;d++){if(c=new A.Rect(h.x+l,h.y+u,m,m),c.contains(t,n))return{index:d};r?l+=m:u+=m}return I}},e.exports=R},function(e,t,n){function r(){return Me._getResource(Ee.SR)()}function o(e){return e.height}function i(e){return e.width}function a(e){clearInterval(e)}function s(){return(new Date).valueOf()}function l(e,t){if(!e||!t)return!1;var n=13,r=15,o=n,i=n,a=r,s=r,l=e.X-t.X,u=e.Y-t.Y;return Qe(l)<o&&Qe(u)<i&&it(l*l+u*u)<$e(a,s)}function u(e){return e.getActiveSheet()}function c(e){return e.getSelections()}function f(e){return e.frozenTrailingColumnCount()}function d(e){return e.frozenTrailingRowCount()}function p(e,t){return e.getColumnCount(t)}function h(e,t){return e.getRowCount(t)}function m(e){var t=Oe(e).offset(),n=Mt.body,r=0,o=0;return t&&(r=t.top+n.clientTop||0,o=t.left+n.clientLeft||0),{_top:r,_left:o}}function g(){var e=this;e._elements=[],e._pressedPointers={length:0},e._manipulationProcessor=new C,e._tapEventProcesser=new S}function _(e,t){var n=nt(t.Y,t.X)-nt(e.Y,e.X);return n>rt?n-=2*rt:n<-rt&&(n+=2*rt),n}function v(e,t){return it((t.X-e.X)*(t.X-e.X)+(t.Y-e.Y)*(t.Y-e.Y))}function y(e,t,n){var r=new x(n._Center.X,n._Center.Y),o=new x(t.X-r.X,t.Y-r.Y),i=new x(e.X-r.X,e.Y-r.Y),a=$e(1,tt(v(t,r)/n._Radius,4)),s=_(o,i);return Ct(s)?0:s*a}function b(e){return Qe(e)<=2.220446049250313e-16}function w(e,t){var n,r=!1,o=!1;return 0!==e&&(n=at(t/e)/rt*180)<20&&(r=!0),0===e?o=!0:(n=at(t/e)/rt*180)>75&&n<105&&(o=!0),{_translateXLocked:r,_translateYLocked:o}}function C(){var e=this;e._totalTranslateX=0,e._totalTranslateY=0,e._totalScale=1,e._totalRotation=0,e._totalExpansion=0,e._process=0,e._workingModes=511,e._manipulatorPointers=new O,e._minimumScaleRotateRadius=20,e._deltaHistory=new E}function S(){}function x(e,t){this.X=e,this.Y=t}function T(e){return new x(e?ot(e.X):-1,e?ot(e.Y):-1)}function E(){var e=this;e._count=0,e._start=0,e._maxCount=10,e._history=[]}function M(e,t,n,r,o){var i=this;e?i._history=e:(i._linear=new x(t,n),i._angular=r,i._expansion=o)}function A(e){this._initialVelocity=e,this._decelerationInternal=0}function k(e){this._initialVelocity=e,this._decelerationInternal=0}function R(e,t){var n=this;n._initialXVelocity=e,n._initialYVelocity=t,n._XDeceleration=0,n._YDeceleration=0,n._decelerationInternal=0,n._velocity=it(e*e+t*t)}function I(){var e=this;e._Translation=new x(0,0),e._Scale=0,e._Rotation=0,e._Expansion=0}function O(){this._list=[]}function D(e,t,n){var r=this;r._Cumulative=e,r._Delta=t,r._Velocities=n}function P(e,t,n,r,o){var i=this;i._OriginalSource=e,i._Cumulative=t,i._IsInertia=n,i._Position=r,i._Velocities=o}function N(e,t,n,r,o,i){var a=this;a._OriginalSource=e,a._Cumulative=t,a._Delta=n,a._IsInertia=r,a._Position=o,a._Velocities=i}function F(e,t,n,r,o,i,a){var s=this;s._OriginalSource=e,s._Cumulative=t,s._Delta=n,s._Velocities=r,s._ExpansionBehavior=o,s._RotationBehavior=i,s._TranslationBehavior=a}function L(e,t,n,r){var o=this;o._OriginalSource=e,o._PointerCount=t,o._Cumulative=n,o._Position=r}function H(e,t,n,r){var o=this;o._OriginalSource=e,o._Mode=t,o._Pivot=n,o._Position=r}function V(e){this._Position=e}function j(e){this._Position=e}function B(e){this._Position=e}function U(e,t){var n=e*t;return n>4?n=4:n<.5&&(n=.5),n}function W(e){this._sheet=e}function z(e,t,n){var r,i,a=n,s=0,l=0,u=e._cachePool,c=e._getSheetLayout()._viewportY,f=e._getViewportRowLayout(1).findRow(a);if(f)if(t>0){for(r=e._getScrollableRow(-1),s=c-f.y;a>r&&s<t;)a--,s+=u._getZoomRowHeight(a);l=t-s}else if(t<0){for(i=e._getLastVisualScrollRow(),s=-(f.y+o(f)-c);a<i&&s>t;)a++,s-=u._getZoomRowHeight(a);l=t-s}return{_row:a,_offset:l}}function Y(e,t,n){var r,o,a=n,s=0,l=0,u=e._cachePool,c=e._getSheetLayout()._viewportX,f=e._getViewportColumnLayout(1).findCol(a);if(f)if(t>0){for(r=e._getScrollableColumn(-1),s=c-f.x;a>r&&s<t;)a--,s+=u._getZoomColWidth(a);l=t-s}else if(t<0){for(o=e._getLastVisualScrollColumn(),s=-(f.x+i(f)-c);a<o&&s>t;)a++,s-=u._getZoomColWidth(a);l=t-s}return{_col:a,_offset:l}}function G(e,t){return St(-t/(e/t+1)+t)}function K(e,t){return St(t*(-t/(e-t)-1))}function X(e,t,n,r,o,i){e.fillStyle=t,e.fillRect(n,r,o,i)}function q(e,t,n,r,o){var i,a=He._getVisualStateThemeStyle(0,"gc-columnHeader-normal"),s=a&&a.backgroundImage,l=a&&a.backgroundColor;if(s&&-1!==s.indexOf("linear-gradient")){var u=Fe._getLinearGradientColors(s);i=e.createLinearGradient(t+r/2,n,t+r/2,n+o);for(var c=0,f=u.length;c<f;c++){var d=u[c];i.addColorStop(d.point,d.color)}}else l&&(i=l);return i}function J(){var e=He._getVisualStateThemeStyle(0,"gc-rowHeader-normal");return e&&e.backgroundColor}function Z(e,t){var n,r,a,s,l=e._getSheetLayout(),u=e._render,c=u._getGrayAreaBackColor(!1),f=u._getCtx(),d=u._getBufferCtx(),m=e._getViewportRowLayout(1);n=l._headerX,a=i(l);var g=e._getScrollableRow(-1),_=m.findRow(g);if(_&&(r=l._viewportY,(s=_.y-r-1)>0))if(t){var v=l._rowHeaderWidth,y=J(f,n,r,v-1,s+1);X(f,y,n,r,v-1,s+1),X(d,y,n,r,v-1,s+1),X(f,c,n+v,r,a-v,s),X(d,c,n+v,r,a-v,s)}else X(f,c,n,r,a,s),X(d,c,n,r,a,s);var b=e._getScrollableRow(h(e),!0),w=m.findRow(b);w&&(r=w.y+o(w),(s=l._frozenTrailingY-r-1)>0&&(X(f,c,n,r,a,s),X(d,c,n,r,a,s)));var C=e._getViewportColumnLayout(1);r=l._headerY,s=o(l);var S=e._getScrollableColumn(-1),x=C.findCol(S);if(x&&(n=l._viewportX,(a=x.x-n-1)>0))if(t){var T=l._colHeaderHeight,E=q(f,n,r,a+1,T-1);X(f,E,n,r,a+1,T-1),X(d,E,n,r,a+1,T-1),X(f,c,n,r+T,a,s-T),X(d,c,n,r+T,a,s-T)}else X(f,c,n,r,a,s),X(d,c,n,r,a,s);var M=e._getScrollableColumn(p(e),!0),A=C.findCol(M);A&&(n=A.x+i(A),(a=l._frozenTrailingX-n-1)>0&&(X(f,c,n,r,a,s),X(d,c,n,r,a,s)))}function Q(e,t,n,r,o,i){e.beginPath(),e.strokeStyle=t,e.moveTo(n,r),e.lineTo(o,i),e.stroke()}function $(e,t){var n,r,a,s,l=e._getSheetLayout(),u=e._render,c=e.options.gridline.color,f=He._getVisualStateThemeStyle(0,"gc-columnHeader-normal"),d=f&&f.borderBottomColor,p=u._getCtx(),h=e._getViewportRowLayout(1);n=l._headerX,a=i(l);var m=e._getScrollableRow(-1),g=h.findRow(m);g&&(r=l._viewportY,(s=g.y-r)>0&&(Q(p,c,n,g.y-.5,n+a,g.y-.5),t&&Q(p,d,l._frozenX-.5,r,l._frozenX-.5,g.y)));var _=e._getViewportColumnLayout(1);r=l._headerY,s=o(l);var v=e._getScrollableColumn(-1),y=_.findCol(v);y&&(n=l._viewportX,(a=y.x-n)>0&&(Q(p,c,y.x-.5,r,y.x-.5,r+s),t&&Q(p,d,n,l._frozenY-.5,y.x,l._frozenY-.5)))}function ee(e,t){var n=0;return e||(n|=1),t||(n|=2),n}function te(e){this._sheet=e}function ne(e,t,n,r,o){var i=e.parent,a=e._eventHandler,s=e.options,l=t.rowViewportIndex,u=t.colViewportIndex,f=c(e),d=Je;if(e._isTouchMode&&f.length>0){var p=f[f.length-1],h=p.row,m=p.row+p.rowCount-1,g=p.col,_=p.col+p.colCount-1;i&&!i.options.allowUserResize||(-1!==h&&-1===g&&l>=0&&u<0&&s.rowHeaderVisible?!(d=a._getResizeRowInfo(e,t,o,2,r))||"sizeRow"!==d.action&&"sizeHiddenRow"!==d.action||2!==d.sheetArea||d.index===m||(d=Je):-1===h&&-1!==g&&l<0&&u>=0&&s.colHeaderVisible&&(!(d=a._getResizeColInfo(e,t,o,1,n))||"sizeCol"!==d.action&&"sizeHiddenCol"!==d.action||1!==d.sheetArea||d.index===_||(d=Je)))}return d}function re(e,t,n,r){var a=t.hitTestType,s=Se(e),l=c(e),u=3;if(e._isTouchMode&&l.length>0){var f=l[l.length-1];-1!==f.row&&-1!==f.col?u=3:-1!==f.row?u=2:-1!==f.col&&(u=1)}for(var d=0;d<s.length;d++){var p=s[d];if(p&&(p.x-=i(p),p.y-=o(p),p.width*=3,p.height*=3,p.contains(n,r))){if(Re(t.row)){var h=e._getViewportRowLayout(1);h&&h.length>0&&(t.row=h[h.length-1].row)}if(Re(t.col)){var m=e._getViewportColumnLayout(1);m&&m.length>0&&(t.col=m[m.length-1].col)}return{x:n,y:r,type:u,isHeader:!1,isFirstIndicator:0===d}}}return 1===a?{x:n,y:r,type:1,isHeader:!0}:2===a?{x:n,y:r,type:2,isHeader:!0}:Je}function oe(e,t,n,r){var a=Je,s=t.rowViewportIndex,l=t.colViewportIndex;if(Re(s)||Re(l))return a;var u=e.parent,c=e._getActiveSelectedRange();if(s>=0&&l>=0&&1===e._selectionModel.length){var m=e._getActualRange(c),g=f(e),_=d(e),v=p(e)-g,y=h(e)-_;if(1===l&&g>0&&m.col<v&&m.col+m.colCount>v){var b=e._getColumnLayout(l);if(b&&b.length>0){var w=b[b.length-1];if(n>w.x+i(w))return a}}if(1===s&&_>0&&m.row<y&&m.row+m.rowCount>y){var C=e._getRowLayout(s);if(C&&C.length>0){var S=C[C.length-1];if(r>S.y+o(S))return a}}}var x=be(e);return x&&(a||(x.x-=i(x),x.y-=o(x),x.width*=3,x.height*=3,x.contains(n,r)&&(a={action:"drag",side:"corner"})),u&&u.options.allowUserDragFill||a&&"corner"===a.side&&(a.side=Je)),a}function ie(e,t,n,r){for(var o=!1,i=e._selectionModel,a=0,s=i.length;a<s;a++){var l=i[a],u=3===r||Re(r);u&&(l=e._getActualRange(l));var c=l.row,f=l.col,d=l.rowCount,p=l.colCount;if(u)l=e._getActualRange(l),o=c<=t&&t<c+d&&f<=n&&n<f+p;else if(2===r)o=-1===f&&c<=t&&t<c+d;else if(1===r)o=-1===c&&f<=n&&n<f+p;else if(0===r)return o;if(o)break}return o}function ae(e,t,n,r){if(!t){var o=c(e),i=o[o.length-1];n?3===r?(e._activeRowIndex=i.row+i.rowCount-1,e._activeColIndex=i.col+i.colCount-1):2===r?(e._activeRowIndex=i.row+i.rowCount-1,e._activeColIndex=0):1===r&&(e._activeRowIndex=0,e._activeColIndex=i.col+i.colCount-1):3===r?(e._activeRowIndex=i.row,e._activeColIndex=i.col):2===r?(e._activeRowIndex=i.row,e._activeColIndex=0):1===r&&(e._activeRowIndex=0,e._activeColIndex=i.col)}}function se(e,t,n,r){var o=c(e),i=o[o.length-1];(t||n)&&(3===r?(e._activeRowIndex=i.row,e._activeColIndex=i.col):2===r?(e._activeRowIndex=i.row,e._activeColIndex=0):1===r&&(e._activeRowIndex=0,e._activeColIndex=i.col))}function le(e){var t=this;t._isScroll=!1,t._touchZoomManager=new W(e),t._touchScrollManager=new te(e),t._sheet=e}function ue(e,t,n){var r=this;r._touchEventProvider=n,r._touchMouseMessageFilter=new pe(t),r._touchEventHandler=new le(t),r._touchTarget=new he(e,"sheet",r._touchMouseMessageFilter,100,10),r._touchEventProvider._attachDettach(r._touchTarget,!0)}function ce(e,t){var n=this;Ie.call(n,t,Fe._getPreferredZIndex(e._host)),n._imageAreaHeight=32,n._separatorHeight=45,n._menuItems={},n._isOpen=!1,n._workbook=e;var r=n._getContainer();n._toolStripDialog=r,r.addClass("gc-toolstrip-default ui-state-default well"),r.appendTo(n._getHost()),r.hide(),n._createLayoutTable(),n._setDefaultCellDomString(),n._attachEvent()}function fe(e,t,n,r,o){this._font="normal 12px Arial";var i=this;i._name=e,i._text=t,i._image=n,r&&(i._command=r),o&&(i._canExecute=o)}function de(e){function t(){for(var e="separator",t=0,n=e+t;Mt.getElementById(n);)t++,n=e+t;return n}this._name=t(),e&&(this._canExecute=e)}function pe(e){this._owner=e}function he(e,t,n,r,o){var i=this;i._element=e,i._messageFilter=n,i._eventFlag=t,i._maxPointer=r,i._level=o}function me(){}function ge(e){this._tab=e}function _e(e,t,n){var r=this;r._touchMouseMessageFilter=new pe(r),r._touchTarget=new he(e,"tabStrip",r._touchMouseMessageFilter,1,-1),r._touchEventProvider=n,r._touchEventHandler=new ge(t);var o=r._touchEventHandler,i=r._touchTarget;i._manipulationStarted=function(e){return o._doManipulationStarted(e)},i._manipulationDelta=function(e){return o._doManipulationDelta(e)},i._manipulationCompleted=function(e){return o._doManipulationCompleted(e)},i._tapped=function(e){return o._doTapped(e)},i._doubleTapped=function(e){return o._doDoubleTapped(e)}}function ve(e,t,n,r){var a=e._getImageLoader();a._getState(t)?n.drawImage(a._getImage(t),r.x,r.y,i(r),o(r)):a._addImage(t)}function ye(e,t){var n,r,a,s,l=e._getSheetLayout(),u=16,f=c(e);if(e._isTouchMode&&f.length>0){var d=f[f.length-1],m=d.row,g=d.row+d.rowCount-1,_=d.col,v=d.col+d.colCount-1,y=e.parent,b="AAAAAQCAYAAAAf8/9hAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAAJcEhZcwAADs";if(!y||y.options.allowUserResize){if(-1!==m&&-1===_&&e.getRowResizable(g)){var w=e._getRowViewportIndex(g);n=kt+b+"MAAA7DAcdvqGQAAABaSURBVDhPY/z//z8DLsDIyAiWBKphBAtgAUxQGgPANIMAMhsdYDUAmwZchtDOC8SCgTcA5DfcgUAEoNwFo7GAPQxwJVtsYYHVBdgU4gpInF5A1oBLMwMDAwMApuAtD6Z7YxQAAAAASUVORK5CYII=",r=e.getCellRect(g,p(e,2)-1,w,-1),s=l._rowHeaderRect(w),s.y<=r.y&&r.y+o(r)<=s.y+o(s)&&(a=new Ve(l._frozenX-u,r.y+o(r)-u/2,u,u))}else if(-1===m&&-1!==_&&e.getColumnResizable(v)){var C=e._getColumnViewportIndex(v);n=kt+b+"IAAA7CARUoSoAAAAAadEVYdFNvZnR3YXJlAFBhaW50Lk5FVCB2My41LjEwMPRyoQAAAE1JREFUOE/ljtEKACAIA/v/nzZ9mFhsJPRocLEuGS4zk/iJyyP/D6gE0wrYoCqoLoUafPl8fEBln3ulSscfErk65TMjMFRBhUowosDWBoHpba8+C7w0"+Rt,r=e.getCellRect(h(e,1)-1,v,-1,C),s=l._colHeaderRect(C),s.x<=r.x&&r.x+i(r)<=s.x+i(s)&&(a=new Ve(r.x+i(r)-u/2,l._frozenY-u,u,u))}n&&a&&ve(e,n,t,a)}}}function be(e){var t=Je,n=c(e),r=n.length;if(e._isTouchMode&&r>0){var a=n[r-1],s=e._getRangeWholeRect(a),l=17;t=new Ve(s.x+i(s)-l,s.y+o(s),l,20)}return t}function we(e,t,n){var r=e._getRowViewportIndex(t),o=e._getColumnViewportIndex(n),i=e._getViewportRowLayout(r),a=e._getViewportColumnLayout(o),s=0,l=0,u=0,c=0;return i.length>0&&(s=i[0].row,l=i[i.length-1].row),a.length>0&&(u=a[0].col,c=a[a.length-1].col),Ue(s,u,l-s+1,c-u+1)}function Ce(e,t,n){var r=e._getRowViewportIndex(t),a=e._getColumnViewportIndex(n),s=e._getSheetLayout(),l=s._viewportRect(r,a),u=!1,c=e._getViewportColumnLayout(a),f=-1===n?c[0]:c.findCol(n);f&&(u=l.x<=f.x&&f.x+i(f)<=l.x+i(l));var d=!1,p=e._getViewportRowLayout(r),h=-1===t?p[0]:p.findRow(t);return h&&(d=l.y<=h.y&&h.y+o(h)<=l.y+o(l)),u&&d}function Se(e){var t=c(e),n=[];if(e._isTouchMode&&t.length>0){var r,a,s=t[t.length-1],l=e._getRangeWholeRect(s),u=8,m=e._getSheetLayout(),g=s.row,_=s.row+s.rowCount-1,v=s.col,y=s.col+s.colCount-1,b=we(e,g,v),w=we(e,_,y),C=b.row,S=w.row+w.rowCount-1,x=b.col,T=w.col+w.colCount-1,E=_===S&&Ce(e,S,-1),M=y===T&&Ce(e,-1,T);if(-1!==s.row&&-1!==s.col)x<=v&&v<=T&&C<=g&&g<=S&&(n[0]=new Ve(l.x-u,l.y-u,2*u,2*u)),(x<=y&&y<T||M)&&(C<=_&&_<S||E)&&(n[1]=new Ve(l.x+i(l)-u,l.y+o(l)-u,2*u,2*u));else if(-1!==s.row){r=m._viewportRect(1,0),a=m._viewportRect(1,1);var A=r.x+(i(r)+i(a))/2-u,k=p(e)-1-f(e),R=e._getViewportColumnLayout(1),I=R.findCol(k);if(I){var O=e._getViewportColumnLayout(0),D=O[0]||R[0];D&&(A=D.x+(I.x+i(I)-D.x)/2-u)}C<=g&&g<=S&&(n[0]=new Ve(A,l.y-u,2*u,2*u)),(C<=_&&_<S||E)&&(n[1]=new Ve(A,l.y+o(l)-u,2*u,2*u))}else if(-1!==s.col){r=m._viewportRect(0,1),a=m._viewportRect(1,1);var P=r.y+(o(r)+o(a))/2-u,N=h(e)-1-d(e),F=e._getViewportRowLayout(1),L=F.findRow(N);if(L){var H=e._getViewportRowLayout(0),V=H[0]||F[0];V&&(P=V.y+(L.y+o(L)-V.y)/2-u)}x<=v&&v<=T&&(n[0]=new Ve(l.x-u,P,2*u,2*u)),(x<=y&&y<T||M)&&(n[1]=new Ve(l.x+i(l)-u,P,2*u,2*u))}for(var j,B=n.length-1;B>=0;B--)(!(j=n[B])||j.x<0||j.y<0)&&(n[B]=Je)}return n}function xe(e,t,n){var r=e.parent;if(je._isActiveElement(e)||r&&!r.options.hideSelection){if(e.isEditing()||!t)return;var a,s=Se(e),l=s.length;if(l>0){n.save(),n.fillStyle="white",n.strokeStyle=e.getSelectionBorderColor();for(var u=0;u<l;u++)(a=s[u])&&(n.beginPath(),n.arc(a.x+i(a)/2,a.y+o(a)/2,i(a)/2,0,2*Math.PI,!1),n.fill(),n.stroke());n.restore()}}}function Te(e,t){var n=be(e);if(n){ve(e,kt+"EAAAATCAIAAAD5x3GmAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwwAADsMBx2 + oZAAAAGhJREFUOE / djkEOwCAIBHk6P98u1lKo1diEU + dggOyAAkC + YPl / Onx3WDmiytm4aulQoKba + 4uiO77YhHDH5SqnRa0If / Nhq0fnjPob2h5oVXJI0rJA3h1ya1kgU4f4nQfVzozk7APgAIEqATZbalz1"+Rt,t,n)}}var Ee={},Me=n(0),Ae=n(1),ke=n(7),Re=Me._Types._isNullOrUndefined,Ie=Ae._BaseDialog,Oe=Ae.GC$,De=Oe.extend,Pe=Oe.isEmptyObject,Ne=Oe.inherit,Fe=Ae._util,Le=Fe._createElement,He=Ae._ThemeStyleHelper,Ve=Ae.Rect,je=Ae._FocusHelper,Be=Ae._DPIHelper,Ue=Ae._createRange,We=Ae.Events,ze=Ae._Layout,Ye=Ae._LayoutModel,Ge=Fe._cancelDefault,Ke=Fe._browser.mozilla,Xe=Fe._device(),qe=Xe.ipad||Xe.iphone,Je=null,Ze=void 0,Qe=Math.abs,$e=Math.min,et=Math.max,tt=Math.pow,nt=Math.atan2,rt=Math.PI,ot=Math.round,it=Math.sqrt,at=Math.atan,st=Math.log,lt=Math.floor,ut=100,ct="touch",ft="none",dt="MSPointerDown",pt="MSPointerMove",ht="MSPointerUp",mt="pointerdown",gt="pointermove",_t="pointerup",vt="touchstart",yt="touchmove",bt="touchend",wt="MSPOINTER_TYPE_TOUCH",Ct=isNaN,St=parseInt,xt=parseFloat,Tt=window,Et=Tt.navigator,Mt=document,At=Tt._gcGlobal,kt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB",Rt="AAAAAElFTkSuQmCC",It=Ae._CanvasHelper,Ot=400,Dt=20;De(g.prototype,{_ManipulationStarting:function(e){this._manipulationProcessor._ManipulationStarting=e},_ManipulationStarted:function(e){this._manipulationProcessor._ManipulationStarted=e},_ManipulationCompleted:function(e){var t=this;t._manipulationProcessor._ManipulationCompleted=function(n){if(e){e(n);var r=t._touchMouseMessageFilter;r&&r._postProcessManipulationComplete()}}},_ManipulationInertiaStarting:function(e){this._manipulationProcessor._ManipulationInertiaStarting=e},_ManipulationDelta:function(e){this._manipulationProcessor._ManipulationDelta=e},_Tapped:function(e){this._tapEventProcesser._Tapped=e},_DoubleTapped:function(e){this._tapEventProcesser._DoubleTapped=e},_RightTapped:function(e){this._tapEventProcesser._RightTapped=e},_TouchOperatorStart:function(e){this._touchOperatorStart=e},_TouchOperatorEnd:function(e){this._touchOperatorEnd=e},_getOffsetRelativeToDownElement:function(e,t){var n=t?t._element:this._downElement._element;return Fe._getRelativeOffset(e,n)},_msPointerDown:function(e,t){var n=this,r=t.pointerType,o=t.target,i=t.offsetX,a=t.offsetY;if(r===t[wt]||r===ct){var s=n._getOffsetRelativeToDownElement(o,e),l=s._left,u=s._top;if(n._down(e,o,t.pointerId,new x(i+l,a+u),t.timeStamp)&&Ge(t),"sheet"===n._downElement._eventFlag){var c=t.pageX-(i+l),f=t.pageY-(a+u);At.canvasOffset={top:f,left:c}}}},_msPointerMove:function(e){var t=this,n=e.pointerType,r=e.pointerId;if(n===e[wt]||n===ct){if(t._pressedPointers[r]===Ze)return!1;var o=t._getOffsetRelativeToDownElement(e.target);t._move(r,new x(e.offsetX+o._left,e.offsetY+o._top),e.timeStamp)&&Ge(e)}},_msPointerUp:function(e){var t=this,n=e.pointerType,r=e.pointerId;if(n===e[wt]||n===ct){if(t._pressedPointers[r]===Ze)return!1;var o=t._getOffsetRelativeToDownElement(e.target);t._up(r,new x(e.offsetX+o._left,e.offsetY+o._top))&&Ge(e)}},_msPointerCancel:function(e){var t=this,n=e.pointerType,r=e.pointerId;if(n===e[wt]||n===ct){if(t._pressedPointers[r]===Ze)return!1;var o=t._getOffsetRelativeToDownElement(e.target);t._cancel(r,new x(e.offsetX+o._left,e.offsetY+o._top))&&Ge(e)}},_touchStart:function(e,t){for(var n=m(e._element),r=t.changedTouches,o=!1,i=0;i<r.length;i++){var a=r[i],l=Ke?s():t.timeStamp;o=this._down(e,t.target,a.identifier,new x(a.pageX-n._left,a.pageY-n._top),l)||o}o&&Ge(t)},_touchMove:function(e){for(var t=this,n=m(t._downElement._element),r=e.changedTouches,o=!1,i=0;i<r.length;i++){var a=r[i],l=Ke?s():e.timeStamp;o=t._move(a.identifier,new x(a.pageX-n._left,a.pageY-n._top),l)||o}o&&Ge(e)},_touchEnd:function(e){for(var t=this,n=m(t._downElement._element),r=e.changedTouches,o=!1,i=0;i<r.length;i++){var a=r[i];o=t._up(a.identifier,new x(a.pageX-n._left,a.pageY-n._top))||o}o&&Ge(e)},_touchCancel:function(e){for(var t=this,n=m(t._downElement._element),r=e.changedTouches,o=!1,i=0;i<r.length;i++){var a=r[i];o=t._cancel(a.identifier,new x(a.pageX-n._left,a.pageY-n._top))||o}o&&Ge(e)},_fixPosition:function(e){var t=this,n=t._downElement,r=t._manipulationElement;if(n!==r){var o=Oe(n._element).offset(),i=Oe(r._element).offset();e.X+=o.left-i.left,e.Y+=o.top-i.top}},_setCaptureElement:function(e){var t,n,r=this,o=r._elements;for(r._manipulationElement=Je,r._touchMouseMessageFilter=Je,n=0;n<o.length;n++)if(o[n]===e){var i=o[n],a=Je,s=Je;if(i._canDoManipulation&&!i._canDoManipulation()){for(n=0;n<o.length;n++)if((t=o[n])!==i&&t._level>=0&&t._level<i._level&&(!t._canDoManipulation||t._canDoManipulation())){a=t;break}if(a===Je)return!1}if(i._canDoTap&&!i._canDoTap()){for(n=0;n<o.length;n++)if((t=o[n])!==i&&t._level>=0&&t._level<i._level&&(!t._canDoTap||t._canDoTap())){s=t;break}if(s===Je)return!1}a===Je&&(a=i),s===Je&&(s=i),r._downElement=i,r._manipulationElement=a,r._tapElement=s,r._ManipulationStarting(a._manipulationStarting||Je),r._ManipulationStarted(a._manipulationStarted||Je),r._ManipulationDelta(a._manipulationDelta||Je),r._ManipulationInertiaStarting(a._manipulationInertiaStarting||Je),r._ManipulationCompleted(a._manipulationCompleted||Je),r._Tapped(s._tapped||Je),r._DoubleTapped(s._doubleTapped||Je),r._RightTapped(s._rightTapped||Je),r._TouchOperatorStart(a._touchOperatorStart||Je),r._TouchOperatorEnd(a._touchOperatorEnd||Je),a._messageFilter&&(r._touchMouseMessageFilter=i._messageFilter);break}return!0},_down:function(e,t,n,r,o){var i=this;return!(i._pressedPointers[n]!==Ze||0===i._pressedPointers.length&&!i._setCaptureElement(e,t)||!i._manipulationElement||!(i._pressedPointers.length>=i._manipulationElement._maxPointer)&&(i._touchMouseMessageFilter&&i._touchMouseMessageFilter._preProcessPointerDown()||(i._fixPosition(r),i._touchMouseMessageFilter&&0===i._pressedPointers.length&&i._touchMouseMessageFilter._preProcessManipulationStarting(),i._pressedPointers[n]={id:n,time:s(),position:r},i._pressedPointers.length++,i._manipulationProcessor._PreviewPointerDown(t,n,r,o),i._manipulationProcessor._PointerDown(n,r,i._pressedPointers.length,o),1===i._pressedPointers.length&&i._tapEventProcesser._PointerDown(r),1===i._pressedPointers.length&&i._touchOperatorStart&&i._touchOperatorStart({_Position:r}),0)))},_move:function(e,t,n){var r=this;return!(r._pressedPointers[e]===Ze||r._touchMouseMessageFilter&&r._touchMouseMessageFilter._preProcessPointerMove()||(r._fixPosition(t),r._pressedPointers[e]={id:e,time:s(),position:t},r._manipulationProcessor._PointerMove(e,t,n),0))},_up:function(e,t){var n=this;return n._pressedPointers[e]!==Ze&&(delete n._pressedPointers[e],n._pressedPointers.length--,!(n._touchMouseMessageFilter&&n._touchMouseMessageFilter._preProcessPointerUp()||(n._fixPosition(t),n._manipulationProcessor._PreviewPointerUp(e),n._manipulationProcessor._PointerUp(e),0===n._pressedPointers.length&&(n._tapEventProcesser._PreviewPointerUp(t),n._tapEventProcesser._PointerUp(t)),0===n._pressedPointers.length&&n._touchOperatorEnd&&n._touchOperatorEnd({_Position:t}),n._touchMouseMessageFilter&&0===n._pressedPointers.length&&0===n._manipulationProcessor._process&&n._touchMouseMessageFilter._postProcessManipulationComplete(),0)))},_cancel:function(e,t){return this._up(e,t)},_attachDettach:function(e,t){function n(){Oe(Mt).bind(d,i).bind(p,a).bind(_,i).bind(v,a).bind(h,s).bind(m,s).bind(y,s).bind(b,s)}function r(){Oe(Mt).unbind(d).unbind(_).unbind(p).unbind(v).unbind(h).unbind(b).unbind(m).unbind(y)}function o(t){n(c+u),l._msPointerDown(e,t)}function i(e){l._msPointerMove(e)}function a(e){l._msPointerUp(e),0===l._pressedPointers.length&&r()}function s(e){l._msPointerCancel(e),0===l._pressedPointers.length&&r()}var l=this,u="."+e._eventFlag,c=".gcSheet",f=dt+c,d=pt+c+u,p=ht+c+u,h="MSPointerCancel"+c+u,m="MSLostPointerCapture"+c+u,g=mt+c,_=gt+c+u,v=_t+c+u,y="LostPointerCapture"+c+u,b="pointercancel"+c+u,w=vt+c,C=yt+c,S=bt+c,x="touchcancel"+c,T=e._element,E=l._elements,M=Me._ArrayHelper._indexOf(E,e);if(!(M>=0&&t||M<0&&!t)){var A=Et.msPointerEnabled||Et.pointerEnabled;if(t)if(A){var k=T.style;Re(k.msTouchAction)||(k.msTouchAction=ft),Re(k.touchAction)||(k.touchAction=ft),Oe(T).bind(f,o).bind(g,o)}else Oe(T).bind(w,function(t){l._touchStart(e,t)}),Oe(T).bind(C,function(e){l._touchMove(e)}).bind(S,function(e){l._touchEnd(e)}).bind(x,function(e){l._touchCancel(e)});else A?Oe(T).unbind(f).unbind(g):Oe(T).unbind(w).unbind(C).unbind(S).unbind(x);t?E.push(e):E.splice(M,1)}},_dispose:function(){for(var e=this,t=e._elements,n=t.length-1;n>=0;n--)e._attachDettach(t[n],!1)}}),De(C.prototype,{_PreviewPointerDown:function(e,t,n,r){var o=this;3===o._process&&o._Complete(!0),o._isScroll=2===o._process&&1===o._manipulatorPointers._Count(),o._originalSource=e;var i={};i._ID=t,i._PreviousPoint=n,i._InitialPoint=n,o._manipulatorPointers._Add(i),o._lastTime=r,o._manipulatorPointers._Count()>1&&(o._TranslateXLocked=!1,o._TranslateYLocked=!1,1===o._process&&o._StartManipulation())},_PointerDown:function(e,t,n){0===this._process&&1===n&&this._Starting(this._manipulatorPointers._ItemAt(0)._InitialPoint)},_PointerMove:function(e,t,n){var r=this;if(0!==r._workingModes&&r._manipulatorPointers._Contains(e)){if(1===r._process&&1===r._manipulatorPointers._Count()){var o=r._IsPinned();if(!r._SupportsMode(1)&&!r._SupportsMode(2)&&!o)return;var i=r._manipulatorPointers._Find(e)._InitialPoint;if(l(t,i))return;var a=Qe(t.X-i.X),s=Qe(t.Y-i.Y);r._SetTranslateRails(a,s)}if(!(n-r._lastTime<Dt)){r._manipulatorPointers._Find(e)._CurrentPoint=t;var u,c,f=r._manipulatorPointers._Count();if(f>1)for(u=0;u<f;u++)if(c=r._manipulatorPointers._ItemAt(u),!c._CurrentPoint)return;for(r._PointerMoveCore(n),r._lastTime=n,f=r._manipulatorPointers._Count(),u=0;u<f;u++)c=r._manipulatorPointers._ItemAt(u),c._PreviousPoint=c._CurrentPoint,c._CurrentPoint=Je}}},_PointerUp:function(){var e=this;e._needFireEvents&&(e._OnManipulationCompleted(e._needFireEvents),e._needFireEvents=Je)},_PreviewPointerUp:function(e){var t=this;t._manipulatorPointers._Contains(e)&&(t._manipulatorPointers._Remove(e),2===t._process?0===t._manipulatorPointers._Count()&&(t._SupportsMode(64)||t._SupportsMode(256)||t._SupportsMode(128)?t._StartInertia():t._Complete(!0)):2===t._process||3===t._process?t._Complete(!0):1===t._process&&t._Complete(!1))},_PointerMoveCore:function(e){var t,n,r,o,i,a,s=this,l=s._CalculateTranslate();t=l._translateX,n=l._translateY,a=l._position;var u=s._CalculateRotationAndScale();i=u._rotation,o=u._scale,r=u._expansion,s._totalTranslateX+=t,s._totalTranslateY+=n,s._totalScale*=o,s._totalRotation+=i,s._totalExpansion+=r;var c={};if(c._expansion=r,c._rotation=i,c._timeStamp=e-s._lastTime,c._translateX=t,c._translateY=n,s._deltaHistory._Enqueue(c),s._lastPosition=a,1===s._process||2===s._process){if(1===s._process&&s._StartManipulation())return;var f=new I;f._Expansion=r,f._Rotation=i,f._Scale=o,f._Translation=new x(t,n);var d=new M(s._deltaHistory),p=new N(s._originalSource,s._GetCumulative(),f,!1,a,d);if(s._OnManipulationDelta(p),p._IsComplete)return void s._Complete(!0)}},_StartManipulation:function(){var e=this;e._process=2;var t=new L(e._originalSource,e._manipulatorPointers._Count(),e._GetCumulative(),e._manipulatorPointers._ItemAt(0)._InitialPoint);return e._OnManipulationStarted(t),!!t._IsComplete&&(e._Complete(!0),!0)},_SetTranslateRails:function(e,t){var n=w(e,t);this._TranslateXLocked=n._translateXLocked,this._TranslateYLocked=n._translateYLocked},_CalculateTranslate:function(){var e=0,t=0,n=this._GetAveragePoint(),r=n._currentAveragePoint,o=n._previousAveragePoint,i=new x(r.X,r.Y);return e=r.X-o.X,t=r.Y-o.Y,{_translateX:e,_translateY:t,_position:i}},_CalculateRotationAndScale:function(){var e=this,t=0,n=1,r=0;if(e._SupportsMode(16)&&1===e._manipulatorPointers._Count()&&e._IsPinned()&&(t=y(e._manipulatorPointers._ItemAt(0)._CurrentPoint,e._manipulatorPointers._ItemAt(0)._PreviousPoint,e._pivot)),e._manipulatorPointers._Count()>1){var o=e._CalculateMultiManipulatorRotationAndScale();t=o._rotation,n=o._scale,r=o._expansion}return t=t/rt*180,{_rotation:t,_scale:n,_expansion:r}},_CalculateMultiManipulatorRotationAndScale:function(){for(var e=this,t=e._GetAveragePoint(),n=t._currentAveragePoint,r=t._previousAveragePoint,o=e._IsPinned(),i=o?e._pivot._Center:new x(0,0),a=0,s=1,l=0,u=0,c=0,f=0,d=0,p=e._manipulatorPointers._Count(),h=0;h<p;h++){var m=e._manipulatorPointers._ItemAt(h),g=m._CurrentPoint,y=m._PreviousPoint,b=v(g,n),w=v(y,r),C=o?new x(y.X-i.X,y.Y-i.Y):new x(y.X-r.X,y.Y-r.Y),S=o?new x(g.X-i.X,g.Y-i.Y):new x(g.X-n.X,g.Y-n.Y),T=v(y,i),E=v(g,i);w>=e._minimumScaleRotateRadius&&b>=e._minimumScaleRotateRadius&&(c++,f+=b,d+=w,(!o||T>=e._minimumScaleRotateRadius)&&E>=e._minimumScaleRotateRadius)&&(a+=_(C,S),u++)}return u>0&&e._SupportsMode(16)?a/=u:a=0,c>0&&e._SupportsMode(32)?(e._isScroll||(s=f/d),l=(f-d)/c,e._lastDistance=f/c):e._lastDistance=0,{_rotation:a,_scale:s,_expansion:l}},_SupportsMode:function(e){return 0!=(this._workingModes&e)},_GetAveragePoint:function(){for(var e=0,t=0,n=0,r=0,o=this._manipulatorPointers,i=o._Count(),a=0;a<i;a++){var s=o._ItemAt(a),l=s._PreviousPoint,u=s._CurrentPoint;e+=l.X,t+=l.Y,n+=u.X,r+=u.Y}var c=new x(e/i,t/i);return{_currentAveragePoint:new x(n/i,r/i),_previousAveragePoint:c}},_IsPinned:function(){var e=this._pivot;return e&&!Ct(e._Radius)},_Starting:function(e){var t=this,n=new H(t._originalSource,t._workingModes,Je,e);return n._Mode=511,t._OnManipulationStarting(n),t._ManipulationMode=n._Mode,0===n._Mode?(t._Complete(!1),!1):(t._workingModes=n._Mode,t._pivot=n._Pivot,t._process=1,!0)},_Complete:function(e){var t=this,n=3===t._process;if(t._process=0,t._inertiaTimer&&(a(t._inertiaTimer),t._inertiaTimer=Je),e){var r=new P(t._originalSource,t._GetCumulative(),n,T(t._lastPosition),new M(t._deltaHistory));3===t._process?t._needFireEvents=r:t._OnManipulationCompleted(r)}t._deltaHistory._Clear(),t._manipulatorPointers._Clear(),t._pivot=Je,t._totalTranslateX=0,t._totalTranslateY=0,t._totalScale=1,t._totalRotation=0,t._totalExpansion=0,t._TranslateXLocked=!1,t._TranslateYLocked=!1,t._workingModes=0},_StartInertia:function(){var e=this,t={},n=new M(e._deltaHistory);if(t._CurrentTranslateXVelocity=e._SupportsMode(64)?n._Linear().X:0,t._CurrentTranslateYVelocity=e._SupportsMode(64)?n._Linear().Y:0,t._CurrentExpansionVelocity=e._SupportsMode(256)?n._Expansion():0,t._CurrentRotationVelocity=e._SupportsMode(128)?n._Angular():0,0===t._CurrentTranslateXVelocity&&0===t._CurrentTranslateYVelocity&&0===t._CurrentExpansionVelocity&&0===t._CurrentRotationVelocity)return void e._Complete(!0);t._TranslateBehavior=new R(t._CurrentTranslateXVelocity,t._CurrentTranslateYVelocity),t._ExpansionBehavior=new A(t._CurrentExpansionVelocity),t._RotationBehavior=new k(t._CurrentRotationVelocity),n=new M(Je,t._CurrentTranslateXVelocity,t._CurrentTranslateYVelocity,t._CurrentRotationVelocity,t._CurrentExpansionVelocity);var r=new F(e._originalSource,e._GetCumulative(),new I,n,t._ExpansionBehavior,t._RotationBehavior,t._TranslateBehavior);e._OnManipulationInertiaStarting(r),t._TranslateBehavior=r._TranslationBehavior,t._ExpansionBehavior=r._ExpansionBehavior,t._RotationBehavior=r._RotationBehavior,t._TranslateBehavior._XDeceleration<=0&&t._TranslateBehavior._YDeceleration<=0&&t._TranslateBehavior._SetDecelerationInternal(.003),t._ExpansionBehavior._DecelerationInternal()<=0&&t._ExpansionBehavior._SetDecelerationInternal(.002),t._RotationBehavior._DecelerationInternal()<=0&&t._RotationBehavior._SetDecelerationInternal(.003);var o=s();t._StartTime=o,t._LastTime=o,t._DeltaXRemainder=0,t._DeltaYRemainder=0,e._process=3,e._inertiaTimer=setInterval(function(){try{e._InertiaTick(t)}catch(e){}},20)},_InertiaTick:function(e){var t=this,n=s(),r=n-e._LastTime;if(0!==r){var o=e._CurrentTranslateXVelocity,i=e._CurrentTranslateYVelocity,a=e._CurrentExpansionVelocity,l=e._CurrentRotationVelocity;e._CurrentTranslateXVelocity=t._GetInertiaCurrentVelocity(r,e._TranslateBehavior._XDeceleration,e._CurrentTranslateXVelocity),e._CurrentTranslateYVelocity=t._GetInertiaCurrentVelocity(r,e._TranslateBehavior._YDeceleration,e._CurrentTranslateYVelocity),e._CurrentExpansionVelocity=t._GetInertiaCurrentVelocity(r,e._ExpansionBehavior._DecelerationInternal(),e._CurrentExpansionVelocity),e._CurrentRotationVelocity=t._GetInertiaCurrentVelocity(r,e._RotationBehavior._DecelerationInternal(),e._CurrentRotationVelocity),o=(o+e._CurrentTranslateXVelocity)/2,i=(i+e._CurrentTranslateYVelocity)/2,a=(a+e._CurrentExpansionVelocity)/2,l=(l+e._CurrentRotationVelocity)/2,e._LastTime=n;var u=!1;b(o)&&b(i)&&b(a)&&b(l)&&(u=!0);var c=r*o,f=r*i,d=r*a,p=r*l,h=1;if(t._lastDistance>0&&(t._lastDistance+2*d<0&&(d=-t._lastDistance/2+1),0!==t._lastDistance&&(h=(t._lastDistance+2*d)/t._lastDistance)),t._totalExpansion+=d,t._totalRotation+=p,t._totalTranslateX+=c,t._totalTranslateY+=f,t._totalScale*=h,t._lastDistance+=d,t._lastPosition=new x(t._lastPosition.X+c,t._lastPosition.Y+f),e._DeltaXRemainder+=c,e._DeltaYRemainder+=f,u){if(c=ot(e._DeltaXRemainder),f=ot(e._DeltaYRemainder),b(c)&&b(f))return void t._Complete(!0)}else Qe(e._DeltaXRemainder)>=1&&(c=e._DeltaXRemainder,e._DeltaXRemainder-=c),Qe(e._DeltaYRemainder)>=1&&(f=e._DeltaYRemainder,e._DeltaYRemainder-=f);var m=new I;m._Translation=new x(c,f),m._Scale=h,m._Expansion=d,m._Rotation=p;var g=new M(Je,e._CurrentTranslateXVelocity,e._CurrentTranslateYVelocity,e._CurrentRotationVelocity,e._CurrentExpansionVelocity),_=new N(t._originalSource,t._GetCumulative(),m,!0,T(t._lastPosition),g);if(t._OnManipulationDelta(_),_._IsComplete)return void t._Complete(!0);u&&t._Complete(!0)}},_GetInertiaCurrentVelocity:function(e,t,n){if(b(n))return 0;var r;return r=n<0?n+t*e:n-t*e,(r<0&&n>0||r>0&&n<0)&&(r=0),r},_GetCumulative:function(){var e=this,t=new I;return t._Expansion=e._totalExpansion,t._Rotation=e._totalRotation,t._Scale=e._totalScale,t._Translation=new x(e._totalTranslateX,e._totalTranslateY),t},_GetManipulationData:function(e,t,n,r){var o=this,i=new I,a=new I,s=0,l=0,u=0,c=0,f=o._SupportsMode(4)&&o._TranslateXLocked,d=o._SupportsMode(8)&&o._TranslateYLocked;return!o._SupportsMode(1)||d||e&&!o._SupportsMode(64)||(i._Translation.X=t._Translation.X,a._Translation.X=n._Translation.X,s=r._Linear().X),!o._SupportsMode(2)||f||e&&!o._SupportsMode(64)||(i._Translation.Y=t._Translation.Y,a._Translation.Y=n._Translation.Y,l=r._Linear().Y),!o._SupportsMode(32)||e&&!o._SupportsMode(256)?(i._Scale=t._Scale,a._Scale=1):(i._Scale=t._Scale,i._Expansion=t._Expansion,a._Scale=n._Scale,a._Expansion=n._Expansion,c=r._Expansion()),!o._SupportsMode(16)||e&&!o._SupportsMode(128)||(i._Rotation=t._Rotation,a._Rotation=n._Rotation,u=r._Angular()),new D(i,a,new M(Je,s,l,u,c))},_OnManipulationStarting:function(e){this._ManipulationStarting&&e&&this._ManipulationStarting(e)},_OnManipulationStarted:function(e){this._ManipulationStarted&&e&&this._ManipulationStarted(e)},_OnManipulationCompleted:function(e){var t=this;if(t._ManipulationCompleted&&e){var n=t._GetManipulationData(!1,e._Cumulative,e._Cumulative,e._Velocities);e._Cumulative=n._Cumulative,e._Velocities=n._Velocities,t._ManipulationCompleted(e)}},_OnManipulationInertiaStarting:function(e){var t=this;if(t._ManipulationInertiaStarting&&e){var n=t._GetManipulationData(!1,e._Cumulative,e._Delta,e._Velocities);e._Cumulative=n._Cumulative,e._Delta=n._Delta,e._Velocities=n._Velocities,t._ManipulationInertiaStarting(e)}},_OnManipulationDelta:function(e){var t=this;if(t._ManipulationDelta&&e){var n=t._GetManipulationData(e._IsInertia,e._Cumulative,e._Delta,e._Velocities);e._Cumulative=n._Cumulative,e._Delta=n._Delta,e._Velocities=n._Velocities,t._ManipulationDelta(e)}}}),De(S.prototype,{_PointerDown:function(e){var t=this;if(!(++t._pointerCount>1)){var n=s();t._firstDownPosition&&l(e,t._firstDownPosition)&&n-t._lastDownTimestamp<Ot?t._count++:(t._firstDownPosition=e,t._count=1),t._lastDownPosition=e,t._lastDownTimestamp=n}},_PointerUp:function(){var e=this;e._needFireEvents&&(e._needFireEvents instanceof V?e._OnTapped(e._needFireEvents):e._needFireEvents instanceof j&&e._OnRightTapped(e._needFireEvents),e._needFireEvents=Je)},_PreviewPointerUp:function(e){var t=this;if(!(--t._pointerCount>0)){var n=s();l(e,t._lastDownPosition)?n-t._lastDownTimestamp>1e3?t._needFireEvents=new j(t._lastDownPosition):t._count>1?(t._count=0,t._OnDoubleTapped(new B(t._firstDownPosition)),t._firstDownPosition=Je):t._needFireEvents=new V(t._lastDownPosition):t._firstDownPosition=Je}},_PointerCancel:function(){this._firstDownPosition=Je},_OnTapped:function(e){this._Tapped&&e&&this._Tapped(e)},_OnDoubleTapped:function(e){this._DoubleTapped&&e&&this._DoubleTapped(e)},_OnRightTapped:function(e){this._RightTapped&&e&&this._RightTapped(e)}}),Ee._TouchPoint=x,De(E.prototype,{_GetVelocity:function(e){var t=this;if(0===t._count)return 0;for(var n=0,r=(1+t._count)*t._count/2,o=t._count-1;o>=0;o--){var i=0,a=t._Item(o);0===e?i=a._translateX:1===e?i=a._translateY:2===e?i=a._expansion:3===e&&(i=a._rotation);var s=t._GetSingleVelocity(i,a._timeStamp);s*=o+1,n+=s}return n/r},_GetSingleVelocity:function(e,t){return e/t},_Item:function(e){return this._history[this._GetInnerListIndex(e)]},_Last:function(){return this._history[this._count-1]},_Enqueue:function(e){var t=this;10===t._count&&t._Dequeue(),t._count++,t._history[t._GetInnerListIndex(t._count-1)]=e;for(var n=Dt*t._maxCount,r=0;r<t._count;r++)e._timeStamp-t._history[r]._timeStamp>n&&(t._Dequeue(),r--)},_Dequeue:function(){var e=this;e._start++,e._start===e._maxCount&&(e._start=0),e._count--},_Clear:function(){this._count=0},_GetInnerListIndex:function(e){return(this._start+e)%this._maxCount}}),De(M.prototype,{_Linear:function(){var e=this;return e._linear||(e._linear=new x(e._history._GetVelocity(0),e._history._GetVelocity(1))),e._linear},_Angular:function(){var e=this;return Re(e._angular)&&(e._angular=e._history._GetVelocity(3)),e._angular},_Expansion:function(){var e=this;return Re(e._expansion)&&(e._expansion=e._history._GetVelocity(2)),e._expansion}}),De(A.prototype,{_DecelerationInternal:function(){var e=this,t=e._DesiredExpansion,n=e._DesiredDeceleration,r=e._initialVelocity;return Ct(t)||0===t?Ct(n)?e._decelerationInternal:n:.5*r*r/t},_SetDecelerationInternal:function(e){this._decelerationInternal=e}}),De(k.prototype,{_DecelerationInternal:function(){var e=this,t=e._DesiredRotation,n=e._DesiredDeceleration,r=e._initialVelocity;return Ct(t)||0===t?Ct(n)?e._decelerationInternal:n:.5*r*r/t},_SetDecelerationInternal:function(e){this._decelerationInternal=e}}),De(R.prototype,{_UpdateXYDecelerations:function(){var e=this,t=e._DesiredDisplacement,n=e._velocity,r=e._initialXVelocity,o=e._initialYVelocity,i=e._DecelerationInternal();Ct(t)||0===t?Ct(i)||0===i?(e._XDeceleration=0,e._YDeceleration=0):(e._XDeceleration=i*Qe(r)/n,e._YDeceleration=i*Qe(o)/n):(e._XDeceleration=.5*n*Qe(r)/t,e._YDeceleration=.5*n*Qe(o)/t)},_DecelerationInternal:function(){var e=this,t=e._DesiredDeceleration;return Ct(t)&&Ct(e._DesiredDisplacement)?e._decelerationInternal:t},_SetDecelerationInternal:function(e){this._decelerationInternal=e,this._UpdateXYDecelerations()}}),De(O.prototype,{_Contains:function(e){for(var t=this._list,n=0;n<t.length;n++)if(t[n]._ID===e)return!0;return!1},_Add:function(e){this._list.push(e)},_Remove:function(e){for(var t=this._list,n=0;n<t.length;n++)if(t[n]._ID===e){t.splice(n,1);break}},_Count:function(){return this._list.length},_ItemAt:function(e){return this._list[e]},_Find:function(e){for(var t=this._list,n=0;n<t.length;n++){var r=t[n];if(r._ID===e)return r}return Je},_Clear:function(){var e=this._list;e.splice(0,e.length)}}),De(W.prototype,{_getTouchCanvas:function(e,t){var n=this._canvas;return n?e===Be._getLogicWidth(n)&&t===Be._getLogicHeight(n)||Be._setSize(n,e,t):(n=Le("canvas"),Be._adjustDevicePixel(n,Je,this._sheet),Be._setSize(n,e,t)),n},_saveCanvas:function(e,t,n,r){var a=this,s=Be._getLogicWidth(e),l=Be._getLogicHeight(e),u=a._getTouchCanvas(s,l),c=u.getContext("2d"),f=Be._getScaleX(u),d=Be._getScaleY(u);It._scaleTo(c,1,1),c.drawImage(e,0,0,i(u),o(u),0,0,i(u),o(u)),It._scaleTo(c,f,d),a._canvas=u,a._oldSheetLayout=t,a._oldGroupLayout=n,a._oldZoomFactor=r},_restoreCanvas:function(e,t,n){var r,a,s,l,u,c,p,h,m=this,g=m._sheet,_=Be._getLogicWidth(e),v=Be._getLogicHeight(e),y=f(g),b=d(g),w=y>0?1:0,C=b>0?1:0,S=m._oldGroupLayout,x=g._getOutlineLayout&&g._getOutlineLayout()||{x:0,y:0,width:0,height:0},T=m._oldSheetLayout,E=g._getSheetLayout(),M=t/m._oldZoomFactor,A=e.getContext("2d"),k=Be._getScaleX(e),R=Be._getScaleY(e),I=m._canvas;A.save(),A.fillStyle=n,A.fillRect(0,0,_,v);var O=g.rowOutlines,D=g.columnOutlines;O&&O._paint(g,A,Je,!0),D&&D._paint(g,A,Je,!1),r=S.x+i(S),a=S.y+o(S),s=T._frozenTrailingX-r-w,l=T._frozenTrailingY-a-C,u=x.x+i(x),c=x.y+o(x),p=s*M,h=l*M,r*=k,a*=R,s*=k,l*=R,u*=k,c*=R,p*=k,h*=R,It._scaleTo(A,1,1),A.drawImage(I,r,a,s,l,u,c,p,h),y>0&&(r=T._frozenTrailingX-w,a=S.y+o(S),s=T._frozenTrailingWidth+w,l=T._frozenTrailingY-a-C,u=E._frozenTrailingX-w,c=x.y+o(x),p=E._frozenTrailingWidth+w,h=l*M,r*=k,a*=R,s*=k,l*=R,u*=k,c*=R,p*=k,h*=R,A.drawImage(I,r,a,s,l,u,c,p,h)),b>0&&(r=S.x+i(S),a=T._frozenTrailingY-C,s=T._frozenTrailingX-r-w,l=T._frozenTrailingHeight+C,u=x.x+i(x),c=E._frozenTrailingY-C,p=s*M,h=E._frozenTrailingHeight+C,r*=k,a*=R,s*=k,l*=R,u*=k,c*=R,p*=k,h*=R,A.drawImage(I,r,a,s,l,u,c,p,h)),y>0&&b>0&&(r=T._frozenTrailingX-w,a=T._frozenTrailingY-C,s=T._frozenTrailingWidth+w,l=T._frozenTrailingHeight+C,u=E._frozenTrailingX-w,c=E._frozenTrailingY-C,p=E._frozenTrailingWidth+w,h=E._frozenTrailingHeight+C,r*=k,a*=R,s*=k,l*=R,u*=k,c*=R,p*=k,h*=R,A.drawImage(I,r,a,s,l,u,c,p,h)),It._scaleTo(A,k,R),A.restore()},_startZoom:function(){var e=this,t=e._sheet,n=t._zoomFactor,r=t._render._getBufferCtx();r&&e._saveCanvas(r.canvas,t._getSheetLayout(),t._getOutlineLayout&&t._getOutlineLayout()||{x:0,y:0,width:0,height:0},n)},_continueZoom:function(e){var t=this,n=t._sheet;if(n.endEdit()){var r=U(e,t._oldZoomFactor);if(n._zoomFactor!==r){n._trigger(We.UserZooming,{sheet:n,sheetName:n._name,oldZoomFactor:n._zoomFactor,newZoomFactor:r}),n._zoomFactor=r,n.invalidateLayout();var o=n._render,i=o._getCtx();i&&t._restoreCanvas(i.canvas,r,o._getGrayAreaBackColor(!1)),n._paintFloatingObject&&n._paintFloatingObject(Je,r),n._paintComment&&n._paintComment(Je)}}},_endZoom:function(e){var t=this,n=t._sheet;n._zoomFactor=U(e,t._oldZoomFactor),n._needSyncHScrollbarSize=!0,n._needSyncVScrollbarSize=!0,n._invalidate()}}),Ee._TouchZoomManager=W;var Pt=0,Nt=20;De(te.prototype,{_updateTouchViewportColumnLayout:function(e){function t(e,t){for(var n,r=new Ye,o=e._cachePool,i=e._getSheetLayout(),a=et(e.frozenColumnCount(),e._scrollLeftCol),s=p(e)-f(e),l=i._viewportX+t,u=i._viewportWidth-t;u>0&&a<s;a++)n=o._getZoomColWidth(a),r.push(new ze(-1,a,l,-1,n,-1)),l+=n,u-=n;return r}var n=this._sheet,r=n._colLayoutCache;r.viewport||(r.viewport={}),r.viewport[1]=t(n,e)},_updateTouchViewportRowLayout:function(e){function t(e,t){for(var n,r=new Ye,o=e._cachePool,i=e._getSheetLayout(),a=et(e.frozenRowCount(),e._scrollTopRow),s=h(e)-d(e),l=i._viewportY+t,u=i._viewportHeight-t;u>0&&a<s;a++)n=o._getZoomRowHeight(a),r.push(new ze(a,-1,-1,l,-1,n)),l+=n,u-=n;return r}var n=this._sheet,r=n._rowLayoutCache;r.viewport||(r.viewport={}),r.viewport[1]=t(n,e)},_invalidateLayout:function(){var e=this._sheet,t=e._colLayoutCache.viewport,n=e._rowLayoutCache.viewport;e.invalidateLayout(),e._colLayoutCache.viewport=t,e._rowLayoutCache.viewport=n},_vScrollTo:function(e,t,n,r){var a=this,s=a._sheet,l=s._scrollTopRow,u=z(s,e,l),c=u._row,f=u._offset;if(s._scrollTopRow=c,s._layoutSuspended>0)return!1;var p,h,m,g=s._getBounds(),_=s._getSheetLayout(),v=_._viewportY,y=_._viewportHeight,b=g?g.x:_.x,w=i(_);if(e<0){a._cachedOffsetY=0,a._cachedAvailableOffsetY=0;var C,S,x=s._getViewportRowLayout(1);if(x&&x.length>0&&(C=x.findRow(c)),C&&(S=x[x.length-1],S.row>=c)){if(p=2,c===s._getLastVisualScrollRow()){if(C.y<=v)return;var T=v-C.y;f=T-e+f,e=T}h=v+Qe(e),m=$e(v+y,S.y+o(S))-h,m>=0&&(m-=p,a._updateTouchViewportRowLayout(f-o(C)),n.x=b,n.y=h,n.width=w,n.height=m,n.tx=b,n.ty=v,r.x=b,r.y=v+m,r.width=w,r.height=y-m)}}else if(e>0){var E,M,A=s._getScrollableRow(-1);if(c===A&&f>0)if(a._cachedOffsetY>0&&a._cachedAvailableOffsetY>0){if(E=a._cachedOffsetY+e,M=G(E,Pt),e=M-a._cachedAvailableOffsetY,f=M,e<=0)return t;if(t&&M>=Nt)return!0;a._cachedOffsetY=E,a._cachedAvailableOffsetY=M}else{if(f>=Pt&&(e-=f-(Pt-1),f=Pt-1,e<=0))return t;if(E=K(f,Pt),M=f,t&&M>=Nt)return!0;a._cachedOffsetY=E,a._cachedAvailableOffsetY=M}else a._cachedOffsetY=0,a._cachedAvailableOffsetY=0;e<y&&(p=2,h=v,m=y-e,d(s)>0&&(m-=1),a._updateTouchViewportRowLayout(f),n.x=b,n.y=h,n.width=w,n.height=m,n.tx=b,n.ty=h+e,r.x=b,r.y=h,r.width=w,r.height=e+p)}return!1},_hScrollTo:function(e,t,n,r){var a=this,s=a._sheet,l=s._scrollLeftCol,u=Y(s,e,l),c=u._col,d=u._offset;if(s._scrollLeftCol=c,s._layoutSuspended>0)return!1;var p,h,m,g,_,v=s._getBounds(),y=s._getSheetLayout(),b=y._viewportX,w=y._viewportWidth,C=v?v.y:y.y,S=o(y);if(e<0){a._cachedOffsetX=0,a._cachedAvailableOffsetX=0;var x,T,E=s._getViewportColumnLayout(1);if(E&&E.length>0&&(x=E.findCol(c)),x&&(T=E[E.length-1],T.col>=c)){if(p=2,c===s._getLastVisualScrollColumn()){if(x.x<=b)return;var M=b-x.x;d=M-e+d,e=M}h=b+Qe(e),m=$e(b+w,T.x+i(T))-h,m>=0&&(m-=p,a._updateTouchViewportColumnLayout(d-i(x)),n.x=h,n.y=C,n.width=m,n.height=S,n.tx=b,n.ty=C,r.x=b+m,r.y=C,r.width=w-m,r.height=S)}}else if(e>0){var A=s._getScrollableColumn(-1);if(c===A&&d>0)if(a._cachedOffsetX>0&&a._cachedAvailableOffsetX>0){if(g=a._cachedOffsetX+e,_=G(g,Pt),e=_-a._cachedAvailableOffsetX,d=_,e<=0)return t;if(t&&_>=Nt)return!0;a._cachedOffsetX=g,a._cachedAvailableOffsetX=_}else{if(d>=Pt&&(e-=d-(Pt-1),d=Pt-1,e<=0))return t;if(g=K(d,Pt),_=d,t&&_>=Nt)return!0;a._cachedOffsetX=g,a._cachedAvailableOffsetX=_}else a._cachedOffsetX=0,a._cachedAvailableOffsetX=0;e<w&&(p=2,h=b,m=w-e,f(s)>0&&(m-=1),a._updateTouchViewportColumnLayout(d),n.x=h,n.y=C,n.width=m,n.height=S,n.tx=h+e,n.ty=C,r.x=h,r.y=C,r.width=e+p,r.height=S)}return!1},_continueScrollCore:function(e,t,n,r){var a,s,l,u,c=this,f=c._sheet,d=!0,p=!0,h=f._render,m=h._getCtx(),g=0!=(2&n),_=0!=(1&n);if(_||g){var v=f._getBounds(),y=f._getSheetLayout(),b=v?v.y:y.y,w=o(y),C=v?v.x:y.x,S=i(y);g&&(s={},a={},d=c._vScrollTo(t,r,a,s),h._copyScreen(a.x,a.y,i(a),o(a),a.tx,a.ty)),_&&(l={},u={},p=c._hScrollTo(e,r,l,u),h._copyScreen(l.x,l.y,i(l),o(l),l.tx,l.ty),g||(a=l,s=u));var x=f.parent;x&&!x.options.scrollbarShowMax&&(_&&(f._needSyncHScrollbarSize=!0),g&&(f._needSyncVScrollbarSize=!0)),c._invalidateLayout();var T=f.rowOutlines&&!f.rowOutlines._isEmpty()?1:0,E=f.columnOutlines&&!f.columnOutlines._isEmpty()?1:0;return _&&g?h._paintBody(m,new Ve(s.x,s.y,i(s),o(s)+T),new Ve(u.x,u.y,i(u)+E,o(u))):h._paintBody(m,new Ve(s.x,s.y,i(s)+E,o(s)+T)),h._paintAdornment(m,new Ve(C,b,S,w)),$(f,!0),Z(f,!0),c._onSheetScroll(_,g),d&&p}},_onSheetScroll:function(e,t){var n=this._sheet;t&&n._syncVScrollbarPosition(),e&&n._syncHScrollbarPosition(),n._eventHandler._updateEditingEditor();var r=n.comments;r&&r._updateCommentsLayoutWhenSheetScroll()},_endScrollWithAnimation:function(e,t,n){function r(e,t,n,r){return e/=n,tt(.75,e)*r*(t?1:-1)}function o(e,t,n){return e=Qe(e),e/=n,st(e)/st(.75)*t}var i=this,s=i._sheet,l=Pt||200,u=10,c=20,f=30,d=o(e,u,l),p=o(t,u,l),h=e,m=t,g=0,_=0,v=!1,y=!1;i._interval=setInterval(function(){if(v&&y){s._cachePool._endCache();var o=s.parent;return o&&!o.options.scrollbarShowMax&&(s._needSyncHScrollbarSize=!0,s._needSyncVScrollbarSize=!0),s._cachePool._clearCacheEndPan(),s._invalidate(),s._syncHScrollbarPosition(),s._syncVScrollbarPosition(),a(i._interval),void(i._interval=Je)}if(d+=c,p+=c,d>f&&p>f)i._continueScrollCore(e-g,t-_,ee(v,y),n),v=!0,y=!0;else{d>f&&!v&&(i._continueScrollCore(e-g,0,1,n),v=!0),p>f&&!y&&(i._continueScrollCore(0,t-_,2,n),y=!0);var b=r(d,e>0,u,l),w=r(p,t>0,u,l),C=lt(h-b),S=lt(m-w);i._continueScrollCore(C,S,ee(v,y),n),h=b,m=w,g+=C,_+=S}},c)},_startScroll:function(e){var t=this,n=t._sheet,r=n._cachePool;t._interval&&(r._clearCacheEndPan(),a(t._interval),t._interval=Je),t._cachedOffsetX=0,t._cachedAvailableOffsetX=0,t._cachedOffsetY=0,t._cachedAvailableOffsetY=0,t._oldScrollTopRow=n._scrollTopRow,t._oldScrollLeftCol=n._scrollLeftCol,e&&r._startCacheBeforPan()},_continueScroll:function(e,t){function n(e,t){var n=0;return n|=0!==e?1:0,n|=0!==t?2:0}var r=St(e.X),o=St(e.Y);Math.abs(r)/Math.abs(o)>1?o=0:r=0;var i=n(r,o);return this._continueScrollCore(r,o,i,t)},_endScroll:function(e){var t,n=this,r=n._sheet,a=r._getSheetLayout(),s=a._viewportX,l=a._viewportY,u=r._scrollTopRow,c=r._scrollLeftCol,f=r._getViewportColumnLayout(1),d=r._getLastVisualScrollColumn();f&&f.length>0&&(t=f.findCol(c),c<d&&t&&t.x+i(t)-s<i(t)/2&&c++);var p,h=r._getViewportRowLayout(1),m=r._getLastVisualScrollRow();h&&h.length>0&&(p=h.findRow(u),u<m&&p&&p.y+o(p)-l<o(p)/2&&u++);var g=0,_=0;f&&f.length>0&&(t=f.findCol(c),g=s-t.x),h&&h.length>0&&(p=h.findRow(u),_=l-p.y),u!==n._oldScrollTopRow&&r._setTopRow(u),c!==n._oldScrollLeftCol&&r._setLeftColumn(c),_<0&&(_=-1),g<0&&(g=-1),r._scrollTopRow=u,r._scrollLeftCol=c,n._endScrollWithAnimation(g,_,e)}}),De(le.prototype,{_doManipulationStarting:function(e){var t=this,n=t._sheet,r=n._getSheetLayout(),o=r._viewportX,i=r._viewportY,a=r._frozenTrailingX,s=r._frozenTrailingY,l=e._Position,u=0,c=t._touchHitTest(l.X,l.Y),f=c.dragInfo,d=c.x,p=c.y;c&&(c.resizeInfo||f&&"corner"===f.side||c.selectionHitInfo)?(u|=2,u|=1):(i<=p&&p<s&&(u|=2),o<=d&&d<a&&(u|=1),u|=96,n.parent&&(u|=12)),e._Mode=u},_doManipulationStarted:function(e){var t=this,n=e._Position,r=t._sheet,o=r.parent,i=r._eventHandler,a=r._render,s=t._touchHitTest(n.X,n.Y),l=s.dragInfo,u=s.selectionHitInfo;if(r._currentTarget=s,s.resizeInfo){if(!r.endEdit())return;i._startResizing(s)}else if(l&&"corner"===l.side)i._startDragFill&&i._startDragFill(s);else if(u){if(!r.endEdit())return;var c=u.isHeader,f=u.isFirstIndicator,d=u.type;c&&i._startSelectingCore(s,!0);var p=s.hitTestType;s.hitTestType=d,i._startSelectingScroll(s),s.hitTestType=p,ae(r,c,f,d),r._showTouchSelectionIndicator=!1,a._refreshTouchSelectionIndicator()}else r._commentRender&&(r._commentRender()._showWhenTouchMoveOrScroll=!1),r._showTouchSelectionIndicator=!1,a._refreshTouchSelectionIndicator(),e._PointerCount>1&&o&&o.options.allowUserZoom?(t._isScroll=!1,t._touchZoomManager._startZoom()):(t._isScroll=!0,t._touchScrollManager._startScroll(1===e._PointerCount))},_doManipulationDelta:function(e){var t=this,n=e._Position,r=t._sheet,o=r._eventHandler,i=r._currentTarget,a=n.X,s=n.Y;if(i){var l=i.dragInfo,u=i.selectionHitInfo;if(i.resizeInfo)o._mousePosition={e:e,x:a,y:s},o._continueResizing();else if(l&&"corner"===l.side)o._mousePosition={e:e,x:a,y:s},o._continueDragFill&&o._continueDragFill();else if(u||o._isSelecting){if(u){if(!o._startHitInfo||!o._isWorking)return;if(!0===o._forceCancelSelectiong)return;var c=u.type;o._mousePosition={e:e,x:a,y:s},3===c?o._continueCellSelecting():2===c?o._continueRowSelecting():1===c&&o._continueColumnSelecting()}}else if(t._isScroll)e._IsComplete=t._touchScrollManager._continueScroll(e._Delta._Translation,e._IsInertia);else{var f=e._Cumulative._Scale;t._touchZoomManager._continueZoom(f)}}},_doManipulationCompleted:function(e){var t=this,n=t._sheet,r=n._eventHandler;n._showTouchSelectionIndicator=!0;var o=n._currentTarget,i=o.selectionHitInfo;if(o.resizeInfo)r._stopResizing();else if(o.dragInfo&&r._isDraggingFill)r._endDragFill&&r._endDragFill(),n.parent.touchToolStrip._closeAutoFillIndicator();else if(i||r._isSelecting)r._stopSelecting(),i&&se(n,i.isHeader,i.isFirstIndicator,i.type),n._render._repaintSelection();else if(n._commentRender&&(n._commentRender()._showWhenTouchMoveOrScroll=!0),t._isScroll)t._touchScrollManager._endScroll(e._IsInertia);else{var a=e._Cumulative._Scale;t._touchZoomManager._endZoom(a)}},_doTapped:function(e){var t=this,n=e._Position,r=t._sheet,o=r.parent,i=!1;t._clearTouchToolStripTimeout(),r._unSelectAllFloatingObjects&&r._unSelectAllFloatingObjects();var a=r.comments;a&&a._clearActiveComment();var s=r._eventHandler,l=t._touchHitTest(n.X,n.Y,!0),u=l.filterButtonHitInfo,c=l.hitTestType,f=l.row,d=l.col,p=l.outlineHitInfo;if(p){if(!r.isEditing()){var h=p.what,m=r.rowOutlines,g=r.columnOutlines;"rg"===h||"rgh"===h?m&&m._doClick(r,p):"cg"!==h&&"cgh"!==h||g&&g._doClick(r,p)}}else if(r._currentTarget=l,u){if(!r.endEdit())return;var _=u.rowFilter;_&&_.openFilterDialog(u)}else if(l.resizeInfo);else if(r._canSelect(l.rowViewportIndex<0?-1:f,l.colViewportIndex<0?-1:d)){r._existTouchDragFillIndicator&&!s._isDraggingFill&&o.touchToolStrip._closeAutoFillIndicator();var v=r.getActiveRowIndex(),y=r.getActiveColumnIndex(),b=l.cellTypeHitInfo;if(b){var w=b.sheetArea;if(!Re(w)&&3!==w||f===v&&d===y)r._render._refreshTouchSelectionIndicator();else{if(r.suspendPaint(),!r.endEdit())return;var C={sheet:r,sheetName:r._name,row:v,col:y,cancel:!1};if(r._trigger(We.LeaveCell,C),C&&!0===C.cancel)return;var S=r._selectionModel.toArray(),x=r._getSpanModel().get(f,d),T=[Ue(x.row,x.col,x.rowCount,x.colCount)];r._raiseSelectionChanging(S,T);var E=b.isReservedLocation&&b.isFocusAware;r._setActiveCellAndSelection(f,d,Ze,Ze,E?0:1);var M={sheet:r,sheetName:r._name,row:f,col:d};r._trigger(We.EnterCell,M),r._trigger(We.FormulatextboxEnterCell,M),r._raiseSelectionChanged(S),s._updateValidationUI&&s._updateValidationUI(f,d),r.resumePaint(),i=!0}var A=r.getCellType(b.row,b.col,c);b.sheet||(b.sheet=r),A.processMouseDown(b),A.processMouseUp(b)}if(b&&b.isReservedLocation)return!0;r._trigger(We.CellClick,{sheet:r,sheetName:r._name,sheetArea:c,row:l.row,col:l.col});try{if(s._hitTestResult=l,r.isEditing()&&v===r.getActiveRowIndex()&&y===r.getActiveColumnIndex()&&!r.endEdit())return}finally{s._hitTestResult=Je}if(Re(f)||Re(d))return;if(3===c&&s._updateValidationUI&&s._updateValidationUI(f,d),ie(r,f,d,c)&&!i)t._touchToolStripTimeout=setTimeout(function(){var e={x:l.x,y:l.y,handled:!1},n=o.touchToolStrip;r._trigger(We.TouchToolStripOpening,e),e.handled||n.open(l.x,l.y-ut),t._clearTouchToolStripTimeout()},Ot+20);else{var k=r._selectionModel.toArray();s._startSelectingCore(l);var R=r._selectionModel.toArray();r._raiseSelectionChanging(k,R),s._stopSelecting()}}},_doDoubleTapped:function(e){var t=this,n=t._sheet,r=e._Position;t._clearTouchToolStripTimeout();var o,i,a=n._currentTarget;if(a){n._trigger(We.CellDoubleClick,{sheet:n,sheetName:n._name,sheetArea:a.hitTestType,row:a.row,col:a.col});var s=a.resizeInfo;if(s){if("sizeRow"===s.action||"sizeHiddenRow"===s.action){var l=[];if(n._isRowSelected(s.index)){for(o=0;o<n._selectionModel.length;o++)if(i=n._selectionModel[o],-1===i.col){i=n._getActualRange(i);for(var u=0;u<i.rowCount;u++)l.push({row:i.row+u})}}else l.push({row:s.index});n._commandManager().execute({cmd:"autoFitRow",sheetName:n.name(),rows:l,columnHeader:1===s.sheetArea})}else{var c=[];if(n._isColumnSelected(s.index)){for(o=0;o<n._selectionModel.length;o++)if(i=n._selectionModel[o],-1===i.row){i=n._getActualRange(i);for(var f=0;f<i.colCount;f++)c.push({col:i.col+f})}}else c.push({col:s.index});n._commandManager().execute({cmd:"autoFitColumn",sheetName:n.name(),columns:c,rowHeader:2===s.sheetArea})}return}}var d=t._touchHitTest(r.X,r.Y,!0);if(d&&d.row>=0&&d.col>=0&&d.rowViewportIndex>=0&&d.colViewportIndex>=0&&!d.resizeInfo&&(!n.options.isProtected||!n._getStyleProperty(d.row,d.col,"locked"))){n._clearSelectionImp();var p=n._getRowViewportIndex(d.row),h=n._getColumnViewportIndex(d.col);n._setActiveCellImp(d.row,d.col,p,h,!0),n.addSelection(d.row,d.col,1,1),n.parent.options.disableVirtualKeyboard||n._eventHandler._resumeFocus(!1),n._startEditImp(n._getCanvas(),d.row,d.col)}},_doTouchOperatorStart:function(e){var t=this,n=t._sheet,r=e._Position,o=t._touchHitTest(r.X,r.Y);if(n.isEditing())o.row===n._activeRowIndex&&o.col===n._activeColIndex||n._eventHandler._releaseFocus(o);else{t._target=o;var i,a=t._touchHitTest(r.X,r.Y,!0);a&&(i=a.cellTypeHitInfo)&&i.isEditting||n._eventHandler._releaseFocus(a)}},_doTouchOperatorEnd:function(){var e=this,t=e._sheet;if(!t.isEditing()){var n=e._target,r=!0;if(n){var o=n.cellTypeHitInfo;if(o&&o.isReservedLocation)r=!1;else{var i=t.getCellType(n.row,n.col);i&&i.isEditting()&&(r=!1)}}r&&t._eventHandler._resumeFocus()}},_touchHitTest:function(e,t,n){var r=this,o=r._sheet;o._getSheetLayout();var i,a={x:e,y:t,rowViewportIndex:Je,colViewportIndex:Je,row:-1,col:-1,resizeInfo:Je,hitTestType:Je,outlineHitInfo:Je,filterButtonHitInfo:Je,dragInfo:Je,cellTypeHitInfo:Je,selectionHitInfo:Je},s=o.rowOutlines,l=o.columnOutlines;if(s&&(i=s.hitTest(o,e,t)),!i&&l&&(i=l.hitTest(o,e,t)),i)a.outlineHitInfo=i;else{var u,c;if(u=o._getRowViewportIndexFromY(t),c=o._getColumnViewportIndexFromX(e),a.rowViewportIndex=u,a.colViewportIndex=c,a.row=o._getRowIndexFromY(t,u),a.col=o._getColumnIndexFromX(e,c),u>=0&&u<=2&&c>=0){var f=o._getCellLayoutByCell(u,c,Ze,a.row,a.col);f&&(a.row=f.row,a.col=f.col)}a.hitTestType=o._getSheetArea(u,c);var d,p,h,m,g;if(d=ne(o,a,e,t,10),h=o._rowFilter,!(m=h&&h.hitTest(a,e,t))){var _=o.tables,v=_&&_.find(a.row,a.col),y=v&&v._rowFilter;m=y&&y.hitTest(a,e,t)}o._existTouchDragFillIndicator&&(p=oe(o,a,e,t))?a.dragInfo=p:d?a.resizeInfo=d:m?a.filterButtonHitInfo=m:!n&&(g=re(o,a,e,t))?a.selectionHitInfo=g:a.cellTypeHitInfo=o._getCellTypeHitInfo(a,e,t)}return a},_clearTouchToolStripTimeout:function(){var e=this,t=e._touchToolStripTimeout;t&&(clearTimeout(t),e._touchToolStripTimeout=Je)}}),De(ue.prototype,{_attach:function(){var e=this,t=e._touchEventHandler,n=e._touchTarget;n._manipulationStarting=function(e){return t._doManipulationStarting(e)},n._manipulationStarted=function(e){return t._doManipulationStarted(e)},n._manipulationDelta=function(e){return t._doManipulationDelta(e)},n._manipulationCompleted=function(e){return t._doManipulationCompleted(e)},n._tapped=function(e){return t._doTapped(e)},n._doubleTapped=function(e){return t._doDoubleTapped(e)},n._touchOperatorStart=function(e){return t._doTouchOperatorStart(e)},n._touchOperatorEnd=function(e){return t._doTouchOperatorEnd(e)}},_detach:function(){var e=this,t=e._touchTarget;t&&(e._touchEventProvider._attachDettach(t,!1),t._manipulationStarting=Je,t._manipulationStarted=Je,t._manipulationDelta=Je,t._manipulationInertiaStarting=Je,t._manipulationCompleted=Je,t._tapped=Je,t._doubleTapped=Je,t._rightTapped=Je,t._touchOperatorStart=Je,t._touchOperatorEnd=Je,e._touchTarget=Je)},_preProcessMouseDown:function(e){return this._touchMouseMessageFilter._preProcessMouseDown(e)},_preProcessMouseUp:function(e){return this._touchMouseMessageFilter._preProcessMouseUp(e)},_preProcessMouseMove:function(e){return this._touchMouseMessageFilter._preProcessMouseMove(e)}});var Ft="gc-toolstrip-button",Lt="gc-toolstrip-text",Ht="gc-toolstrip-image",Vt="gc-toolstrip-item",jt="gc-touch-sperate-line",Bt="height",Ut="width",Wt="px",zt="button";Ne(ce,Ie),De(ce.prototype,{open:function(e,t){var n=this;if(u(n._workbook)&&(je._setActiveElement(Je,!0),n._toolStripDialog.css({left:e,top:t}),n._show(),n._isOpen=!0,n._resetDialogPosition(),!Pe(n._menuItems))){var r=n._menuItems;for(var o in r)if(r.hasOwnProperty(o)){var i=r[o],a=!i._canExecute||i._canExecute.call(n);a?Oe("#"+o).show():Oe("#"+o).hide()}}},add:function(e){if(e){var t=this,n=t._menuItems;if(e instanceof de){var r=e.name();r&&(n[r]=e,t._addDom(e._getDOM(jt,t._separatorHeight+Wt)))}else if(e instanceof fe){var o=e.name();t.getItem(o)||(n[o]=e,t._addDom(e._getDOM(Ht,t._imageAreaHeight+Wt,Lt,Ft)))}}},getItem:function(e){return this._menuItems[e]},getItems:function(){var e=this,t=[],n=e._menuItems;if(!Pe(n)){for(var r in n)n.hasOwnProperty(r)&&t.push(n[r]);return t}return Je},remove:function(e){var t=this;if(t.getItem(e)){Oe("#"+e).parent().remove();var n=t._menuItems[e];return delete t._menuItems[e],n}return Je},clear:function(){var e=this;e._toolStripDialog&&(e._toolStripDialog.find("td."+Vt).remove(),e._menuItems={})},close:function(){var e=this;At._resumeEvent(),e._toolStripDialog&&e._toolStripDialog.hide(),e._isOpen=!1,e._closeOverlay();var t=u(e._workbook);if(t){t._setFocus();var n=c(t);n.length>0&&!t._existTouchDragFillIndicator&&-1===n[0].row&&-1===n[0].col&&t._clearSelectionImp()}},imageAreaHeight:function(e){var t=this;return 0===arguments.length?t._imageAreaHeight:(e>0&&(t._imageAreaHeight=e,t._toolStripDialog.find("span."+Ht).css(Bt,e+Wt)),t)},itemHeight:function(e){var t=this,n=t._toolStripDialog.find("button."+Ft);return 0===arguments.length?xt(n.css(Bt)):(e>0&&n.css(Bt,e+Wt),t)},itemWidth:function(e){var t=this,n=t._toolStripDialog.find("button."+Ft);if(0===arguments.length)return xt(n.css(Ut));if(e>0){var r="min-width";xt(n.css(r))>e&&n.css(r,e+Wt),n.css(Ut,e+Wt)}return t},separatorHeight:function(e){var t=this;return 0===arguments.length?t._separatorHeight:(e>0&&(t._separatorHeight=e,t._toolStripDialog.find("div."+jt).css(Bt,e+Wt)),t)},_createLayoutTable:function(){var e="table",t=this,n=Oe(Le(e)).css({padding:0,display:e}).attr({cellspacing:0,cellpadding:0});t._tableRow=Oe(Le("tr")).appendTo(n),n.appendTo(t._toolStripDialog)},_dispose:function(){var e=this,t=e._toolStripDialog;t&&(e._isOpen&&At._resumeEvent(),t.remove(),e._closeOverlay(),t=Je)},_attachEvent:function(){var e=this;e._toolStripDialog.bind("click",function(t){var n,r=t.target,o=r.tagName.toLowerCase();if(o===zt)n=r.id;else{var i=r.parentElement;i&&i.tagName.toLowerCase()===zt&&(n=i.id)}var a=e._menuItems[n];n&&a&&a._command.call(e)})},_addDom:function(e){this._toolStripDialog&&e&&Oe(Le("td")).append(e).appendTo(this._tableRow).addClass(Vt)},_setDefaultCellDomString:function(){function e(e){for(var t=0,n=e+t;Mt.getElementById(n);)t++,n=e+t;return n}if(ke.SHOW_PASTE_COPY){var t="gAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAZdEVYdFNvZnR3YXJlAEFkb2JlIEltYWdlUmVhZHlxyWU8AAA",n={0:kt+t+"A8ElEQVRIS92VwQ3CMAxFe+qZERiHY8dgDI4cYYNOhDhwY4ayQviW4q/Eddu0KRe+9CQ72P8rEpAmhPBT3ENLd76EiPv5HO5hSmK+KYTFsz+04A4G9NZ0hAizn7jTos2MFRYYugFZQlscoFzRZsYKCwwNulAqnZddtJmxwiIZ3oT6WFh4S2tQHwsLb2kN6mNh4S2tQX0sLLwly4IyY4WFZ2gReV/ZhBOQH2ddgKcYwBAc7R/weL0ZgqO6gGPXE1E0JlBdwJx2CUhvkCL63xvw33QKUc0N+B5MIaq5gb5o8kotBszJDShFlkvQ+ZHBvoTmC+fiVfoq/m86"+Rt,1:kt+t+"BkklEQVRIS7WTUXECQRBEcYCFOIiESAAH/OYPCcQBEogDJCABCUhAwqXf1QzVM0cojko+Xt3ObG/33t7eYhiGf6UU68+vneD5Mu4HpZDgKja+YCYH94NSSHAUg3glZC9k8zgAYwLmhuS6o/tBKUJ8CTGsoveIsin3g1LEAkxzAd/kXbihwxwatGys+EEpEAT5LR6FuDmMb+t+UAoEwVL44h7CvB8lGxrn3A9KkaLAj8pDMD9HL/v0ZgfAQfSAk/WgXAT3g1K4MPCj2AoPhNvRJO4HpejigF1jxtjNy9Ek7gel6GIjfzoP+Ihewf2gFPcWNNL817/c/aAUKXpbfy/FXlzFIM6gOYy3Gp+iz/xBPHeLQGLAMI2PNmYOw1uojZfdCyYNCXexiGcGpiljdp9hsBGjvnvBpCHhRbgBZChjAgj0eXrX7gWThoR992lAMGOOLMfJuIHuBZMGQuE75KN66Cpq14xH2L1g0kixyLNm3I8sNbwJulHfvWDSkJArmou4hlxXeh4AvBEBuZnnbtHfMix+AHqkr6wgQ4Q7"+Rt,2:kt+t+"A3UlEQVRIS72PwQ3CMAxFOwrjcOyZCTgyAjfWYCJO3JiCCVL/iFSO9W0MDTzpqYob+ztTKeWn0uJIadE6H8/ljXsR96q6tzt4YogH/olPcQ2R8mp3CHRBwO3+6EKkvNodcDkSgyyoAx0iRz/AA/8Op0sdtJuv1Va3Ct8FYHgL8dgUAGxIe41+kRAH6CbdaGW86nFAhnaXLSLEAbqJCbxlUgEZ2DIgFaCbmMBbJhWQgS0DUgG6iQm8ZVIBGTYFsK21oN3F1yrEARnsIM/u8JeAT9S9nrQ4UlocKS2Os0wLtkPMdu9POt0AAAAASUVORK5CYII=",3:kt+"UAAAAXCAIAAABrvZPKAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwwAADsMBx2+oZAAAAIdJREFUOE/tzEEKgCAQheEOWLdx351adYc8Qgs3rbuAUC9nkkF0BKNN9CMy0Xx25llf8Edr7d57j/tlP4wTHf4W/b7gsT0vLs7Sz9bFWfM9nrDXE9ITphlVPO512wkkM++FNF86vBfKeKR43rjLe5QwOvxPVPSoipHmkY5RxSMFo7rXY9+eMSdet07b6c/bnwAAAABJRU5ErkJggg=="},o=this,i=n[0],a=n[1],s=n[2],l=n[3];o._pasteItem=new fe(e("wijspread_toolstrip_paste"),r().ToolStrip_PasteText,i,o._doTapPaste),o._cutItem=new fe(e("wijspread_toolstrip_cut"),r().ToolStrip_CutText,a,o._doTapCut),o._copyItem=new fe(e("wijspread_toolstrip_copy"),r().ToolStrip_CopyText,s,o._doTapCopy),o._autoFillItem=new fe(e("wijspread_toolstrip_autofill"),r().ToolStrip_AutoFillText,l,o._showAutoFillIndicator,o._hideAutoFill),o.add(o._pasteItem),o.add(o._cutItem),o.add(o._copyItem),o.add(new de(o._hideAutoFill)),o.add(o._autoFillItem)}},_hideAutoFill:function(){var e=u(this._workbook);if(!e)return!1;for(var t=c(e),n=0;n<t.length;n++){var r=t[n];if(-1===r.row&&-1===r.col)return!1}return!0},_showAutoFillIndicator:function(){this.close();var e=u(this._workbook);if(e){c(e).length<=1&&(e._existTouchDragFillIndicator=!0,e._render._repaintSelection())}},_closeAutoFillIndicator:function(){var e=u(this._workbook);e&&(e._existTouchDragFillIndicator=!1,e._render._repaintSelection())},_doTapCopy:function(){var e=u(this._workbook);e&&(this._clipboardTouchData=e._doCopy(!0)),this.close()},_doTapCut:function(){var e=u(this._workbook);e&&(this._clipboardTouchData=e._doCut(!0)),this.close()},_doTapPaste:function(){var e=this,t=e._clipboardTouchData,n=u(e._workbook);n&&(Re(t)||n._doPaste({pasteHtml:t.copyHtml,pasteText:t.copyText})),e.close()},_updateResource:function(){var e=this,t="span."+Lt;Oe("#"+e._pasteItem._name).find(t).text(r().ToolStrip_PasteText),Oe("#"+e._cutItem._name).find(t).text(r().ToolStrip_CutText),Oe("#"+e._copyItem._name).find(t).text(r().ToolStrip_CopyText),Oe("#"+e._autoFillItem._name).find(t).text(r().ToolStrip_AutoFillText)}}),Ee.TouchToolStrip=ce,De(fe.prototype,{name:function(e){var t=this;return 0===arguments.length?t._name:(Oe("#"+t._name).attr("id",e),Oe("#"+t._name+"Text").attr("id",e+"Text"),Oe("#"+t._name+"Image").attr("id",e+"Image"),t._name=e,t)},text:function(e){var t=this;return 0===arguments.length?t._text:(t._text=e,Oe("#"+t.name()+"Text").text(e),t)},font:function(e){var t=this,n=Oe("#"+t.name()+"Text");return 0===arguments.length?t._font:(t._font=e,n.css("font",e),t)},foreColor:function(e){var t=this,n=Oe("#"+t.name()+"Text");return 0===arguments.length?t._foreColor?t._foreColor:n.css("color"):(n.css("color",e),t)},image:function(e){var t=this;return 0===arguments.length?t._image:(t._image=e,Oe("#"+t.name()+"Image").css("background-image","url("+e+")"),t)},_getDOM:function(e,t,n,r){function o(e,t,n){var r=Le("span"),o=Mt.body;r.className=n,r.style.font=e,r.style.cssFloat="left",r.textContent=t,o.insertBefore(r,Je);var i=Oe(r).width();return o.removeChild(r),i}var i=this,a=i.name(),s=i.font(),l=i.text(),u=Oe(Le("span"));u.attr("id",a+"Image"),u.addClass(e),u.css({"background-image":"url("+i.image()+")","background-repeat":"no-repeat",display:"block",height:t,"background-position-x":"50%"});var c=Oe(Le("span"));c.attr("id",a+"Text"),c.addClass(n),c.css("font",s),c.text(l);var f=o(s,l,n),d=60;f>d&&(d=f);var p=Oe(Le(zt));return p.attr("type",zt),p.attr("id",a),p.addClass(r+" gc-toolstrip-button-style ui-state-default ui-widget btn btn-default"),p.css({"box-sizing":"content-box",border:"0px",padding:"4px",margin:"3px",width:d+Wt}),p.append(u),p.append(c),p[0]}}),Ee.TouchToolStripItem=fe,De(de.prototype,{name:function(){return this._name},_getDOM:function(e,t){var n=Oe(Le("div"));return n.attr("id",this.name()),n.addClass(e),n.css({width:"1px",height:t,display:"inline-block;","background-color":"#CCC","margin-left":"5px","margin-right":"5px",opacity:.6}),n[0]}}),Ee.TouchToolStripSeparator=de,De(pe.prototype,{_preProcessManipulationStarting:function(){this._eventMode=2,this._owner._isTouchMode=!0},_postProcessManipulationComplete:function(){this._eventMode=0,this._touchCompleteTimestamp=s()},_preProcessPointerDown:function(){return 1===this._eventMode},_preProcessPointerUp:function(){return 1===this._eventMode},_preProcessPointerMove:function(){return 1===this._eventMode},_preProcessMouseDown:function(){var e=this;if(2===e._eventMode)return!0;if(e._touchCompleteTimestamp){if(s()-e._touchCompleteTimestamp<=200)return e._mouseDownHandled++,!0;e._touchCompleteTimestamp=0,e._mouseDownHandled=0,e._eventMode=1}else e._eventMode=1;return e._owner._isTouchMode=!1,!1},_preProcessMouseUp:function(){var e=this;return e._mouseDownHandled?(e._mouseDownHandled--,!0):2===e._eventMode||(e._eventMode=0,!1)},_preProcessMouseMove:function(){return 2===this._eventMode}}),Ee._TouchMouseMessageFilter=pe,Ee._TouchTargetElement=he,De(me.prototype,{_simulateMouseEvent:function(e,t){var n=e,r=n.touches,o=n.targetTouches,i=n.changedTouches;if(!1!==n.isPrimary&&(!(r&&r.length>=1&&o&&o.length>=1)||r[0].clientX===o[0].clientX&&r[0].clientY===o[0].clientY)){Ge(e);var a=Re(i)?n:i[0],s=Mt.createEvent("MouseEvents");s.initMouseEvent(t,!0,!0,Tt,1,a.screenX,a.screenY,a.clientX,a.clientY,!1,!1,!1,!1,0,Je),e.target.dispatchEvent(s)}},_down:function(e){var t=e.pointerType;if(!t||t===e[wt]||t===ct){var n=e.data;if(n._touchHandled)return;n._touchHandled=!0,n._touchMoved=!1,n._simulateMouseEvent(e,"mouseover"),n._simulateMouseEvent(e,"mousemove"),n._simulateMouseEvent(e,"mousedown")}},_move:function(e){var t=e.pointerType;if(!t||t===e[wt]||t===ct){var n=e.data;if(!n._touchHandled)return;n._touchMoved=!0,n._simulateMouseEvent(e,"mousemove")}},_up:function(e){var t=e.pointerType;if(!t||t===e[wt]||t===ct){var n=e.data;if(!n._touchHandled)return;n._simulateMouseEvent(e,"mouseup"),n._simulateMouseEvent(e,"mouseout"),n._touchMoved||n._simulateMouseEvent(e,"click"),n._touchHandled=!1}},_bindUnBindTouchEvents:function(e,t,n){var r=this;"."!==n.charAt(0)&&(n="."+n);var o=dt+n,i=pt+n,a=ht+n,s=mt+n,l=gt+n,u=_t+n,c=vt+n,f=yt+n,d=bt+n,p=Et.msPointerEnabled||Et.pointerEnabled;if(t)if(p){var h=e.style;Re(h.msTouchAction)||(h.msTouchAction=ft),Re(h.touchAction)||(h.touchAction=ft),Oe(e).bind(o,r,r._down).bind(s,r,r._down),Oe(Mt).bind(i,r,r._move).bind(l,r,r._move).bind(a,r,r._up).bind(u,r,r._up)}else Oe(e).bind(c,r,r._down).bind(f,r,r._move).bind(d,r,r._up);else p?(Oe(e).unbind(o).unbind(s),Oe(Mt).unbind(i).unbind(l).unbind(a).unbind(u)):Oe(e).unbind(c).unbind(f).unbind(d)}}),Ee._SimulateMouseEvents=me;var Yt="tab",Gt="newTab";De(ge.prototype,{_doManipulationStarted:function(e){var t=this,n=e._Position,r=t._tab,a=u(r._workbook);r._tabNameEditor&&r._endSheetTabEditing(a,!1);var s=r.hitTest(n.X,n.Y),l=s.element;if("resizeBar"===l)r._resizeTab=!0,r._activeX=n.X;else if(l===Yt||l===Gt||""===l){var c=r._canvas,f=Be._getLogicWidth(c),d=Be._getLogicHeight(c),p=t._getTouchCanvas(f,d),h=p.getContext("2d"),m=Be._getScaleX(p),g=Be._getScaleY(p);It._scaleTo(h,1,1),h.drawImage(c,0,0,i(p),o(p),0,0,i(p),o(p)),It._scaleTo(h,m,g),t._canvas=p,t._oldFirstTab=r._firstTab,t._tabStartPosition=r._getTabStartPosition(),t._tabEndPosition=r._getTabEndPosition(),t._newTabSize=r._getNewTabSize(),r._hideNewTabSecondMoreTab=!0}t._minFirstTabIndex=r._getNextVisibleIndex(-1),t._maxFirstTabIndex=r._reCalculateFirstTabIndex(r._getVisibleTabs())},_doManipulationDelta:function(e){var t=this,n=e._Position.X,r=t._tab;if(r._resizeTab){var a=n-r._activeX,s=r._workbook,l=s.options,u=s._vp.clientWidth;l.tabStripRatio=s._getActualTabStripRatio()+a/u;var c=r._resizeBarWidth/u,f=1;s._getActualTabStripRatio()<c?(l.tabStripRatio=c,r._activeX=r._resizeBarWidth):s._getActualTabStripRatio()>=f?(l.tabStripRatio=f,r._activeX=u):r._activeX=n}else{var d=t._canvas,p=t._oldFirstTab;if(!d||Re(p))return;var h=t._minFirstTabIndex,m=t._maxFirstTabIndex,g=t._newTabSize,_=t._tabStartPosition,v=t._tabEndPosition,y=e._Cumulative._Translation.X,b=t._getNewFirstTabInfo(y,p);r._firstTab=b._firstTab;var w=b._width;if(y>0&&p===h&&r._firstTab===h?w=0:y<0&&p===m&&r._firstTab===m&&(w=0),y>0&&y>w+g?y=w+g:y<0&&y<w-g&&(y=w-g),0!==y){var C=r._canvas,S=C.getContext("2d"),x=Be._getScaleX(C),T=Be._getScaleY(C);S.save(),S.clearRect(0,0,Be._getLogicWidth(C),Be._getLogicHeight(C));var E=r._getBounds();r._paintBackground(S,E);var M,A,k,R,I=0,O=o(E);y>0?(M=_,k=M+y,A=v-k,A>0&&(It._scaleTo(S,1,1),S.drawImage(d,M*x,I,A*x,O*T,k*x,I,A*x,O*T),It._scaleTo(S,x,T)),R=y-w,v-_<=y&&(R=0),A=w,M=_,A>0&&(It._translate(S,R,0),r._paintTabs(S,new Ve(M,I,A,O)),It._translate(S,-R,0))):y<0&&(k=_,M=k+Qe(y),A=v-M,A>0&&(It._scaleTo(S,1,1),S.drawImage(d,M*x,I,A*x,O*T,k*x,I,A*x,O*T),It._scaleTo(S,x,T)),R=y-w,v-_<=Qe(y)&&(R=0),A=Qe(w),M=v-A,A>0&&(It._translate(S,R,0),r._paintTabs(S,new Ve(M,I,A,O)),It._translate(S,-R,0))),It._scaleTo(S,1,1),M=0,A=_,S.drawImage(d,M*x,I,A*x,O*T,M*x,I,A*x,O*T);var D=He._getCssClassThemeStyle("");St(D.zIndex)>2007&&(M=v,A=E.x+i(E)-r._resizeBarWidth-M,S.drawImage(d,M*x,I,A*x,O*T,M*x,I,A*x,O*T)),M=i(E)-r._resizeBarWidth,A=r._resizeBarWidth,S.drawImage(d,M*x,I,A*x,O*T,M*x,I,A*x,O*T),It._scaleTo(S,x,T),S.restore()}}},_doManipulationCompleted:function(){var e=this._tab;e._resizeTab?(e._resizeTab=!1,e._workbook._doTabHSResize()):(e._hideNewTabSecondMoreTab=Ze,e.repaint())},_doTapped:function(e){var t=this._tab,n=t._workbook,r=e._Position,o=u(n);t._tabNameEditor&&t._endSheetTabEditing(o,!1);var i="navButton",a=t.hitTest(r.X,r.Y),s=a.element;n._suspendSetFocus=!0;try{s===i?t._doNavButtonClick(a.index,!0):s===Yt?t._doSheetTabClick(a.index,a.position):s===Gt&&t._doNewTabClick(a.position)}finally{n._suspendSetFocus=!1;var l=u(n);l!==o&&(l._isTouchMode=!0,l._setFocus())}},_doDoubleTapped:function(e){return this._tab._doMouseDbClickImp(e._Position.X,e._Position.Y)},_getTouchCanvas:function(e,t){var n=this._canvas;return n?e===Be._getLogicWidth(n)&&t===Be._getLogicHeight(n)||Be._setSize(n,e,t):(n=Le("canvas"),Be._adjustDevicePixel(n,this._tab._workbook),Be._setSize(n,e,t)),n},_getNewFirstTabInfo:function(e,t){var n=this,r=n._tab,o=r._tabSizes,i=n._minFirstTabIndex,a=n._maxFirstTabIndex,s=t,l=0;if(e>0){for(;s>=i&&!(l>e);)l+=o[s],s--;s<i&&(s=i)}else if(e<0&&-1!==a){for(;s<=a&&!(l<e);)l-=o[s],s++;s>a&&(s=a)}return{_firstTab:s,_width:l}}}),De(_e.prototype,{_attach:function(){var e=this,t=e._touchEventProvider;t&&t._attachDettach(e._touchTarget,!0)},_detach:function(){var e=this,t=e._touchEventProvider;t&&t._attachDettach(e._touchTarget,!1)},_preProcessMouseDown:function(e){return this._touchMouseMessageFilter._preProcessMouseDown(e)},_preProcessMouseUp:function(e){return this._touchMouseMessageFilter._preProcessMouseUp(e)},_preProcessMouseMove:function(e){return this._touchMouseMessageFilter._preProcessMouseMove(e)}}),Ae._SheetRender.prototype._refreshTouchSelectionIndicator=function(){var e=this,t=e._sheet,n=c(t),r=n.length;t._layoutSuspended<=0&&r>0&&e._repaintSelection(n[r-1],Ze,Ze,!0)},Ae.Worksheet._registerFeature(ct,{init:function(){this._existTouchDragFillIndicator=!1,this._showTouchSelectionIndicator=!0},setHost:function(e){var t=this,n=t.parent,r=n&&n._touchEventProvider||new g,o=new ue(e[0],t,r);o._attach(),t._touchManager=o},dispose:function(e){var t=this;t._touchManager&&t._touchManager._detach(),!1!==e&&(t._touchManager=Je)},startEdit:function(){this._render._refreshTouchSelectionIndicator()},paintAdornment:function(e){var t=this,n=e.ctx;t._isTouchMode&&(ye(t,n),t._existTouchDragFillIndicator?Te(t,n):xe(t,t._showTouchSelectionIndicator,n))},preProcessMouseDown:function(e){var t=e.e,n=this._touchManager;(qe||n._preProcessMouseDown(t))&&(Ge(t),e.r=!0)},preProcessMouseMove:function(e){var t=e.e,n=this._touchManager;(qe||n._preProcessMouseMove(t))&&(Ge(t),e.r=!0)},preProcessMouseUp:function(e){var t=e.e,n=this._touchManager;(qe||n._preProcessMouseUp(t))&&(Ge(t),e.r=!0)},preProcessMouseDbClick:function(e){(qe||this._isTouchMode)&&(e.r=!0)},preProcessMouseOut:function(e){qe&&(e.r=!0)},preProcessMouseWheel:function(e){qe&&(e.r=!0)}}),Ae.Workbook._registerFeature(ct,{init:function(){this._touchEventProvider=new g},setHost:function(){var e=this;e.touchToolStrip=new ce(e,e._getContainerDiv())},dispose:function(){var e=this,t=e._touchEventProvider,n=e.touchToolStrip;t&&t._dispose(),n&&(n._dispose(),e.touchToolStrip=Je)},onCultureChanged:function(){var e=this.touchToolStrip;e&&e._updateResource()}}),Ae._SheetTabBase._registerFeature(ct,{setHost:function(){var e=this,t=new _e(e._canvas,e,e._workbook._touchEventProvider);t._attach(),e._touchManager=t},dispose:function(){var e=this,t=e._touchManager;t&&(t._detach(),e._touchManager=Je)},preProcessMouseDown:function(e){var t=this._touchManager,n=e.e;(qe||t._preProcessMouseDown(n))&&(Ge(n),e.r=!1)},preProcessMouseMove:function(e){var t=this._touchManager,n=e.e;(qe||t._preProcessMouseMove(n))&&(Ge(n),e.r=!1)},preProcessMouseUp:function(e){var t=this._touchManager,n=e.e;(qe||t._preProcessMouseUp(n))&&(Ge(n),e.r=!1)},preProcessMouseDbClick:function(e){var t=u(this._workbook);(qe||t._isTouchMode)&&(e.r=!1)},preProcessMouseOut:function(e){qe&&(e.r=!1)}});var Kt=".gcScrollbar";Ae._Scrollbar._registerFeature(ct,{initEvents:function(e){(this._simulateMouseEvents=new me)._bindUnBindTouchEvents(e,!0,Kt)},dispose:function(e){var t=this._simulateMouseEvents;t&&t._bindUnBindTouchEvents(e,!1,Kt)}}),e.exports=Ee},function(e,t,n){var r=n(1),o=n(34),i=r._util._createElement,a=r._util._defProperty,s=o.FloatingObject,l=o._fromJsonFn,u=o._toJsonFn,c=o._propertyRefreshCallback,f=r.GC$,d=null,p=void 0,h=function(e){function t(e){return"number"==typeof e&&!isNaN(e)}function n(t,n,r,o,i,a){var s=this;e.call(s,t,r,o,i,a),s.typeName="1",s._imageLoader=d,s._isImageLoaded=!1,s._isTakeOriginalSize=!1,"string"==typeof n&&(s._isTakeOriginalSize=!i||!a,s.src(n))}function o(e){var t=e,n=t.src(),i=t.sheet();t._imageLoader||(t._imageLoader=new r._ImageLoader(function(){o(t)}));var a=t._imageLoader;try{if(a._getState(n)){t._isImageLoaded=!0;var s=a._getImage(n);t._originalWidth=s.width,t._originalHeight=s.height,t._isTakeOriginalSize&&(t.width(s.width,!0),t.height(s.height,!0),t._isTakeOriginalSize=!1),i&&i.repaint()}else a._addImage(n)}catch(e){}}f.inherit(n,e);var s="src",h="backColor",m="pictureStretch",g="borderRadius",_="borderWidth",v="borderStyle",y="borderColor",b=[s,h,g,_,v,y,m],w=[[s,p,function(e){var t=this;t._isImageLoaded=!1,o(t),t.srccallback||(t.srccallback=c(s)),t.srccallback.call(t,e)}],[h,d,c(h)],[g,-1,c(g),t],[_,1,c(_),t],[v,"none",function(e){var t=this;t._isBorderStyleWork(e)||t.borderWidth(0),t.bscallback||(t.bscallback=c(v)),t.bscallback.call(t,e)}],[y,d,c(y)],[m,0,c(m)]],C={onPropertyChanged:function(e,t){var n=this;if(!n._loading){var r=n.sheet();this._trigger({sheet:r,sheetName:r?r._name:"",picture:n,propertyName:e})}},toJSON:function(){var t=this,n=e.prototype.toJSON.call(this);return u.call(t,b,n),delete n.content,n},fromJSON:function(t,n){if(t){var r=this;r._loading=!0,e.prototype.fromJSON.call(r,t,n),l.call(r,b,t,n),r._isImageLoaded=!1,o(r),r._loading=p}},clone:function(){var e=new n,t=JSON.stringify(this.toJSON());return e.fromJSON(JSON.parse(t)),e},getOriginalWidth:function(){return this._originalWidth},getOriginalHeight:function(){return this._originalHeight},_isBorderStyleWork:function(e){return["dotted","dashed","solid","double","groove","ridge","inset","outset"].indexOf(e)>=0},_createContentContainer:function(){var e=i("div");return f(e).addClass("gc-floatingobject-content-container").addClass("gc-no-user-select").attr("unselectable","on").css("position","absolute"),this._addContainer(e),e},_trigger:function(e){var t=this.sheet();if(t&&(t._trigger(r.Events.PictureChanged,e),"isSelected"===e.propertyName)){var n={sheet:e.sheet,sheetName:e.sheetName,picture:e.picture};t._trigger(r.Events.PictureSelectionChanged,n)}}};return f.each(w,function(e,t){C[t[0]]=a(t[0],t[1],t[2],t[3])}),f.extend(n.prototype,C),n}(s);o.Picture=h,e.exports=o},function(e,t,n){var r=n(33);r&&function(){function e(e,n,r){var o=this;o._touchMouseMessageFilter=new l(o),o._touchTarget=new u(e,"FL_"+n.name,o._touchMouseMessageFilter,2,200),o._touchEventProvider=r,o._touchEventHandler=new t(e,n);var i=o._touchEventHandler,a=o._touchTarget;a._canDoManipulation=function(){return n._floatingObject.isSelected()},a._canDoTap=function(){return!0},a._manipulationStarting=function(e){return i._doManipulationStarting(e)},a._manipulationStarted=function(e){return i._doManipulationStarted(e)},a._manipulationDelta=function(e){return i._doManipulationDelta(e)},a._manipulationCompleted=function(e){return i._doManipulationCompleted(e)},a._tapped=function(e){return i._doTapped(e)}}function t(e,t){var n=this;n._floatingObjectRender=t,n._floatingObject=t._floatingObject,n._containerElement=e,n._touchZoomManager=new r._TouchZoomManager(t._sheet)}var o=n(1),i=o.GC$,a=i.extend,s=o._util._cancelDefault,l=r._TouchMouseMessageFilter,u=r._TouchTargetElement;a(e.prototype,{_attach:function(){var e=this,t=e._touchEventProvider;t&&t._attachDettach(e._touchTarget,!0)},_detach:function(){var e=this,t=e._touchEventProvider;t&&t._attachDettach(e._touchTarget,!1)},_preProcessMouseDown:function(e){return this._touchMouseMessageFilter._preProcessMouseDown(e)},_preProcessMouseUp:function(e){return this._touchMouseMessageFilter._preProcessMouseUp(e)},_preProcessMouseMove:function(e){return this._touchMouseMessageFilter._preProcessMouseMove(e)}}),a(t.prototype,{_positionToPage:function(e){var t=new r._TouchPoint(e.X,e.Y),n=i(this._containerElement).offset();if(n){var o=document.body;t.X+=n.left+o.clientLeft||0,t.Y+=n.top+o.clientTop||0}return t},_doManipulationStarting:function(e){e._Mode=35},_doManipulationStarted:function(e){var t=this,n=t._positionToPage(e._Position);t._floatingObjectRender._doMouseDown({target:e._OriginalSource,isTouch:!0,button:0,pageX:n.X,pageY:n.Y,stopPropagation:function(){}}),t._touchZoomManager._startZoom()},_doManipulationDelta:function(e){var t=this,n=e._Cumulative._Scale,r=t._floatingObjectRender._sheet,o=r.parent;if(1!==n&&o&&o.options.allowUserZoom)r._eventHandler._isFloatingObjectWorking=!1,t._floatingObjectRender._resetStatusOnMouseUp(),t._touchZoomManager._continueZoom(n);else{var i=t._positionToPage(e._Position);t._floatingObjectRender._doMouseMove({isTouch:!0,button:0,pageX:i.X,pageY:i.Y,stopPropagation:function(){}})}},_doManipulationCompleted:function(e){var t=this,n=e._Cumulative._Scale,r=t._floatingObjectRender._sheet,o=r.parent;if(1!==n&&o&&o.options.allowUserZoom)t._touchZoomManager._endZoom(n);else{var i=t._positionToPage(e._Position);this._floatingObjectRender._doMouseUp({isTouch:!0,button:0,pageX:i.X,pageY:i.Y,stopPropagation:function(){}})}},_doTapped:function(){try{var e=this,t=e._floatingObjectRender._sheet;t.suspendPaint(),e._floatingObject.isSelected()||(t._unSelectAllFloatingObjects(),e._floatingObject.isSelected(!0),o._FocusHelper._setActiveElement(t)),t.clearSelection()}finally{t.resumePaint()}}}),n(34)._FloatingObjectRender._registerFeature("touch",{init:function(t){var n=this;(n._touchManager=new e(t,n,n._sheet.parent._touchEventProvider))._attach()},dispose:function(){var e=this._touchManager;e&&e._detach()},preProcessMouseDown:function(e){var t=e.e,n=this._touchManager;n&&!t.isTouch&&n._preProcessMouseDown(t)&&(s(t),e.r=!0)},preProcessMouseMove:function(e){var t=e.e,n=this._touchManager;n&&!t.isTouch&&n._preProcessMouseMove(t)&&(s(t),e.r=!0)},preProcessMouseUp:function(e){var t=e.e,n=this._touchManager;n&&!t.isTouch&&n._preProcessMouseUp(t)&&(s(t),e.r=!0)}})}()},function(e,t,n){var r=n(35);n(121),n(122),e.exports=r},function(e,t,n){function r(e,t,n){var r=!1,o=e.comments._getActiveComment();if(o){var a=o.location();return e._commandManager().execute({cmd:b,sheetName:e.name(),comment:o,oldValue:a.clone(),newValue:new i.Point(a.x+t,a.y+n),propertyName:"location"})}return r}function o(e,t){if(t?e.canUndo():e.canExecute()){var n=e._commentUndoTransaction;if(n){for(var r=0;r<n.length;r++){var o=n[r];o&&(t?o.undo():o.execute())}return!0}}return!1}var i=n(1),a=i.Commands,s=i.GC$,l=i.Events,u=n(35),c=a.ActionBase,f=null,d=void 0,p="deleteComment",h="deleteCommentByKey",m="deactivateComment",g="moveCommentUp",_="moveCommentDown",v="moveCommentLeft",y="moveCommentRight",b="changeComment",w="changeCommentTransaction",C=a._executeCommand;a[h]={canUndo:!1,execute:function(e,t){var n=a._getWorksheet(e,t),r=n.comments._getActiveComment();return!!r&&n._commandManager().execute({cmd:p,sheetName:n.name(),comment:r})}},a[m]={canUndo:!1,execute:function(e,t){var n=a._getWorksheet(e,t),r=n.comments;return!!r._getActiveComment()&&(r._clearActiveComment(),n._loadAndSetSheetSelections(),n.repaint(),!0)}},a[g]={canUndo:!1,execute:function(e,t){return r(a._getWorksheet(e,t),0,-1)}},a[_]={canUndo:!1,execute:function(e,t){return r(a._getWorksheet(e,t),0,1)}},a[v]={canUndo:!1,execute:function(e,t){return r(a._getWorksheet(e,t),-1,0)}},a[y]={canUndo:!1,execute:function(e,t){return r(a._getWorksheet(e,t),1,0)}},a[p]={canUndo:!0,execute:function(e,t,n){return C(e,x,t,n)}},a[b]={canUndo:!0,execute:function(e,t,n){return C(e,T,t,n)}},a[w]={canUndo:!0,execute:function(e,t,n){return C(e,E,t,n)}};var S=function(e){function t(){e.call(this)}s.inherit(t,e);var n={init:function(e,t){this._sheet=e,this._command=t},canUndo:function(){return!!this._command._savedComment},saveState:function(){this._command._savedComment=this._command.comment},clearState:function(){this._command._savedComment=d}};return s.extend(t.prototype,n),t}(c),x=function(e){function t(t,n){e.call(this),this.init(t,n)}s.inherit(t,e);var n={execute:function(){var e=this;if(e.canExecute()){e.saveState();var t=e._sheet;e._beforeAction(t,!0);var n=e._command.comment,r=t.comments,o={sheet:t,sheetName:t.name(),comment:n,cancel:!1};return t._trigger(l.CommentRemoving,o),o&&!0===o.cancel?e.clearState():(t.comments.remove(n._rowIndex,n._colIndex),r._activeComment=f,t._loadAndSetSheetSelections(),t._trigger(l.CommentRemoved,{sheet:t,sheetName:t.name(),comment:n})),e._afterAction(t,!0),!0}return!1},undo:function(){var e=this,t=e._command._savedComment;if(e.canUndo()){var n=e._sheet;return e._beforeAction(n,!0),n.comments._addInternal(t._rowIndex,t._colIndex,t),n._saveAndClearSheetSelections(),e._afterAction(n,!0),!0}return!1}};return s.extend(t.prototype,n),t}(S),T=function(e){function t(t,n){var r=this;e.call(r),r.init(t,n)}s.inherit(t,e);var n={execute:function(){var e=this,t=e._command,n=t.comment;if(e.canExecute()&&n){e.saveState();var r=e._sheet;return e._beforeAction(r,!0),n[t.propertyName](t.newValue),e._afterAction(r,!0),!0}return!1},undo:function(){var e=this,t=e._command;if(e.canUndo()){var n=e._sheet;return e._beforeAction(n,!0),t.comment[t.propertyName](t.oldValue),e._afterAction(n,!0),!0}return!1}};return s.extend(t.prototype,n),t}(S);a.ChangeComment=T;var E=function(e){function t(t,n){var r=this;e.call(r),r._commentUndoTransaction=[],r._sheet=t,r._command=n;var o=n.commands;if(o)for(var i=0;i<o.length;i++)r.add(o[i])}s.inherit(t,e);var n={execute:function(){return o(this,!1)},undo:function(){return o(this,!0)},add:function(e){this._commentUndoTransaction.push(e)}};return s.extend(t.prototype,n),t}(c),M=function(e){e.register(h,a[h],46,!1,!1,!1,!1),e.register(m,a[m],27,!1,!1,!1,!1),e.register(g,a[g],38,!1,!1,!1,!1),e.register(_,a[_],40,!1,!1,!1,!1),e.register(v,a[v],37,!1,!1,!1,!1),e.register(y,a[y],39,!1,!1,!1,!1),e.register(p,a[p]),e.register(b,a[b]),e.register(w,a[w])};a._initCommentDefaultCommands=M;var A={CommentDeleteUndoAction:x,CommentPropertyUndoAction:T};s.extend(u,A),e.exports=u},function(e,t,n){var r=n(33);r&&function(){function e(e,n,r){var o=this,i=o._comment=n._comment;o._touchMouseMessageFilter=new c(o),o._touchTarget=new f(e,"Comment"+i._rowIndex+i._colIndex,o._touchMouseMessageFilter,2,200),o._touchEventProvider=r,o._touchEventHandler=new t(e,n);var a=o._touchEventHandler,s=o._touchTarget;s._canDoManipulation=function(){return 3!==o._comment.commentState()},s._canDoTap=function(){return!0},s._manipulationStarting=function(e){return a._doManipulationStarting(e)},s._manipulationStarted=function(e){return a._doManipulationStarted(e)},s._manipulationDelta=function(e){return a._doManipulationDelta(e)},s._manipulationCompleted=function(e){return a._doManipulationCompleted(e)},s._tapped=function(e){return a._doTapped(e)}}function t(e,t){var n=this;n._containerElement=e,n._commentView=t,n._comment=t._comment,n._sheet=n._comment._sheet,n._touchZoomManager=new r._TouchZoomManager(n._sheet)}function o(e,t,n){var r=this,o=r._comment=t._comment;r._touchMouseMessageFilter=new c(r),r._touchTarget=new f(e,"Comment"+o._rowIndex+o._colIndex,r._touchMouseMessageFilter,2,200),r._touchEventProvider=n,r._touchEventHandler=new i(e,t);var a=r._touchEventHandler,s=r._touchTarget;s._canDoManipulation=function(){return 3!==r._comment.commentState()},s._canDoTap=function(){return!0},s._manipulationStarting=function(e){return a._doManipulationStarting(e)},s._manipulationStarted=function(e){return a._doManipulationStarted(e)},s._manipulationDelta=function(e){return a._doManipulationDelta(e)},s._manipulationCompleted=function(e){return a._doManipulationCompleted(e)},s._tapped=function(e){return a._doTapped(e)}}function i(e,n){t.call(this,e,n)}var a=n(1),s=a.GC$,l=s.extend,u=a._util._cancelDefault,c=r._TouchMouseMessageFilter,f=r._TouchTargetElement;l(e.prototype,{_attach:function(){var e=this,t=e._touchEventProvider;t&&t._attachDettach(e._touchTarget,!0)},_detach:function(){var e=this,t=e._touchEventProvider;t&&t._attachDettach(e._touchTarget,!1)},_preProcessMouseDown:function(e){return this._touchMouseMessageFilter._preProcessMouseDown(e)},_preProcessMouseUp:function(e){return this._touchMouseMessageFilter._preProcessMouseUp(e)},_preProcessMouseMove:function(e){return this._touchMouseMessageFilter._preProcessMouseMove(e)}}),l(t.prototype,{_positionToPage:function(e){var t=new r._TouchPoint(e.X,e.Y),n=s(this._containerElement).offset();if(n){var o=document.body;t.X+=n.left+o.clientLeft||0,t.Y+=n.top+o.clientTop||0}return t},_doManipulationStarting:function(e){e._Mode=35},_doManipulationStarted:function(e){var t=this,n=t._positionToPage(e._Position);t._commentView._doMouseDownToDragOrResize({target:e._OriginalSource,isTouch:!0,button:0,pageX:n.X,pageY:n.Y,stopPropagation:function(){}}),t._touchZoomManager._startZoom()},_doManipulationDelta:function(e){var t=this,n=e._Cumulative._Scale,r=t._sheet,o=r.parent;if(1!==n&&o&&o.options.allowUserZoom){r._eventHandler._isCommentWorking=!1;var i=t._commentView;s(i._moveResizeContainerDom).remove(),t._touchZoomManager._continueZoom(n)}else{var a=t._positionToPage(e._Position);t._commentView._doMouseMove({target:e._OriginalSource,isTouch:!0,button:0,pageX:a.X,pageY:a.Y,stopPropagation:function(){}})}},_doManipulationCompleted:function(e){var t=this,n=e._Cumulative._Scale,r=t._sheet,o=r.parent;if(1!==n&&o&&o.options.allowuserZoom)t._touchZoomManager._endZoom(n);else{var i=t._positionToPage(e._Position);t._commentView._doMouseUp({target:e._OriginalSource,isTouch:!0,button:0,pageX:i.X,pageY:i.Y,stopPropagation:function(){}})}},_doTapped:function(){var e=this,t=e._comment,n=e._sheet;try{n.suspendPaint(),3===t.commentState()?t.commentState(1):1===t.commentState()&&t.commentState(2)}finally{n.resumePaint()}}}),l(o.prototype,{_attach:function(){var e=this,t=e._touchEventProvider;t&&t._attachDettach(e._touchTarget,!0)},_detach:function(){var e=this,t=e._touchEventProvider;t&&t._attachDettach(e._touchTarget,!1)},_preProcessMouseDown:function(e){return this._touchMouseMessageFilter._preProcessMouseDown(e)},_preProcessMouseUp:function(e){return this._touchMouseMessageFilter._preProcessMouseUp(e)},_preProcessMouseMove:function(e){return this._touchMouseMessageFilter._preProcessMouseMove(e)}}),s.inherit(i,t),i.prototype._doManipulationStarted=function(e){var t=this,n=t._positionToPage(e._Position);t._commentView._doMouseDownToEdit({target:e._OriginalSource,isTouch:!0,button:0,pageX:n.X,pageY:n.Y,stopPropagation:function(){}}),t._touchZoomManager._startZoom()},n(35)._CommentView._registerFeature("touch",{init:function(t){var n=this,r=n._comment._sheet,i=r.parent._touchEventProvider;n._touchManager=new e(t[0],n,i),n._touchManager._attach(),n._touchContentManager=new o(t[1],n,i),n._touchContentManager._attach()},detachEditor:function(e){var t=this,n=t._comment._sheet;t._touchContentManager=new o(e,t,n.parent._touchEventProvider),t._touchContentManager._attach()},preProcessMouseDownEdit:function(e){var t=e.e,n=this._touchContentManager;n&&!t.isTouch&&n._preProcessMouseDown(t)&&(u(t),e.r=!0)},preProcessMouseDownDragResize:function(e){var t=e.e,n=this._touchManager;n&&!t.isTouch&&n._preProcessMouseDown(t)&&(u(t),e.r=!0)},preProcessMouseMove:function(e){var t=e.e,n=t.isTouch,r=this._touchManager,o=this._touchContentManager;r&&!n&&r._preProcessMouseMove(t)&&(u(t),e.r=!0),o&&!n&&o._preProcessMouseMove(t)&&(u(t),e.r=!0)},preProcessMouseUp:function(e){var t=e.e,n=t.isTouch,r=this._touchManager,o=this._touchContentManager;r&&!n&&r._preProcessMouseUp(t)&&(u(t),e.r=!0),o&&!n&&o._preProcessMouseUp(t)&&(u(t),e.r=!0)}})}()},function(e,t,n){function r(e){var t=0,n=0,r=e.length;r>0&&(t=e[0].row,n=e[0].col);for(var o=1;o<r;o++){var i=e[o];t>i.row&&(t=i.row),n>i.col&&(n=i.col)}return{r:t,c:n}}function o(e){return e.rowCount}function i(e){return e.colCount}function a(e,t,n){switch(e){case 0:return t===n;case 1:return t!==n;case 2:return t>n;case 3:return t>=n;case 4:return t<n;case 5:return t<=n;default:return!1}}var s={},l=n(0),u=n(1),c=n(5),f=u.GC$,d=null,p=void 0,h="undefined",m="string",g=Math.min,_=Math.max,v=Math.abs,y=Math.floor,b=c.Convert,w=b._isNumber,C=b._toDouble,S=b._tryToDouble,x=l._StringHelper,T=x._trimStart,E=x._startsWith,M=x._endsWith,A=x._contains,k=l._Types._isNullOrUndefined,R=l._RegexHelper,I=l._isInstanceOf,O=u._util,D=u._supportsCalc,P=u.Style,N=l._ColorHelper,F=N._toString,L=u._createRange,H=u.Range,V=l._DateTimeHelper,j=l._ArrayHelper,B=j._remove,U=j._indexOf,W=j._getLength,z=c.Functions,Y=c._createCellIdentity,G=u._ThemeContext,K=function(){return l._getResource(s.SR)()},X=function(e){var t;if(e instanceof c.Expression)t=e;else if(e instanceof H)t=q(e);else{if(!w(e)||isNaN(e=C(e)))throw K().Exp_NotSupport;t=new c.Expression(2),t.value=e}return t},q=function(e){var t=e.row<0?c.BAND_INDEX_CONST:e.row,n=e.col<0?c.BAND_INDEX_CONST:e.col;return new c._createRangeExpression(d,d,t,n,t+e.rowCount-1,n+e.colCount-1)},J=function(e,t,n,r){var o=e,i=t,a=function(e,t){var a=this;a.hasOwnProperty("_ps")||(a._ps={});var s=a._ps;if(0===arguments.length)return s[o]!==p?r?r.call(a,s[o]):s[o]:i;if(s[o]!==e){var l=s[o]!==p?s[o]:i;s[o]=e,!1!==t&&n&&n.call(a,e,l)}return a};return a.isDefault=function(e){return e===i},a},Z=function(e,t){var n=this;return t||(t={}),e||(e=n),f.each(e,function(e,r){var o=n[r];if(!k(o)){var i=o.call(n);"iconCriteria"===r?t[r]=i:i&&i.toJSON?t[r]=i.toJSON():k(i)||o.isDefault(i)||(t[r]=i)}}),t},Q=function(e,t,n){if(t){var r,a=this;e||(e=a),f.each(e,function(e,s){if(r=t[s],!k(r))if("ranges"===s){for(var l=[],u=0;u<r.length;u++){var c=r[u];l.push(L(c.row,c.col,o(c),i(c)))}a.ranges(l,!1)}else if("style"===s)a.style(new P,!1),a.style().fromJSON(r,n);else if("iconCriteria"===s)for(var d=r.length,p=0;p<d;p++){var h=r[p];a._iconCriteria[p]=new ue(h.isGreaterThanOrEqualTo,h.iconValueType,h.iconValue)}else if("item1"===s||"item2"===s)a[s](re(),!1),a[s]().fromJSON(r);else if("expected"===s)f.getType(r)===m&&5===t.conType?a[s](new Date(r),!1):a[s](r,!1);else if("condition"===s){var g=new ne;g.fromJSON(r),a.condition(g,!1)}else a[s](r,!1)})}},$={init:function(){this.conditionalFormats=new fe(this)},dispose:function(e){if(!1!==e){var t=this.conditionalFormats;t&&t._clearCellRuleCache()}},onLayoutChanged:function(e){var t=e.changeType,n=e.row,r=o(e),a=e.col,s=i(e),l=e.sheetArea,u=this.conditionalFormats;"addRows"===t?u._onRowsAdded(n,r):"deleteRows"===t?u._onRowsRemoved(n,r):"addColumns"===t?u._onColumnsAdded(a,s):"deleteColumns"===t?u._onColumnsRemoved(a,s):"clear"===t?u._clearCache():"setColumnCount"!==t&&"setRowCount"!==t||3!==l&&1!==l||u._resetCache()},toJson:function(e){var t=this.conditionalFormats;t&&(e.conditionalFormats=t.toJSON())},fromJson:function(e,t){e&&e.conditionalFormats&&this.conditionalFormats.fromJSON(e.conditionalFormats,t)}};u.Worksheet._registerFeature("conditionalFormat",$),s.GeneralComparisonOperators={equalsTo:0,notEqualsTo:1,greaterThan:2,greaterThanOrEqualsTo:3,lessThan:4,lessThanOrEqualsTo:5},s.LogicalOperators={or:0,and:1},s.ComparisonOperators={equalsTo:0,notEqualsTo:1,greaterThan:2,greaterThanOrEqualsTo:3,lessThan:4,lessThanOrEqualsTo:5,between:6,notBetween:7},s.TextComparisonOperators={contains:0,doesNotContain:1,beginsWith:2,endsWith:3},s.TextCompareType={equalsTo:0,notEqualsTo:1,beginsWith:2,doesNotBeginWith:3,endsWith:4,doesNotEndWith:5,contains:6,doesNotContain:7},s.ColorCompareType={backgroundColor:0,foregroundColor:1},s.CustomValueType={empty:0,nonEmpty:1,error:2,nonError:3,formula:4},s.DateCompareType={equalsTo:0,notEqualsTo:1,before:2,beforeEqualsTo:3,after:4,afterEqualsTo:5},s.Top10ConditionType={top:0,bottom:1},s.DateOccurringType={today:0,yesterday:1,tomorrow:2,last7Days:3,thisMonth:4,lastMonth:5,nextMonth:6,thisWeek:7,lastWeek:8,nextWeek:9},s.QuarterType={quarter1:0,quarter2:1,quarter3:2,quarter4:3},s.AverageConditionType={above:0,below:1,equalOrAbove:2,equalOrBelow:3,above1StdDev:4,below1StdDev:5,above2StdDev:6,below2StdDev:7,above3StdDev:8,below3StdDev:9},s.ScaleValueType={number:0,lowestValue:1,highestValue:2,percent:3,percentile:4,automin:5,formula:6,automax:7},s.BarDirection={leftToRight:0,rightToLeft:1},s.DataBarAxisPosition={automatic:0,cellMidPoint:1,none:2},s.IconSetType={threeArrowsColored:0,threeArrowsGray:1,threeTriangles:2,threeStars:3,threeFlags:4,threeTrafficLightsUnrimmed:5,threeTrafficLightsRimmed:6,threeSigns:7,threeSymbolsCircled:8,threeSymbolsUncircled:9,fourArrowsColored:10,fourArrowsGray:11,fourRedToBlack:12,fourRatings:13,fourTrafficLights:14,fiveArrowsColored:15,fiveArrowsGray:16,fiveRatings:17,fiveQuarters:18,fiveBoxes:19},s.IconValueType={number:1,percent:4,formula:7,percentile:5};var ee={relationCondition:0,numberCondition:1,textCondition:2,colorCondition:3,formulaCondition:4,dateCondition:5,dateExCondition:6,textLengthCondition:7,top10Condition:8,uniqueCondition:9,averageCondition:10,cellValueCondition:11,areaCondition:12};s.ConditionType=ee;var te={conditionRuleBase:0,cellValueRule:1,specificTextRule:2,formulaRule:3,dateOccurringRule:4,top10Rule:5,uniqueRule:6,duplicateRule:7,averageRule:8,twoScaleRule:10,threeScaleRule:11,dataBarRule:12,iconSetRule:13};s.RuleType=te,function(){var e;for(e in ee)ee[e]!==p&&(ee[ee[e]]=e);for(e in te)te[e]!==p&&(te[te[e]]=e)}();var ne=function(){function e(e,t){t||(t={});var n=t.formula,r=this;r.offsetRow=0,r.offsetCol=0,r.conType("string"==typeof e?s.ConditionType[e]:e),k(t.compareType)||r._compareType(t.compareType),k(t.expected)||r.expected(t.expected),k(n)||r.formula("string"==typeof n?T(f.trim(n),"="):n),k(t.item1)||r.item1(t.item1),k(t.item2)||r.item2(t.item2),k(t.customValueType)||r.customValueType(t.customValueType),k(t.type)||r.type(t.type),r.ranges(t.ranges),r._baseRow=d,r._baseCol=d,r._expr=d,r._stdevExpr=d}var t=["conType","compareType","item1","item2","ignoreBlank","expected","formula","treatNullValueAsZero","integerValue","forceValue2Text","useWildCards","ignoreCase","customValueType","expectTypeId","type","ranges","isPercent","regex"],n=function(e,t){return e.getYear()===t.getYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()},r=function(e,t){return t>h(e)},l=function(e,t){return t<u(e)},u=function(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0)},h=function(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate(),23,59,59,999)},m=function(e,t){e.setDate(t)},g=function(e){return e.getDate()};return e.prototype={conType:J("conType",d),ranges:J("ranges",d),ignoreBlank:J("ignoreBlank",!1),compareType:J("compareType",p),expected:J("expected",p),formula:J("formula",p),item1:J("item1",d),item2:J("item2",d),treatNullValueAsZero:J("treatNullValueAsZero",!1),integerValue:J("integerValue",!1),forceValue2Text:J("forceValue2Text",!1),useWildCards:J("useWildCards",!0),regex:J("regex",d),ignoreCase:J("ignoreCase",!1),customValueType:J("customValueType",p),expectTypeId:J("expectTypeId",0),type:J("type",d),isPercent:J("isPercent",!1),adjustOffset:function(e,t){var n=this,r=n.item1();r&&r.adjustOffset&&r.adjustOffset(e,t),r=n.item2(),r&&r.adjustOffset&&r.adjustOffset(e,t),n.offsetRow=e,n.offsetCol=t},relationConditionEvaluate:function(e,t,n,r,o){function i(r,o){if(e&&r&&3===r.conType()){var i=e.getActualStyle(t,n);i&&(0===r._compareType()?o=i.backColor:1===r._compareType()&&(o=i.foreColor))}return o}function a(e,t){if(e)return e.ignoreBlank(l.ignoreBlank()),arguments.length<5?i(e,r):t}function s(r,o){return!k(r)&&r.evaluate(e,t,n,o)}var l=this,u=a(l.item1(),r),c=a(l.item2(),o);return s(l.item1(),u)+s(l.item2(),c)>l._compareType()},cellValueConditionEvaluate:function(e,t,n,r){var o=this.getExpected(e,t,n);return this.cellValueConditionCheckCondition(o,r)},cellValueConditionCheckCondition:function(e,t){function n(e){return"string"==typeof e&&0===e.trim().length}function r(e){return"string"==typeof e&&0===e.length}function o(e){return"string"==typeof e&&(0===e.trim().length||isNaN(+e))}var i=this,s=0,l=!1;if((k(t)||r(t))&&(k(e)||r(e)))switch(i._compareType()){case 0:case 3:case 5:return!0;case 1:case 2:case 4:default:return!1}if("boolean"==typeof e)return a(i._compareType(),t,e);if(n(e)&&n(t))return!!/0|3|5/.test(i._compareType())&&e===t;if(1==(o(e)^o(t)))return!1;var u={};if(k(t)?i.treatNullValueAsZero()?(l=!0,s=0):s=t:"boolean"!=typeof t&&S(t,u)&&(s=u.value,l=!isNaN(s)),l){var c=0,f=!1;return S(e,u)&&(c=u.value,f=!0),f?a(i._compareType(),s,c):1===i._compareType()}return"string"==typeof t&&("string"==typeof e?a(i._compareType(),t,e):1===i._compareType())},numberConditionEvaluate:function(e,t,n,r){var o=this.numberConditionGetExpected(e,t,n);return this.integerValue()&&(o=isNaN(o)?d:parseInt(o,10)),this.numberConditionCheckCondition(o,r)},numberConditionCheckCondition:function(e,t){var n=this;if((k(t)||""===t)&&n.ignoreBlank())return!0;if(isNaN(t))return!1;if(k(e)){if(n.ignoreBlank())return!0;e=0}try{var r=parseFloat(t)}catch(e){return!1}if(n.integerValue()){if(!(r-y(r)==0))return!1}return a(n._compareType(),r,e)},numberConditionGetExpected:function(e,t,n){var r=this;if(r.formula()&&r.formula().length>0){var o=e._getCalcServiceInternal();return o?o.evaluate(e._getSheetSource(),r.formula(),t,n):r.expected()}return r.expected()},textConditionEvaluate:function(e,t,n,r){function o(e,t){return c?l.testByRegular(t,e,"^","$"):f?e.toLowerCase()===t.toLowerCase():e===t}function i(e,t){return c?l.testByRegular(t,e,"^",""):E(t,e,f)}function a(e,t){return c?l.testByRegular(t,e,"","$"):M(t,e,f)}function s(e,t){return c?l.testByRegular(t,e,"",""):A(t,e===p||e===d?"":e,f)}var l=this,u=l.compareType(),c=l.useWildCards(),f=l.ignoreCase();if(!l.forceValue2Text()&&I(r,Date))return 2!==u&&4!==u&&6!==u&&(3===u||5===u||7===u);var h=k(r)?"":r.toString();if(l.ignoreBlank()&&""===h)return!0;var m=this.getExpected(e,t,n),g=k(m)?"":m.toString();if(l.hasWildcard(g)&&"number"==typeof r)return 3===u||7===u||5===u||1===u;switch(u){case 0:return o(g,h);case 1:return!o(g,h);case 2:return i(g,h);case 3:return!i(g,h);case 4:return a(g,h);case 5:return!a(g,h);case 6:return s(g,h);case 7:return!s(g,h);default:return!1}},hasWildcard:function(e){return e.indexOf("*")>-1||e.indexOf("?")>-1},testByRegular:function(e,t,n,r){if(this.regex())return R._getReg(this.regex()).test(e);var o=R._getWildcardCriteria(t);return o||(o=t),o=n+o+r,this.ignoreCase()?R._getRegIgnoreCase(o).test(e):R._getReg(o).test(e)},colorConditionEvaluate:function(e,t,n,r){function o(e){return k(e)||""===e?d:N._fromString(e)}var i=this,a=o(i.expected());if(k(a)||""===a){if(i.ignoreBlank())return!0}else{var s=o(r);if((k(s)||""===s)&&e&&e.getDefaultStyle){var l=e.getDefaultStyle();0===i._compareType()?s=l.backColor:1===i._compareType()&&(s=l.foreColor)}if(!k(s)&&""!==s)return s.a===a.a&&s.r===a.r&&s.g===a.g&&s.b===a.b}return!1},formulaConditionEvaluate:function(e,t,n,r){if(!D)return!1;var o=this;if(4===o.customValueType()){var i=o.getExpected(e,t,n);if(o.ignoreBlank()&&(k(i)||""===i))return!0;var a={};return!!b._tryToBool(i,a)&&a.value}var s=b._isError;switch(o.customValueType()){case 0:return k(r)||""===r;case 1:return!k(r)&&""!==r;case 2:return s(r);case 3:return!s(r);default:return!1}},formulaConditionGetExpected:function(e,t,n){var r=this;if(r.formula()&&r.formula().length>0){var o=e._getCalcServiceInternal();if(!o)return r.expected();r._expr||(k(r._baseRow)&&k(r._baseCol)&&(r._baseRow=t,r._baseCol=n),r._expr=o.parse(e._getSheetSource(),r.formula(),r._baseRow,r._baseCol));var i,a,s,l,u,f=o._evaluateParsedFormula(e._getSheetSource(),r._expr,Y(t,n),!0);if(b._isReference(f)){for(i=f.getRowCount(0),a=f.getColumnCount(0),s=[],l=0;l<i;l++)for(s[l]=[],u=0;u<a;u++)s[l][u]=f.getValue(0,l,u);f=s}else if(b._isArray(f)){for(i=f.getRowCount(),a=f.getColumnCount(),s=[],l=0;l<i;l++)for(s[l]=[],u=0;u<a;u++)s[l][u]=f.getValue(l,u);f=s}if(I(f,Array)){if(i=W(f),a=W(f[0]),1===i&&1===a)return f[0][0];var d=t-r._baseRow,p=n-r._baseCol;return d<i&&p<a?f[d][p]:c.Errors.NotAvailable}return f}return r.expected()},dateConditionEvaluate:function(e,t,o,i){var a=this;if((k(i)||""===i)&&a.ignoreBlank())return!0;if(!I(i,Date))return!1;var s=d,u=this.getExpected(e,t,o);if(I(u,Date)?s=u:"string"==typeof u?s=V._parseLocale(u):"number"==typeof u&&(s=V._fromOADate(u)),k(s))return!!a.ignoreBlank();switch(a._compareType()){case 0:return n(s,i);case 1:return!n(s,i);case 4:return r(s,i);case 5:return r(s,i)||n(s,i);case 2:return l(s,i);case 3:return l(s,i)||n(s,i);default:return!1}},dateExConditionEvaluate:function(e,t,n,r){var o=this._getExpectedInt(e,t,n);return!k(o)&&this.dateExConditionCheckCondition(o,r)},dateExConditionCheckCondition:function(e,t){function n(e,t){switch(e){case 0:return t.getMonth()>=0&&t.getMonth()<=2;case 1:return t.getMonth()>=3&&t.getMonth()<=5;case 2:return t.getMonth()>=6&&t.getMonth()<=8;case 3:return t.getMonth()>=9&&t.getMonth()<=11;default:return!1}}var r=this,o=t;if(r.ignoreBlank()&&(k(o)||""===o))return!0;try{o=b._toDateTime(o)}catch(e){return!1}var i,a=r.expectTypeId();if(0===a){var s=d,l=d,c=new Date,f=new Date(c.getFullYear(),c.getMonth(),c.getDate(),c.getHours(),c.getMinutes(),c.getSeconds(),c.getMilliseconds());switch(e){case 3:m(f,g(f)-6),s=u(f),l=h(c);break;case 1:m(f,g(f)-1),s=u(f),l=h(f);break;case 0:s=u(c),l=h(c);break;case 2:m(f,g(f)+1),s=u(f),l=h(f);break;case 8:var p=c;m(p,g(c)-c.getDay()-7);var _=f;_.setDate(g(f)-f.getDay()-1),s=u(p),l=h(_);break;case 7:var v=c;m(v,g(c)-c.getDay());var y=f;m(y,g(f)-f.getDay()+6),s=u(v),l=h(y);break;case 9:var w=c;m(w,g(c)-c.getDay()+7);var C=f;m(C,g(f)-f.getDay()+13),s=u(w),l=h(C);break;case 5:var S=c;m(S,1),S.setMonth(c.getMonth()-1);var x=f;m(x,0),s=u(S),l=h(x);break;case 4:var T=c;m(T,1);var E=f;m(E,1),E.setMonth(f.getMonth()+1),m(E,0),s=u(T),l=h(E);break;case 6:var M=c;m(M,1),M.setMonth(c.getMonth()+1);var A=f;m(A,1),A.setMonth(f.getMonth()+2),m(A,0),s=u(M),l=h(A)}if(!k(s)&&!k(l)){var R=re(5,5,s,d),I=re(5,3,l,d);return re(0,1,d,d,d,d,d,R,I).evaluate(d,0,0,o)}}else if(i=r._getExpectedInt(d,0,0),!k(i)){if(1===a)return i===o.getFullYear();if(2===a)return n(i,o);if(3===a)return i===o.getMonth();if(4===a)return i===o.getDay();if(5===a)return i===g(o)}return!1},textLengthConditionEvaluate:function(e,t,n,r){if(k(r)||""===r)return this.ignoreBlank();var o=k(r)?0:r.toString().length,i=this._getExpectedInt(e,t,n);return"number"==typeof i&&a(this._compareType(),o,i)},top10ConditionEvaluate:function(e,t,n,r){var o=this;if(k(r)||""===r)return o.ignoreBlank();var i=o._getExpectedInt(e,t,n);if(!k(i)){var a=o.getTopValues(e,i,o.ranges());if(a){var s=0;try{s=o._toDouble(r)}catch(e){return!1}if(j._contains(a,s))return!0}}return!1},_getExpectedInt:function(e,t,n){var r=this.getExpected(e,t,n);return r=parseInt(r,10),isNaN(r)||!isFinite(r)?d:r},adjustRange:function(e,t){return L(e.row,e.col,Math.min(o(e),t.getRowCount()),Math.min(i(e),t.getColumnCount()))},getTopValues:function(e,t,n){var r=0===this.type()?1:-1,a=[];if(!n)return a;for(var s,l,u,c,f=this._cloneToActualRanges(e,n),d=W(f),p=0;p<d;p++){s=this.adjustRange(f[p],e);for(var h=0;h<o(s);h++){l=h+s.row;for(var m=0;m<i(s);m++)u=m+s.col,c=this._toDouble(e.getValue(l,u)),k(c)||k(c)||a.push(c)}}return a.sort(function(e,t){return(t-e)*r}),W(a)>t&&(a=a.slice(0,t)),a},_toDouble:function(e){return("number"==typeof e||I(e,Date))&&D?C(e):d},uniqueConditionEvaluate:function(e,t,n,r){var o=this,i=r;if(k(i)||""===i)return o.ignoreBlank();D&&w(i)&&(i=C(i));var a=this.getExpected(e,t,n),s={};b._tryToBool(a,s);var l=s.value;if(!k(l)){var u=o.getDuplicated(e,o.ranges());return!k(u)&&j._contains(u,i)?!0===l:!0!==l}return!1},getDuplicated:function(e,t){var n=[],r=[],a=this._cloneToActualRanges(e,t);if(a){for(var s=W(a),l=0;l<s;l++){var u=a[l];u=this.adjustRange(u,e);for(var c=0;c<o(u);c++)for(var h=c+u.row,m=0;m<i(u);m++){var g=m+u.col,_=e.getValue(h,g,3);k(_)||D&&w(_)&&(_=C(_)),n.push(_)}}var v={};f.each(n,function(e,t){v[t]=0}),f.each(n,function(e,t){v[t]++}),f.each(n,function(e,t){v[t]>1&&r.push(t)}),v=p}return n=d,r},_containsKey:function(e,t){for(var n=e.length,r=0;r<n;r++)if(e[r].key===t)return!0;return!1},averageConditionEvaluate:function(e,t,n,r){if(!D)return!1;var o=this;if(o.ignoreBlank()&&(k(r)||""===r))return!0;o._rebuildFormula();var i=this.getExpected(e,t,n),a={},s=S(i,a)?a.value:NaN,l=d,u=o._stdevExpr?o._getExpectedByExpression(e,o._stdevExpr,t,n):d;if(k(u)||(a={},l=S(u,a)?a.value:NaN),w(r)){var c=C(r);if(!isNaN(s)){var f=isNaN(l);switch(o.type()){case 0:return c>s;case 1:return c<s;case 2:return c>=s;case 3:return c<=s;case 4:return!f&&c>s+l;case 5:return!f&&c<s-l;case 6:return!f&&c>s+2*l;case 7:return!f&&c<s-2*l;case 8:return!f&&c>s+3*l;case 9:return!f&&c<s-3*l;default:return!1}}}return!1},_rebuildFormula:function(){var e=this;e.ranges()&&(e._expr=e._createExpression("AVERAGE",e.ranges()),e.type()>=4&&e.type()<=9&&(e._stdevExpr=e._createExpression("STDEV",e.ranges())))},_createExpression:function(e,t){if(!D)return d;var n=z.findGlobalFunction(e);if(n){for(var r=[],o=W(t),i=0;i<o;i++)r[i]=X(t[i]);return c._createFunctionExpression(n,r)}return d},averageConditionGetExpected:function(e,t,n){var r=e._getCalcServiceInternal();if(!r)return d;var o=r.unparse(d,this._expr,t,n);return this._expr=r.parse(e._getSheetSource(),o,t,n),r._evaluateParsedFormula(e._getSheetSource(),this._expr,Y(t,n),!1)},_getExpectedByExpression:function(e,t,n,r){var o=e._getCalcServiceInternal();if(!o)return d;var i=o.unparse(d,t,n-this.offsetRow,r-this.offsetCol);return t=o.parse(e._getSheetSource(),i,n,r),o._evaluateParsedFormula(e._getSheetSource(),t,Y(n,r),!1)},_concatArray:function(e,t){var n,r;for(r=0;r<W(t);r++)n=t[r],I(n,Array)&&W(n)>0?W(t)>1?e.push(n[0]):e.push.apply(e,n):e.push(n)},getValidList:function(e,t,n){for(var r=[],o=this.getValidListImp(e,t,n),i=0,a=W(o);i<a;i++)r.push(o[i].value);return r},getValidListImp:function(e,t,n){var r=this,o=[];if(r.formula()&&r.formula().length>0){var i=r.getExpected(e,t,n);I(i,Array)?r._concatArray(o,i):o.push(i)}else if(r.expected()&&r.expected().length>0){var a=r.expected(),s=a.split(",");if(s)for(var l=0;l<W(s);l++){var u=s[l];if(!k(u)){var c=f.trim(u);""!==c&&o.push({text:c,value:c})}}}return o},areaConditionEvaluate:function(e,t,n,r){function o(e,t){return I(e,Date)&&I(t,Date)?e.valueOf()===t.valueOf():e===t}var i=this;if(k(r)||""===r)return!0===i.ignoreBlank();for(var a=i.getValidList(e,t,n),s=0;s<W(a);s++){var l=a[s];if(k(l)&&k(r))return!0;if(i.formula()){if(o(l,r))return!0}else{var u=e.getActualStyle(t,n);if(o(O._parseText2Value(u,l,!0),r))return!0}}return!1},areaConditionGetExpected:function(e,t,n){var r=this,o=[];if(r.formula()){var i,a,s,l,u,c,f=e._getCalcServiceInternal();if(!f)return o;var d=f.parse(e._getSheetSource(),r.formula(),t-r.offsetRow,n-r.offsetCol),p=f._evaluateParsedFormula(e._getSheetSource(),d,Y(t,n),!0);if(b._isReference(p)){i=p.getRowCount(0),a=p.getColumnCount(0);var h=p.getRow(0),m=p.getColumn(0),g=p._source&&p._source._sheet;for(s=0;s<i;s++)for(o[s]=[],l=0;l<a;l++)u=p.getValue(0,s,l),c=g?g.getText(h+s,m+l):u,o[s][l]={value:u,text:c}}else if(b._isArray(p))for(i=p.getRowCount(),a=p.getColumnCount(),s=0;s<i;s++)for(o[s]=[],l=0;l<a;l++)u=p.getValue(s,l),o[s][l]={value:u,text:u}}else o.push({value:r.expected(),text:r.expected()});return o},reset:function(){var e=this;switch(e.ignoreBlank(!1),e._compareType(1),e.item1(d),e.item2(d),e.value1=d,e.value2=d,e.style(d),e.stopIfTrue(!1),e.priority(1),e.expected(d),e._compareType(0),e.integerValue(!1),e.operator=0,e.text="",e._compareType(0),e.useWildCards(!0),e.ignoreCase(!1),e.forceValue2Text(!1),e.customValueType(0),e._expr=d,e._baseRow=d,e._baseCol=d,e.type(0),this.expectTypeId(0),e.ranges(d),e.isPercent(!1),e.regex(d),e.conType()){case 0:e.ignoreBlank(!1),e._compareType(1);break;case 1:e._compareType(0),e.integerValue(!1);break;case 2:e._compareType(0),e.useWildCards(!0),e.forceValue2Text(!1);break;case 3:e._compareType(0);break;case 4:e.customValueType(0),e._stdevExpr=d;break;case 5:e._compareType(0);break;case 6:e.expectTypeId(0);break;case 7:e._compareType(0);break;case 8:case 10:e.type(0);break;case 11:e.operator=6}},evaluate:function(e,t,n,r){var o=this.conType();return!k(o)&&this[ee[o]+"Evaluate"](e,t,n,r)},getExpectedNormal:function(e,t,n,r,o,i){var a=this,s=a.formula(),l=a.expected();if(s&&s.length>0){var u=e._getCalcServiceInternal();if(!u)return l;var c=u.parse(e._getSheetSource(),s,r,o);return u._evaluateParsedFormula(e._getSheetSource(),c,Y(t,n),!1,i)}return l},getExpected:function(e,t,n){var r=this;switch(r.conType()){case 2:return r.getExpectedNormal(e,t,n,t-r.offsetRow,n-r.offsetCol,!1);case 5:case 6:case 7:case 9:case 11:return r.getExpectedNormal(e,t,n,t-r.offsetRow,n-r.offsetCol,!1);case 8:return r.getExpectedNormal(e,t,n,t,n);case 0:return d;case 1:return r.numberConditionGetExpected(e,t,n);case 3:return d;case 4:return r.formulaConditionGetExpected(e,t,n);case 10:return r.averageConditionGetExpected(e,t,n);case 12:return r.areaConditionGetExpected(e,t,n);default:return d}},_cloneToActualRanges:function(e,t){for(var n=[],r=0,o=W(t);r<o;r++){var i=e._getActualRange(t[r]);n.push(i)}return n},getFormulas:function(){var e=[],t=this;return 0===t.conType()?(t.item1()&&t.item1().getFormulas&&(e=t.item1().getFormulas()),t.item2()&&t.item2().getFormulas&&(e=e.concat(t.item2().getFormulas())),e):t.formula()?[t.formula()]:[]},setFormulas:function(e){var t=this;if(0===t.conType()){if(t.item1()&&t.item1().getFormulas){var n=t.item1().getFormulas().length;t.item1().setFormulas(e.slice(0,n))}return void(t.item2()&&t.item2().setFormulas&&t.item2().setFormulas(e.slice(n)))}t.formula(e[0]),t._expr=null},toJSON:function(){return Z.call(this,t)},fromJSON:function(e,n){e&&Q.call(this,t,e,n)}},e.prototype._compareType=e.prototype.compareType,e.fromSource=function(e){return re(12,d,e,d)},e.fromFormula=function(e){return re(12,d,"",e)},e.fromDay=function(e){var t=re(6,d,e);return t.expectTypeId(5),t},e.fromMonth=function(e){var t=re(6,d,e);return t.expectTypeId(3),t},e.fromQuarter=function(e){var t=re(6,d,e);return t.expectTypeId(2),t},e.fromWeek=function(e){var t=re(6,d,e);return t.expectTypeId(4),t},e.fromYear=function(e){var t=re(6,d,e);return t.expectTypeId(1),t},e}();s.Condition=ne;var re=function(e,t,n,r,o,i,a,s,l){return new ne(e,{compareType:t,expected:n,formula:r,customValueType:o,type:i,ranges:a,item1:s,item2:l})};s._createCondition=re;var oe=function(){function e(e,t,n){var r=this;r.ruleType(e),r.style(t),r.ranges(n)}var t={ruleType:J("ruleType",d),ranges:J("ranges",d,function(e){var t=this.condition();t&&t.ranges()&&t.ranges(e)}),condition:J("condition",d),style:J("style",d),priority:J("priority",1),stopIfTrue:J("stopIfTrue",!1),evaluate:function(e,t,n,r){var o=this;if(o.contains(t,n)){o.initCondition();var i={baseRow:0,baseCol:0};o.getBaseCoordinate(i),o.condition().adjustOffset(t-i.baseRow,n-i.baseCol);var a=d;return o.condition().evaluate(e,t,n,r)&&(a=o.getExpected()),o.condition().adjustOffset(0,0),a}return d},contains:function(e,t){var n=this.ranges();if(n)for(var r,o=W(n),i=0;i<o;i++)if(r=n[i],r.contains(e,t))return!0;return!1},createCondition:function(){return null},initCondition:function(){this.condition()||this.condition(this.createCondition())},getExpected:function(){return this.style()},reset:function(){var e=this;e.ranges(d),e.condition(d),e.style(d),e.stopIfTrue(!1),e.priority(1)},intersects:function(e,t,n,r){var o=this.ranges();if(o)for(var i,a=W(o),s=0;s<a;s++)if(i=o[s],i.intersect(e,t,n,r))return!0;return!1},isScaleRule:function(){return!1},getBaseCoordinate:function(e){e.baseRow=Number.MAX_VALUE,e.baseCol=Number.MAX_VALUE;var t=this;if(t.ranges()&&W(t.ranges())>0)for(var n=0;n<W(t.ranges());n++){var r=t.ranges()[n],o=r.row,i=r.col;o=-1===o?0:o,i=-1===i?0:i,e.baseRow=g(o,e.baseRow),e.baseCol=g(i,e.baseCol)}else e.baseRow=0,e.baseCol=0},_addData:function(e,t,n){var r=this,a=n?t:0,s=n?0:t;if(r.ranges())for(var l=W(r.ranges()),u=0;u<l;u++){var c=r.ranges()[u],f=n?c.row:c.col,d=n?o(c):i(c);-1!==f&&(f>=e?r.ranges()[u]=L(c.row+a,c.col+s,o(c),i(c)):f<e&&e<f+d&&(r.ranges()[u]=L(c.row,c.col,o(c)+a,i(c)+s)))}},_onRowsAdded:function(e,t){this._addData(e,t,!0)},_onColumnsAdded:function(e,t){this._addData(e,t,!1)},_removeData:function(e,t,n){var r=this,a=n?e:0,s=n?0:e,l=n?t:0,u=n?0:t;if(r.ranges()){for(var c=[],f=W(r.ranges()),d=0;d<f;d++){var p=r.ranges()[d],h=n?p.row:p.col,m=n?o(p):i(p);if(-1!==h)if(h>e)h+m<=e+t?c.push(p):r.ranges()[d]=L(p.row-l,p.col-u,o(p),i(p));else if(h<=e&&e<h+m){var _=L(p.row,p.col,o(p)-g(p.row+o(p)-a,l),i(p)-g(p.col+i(p)-s,u));0===i(_)||0===o(_)?c.push(p):r.ranges()[d]=_}}for(var v=W(c),y=0;y<v;y++){var b=c[y];B(r.ranges(),b)}}},_onRowsRemoved:function(e,t){this._removeData(e,t,!0)},_onColumnsRemoved:function(e,t){this._removeData(e,t,!1)},toJSON:function(){return Z.call(this)},fromJSON:function(e,t){e&&Q.call(this,d,e,t)}};return f.extend(e.prototype,t),e}();s.ConditionRuleBase=oe;var ie=function(e){function t(t,n,r,o,i,a,s,l,u,c){e.call(this,t,r);var d=this;d.ranges(n),d.operator(o),d.value1("string"==typeof i?f.trim(i):i),d.value2("string"==typeof a?f.trim(a):a),d.text(s),d.formula(l),d.type(u),d.rank(c)}f.inherit(t,e);var n=["ruleType","style","operator","value1","value2","text","formula","type","rank","priority","stopIfTrue","ranges"],r={operator:J("operator",d),value1:J("value1",d),value2:J("value2",d),text:J("text",d),name:J("name",d),formula:J("formula",d),type:J("type",d),rank:J("rank",d),priority:J("priority",1),cellValueRuleCreateCondition:function(){var e,t,n,r,o,i,a=this,s=a.value1(),l=a.value2(),u=a._isFormula(s)?T(s,"="):d,c=a._isFormula(l)?T(l,"="):d,f=a.operator(),p=d,h=!1;if(6===f)return e=re(11,3,s,u),e.treatNullValueAsZero(h),t=re(11,5,l,c),t.treatNullValueAsZero(h),o=re(0,1,d,d,d,d,d,e,t),n=re(11,5,s,u),n.treatNullValueAsZero(h),r=re(11,3,l,c),r.treatNullValueAsZero(h),i=re(0,1,d,d,d,d,d,n,r),re(0,0,d,d,d,d,d,o,i);if(7===f)return e=re(11,4,s,u),e.treatNullValueAsZero(h),t=re(11,2,l,c),e.treatNullValueAsZero(h),o=re(0,0,d,d,d,d,d,e,t),n=re(11,2,s,u),n.treatNullValueAsZero(h),r=re(11,4,l,c),r.treatNullValueAsZero(h),i=re(0,0,d,d,d,d,d,n,r),re(0,1,d,d,d,d,d,o,i);p=f;var m=re(11,p,s,u);return m.treatNullValueAsZero(h),m},_isFormula:function(e){return!k(e)&&"="===e[0]},specificTextRuleCreateCondition:function(){var e,t=this.operator();switch(t){case 2:e=2;break;case 3:e=4;break;case 0:e=6;break;case 1:e=7;break;default:e=0}var n=this.text(),r=d;n&&"="===n[0]&&(r=n);var o=re(2,e,n,r);return o.ignoreCase(!0),o.useWildCards(2!==t&&3!==t),o},formulaRuleCreateCondition:function(){var e=this,t=e.ranges(),n=re(4,d,d,e.formula()&&""!==e.formula()?e.formula():d,4);if(t&&W(t)>0){for(var r=t[0].row,o=t[0].col,i=1;i<t.length;i++)r=r>t[i].row?t[i].row:r,o=o>t[i].col?t[i].col:o;r=-1===r?0:r,o=-1===o?0:o,n._baseRow=r,n._baseCol=o}return n},dateOccurringRuleCreateCondition:function(){return re(6,d,this.type(),d,d)},top10RuleCreateCondition:function(){return re(8,d,this.rank(),d,d,this.type(),this.ranges())},uniqueRuleCreateCondition:function(){return re(9,d,!1,d,d,d,this.ranges())},duplicateRuleCreateCondition:function(){return re(9,d,!0,d,d,d,this.ranges())},averageRuleCreateCondition:function(){return re(10,d,d,d,d,this.type(),this.ranges())},createCondition:function(){return this[te[this.ruleType()]+"CreateCondition"]()},reset:function(){var e=this;switch(e.ranges(d),e.condition(d),e.style(d),e.stopIfTrue(!1),e.priority(1),e.operator(6),e.value1(d),e.value2(d),e.text(""),e.formula(d),e.type(0),e.rank(10),e.ruleType()){case 1:e.operator(6);break;case 2:e.operator(0);break;case 4:e.style(0);break;case 5:e.type(0),e.rank(10);break;case 8:e.type(0)}},toJSON:function(){return Z.call(this,n)},fromJSON:function(e,t){Q.call(this,n,e,t)}};return f.extend(t.prototype,r),t}(oe);s.NormalConditionRule=ie;var ae=function(){function e(e,t){this.type=e,this.value=t}return e}();s.ScaleValue=ae;var se=function(e){function t(t,n,r,o,i,a,s,l,u,c,f){e.call(this,t,d,f);var p=this;p.lowestValueCached=d,p.highestValueCached=d,p.cached=!1,p._oldRanges=d;var h=n,m=r,g=o,_=i,v=a,y=s,b=l,w=u,C=c;arguments.length<=1&&(h=1,m=d,g=F(255,248,105,107),_=4,v=50,y=F(255,255,235,132),b=2,w=d,C=F(255,99,190,123)),p.minColor(g),p.minValue(m),p.minType(h),p.midColor(y),p.midValue(v),p.midType(_),p.maxColor(C),p.maxValue(w),p.maxType(b)}f.inherit(t,e);var n=["ruleType","ranges","minType","minValue","minColor","maxType","maxValue","maxColor","midType","midValue","midColor","priority"],r={stopIfTrue:function(){return!1},minValue:J("minValue",d),minType:J("minType",5),minColor:J("minColor",d),midValue:J("midValue",50,d,function(e){var t=this;if(t._evaluator){if(2===t.midType())return t._getHighestValue(t._evaluator);if(1===t.midType())return t._getLowestValue(t._evaluator)}return e}),midType:J("midType",d),midColor:J("midColor",d),maxType:J("maxType",7),maxValue:J("maxValue",d),maxColor:J("maxColor",d),isScaleRule:function(){return!0},createCondition:function(){return d},_calculateLowestValueEx:function(e){var t=re(8,d,d,d,d,1).getTopValues(e,1,this.ranges());return W(t)>0?t[0]:d},_calculateHighestValueEx:function(e){var t=re(8,d,d,d,d,0).getTopValues(e,1,this.ranges());return W(t)>0?t[0]:d},_cloneRanges:function(e){for(var t,n=[],r=W(e),a=0;a<r;a++)t=e[a],n.push(L(t.row,t.col,o(t),i(t)));return n},_rangesChanged:function(){var e=this._oldRanges,t=this.ranges();if(!e)return e=this._oldRanges=this._cloneRanges(t),!1;var n=W(e),r=W(t);if(n!==r)return!0;for(var o=0;o<r;o++)if(!e[o].equals(t[o]))return!0;return!1},_tryCache:function(e){var t=this;t._rangesChanged()&&(t._clearCache(),t._oldRanges=t._cloneRanges(t.ranges())),!1===t.cached&&(t.lowestValueCached=t._calculateLowestValueEx(e),t.highestValueCached=t._calculateHighestValueEx(e),t.cached=!0)},_clearCache:function(){this.lowestValueCached=d,this.highestValueCached=d,this.cached=!1},_calculateFormula:function(e,t,n,r){if(r&&r.length>0){var o=e._getCalcServiceInternal();if(!o)return d;var i=o.parse(e._getSheetSource(),r,t,n);return o._evaluateParsedFormula(e._getSheetSource(),i,Y(t,n),!1)}return d},_isFormula:function(e){return e&&"="===e[0]},_trimFormula:function(e){return k(e)||""===e?d:"="===e[0]?e.substr(1):e},_calculateValue:function(e,t,n,r){if(this._isFormula(r))return this._calculateFormula(e,t,n,this._trimFormula(r.toString()));var o={};return S(r,o)?o.value:NaN},_getHighestValue:function(e){return this._tryCache(e),this.highestValueCached},_getLowestValue:function(e){return this._tryCache(e),this.lowestValueCached},_calculatePercent:function(e,t,n,r){var o=this._calculateValue(e,t,n,r);if(!isNaN(o)&&0<=o&&o<=100){var i=this._getLowestValue(e),a=this._getHighestValue(e);if(typeof i!==h&&i!==d&&typeof a!==h&&a!==d)return i+(a-i)*o/100}return d},_calculatePercentile:function(e,t,n,r){var o=this._calculateValue(e,t,n,r);if(!isNaN(o)&&0<=o&&o<=100){for(var i=0,a=this.ranges(),s=W(a),l=0;l<s;l++){var u=this._createExpression("PERCENTILE",[e._getActualRange(a[l]),o/100]),c=e._getCalcServiceInternal(),f=c.unparse(d,u,t,n),p=c.parse(e._getSheetSource(),f,t,n),h=c._evaluateParsedFormula(e._getSheetSource(),p,Y(t,n),!1),m={};i+=S(h,m)?m.value:0}return i/s}return d},_getActualValue:function(e,t,n,r,o){var i=this;switch(r){case 6:return i._isFormula(o)||(o="="+o),i._calculateValue(e,t,n,o);case 2:return i._getHighestValue(e);case 1:return i._getLowestValue(e);case 0:return i._calculateValue(e,t,n,o);case 3:return i._calculatePercent(e,t,n,o);case 4:return i._calculatePercentile(e,t,n,o);case 7:var a=i._getHighestValue(e);return a<0?0:a;case 5:var s=i._getLowestValue(e);return s>0?0:s;default:return d}},_evaluate2Scale:function(e,t,n){return e===t&&e===n?1:e<=t?0:e>=n?1:(e-t)/(n-t)},_evaluateColor:function(e,t,n){if(0<=e&&e<=1){var r=N._fromString(t),o=N._fromString(n),i=r.a*(1-e)+o.a*e,a=r.r*(1-e)+o.r*e,s=r.g*(1-e)+o.g*e,l=r.b*(1-e)+o.b*e;return F(parseFloat(i/255),parseInt(a,10),parseInt(s,10),parseInt(l,10))}return d},_createExpression:function(e,t){if(!D)return d;var n=z.findGlobalFunction(e);if(n){for(var r=[],o=W(t),i=0;i<o;i++)r[i]=X(t[i]);return new c._createFunctionExpression(n,r)}return d},_onRowsAdded:function(t,n){e.prototype._onRowsAdded.call(this,t,n),this._clearCache()},_onColumnsAdded:function(t,n){e.prototype._onColumnsAdded.call(this,t,n),this._clearCache()},_onRowsRemoved:function(t,n){e.prototype._onRowsRemoved.call(this,t,n),this._clearCache()},_onColumnsRemoved:function(t,n){e.prototype._onColumnsRemoved.call(this,t,n),this._clearCache()},scaleEvaluate:function(e,t,n,r){var o=this;if(o._tryCache(e),o.contains(t,n)){if(k(r))return d;try{var i=C(r),a=o._getActualValue(e,t,n,o.minType(),o.minValue()),s=o._getActualValue(e,t,n,o.midType(),o.midValue()),l=o._getActualValue(e,t,n,o.maxType(),o.maxValue());if(a>l)return d;if(isNaN(s)){if(!isNaN(a)&&!isNaN(l))return o._evaluate2Scale(i,a,l)}else if(!isNaN(a)&&!isNaN(l))return i<a?0:i>=l?2:a<=i&&i<=s?o._evaluate2Scale(i,a,s):1+o._evaluate2Scale(i,a,l)}catch(e){return d}}return d},twoScaleRuleEvaluate:function(e,t,n,r){if(!k(r)){var o={},i=w(r)&&S(r,o)?o.value:NaN;if(isNaN(i))return d;var a=this,s=a._getActualValue(e,t,n,a.minType(),a.minValue()),l=a._getActualValue(e,t,n,a.maxType(),a.maxValue());if(!k(s)&&!k(l))return o=a._evaluate2Scale(i,s,l),a._evaluateColor(o,a.minColor(),a.maxColor())}return d},threeScaleRuleEvaluate:function(e,t,n,r){var o=this;if(o._evaluator=e,!k(r)){var i={},a=w(r)&&S(r,i)?i.value:NaN;if(isNaN(a))return d;var s=o._getActualValue(e,t,n,o.minType(),o.minValue()),l=o._getActualValue(e,t,n,o.midType(),o.midValue()),u=o._getActualValue(e,t,n,o.maxType(),o.maxValue());if(!k(s)&&!k(u)&&!k(l))return s>u?d:a<=s||s===u?a>=u?o.maxColor():o.minColor():a>=u?o.maxColor():s<=a&&a<=l?(i=o._evaluate2Scale(a,s,l),o._evaluateColor(i,o.minColor(),o.midColor())):(i=o._evaluate2Scale(a,l,u),o._evaluateColor(i,o.midColor(),o.maxColor()))}return d},evaluate:function(e,t,n,r){return this[te[this.ruleType()]+"Evaluate"](e,t,n,r)},_init:function(){var e=this;e.minValue(d),e.minType(1),e.midValue(50),e.midType(4),e.maxValue(d),e.maxType(2),10===e.ruleType()&&(e.minColor(F(0,255,255,255)),e.maxColor(F(255,99,190,123))),11===e.ruleType()&&(e.midValue(50),e.midType(4),e.minColor(F(255,248,105,107)),e.midColor(F(255,255,235,132)),e.maxColor(F(255,99,190,123)))},reset:function(){var e=this;e.ranges(d),e.condition(d),e.style(d),e._init(),e._evaluator=d,e.stopIfTrue(!1),e.priority(1)},toJSON:function(){return Z.call(this,n)},fromJSON:function(e,t){Q.call(this,n,e,t)}};return f.extend(t.prototype,r),t}(oe);s.ScaleRule=se;var le=function(e){function t(t,n,r,o,i,a){var s=t,l=n,u=r,c=o,f=i;0===arguments.length&&(s=5,l=d,u=7,c=d,f=F(255,99,142,198)),e.call(this,12,s,l,d,d,d,d,u,c,d,a),this._init(f)}f.inherit(t,e);var n=["ruleType","ranges","gradient","color","showBorder","borderColor","dataBarDirection","negativeFillColor","useNegativeFillColor","negativeBorderColor","useNegativeBorderColor","axisPosition","axisColor","showBarOnly","minType","minValue","maxType","maxValue","priority"],r={gradient:J("gradient",!0),color:J("color",d),showBorder:J("showBorder",!1),borderColor:J("borderColor","black"),dataBarDirection:J("dataBarDirection",0),negativeFillColor:J("negativeFillColor","red"),useNegativeFillColor:J("useNegativeFillColor",!0),negativeBorderColor:J("negativeBorderColor","black"),useNegativeBorderColor:J("useNegativeBorderColor",!1),axisPosition:J("axisPosition",0),axisColor:J("axisColor","black"),showBarOnly:J("showBarOnly",!1),_init:function(e){var t=this;t.gradient(!0),t.color(e),t.showBorder(!1),t.borderColor("black"),t.dataBarDirection(0),t.negativeFillColor("red"),t.useNegativeFillColor(!0),t.negativeBorderColor("black"),t.useNegativeBorderColor(!1),t.axisPosition(0),t.axisColor("black"),t.showBarOnly(!1)},reset:function(){var e=this;e.ranges(d),e.condition(d),e.style(d),e._init(F(255,99,142,198)),e.stopIfTrue(!1),e.priority(1),e.minValue(d),e.minType(5),e.midValue(d),e.midType(d),e.maxValue(d),e.maxType(7),e.minColor(d),e.midColor(d),e.maxColor(d)},_calcuteMaxMinValue:function(e,t,n,r){var o=this,i=d,a=r?o.maxType():o.minType(),s=r?o.maxValue():o.minValue();if(6!==a&&4!==a)return o._getActualValue(e,t,n,a,s);for(var l=0;l<W(o.ranges());l++)if(o.ranges()[l].intersect(t,-1,1,-1)&&(i=o.ranges()[l])){var u=i.row,c=i.col;return u=-1===u?0:u,c=-1===c?0:c,o._getActualValue(e,u,c,a,s)}},_evaluateNoneScale:function(e,t,n,r){return r=0,e>=n&&e>t?[1,r]:e<=t&&e<n?[0,r]:n===t?[.5,r]:[(e-t)/(n-t),r]},_evaluateMidScale:function(e,t,n,r){r=.5;var o=v(n-t);if(n>0&&t>=0)return n===t?[.5,r]:e>=n?[.5,r]:e<=t?[t/n*.5,r]:[.5*v(e/n),r];if(n>0&&t<0){var i=n>v(t)?.5:n/o,a=n>v(t)?t/o:-.5;return e>0?e>=n?[i,r]:[e/n*i,r]:e<0?e<=t?[a,r]:[e/t*a,r]:[0,r]}return n<=0&&t<0?n===t?[-.5,r]:e>=n?[-n/t*.5,r]:e<=t?[-.5,r]:[-e/t*.5,r]:0===n&&0===t?[0,r]:(r=-1,[-1,r])},_evaluateAutoScale:function(e,t,n,r){var o=v(t),i=v(n),a=v(n-t);if(n>0&&t>=0||n<=0&&t<0){var s=_(o,i),l=g(o,i),u=v(e),c=t<0?-1:1;return r=t<0?1:0,u<=l&&u<s?[0,r]:u>=s&&u>l?[c,r]:l===s?[.5*c,r]:[c*(e-t)/a,r]}return n>0&&t<0?(r=v(t)/a,0===e?[0,r]:e>=n?[1-r,r]:[_(e,t)/a,r]):0===n&&0===t?(r=.5,0===e?[0,r]:[.5*c,r]):(r=-1,[-1,r])},_evaluateScale:function(e,t,n,r){var o=this;return 0===o.axisPosition()?o._evaluateAutoScale(e,t,n,r):1===o.axisPosition()?o._evaluateMidScale(e,t,n,r):o._evaluateNoneScale(e,t,n,r)},evaluate:function(e,t,n,r){if(!k(r)){var o={},i=w(r)&&S(r,o)?o.value:NaN;if(isNaN(i))return d;var a=this,s=a._calcuteMaxMinValue(e,t,n,!1),l=a._calcuteMaxMinValue(e,t,n,!0);if(I(s,Date)&&(s=V._toOADate(s)),I(l,Date)&&(l=V._toOADate(l)),!k(s)&&!k(l)){if(s>l){var u=l;l=s,s=u}var c,f=a._evaluateScale(i,s,l,c);if(!f||W(f)<2)return d;var p=f[0];c=f[1];var h=i<0&&a.useNegativeFillColor()?a.negativeFillColor():a.color(),m=i<0&&a.useNegativeBorderColor()?a.negativeBorderColor():a.borderColor(),g=a.axisColor();return h=G._getColor(e,h),m=G._getColor(e,m),g=G._getColor(e,g),{fillColor:h,borderColor:m,showBorder:a.showBorder(),axisColor:g,isGradient:a.gradient(),direction:a.dataBarDirection(),axisLocation:c,scale:p,showBarOnly:a.showBarOnly()}}}return d},toJSON:function(){return Z.call(this,n)},fromJSON:function(e,t){Q.call(this,n,e,t)}};return f.extend(t.prototype,r),t.paintDataBar=function(e,t,n,r,o,i){var a=new u.Rect(n+2,r+2,o-4,i-4),s=a.x,l=a.y,c=y(v(a.width*t.scale)),f=a.height;if(0===t.axisLocation)t.scale<=0&&(c=0);else if(1===t.axisLocation)t.scale<0?s=s+a.width-c:c=0;else{var d=y(a.width*t.axisLocation+s)+.5,p=a.y,h=1,m=i-2;e.lineWidth=h,e.strokeStyle=t.axisColor,e.beginPath();for(var g=0;g<=m;g+=2)1===t.direction?(e.moveTo(2*n+o-d,p+g),e.lineTo(2*n+o-d,p+g+1)):(e.moveTo(d,p+g),e.lineTo(d,p+g+1));e.stroke(),t.scale>0?s=d+h:t.scale<0?s=d-c:c=0}t.showBorder&&(s=y(s)+.5,c-=1,l+=.5,f-=1);var _=s,b=s+c;if(1===t.direction&&(_=2*n+o-s-c,b=2*n+o-s),c>=0&&f>=0){var w=t.fillColor;if(t.isGradient){var C=.9;w=e.createLinearGradient(_,l,b,l);var S=N._fromString(t.fillColor),x=F(S.a,y(255*C+S.r*(1-C)),y(255*C+S.g*(1-C)),y(255*C+S.b*(1-C))),T=t.scale<0?1-C:C,E=t.fillColor,M=t.scale<0?1:0;1===t.direction?(w.addColorStop(T,E),w.addColorStop(M,x)):(w.addColorStop(T,x),w.addColorStop(M,E))}e.fillStyle=w,e.fillRect(_,l,c,f),t.showBorder&&c>0&&f>0&&(e.strokeStyle=t.borderColor,e.strokeRect(_,l,c,f))}},t}(se);s.DataBarRule=le;var ue=function(){function e(e,t,n){this.isGreaterThanOrEqualTo=e,this.iconValueType=t,this.iconValue=n}return e}();s.IconCriterion=ue;var ce=function(e){function t(t,n){var r=t;0===arguments.length&&(r=0),e.call(this,13,d,d,d),this.ranges(n),this._init(r)}f.inherit(t,e);var n=["ruleType","ranges","iconSetType","iconCriteria","showIconOnly","reverseIconOrder","priority"],r={_initIconSetType:function(e){var t=this;t.iconSetType(e,!1),t.iconSetType()>=0&&t.iconSetType()<=9?(t._iconCriteria=new Array(2),t._iconCriteria[0]=new ue(!0,4,33),t._iconCriteria[1]=new ue(!0,4,67)):t.iconSetType()>=10&&t.iconSetType()<=14?(t._iconCriteria=new Array(3),t._iconCriteria[0]=new ue(!0,4,25),t._iconCriteria[1]=new ue(!0,4,50),t._iconCriteria[2]=new ue(!0,4,75)):t.iconSetType()>=15&&t.iconSetType()<=19?(t._iconCriteria=new Array(4),t._iconCriteria[0]=new ue(!0,4,20),t._iconCriteria[1]=new ue(!0,4,40),t._iconCriteria[2]=new ue(!0,4,60),t._iconCriteria[3]=new ue(!0,4,80)):t.iconSetType()>19&&(t._iconCriteria=[])},_init:function(e){this.showIconOnly(!1),this.reverseIconOrder(!1),this._initIconSetType(e)},_modifyIconIndex:function(e){var t=W(this._iconCriteria)+1;return this.reverseIconOrder()&&t>2?t-1-e:e},_getActualValue:function(e,t,n,r){var o=this,i=o._iconCriteria[r];if(i)switch(i.iconValueType){case 7:case 1:return o._calculateValue(e,t,n,i.iconValue);case 4:return o._calculatePercent(e,t,n,i.iconValue);case 5:return o._calculatePercentile(e,t,n,i.iconValue);default:return d}},evaluate:function(e,t,n,r){var o=this,i=r;if(k(i))return d;var a={},s=w(r)&&"boolean"!=typeof i&&S(r,a)?a.value:NaN;if(isNaN(s))return d;var l=0,u=o.iconSetType(),c=o._iconCriteria;if(u>=15?l=5:u>=10?l=4:u>=0&&(l=3),!c)return 0;for(var f,p=0,h=l-1;h>0;h--)if(h<W(c)+1&&(f=c[h-1],!k(f&&f.iconValue))){var m=o._getActualValue(e,t,n,h-1);if(!k(m)){var g=f.isGreaterThanOrEqualTo?s>=m:s>m;if(s<Number.MAX_VALUE&&g){p=h;break}}}return{iconSetType:u,iconIndex:o._modifyIconIndex(p),showIconOnly:o.showIconOnly()}},reset:function(){var e=this;e.ranges(d),e.condition(d),e.style(d),e.showIconOnly(!1),e.reverseIconOrder(!1),e.iconSetType(0,!1),e._iconCriteria=d,e.stopIfTrue(!1),e.priority(1),e.minColor(d),e.minValue(d),e.minType(5),e.midColor(d),e.midValue(d),e.midType(d),e.maxColor(d),e.maxValue(d),e.maxType(7)},iconSetType:J("iconSetType",0,function(e){this._initIconSetType(e)}),reverseIconOrder:J("reverseIconOrder",!1),showIconOnly:J("showIconOnly",!1),iconCriteria:function(){return this._iconCriteria},toJSON:function(){return Z.call(this,n)},fromJSON:function(e,t){Q.call(this,n,e,t)}};return f.extend(t.prototype,r),t.paintIconSet=function(e,n,r,o,i,a,s,l){function u(){var t=arguments,n=t[0],r=t[1],o=t[2],i=t[3],a=t[4];if(l._getState(n)){var s=l._getImage(n);5===W(t)?e.drawImage(s,r,o,i,a):e.drawImage(s,r,o,i,a,t[5],t[6],t[7],t[8])}else l._addImage(n)}var c=r+1,d=o+2,p=16,h=16;n.showIconOnly&&(1===s.hAlign?c=r+i/2-p/2:2===s.hAlign&&(c=r+i-p-2)),1===s.vAlign?d=o+a/2-h/2:2===s.vAlign&&(d=o+a-h-2);var m=t.getIcon(n.iconSetType,n.iconIndex);try{m&&l&&("string"===f.getType(m)?u(m,c,d,p,h):u(m.image,m.x,m.y,m.w,m.h,c,d,p,h))}catch(e){}},t._getImageSrc=function(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAQgCAYAAADvxtzfAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwgAADsIBFShKgAAANyVJREFUeF7tfQl8TFf7/6CvVsXaIkqrtVZqKxq0SCyxxxpr0ailtUYoYilCrLWEqC0h9i2xJyKSEJSiUcQWW4tGFRFEJJlkMs//+Z577yzJzGQm+v5/fd93ns/n+7nnnvN8v2e59z5z7ty5Z1R/u7m4uDR1dXWlFi1aDJOzrDeFfPv2bbJZxJCswGqRnOSYmJg8RZjjgTKxk5MMREVHmRVRyDoBzmhnKBIVFU2RR45QRMThXCIKWckTArCcIhERERQeFk4HDhwwEgFu3bqVnksAllPkwP4DtHfvXgoNDdHlGSKXACynSEhIKO3YsYO2bt1KGzdtovXB6ykwMNC8ACynCMibNm2k4PUSefXq1ZYFYIYiIK8PDtaRf/zxR6sEdOeG0myFvDxguWUBQzKgI69cSQHLA8jff5l5Ac50MSRbQi6Bnj17FkKmLZCpdjM0UwNlCTJNb3wO6C7XvGBSAKaIKJctAswRjg+HDh2i/fv3U4h8dZoVgBm2JDIyksLDw2nf3n20a9cu2rJlS94CiD6KQNjBg7R3zx7auWMnbd68mdavW2dZwJAM7N4dStu3b6dNGzdSUFAQreRrwqxATnJoaCht27aNNmzYQGsD1/LVuJKWLfM3LZCTrPQ3eH2wLs8QRgI5yTu4v5u4v+vk/ioEQx+dQE6y0t9A7q+hMx+ZdoaxQidgSNb1d60UOA3JwplNEdEJGKoCa9asMUtWjPNF4JF3c4tYIiuGACQnJTMUyYts1hSRfJHt9k+xlLUuHi8DmxPj5KMVLg5ytnUmyEEuROnXKWXN57aJGJIVvFjlbJ1ITrL2N2+9yIp6JkVeBroEpaxuLF1MLwObGZEF7ozR5T33/8RIhNPBzxZUpBcrG0oCogVrmuhFmKy9PZLxjV5kcVUhAnLy/Aoi78WKuvrLGSIpqz7Ti4B8czDRjYG6vGcLP6Dk+e+R9uWldOw/X1ZTLwCDyIuAunqRmwOIEvqQ9noPXZ4hnnGrZKreIPLcv6bOSXutO9E1d6LLbYniWxBdakp00VkS+KFSbgEYRJ4trqIXudKWtPEtZXIjogv1RX7yvPKmBWBChEdaCMhkrSB/StrztUX+U793zQukrnWplzy/vNQKmaxFzb8y+bzUxaezipsWkMjvSWQANf/KZNQcx+Rfqon8pJlvmxjEda4uuprzwJPphXMLvPixPr0IqMNnX01xmDDSyQsqUPLcMpQ8uxQ99S1GSTOKUNL3henJ1ILmx+B/2XCN4zLFlYaLRTeQfNbhxMGxx+HDETA5iAgUyhmYF3AkZJqxKde8ctlKAWYUaW8N5cubr9BrHpIAH06ZktskEelsVMhaJmuv9SDt1Q4iH+eE7G5sCF2IPgggQkCuWcs1a68wGZc15+PEkil6U8gIYXASAmg2ggpqBvliY0mAz06ZJpmOzEFUT+5vVLOWydrz9SQBPsVlqp6MMK4jJ3Czr/OAgSznGUIXkXRk/iBRCkWzMdoGZBxewytVFxNBxkeZUpBztCXnKoQoZRgrcMUqAsZkbrbos5wHR5CFM5sSrXDZiwwUGn20GZAR5g3JiiHwIHbIu7lFAHzQmCKbNUMRfNTZRFZMiPCHbb7Idvs3WIl1Dh4l1xWNKx74tu0zd5BLrCt675vY4VR8zduJxVfYIGJIXnEhiLAttvytxLcXWyGSk9zuWCedSNEfCie+PfdN8yKG5ICLgdQ6pr2AGwP7yH9r1r8S35xhQsSIfGkNuUS65cLyS2uFSOFpbyS+6VNIL2JIXh6/mh1X0zJGk3BXhovYIh95KIPfG98VSizkLYvwoaISgYw1Ran4yrep2yl38o9fSZ/u/5zqy/C/vFLkF570Bv1rfCF6w7sgFRptZn7gsPQtWnplBTmFNqRPQj8jp92f8X4AFfZ5wzQhpxX94S1acnUZVdlRl6pur8Ooy/vL0WzrBN6e9yYtvuZP72+uSe9vceKtEy25tpQKjbVySlNkdmFalLCEym2oRuWCq1FZBvYLjbJS4K0ZhemHG4uoVNBHVHrdR2K7iPcLDi9gnUDhqW+wwA9UfO0HOmC/wDfWCkwqRAtvLsyFAkNV1gn8i0cbA4bjjGYX+JYB8mArBexm+TtF2cWywdHwyxgFNgsoDyuAfAlERUXRkagjdOSI9LTDZoGIQ4cE8E1mvgQOHDwgnnAoTzlsFti9e7cO+RLAk40d2yWYFTD3hTwImzdtok2MzZs26wRyQogoX3+dOXNGOCrAl5HrghgGX0oC8IM/eEIAllNk9epVtGr1avFgQoFZsmI5RQJWBFBAwAqxzZOsWE6Rpf7SN7hWkRXLKWITWTFDEZvJiiki+SLbTW/KIPI1U1jOss0g8FoiIBueCzaLgJjzbDQSQWZegIBZEUMHSwiUHxfkElEETp0+TcdPnKDomGg6FBEhPU8KCRHPWzdsCGaBtbRq5apcIiYEYsQz5/0HJIFtEBDPWyGwklYEGMcGvcApFjgutUAIyC2AQHDwBrkF0uMhky3IC6bGQDeIeUERyUW2xhSBfJFhIOWbDAMx32TYa5FhfLYZPwqym3WGyxQjn68jYEi2+QTKSbbpFDZFxjzRKhFTZMwNxRyRY4NFEVNkZW6o4CDPF82K5CQryDlHVJBLBDs5AUdpfrjdaI6YE9z63NcJCkDYvFmaH27irSIgu1g2RSAIc8R1QQL5Eli9ynh+aLOANEeUkC8B/6VLeY64lPzleaLNAosXL9YhXwI5YZOAOcgudrPGHgz7ksxBdrFsfwzuQ3TnTi5YLXB3YHdByAoJ1QH797/ubZ3A7T7ukgDHgqxtOyhz23ax/3v/btYJ3OjRRhAyN26izA0SsH+zZ3vrBK65uwqCek0QqXlupF4TKPavd25pncDldl8IQsayFZSxPIC3AWL/cvum1glccmssCOkLf6CMBYsYP4h95Msuervi4uRw+YtamguNaz6EA4DDBUKa72xK9/VjzBb7yD/a+BOBsHJvvTzw7hsJQuSScw0PEFOjDgtHBWlTpgm8mjzNKD9x5TIKr+5Ie0v+q7YQgJ2p/ZHHL80+pZeRh4TTq/ETGBNlID1B5P+hI6v0ZMVO1HD0+Mm5JqVEhEsio8cKpDIE+Ud/82TFoj8o7QGnF4cOClLq8FHG5KIWyIodciwiRJ6HH7C+5py2r3Qhj32lCj2+7jPW+ppz2u4SKtESm2q2W25LXd+SHk1W5f+p18v1LpQS+HlWvkVeBjWjjMshlBL0Rf5EXq7l4JJ+XRIJNCHy1NeBnvqVpuR5ZSl5QUV6trgyPfevQS8CalPKygaCqDx/NCmSNLOIzsESxMNr3uYSefJ9YcnpXCXpxxnna5MWP1S55CI98cUDazyHxaPzO3xl5hRJmvaGTkAbV50F6pD2gjNp4zkyX20vfkYjHiFD4PYo3U+NhMjqxq9USVMLGrfgV24BC9AlV+nhrWELWEDfgqaaRz6qdqonU1SSQB4wGoPVzhJZjAELPJlSgJ5wV5Kmv0U4KniqnzwXR6WCICgiSD//sZ6ebI09W/i+jvzMv6ZtZBiecAvyDx/aTobhNwZP5znmjwxL9itF+SbbLf9WhOHJCGHEyUAaeSizaM6MhOrVq1OvXr1o2rRpAkgjD2Wyj0nzKlKkiGb8+PEUGxsrgFtfQNlHGXzgK1H05la0aFENfk4NR/zIecWKFTRr1iyazViwYIH4pTTK4ANfcCSqZPFo6rFjx2jVqlXk5+dHM2fOpKnTptKECRPIy8uLxo4dS/Pnzxc+8AVHoqpUTcuXLy/U8TPjuXPnSuSpEnnMmDE0bNgw6t9/APXt00c8a4AvOOBCwAeDBOUlS5aQr69vDvJQGsDkHh49qEP79uTNLYEvOOBCwB9NxA/b0cRpCnm0XPOA/tSjh0Ru4eJCLfjeCb7ggAsBPzhitOfNm0cTDZo9QCF3aM83XS7UyNmZGtSvL3xRzlxfCAxu3bq1aNaiRYtYmclDQeZmi5o76Mh1atchV24FfMFhLk4uVRk+LGp80YABQtNRs4eoGWRXHbkGn0w4nPAFB1wIwPxdZGUMZN++fUWfDcnVq1UjrzFewge+4EhUyUow4keMGCEOEe7cO7u7i2a6NGsmtkv5Xhpl8IGvzDGyCoyzzlwjfrcOZ4z2zp07RBp5KIMP4wMQTBmutnGMRFw87twKQL6QEhkTZB+rzInRUQbSdrPWFi9eXISvd89Jk3xCvL2940aOHBk3ePDQkP79+3t6eHhYPgIcSJynT5+e4OMzmcaNG0cjR42kIUOGiOuiZ8+e1KlTp4Q2bdqYjokcvryYrPGZ7CPIo0aOoiFDh/DlPIB6MblzZ3dya+NGzZo11TRs1Mg4JnIQcZv+/XTNZF3NTBY19+eae4mTqY2bGzVv3ozPxs/42qit+bjqx/qYyDXHKzWP5JqHDuEoJDe7c+fO1IZrbt68uUSuw1dljepUqVIlKSbOmDGjqb7Zxn1GzW5t2lAzQearEuTqNejDDz8kR46JpUqVaqqaxMNtasBwNbq5tdHXXLeuiAcgI6C+88475ODg4KPiQ+U/Stdng5q5z81En6Waq9eoQZU+rCTIpd8pTcWKFaO33nrLX8XXtx9GW0/uLJqtG7A6XLMgKzXryFSoUCFfFdc8WN9sJivN/oxrrss1iz5LNb9T+h09+Q3xuxxP1aBBg8p49PJQS2RltA0GrJJM5j4r5DcKCbI+Jrp3cvfHoVJGu658qKQBc6TSBjXLZEAfEznmleAzLP4zpWbus+Fo68hSs4HcMbFx48YV6tSpfdbwUJWWyW++9aZhzeZjYsWKFYvwGTbO0dEx0XjAxC+hbIuJfJI4FS5cuCMfKntMtMYmz91J5mBNuXA4dvpWLigOeZXbBWQHc7Cm/PXNlLICa8rz7GNe5XYB2cEcrCm3299hpkZXgTXleR7nvMrtArKDOVhT/jdYrRAyCzZTNSsQfDj2mH4tFwwFLI6BXYANjubABkdzEHy7/Q1manQVWFOe53HOq9wuIDuYgzXlf4OZugoVWFOOhKV4kGe5XUByMAtryu32d5ip0VXAZuoqVCD4cLR0nOFoMR7YBdjgaA5scDQHwX99M1WzAmvKkbA0BnmW2wUkB7Owptxuf4eZGl0F1pQjYfE451VuF5AczMKa8tc3U8oKrClHwmIf8yq3C0gOZmFNud3+Zjt9+nSRY8eOecbExIQciYqKi4w8EhcRERESFhHhuXPnTstPuaKPH3eOPno0AW+W4YcaypKoeCHk4MGDtP/AgYQ9e/aYfu58NDbWK+boUY1EjiaumSIOH6bwcJDDQKa9e/fhnQ4Nt8T4uXNsbKwbyGKhxegoOnwkUiIfCqeDYUyWl0XFCyF4VW3Hjh2abdu26Z87Mzle1CzIR+iwIHPNOrKoWZCxhiJ+TrF161bpuTMPWFOFHKnUjGYb1byHdoWE6slbtopfBW3cuLGpKioqxicqWu4zD1juPu+hkF1M3rmLtm8zIlNwcLCPKjIqyl+MtqiZ+wzy/v26mrGi684du2ib1GzxasrGDZtow/pg/PDFXxUZGemnb/ZB8SuXfQYDJmqWm70JZFHzBrGOZNDaIF8VH+PBumYb9Fki6waMm72FyZvEao7r162ndYFBtHbtWk8IlOGa1YK8T+rzLh15h9xnJotmo2YmBzF5zVo1d0F67sxkf5M1K2RpwGTyOvGm4drVa/XPnXft2lUiNDQ0XiyBC/I2ueZNClmqOShQR45fs2aN8XNnrrXC9h07zhoN2IaN4u1Kw5qZeJZh+rkzixTZunnrOD5UiQp5nb7mRK55An4lIrtbNh4gp6CgoI7AulXr7M+d/27rues1Xpr0vPyNl2f8tydHXBlh29qKMJAHXf6WAJtFvrw01Kv/xcHU/+IQgQEXB6cNuDhM/4Zdz7hhuX5nppjHuYFeveIGUK+4gRJ+Gaj2OP+V/tezXX7qWa/z6d6P3X/uLX5rZ2idT/X24jJS4H6qt9r9dB89uc3Jrg3cjnV+6hbbhdyOd9a4He+iE2kd29mrzfEupID31a2OuRv/brdptJvHF0faaJpFtSWgKdKRbT2bH2nrpc9jRLVRM0z/6LfBIRePBuHNNQ3DXahhmCuDt5xuoKTDXNT1w1zxYw7z5rTP2eOTvY00tfY2ptr7GhO2tXjLaXWtfc6WyYpV3VnPo3rop5rqIQ2oemh9qhZaX11tZ33ryIp9tK22x0fba2s+3F5H/eG22p3lbNvso511nSvvcjL7E0K7/Q+Yt6pIMa9insXGFAtx8CoWByCNPJTJXqatuHdxZ4cxxRNqza9N3bd7kPfx8QJIIw9l8JHdjY1r8Xp3QhnN8KhRtP0pz0oYwY830XqGso8y+MBXpklWfExxt7ITy2mW3lwuHBf+sUQEzl7nB1C3c33I41x/Gn9lMv2YuJZmXp5DZSeV04Aj01F78Xg0dWvSDvru1mT68tIg6vkrk8/2oU6ne5BzREuqtK0WtQh3p+o7G1Dbg10IHEF2GOPQ9KMZlUXN3170ovanulObE12o5bFOIo2Y8P7WT2jiuen0KiuNttzZSZ2P9iFwwGWB4j4YpLm3fxCO3572piGnRtOH22tTlZ31RI377oeTYuF/HCH3o73FwIKrcvAq7j/s8Lc08+Yc6n98mHBKzXpFLbm5bSO6093U+yIvMzuTZp6fLyppF92DwAEXo+/31YFBLDBXFEb/FSsIf6U/ogxNhkgnvnpAnSJ7i/JK3LK1f64ncJjrizEY3CrQjbY93Un1DjQVTb6ZclsQYUf/PEGf7GpMH/AgglxrdxMx2OCIk8thtEOZMhPKqoMSg2nitWlUZden9Pn+tvQo/QnNvbhEV+tH2+uK9NBzowm+4IArHQnui+uaFkK5+09fCkKNnQ1FrR/tqMsDWofJtajlYXfa8mQ7wVf0X7FSk0qVwHH9OnyIOJxjLk2gzw66UtWQ+ixQh2qGNqaRv44XZfCBLzgyXbIi3kUqOIwpdrZxwOcUcGelcF71IIgRKNLIQxl8So0pZSbgSlfiOK4hERdPx42dBJBGHpdNyPOKVIwHyKnY2GIdAaTlbLtZZf+9MXHmrTmiDD7wtSkmunGIc4lpT/3ODKYt7ANfcATZMCbOubeQ+jG5F5O7MrkjyMc7k8vRDvR5ZGsx8cKFBt9cMREBZciVEdRTNLuvnhzTgZqAfMiF6h74nBqHu3FLd+aOiesfb5T6jJpP9RCR2RU1H0HNrlSHyTX3NKJqfInjCs0VEzHaSs0go89odgNB/oLJzlR1V336kOOD2ZjYk0fb7YTc7CNu3Gwm72fybj3ZYkycnDBDrpnJXHNdJjtxzdWYbHVM7HtmkFSz3Gz02eaY6H3Zh5zDWthj4v+YubpPoGETlmORyeGMh2KxSQl7VF+rashu5g0C7JzIzhHFllegxodb0ldXh1KdjQ2J8+5xmTPDjRHLOCnT9CYLnCwZ+CEBjQ+3EgIuh9sgX80icSh3+rGW8JNpesst0JI8IRDBAtwCXAvdfulL7aM6WyvQShI43FYS2JYfgWtDpC4Igdq2CshdkAUqWdsChyXlQYjg9HDeXqi+8hMjAbdD7S0IsCMXXuWtp6qnqpBqkMqF02c572GFoBrUYEsjkB9yHt6iMDYICJGcNlhVlQlxjBjGbyxq+qo0K2BoPVXm14qzSsCS/ZcIfDthZf4F7KZS4d01oE+fPjR0kCd9NbCfeMer35cDqFcfvkPr0ZO6dOlGHTq0o1ZuralzJ3fhD+gE/P2XC3zJpJ4e3cm9Uwdq2bIlOTdqQnXq1KLKH1Wn9xzLU/GSJfDKMhVQFdQL9O3dh5Yt9ceODu+3rET1vBqS88zPqYanE5Wq9Y5ROdDFvSu2KtWQrwfTgC/7i8wi775NLX5sS/1+5aneuYHU9ee+1OEkT3tiu1DV4TWpwBtijWUB+X1Xleqrr74Sr+Uis9Wa9jTg1yH0zeUxNCLem/qeG0Rtj3cjV572fMEzl/cHVJYFClJz12aSAAasU6dOVLlzNep3fhCNuvIdBf21kXYl76ZZt+dTh+M9xLSnMd+Ef3HIjRxqFKeCqgLk6iIL9OvXj1q1akVNFrhQ73Nf0XfXp9Ke5wfoYEoEreRb/k7He9JnPGdyPtSCWh11pxoTa4tW6LrQu3dvaty4MTVf05q6nO5Nnue/pSX3Aijo4UYad3kKNYtsLyZcEMFY1JrbgFQFVOTq2lwSQP9r165N9b535v52FU4dTvSkTid6UdPIdnxL/AV9sreR6EL7E93ooxHVjbvQpUsXqlKlCpVtXp5aHO0ovsFsFNGKGhxsTvW45tr7moh5cqujnVigO735/tviPGjuKncB7zU7OjqKfjVc+QU1j24nRrwJi+BDphkLolXuP/WkGt+L/xsQwHuA4OPVPCpeXPw1ChUuWZg+W9mM2vGhAzqc7E6dfvKgtrFdqco4Jx0Z0B1GnJI4PZUCoIyrI33i14BqL/mMPvL6mN6qaFwOuHcxuBYKFCjA/VKJbSHZAfsYbeSJrZyvwOhiUoBjC7g2x7aFvG0mRhyvcKPM0F8I2O1vNu3p00U0EZGe2WHhIZr9++M0obvjMnfsDFFv2eKpzeu5szY62jn78JGE7PBDpNl/gDS795Bm5y7K2rKNsjZsoMy1gQmZq1aZvnfWHIn20hyO1GSHHaJshbxDIW9kchBlrlxNGcuWazIWLTG+d86KjnYTZK5ZIu+lLJmcCXJgEKmZrF4WQBmLl1D6vAWadN85+ntnJsdLzT5ImtAcNTM5c+UqHTlj/kJK95tLaTNmSvfOdCiqqQY17zNutlIzmq1etlxHzvCbQ+kzZlLa1O8pbdKkpipN2CEfZcCy5AHLDEaf13GzpZrVi5YyeQFlzAbZl9IFeTKljZvko+I++wuyqHkrZYGsq5nJSrMFmWue9j2lT5pCad9NpFRvb39VVsheP+OaMWByzYJsULMgc81MfuU9nl6NGeurUm/fOdi4ZkOyUrOv1GcfmTyWyV5jKXXUKE8Vn11l1MEb1FLN8qFCn+fxgBn0OV0hSzVT6sjR6pTRo6V7Z/Xadf6i2csxYPJoz56rr1lp9thxgvxq1BiufbT+3pnWrCmR4b88XjpUC/g465stDdgErhlkb0FmxCcPy/Fs7tXixRXS5y08q/RZd6i45jRudppS88gxZ9PGjDF976xdvLhI2gzfcelTpyXqmi1qxoCNTuRBm6D19rbu3jll/Hin1LHjO6aOGtuRB8t+75xPQ+jC3xEDpsOYGRtWvXr1F127dqXvvvtOAGnkoUxyMW2Ob7/99hEsZRAWFiaWLYmPjxdAGnkogw98JYqBFStW7CgWHo2OjqbHjx/L3+3rDXkogw98ZZrOhqGpR48epczMTJmS21AGEfgyZ7hEVamK8PTmGZqYlJQku5q3J0+eiO6Aw1zxEL8pBun06dOyS952/PhxMbDMbQIBz2+//ZYuX74sF+dtFy9eJHDAFQKYK1+9elUuztsuXbpE4CgCTTF1wXK31hq6K69uKrpQhI9tMv4qITU1VXYxbykpKeJvFcBhru6XEMO/+OILoZydnS275jaNRkM//fQTwRcciaq3GCym8fPPP5tsCfJAhg98JYqxYV2c2AYNGtD69euFM44McPLkSbHsD8rgI/uaNVwwT6tWrUrt2rUTQBp5cpnVlu/L2W56+4fEROwjjOU7JnKRAM5C/MTM5pjIZTpgdRKI2BQTudwIn376qW0xUSEaAkuhWR0TFZIhsPSZPSbaY6LdrDd7TJSNy3T4X42JCskQWF/R6piokAyxcOFC62OiQlKARbjwI3CrYyKX6VC4cGGxvqJNMZHzBbD0F8g2x0QsuIg/MLDHxP9Us8dE2bhMh//2mCivEWsVTMbE2bNn53I0B5MxEXEOUUdxMgeLMRHKb0gLDZqEVTERi/OaaolNMTEwMFA4Ix7aY+J/uv0fx0SELqRtjokIWfIZZwSrYiJOV8Q93jeJPGNi3bp1c5FywmxMxKWsOOUFkzFRXvrZKthjoj0m2u1vsNdejQVE4/VgbDSbBeCoQNm3WcCQ8B8ggAIFyr7NApYIOfdzWV6EnPsiQ4Eph7z2bSbk3P9vEVCQn3275cNeexBBNDqMtprNAnBUoOzbLGDxTMzL/v8LoECBsm+zgCVCzv1clhch577xei9seRFy7guBMTsfvp7A4FV3X0/AcI2bvAg594VAu5EXXk9ABzYUKLBm3275sNceRBCND6ONZrMAHBUo+zYLWD4T87D/AwET14bNAl67rA8wuY2JIzcn2iAARwXy/rC192wTMIyJ2H619I5tAoYxEds+c27YJmC07hdvu025apuAYUzEtpP3JdsEdDCxD0cFpvbtlg977UEE0fgw2mi2C5g4L2wWsBQf8jYmjtr65+sJjNhoPsDkNjgqkPeHBd63TcCwz9h+veJ32wQMYyK2A5bctiCAAgXyvmFMxLbvvJuWBSzFRGx7zrxuWcBSTMS26+QrlgUsxURsO38Xb1nAUkzEtqOX+RgpHHSwYh9EBaLcbvmwHINquzFxjOHFZrMxcfR2fYDJ2+CoQN4fufmBbQI548O3wX/YJmAYE7EdGmhwuedp7GgYE7H9eqXB1ZvLUKBA3jeMidgO9DeIF7mMCyzFRGy/XHjLsoClmIitUcARCQXyvqWYiK3HDH2IExm2xERsjSIWErbERGy7TLhsLGBLTMS20ziDfSRsiYnYth9z0VhAh/zs2y23na6oKnKshMozpqQq5GhJVRyANPJQJruZtujiKmcmJPzyeW26NWYo/bUmQABp5KEMPrK7sXGh1/H3imoeLJ1P9McfEn77TYK8jzL4wFemScaqbicqFtO8OhkrHLWXL1P2kSjSHJBfmGNknz0ryuADX3BkukoVU0IVj6bS/fukPfUzZR+SX08MZfL2HZS1cTNlBq2jLN6ne/dEt8AR5GOlVE1Pf/K+1MwLF0m8JLhvP2WFhJJm23Ymb5LeLvxxJWX4+5Mm8ojwBQdcVUwplQ8Gie7/wc0+IsiakBAmyy8Irg2kzB9/pIwl/pSxYCGpeYuWggMumu//x8LZRHd+o+y9+0izK0R6NTF4A6nXBJJ6BZMX4+XAhZQxy4/Sv59B2uvXCRxwIeB3d6YPC9yRyVspcz3IaykzYIUgp+P9Ppmc5jOFtDduEDjM9VUdLaEafLVfV9GsrF2hlLUumDJXryH18hXSW3bzFlC672xKmzZdvJ6Hd97gCw5OLtUJB1WZ4xWKqTOv8KE7cZLUq1YzeTllLFpMGXPnCXL6VCZPmkyvxk+gTD4S8AUHXHEk0JfLvTqKQ5S1Yyepf1gkkWfOkt7tm8jkcd/xUVhGdPcuwVf0X7GoUqoSnBF/f850cYiy+FCpecTTpk5jsg/3fTpl7T8oyuADX3BkumTRpVUV+BQ9e7GTK6WfOS2ctdeuCSCNPJTBh8mm3+3D1caDOo6RiIsnYciXAuJC4jyueUKeV6Ri3CInrq0jgLScbbd/q/3ernXju1066c8uE/ZbB7fm97p2WCTv6g3k5G++yUr1Hk/3unUKkrONDORnI0ZohE/XjivkbMn+GtD/Ac51wJSIQlZ8UsaM1d5s16KKXKxSYefpkMFppkRykl96jaXf3duMF0RDyykC3O/RJcwqsmKmRKwmKyZEhg7NMCSnjh1nHRkm+jx8RLahAGDu6BjZ7U6tWxn2WbyabK1ITjL6fLdLh7k5x8SkiCmy0mdTA5tLxPBEMjXaEEka/PUrxSfXiXSrTZv32SHV0qFSRED+vVO7EXK23iDyW8f2Q+VdkwaR253aDJJ37fZvs3/WPFGbkCCg7Fs9T8w6HEnpPKXBdAZAOisqSpRZnifevSf9yjkzkzJ4aqcIZPJEk7RaqYx9zM4Ts3hymXVMWpAVBIgIsmyZmD+yD3xNzBPvU/qcuaLGrJM/SQylVjaQRXfYx+Q8UXvtuq7JQPZvv8tUoqwzZ43K4JtrnojRVhwMmy1M7o5OwNw8EWsf5OqzQXcgAh+z88SssHBdv5U+AzqR7GwxiObniXyIsniyaUg2FEEZfPKeJx4My30iHYoQZTbOE68LIG2fJ/7HWlh1x3bh1R0pvEZZ4whkjSnkRzu2kM0iCvnZsWjS3rxF6Rd+tV5EISfHHn2Qfeq0uIPNPn/eOhHDmjUnTgiyAiHy63nzIjry0SjKijlKmbgB3cq3v1hsBneyjOxz51gkLreIjhxzRIR0NW62Bdbxjfc6g/0g0vBlnR73i15kl0pVCDs3p06g7MtXxL2hBL75NIKSt4y0t27RX6sChIhowaGqjk7YeRC0WoT1ND++6dRhrgwpreGBTYo+cgr+aLkQgCki2VeuUtaRKEqbPJVeTeYbT94qQPOf7dktajYiK6aI3AsOvJEVESktYwN4jSNN7Al6tnuXebJiiojmwgXKCj9EqcNHUVZ0DD3btSNvsmK6MeGByk64YbrPeZkicmPUMOtrzmmKSL7IdnsNwwpFtHy5Z/aixSGaOfPjNLNmx2mmfB+i/m6SZ54rE2mXr3LW+i9P0P6wmLLnzScmU9bU7ylr4iTK5NNZ/c3IhMzBg03PE7UBP3plL12myTYkT2PyBB8me5P62xGU8fUQSu83QJPRvbdxRNIGBLgJ8iImz51P2b6zSWNEHklqiUxpHr3pVacumpdt2uvnidn+y+KVmkHOmjadMtHsMTJ5EJO/HEDpTE5z70av2nSgV64t5bXC/P2b6sjcbMOaM9FsJmd8OZDSe3DN7l1lcit6+XkzSmnQqKlKs3CRj+gzasaACTIPGNeskNMMyKlMTv28Ob1s0JhS6jTwUXGf/QVZ1IzR1jdb1CyarZBbM7kZvWzI5LoN6PnHdfxVWb6z/dBnHXn4CKnP/bhmXZ/bU6pLa3rZBM0GuT6l1KxDL6rV9FVppk4fbDTag4ZKA8bNTuskDZhCFs3mml9IZHpRuZqnSjt5chn1aG915nCpzzhU6R69mMzNbis3uwn3Gc2uo5Cd6NmH1dQpjlXltcK+HeEvnSRKs+U+o2b9gFGKE5OrOtHzytXp+QdVDNYKGzasRFrfAfEYMP1oy2S5ZqnPTP5IkOOTK1fOsVaYh0eFNPcuZ41qVsioWfS5Oj37oMpZJptZK6yxR5GXrq3G8YAlpih9lslcc+KzDypPuF+xonXzxJR69ZxefFy344tqH3dM+aCqfZ6Yl2Fh3hHjA+hQdcfh4dUcH+LTSEK5PRE13rNunW12TgyvVi7i6eQpRHvDKDtkH931HID8ewerlXMOr1rWLax6udiwauVMr/CMAnyUqxcsIS0LaFngGV+hLKpmxKH86uCBwk+m6c1IYCEEwvUC3IKMOQtIG7qfkpcvz1sgQwgYtMBWAakFLBDKAhxYbW8Bj4EYRBZ4PmFiDoEAywJ/9uuLQYsQh7N6uQtXunUUAmpZ4PEPP5gXgCMfpqvs4InJJ89OXPhcOIvzInmiD/0xBUfE8SGXW7/O9uEqZapKh9Axhsm/YcojFxmbOQFD2+XkZF9n25KBbF9n+zVNWaX3n7XOdtcmTWj+V560YfQYmty1GzWW3vM0gsl1th1LlaLDfn6kwaPjA/spa9cuysST36B1tLCHBxUuVEgnYHKd7WhM92KiKPvCz5R98QxpIsNJjWew0oq2NLNdB1nAxDrbX7VuTVlhHM5+OUXaZ78TpdwnzaWfKXPDBkHGA9xXywKo/vvvm15neycH0ax9+yn7zAnSJv9O2hf3SPPrKb5/DqR0noxmLFoi7qUDBwwUrci1znYs912sLbt/L2lOHyPNmVjKDN1JGTzA6XPnUQaLZK4Ppv0jRppeZzuYZ2p4VC76vI7v2teulcnzKW32HHHjnblxMy3p3sP0OtvdGjTk0V4vDRju1LlG1JzGN91ovhplLFDt3XfFeWByne1Ib54nL1/BNfPtPh6ZM7CPp+H4EmLLQPGmtYDJdbZLvv02hQz9htSr1kgLEgdLRHXwRgrgpsNHgcV1tjt+Uou2ff01RfGZuLpnL6pRpoxROWBfZ/t/w0aMGOEAyLu225gxY/wAedc28/b2rjBx4sRUAGk523obPXp00L59+whAWs62zry8vOpNnTpV8+DBAwKQRp5cbNrYoQb3tx9jIeMq/uP62rVrAkgjTy7rB1+ZJpo6nTNfzpkzRywuhb9oPn/+PD18+FCs1AMgjTyUwQe+4ICLwSrCiZNYFAFrAiUkJNCZM2fFGkEghB8Kp5ijMSIPZfCBLzjgilYM4/tGzriA/3S+e/cuhXNoxz8t79u7T2zxT9Ph4WGiDD5cexw4gqwYC5RhJGCNixs3boh/WDYE8lAGH/jKNGPjgnZYOOH27du0afNm8QfJmzdvElvkYSEF+MjuuW3UqFGeG/hTCAsrhYaG0sWLF8QaukjHx18ilMFHds9t3DdfnDh//vkn/fbbb2KwAKSRhzL4yO65jQs3YZBQE4/wS95fDCCNPHkAN8nuuY37d5LxlDGdSaXlbBzq0siTy3JP9xVj9X6WLl+UwUfetZs19mhGmdeLiU9nl8p/TEzyK10heWHF/MfEp34lg9JjvPIXE5/5laiXvKSqRpsUZX1MfDLrnRpP55TslzS75MKns0tezfh5BtFfG/OOiUyYzs19+Xx1fUrd04vST/Bc8fpqouRo0v7uk3dMvL+4YpEkv5InX4V5Ej0/wbVuIO29WaS9PYq0NwZaFxOT55cqkTS71IW0qJFET0JJe60Laa+4CVgdE1PmOJThriSkH59A9DCQtL/WJPrVybaYyCdOu5QNLtyNYKIzJUl7tpRtMTHJr4Rn6t4+RPf9iM7XILo307aY+NSvlC9OHkqOpOw/9xMG1qaYyAKbMJBoxdN5777ko2NbTMThTPIr9RTnxvMZxW2PiTgTcQnLu7nMHhPzYRhQS4OapyEmAvKubabERABpOdt6U2IigLScbZ0ZxkQAaeTJxabNXEwEkEaeKGMf+Mq0vGMigDTyUAYf+IIDrumYeF8fEwXujBZxEmXwgS844IpW5IqJV5WY2EZsCVuOkyiDD1/2ceAIsmI5YyLiofZ8TYYTpzk+ch7K4ANfmWZs+pi4nojjIZ0xAMfJlI0teDBL2RYTBX7lNOehDD6ye24zFRMBpJEnnVSlbIuJANLIkwfQ9piINPJEGfvI2bktr5iIMvjIu3b7/2IVvSsWKfM6QbXspHKxZSeWixP/qmmrlZ1Ytt8XK5oSUGaiY6418iwamv3BtEoPVt8LpDX3g+j97yslc3d0Z2aeVnai47zB4UMp8NF6CnoUTEiXm1hupVxs2cpPKv/BJ/NqZW5+tI3GJ/jQuIRJtPnxNnKaV0tT5rv3LEdmWLmJjlu/PzeDZt+ZT1/+8jX1Y/jdWUDIKzfJEQtQmrcyk8o3bbG2Fa3jUO5+oje1j+1O7WJ7UNeTfWjD4y3UdGVzdKWj7J7D+FA5Ti5/cdmtFfTV2W+oUXhLRisdhsaNpkXXl5LjpPK3nGaYeFyCQ9V9hwctuLOEPg51phohn8ngdOhnVDO0ES29t4LgU25SOR+ZJhkOUeUZVZLXPdhALQ93Fv/lbApto3oQfCrPqJxaekpF/QcuDlHv0L7ib5jx/9U//L7MJIIebhA+Hjt78Vg4bpXpOO7lrr43pQI1XPqZVYAvH5GHMl26aMr7lG9gC17rIrPbv8OOOZVxCPu4fANbsNPwZwR4khnh9D791NHFKsAXT0dluvhx39Yr3/H05s4d4tsz8W6fKfCNo/C55jMWz171EepgtYoVohpWT828eIHwF3xZm7dSpsAWgSwFBw8SfNg3+bBTjhjJTfK57D2ctHyXhpfi1KvXUMaqNeJbfgVavv2FD54KyzS94ZlqeI3yt15EHaas0N2UsXARpctAOnP7Tko9fozCP37vIp4KyzRj4351PNOzI0/prlH67LmUNm0GpeF1vFmzxRj80r87116+qexu2nhAjzzavpkyQ3ZLr6F4f0eZu0IJeRhs2c28hVV7r94xlwaa7GtXKU38PnEaIX2sxWeZByqXN/M/7zkMh+j2vJmUffIn8WtRpPlcmScX5204RJF1KydnxJ2j9HNn6HCdyg9wtsrF1hkO1c892hMQXrWs7RMr8etRPHevXg5ryObP0Gyji8ZudvtnW9IcB6cns0o0sAWPZhSvKpFnlViZNLsE5QuzSszju/biJ8Wd6sMfbYI2cS0EwvjuvXhs1vnBRNf7MwbI25xQ8rEdQFpG5s8DuRXF9/PtbvHeT2aXOM1NirMFaPljv2JmJp12s9v/ud33VhV5NKWg55MpBUKeTCkYJ6FACPJQJruZtqQpKufHUwomPFtRh1IPDKaMX5YKII08lMFHdje2x9MKej2Z6aBJPzWHKP22hFdXGDy9k/dRBh/4yjTJkiYXcnviW0KjSYySnF8ck677xHlE92cyfIme7hNl8IEvODJdpeJ+xqOplH6T6MkOogeLmYw36KYT3Z3Ak8vRRLeGSGJpN0S3wBHkR1NVTZN/+ECq+VkkkxcR/YF3174n+h1knsHe4oCT0JcIX8j9yS1jX3DAVT2ZWtAHg0Tpt6Rm/+FHdG8ak79j8giim4OY3Ifoameiy2687SpaCg643PwC/uknuGmv4pk8m5s8lei38US3hzPZk0NYLya5M7kV0cUviH5tQJTyM4EDLreggF9aDDcVAnenMHksk7/hSfdXTO7J5I5E8S2Z/DmT6xOd/4To5S8EDgv4qh5PLTg4ZTv3DV24x7XfGsZkBE8PoisdmNyCyY2Z/ClRnBOnG/FA3iRwcHKp/pysKsMfFGpt8nkivkOnGxx9r3VncnsmuxJdALke0S81ic5V4Up42su+4IArjgT6krKFa+NDRPgS9kpbokvNmcy1/VqHawa5Mgtzq9ISCL6i/4olT1KVwHFNi+Uu4HDiUF1uw/0FuQaLNOTzgg8vl8EHvuDIdMn4HK/A43H2xXpX0jyMlYR4tCnltEgjD2XwYbLpOTOuNnYYx0jExfNyd18BcSFxHtc8Ic8rUrGkySqnx1MKdQSQlrPtZoul7Clc8+Xmt/oDSMvZ1ltaWMG9GdEqyohREdJytvWWduhfezOO/osApOVs6y09oujejNiipGYgLWdbb+mRpfeqT7xD6hOlCWk523pLi3IMzDxVgQCk5WzrLf3oR7Mzf67Ks7GqhLScbb1lnq71TdYvdSjrXB1CWs623rLON+qcdb4xZcUxOC1nW2+Z8a4umostKfNc82yk5ez/JEuPVg3JiFKdAZCWs603Jt0U1wIDaTnbenvtFtjtNewfNk/kmYiAvG/9PPGv9ZQa60ipx0oLpJ/iicXDtaLM8jyRJw90x0tMa1KOvEmkzSSt+k96dexdniN8xpMuniuyj/l54p8rpDlRvIskIJYsSGOBd1iAZ2fnearzx0Lha2KeyLPUaz14auMipjeSgJYo6wULlJbmSedrcxnPm3iSlXue+PKcTG4m5oMpUUWYryFtxp88reEugIwnwHEfm5knYrQxsbrYlNGEXkY7cPPVpH2VwM5lmczzQ8zUfqlubp7IXbjCM1ImY3b26mhJrvkd3hanjJOO0kwtjsmY9pmdJz7wl6d2DSn9eBk+CEmU/fw0qU++xzXzbO1cNZ6Ez7E0T+TDiEPFU9r04+9S9st40vy1gwW4BSBf50m3VfPEB0tJfbqKIKpPlqOsM1x74hJRlo95IoPT9nniP97wMtDICQH0dKbD8Ke+Dg8ZJDCz6J4ns4pZ924fkxOTfB0iNBEF+UaLrw2OSuqYjsR595JmFHdO8i3qljSzaCxvTb9VhgI6oSIBIRBM2Ze+hoCaxeNQ/mqPu/CTaXozKxAvBO7RWY5Y92ZS1qXp1grw3Sl34fUEHrGA1IV7dC6/LVAEzlayTiDrYCEQInA4eXshLfQLWUBqQWbcJEsCDvee+ha9mjSrmCftUhVK9nVw4f2zOC80RyvwtN8D58bDpzOLWf9uH743xSFkYgyfA78lzXDI/7t9NENlf7fPkoFsf7fvNU15M+if9W5ftzZVaOGkJrRpoStNHV6HmtR716gcMP1uX5miFLmRJ1t3xktTvhs8XxDf5PWgxRM+ocL/KqgTMPlu39GtHiJ40KNgxmZOT+eJRW9p+nO5Hc0ZrbxlaOLdPs8ePA+6PZZnpat5JnKV5wW3iB5v5Rb047ljGwHN5W7UwKm46Xf7QgLciG6NkCacaVdYgCdejzdx83tKU0BuASUMpLUzpT9NzfVu38ltPE/C14B3vCWRh2u4RWO45tY8e+PZGb6gu/E17VnW0PS7fZsWfC7Vhhkrvg7Et3rx+CKSyRd4rnylk5iELfSuavrdvh5tKrITvvrEV4FMxKxVnvbRRe7C9b6kTRhE1T+QzgOT7/Zd2MPNvcIfbVc6Sn1G8zGAmOLdHEqhS+oJP8Dku31lS79JcaFMuDGI4SmNCW+1CV/Txjm1dWTA4rt9vdqWp7CVjejnbU1p24K6VLtaUaNywP5un92sskczVI4WP9bzssdTC2wV94b5MdyVPp1fnp4tc3qFuxk523rju5O4jLhllHkrhO9WCuT9+xNDezK5YL/nq52JMn4XSNneVbpPtsZ44Bxwf5R1ew9pf/MWyH5yhu8Ti1+SXSzb4ykF5qFG1Ky9PYIxXKRfRXoRWia7mTbczj3h2Tlq1HIgMULKVXq6oMJDtFB2z20YrLSYSVLtHFC117rJWw6unIdBRQtld2MTX0Qs/ojo1U3SXm4tQPJWSvNnBos8W90o85GPSnpwrxj1VBXiE+ZCxnn+LGAnPMnRcijXIiIbprks6244Pfn+X+EyVTI+5sN0hy2uFtF5BfjSgSHy5DT7vNzdj7tSSHpsLg7btDcSoSwErAAGmSfld8R1In1rpXxjlQemFozlgV6jwOyXUtabSvX/AOf1iiJEERHsAAAAAElFTkSuQmCC"},t.getIcon=function(e,n){for(var r=[[160,180,80,d,d],[100,120,140,d,d],[900,920,880,d,d],[820,840,860,d,d],[780,1e3,420,d,d],[680,940,400,d,d],[800,1020,440,d,d],[740,1040,400,d,d],[720,980,380,d,d],[700,960,360,d,d],[160,40,60,80,d],[100,0,20,140,d],[220,340,460,760,d],[600,620,640,660,d],[200,680,940,400,d],[160,40,180,60,80],[100,0,120,20,140],[580,600,620,640,660],[480,500,520,540,560],[240,260,280,300,320]],o="0,",i=",16,16",a=0;a<W(r);a++)for(var s=0;s<W(r[a]);s++){var l=r[a][s];l!==d&&(r[a][s]=o+l+i)}var u=t._getImageSrc(),c=r[e][n];if(c){var f=c.split(",");return{image:u,x:f[0],y:f[1],w:f[2],h:f[3]}}return d},t}(se);s.IconSetRule=ce;var fe=function(){function e(e){this._rules=[],this._ruleTypes=d,this._cellRuleCache={},this._worksheet=e}var t={getRule:function(e){return this._rules[e]},count:function(){return W(this._rules)},_getAllRules:function(){return this._rules},_cloneToActualRanges:function(e){for(var t=[],n=this._worksheet,r=W(e),o=0;o<r;o++){var i=n._getActualRange(e[o]);t.push(i)}return t},_cloneToRanges:function(e){for(var t=[],n=this._worksheet,r=0,a=W(e);r<a;r++){var s=e[r],l=new H(s.row,s.col,o(s),i(s));0===s.row&&o(s)===n.getRowCount()&&(l.row=-1),0===s.col&&i(s)===n.getColumnCount()&&(l.col=-1),t.push(l)}return t},_resetCache:function(){if(this._cellRuleCache={},this._rules)for(var e=0;e<W(this._rules);e++)this._addCache(this._rules[e])},_clearCellRuleCache:function(){this._cellRuleCache={}},_addCache:function(e){for(var t,n,r,a,s=this,l=s._cellRuleCache,u=s._cloneToActualRanges(e.ranges()),c=s._worksheet,f=c.getRowCount(),d=c.getColumnCount(),p=0;p<W(u);p++){var h=u[p],m=h.row,g=h.col,_=o(h),v=i(h);m+_-1>=f&&(_=f-m),g+v-1>=d&&(v=d-g);for(var y=0;y<_;y++){r=y+m,t=l[r],t||(l[r]=t={});for(var b=0;b<v;b++)a=b+g,n=t[a],n||(t[a]=n=[]),n.push(e)}}},_removeCache:function(e){for(var t,n,r,a,s=this._cellRuleCache,l=this._cloneToActualRanges(e.ranges()),u=0;u<W(l);u++)for(var c=l[u],f=0;f<o(c);f++)if(r=f+c.row,t=s[r])for(var d=0;d<i(c);d++)if(a=d+c.col,n=t[a]){for(var h=[],m=0;m<W(n);m++)n[m]!==e&&h.push(n[m]);0===W(h)&&(h=p),t[a]=h}},_removeCacheByRange:function(e,t,n,r){for(var o,i,a,s=this._cellRuleCache,l=0;l<n;l++)if(o=l+e,a=s[o])for(var u=0;u<r;u++)i=u+t,a[i]=p},addSpecificTextRule:function(e,t,n,r){var o=new ie(2,r,n,e,d,d,t);return this.addRule(o)},addCellValueRule:function(e,t,n,r,o){var i=new ie(1,o,r,e,t,n);return this.addRule(i)},addDateOccurringRule:function(e,t,n){var r=new ie(4,n,t,d,d,d,d,d,e);return this.addRule(r)},addFormulaRule:function(e,t,n){var r=new ie(3,n,t,d,d,d,d,e);return this.addRule(r)},addTop10Rule:function(e,t,n,r){var o=new ie(5,r,n,d,d,d,d,d,e,t);return this.addRule(o)},addUniqueRule:function(e,t){var n=new ie(6,t,e);return this.addRule(n)},addDuplicateRule:function(e,t){var n=new ie(7,t,e);return this.addRule(n)},addAverageRule:function(e,t,n){var r=new ie(8,n,t,d,d,d,d,d,e);return this.addRule(r)},add3ScaleRule:function(e,t,n,r,o,i,a,s,l,u){var c;return c=0===arguments.length?new se(11):new se(11,e,t,n,r,o,i,a,s,l,u),this.addRule(c)},add2ScaleRule:function(e,t,n,r,o,i,a){var s;return s=0===arguments.length?new se(10):new se(10,e,t,n,d,d,d,r,o,i,a),this.addRule(s)},addDataBarRule:function(e,t,n,r,o,i){var a;return a=0===arguments.length?new le:new le(e,t,n,r,o,i),this.addRule(a)},addIconSetRule:function(e,t){var n=new ce(e,t);return this.addRule(n)},addRule:function(e,t){var n=this,r=n._worksheet;if(r){if(!e)throw new Error(K().Exp_RuleIsNull);return e.priority(t),n._rules.push(e),n._addCache(e),r._invalidate(),e}},removeRule:function(e){var t=this,n=t._worksheet;n&&(e&&(t._removeCache(e),B(t._rules,e)),n._invalidate())},_removeRange:function(e,t,n,r,a){if(!e.intersect(t,n,r,a))return[e];var s=e.row,l=e.row+o(e)-1,u=e.col,c=e.col+i(e)-1,f=t,p=t+r-1,h=n,m=n+a-1,v=[];if(-1!==s&&-1!==u&&-1!==f&&-1!==h){if(h-u>0){var y=L(s,u,o(e),h-u);v.push(y)}if(c-m>0){var b=L(s,m+1,o(e),c-m);v.push(b)}if(f-s>0){var w=L(s,_(h,u),f-s,g(m,c)-_(h,u)+1);v.push(w)}if(l-p>0){var C=L(p+1,_(h,u),l-p,g(m,c)-_(h,u)+1);v.push(C)}}return W(v)>0?v:d},removeRuleByRange:function(e,t,n,r){var o=this,i=o._worksheet;if(i){var a=[];if(o._rules){o._removeCacheByRange(e,t,n,r);for(var s=0,l=W(o._rules);s<l;s++){var u=o._rules[s];if(u&&u.ranges()&&u.intersects(e,t,n,r)){for(var c=[],f=o._cloneToActualRanges(u.ranges()),d=0,p=W(f);d<p;d++){var h=o._removeRange(f[d],e,t,n,r);h&&(c=c.concat(h))}W(c)>0?u.ranges(o._cloneToRanges(c)):a.push(u)}}}for(var m=0,g=W(a);m<g;m++)B(o._rules,a[m]);i._invalidate()}},clearRule:function(){var e=this,t=e._worksheet;t&&(e._rules.length=0,e._resetCache(),t._invalidate())},getRules:function(e,t){function n(e,t){if(t)for(var n=0;n<t.length;n++)e.push(t[n])}var r=this._rules;if(0===arguments.length||0===W(r))return r;e=e===p?-1:e,t=t===p?-1:t;var o,i,a=this._cellRuleCache,s=[];return-1!==e&&-1!==t?(i=a[e])&&(o=i[t],n(s,o)):-1===e?f.each(a,function(e,r){o=r[t],n(s,o)}):(i=a[e])&&f.each(a,function(e,t){n(s,t)}),s},containsRule:function(e,t,n){return!(!e||!j._contains(this._rules,e))&&e.contains(t,n)},_addData:function(e,t,n){var r=this;if(r._rules&&r._worksheet)for(var o=W(r._rules),i=0;i<o;i++){var a=r._rules[i];a&&(n?a._onRowsAdded(e,t):a._onColumnsAdded(e,t))}this._resetCache()},_onRowsAdded:function(e,t){this._addData(e,t,!0)},_onColumnsAdded:function(e,t){this._addData(e,t,!1)},_removeData:function(e,t,n){var r=this;if(r._rules&&r._worksheet)for(var o=W(r._rules),i=o-1;i>=0;i--){var a=r._rules[i];a&&(n?a._onRowsRemoved(e,t):a._onColumnsRemoved(e,t),a.ranges().length<=0&&(r._removeCache(a),r._rules.splice(i,1)))}this._resetCache()},_onRowsRemoved:function(e,t){this._removeData(e,t,!0)},_onColumnsRemoved:function(e,t){this._removeData(e,t,!1)},_clearCache:function(){var e,t=this._rules;if(t!==d&&W(t)>0)for(var n=0,r=W(t);n<r;n++)e=t[n],I(e,se)&&e._clearCache()},_copyRules:function(e,t,n,a,s,l,c){for(var f=[],d=[],p=[],h=this,m=h._worksheet,g=0;g<l;g++)for(var _=0;_<c;_++)for(var v=h.getRules(e+g,t+_),y=0;y<W(v);y++){for(var b=v[y],w=b.ranges(),C=[],S=0;S<W(w);S++){var x=w[S],T=m._getActualRange(x),E=T.row,M=T.col,A=o(T),k=i(T);if(U(p,x)<=-1&&x.contains(e+g,t+_)){p.push(x);var R=L(a+g,s+_,-1,-1);R.rowCount=E+A>=l+e?l-g:e<E?A:E+A-e,R.colCount=M+k>=c+t?c-_:t<M?k:M+k-t,h===n&&x.containsRange(R)||C.push(R)}}if(C.length>0){var I=f.indexOf(b);I<0?(f.push(b),d.push(C)):d[I]=d[I].concat(C)}}for(var O=0,D=f.length;O<D;O++){var P=h._createRuleFromJson(f[O].toJSON()),N=P.ranges();P.ranges(d[O]);var F=P.formula&&P.formula();if(F){var H=1===m.parent.options.referenceStyle,V=r(N),j=u.CalcEngine.formulaToExpression(m,F,V.r,V.c,H),B=r(d[O]),z=u.CalcEngine.expressionToFormula(m,j,B.r,B.c,H);P.formula(z)}n.addRule(P)}h._resetCache()},_onRulesMoved:function(e,t,n,r){for(var a=[],s=this,l=0;l<n;l++)for(var u=0;u<r;u++)for(var c=s.getRules(e+l,t+u),f=0;f<W(c);f++){for(var d=c[f],p=d.ranges(),h=[],m=0;m<W(p);m++){var v=p[m],y=s._worksheet._getActualRange(v),b=y.row,w=y.col,C=o(y),S=i(y);U(a,v)<=-1&&v.contains(e+l,t+u)&&(a.push(v),e>b&&h.push(L(b,w,e-b,S)),t>w&&h.push(L(_(e,b),w,g(e+n,b+C)-_(e,b),t-w)),t+r<w+S&&h.push(L(_(e,b),t+r,g(e+n,b+C)-_(e,b),w+S-(t+r))),e+n<b+C&&h.push(L(e+n,w,b+C-(e+n),S)))}for(var x=0;x<W(a);x++)B(p,a[x]);var T=p.concat(h);T.length>0?d.ranges(T):s.removeRule(d)}s._resetCache()},_paint:function(e,t,n,r,o,i,a,s){var l,u,c=16,f=!1,p=!1,h=s.sheet,m=s.row,g=s.col,_=h._cachePool,v=_._getConditionalFormat(m,g);if(v)l=v.i,u=v.d;else{var y=this.getRules(m,g),b=W(y);if(b>0){y.sort(function(e,t){return e.priority()-t.priority()});var w,C=d,S=d,x=d;for(w=0;w<b&&(!C||!S);w++)(x=y[w])&&(I(x,le)&&(C=x),I(x,ce)&&(S=x));if(C||S)for(C=S=d,w=0;w<b&&(!C||!S)&&!((x=y[w])&&(!C&&I(x,le)&&(C=x),!S&&I(x,ce)&&(S=x),x.stopIfTrue()&&x.evaluate(h,m,g,t)));w++);C&&(u=C.evaluate(h,m,g,t)),S&&(l=S.evaluate(h,m,g,t))}_._setConditionalFormat(m,g,u,l)}return(u||l)&&(e.save(),e.beginPath(),u&&(le.paintDataBar(e,u,n,r,o,i),f=u.showBarOnly),l&&((o<c||i<c)&&(e.rect(n,r,o,i),e.clip(),e.beginPath()),ce.paintIconSet(e,l,n,r,o,i,a,s.imageLoader),p=l.showIconOnly),e.restore()),f||p},_hasIconSet:function(e,t,n){if(k(n)||3===n)for(var r=this.getRules(e,t),o=0,i=W(r);o<i;o++)if(r[o]instanceof ce)return!0;return!1},toJSON:function(){for(var e=[],t=0;t<W(this._rules);t++){var n=this._rules[t];e.push(n?n.toJSON():d)}return 0===W(e)?p:{rules:e}},fromJSON:function(e,t){if(e&&e.rules){this._rules=[];for(var n=0;n<W(e.rules);n++){var r=e.rules[n],o=this._createRuleFromJson(r,t);o&&this._rules.push(o)}this._resetCache()}},_createRuleFromJson:function(e,t){var n=d;if(e){var r=this._getRuleTypes(),o=r[e.ruleType];o&&(n=new o,n.fromJSON(e,t))}return n},_getRuleTypes:function(){if(!this._ruleTypes){var e={};e[0]=oe,e[1]=ie,e[2]=ie,e[3]=ie,e[4]=ie,e[5]=ie,e[6]=ie,e[7]=ie,e[8]=ie,e[9]=se,e[10]=se,e[11]=se,e[12]=le,e[13]=ce,this._ruleTypes=e}return this._ruleTypes},_applyFormats:function(e,t,n,r){var o=this;if(o&&o.count()>0){var i,a=o.getRules(t,n),s=W(a),l=d;if(s>0){a.sort(function(e,t){return e.priority()-t.priority()});for(var u=0;u<s;u++)if(i=a[u]){var c=o._worksheet;if(i.isScaleRule()?10!==i.ruleType()&&11!==i.ruleType()||(l=i.evaluate(c,t,n,c.getValue(t,n,r)))&&(e||(e=new P),e.backColor===p&&(e.backColor=l)):(l=i.evaluate(c,t,n,c.getValue(t,n,r)))&&(e||(e=new P),e._compose(l,!1,1)),i.stopIfTrue()&&l)break}}}return e},_getConditionalStyle:function(e,t,n,r){var o={_hasResult:!1},i=this;if(i&&i.count()>0){var a,l=i.getRules(e,t),u=W(l),c=d;if(u>0){l.sort(function(e,t){return e.priority()-t.priority()});for(var f=0;f<u;f++)if(a=l[f]){var h=i._worksheet;if(a.isScaleRule()){if("backColor"===n&&I(a,s.ScaleRule)&&(c=a.evaluate(h,e,t,h.getValue(e,t,r)))){o._result=c,o._hasResult=!0;break}}else if((c=a.evaluate(h,e,t,h.getValue(e,t,r)))&&c[n]!==p){o._result=c[n],o._hasResult=!0;break}if(a.stopIfTrue()&&c)break}}}return o}};return f.extend(e.prototype,t),e}();s.ConditionalFormats=fe,e.exports=s},function(e,t,n){function r(e,t,n,r){var o,i;for(i=0;i<x(e);i++)if((o=e[i])&&o.row===t&&o.col===n&&o.sheetArea===r)return o;return h}function o(e,t){var n=l(e),r=e.compareType();2===n||7===n?-1===w(t,"T")&&t.push("T"):3===n?0===r&&-1===w(t,"BC")?t.push("BC"):1===r&&-1===w(t,"FC")&&t.push("FC"):-1===w(t,"V")&&t.push("V")}function i(e){var t,n=[];for(t=0;t<x(e);t++){var r=e[t];if(0===l(r)){var i=r.item1(),a=r.item2();i&&o(i,n),a&&o(a,n)}else o(r,n)}return n}function a(e){return e.getColumnCount()}function s(e,t){return e.getRowCount(t)}function l(e){return e.conType()}function u(){this._reset()}var c=n(1),f=n(0),d=n(18),p=n(67),h=null,m=void 0,g=d._createCondition,_=c._createRange,v=f._Types._isNullOrUndefined,y=parseInt,b=f._ArrayHelper,w=b._indexOf,C=b._contains,S=b._remove,x=b._getLength,T="mousedown.filter",E="HideRowFilter",M=c.GC$,A=M.each,k=p._FilterButtonInfo,R=function(){return f._getResource(p.SR)()},I={rowFilter:function(e){var t=this,n=t._rowFilter,r=t.filterRowsVisibleInfo;return x(arguments)?(n&&n.reset(),n=t._rowFilter=e,n?t._rowFilter._sheet=t:r&&r._reset(),t._invalidate(),t):n},_createFilterButtonModel:function(){var e,t,n,r=this,o=[],i=r.rowFilter(),l=i&&i.range,u=r.tables;if(l){var c,f=l.row,d=l.col,p=d<0?a(r):d+l.colCount;if(t=d<0?0:d,f<1?(e=s(r,1)-1,c=1):(e=f-1,c=3),e>=0)for(;t<p;)if(i.filterButtonVisible(t)){var h,m=r.getSpans(_(e,t,1,1),c);n=new k(i),n.sheetArea=c,n.row=e,x(m)?(h=m[0],n.row=h.row,n.col=h.col,t+=h.colCount):(n.col=t,t++),o.push(n)}else t++}if(u){var g=u.all();A(g,function(r,i){if(e=i.headerIndex(),i&&i.showHeader()&&e>=0){var a,s=i.range();for(a=0;a<s.colCount;a++)t=s.col+a,i.filterButtonVisible(a)&&(n=new k(i.rowFilter(),e,t,3),o.push(n))}})}return o},_getFilterButtonModel:function(){var e=this,t=e._filterButtonsModel;return!t&&p&&(t=e._filterButtonsModel=e._createFilterButtonModel()),t},_isRowFilterOut:function(e,t){var n=this.filterRowsVisibleInfo;return v(t)&&(t=3),!(3!==t&&2!==t||!n||n._rowVisible(e))},_hasRowFilterOut:function(){return this.filterRowsVisibleInfo._hasFilterOut()},_getFilterButtonRect:function(e,t){var n=this,r=n._zoomFactor,o=n.parent,i=r>1?1:r,a=3===t||t===m?n.defaults.rowHeight:n.defaults.colHeaderRowHeight,s=y((Math.min(20,a)*i).toString());return o&&o.options.useTouchLayout&&(s=y((a*r).toString())),{x:e.x+e.width-s,y:e.y+e.height-s,width:s,height:s}}};M.extend(c.Worksheet.prototype,I);var O={init:function(){var e=this;e._rowFilter=h,e.filterRowsVisibleInfo=new u,e._rowStateProviders.push({_isVisible:function(t){return e.filterRowsVisibleInfo._rowVisible(t)}})},setHost:function(e){if(e){var t=this;e.bind(T,function(e){var n=t._getCanvasOffset(),r=e.pageX-n.left,o=e.pageY-n.top,i=t.hitTest(r,o),a=i.filterButtonHitInfo;a&&a.rowFilter.openFilterDialog(a)})}},onLayoutChanged:function(e){var t=this,n=e.changeType,r=e.row,o=e.rowCount,i=e.col,a=e.colCount,s=t._rowFilter;if("invalidateLayout"===n)return void(t._filterButtonsModel=h);s&&("addRows"===n?s._onRowsAdded(r,o):"deleteRows"===n?s._onRowsRemoved(r,o):"addColumns"===n?s._onColumnsAdded(i,a):"deleteColumns"===n?s._onColumnsRemoved(i,a):"clear"===n&&s.range&&s._clear(r,i,o,a))},dispose:function(){var e=this,t=e._filterDialiog;M(e._getCanvas()).unbind(T),t&&t.close()},toJson:function(e){var t=this._rowFilter;t&&(e.rowFilter=t.toJSON())},fromJson:function(e,t){var n=e.rowFilter,r=this;if(n&&p){var o,i,a=n.typeName;a&&a!==E?(o=c.getTypeFromString(a))&&(i=new o):i=new P,i&&(r._rowFilter=i,i._sheet=r,i.fromJSON(n,t),i.reFilter())}},paintCell:function(e){var t=this,n=e.cell,o=n.width,i=n.height,a=n.cellLayout,s=t._getImageLoader(),l=t._getFilterButtonModel(),u=[],f=e.ctx;if(f.save(),f.beginPath(),f.lineWidth=1,f.fillStyle="#FFFFFF",f.strokeStyle="#CCCCCC",(!a||!C(u,a))&&l&&o>0&&i>0){var d=r(l,n.row,n.col,e.sheetArea);if(d){var h=new k(d.rowFilter,d.row,d.col,d.sheetArea,n.x,n.y,o,i),m=t._getFilterButtonRect(new c.Rect(h.x,h.y,h.width,h.height),h.sheetArea),g=m.width,_=m.height,v=m.x,y=m.y,b=p._FilterDialog._getImageSrc(h._getState());f.save(),f.rect(h.x,h.y,h.width,h.height),f.clip(),f.beginPath(),f.fillRect(v+1,y+1,g-3,_-3),f.strokeRect(v+1-.5,y+2-.5,g-3,_-4);try{s._getState(b)?f.drawImage(s._getImage(b),v,y+1,g-3,_-3):s._addImage(b)}catch(e){}f.beginPath(),f.restore()}}f.restore()}};c.Worksheet._registerFeature("filter",O),p.FilterActionType={filter:0,unfilter:1};var D=function(){function e(e){var t=this;t.range=e,t.reset(),t.typeName="",t.filterHandler=h}return e.prototype={filterButtonVisible:function(e,t){var n,r=this,o=r._sheet,i=r.range,a=r._getStartCol(i),s=r._getEndCol(i,o),l=arguments,u=r._filterButtonVisibleInfo,c=e>=a&&e<s,f=x(l),d=l[0],p=typeof d;if(0===f){for(n=a;n<s;n++)if(u[n]||u[n]===m)return!0;return!1}if(1===f){if("number"===p)return c&&u[e]===m&&(u[e]=!0),u[e];if("boolean"===p)for(n=a;n<s;n++)u[n]=d}else 2===f&&c&&(u[e]=t);return o&&o._invalidate(),r},_getStartCol:function(e){return e.row<0?0:e.col},_getEndCol:function(e,t){return e.row<0?a(t):e.col+e.colCount},addFilterItem:function(e,t){var n=this,r=n._sheet,o=n.range,i=n._filterItemMap,s=i[e];if(v(t))throw new Error(R().Exp_FilterItemIsNull);if(e<-1||e>=a(r))throw new Error(R().Exp_InvalidColumnIndex);if(o){if(o=r._getActualRange(o),e<o.col||e>=o.col+o.colCount)return;s||(s=[]),s.push(t),i[e]=s}},removeFilterItems:function(e){this._removeFilterItemsInternal(e),this.unfilter(e)},_removeFilterItemsInternal:function(e){var t=this,n=t._filterItemMap;t._removeFilteredItems(e),n[e]&&n.splice(e,1,h)},unfilter:function(e){var t=this,n=t._sheet;if(n){var r,o=[],i=t._filteredColumns;if(v(e))for(r=x(i)-1;r>=0;r--)o.push(i[r]),t._unfilterColumn(i[r]);else o.push(e),t._unfilterColumn(e),t.reFilter();t._updateLayoutByFilter(n,1,o)}},_filterColumn:function(e){var t=this,n=t.range;if(t._unfilterColumn(e),t._filterItemMap[e]&&n){var r=n.col;if(-1!==r&&(e<r||e>=r+n.colCount))return;n=t._sheet._getActualRange(n);var o,i=n.row,a=n.rowCount,s=t._getRowDataCache(e,i,a),l=t._filterRowsWithTextEquals(i,a,e,s);for(o=i;o<i+a;o++)t.isRowFilteredOut(o)||t._filterRowByCell(l,o,e,s);t._setColumnFilteredState(e,!0)}},_getRowDataCache:function(e,t,n){var r,o,a,s,l=this,u=l._sheet,c=i(l._filterItemMap[e]),f={},d=x(c);for(r=t;r<t+n;r++){var p={};for(o=0;o<d;o++)if("T"===(a=c[o])){var h=u.getText(r,e);p[a]=h?h.trim():h}else"BC"===a?(s=u.getActualStyle(r,e))&&(p[a]=s.backColor):"FC"===a?(s=u.getActualStyle(r,e))&&(p[a]=s.foreColor):"V"===a&&(p[a]=u.getValue(r,e));f[r]=p}return f},filter:function(e){var t,n=this,r=n._sheet,o=n._filterItemMap;if(r){var i=[];if(v(e))for(t=0;t<x(o);t++)o[t]&&(i.push(t),n._filterColumn(t));else{if(!o[e])return;i.push(e),n._filterColumn(e)}n._updateLayoutByFilter(r,0,i)}},_updateLayoutByFilter:function(e,t,n){var r=this;e._refreshObjectsAboveSheet&&e._refreshObjectsAboveSheet();var o=r._getFilterArgs(t,n);r.filterHandler&&r.filterHandler(o),r.onFilter(o),e._invalidate()},_getFilterArgs:function(e,t){var n=this,r=n._sheet,o=n.range,i=[],a=[];if(o){var s,l=r._getActualRange(o),u=l.row;for(s=u;s<u+l.rowCount;s++)n.isRowFilteredOut(s)?a.push(s):i.push(s)}return{action:e,sheet:r,range:o,filteredRows:i,filteredOutRows:a,columns:t}},onFilter:function(){},isFiltered:function(e){var t=this._filteredColumns;return arguments.length?C(t,e):t.length>0},isRowFilteredOut:function(e){var t=this,n=t.range;if(t.isFiltered()&&n){var r=n.row,o=t._filteredInRowsWithColIndexs[e];return!(-1!==r&&(e<r||e>=r+n.rowCount)||x(o)>=x(t._filteredColumns))}return!1},reset:function(){var e=this;e.unfilter(),e._filterItemMap=[],e._filteredColumns=[],e._filteredItems=[],e._filteredInRowsWithColIndexs={},e._filterButtonVisibleInfo={},e._sortInfo=h},_isFilterHeader:function(e,t,n){var r=this,o=!1,i=r._sheet,a=r.range;if(a){a=i._getActualRange(a,n);var l=a.row,u=a.col,c=t>=u&&t<u+a.colCount;1===n&&e===s(i,n)-1&&l-1<0&&c?o=!0:3===n&&e===l-1&&c&&(o=!0)}return o},getFilterItems:function(e){var t=this._filterItemMap[e];return t||(t=[])},getFilteredItems:function(){return this._filteredItems},sortColumn:function(e,t){var n=this,r=n._sheet;if(r){var o=r._getActualRange(n.range);r.suspendPaint();var i={index:e,ascending:t},a=r.sortRange(o.row,o.col,o.rowCount,o.colCount,!0,[i]);return a&&(n._sortInfo=i,n.isFiltered(e)&&n.reFilter()),r.resumePaint(),a}},getSortState:function(e){var t=this._sortInfo,n=0;return t&&t.index===e&&(n=t.ascending?1:2),n},reFilter:function(){var e,t=this,n=t._filteredColumns,r=x(n);for(t._filteredInRowsWithColIndexs={},t._filteredItems=[],t._filteredColumns=[],e=0;e<r;e++)t.filter(n[e])},openFilterDialog:function(){},_addFilteredInRowsWithColumnIndex:function(e,t){var n=this._filteredInRowsWithColIndexs,r=n[e];v(r)?r=[t]:(C(r,t)&&S(r,t),r.push(t)),n[e]=r},_addFilteredItem:function(e){var t=this._filteredItems;C(t,e)||t.push(e)},_unfilterColumn:function(e){var t,n,r=this,o=r._filteredInRowsWithColIndexs;if(r.range&&r.isFiltered(e)){r._setColumnFilteredState(e,!1);for(t in o)t&&(n=o[t])&&C(n,e)&&(S(n,e),x(n)||(o[t]=m));r._removeFilteredItems(e)}},_setColumnFilteredState:function(e,t){var n=this._filteredColumns;if(t){if(x(n)){if(n[x(n)-1]===e)return;S(n,e)}n.push(e)}else S(n,e)},_removeFilteredItems:function(e){var t,n=this,r=n._filterItemMap,o=r.length,i=[],a=[];for(t=0;t<o;t++)t===e?i=i.concat(r[t]):a=a.concat(r[t]);var s=i.length;for(t=0;t<s;t++)C(a,i[t])||S(n._filteredItems,i[t])},_filterRowsWithTextEquals:function(e,t,n,r){var o,i=this,a=i._filterItemMap[n],s={},u=[];for(o=0;o<x(a);o++){var c=a[o];2!==l(c)||0!==c.compareType()||c.forceValue2Text()||c.useWildCards()||c.ignoreCase()||c.ignoreBlank()?u.push(c):s[c.expected()]=c}for(o=e;o<e+t;o++)i.isRowFilteredOut(o)||s[r[o].T]&&(i._addFilteredInRowsWithColumnIndex(o,n),i._addFilteredItem(c));return u},_filterRowByCell:function(e,t,n,r){var o,i=this,a=i.range;for(o=0;o<x(e);o++){var s,u,c=e[o],f=c.item1(),d=c.item2();if(0===l(c)?(f&&(s=i._applyNewItemRange(f,t,n,a,r)),d&&(u=i._applyNewItemRange(d,t,n,a,r))):s=i._applyNewItemRange(c,t,n,a,r),c.evaluate(i._sheet,t,n,s,u)){i._addFilteredInRowsWithColumnIndex(t,n),i._addFilteredItem(c);break}}},_applyNewItemRange:function(e,t,n,r,o){var i=this,a=h,s=l(e),u=e.compareType(),c=o[t];if(8===s||10===s){var f=[],d=i._sheet._getActualRange(r),p=d.col;p<=n&&n<p+d.colCount&&f.push(_(d.row,n,d.rowCount,1)),e.ranges(f)}return 2===s||7===s?a=c.T:3===s?0===u?a=c.BC:1===u&&(a=c.FC):a=c.V,a},_isRowfilteredOutByColumn:function(e,t){var n=this,r=n._filteredColumns;if(!x(r))return!1;var o=-1,i=w(r,t),a=n._filteredInRowsWithColIndexs[e],s=x(a);return i>0&&(o=r[i-1]),o>-1?!!s&&o===a[s-1]:!s},_onRowsAdded:function(e,t){var n=this,r=n.range;if(r){var o=s(n._sheet)-t-1,i=r.row,a=r.col,l=r.rowCount,u=r.colCount;i>-1&&(o=i+l-1,e<=i?n._setRangeInternal(_(i+t,a,l,u)):e<i+l&&n._setRangeInternal(_(i,a,l+t,u)));var c=n._filteredInRowsWithColIndexs;if(n.isFiltered()&&c){var f,d=[];for(f=0;f<x(c);f++)d.push(f);for(d.sort(),f=0;f<x(d);f++){var p=d[f];p>=e&&p<=o&&(c[p+t]=c[p],c[p]=m)}}n.reFilter()}},_onColumnsAdded:function(e,t){var n=this,r=n.range;if(r){var o,i=r.row,s=r.col,l=r.rowCount,u=r.colCount,c=0,f=-1,d=0;if(e>=0&&n._isSorted()){for(o=0;o<t;o++)o+e<=n._sortedColumn()&&c++;n._sortedColumn(n._sortedColumn()+c)}for(s>-1&&(e<=s?(f=s,d=u,n._setRangeInternal(_(i,s+t,l,u))):e<s+u&&(f=e,d=u-(e-s),n._setRangeInternal(_(i,s,l,u+t)))),f<0&&(f=0,d=a(n._sheet)-t),o=f+d-1;o>=f;o--)if(o>=e){var p=o+t,h=w(n._filteredColumns,o);h>=0&&(n._filteredColumns[h]=p);var m=n._filterItemMap[o];x(m)&&(S(n._filterItemMap,o),n._filterItemMap[p]=m)}n.reFilter()}},_onRowsRemoved:function(e,t){var n=this,r=n.range;if(r){var o=0,i=s(n._sheet)+t-1,a=r.row,l=r.col,u=r.rowCount,c=r.colCount;a>-1&&(o=a,i=a+u-1,e<=a?a===e+1||a+u<=e+t?n._setRangeInternal(h):a<e+t?n._setRangeInternal(_(e,l,a+u-(e+t),c)):n._setRangeInternal(_(a-t,l,u,c)):e<a+u&&n._setRangeInternal(_(a,l,u-Math.min(a+u-e,t),c)));var f,d=n._filteredInRowsWithColIndexs;if(n.isFiltered()&&d)for(f=o;f<=i;f++)if(f>=e&&f<e+t)d[f]=m;else if(f>=e+t){var p=f,g=d[p];g&&(d[p-t]=g,d[p]=m)}n.reFilter()}},_setRangeInternal:function(e){this.range=e},_updateRange:function(e){var t,n,r=this,o=r._sheet,i=r.range;if(i)if(e){if(!e.equals(i)){var l=i.col,u=i.colCount,c=e.col,f=e.colCount,d=a(o);if(r.isFiltered()&&!(l<0&&c<0))for(l<0&&(l=0,u=d),c<0&&(c=0,f=d),t=0;t<u;t++)n=l+t,(c>n||n>=c+f)&&r.removeFilterItems(n);var p=i.row,g=i.rowCount,_=e.row,v=e.rowCount,y=s(o);if(r.isFiltered()&&r._filteredInRowsWithColIndexs&&!(p<0&&_<0))for(p<0&&(p=0,g=y),_<0&&(_=0,v=y),t=0;t<g;t++)n=p+t,(_>n||n>=_+v)&&(r._filteredInRowsWithColIndexs[n]=m)}}else r.reset();!r._isSorted()||e&&e.contains(-1,r._sortedColumn())||(r._sortInfo=h),r._setRangeInternal(e)},_onColumnsRemoved:function(e,t){var n=this,r=n.range,o=n._sortedColumn(),i=e+t;if(r){e>=0&&n._isSorted()&&(o>=e&&o<i?n._sortedColumn(-1):o>=i&&n._sortedColumn(o-t));var s,l=r.row,u=r.col,c=r.rowCount,f=r.colCount;for(u<0?(u=0,f=a(n._sheet)+t):f=r.colCount,s=u;s<u+f;s++)if(s>=e)if(s<i)n.removeFilterItems(s);else{var d=s-t,p=w(n._filteredColumns,s),m=n._filterItemMap[s];p>=0&&(n._filteredColumns[p]=d),x(m)&&(S(n._filterItemMap,s),n._filterItemMap[d]=m)}u>=0&&(e<u?i<=u?n._setRangeInternal(_(l,u-t,c,f)):i<=u+f?n._setRangeInternal(_(l,e,c,u+f-i)):n._setRangeInternal(h):e<u+f&&(i<=u+f?n._setRangeInternal(_(l,u,c,f-t)):n._setRangeInternal(_(l,u,c,e-u)))),n.reFilter()}},_isSorted:function(){var e=this,t=e._sortInfo;return!!t&&(t.index>-1&&0!==e.getSortState(t.index))},_sortedColumn:function(e){var t,n=this,r=n._sortInfo;return x(arguments)?(r?r.index=e:n._sortInfo={index:e,ascending:!1},t=n):t=r?r.index:-1,t},_clear:function(e,t,n,r){var o=this,i=o.range;if(i){var a=_(e,t,n,r);if(o.filterButtonVisible()){var s=i.row-1,l=i.rowCount+1;s<0&&(s=-1,l=-1),a.containsRange(_(s,i.col,l,i.colCount))&&o.unfilter()}else a.containsRange(i)&&o.unfilter()}},fromJSON:function(e,t){if(e){var n,r,o,i=this,a=e.range,s=e.filterItemMap,l=i._filterItemMap,u=e.sortInfo,c=e.showFilterButton,f=e.filterButtonVisibleInfo;if(a&&(i.range=_(a.row,a.col,a.rowCount,a.colCount)),d)for(n=0;n<x(s);n++){var p=s[n],h=p.conditions;for(r=0;r<x(h);r++){var y=h[r];if(y){var b=g(),w=p.index,C=l[w];b.fromJSON(y,t),C||(C=l[w]=[]),C.push(b)}}}for(o=e.filteredColumns||e.filteredColMap,n=0;n<x(o);n++)v(o[n])||i._filteredColumns.push(o[n]);if(u&&(i._sortInfo={index:u.index,ascending:u.ascending}),c!==m){var S=i.range;if(f)i._filterButtonVisibleInfo=f;else if(S)for(n=i._getStartCol(S);n<i._getEndCol(S,i._sheet);n++)i._filterButtonVisibleInfo[n]=c}}},toJSON:function(){var e,t=this,n={},r=t.range,o=t._filterButtonVisibleInfo,i=t._filterItemMap,a=t._filteredColumns,s=t._sortInfo,l=[],u=0,c=t.typeName;for(r&&(n.range=r),c&&(n.typeName=c),e=0;e<x(i);e++){var f=i[e];if(f){var d,p=[];for(d=0;d<x(f);d++)p.push(f[d]?f[d].toJSON():h);l[u++]={index:e,conditions:p}}}if(x(l)&&(n.filterItemMap=l),x(a)&&(n.filteredColumns=a),s&&(n.sortInfo=s),o){n.filterButtonVisibleInfo=o;var m=!1;for(e in o)if(o[e]){m=!0;break}n.showFilterButton=m}var g,_=[];for(g=0;g<t._sheet.getRowCount();g++)t.isRowFilteredOut(g)&&_.push(g);return _.length>0&&(n.filteredOutRows=_),n},_canDoFilter:function(e){var t=e.options;return!t.isProtected||t.protectionOptions.allowFilter},hitTest:function(e,t,n){var o=this._sheet;if(o){var i,a,s,l=e.rowViewportIndex,u=e.colViewportIndex,c=e.hitTestType,f=o._getViewportColumnLayout(u);if(1===c?(i=o._getColumnHeaderRowLayout().findY(n),a=f.findX(t),s=1):3===c&&(i=o._getViewportRowLayout(l).findY(n),a=f.findX(t),s=3),!i||!a)return h;var d=i.row,p=a.col,m=o.getSpan(d,p,s),g=o._getFilterButtonModel();if(m){for(var _=m.row,v=m.col,y=o._rowFilter._getFilterArgs().filteredOutRows,b=0,w=0,C=y.length;w<C;w++){var S=y[w];S>_&&S<_+m.rowCount&&b++}if(d!==_+m.rowCount-b-1||p!==v+m.colCount-1)return h;d=_,p=v}if(g){var x=r(g,d,p,s);if(x){var T=o.getCellRect(d,p,l,u),E=o._getFilterButtonRect(T,s);if(E.x<=t&&t<=E.x+E.width&&E.y<=n&&n<=E.y+E.height)return new k(x.rowFilter,x.row,x.col,x.sheetArea,E.x,E.y,E.width,E.height)}}return h}}},e}();p.RowFilterBase=D;var P=function(e){function t(t){e.call(this,t),this.typeName=E}M.inherit(t,e);var n={onFilter:function(e){var t=this,n=t._sheet;n&&(t._updateRowVisibleInfo(n,e.filteredRows,e.filteredOutRows),n._invalidateVScrollbar())},_updateRowVisibleInfo:function(e,t,n){var r=e.filterRowsVisibleInfo;if(r){var o=r._updateVisible(t,n);c._supportsCalc&&e.recalcRows(o)}},openFilterDialog:function(e){var t=this,n=t._sheet;if(t._canDoFilter(n)){var r=new p._FilterDialog(n.parent._getContainerDiv(),n,e);n._filterDialog=r,r._open()}}};return M.extend(t.prototype,n),t}(D);p.HideRowFilter=P,u.prototype={_rowVisible:function(e){var t=this.rowsVisibleInfo[e];return!!v(t)||t},_updateVisible:function(e,t){for(var n=[],r=this.rowsVisibleInfo,o=0,i=e.length;o<i;o++){var a=e[o],s=r[a];s!==m&&s!==h&&n.push(a),delete r[a]}for(var l=0,u=t.length;l<u;l++){var c=t[l],f=r[c];f!==m&&f!==h||n.push(c),r[c]=!1}return n},_reset:function(){this.rowsVisibleInfo={}},_hasFilterOut:function(){return Object.keys(this.rowsVisibleInfo).length>0}},e.exports=p},function(e,t,n){function r(){return H._getResource(F.SR)()}function o(e){throw new Error(e)}function i(e,t,n,r){V&&e.setFormula(t,n,r)}function a(e,t,n,r){e.setValue(t,n,r)}function s(e){e.suspendPaint()}function l(e){e.resumePaint()}function u(e){return e._getCalcServiceInternal()._getOperatorAdjustor()}function c(e){V&&e.suspendCalcService()}function f(e,t){V&&e.resumeCalcService(t)}function d(e){return e.rowCount}function p(e){return e.colCount}function h(e){return e&&!(/\d/.test(e[0])||/[\s\+\-\*\\:%!\[\]]/.test(e)||-1!==["C","c","R","r"].indexOf(e)||/^[A-Za-z]{1,3}(\$)?\d+$/.test(e)||/^[Rr]\d*[Cc]\d*$/.test(e)||e.length>=255)}function m(e){if(!e)return!1;h(e)||o(r().Exp_TableNameInvalid);var t=this,n=t.name(),i=t._owner;if(e===n)return!1;if(i){var a=i.findByName(e);return!a||t===a}return!0}function g(e,t,n){function r(t,r){te(t,function(t,o){var a=o.getExpression(),s=V.CalcOperatorAdjustor.adjustExpressionOnRemoveTable(a,r,-1,-1,n);s!==a&&(o._setExpression(s),i.invalidName(e._getSheetSource(),o.getName()))})}var o=e.parent,i=u(e);o?(r(o.getCustomNames(),t),te(o.sheets,function(e,n){r(n.getCustomNames(),t)})):r(e.getCustomNames(),t),i.onAfterRemoveTable(t,n)}function _(e,t,n,r,o,i,a){var s=this;s._showHeader=!a||a.showHeader===ue||a.showHeader,s._showFooter=!(!a||a.showFooter===ue)&&a.showFooter,s._bindingManager=le,s._rowFilter=le,s._owner=le,G(e)&&s.name(e),s._row=G(t)?t:-1,s._col=G(n)?n:-1,s._rowCount=G(r)?r:-1,s._colCount=G(o)?o:-1,G(i)&&s.style(i),s._columns=[];for(var l=0;l<s._colCount;l++)s._columns.push(new v(l+1));s._slicerData=le}function v(e){var t=this;t.id(e),t.name(Ce+t.id())}function y(e,t,n,r,o,i,a,s,l,u){var c=this,f=arguments;te(Ne,function(e,t){c[t]=f[e]})}function b(){}function w(e,t,n,r,o,i,a,s,l,u){function c(e,t){return isNaN(t)?t:new Z(e,t)}var f=new y;return t&&(f.backColor=t),n&&(f.foreColor=n),r&&(f.font=we),o&&(f.borderLeft=c(e,o)),i&&(f.borderTop=c(e,i)),a&&(f.borderRight=c(e,a)),s&&(f.borderBottom=c(e,s)),l&&(f.borderHorizontal=c(e,l)),u&&(f.borderVertical=c(e,u)),f}function C(e){return 0===e?"Text 1":"Accent "+e}function S(e){var t=e-1,n=le,r=fe(t/7);if(r>=0&&r<3){n=[x,T,E][r](t%7);var o="Light"+e;n.name(o),n.builtInName(o)}return n}function x(e){var t=C(e),n=t+" 80",r=new b;return r[Fe](w(t,0,t,1,0,0,0,1)),r[He](w(t,0,t,0,0,1,0,1)),r[Be](w(t,n)),r[je](w(t,0,t,1)),r[Ve](w(t,0,t,1)),r[We](w(t,n)),r[Le](w(t,0,t,1,0,1)),r}function T(e){var t=C(e),n=new b;return n[Fe](w(t,t,tt,1)),n[He](w(t,0,0,0,1,1,1,1)),n[Be](w(t,0,0,0,0,1)),n[Ue](w(t,0,0,0,0,1)),n[We](w(t,0,0,0,1)),n[ze](w(t,0,0,0,1)),n[je](w(t,0,0,1)),n[Ve](w(t,0,0,1)),n[Le](w(t,0,0,1,0,6)),n}function E(e){var t=C(e),n=t+" 80",r=new b;return r[Fe](w(t,0,0,1,0,0,0,2)),r[He](w(t,0,0,0,1,1,1,1,1,1)),r[Be](w(t,n)),r[We](w(t,n)),r[je](w(t,0,0,1)),r[Ve](w(t,0,0,1)),r[Le](w(t,0,0,1,0,6)),r}function M(e){var t=e-1,n=le,r=fe(t/7);if(r>=0&&r<4){n=[A,k,R,I][r](t%7);var o="Medium"+e;n.name(o),n.builtInName(o)}return n}function A(e){var t=C(e),n=t+" 20",r=t,o=t+" 80",i=new b;return i[Fe](w(n,r,tt,1)),i[He](w(n,0,0,0,1,1,1,1,1)),i[Be](w(n,o)),i[We](w(n,o)),i[je](w(n,0,0,1)),i[Ve](w(n,0,0,1)),i[Le](w(n,0,nt,1,0,6)),i}function k(e){var t=C(e),n=tt,r=t,o=t+" 60",i=t+" 80",a=new b;return a[Fe](w(n,r,tt,1,0,0,0,2,0,1)),a[He](w(n,i,0,0,0,0,0,0,1,1)),a[Be](w(n,o)),a[We](w(n,o)),a[je](w(n,r,tt,1)),a[Ve](w(n,r,tt,1)),a[Le](w(n,r,tt,1,0,2,0,0,0,1)),a}function R(e){var t=C(e),n="#D3D3D3",r=t,o=n,i=0===e?nt:n,a=new b;return a[Fe](w(nt,r,tt,1,0,2,0,2)),a[He](w(i,0,0,0,1,new Z(nt,2),1,new Z(nt,2),0===e?1:0,1)),a[Be](w(i,o)),a[We](w(i,o)),a[je](w(i,r,tt)),a[Ve](w(i,r,tt)),a[Ke](w(i,r,tt,1)),a[Xe](w(i,r,tt,1)),a[Le](w(nt,0,nt,0,0,6)),a}function I(e){var t=C(e),n=t,r=t+" 40",o=t+" 80",i=t+" 60",a=t+" 80",s=new b;return s[Fe](w(r,o,nt,1,1,1,1,1,0,1)),s[He](w(r,o,0,0,1,1,1,1,1,1)),s[Be](w(r,i)),s[We](w(r,i)),s[je](w(r,0,0,1)),s[Ve](w(r,0,0,1)),s[Le](w(r,a,nt,1,1,new Z(n,2),1,1,0,1)),s}function O(e){var t=e-1,n=le,r=fe(t/7);if(r>=0&&r<2){n=[D,P][r](t%7);var o="Dark"+e;n.name(o),n.builtInName(o)}return n}function D(e){var t=C(e),n=nt,r=0===e?t+" 25":t+" -25",o=0===e?t+" 50":t,i=0===e?t:t+" -50",a=new b;return a[Fe](w(tt,n,tt,1,0,0,0,2)),a[He](w(t,o,tt)),a[Be](w(t,r)),a[We](w(t,r)),a[je](w(tt,r,tt,1,0,0,2)),a[Ve](w(tt,r,tt,1,2)),a[Le](w(tt,i,tt,1,0,2)),a}function P(e){function t(e){return e<0||e>3?"":["Background 1 -15","Accent 1 80","Accent 3 80","Accent 5 80"][e]}function n(e){return e<0||e>3?"":["Background 1 -35","Accent 1 60","Accent 3 60","Accent 5 60"][e]}function r(e){return e<0||e>3?"":["Text 1","Accent 2","Accent 4","Accent 6"][e]}var o=C(e),i=r(e),a=n(e),s=t(e),l=s,u=new b;return u[Fe](w(o,i,tt)),u[He](w(o,s)),u[Be](w(o,a)),u[We](w(o,a)),u[je](w(o,0,0,1)),u[Ve](w(o,0,0,1)),u[Le](w(nt,l,0,1,0,6)),u}function N(e){this._sheet=e,this._tableList=[],this._updateDataSourceSuspended=!1}var F={},L=n(1),H=n(0),V=n(5),j=n(66),B=j&&j.HideRowFilter,U=n(57),W=L._createRange,z=L._util,Y=z._defProperty,G=z._isDefined,K=z._toString,X=L._CacheMgr,q=L.Worksheet,J=L.Events,Z=L.LineBorder,Q=L.Style,$=L.GC$,ee=$.inArray,te=$.each,ne=$.isEmptyObject,re=H._Types._isNullOrUndefined,oe=H._ArrayHelper._contains,ie=U&&U.CellBindingSource,ae=U&&U._BindingManager,se=U&&U._getValueByPath,le=null,ue=void 0,ce=Math.min,fe=Math.floor,de=JSON.stringify,pe=JSON.parse,he="name",me="highlightFirstColumn",ge="highlightLastColumn",_e="bandRows",ve="bandColumns",ye="autoGenerateColumns";q._registerFeature("table",{priority:2e3,init:function(){var e=this,t=".table";e.tables=new N(e),e.bind(J.BeforeDragDrop+t,function(t,n){var o=e,i=e.tables,a=r().Exp_DragDropChangePartOfTable,s=n.fromRow,l=n.fromColumn,u=d(n),c=n.columnCount,f=o._eventHandler._dragRect,p=f.row,h=f.col,m=n.isDragInsert,g=n.isDragCopy,_=le;if(m&&(-1===s||-1===l))if(l>=0&&s<0){if(e.isDragCopy&&(h<=l||h>=l+c)||!g&&(h<l||h>l+c)){var v=!1;i._hasPartTable(-1,h,-1,1)&&(v=!0,_=r().Exp_DragDropShiftTableCell),v||g||!i._hasPartTable(-1,l,-1,c)||(_=a)}}else s>=0&&l<0&&(g&&(p<=s||p>=s+u)||!g&&(p<s||p>s+u))&&!g&&i._hasPartTable(s,-1,u,-1)&&(_=a);n.invalidMessage=_}),e.bind(J.ResetBinding+t,function(){e.tables._resetTablesBindingManager()}),e.bind(J.InitBinding+t,function(){var t=e.tables;t._resetTablesBindingManager(),c(e);for(var n=t.all(),r=0,o=n.length;r<o;r++){var i=n[r];i&&i._applyBindingPath()}f(e)})},onLayoutChanged:function(e){var t=this,n=e.changeType,r=e.row,o=d(e),i=e.col,a=p(e),s=t.tables;if("addRows"===n)s._onRowsAdded(r,o);else if("addRows2"===n)s._onRowsAdded2(r,o);else if("deleteRows"===n)s._onRowsRemoved(r,o);else if("addColumns"===n)s._onColumnsAdded(i,a);else if("deleteColumns"===n)s._onColumnsRemoved(i,a);else if("clear"===n){var l=e.sheetArea;e.ignoreTable||3!==l&&!re(l)||s._clear(r,i,o,a,e.type)}},toJson:function(e,t){function n(e,t){for(var n=e.tables.all(),r=0,o=n.length;r<o;r++){var i=n[r],a=i._getDataSource(),s=i.dataRange(),l=s.row,u=s.col,c=l+d(s)-1,f=u+p(s)-1;if(a)for(var h=l;h<=c;h++)for(var m=u;m<=f;m++){var g=i._getValue(h,m);g._hasValue&&e._setValueToDataTable(t,h,m,g._value)}}}var r=this,o=r.tables;if(o&&(e.tables=o.toJSON()),t&&t.includeBindingSource){var i=e.data;i.dataTable=i.dataTable||{},n(r,i.dataTable)}},fromJson:function(e,t){var n=this,r=n.tables,o=e.tableManager,i=t?o&&o.tables:e.tables;G(i)&&r&&r.fromJSON(i,t)},lastNonNullRowAndCol:function(){var e=this,t=e.tables,n=-1,r=-1,o=t.all();if(o)for(var i=0,a=o.length;i<a;i++){var s=o[i];if(s){var l=s.range(),u=l.row+d(l)-1,c=l.col+p(l)-1;u>n&&(n=u),c>r&&(r=c)}}return{lastNonNullRow:n,lastNonNullCol:r}}}),$.extend(L.Workbook.prototype,{_findTable:function(e){var t,n,r=this.sheets;if(r)for(var o=0;o<r.length;o++)if((n=r[o].tables)&&(t=n.findByName(e)))return t;return le}}),_.prototype={range:function(){var e=this;return W(e._row,e._col,e._rowCount,e._colCount)},dataRange:function(){var e=this,t=e._showHeader?e._row+1:e._row,n=e._showHeader?e._rowCount-1:e._rowCount;return e._showFooter&&n--,W(t,e._col,n,e._colCount)},name:Y(he,"",ue,m),headerIndex:function(){return this._showHeader?this._row:-1},footerIndex:function(){return this._showFooter?this._row+this._rowCount-1:-1},showHeader:function(e){var t=this;if(0===arguments.length)return t._showHeader;if(t._showHeader!==e){var n=t._getSheet();n&&n.suspendPaint();if(t._showHeader=e)t._row>0&&(t._row=t._row-1,t._rowCount+=1),t._syncHeader();else{var r=t._row;t._row=t._row+1,t._rowCount-=1,t._clearSheetRow(r),t._resetFilter()}n&&(V&&n.recalcRange(t._row+(e?0:-1),t._col,1,t._colCount),n.resumePaint())}return t},showFooter:function(e){var t=this;if(0===arguments.length)return t._showFooter;if(t._showFooter!==e){var n=t._getSheet();n&&n.suspendPaint();if(t._showFooter=e)(!n||t._row+t._rowCount<n.getRowCount())&&(t._rowCount+=1),t._syncFooter();else{var r=t._row+t._rowCount-1;t._rowCount-=1,t._clearSheetRow(r)}n&&(V&&n.recalcRange(t._row+t._rowCount+(e?-1:0),t._col,1,t._colCount),n.resumePaint())}return t},bandRows:Y(_e,!0),bandColumns:Y(ve,!1),highlightFirstColumn:Y(me,!1),highlightLastColumn:Y(ge,!1),style:Y("style"),rowFilter:function(){var e=this;return!e._rowFilter&&be&&(e._rowFilter=new be(e),e._rowFilter._updateRange(e.dataRange())),e._rowFilter},autoGenerateColumns:Y(ye,!0),bindColumns:function(e){var t=this;if(e)for(var n=ce(t._colCount,e.length),r=0;r<n;r++){var o=t._columns[r];o||(o=new v(t._newAutoId()),t._columns[r]=o),o.name(e[r].name()),o.dataField(e[r].dataField())}},bindingPath:function(e){var t=this;return 0===arguments.length?t._bindingPath:(t._bindingPath=e,t._applyBindingPath(),t)},getColumnName:function(e){var t=this._columns;if(t&&0<=e&&e<t.length){var n=t[e];if(n){var r=n.name();return r!==le&&(r=K(r)),r}}return le},setColumnName:function(e,t){var n=this;if(n._hasColumnName(t))return n;var r=n._columns;if(r&&0<=e&&e<r.length){var o=r[e];o||(o=n._columns[e]=new v(n._newAutoId()));var i=o.name();if(o.name(t),n._showHeader){var a=n._getSheet();a&&a.setText(n.headerIndex(),n._col+e,t)}n._onColumnNameChanged(i,o.name())}return n},_onColumnNameChanged:function(e,t){var n=this._slicerData;n&&n.onColumnNameChanged(e,t)},setColumnDataField:function(e,t){var n=this,r=n._columns;if(r&&0<=e&&e<r.length){var o=r[e];o||(o=n._columns[e]=new v(n._newAutoId())),o.dataField(t)}return n},getColumnDataField:function(e){var t=this._columns;if(t&&0<=e&&e<t.length){var n=t[e];if(n){var r=n.dataField();return r!==le&&(r=K(r)),r}}return le},getColumnFormula:function(e){var t=this._columns;if(t&&0<=e&&e<t.length){var n=t[e];if(n){var r=n.footerFormula();return r?r.toUpperCase():r}}return le},setColumnFormula:function(e,t){var n=this,r=n._columns;if(V&&r&&0<=e&&e<r.length){t&&"="===t[0]&&(t=t.substring(1));var o=r[e];if(o&&o.footerFormula(t),n._showFooter){var a=n._getSheet();a&&i(a,n.footerIndex(),n._col+e,t)}}return n},setColumnDataFormula:function(e,t){function n(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return n;return-1}if(V){var r=this,o=r._columns;if(o&&0<=e&&e<o.length){t&&"="===t[0]&&(t=t.substring(1));var a=o[e];if(a&&a.dataAreaFormula()!==t){a.dataAreaFormula(t);var s=r._getSheet();c(s);var l=n(o,a)+r._col,u=r._row,d=r._rowCount;r.showHeader()&&(u++,d--),r.showFooter()&&d--;for(var p=u;p<u+d;p++)i(s,p,l,t);f(s,!1)}}return r}},getColumnValue:function(e){var t=this,n=t._columns;if(n&&0<=e&&e<n.length){var r=n[e];if(r){if(t._showFooter&&r.footerFormula()){var o=t._getSheet();if(o)return o.getValue(t.footerIndex(),t._col+e)}return r.footerValue()}}return le},setColumnValue:function(e,t){var n=this,r=n._columns;if(r&&0<=e&&e<r.length){var o=r[e];if(o&&o.footerValue(t),n._showFooter){var i=n._getSheet();i&&a(i,n.footerIndex(),n._col+e,t)}}return n},filterButtonVisible:function(e,t){var n=this,r=n._getSheet(),o=n.rowFilter();if(!(e<0||e>=n._colCount)){var i=arguments;switch(i.length){case 0:return o&&o.filterButtonVisible();case 1:var a=i[0],u=typeof a;if("number"===u)return o&&o.filterButtonVisible(a);if("boolean"===u&&o){s(r);for(var c=0;c<n._colCount;c++)o.filterButtonVisible(c,a);l(r)}return n;case 2:return o&&o.filterButtonVisible(e,t),n}}},_hasSlicerData:function(){return!!this._slicerData},_setOwner:function(e){var t=this;t._owner=e;var n=t._rowFilter;n&&n._sheet!==e._sheet&&n.table(t)},_getSheet:function(){var e=this._owner;return e?e._sheet:le},_bind:function(e){var t=this,n=t.autoGenerateColumns(),r=t._rowFilter&&t._rowFilter._filterButtonVisibleInfo;t._resetFilter();var o=t._getSheet();if(o){var i=t.dataRange();n?o._clearCore(i.row,i.col,d(i),p(i),3,17,!1,!0):te(t._columns,function(e,t){t.dataField()&&o._clearCore(i.row,i.col+e,d(i),1,3,17,!1,!0)})}if(n){var a=t.range();t._clear(a.row,a.col,d(a),p(a))}if(t._bindingManager=e,e){var s=e.getRowCount(),l=e.getColumnCount();if(t._showHeader&&s++,t._showFooter&&s++,t._rowCount=s,n){t._colCount=l,t._columns=[];for(var u=e._getFields(),c=0;c<t._colCount;c++){var f=new v(c+1);t._columns[c]=f,u&&(f.name(u[c]),f.dataField(u[c]))}}}t._rowFilter&&(t._rowFilter._updateRange(t.dataRange()),t._rowFilter._filterButtonVisibleInfo=r)},_getDataSourceCol:function(e){var t=this,n=t._bindingManager;if(n){var r=n._getFields();if(r)for(var o=t._columns[e-t.startColumn()],i=o&&o.dataField(),a=0,s=r.length;a<s;a++)if(r[a]===i)return a}return-1},_getValue:function(e,t){var n,r=!1,o=ue,i=this,a=i._bindingManager,s=e-i.dataRange().row;return a&&s<a.getRowCount()&&(n=i._getDataSourceCol(t))>=0&&(r=!0,o=a.getValue(s,n).value),{_hasValue:r,_value:o}},_setValue:function(e,t,n){var r,o=this,i=o._bindingManager,a=e-o.dataRange().row,s=!1;if(i&&(r=o._getDataSourceCol(t))>=0){var l=o._getSheet();if(l){var u=l._getModel(),c=i.getValue(a,r);c.hasBinding&&c.value!==n&&u._updateDirty(e,t,{_oldValue:c.value}),u.setValue(e,t,ue)}i.setValue(a,r,n),s=!0}return s},_getStyle:function(e,t,n){if(b[n]){var r=new Q;return this._compose(e,t,r),r}return le},_compose:function(e,t,n){var r=this,o=r.style();if(o){var i=r._getSheet(),a=r._showHeader,s=r._showFooter,l=r.highlightLastColumn(),u=r.highlightFirstColumn(),c=r.headerIndex(),f=r.footerIndex(),d=a?e===r._row+1:e===r._row,p=s?e===r._row+r._rowCount-2:e===r._row+r._rowCount-1,h=t===r._col,m=t===r._col+r._colCount-1,g=a?e===c:e===r._row,_=s?e===f:e===r._row+r._rowCount-1,v=o[Ve](),y=o[je]();if(c===e){var b=o[Ge]();m&&l&&b&&b._compose(n,!0,!0,!0,!0);var w=o[Ye]();h&&u&&w&&w._compose(n,!0,!0,!0,!0);var C=o[Fe]();C&&C._compose(n,!0,h,!0,m),m&&l&&v&&v._compose(n,!0,!0,!1,!0),h&&u&&y&&y._compose(n,!0,!0,!1,!0)}else if(f===e){var S=o[Xe]();m&&l&&S&&S._compose(n,!0,!0,!0,!0);var x=o[Ke]();h&&u&&x&&x._compose(n,!0,!0,!0,!0);var T=o[Le]();T&&T._compose(n,!0,h,!0,m),m&&l&&v&&v._compose(n,!1,!0,!0,!0),h&&u&&y&&y._compose(n,!1,!0,!0,!0)}else{m&&l&&v&&v._compose(n,g,!0,_,!0),h&&u&&y&&y._compose(n,g,!0,_,!0);var E=a?e-r._row-1:e-r._row,M=t-r._col;if(X._cached&&X._visibleRowIndexCache){for(var A=X._visibleRowIndexCache,k=r.dataRange().row;-1===A[k];)k++;if(k>e)return;E=A[e]-A[k]}else if(i){var R=0,I=0;for(k=r.dataRange().row;k<e;k++)i.getRowHeight(k)>0&&R++;for(var O=r._col;O<t;O++)i.getColumnWidth(O)>0&&I++;E=R,M=I}if(r.bandRows()){var D=o[Je](),P=D+o[Ze]();if(P>0){var N=E%P,F=o[Be](),L=o[Ue]();if(N<D&&F){var H=0===N,V=p||N===D-1;F._compose(n,H,h,V,m)}else N>=D&&L&&(H=N===D,V=p||N===P-1,L._compose(n,H,h,V,m))}}r.bandColumns()&&(D=o[Qe](),(P=D+o[$e]())>0&&(N=M%P,F=o[We](),L=o[ze](),N<D&&F?(H=0===N,V=m||N===D-1,F._compose(n,d,H,p,V)):N>=D&&L&&(H=N===D,V=m||N===P-1,L._compose(n,d,H,p,V))))}var j=o[He]();j&&j._compose(n,g,h,_,m)}},_moveTo:function(e,t){var n=this;if(e!==n._row||t!==n._col){var i=n._getSheet();if(i){(e<0||i.getRowCount()<e+n._rowCount||t<0||i.getColumnCount()<t+n._colCount)&&o(r().Exp_TableMoveOutOfRange);var a,s,l,u=n._owner;if(u)for(a=u.all(),s=0,l=a.length;s<l;s++)if(a[s]===n){a.splice(s,1),n._clearSheetModelFormula();break}i.moveTo(n._row,n._col,e,t,n._rowCount,n._colCount,3),a&&s<=l&&(n._moveToCore(e,t),a.splice(s,0,n),n._syncSheetModelFormula())}}},_moveToCore:function(e,t){var n=this;n._row=e,n._col=t,n._updateFilter()},_clearSheetModelFormula:function(e,t){var n=this,r=n._getSheet();if(r&&V){var o=n._columns,s=n.footerIndex(),l=n.range(),u=n.dataRange();for(re(e)&&(e=0,t=o.length);e<t;e++){var c=o[e],f=l.col+e;if(c&&c.footerFormula()&&s>=0&&(i(r,s,f,le),a(r,s,f,le)),c&&c.dataAreaFormula())for(var p=0,h=d(u);p<h;p++)i(r,u.row+p,f,le),a(r,u.row+p,f,le)}}},_syncSheetModelFormula:function(){var e=this,t=e._getSheet();if(t&&V){var n=e.footerIndex(),r=e.range(),o=e.dataRange();te(e._columns,function(e,a){var s=r.col+e,l=a.footerFormula(),u=a.dataAreaFormula();if(l&&n>=0&&i(t,n,s,l),u)for(var c=0,f=d(o);c<f;c++)i(t,o.row+c,s,u)})}},_resize:function(e,t){var n=this,i=n.dataRange();if(!e.equals(n.range())){var a=e.row,s=e.col,l=d(e),u=p(e),c=n._showHeader,f=n._showFooter,h=0,m=1;c&&(h+=1),f&&(h+=1);var g=n._getSheet();g&&((l<h||u<m||a+l>g.getRowCount()||s+u>g.getColumnCount())&&o(r().Exp_TableResizeOutOfRange),a===n._row&&e.intersect(n._row,n._col,n._rowCount,n._colCount)||o(r().Exp_TableResizeInvalidRange));var _=n._columns,y=s,b=s+u-1,w=n._col,C=n._col+n._colCount-1;if(n._col=s,n._colCount=u,y<w){for(var S=0,x=y;x<w;x++){var T=new v(n._newAutoId());_.splice(S++,0,T)}c&&n._syncHeader(y,w-y),f&&n._syncFooter(y,w-y)}else y<=C&&(n._clearSheetModelFormula(w,y),_.splice(0,y-w));if(b>C){for(x=C+1;x<=b;x++)T=new v(n._newAutoId()),_.push(T);c&&n._syncHeader(C+1,b-C),f&&n._syncFooter(C+1,b-C)}else b>=w&&(n._clearSheetModelFormula(b,C),_.splice(_.length-(C-b),C-b));if(l!==n._rowCount){var E=n._bindingManager,M=n.dataRange(),A=M.row,k=d(M);if(E){if(l>n._rowCount){var R=A+k,I=l-n._rowCount;g&&g.addRows(R,I),f||(t||n._updateDataSourceOnAddRows(R,I),n._rowCount=l,n._updateFormulaOnAddRows(R,I))}else if(g){var O=n._rowCount-l;g.deleteRows(A+k-O,O)}}else{var D;f&&(n._syncFooter(),D=n.footerIndex()),n._rowCount=l,f&&(n._syncSheetByFooter(),n._clearSheetRow(D))}}n._updateFilter(),n._onTableResized(i,n.dataRange())}},_onTableResized:function(e,t){var n=this,r=n._slicerData;if(r){var o=e.col,i=d(e),a=p(e),s=t.col,l=d(t),u=p(t),c=e.row+i,f=o+a,h=t.row+l,m=s+u;h<c&&r.onRowsRemoved(l,c-h),h>c&&r.onRowsAdded(i,h-c),s>o&&r.onColumnsRemoved(0,s-o),m<f&&r.onColumnsRemoved(u,f-m),s<o&&r.onColumnsAdded(0,o-s),m>f&&r.onColumnsAdded(o+a-s,m-f)}},_updateFilter:function(){var e=this,t=e._rowFilter;t&&(t._updateRange(e.dataRange()),t.reFilter())},_resetFilter:function(){var e=this._rowFilter;e&&(e.unfilter(),e.reset())},_hasColumnName:function(e){e!==le&&(e=K(e));for(var t=0;t<this._colCount;t++){if(e===this.getColumnName(t))return!0}return!1},_getHeaderName:function(e){var t=this,n=t._columns;if(!t._showHeader||!n)return le;var r=e-t._col;if(0<=r&&r<n.length){var o=n[r];if(o){var i=o.name();return re(i)||(i=K(i)),i}}return le},_setHeaderName:function(e,t){var n=this,r=n._columns;if(n._showHeader&&r){var o=r.length,i=e-n._col;if(0<=i&&i<o){var a=r[i];if(a){var s=n._getSheet();if(s){s._getModel()._updateDirty(n._row,e,{_oldValue:a.name()})}var l=a.name();a.name(t);for(var u=0;u<o;u++){var c=r[u],f=c&&c.dataAreaFormula();f&&f.indexOf(l)>=0&&c.dataAreaFormula(f.replace(new RegExp(l,"g"),a.name()))}n._onColumnNameChanged(l,a.name())}}}},_setFooterFormula:function(e,t){var n=this,r=n._columns;if(n._showFooter&&r){var o=e-n._col;if(0<=o&&o<r.length){var i=r[o];i&&i.footerFormula(t)}}},_setFooterValue:function(e,t){var n=this,r=n._columns;if(n._showFooter&&r){var o=e-n._col;if(0<=o&&o<r.length){var i=r[o];if(i){if(t!==i.footerValue()){var a=n._getSheet();if(a){a._getModel()._updateDirty(n._row+n._rowCount-1,e,{_oldValue:i.footerValue()})}}i.footerValue(t)}}}},_newAutoId:function(){var e=this._columns,t=e&&e.length;if(0===t)return-1;for(var n,r=[],o=0;o<t;o++)(n=e[o])&&n._isAutoId()&&r.push(n.id());if(r.sort(function(e,t){return e-t}),(t=r.length)>0){for(o=0;o<t;o++)if(r[o]!==o+1)return o+1;return t+1}return 1},_getNoConflictTableColumnName:function(e){for(var t=e,n=2;this._hasColumnName(t);)t=e+n++;return t},_syncHeader:function(e,t){var n,r=this,o=r._columns;if(r._showHeader&&o&&(n=r._getSheet())){var a,s=o.length,l=r.headerIndex(),u=r._col;re(e)&&(e=0),re(t)&&(t=s);for(var c,f=ce(s,e+t),d=n._getModel(),p=e;p<f;p++)if(a=o[p]){var h=r._owner._tableList,m=ee(r,h);if(m>-1&&h.splice(m,1),c=n.getText(l,u+p),m>-1&&h.splice(m,0,r),i(n,l,u+p,le),c){V&&n._recalcCell(d,l,u+p);var g=r._getNoConflictTableColumnName(c);g===c?a.name(c):n.setText(l,u+p,g)}else n.setText(l,u+p,a.name())}}},_syncFooter:function(e,t){var n,r=this,o=r._columns;if(r._showFooter&&o&&(n=r._getSheet())){var s,l=o.length,u=r.footerIndex(),c=r._col;re(e)&&(e=0),re(t)&&(t=l);for(var f,d,p=ce(l,e+t),h=e;h<p;h++)(s=o[h])&&(f=n.getFormula&&n.getFormula(u,c+h),f?s.footerFormula(f):r._ignoreFormula||i(n,u,c+h,s.footerFormula()),d=n.getValue(u,c+h),re(d)?a(n,u,c+h,s.footerValue()):s.footerValue(d))}},_clearHeader:function(e,t){var n=this,r=n._columns;if(n._showHeader&&r){var o,i=r.length;re(e)&&(e=0),re(t)&&(t=i);for(var a=ce(i,e+t),s=e;s<a;s++)if(o=r[s]){var l=o.name();o.name(le),n._onColumnNameChanged(l,o.name())}}},_clearDataRange:function(e){var t=this,n=t.dataRange();if(n.containsRange(e)){for(var r=e.row,o=e.col,i=d(e),a=p(e),s=[],l=0;l<i;l++)for(var u=0;u<a;u++)t._setValue(r+l,o+u,le),s.push({columnName:t.getColumnName(o+u-n.col),row:r+l-n.row,data:""});var c=t._slicerData;c&&c.onDataChanged(s)}},_clearFooter:function(e,t){var n=this,r=n._columns;if(n._showFooter&&r){var o;re(e)&&(e=0),re(t)&&(t=r.length);for(var i=ce(r.length,e+t),a=e;a<i;a++)(o=r[a])&&(o.footerFormula(le),o.footerValue(le))}},_syncSheetByFooter:function(){var e=this,t=e._columns;if(e._showFooter&&t){var n=e._getSheet();if(n)for(var r,o,s=t.length,l=e._col,u=e.footerIndex(),c=0;c<s;c++)(r=t[c])&&(o=l+c,a(n,u,o,r.footerValue()),i(n,u,o,r.footerFormula()))}},_clearSheetRow:function(e){var t=this,n=t._getSheet();if(n&&!(e<0||n.getRowCount()<=e))for(var r,o=t._col,s=t._colCount,l=0;l<s;l++)r=o+l,i(n,e,r,le),a(n,e,r,le)},_onRowsAdded:function(e,t,n){var r=this,o=!1;if(e>=r._row+r._rowCount)return o;var i=r._row,a=r._row+r._rowCount-1;return e<=i?r._row+=t:e<=a&&(n||(o=r._updateDataSourceOnAddRows(e,t)),r._rowCount+=t),o},_onRowsAdded2:function(e,t){var n=this;e<=n._row+n._rowCount-1&&n._updateFormulaOnAddRows(e,t);var r=n._slicerData,o=n.dataRange(),i=o.row,a=n.endRow();e>=i&&e<=a&&r&&r.onRowsAdded(e-i,t),n._rowFilter&&n._rowFilter._onRowsAdded(e,t)},_updateDataSourceOnAddRows:function(e,t){var n=this,r=n._row,o=n._bindingManager;return!!o&&(o._addItems(e-(n.showHeader()?r+1:r),t),!0)},_updateFormulaOnAddRows:function(e,t){if(V){var n=this,r=n._getSheet();c(r),te(n._columns,function(o,a){var s=a.dataAreaFormula();if(s)for(var l=o+n._col,u=e;u<e+t;u++)i(r,u,l,s)}),f(r,!1)}},_onColumnsAdded:function(e,t){var n=this;if(!(e>=n._col+n._colCount)){var r=n._col;if(e<=n._col)n._col+=t;else if(e<n._col+n._colCount){n._colCount+=t;var o=n._columns;if(o)for(var i=0;i<t;i++){var a=new v(n._newAutoId());o.splice(e+i-n._col,0,a)}}if(n._rowFilter&&n._rowFilter._onColumnsAdded(e,t),e>=r){var s=n._slicerData;s&&s.onColumnsAdded(e-r,t)}}},_onRowsRemoved:function(e,t,n){var r=this,o=!1;if(e>=r._row+r._rowCount)return o;var i=r.dataRange(),a=i.row,s=d(i),l=r._row,u=r._row+r._rowCount-1;if(e<l)e+t<=l&&(r._row-=t);else if(e===l){if(!r._showHeader&&(r._rowCount-=ce(u-e+1,t),!n)){var c=r._bindingManager;c&&(c._removeItems(e-(r.showHeader()?l+1:l),ce(u-e+1,t)),o=!0)}}else e<=u&&(r._rowCount-=ce(u-e+1,t),n||(c=r._bindingManager)&&(c._removeItems(e-(r.showHeader()?l+1:l),ce(u-e+1,t)),o=!0),e===u&&r._showFooter&&(r._showFooter=!1));if(r._rowFilter&&r._rowFilter._onRowsRemoved(e,t),e>=a&&e<a+s){var f=r._slicerData;f&&f.onRowsRemoved(e-a,t)}return o},_onColumnsRemoved:function(e,t){var n=this,r=n._columns;if(!(e>=n._col+n._colCount)){var o=n._col,i=n._col,a=n._col+n._colCount-1;if(e<i?e+t<=i?n._col-=t:(n._col=e,n._colCount-=e+t-i,r&&r.splice(0,e+t-i)):(n._colCount-=ce(a-e+1,t),r&&r.splice(e-i,ce(a-e+1,t))),n._rowFilter&&n._rowFilter._onColumnsRemoved(e,t),e>=o){var s=n._slicerData;s&&s.onColumnsRemoved(e-o,t)}}},_clear:function(e,t,n,r){var o=this,i=n,a=r,s=o._getSheet();s&&(i=s.getRowCount(),a=s.getColumnCount());var l=e<0?0:e,u=t<0?0:t,c=e<0?i:n,f=t<0?a:r,d=W(l,u,c,f),h=o.headerIndex();if(o._showHeader&&l<=h&&h<l+c){var m=W(h,o._col,1,o._colCount),g=d.getIntersect(m,i,a);g&&o._clearHeader(g.col-o._col,p(g))}var _=o.dataRange(),v=d.getIntersect(_,i,a);v&&o._clearDataRange(v);var y=o.footerIndex();if(o._showFooter&&l<=y&&y<l+c){var b=W(y,o._col,1,o._colCount);g=d.getIntersect(b,i,a),g&&o._clearFooter(g.col-o._col,p(g))}o._rowFilter&&o._rowFilter._clear(e,t,n,r)},toJSON:function(){var e=this,t=e.style(),n=e._rowFilter,r="columns",o={name:[e.name(),le],row:[e._row,-1],col:[e._col,-1],rowCount:[e._rowCount,-1],colCount:[e._colCount,-1],showHeader:[e._showHeader,!0],showFooter:[e._showFooter,!1],highlightFirstColumn:[e.highlightFirstColumn(),!1],highlightLastColumn:[e.highlightLastColumn(),!1],bandRows:[e.bandRows(),!0],bandColumns:[e.bandColumns(),!1],style:[t?t.toJSON():le,le],autoGenerateColumns:[e.autoGenerateColumns(),!0],bindingPath:[e.bindingPath(),ue],rowFilter:[n?n.toJSON():le,le]};o[r]=[[]];for(var i=0;i<e._columns.length;i++)o[r][0][i]=e._columns[i].toJSON();o[r][1]=le;var a={};for(var s in o){var l=o[s];l[0]!==l[1]&&(a[s]=l[0])}return ne(a)?ue:a},fromJSON:function(e,t){if(e){var n=this;te([he,me,ge,_e,ve,ye],function(t,r){G(e[r])&&n[r](e[r],!1)});var r=e.row;G(r)&&(n._row=r);var o=e.col;G(o)&&(n._col=o);var i=e.rowCount;G(i)&&(n._rowCount=i);var a=e.colCount;G(a)&&(n._colCount=a);var s=e.showHeader;G(s)&&(n._showHeader=s);var l=e.showFooter;G(l)&&(n._showFooter=l);var u=e.style;if(u){var c=new b;c.fromJSON(u,t),n.style(c)}var f=e.dataSource,d=e.dataBinding,p=e.bindingPath;if(t)f&&ae&&(n._bindingManager=new ae,n._bindingManager.bind(f)),d&&ae&&(n._bindingManager=new ae,n._bindingManager.fromJSON(d,t));else if(p){n._bindingPath=p;var h=n._getSheet(),m=h&&h.getDataSource&&h.getDataSource();if(ie&&m instanceof ie){var g=se(m.getSource(),p);g&&(n._bindingManager=new ae,n._bindingManager.bind(g))}}var _=e.columns;if(_)for(var y,w,C=_,S=C.length,x=n._columns=[],T=0;T<S;T++){w=C[T],y=new v(n._newAutoId()),y.fromJSON(w,t);var E=y.name(),M=n._getNoConflictTableColumnName(E);x.push(y),M!==E&&n.setColumnName(T,M)}var A=e.rowFilter;if(A){var k=be&&new be;k&&(k.table(n),k.fromJSON(A,t),n._rowFilter=k,n._rowFilter.reFilter())}}},startRow:function(){return this._row},startColumn:function(){return this._col},endRow:function(){return this._row+this._rowCount-1},endColumn:function(){return this._col+this._colCount-1},hasHeadersRow:function(){return this._showHeader},hasTotalsRow:function(){return this._showFooter},tableName:function(){return this.name()},getColumnIndexInTable:function(e){e=e.toLowerCase();var t=-1,n=H._StringHelper._replace(e,"\r\n","\n");return re(e)||te(this._columns,function(r,o){var i=o.name().toString().toLowerCase();if(i===e||i===n)return t=r,!1}),t},source:function(){var e=this._getSheet();return e._getSheetSource&&e._getSheetSource()},_applyBindingPath:function(){var e=this,t=e._getSheet();if(t){var n=e.bindingPath();if(n){var r=t.getDataSource&&t.getDataSource();if(ie&&r instanceof ie){var o=se(r.getSource(),n);if(o){var i=e.dataRange(),a=i.row,u=d(i),c=new ae;c.bind(o);var f=c.getRowCount();try{s(t),e._bindingManager=le,f>u?t.addRows(a+u,f-u):f<u&&t.deleteRows(a+f,u-f),e._bind(c);var p=V&&t._getCalcServiceInternal();p&&!p.IsSuspended()&&t.recalcAll()}finally{l(t)}}}}}},clone:function(){var e=this,t=new _,n=de(e.toJSON());return t._setOwner(e._owner),t.fromJSON(pe(n)),t},_copyDataSourceImp:function(e){var t=new ae;t.bind(e),this._bindingManager=t},_copyDataSource:function(e){if(e&&!e.bindingPath()){var t=e._bindingManager;t&&this._copyDataSourceImp(t.getSource())}},_getDataSource:function(){var e=this._bindingManager;return e?e.getSource():le},_getDataSourceRowCount:function(){var e=this._bindingManager;return e?e.getRowCount():0},sort:function(e,t){var n=this,r=n._getSheet(),o=n.dataRange(),i=n.rowFilter();r&&0<=e&&e<o.colCount&&(r.suspendPaint(),r.sortRange(o.row,o.col,o.rowCount,o.colCount,!0,[{index:e+o.col,ascending:t}]),i&&(i._sortInfo={index:e+o.col,ascending:t}),r.resumePaint())}},F.Table=_;var be=function(e){function t(t){var n=this;e.call(n),n.table(t)}return e?($.inherit(t,e),$.extend(t.prototype,{_getStartCol:function(){return 0},_getEndCol:function(){return this.range.colCount},table:function(e){var t=this;if(0===arguments.length)return t._table;t._table=e,e&&(t._sheet=e._getSheet())},_onRowsAdded:function(t,n){var r=this,o=r._table;e&&e.prototype._onRowsAdded.call(r,t,n),o&&r._setRangeInternal(o.dataRange())},_onRowsRemoved:function(t,n){var r=this,o=r._table;e&&e.prototype._onRowsRemoved.call(r,t,n),o&&r._setRangeInternal(o.dataRange())}}),t):le}(B),we="bold 11pt calibri",Ce="Column",Se="id",xe="dataField",Te="footerFormula",Ee="dataAreaFormula",Me="footerValue",Ae=[Se,he,xe,Te,Ee,Me];v.prototype={id:Y(Se,ue,function(e){var t=this;t.name()||t.name(Ce+e)}),_isAutoId:function(){return this.id()>0},name:Y(he,ue,function(e){if(!e){var t=this;t.name(Ce+t.id())}}),dataField:Y(xe),footerValue:Y(Me),dataAreaFormula:Y(Ee),footerFormula:Y(Te),toJSON:function(){var e=this,t={};return te(Ae,function(n,r){var o=e[r]();o&&(t[r]=o)}),ne(t)?ue:t},fromJSON:function(e){if(e){var t=this;te(Ae,function(n,r){var o=e[r]!==ue?e[r]:e["_"+r];o&&t[r](o,!1)})}}},F.TableColumn=v;var ke="borderLeft",Re="borderTop",Ie="borderRight",Oe="borderBottom",De="borderHorizontal",Pe="borderVertical",Ne=["backColor","foreColor","font",ke,Re,Ie,Oe,De,Pe,"textDecoration"];y.prototype={_compose:function(e,t,n,r,o){var i=this;te(Ne,function(a,s){s.indexOf("border")>=0?(n&&G(i[ke])&&!G(e[ke])&&(e[ke]=i[ke],e[ke].level=20),t&&G(i[Re])&&!G(e[Re])&&(e[Re]=i[Re],e[Re].level=20),o&&G(i[Ie])&&!G(e[Ie])&&(e[Ie]=i[Ie],e[Ie].level=20),r&&G(i[Oe])&&!G(e[Oe])&&(e[Oe]=i[Oe],e[Oe].level=20),r||!G(i[De])||G(e[Oe])||(e[Oe]=i[De],e[Oe].level=20),o||!G(i[Pe])||G(e[Ie])||(e[Ie]=i[Pe],e[Ie].level=20)):G(i[s])&&!G(e[s])&&(e[s]=i[s])})},_clone:function(){var e=new y,t=de(this.toJSON());return e.fromJSON(pe(t)),e},toJSON:function(){var e=this,t={};return te(Ne,function(n,r){var o=e[r];t[r]=o&&o.toJSON?o.toJSON():o}),t},fromJSON:function(e,t){if(e){var n=this;te(Ne,function(r,o){var i=e[o];if(G(i))if(o.indexOf("border")>=0){var a=new Z;a.fromJSON(i,t),n[o]=a}else n[o]=i})}}},F.TableStyle=y;var Fe="headerRowStyle",Le="footerRowStyle",He="wholeTableStyle",Ve="highlightLastColumnStyle",je="highlightFirstColumnStyle",Be="firstRowStripStyle",Ue="secondRowStripStyle",We="firstColumnStripStyle",ze="secondColumnStripStyle",Ye="firstHeaderCellStyle",Ge="lastHeaderCellStyle",Ke="firstFooterCellStyle",Xe="lastFooterCellStyle",qe=[Fe,Le,He,Ve,je,Be,Ue,We,ze,Ye,Ge,Ke,Xe],Je="firstRowStripSize",Ze="secondRowStripSize",Qe="firstColumnStripSize",$e="secondColumnStripSize",et=[Je,Ze,Qe,$e];b.prototype={name:Y(he),builtInName:Y("builtInName"),toJSON:function(){var e=this,t=e.builtInName();if(t)return{buildInName:t};var n,r={name:e.name()};return te(qe,function(t,o){(n=e[o]())&&(r[o]=n.toJSON())}),te(et,function(t,o){1!==(n=e[o]())&&(r[o]=n)}),ne(r)?ue:r},fromJSON:function(e,t){function n(e,t){var n=e;n.name(t.name()),te(et,function(e,r){n[r](t[r]())}),te(qe,function(e,r){var o=t[r]();n[r](o?o._clone():le)}),n.builtInName(t.builtInName(),!1)}if(e){var r=this,o=e.buildInName;if(o)return void n(r,rt[o.toLowerCase()]);var i=e.name,a=G(i)?i:e._name;G(a)&&r.name(a,!1),te(et,function(t,n){var o=e[n]!==ue?e[n]:e["_"+n];o&&r[n](o,!1)}),te(qe,function(n,o){var i=e[o]!==ue?e[o]:e["_"+o];if(i){var a=new y;a.fromJSON(i,t),r[o](a,!1)}})}}},te(qe,function(e,t){b.prototype[t]=Y(t)}),te(et,function(e,t){b.prototype[t]=Y(t,1)}),F.TableTheme=b;for(var tt="white",nt="black",rt={},ot=1;ot<=28;ot++)ot<=21&&(rt["light"+ot]=S(ot)),ot<=11&&(rt["dark"+ot]=O(ot)),rt["medium"+ot]=M(ot);F.TableThemes=rt,N.prototype={add:function(e,t,n,r,o,i,a){var s=this;return s._checkCanAddTable(s._sheet,e,t,n,r,o,!0),s._addInternal(new _(e,t,n,r,o,i||rt.medium2,a))},addFromDataSource:function(e,t,n,i,a,s){if(i||o(r().Exp_TableDataSourceNullError),ae){var l=this,u=l._sheet;u.suspendPaint();var c=new ae;c.bind(i);var f=c.getRowCount()+1,d=c.getColumnCount(),p=l.add(e,t,n,f,d,a,s);return p._bind(c),u.clearPendingChanges(),u.resumePaint(),p}},find:function(e,t){for(var n,r=this._tableList,o=r.length,i=0;i<o;i++){n=r[i];var a=n.range();if(a.row<=e&&e<a.row+d(a)&&a.col<=t&&t<a.col+p(a))return n}return le},findByName:function(e){for(var t,n=this._tableList,r=n.length,o=0;o<r;o++)if(t=n[o],t.name().toLowerCase()===e.toLowerCase())return t;return le},_findByRange:function(e,t,n,r){for(var o,i=this._tableList,a=i.length,s=[],l=0;l<a;l++)o=i[l],o.range().intersect(e,t,n,r)&&s.push(o);return s},_addInternal:function(e){if(e){var t=this;t.findByName(e.name())&&o(r().Exp_TableHasSameNameError);var n=t._sheet;return n.suspendPaint(),e._setOwner(t),t._tableList.push(e),e._applyBindingPath(),e.showHeader()&&e._syncHeader(),e.showFooter()&&e._syncFooter(),t._onTableAdded(e),n.resumePaint(),e}},_removeInternal:function(e){var t=this,n=ee(e,t._tableList);return n>-1?(t._tableList.splice(n,1),t._onTableRemoved([e],!1),e):le},remove:function(e,t){var n=this;if("string"==typeof e&&(e=n.findByName(e)),e&&(t=t||0,e=n._removeInternal(e)))try{var r=e.range(),o=n._sheet;s(o);var u,c,f=r.row,h=r.row+d(r),m=r.col,g=r.col+p(r);if(1!=(1&t))for(u=f;u<h;u++)for(c=m;c<g;c++)i(o,u,c,le),a(o,u,c,le);else if(e.showHeader())for(u=e.headerIndex(),c=m;c<g;c++)o.setValue(u,c,e.getColumnName(c-r.col));if(2==(2&t))for(u=f;u<h;u++)for(c=m;c<g;c++){var _=o.getStyle(u,c)||new Q;e._compose(u,c,_),o.setStyle(u,c,_)}}finally{l(o)}return e},move:function(e,t,n){var r=this,o=r._sheet;if("string"==typeof e&&(e=r.findByName(e)),e&&t>=0&&n>=0){var i=e.range(),a=r._findByRange(t,n,d(i),p(i)),u=a.length;if(0===u||1===u&&a[0]===e){s(o);try{e._moveTo(t,n)}finally{l(o)}}}},resize:function(e,t){var n=this,r=n._sheet;if("string"==typeof e&&(e=n.findByName(e)),e){var o=e.range(),i=arguments,a=t;if(3===i.length&&(a=W(o.row,o.col,i[1],i[2])),a){var u=d(a),c=p(a);if(u>=0&&c>=0){if(n._findByRange(a.row,a.col,u,c).length<=1){s(r);try{e._resize(a)}finally{l(r)}}}}}},all:function(){var e=[];return te(this._tableList,function(t,n){e.push(n)}),e},_checkCanAddTable:function(e,t,n,i,a,s,l){if(!t)return l&&o(r().Exp_TableEmptyNameError),!1;if(!h(t))return l&&o(r().Exp_TableNameInvalid),!1;if(n<0||a<1||n+a>e.getRowCount())return l&&o(r().Exp_TableInvalidRow),!1;if(i<0||s<1||i+s>e.getColumnCount())return l&&o(r().Exp_TableInvalidColumn),!1;var u=e.tables;if(u._has(n,i,a,s))return l&&o(r().Exp_TableIntersectError),!1;if(u.findByName(t))return l&&o(r().Exp_TableHasSameNameError),!1;var c=V&&e._getsArrayFormulas(n,i,a,s),f=c&&c.ranges,m=!0;return f&&te(c,function(e,t){if(d(t)>1||p(t)>1)return l&&o(r().Exp_ArrayFormulaTable),m=!1,!1}),m},_hasPartTable:function(e,t,n,r){var o=this.all();if(o)for(var i,a=W(e,t,n,r),s=o.length,l=0;l<s;l++)if(i=o[l].range(),a.intersect(i.row,i.col,d(i),p(i))&&!a.containsRange(i))return!0;return!1},_has:function(e,t,n,r){for(var o,i=this._tableList,a=i.length,s=0;s<a;s++)if(o=i[s],o.range().intersect(e,t,n,r))return!0;return!1},_onRowsAdded2:function(e,t){for(var n=this,r=n._tableList,o=0,i=r.length;o<i;o++)r[o]._onRowsAdded2(e,t,n._updateDataSourceSuspended)},_onRowsAdded:function(e,t){for(var n=this,r=n._tableList,o=[],i=0,a=r.length;i<a;i++){var u=r[i],c=u._getDataSource();if(oe(o,c))u._onRowsAdded(e,t,!0);else{u._onRowsAdded(e,t,n._updateDataSourceSuspended)&&o.push(c)}}if(!n._updateDataSourceSuspended)try{var f=n._sheet;s(f),n._updateDataSourceSuspended=!0;var h,m;for(i=0,a=r.length;i<a;i++)if(u=r[i],h=u._getDataSourceRowCount(),m=u.dataRange(),h>0&&h!==d(m)){var g=h;u.showHeader()&&(g+=1),u.showFooter()&&(g+=1);var _=u.range(),v=W(_.row,_.col,g,p(m));u._resize(v,n._updateDataSourceSuspended)}}finally{n._updateDataSourceSuspended=!1,l(f)}},_onColumnsAdded:function(e,t){for(var n,r=this._tableList,o=r.length,i=0;i<o;i++)n=r[i],n._onColumnsAdded(e,t)},_onRowsRemoved:function(e,t){for(var n=this,r=n._tableList,o=[],i=[],a=[],u=0,c=r.length;u<c;u++){var f=r[u],h=f._getDataSource(),m=f.range();if(e<=m.row&&m.row+d(m)<=e+t)a.push(f);else{if(oe(o,h))f._onRowsRemoved(e,t,!0);else{f._onRowsRemoved(e,t,n._updateDataSourceSuspended)&&o.push(h)}i.push(f)}}n._tableList=i,n._onTableRemoved(a,!0);try{var g=n._sheet;s(g),n._updateDataSourceSuspended=!0,r=n._tableList;var _,v;for(u=0,c=r.length;u<c;u++)if(f=r[u],_=f._getDataSourceRowCount(),v=f.dataRange(),_>0&&_!==d(v)){var y=_;f.showHeader()&&(y+=1),f.showFooter()&&(y+=1);var b=f.range(),w=W(b.row,b.col,y,p(v));f._resize(w,n._updateDataSourceSuspended)}}finally{n._updateDataSourceSuspended=!1,l(g)}},_onColumnsRemoved:function(e,t){for(var n,r=this,o=r._tableList,i=[],a=[],s=o.length,l=0;l<s;l++){n=o[l];var u=n.range();e<=u.col&&u.col+p(u)<=e+t?a.push(n):(n._onColumnsRemoved(e,t),i.push(n))}r._tableList=i,r._onTableRemoved(a,!0)},_clear:function(e,t,n,r,o){var i,a,s,l=this,u=W(e,t,n,r),c=[];if(1==(1&o)){var f=[];i=l._tableList,a=i.length;for(var d=0;d<a;d++)s=i[d],u.containsRange(s.range())?c.push(s):f.push(s);for(a=f.length,d=0;d<a;d++)s=f[d],s._clear(e,t,n,r);l._tableList=f}if(2==(2&o))for(i=l._tableList,a=i.length,d=0;d<a;d++)s=i[d],u.containsRange(s.range())&&s.style(le);return l._onTableRemoved(c,!0),c},_onTableRemoved:function(e,t){e&&0!==e.length&&($.each(e,function(e,t){t._hasSlicerData()&&t.getSlicerData().onTableRemoved(t)}),V&&g(this._sheet,e,t))},_onTableAdded:function(e){e&&e._hasSlicerData()&&e.getSlicerData().onTableAdded(e)},_getNoConflictTableName:function(e){for(var t=1;this.findByName(e);)e="table"+t,t++;return e},_getValue:function(e,t){var n=this,r=!1,o=le,i=n.find(e,t);return i&&(i.showHeader()&&e===i.headerIndex()?(o=i._getHeaderName(t),re(o)||(o=K(o)),r=!0):(o=i._getValue(e,t),r=o._hasValue,o=o._value)),{_hasValue:r,_value:o}},_setValue:function(e,t,n){var r=this,o=!1,i=!0,a=r.find(e,t);return a&&(a.showHeader()&&e===a.headerIndex()?a._hasColumnName(n)?i=!1:a._setHeaderName(t,n):a.showFooter()&&e===a.footerIndex()?a._setFooterValue(t,n):o=a._setValue(e,t,n)),{isValueSet:o,isValid:i}},_setFormula:function(e,t,n,o,i){var a=this.find(e,t);if(V&&a){if(n>1||o>1)return this._sheet._raiseInvalidOperation(0,r().Exp_ArrayFormulaTable),!1;if(a.showHeader()&&e===a.headerIndex()&&i)return!1;a.showFooter()&&e===a.footerIndex()&&a._setFooterFormula(t,i)}return!0},_resetTablesBindingManager:function(){for(var e=this.all(),t=0,n=e.length;t<n;t++){var r=e[t];r.bindingPath()&&(r._bindingManager=le)}},_onCopyOrMoving:function(e,t){var n,r,o,i=[],a=this;if(a&&(n=a.all()))for(o=n.length-1;o>=0;o--)r=n[o],e.containsRange(r.range())&&(t&&(a._tableList.splice(o,1),r._clearSheetModelFormula()),i.push(r));return i},_onCopyOrMoved:function(e,t,n,r,o,i){for(var a=this,s=0,l=e.length;s<l;s++){var u,c,f=e[s];i?c=f:(u=f.bindingPath()?ue:f._getDataSource(),c=new _,c._setOwner(a),c.fromJSON(pe(de(f.toJSON()))),c.name(a._getNoConflictTableName(c.name())));var d=c.range();if(c._ignoreFormula=!0,c._moveToCore(r+d.row-t,o+d.col-n),a._addInternal(c),i){var p=c._slicerData;p&&(p._sheet=a._sheet,p.refresh())}else u&&c._copyDataSourceImp(u);c._ignoreFormula=!1}},_syncFormulaInTables:function(e){for(var t=0,n=e.length;t<n;t++)e[t]._syncSheetModelFormula()},toJSON:function(){var e=this._tableList,t=[];if(e)for(var n=0;n<e.length;n++)t.push(e[n].toJSON());return 0===t.length?ue:t},fromJSON:function(e,t){if(e)for(var n=0,r=e.length;n<r;n++){var o=e[n],i=new _;i._setOwner(this),i.fromJSON(o,t),this._tableList.push(i)}}},F.TableManager=N,F.TableRemoveOptions={none:0,keepData:1,keepStyle:2},e.exports=F},function(e,t,n){var r=n(127);n(128),r.SR={},r.SR.en=n(71),e.exports=r},function(e,t,n){function r(e){var t,n;return e&&0!==Fe(e)?0===e.indexOf(qe)?(n=parseInt(e.replace(qe,"")),t=Vn[qe+n]()):0===e.indexOf(Je)?(n=parseInt(e.replace(Je,"")),t=Vn[Je+n]()):Vn[e]&&(t=Vn[e]()):t=new Nn,t}function o(e,t,n){return new Fn(e,t,n)}function i(){var e=new Fn(0,"",""),t=new Nn(Ze,Qe,Be);return t.setBorders(e),t}function a(e){var t,n=17,r=16,o="Slicer"+Xe;return e.indexOf(o+"Light")>-1&&Fe(e)===n&&(t=parseInt(e[n-1])),e.indexOf(o+"Dark")>-1&&Fe(e)===r&&(t=parseInt(e[r-1])),t>=1&&t<=6}function s(){return new Ln}function l(e,t){e[kt](t)[Rt](t)[It](t)[Ot](t)}function u(e,t,n){var o=r();return o[ut](e)[lt](t)[st](n),o}function c(e){var t=cn+e;return Hn("Light",e,Be,Ze,o(1,$e,t),o(0,"",""),o(1,$e,t),Qe,t+",Lighter 60%",o(1,$e,dn),pn,t+",Lighter 80%",o(1,$e,hn),Qe,Ze,o(1,$e,hn),pn,Ze,o(1,$e,"#E0E0E0"),Qe,"#F9E36F",o(1,$e,dn))}function f(e){var t=cn+e;return Hn("Dark",e,Be,Ze,o(1,$e,t),o(0,"",""),o(1,$e,t),Ze,t,o(1,$e,t),t+",Darker 25%",t+",Lighter 60%",o(1,$e,t+",Lighter 60%"),Qe,"#C0C0C0",o(1,$e,"#C0C0C0"),"#959595","#DFDFDF",o(1,$e,"#DFDFDF"),Qe,"#F9E36F",o(1,$e,dn))}function d(e,t){var n=e._header,r=e._caption,o=g(e.slicerData),i=e.zoomFactor();if(t){t[St]&&(v(e._container,t[St],o,r,i),W(e,gn));var a=e._headerBorderDiv,s=h(t[St],t[xt]);if(y(t)){var l=s[_t],u=l&&l[ft]||0;a[Ke][it]=(e._headerHeight-u)*b(t)*i+Pt,_(a,l,o,_t),s[ht]=s[mt]=s[gt]=s[_t]=je}else a[Ke][_t+rt]=0+Pt,a[Ke][it]=n[Ke][it];v(n,s,o,r,i),W(e,vn);for(var c in e._itemsSet)if(Ee(e._itemsSet,c)){var f=parseInt(c);j(e,f)}}}function p(e,t,n){var r={};if(t&&n&&Fe(t)===Fe(n)){for(var o=0,i=Fe(t);o<i;o++)r[t[o]]=n[o];Re(e).css(r)}}function h(e,t){var n,r={};if(t)for(n in t)Ee(t,n)&&(r[n]=t[n]);if(e)for(n in e)r[n]===Ve&&e[n]!==Ve&&(r[n]=e[n]);return r}function m(e,t){if(!t)return e;var n;return e&&t&&t.getColor&&(n=t.getColor(e)),n}function g(e){var t=e&&e._getSheet&&e._getSheet();return t&&t.currentTheme()}function _(e,t,n,r){if(e){var o=t&&t[ft]||0,i=t&&t[dt]||"",a=t&&t[pt]||"";e[Ke][r+ot]=o+Pt,e[Ke][r+Xe]=i,e[Ke][r+tt]=m(a,n)}}function v(e,t,n,r,o){if(e&&t){var i=t[ut]||Qe,a=t[lt]||Ze,s=t[at]||Be;e[Ke][nt]=m(a,n),e[Ke][et]=m(i,n),e[Ke][at]=Ie._scaleFont(s,o)[at],_(e,t[ht],n,ht),_(e,t[mt],n,mt),_(e,t[gt],n,gt),_(e,t[_t],n,_t);var l=Ie._composeTextDecoration(t[vt]);we._StringHelper._contains(e.className,yn)?r[Ke][vt]=l:we._StringHelper._contains(e.className,Dn)&&(e[Ke][vt]=l)}}function y(e){var t=e[xt];if(!t||!(t[ht]||t[mt]||t[gt]||t[gt]))return!0;var n=h(e[St],t);return!(!(n[_t]&&n[_t][ft]>0)||n[ht]&&0!==n[ht][ft]||n[mt]&&0!==n[mt][ft]||n[gt]&&0!==n[gt][ft])}function b(e){if(!e)return 1;var t=h(e[St],e[xt]);if(!t||!t[at])return 1;var n=t[at],r=1,o=Ie._splitFont,i=Ie._normalizeFont,a=o(i(Be)).fontSize,s=o(i(n)).fontSize;if(a&&s){var l=Ue(a),u=Ue(s);isNaN(u)||(r=u/l)}return r}function w(e){var t=0,n=0;if(e){var r=e[Ke],o=r[ht+ot],i=r[mt+ot],a=r[gt+ot],s=r[_t+ot];o&&(t+=Ue(o)),i&&(n+=Ue(i)),a&&(t+=Ue(a)),s&&(n+=Ue(s))}return{widthOffset:t,heightOffset:n}}function C(e){var t,n=[];if(e)for(var r=0;r<Fe(e);r++)t=e[r]===Ve||e[r]===je||""===e[r]?Ae().Blank:String(e[r]),n.push(t);return n}function S(e){var t=De(Dt);return p(t,[Lt,Vt,rn,Yt],[Ht,6*e.zoomFactor(),on,Gt]),Re(t).addClass(_n),W(e,gn),Re(t).append(x(e)).append(T(e)),t}function x(e){var t=De(Dt),n=De(Dt),r=De("span"),o=De(Dt),i=e.zoomFactor(),a=e.style();p(t,[rt,Lt,jt,Ut,Wt,rn,Yt],[Kt,Ht,0,0,0,on,Gt]),Re(t).addClass(yn),e._header=t;var s=e._containerPadding*i;p(n,[rt,Lt,Ut,Wt,rn,Yt],[Kt,Ht,s,s,on,Gt]),Re(n).addClass(bn),e._headerBorderDiv=n,Re(t).append(n);var l=e._captionTop*b(a)*i,u=A(e)*i;p(r,[rn,Lt,jt,Yt,rt,Xt,Jt],[on,Ht,l,Gt,u,qt,Zt]),Re(r).text(e.captionName()).attr(Qt,$t).addClass(wn+" "+Pn),e._caption=r;var c=e._clearFilterWidth*i,f=e._clearFilterHeight*i,d=e._clearFilterTop*b(a)*i,h=e._clearFilterRight*i,m=e._fontSize*i+Pt;return p(o,[rt,it,Ft,Lt,jt,Wt,zt,rn,en,nn,Yt,tn],[c,f,Nt,Ht,d,h,"center",on,"normal",2,Gt,m]),Re(o).attr("title","Clear Filter (Alt+C)").attr(Qt,$t).text(sn).addClass(Sn+" "+Pn),e._clearFilter=o,W(e,vn),Re(n).append(r).append(o),t}function T(e){var t=De(Dt),n=De("table"),r=De("tr"),o=De("td"),i=De("td"),a=(e._headerHeight-e._containerPadding+e._headerMarginBottom)*b(e.style())*e.zoomFactor();p(t,[rt,Yt,Bt,rn],[Kt,Gt,a,on]),Re(t).attr(Qt,$t).addClass(Tn+" "+Pn),e._body=t,p(n,[rn,"border-spacing"],[on,0+Pt]),Re(n).attr(Qt,$t).addClass(En+" "+Pn),e._tb=n,Re(r).css(rn,on).addClass(Mn),e._tr=r,p(o,[Vt,rn],[0,on]),Re(o).addClass(An),e._td1=o,p(i,[Vt,rn,Ft],[0,on,Nt]),Re(i).addClass(kn),e._td2=i,Re(o).append(E(e));var s=P(e);return Re(i).append(s),e._scrollbar=s,Re(r).append(o).append(i),Re(n).append(r),Re(t).append(n),t}function E(e){var t,n,r=De(Dt),o=e.zoomFactor();e._itemsContainer=r,n=k(e),e._itemsContainerHeight=n,t=R(e),e._itemsContainerWidth=t,p(r,[rt,it,tn],[t*o,n*o,e._fontSize*o+Pt]),Re(r).attr(Qt,$t).addClass(In+" "+Pn);var i,a=D(e);e._sortedItems=a,i=Math.min(O(e),Fe(a));for(var s=0;s<i;s++){var l=a[s],u=M(e,l,s);Re(r).append(u),e._items.push(u),e._itemsSet[e._exclusiveDataTexts.indexOf(l)]=u}return r}function M(e,t,n){var r=t,o=De(an),i=e.zoomFactor(),a=e._itemMargin*i+Pt;return p(o,[zt,Jt,Bt,Ft,rn,nn,Vt,Yt,Xt,nt],[Ut,Zt,a,Nt,on,5,"1px 6px",Gt,qt,Ze]),Re(o).attr("type",an).attr(Qt,$t).text(r).addClass(Dn+" "+Pn),(n+1)%e.columnCount()!=0&&Re(o).css("margin-right",e._itemMargin*i+Pt),W(e,On,o),o}function A(e){var t,n,r=e._container,o=e._header,i=1,a=1,s=0,l=0,u=function(e){return e?Ue(e):0},c=ct+"Left"+ot,f=ct+"Right"+ot;return r&&(t=r.style,i=u(t[c]),a=u(t[f])),o&&(n=o.style,s=u(n[c]),l=u(n[f])),e.width()-(i+a)-2*e._containerPadding-(s+l)-e._clearFilterWidth}function k(e){var t=w(e._container),n=e.height()-2*e._containerPadding-t.heightOffset;return e.showHeader()?n-e._headerHeight*b(e.style())-e._headerMarginBottom:n}function R(e){var t=w(e._container),n=e.width()-2*e._containerPadding-t.widthOffset-1;return e._needShowScrollbar()?n-e._scrollbarWidth:n}function I(e,t){var n=e.columnCount();return(t-(n-1)*e._itemMargin)/n}function O(e){return Math.ceil(e._itemsContainerHeight/(e.itemHeight()+2*(e._itemVerticalPadding+e._itemBorderWidth)+e._itemMargin))*e.columnCount()}function D(e){var t,n=e._exclusiveDataTexts,r=e._orderBySortState(n.slice(0),e.sortState()),o=e.slicerData.getFilteredOutIndexes(e.columnName,2);if(e.showNoDataItems()){if(e.visuallyNoDataItems()&&e.showNoDataItemsInLast()){t=[];var i,a,s=Fe(r);for(i=0;i<s;i++)a=r[i],ke._contains(o,n.indexOf(a))||t.push(a);for(i=0;i<s;i++)a=r[i],ke._contains(o,n.indexOf(a))&&t.push(a);r=t}}else{t=r.concat();for(var l=0;l<Fe(t);l++)ke._contains(o,n.indexOf(t[l]))&&ke._remove(r,t[l])}var u=Ae().Blank;return ke._contains(r,u)&&(ke._remove(r,u),r.push(u)),r}function P(e){var t=new be._Scrollbar(!1);e._scrollbarObj=t;var n=t._getScrollbar();return Re(n).bind("scroll.gcScrollbar",function(t,n){var r=n.scrollEventType,o=n.scrollOrientation;if(t.data=e,1===o){[0,1,2,3,5].indexOf(r)>=0&&e._doScroll(t,n)}}),n}function N(e){var t=e.slicerData;e.data=t.getData(e.columnName),e.exclusiveDatas=t.getExclusiveData(e.columnName),e._dataTexts=C(e.data),e._exclusiveDataTexts=C(e.exclusiveDatas),e._sortedItems=D(e),U(e),V(e)}function F(e,t){var n=e.style(),r=e._container;if(r){t!==Ve&&t!==e.zoomFactor()&&(e.zoomFactor(t),d(e,n)),Re(r).css(Vt,6*t),W(e,gn),L(e);var o=e.showHeader()?(e._headerHeight+e._headerMarginBottom-e._containerPadding)*b(n)*t:0;Re(e._body).css(Bt,o),H(e),U(e)}}function L(e){var t=e.zoomFactor(),n=e._header,r=e._body,o=e._caption,i=e._clearFilter,a=e.style();if(e.showHeader()){e._container.firstChild!==n&&(Re(n).insertBefore(r),Re(r).css(Bt,(e._headerHeight+e._headerMarginBottom)*b(a)*t)),Re(n).css(it,e._headerHeight*b(a)*t);var s=e._containerPadding*t;p(e._headerBorderDiv,[Ut,Wt],[s,s]),o.innerHTML!==e.captionName()&&Re(o).text(e.captionName());var l=e._captionTop*b(a)*t,u=A(e)*t;p(o,[jt,rt,en],[l,u,"bold"]);var c=e._unSelectedItemIndexes;$(e,c&&Fe(c)>0?1:0);var f=e._clearFilterWidth*t,d=f,h=e._clearFilterTop*b(a)*t,m=e._clearFilterRight*t;p(i,[rt,it,jt,Wt],[f,d,h,m]),W(e,vn)}else Re(n).remove()}function H(e){var t=e.zoomFactor(),n=k(e);e._itemsContainerHeight=n;var r=R(e);e._itemsContainerWidth=r,p(e._itemsContainer,[rt,it,tn],[r*t,n*t,e._fontSize*t]),V(e)}function V(e){var t=e._sortedItems;if(t){var n=e._items;n&&Fe(n)>0&&Re(n).remove(),e._items=[],n=e._items,e._itemsSet={};for(var r=Math.min(O(e),Fe(t)),o=e._needShowScrollbar()?e._scrollbarObj.value()*e.columnCount():0,i=Math.min(o+r,Fe(t)),a=o;a<i;a++){var s=t[a],l=M(e,s,a);Re(e._itemsContainer).append(l),n.push(l),e._itemsSet[e._exclusiveDataTexts.indexOf(s)]=l}if(0!==Fe(n))for(var u in e._itemsSet)Ee(e._itemsSet,u)&&j(e,parseInt(u))}}function j(e,t){var n=e._hitInfo,r=n?e._exclusiveDataTexts.indexOf(n[un]):-1,o=e._unSelectedItemIndexes,i=e._noDataItemIndexes,a=e._itemsSet[t],s=0;t===r&&(s|=1),ke._contains(o,t)?s|=4:s|=2,ke._contains(i,t)&&e.visuallyNoDataItems()?s|=16:s|=8,B(e,a,s)}function B(e,t,n){var r,o=e.style();if(t&&o){switch(n){case 10:r=Tt;break;case 18:r=Et;break;case 12:r=Mt;break;case 20:r=At;break;case 11:r=kt;break;case 19:r=Rt;break;case 13:r=It;break;case 21:r=Ot}v(t,h(o[St],o[r]),g(e.slicerData),e._caption,e.zoomFactor()),W(e,On,t)}}function U(e){var t=e._scrollbar,n=e._td2;if(e._needShowScrollbar()){t||(t=P(e)),n.firstChild!==t&&(Re(n).append(t),H(e));var r=e.zoomFactor(),o=e._itemsContainerHeight,i=Math.floor(o/(e.itemHeight()+2*e._itemVerticalPadding+e._itemMargin)),a=e._scrollbarObj;a.value(e._scrollbarValue),a._width(e._scrollbarWidth*r,!1),a._height(o*r,!1),a._minimum(0),a._maximum(Math.ceil(Fe(e._exclusiveDataTexts)/e.columnCount())-i),a._pageValue(i),a._smallChange(1),a._largeChange(i-1),a._refreshLayout()}else{if(n.firstChild===t){var s=t.parentElement;s&&s.removeChild(t),H(e)}e._scrollbarValue=0}}function W(e,t,n){var r,o,i,a=e.zoomFactor();switch(t){case gn:var s=e._container,l=w(s),u=e._containerPadding;r=(e.width()-2*u)*a-l.widthOffset,o=(e.height()-2*u)*a-l.heightOffset,i=s;break;case vn:var c=e._header,f=w(c),d=e._headerHeight*b(e.style())*a-f.heightOffset;Re(c).css(it,d),r=e._clearFilterWidth*a,o=e._clearFilterHeight*a,i=e._clearFilter;break;case On:var h=w(n);r=I(e,e._itemsContainerWidth)*a-2*e._itemHorizontalPadding-h.widthOffset,o=e.itemHeight()*a-h.heightOffset,i=n}p(i,[rt,it],[r,o])}function z(e){var t=e._container,n=".slicer",r="mouse",o="wheel",i="DOMMouseScroll";t&&(Re(t).bind(r+"down"+n,function(t){e._doMouseDown(t)}).bind(r+"up"+n,function(t){e._doMouseUp(t)}).bind(r+"move"+n,function(t){e._doMouseMove(t)}).bind(r+"out"+n,function(t){e._doMouseLeave(t)}),t.addEventListener(r+o,function(t){e._doMouseWheel(t)},!1),t.addEventListener(i,function(t){e._doMouseWheel(t)},!1),Re(He).bind(r+"up"+n,function(t){Q(e,t)}).bind("keydown"+n,function(t){e._doKeyDown(t)}).bind("keyup"+n,function(t){e._doKeyUp(t)}),He.addEventListener(r+o,function(t){e._doMouseWheel(t)},!1),He.addEventListener(i,function(t){e._doMouseWheel(t)},!1))}function Y(e){var t=e._container;t&&Re(t).unbind(".slicer")}function G(e,t){var n=e.exclusiveDatas,r=e._unSelectedItemIndexes,o=J(e,t[un]),i=e._selectingItemIndexes,a=e._filteringItemIndexes;ke._contains(i,o)?ke._remove(i,o):i.push(o);for(var s=0;s<Fe(n);s++)ke._contains(r,s)||a.push(s);for(var l=0;l<Fe(i);l++)ke._contains(a,i[l])?ke._remove(a,i[l]):a.push(i[l]);if(0===Fe(a))for(var u=0;u<Fe(e._exclusiveDataTexts);u++)a.push(u);e._activeItemIndex=o}function K(e,t){var n=e._sortedItems,r=e._exclusiveDataTexts,o=r[e._activeItemIndex];q(e);for(var i=n.indexOf(o),a=n.indexOf(t[un]),s=Math.min(i,a),l=Math.max(i,a),u=s;u<=l;u++){var c=r.indexOf(n[u]),f=e._selectingItemIndexes,d=e._filteringItemIndexes;-1===f.indexOf(c)&&f.push(c),-1===d.indexOf(c)&&d.push(c)}}function X(e,t){q(e);var n=J(e,t[un]);j(e,n),e._selectingItemIndexes.push(n),e._filteringItemIndexes.push(n),e._activeItemIndex=n}function q(e){var t=e._items;if(t&&0!==Fe(t))for(var n=e._noDataItemIndexes,r=0,o=Fe(t);r<o;r++){var i=t[r],a=e._exclusiveDataTexts.indexOf(t[r].innerHTML),s=ke._contains(n,a)?20:12;B(e,i,s)}}function J(e,t){var n=e._exclusiveDataTexts;if(n)for(var r=0,o=Fe(n);r<o;r++)if(n[r]===t)return r;return-1}function Z(e,t){for(var n=e._unSelectedItemIndexes,r=e._noDataItemIndexes,o=0;o<Fe(t);o++){var i=0;e._isCtrlKeyDown?ke._contains(n,t[o])?i|=2:i|=4:i|=2,ke._contains(r,t[o])&&e.visuallyNoDataItems()?i|=16:i|=8,B(e,e._itemsSet[t[o]],i)}}function Q(e,t){var n=e._hitInfo;e._doMouseUp(t),n=n?new Bn(n[ln],n[un]):je,e._hitInfo=je,ee(e,n)}function $(e,t){var n=e._clearFilter;if(n){var r=e.style(),o=h(r[St],r[xt]),i=o&&o[lt];switch(i||(i=Ze),e._clearFilterNormalBackColor=i,t){case 0:e._isFiltered=!1,p(n,[et,nt],[e._clearFilterNonActivedForeColor,i]);break;case 1:e._isFiltered=!0,p(n,[et,nt],[e._clearFilterActivedForeColor,i]);break;case 2:Re(n).css(nt,e._clearFilterHoveredBackColor)}}}function ee(e,t){if(t){var n=e._selectingItemIndexes;switch(t[ln]){case 4:if(!e._clearFilter)return;e._isFiltered?$(e,1):$(e,0);break;case 5:var r=e._exclusiveDataTexts.indexOf(t[un]);n&&ke._contains(n,r)?Z(e,n):j(e,r)}}}function te(e,t){if(t)switch(t[ln]){case 4:if(!e._clearFilter||!e._isFiltered)return;$(e,2);break;case 5:j(e,e._exclusiveDataTexts.indexOf(t[un]));break;case 6:e._itemsContainer.style.cursor=Nt}}function ne(e,t){var n=e._items;if(n&&t!==je)for(var r=0;r<Fe(n);r++){var o=n[r];if(o.innerHTML.toLowerCase()===t.toLowerCase())return o}return je}function re(e,t){var n=oe(e,gn),r=je,o=je;if(!n)return je;var i=t.pageX,a=t.pageY,s=oe(e,vn),l=oe(e,Cn),u=oe(e,xn),c=oe(e,Rn);if(s&&s.contains(i,a))r=l&&l.contains(i,a)?4:1;else if(u&&u.contains(i,a)){var f=e._items;if(c&&c.contains(i,a)&&f){for(var d=0;d<Fe(f);d++){var p=oe(e,On,d);if(p&&p.contains(i,a)){r=5;for(var h in e._itemsSet)if(e._itemsSet[h]===f[d]){o=e._exclusiveDataTexts[h];break}break}}if(d>=Fe(f)){var m=oe(e,On,Fe(f)-1);r=a<m.y+e.itemHeight()*e.zoomFactor()?6:7}}else r=8}else r=0;return new Bn(r,o)}function oe(e,t,n){var r,o,i,a,s=t===gn?Ve:oe(e,gn),l=e._container,u=e._containerBorderWidth,c=e._containerPadding,f=e.zoomFactor(),d=e.style(),p=e.showHeader(),h=e._headerHeight,m=e._clearFilterWidth,g=e._exclusiveDataTexts;switch(t){case gn:r=0,o=0,i=l.offsetWidth,a=l.offsetHeight;do{r+=l.offsetLeft,o+=l.offsetTop,l=l.offsetParent}while(l);break;case vn:if(!s||!p)return je;r=s.x+u*f,o=s.y+u*f,i=e.width()*f,a=h*b(d)*f;break;case Cn:if(!s||!p)return je;r=s.x+s.width-(u+c+m)*f,o=s.y+u+e._captionTop*b(d)*f,i=m*f,a=e._clearFilterHeight*f;break;case xn:if(!s)return je;var _=u+c,v=0,y=h*b(d)+e._headerMarginBottom;r=s.x+_*f,o=s.y+v*f+(p?y*f:0),i=(e.width()-2*_)*f,a=s.height-2*v*f-(p?y*f:0);break;case Rn:var w=oe(e,xn);if(!w)return je;if(!e._needShowScrollbar())return w;r=w.x,o=w.y,i=w.width-e._scrollbarWidth*e.zoomFactor(),a=w.height;break;case On:if(!s||0===Fe(g)||n>=Fe(g))return je;var C=oe(e,Rn);if(!C)return je;var S=e.columnCount(),x=e._itemMargin;i=(C.width-(S-2)*x*f)/S,a=e.itemHeight()*f+2*e._itemBorderWidth,r=C.x+n%S*(i+x*f),o=C.y+Math.floor(n/S)*(a+x*f)}return new be.Rect(r,o,i,a)}function ie(e){return e>0}function ae(e,t,n){for(var r=e._table,o=r._getSheet(),i=r.dataRange(),a=i.row+i.rowCount-1,s=i.col+i.colCount-1,l=i.row;l<=a;l++){var u=[];t.push(u);for(var c=i.col;c<=s;c++)u.push({value:o.getValue(l,c),text:o.getText(l,c)})}for(c=0;c<i.colCount;c++){var f=r.getColumnName(c)||"";n.push(f)}}function se(e,t){var n=e._sheet,r=e._table.rowFilter();n.suspendPaint();for(var o=r&&r._filteredColumns||[],i=0;i<Fe(o);i++)le(e,t,[o[i]]);n.resumePaint()}function le(e,t,n){for(var r=0;r<n.length;r++){var o=e._table,i=e._rowFilter,a=n[r]-o.range().col,s=o.dataRange(),l=a+s.col,u=e.columnNames[a],c=[],f={};if(ke._contains(i._filteredColumns,l)){for(var d=[],p=s.row;p<s.row+s.rowCount;p++)i._isRowfilteredOutByColumn(p,l)||d.push(p);for(var h=0;h<Fe(d);h++){var m=d[h]-s.row,g=e.getExclusiveRowIndex(u,m);f[g]||(f[g]=!0,c.push(g))}}else for(var _=Fe(e.getExclusiveData(u)),v=0;v<_;v++)c.push(v);ue(ce(e,u),c)||(t.prototype.doFilter.call(e,u,{exclusiveRowIndexes:c}),e.onFiltered(),e._sheet._invalidate())}}function ue(e,t){var n=we._Types._isNullOrUndefined;if(n(e)&&n(t))return!0;if(n(e)&&!n(t)||!n(e)&&n(t)||!n(e)&&!n(t)&&(!(e instanceof Array)||!(t instanceof Array))||e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function ce(e,t){for(var n=e.getExclusiveData(t),r=e.getFilteredOutIndexes(t,1),o=[],i=0;i<Fe(n);i++)ke._contains(r,i)&&o.push(i);return o}function fe(e){var t=e._table,n=t._getSheet(),r=t&&t.rowFilter();return!n.options.isProtected||r&&r._canDoFilter(n)}function de(e,t){var n=e._slicerDatas;if(t){for(var r=t.getTable(),o=0;o<Fe(n);o++)if(n[o].getTable()===r)return;n.push(t)}}function pe(e,t){ke._remove(e._slicerDatas,t)}function he(e,t){for(var n=e._slicerDatas,r=0;r<Fe(n);r++){var o=n[r],i=o.getTable();if(o&&i&&i.tableName()===t)return o}return je}function me(e,t,n){var r;return t?Ee(ge(e),t)&&(r=Ae().Exp_SlicerNameExist):r=Ae().Exp_SlicerNameInvalid,r&&n&&(n.error=new Error(r)),!r}function ge(e){var t=e._sheet,n={},r=t&&t.parent&&t.parent.sheets;if(r)for(var o=0;o<Fe(r);o++){var i=r[o].slicers._getSlicerSet();for(var a in i)Ee(i,a)&&(n[a]=i[a])}return n}function _e(e,t,n){var r=e._slicerData;if(r){var o=r._getSheet(),i=o.slicers;i.all().forEach(function(r){r===e&&(i._rename(t,n),e.onPropertyChanged(Ge,n))})}}function ve(e){return e._slicerData.getTable()}function ye(e){return e._tableItemSlicers}var be=n(1),we=n(0),Ce=n(42),Se=n(62),xe=n(69),Te=n(18),Ee=we._hasOwnProperty,Me={},Ae=function(){return we._getResource(Me.SR)()},ke=we._ArrayHelper,Re=be.GC$,Ie=be._StyleHelper,Oe=be.Commands,De=be._util._createElement,Pe=be._util._defProperty,Ne=be._util._isDefined,Fe=ke._getLength,Le=Re.extend,He=document,Ve=void 0,je=null,Be="normal 11pt calibri",Ue=parseFloat;Le(be.Worksheet.prototype,{_updateTableSlicer:function(e,t,n,r,o){o===Ve&&(o=3);var i=this,a=i.tables;if(a)for(var s=0;s<n;s++)for(var l=0;l<r;l++){var u=s+e,c=l+t,f=a.find(u,c);if(3===o&&f&&f._hasSlicerData()){var d=f.dataRange();if(d.contains(u,c)){var p=f.getSlicerData();p&&p.onDataChanged([{columnName:f.getColumnName(c-d.col),row:u-d.row,data:{value:i.getValue(u,c),text:i.getText(u,c)}}])}}}}});var We={priority:900,init:function(){var e=this;e.slicers=new zn(e)},setHost:function(){var e=this;e.bind("tableRemoved",function(t,n){for(var r=n.tables,o=0;o<Fe(r);o++){var i=e.slicers,a=he(i,r[o].name());a&&pe(i,a)}})},toJson:function(e){var t=this.slicers.toJSON();t.length>0&&(e.slicers=t)},fromJson:function(e){e&&e.slicers&&this.slicers.fromJSON(e.slicers)},preProcessMouseWheel:function(e){var t=this.slicers;t&&t._mouseWheelSelectedSlicer(e.e)&&(e.r=!0)}};be.Worksheet._registerFeature("slicer",We);var ze=function(e){var t="unfilterSlicerByKey",n="filterSlicer",r="unfilterSlicer",o="changeSlicerProperty";e.register(t,Oe[t],67,!1,!1,!0,!1),e.register(n,Oe[n]),e.register(r,Oe[r]),e.register(o,Oe[o])},Ye={init:function(){ze(this.commandManager())}};be.Workbook._registerFeature("slicer",Ye);var Ge="name",Ke="style",Xe="Style",qe="light",Je="dark",Ze="white",Qe="black",$e="solid",et="color",tt="Color",nt="background-color",rt="width",ot="Width",it="height",at="font",st="setBorders",lt="back"+tt,ut="fore"+tt,ct="border",ft=ct+"Width",dt=ct+Xe,pt=ct+tt,ht=ct+"Left",mt=ct+"Top",gt=ct+"Right",_t=ct+"Bottom",vt="textDecoration",yt="WithData"+Xe,bt="WithNoData"+Xe,wt="electedItem",Ct="hovered",St="wholeSlicer"+Xe,xt="header"+Xe,Tt="s"+wt+yt,Et="s"+wt+bt,Mt="unS"+wt+yt,At="unS"+wt+bt,kt=Ct+"S"+wt+yt,Rt=Ct+"S"+wt+bt,It=Ct+"UnS"+wt+yt,Ot=Ct+"UnS"+wt+bt,Dt="div",Pt="px",Nt="default",Ft="cursor",Lt="position",Ht="absolute",Vt="padding",jt="top",Bt="margin-"+jt,Ut="left",Wt="right",zt="text-align",Yt="overflow",Gt="hidden",Kt="auto",Xt="text-overflow",qt="ellipsis",Jt="white-space",Zt="nowrap",Qt="unselectable",$t="on",en="font-weight",tn="font-size",nn="border-radius",rn="box-sizing",on="content-box",an="button",sn="✗",ln="mark",un="itemValue",cn="Accent ",fn="Slicer"+Xe,dn="#999999",pn="#828282",hn="#CCCCCC",mn="gc-slicer-",gn="container",_n=mn+gn,vn="header",yn=mn+vn,bn=mn+"header-borderDiv",wn=mn+"caption",Cn="clearfilter",Sn=mn+Cn,xn="body",Tn=mn+xn,En=mn+"table",Mn=mn+"tr",An=mn+"td1",kn=mn+"td2",Rn="itemscontainer",In=mn+Rn,On="item",Dn=mn+On,Pn="gc-no-user-select",Nn=function(){function e(e,n,r,o,i,a,s,l){for(var u=0,c=Fe(t);u<c;u++)this[t[u]](arguments[u])}for(var t=[lt,ut,at,ht,mt,gt,_t,vt],n={constructor:e,setBorders:function(e){this[ht](e)[mt](e)[gt](e)[_t](e)},fromJSON:function(e){if(e&&!Re.isEmptyObject(e)){var n=this;t.forEach(function(t){var r=e[t];if(Ne(r))if(t.indexOf(ct)>=0){var i=o();i.fromJSON(r),n[t](i,!1)}else n[t](r,!1)})}},toJSON:function(){var e=this,n={};return t.forEach(function(t){var r=e[t]();e[t].isDefault(r)||(n[t]=r&&r.toJSON?r.toJSON():r)}),n}},r=0,i=Fe(t);r<i;r++)n[t[r]]=Pe(t[r]);return e.prototype=n,e}(),Fn=function(){function e(e,r,o){for(var i=0;i<n;i++)this[t[i]](arguments[i])}for(var t=[ft,dt,pt],n=Fe(t),r=function(e,t,n){return Pe(e,t,n,function(t){var n=typeof t;return e===ft?"number"===n&&t>=0:"string"===n})},o={constructor:e,fromJSON:function(e){if(e&&!Re.isEmptyObject(e))for(var r=0;r<n;r++){var o=t[r];Ne(e[o])&&this[o](e[o],!1)}},toJSON:function(){for(var e={},r=0;r<n;r++)e[t[r]]=this[t[r]]();var o={};for(var i in e)e[i]!==Ve&&e[i]!==je&&(o[i]=e[i]);return o}},i=0;i<n;i++)o[t[i]]=r(t[i],Ve,Ve);return e.prototype=o,e}(),Ln=function(){function e(e,t,n,r){return Pe(e,t,n,r)}function t(){var e=this;e[Ge](""),e[St](i(),!1)}for(var n=[Ge,St,xt,Tt,Et,Mt,At,kt,Rt,It,Ot],o={constructor:t,name:e(Ge,""),fromJSON:function(e){if(e&&!Re.isEmptyObject(e)){var t=this,o=e.name;if(Ne(o)&&(t.name(o,!1),a(o))){var i=o.toLocaleLowerCase().replace("slicerstyle","").replace(" ",""),s=r(i);return void n.forEach(function(e){t[e](s[e](),!1)})}n.forEach(function(n){var o=e[n];if(n!==Ge&&Ne(o)){var i=r();i.fromJSON(o),t[n](i,!1)}})}},toJSON:function(){var e,t=this;e=a(t.name())?{name:t.name()}:t.toJSONInternal();var n={};for(var r in e)e[r]===je||e[r]===Ve||be.GC$.isEmptyObject(e[r])||(n[r]=e[r]);return n},toJSONInternal:function(){var e=this,t={},r="toJSON";t[Ge]=e.name();for(var o=1,i=Fe(n);o<i;o++){var a=n[o];t[a]=e[a]()?e[a]()[r]():je}return t}},s=1,l=Fe(n);s<l;s++)o[n[s]]=e(n[s]);return t.prototype=o,t}(),Hn=function(e,t,n,o,i,a,c,f,d,p,h,m,g,_,v,y,b,w,C,S,x,T){var E=s(),M=fn+e+t;E[Ge](M);var A=r();A[at](n)[lt](o)[st](i),E[St](A);var k=r();return k[ht](a)[mt](a)[gt](a)[_t](c),E[xt](k),E[Tt](u(f,d,p)),E[Et](u(h,m,g)),E[Mt](u(_,v,y)),E[At](u(b,w,C)),l(E,u(S,x,T)),E},Vn=function(){function e(){}for(var t=1;t<=6;t++)e["light"+t]=function(e){var t=e;return function(){return c(t)}}(t),e["dark"+t]=function(e){var t=e;return function(){return f(t)}}(t);return e.other1=function(){return Hn("Other",1,Be,Ze,o(1,$e,"#808080"),o(0,"",""),o(1,$e,"#A6A6A6"),Qe,"#BFBFBF",o(1,$e,dn),Qe,"#D9D9D9",o(1,$e,hn),Qe,Ze,o(1,$e,hn),"#959595",Ze,o(1,$e,"#E0E0E0"),Qe,"#F9E36F",o(1,$e,dn))},e.other2=function(){return Hn("Other",2,Be,Ze,o(1,$e,"#4F81BD"),o(0,"",""),o(1,$e,"#4F81BD"),Qe,"#A9C1E3",o(1,$e,dn),pn,"#D5E2F6",o(1,$e,hn),Qe,Ze,o(1,$e,hn),pn,Ze,o(1,$e,"#E0E0E0"),Qe,"#F9E36F",o(1,$e,dn))},e}(),jn=function(){function e(){F(this)}function t(){var e=this;e._sortedItems=D(e),F(e)}function n(t,n,r,o){return r||(r=e),be._util._defProperty(t,n,r,o)}function r(e,t,n){var r=this;r.name(e,!1),r._container=je,r._containerPadding=6,r._containerBorderWidth=1,r._fontSize=14,r._header=je,r._headerHeight=27,r._headerMarginBottom=5,r._caption=je,r._clearFilter=je,r._clearFilterWidth=28,r._clearFilterHeight=25,r._clearFilterTop=3,r._clearFilterRight=0,r._isFiltered=!1,r._captionTop=3,r._body=je,r._tb=je,r._tr=je,r._td1=je,r._td2=je,r._itemsContainer=je,r._itemsContainerWidth=0,r._itemsContainerHeight=0,r._scrollbar=je,r._tableBorderSpacing=2,r._items=[],r._itemsSet={},r._itemBorderWidth=1,r._itemVerticalPadding=1,r._itemHorizontalPadding=6,r._itemMargin=2,r._scrollbarWidth=17,r._scrollbarValue=0,r._clearFilterNormalBackColor=Ze,r._clearFilterHoveredBackColor="#F9E578",r._clearFilterActivedForeColor="red",r._clearFilterNonActivedForeColor="#B0ADB0",r._isMouseDownOnItem=!1,r._isMouseDownOnScrollbar=!1,r._selectingItemIndexes=[],r._filteringItemIndexes=[],r._activeItemIndex=0,r._sortedItems=[],r._unSelectedItemIndexes=[],r._noDataItemIndexes=[],r._exclusiveDataTexts=[],r._dataTexts=[],r.slicerData=t,r.columnName=n,r.data=t.getData(n),r.exclusiveDatas=t.getExclusiveData(n),r.slicerData.attachListener(r),r._onDataLoaded()}r.getDefaultStyle=function(){var e=function(e,t,n,r,o,i,a,s){var l={};return l[lt]=e,l[ut]=t,l[at]=n,l[ht]=r,l[mt]=o,l[gt]=i,l[_t]=a,l[vt]=s,l},t=function(e,t,n){var r={};return r[ft]=e,r[dt]=t,r[pt]=n,r},n=t(1,$e,"#808080"),r=t(0,"",""),o=t(1,$e,"#999999"),i=t(1,$e,"#CCCCCC"),a=t(1,$e,"#E0E0E0"),s=e("#F9E36F",Qe,Be,o,o,o,o),l={};return l[St]=e(Ze,Qe,Be,n,n,n,n),l[xt]=e(Ze,Qe,"bold 11pt calibri",r,r,r,t(1,$e,"#A6A6A6")),l[Tt]=e("#BFBFBF",Qe,Be,o,o,o,o),l[Et]=e("#D9D9D9",Qe,Be,i,i,i,i),l[Mt]=e(Ze,Qe,Be,i,i,i,i),l[At]=e(Ze,"#959595",Be,a,a,a,a),l[kt]=s,l[Rt]=s,l[It]=s,l[Ot]=s,l};for(var o=[[Ge],[rt,180],[it,210],["captionName",""],["columnCount",1,je,ie],["itemHeight",21,je,ie],["showHeader",!0],["sortState",1,t],["showNoDataItems",!0,t],["showNoDataItemsInLast",!0,t],["visuallyNoDataItems",!0,t],[Ke,r.getDefaultStyle(),function(e){d(this,e),F(this)}],["zoomFactor",1,je,ie],["isLocked"],["disableResizingAndMoving"]],i={constructor:r,_onDataLoaded:function(){var e=this;e._dataTexts=C(e.data),e._exclusiveDataTexts=C(e.exclusiveDatas),e._container=S(e),e.captionName(e.columnName,!1),z(e),e.onFiltered(),d(e,e.style()),F(e)},getDOMElement:function(){return this._container},_orderBySortState:function(e,t){var n=[];if(0!==t){for(var r=Ce._SortHelper.quickSort(e),o=0;o<Fe(r);o++)n[o]=r[o].value;return 2===t&&n.reverse(),n}},_needShowScrollbar:function(){var e=this,t=e._exclusiveDataTexts,n=e.showNoDataItems()?Fe(t):Fe(t)-Fe(e._noDataItemIndexes);return Math.ceil(n/e.columnCount())*(e.itemHeight()+2*(e._itemBorderWidth+e._itemVerticalPadding)+e._itemMargin)>e._itemsContainerHeight},_doScroll:function(e,t){this._scrollTo(e,t)},_scrollTo:function(e,t){var n=this,r=t.newValue;r!==n._scrollbarValue&&r<=n._scrollbarObj._maximum()&&(n._scrollbarValue=r,U(n),V(n))},onDataChanged:function(){N(this)},onRowsChanged:function(){N(this)},onColumnNameChanged:function(e,t){var n=this;n.columnName===e&&n._caption&&(n.columnName=t,n.captionName(t,!1),Re(n._caption).text(t))},onColumnRemoved:function(e){var t=this;e===t.columnName&&(t.slicerData.doUnfilter(e),Y(t),Re(t._container).remove(),t._container=je)},onFiltered:function(){var e=this,t=e.slicerData,n=e.columnName;e._sortedItems=D(e),e._noDataItemIndexes=t.getFilteredOutIndexes(n,2),e._unSelectedItemIndexes=t.getFilteredOutIndexes(n,1),F(e)},_doMouseDown:function(e){var t=this,n=re(t,e);n&&(8===n[ln]&&(t._isMouseDownOnScrollbar=!0),5===n[ln]&&(t._filteringItemIndexes=[],t._isMouseDownOnItem=!0,e.ctrlKey?G(t,n):e.shiftKey?K(t,n):X(t,n)),Z(t,t._selectingItemIndexes),(5===n[ln]||6===n[ln]||8===n[ln]||4===n[ln]&&t._isFiltered)&&e.stopPropagation())},_doMouseUp:function(e){var t=this,n=re(t,e);if(n){var r=t.slicerData,o=t._selectingItemIndexes,i=!1;4===n[ln]?t._isFiltered&&(r.doUnfilter(t.columnName),$(t,0),i=!0):o&&Fe(o)>0&&(t._isCtrlKeyDown||t._isShiftKeyDown||(r.doFilter(t.columnName,{exclusiveRowIndexes:t._filteringItemIndexes}),i=!0)),t._isMouseDownOnItem=!1,t._isMouseDownOnScrollbar=!1,i&&(t._selectingItemIndexes=[],t._filteringItemIndexes=[])}},_doMouseMove:function(e){var t=this,n=t._hitInfo,r=n?new Bn(n[ln],n[un]):je,o=re(t,e),i=t._exclusiveDataTexts,a=t._filteringItemIndexes;if(o&&(!r||r[ln]!==o[ln]||5===r[ln]&&r[un]!==o[un])){if(!t._isMouseDownOnItem)return t._hitInfo=o,ee(t,r),void te(t,o);if(5===o[ln]){var s,l,u,c,f=i.indexOf(o[un]),d=t._noDataItemIndexes;if(ke._contains(a,f)){var p=t._sortedItems,h=p.indexOf(i[t._activeItemIndex]),m=p.indexOf(o[un]),g=Math.min(h,m),_=Math.max(h,m),v=[];for(s=0,l=Fe(a);s<l;s++){var y=a[s];u=p.indexOf(i[y]),(u>_||u<g)&&v.push(y)}for(s=0,l=Fe(v);s<l;s++)u=v[s],c=ne(t,i[u]),ke._contains(d,u)?B(t,c,20):B(t,c,12),ke._remove(a,u)}else c=ne(t,i[f]),ke._contains(d,f)?B(t,c,18):B(t,c,10),ke._add(a,f)}t._hitInfo=o}},_doMouseLeave:function(){var e=this,t=e._hitInfo,n=t?new Bn(t[ln],t[un]):je;e._hitInfo=je,ee(e,n)},_doMouseWheel:function(e){return 8===re(this,e)[ln]&&(e.stopPropagation(),!0)},_doKeyDown:function(e){var t=this;17!==e.keyCode||t._isCtrlKeyDown||(t._isCtrlKeyDown=!0),16!==e.keyCode||t._isShiftKeyDown||(t._isShiftKeyDown=!0)},_doKeyUp:function(e){var t=this,n=t.slicerData;17===e.keyCode&&t._isCtrlKeyDown&&(t._isCtrlKeyDown=!1),16===e.keyCode&&t._isShiftKeyDown&&(t._isShiftKeyDown=!1),!t._isCtrlKeyDown&&!t._isShiftKeyDown&&Fe(t._selectingItemIndexes)>0&&(n.doFilter(t.columnName,{exclusiveRowIndexes:t._filteringItemIndexes}),t._selectingItemIndexes=[],t._filteringItemIndexes=[])}},a=0,s=Fe(o);a<s;a++)i[o[a][0]]=n(o[a][0],o[a][1],o[a][2],o[a][3]);return Re.extend(r.prototype,i),r}(),Bn=function(){function e(e,t){var n=this;n[ln]=e===Ve?je:e,n[un]=t===Ve?je:t}return e}(),Un=function(e){function t(t){var n=this,r=[],o=[],i=t.rowFilter();n._table=t,n._sheet=t._getSheet(),n._rowFilter=i,n._savedSlicers=je,ae(n,r,o),e.call(n,r,o),se(n,e),i&&(i.filterHandler=function(t){le(n,e,t.columns)})}Re.inherit(t,e);var n={constructor:t,_getSheet:function(){return this._sheet},getTable:function(){return this._table},doFilter:function(t,n,r){var o=this,i=o._sheet,a=o._table,s=o._rowFilter,l=n.ranges,u=n.exclusiveRowIndexes,c=!!u,f=o.getColumnIndex(t);if(!(f<0||!c&&!l))if(r)e.prototype.doFilter.call(o,t,n,r);else{var d=c?o.getExclusiveData(t):o.getData(t),p=[];if(c)p=u;else{var h=o._getSortedColumnDataCache(),m=o._getSorted2DataMapping();h[f]||o._sortOneCol(f);for(var g=h[f],_=0;_<Fe(l);_++)for(var v=l[_],y=o._getStartEndIndex(g,v),b=y.start;b<=y.end;b++)p.push(m[f][b])}i.suspendPaint();var w=a.startColumn()+f,C=a.dataRange().row;s&&(s._removeFilterItemsInternal(w),s._unfilterColumn(w)),i._refreshObjectsAboveSheet();var S=[];if(Te)for(var x=0;x<Fe(p);x++){var T=new Te._createCondition(2,0,d[p[x]]);s&&s.addFilterItem(w,T),S.push(T)}e.prototype._doFilterInternal.call(o,t,n);var E=[],M={};if(o._getFilteredExclusiveIndexes(t,E,M),s){for(var A=0;A<Fe(p);A++){var k=c?p[A]:o.getExclusiveRowIndex(t,p[A]);if(M[k])if(s._addFilteredItem(S[A]),c)for(var R=o.getRowIndexes(t,p[A]),I=0;I<Fe(R);I++)s._addFilteredInRowsWithColumnIndex(R[I]+C,w);else s._addFilteredInRowsWithColumnIndex(p[A]+C,w)}s._setColumnFilteredState(w,!0),s.onFilter(s._getFilterArgs(0,[w]))}o.onFiltered(),i.resumePaint()}},doUnfilter:function(t){var n=this,r=n._table,o=n.getColumnIndex(t),i=n._rowFilter;if(-1!==o){var a=r.startColumn()+o;i.removeFilterItems(a),e.prototype._doUnfilterInternal.call(n,t),i._unfilterColumn(a),i._setColumnFilteredState(a,!1),i.onFilter(i._getFilterArgs(0,[a])),n.onFiltered(),n._sheet._invalidate()}},refresh:function(){var e=this,t=[],n=[];ae(e,t,n),e._setDataSource(t,n),e._notifyListeners()},onColumnNameChanged:function(t,n){var r=this;e.prototype.onColumnNameChanged.call(r,t,n),r._sheet.slicers.all().forEach(function(e){e.columnName(n)})},onRowsAdded:function(t,n){var r=this,o=r._sheet,i=r._table,a=i.dataRange();e.prototype.onRowsAdded.call(r,t,n,!0);for(var s=t;s<t+n;s++)for(var l=0;l<Fe(r.columnNames);l++)r.data[s][l]={value:o.getValue(a.row+s,a.col+l),text:o.getText(a.row+s,a.col+l)};r._setDataSource(r.data,r.columnNames),r._notifyListeners(t,n,!0,"onRowsChanged")},onRowsRemoved:function(t,n){e.prototype._onRowsRemovedCore.call(this,t,n,!1)},onColumnsAdded:function(e,t){for(var n=this,r=n._sheet,o=n._table,i=o.dataRange(),a=n.data,s=n.columnNames,l=0;l<Fe(a);l++)for(var u=e;u<e+t;u++)a[l].splice(u,0,{value:r.getValue(i.row+l,i.col+u),text:r.getText(i.row+l,i.col+u)});for(var c=e;c<e+t;c++){var f=o.getColumnName(c)||"";s.splice(c,0,f)}n._setDataSource(a,s)},onColumnsRemoved:function(t,n){for(var r=this,o=r._sheet,i=r._table.name(),a=r.columnNames,s=[],l=t;l<t+n;l++)s.push(a[l]);e.prototype.onColumnsRemoved.call(r,t,n);var u=o&&o.slicers;s.forEach(function(e){u.all(i,e).forEach(function(e){u.remove(e.name())})})},onTableRemoved:function(e){var t=this;if(e&&e===t._table){t._savedSlicers=[];var n=t._sheet,r=n.slicers,o=e.name();r.all(o).forEach(function(e){t._savedSlicers.push(e),r.remove(e.name())}),r&&pe(r,t),t._listeners=[]}},onTableAdded:function(e){var t=this,n=t._sheet,r=n.slicers;r&&e&&e._hasSlicerData()&&de(r,e.getSlicerData()),(t._savedSlicers||[]).forEach(function(e){r._addInternal(e)})}};return Re.extend(t.prototype,n),t}(Ce.GeneralSlicerData);xe&&Re.extend(xe.Table.prototype,{getSlicerData:function(){var e=this;return e._slicerData||(e._slicerData=new Un(e)),e._slicerData}});var Wn=function(e){function t(t,n,r){e.call(this,t,n,r),this.isSelected(!1)}Re.inherit(t,e);var n={constructor:t,isSelected:Pe("isSelected",!1),sheet:Pe("sheet"),slicer:Pe("slicer"),_onDataLoaded:function(){var t=this,n=t.slicerData;n&&n instanceof Un&&(t.sheet(n._getSheet()),t._table=n.getTable()),e.prototype._onDataLoaded.call(this)},onColumnRemoved:function(e){var t=this,n=t.sheet(),r=t._table,o=t.slicerData;if(e===t.columnName){var i=o.getFilteredOutIndexes(e,1);0!==Fe(i)&&o.doUnfilter(e),n&&r&&n._floatingObjectModel._remove(t.name())}},_orderBySortState:function(e,t){var n=this,r=n.slicerData,o=r.getColumnIndex(n.columnName),i=n._table,a=i.dataRange(),s=[];if(0===t)return e;for(var l=[],u=r._getSheet(),c=0;c<Fe(e);c++){var f=r.getRowIndexes(n.columnName,c);l.push(u.getValue(a.row+f[0],a.col+o))}for(var d=Ce._SortHelper.quickSort(l),p=0;p<Fe(d);p++)s[p]=e[d[p].index];return 2===t&&s.reverse(),s},_doScroll:function(t,n){var r=this,o=r.sheet(),i=r.slicer();i&&o._canEditFloatingObject(i)||(n.newValue=n.oldValue);for(var a=ye(i),s=0;s<Fe(a);s++)e.prototype._scrollTo.call(a[s],t,n)},_doMouseDown:function(t){var n=this,r=n.sheet(),o=n.slicer();if(o&&r._canEditFloatingObject(o)){var i=re(n,t);if(!fe(n)&&(5===i[ln]||6===i[ln]||8===i[ln]))return void t.stopPropagation();for(var a=ye(o),s=0;s<Fe(a);s++)e.prototype._doMouseDown.call(a[s],t)}},_doMouseUp:function(e){var t=this,n=t.sheet(),r=t.slicer();if(r&&n._canEditFloatingObject(r)&&fe(t)){var o=re(t,e);if(o){var i=t.slicerData,a=t._selectingItemIndexes,s=t._filteringItemIndexes,l=i.getExclusiveData(t.columnName),u=!1,c=je;if(4===o[ln]||5===o[ln]&&Fe(s)===Fe(l)&&!t._isCtrlKeyDown&&!t._isShiftKeyDown){var f=i.getFilteredIndexes(t.columnName);c=n._commandManager().execute({cmd:"unfilterSlicer",sheetName:n.name(),slicerData:i,columnName:t.columnName,value:f}),u=!0}else if(a&&Fe(a)>0&&!t._isCtrlKeyDown&&!t._isShiftKeyDown){var d=i.getFilteredIndexes(t.columnName),p=s.concat();c=n._commandManager().execute({cmd:"filterSlicer",sheetName:n.name(),slicerData:i,columnName:t.columnName,oldValue:d,newValue:p}),u=!0}for(var h=ye(r),m=0,g=Fe(h);m<g;m++){var _=h[m];_._isMouseDownOnItem=!1,_._isMouseDownOnScrollbar=!1,u&&(_._selectingItemIndexes=[],_._filteringItemIndexes=[])}return!!c}}},_doMouseMove:function(t){var n=this,r=n.sheet(),o=n.slicer();if(o&&!n._isMouseDownOnScrollbar&&r._canEditFloatingObject(o))for(var i=ye(o),a=0;a<Fe(i);a++)e.prototype._doMouseMove.call(i[a],t)},_doMouseLeave:function(t){var n=this,r=n.sheet(),o=n.slicer();if(o&&r._canEditFloatingObject(o))for(var i=ye(o),a=0;a<Fe(i);a++)e.prototype._doMouseLeave.call(i[a],t)},_doMouseWheel:function(t){var n=this;if(e.prototype._doMouseWheel.call(this,t))return!0;var r=n.sheet(),o=r.slicers,i=o&&o._getSelectedSlicers(),a=n._scrollbarObj;return!!(i&&1===Fe(i)&&n.isSelected()&&n._needShowScrollbar()&&a)&&(a._scrollContainerMousewheel(t),t.stopPropagation(),!0)},_doKeyUp:function(e){var t=this,n=t.slicerData,r=t.sheet(),o=t._filteringItemIndexes;if(17===e.keyCode&&t._isCtrlKeyDown&&(t._isCtrlKeyDown=!1),16===e.keyCode&&t._isShiftKeyDown&&(t._isShiftKeyDown=!1),!t._isCtrlKeyDown&&!t._isShiftKeyDown&&Fe(t._selectingItemIndexes)>0){var i=Fe(n.getExclusiveData(t.columnName));if(Fe(o)===i){var a=n.getFilteredIndexes(t.columnName);r._commandManager().execute({cmd:"unfilterSlicer",sheetName:r.name(),slicerData:n,columnName:t.columnName,value:a})}else{var s=n.getFilteredIndexes(t.columnName),l=o.concat();r._commandManager().execute({cmd:"filterSlicer",sheetName:r.name(),slicerData:n,columnName:t.columnName,oldValue:s,newValue:l})}t._selectingItemIndexes=[],t._filteringItemIndexes=[]}}};return Re.extend(t.prototype,n),t}(jn),zn=function(){function e(e){var t=this;t._sheet=e,t._slicerDatas=[],t._slicerSet={}}return e.prototype={constructor:e,add:function(e,t,n,r){var o=this,i=o._sheet,a=i.parent,s=a._findTable(t);if(!s||-1===s.getColumnIndexInTable(n))return je;i.suspendPaint();var l=new Yn(e,s,n);return r&&l.style(r),o._addInternal(l),i._floatingObjectModel._add(l),i.resumePaint(),l},_addInternal:function(e){var t=this;if(e){var n=e.name(),r={};if(!me(t,n,r))throw r.error;t._slicerSet[n]=e,de(t,e._getSlicerData())}},get:function(e){return e===je||e===Ve?je:this._slicerSet[e]},remove:function(e){var t=this,n=t._sheet,r=t._slicerSet,o=t.get(e);if(o&&Ee(r,e)){for(var i=o._getSlicerData(),a=ye(o),s=0;s<Fe(a);s++)i.detachListener(a[s]);delete t._slicerSet[e],n._floatingObjectModel._remove(e)}},_rename:function(e,t){var n=this,r=n._sheet,o={};if(!me(n,t,o))throw o.error;var i=n._slicerSet[e];delete n._slicerSet[e],n._slicerSet[t]=i,r._floatingObjectModel._rename(e,t)},clear:function(){var e=this,t=e.sheet();t.suspendPaint(),Re.each(this._slicerSet,function(t){e.remove(t.name())}),t.resumePaint()},all:function(e,t){var n=[];return Re.each(this._slicerSet,function(r,o){e&&(ve(o).name()!==e||t&&o.columnName()!==t)||n.push(o)}),n},_getSlicerSet:function(){return this._slicerSet},_getAutoSlicerName:function(e){var t=ge(this);if(!Ee(t,e))return e;for(var n=1,r=" ",o=e.split(r)[0];Ee(t,o+r+n);)n++;return o+r+n},_getSelectedSlicers:function(){var e=this,t=e._slicerSet;if(!t||be.GC$.isEmptyObject(t))return[];var n=[];for(var r in t)if(Ee(t,r)){var o=t[r];o&&o.isSelected()&&n.push(o)}return n},_mouseWheelSelectedSlicer:function(e){var t=this,n=t._getSelectedSlicers();if(1!==Fe(n))return!1;var r=ye(n[0]);if(Fe(r)>0){for(var o=0;o<Fe(r);o++)r[o]._doMouseWheel(e);return!0}return!1},toJSON:function(){var e=this,t=[],n=e._slicerSet;if(n&&!be.GC$.isEmptyObject(n))for(var r in n)Ee(n,r)&&t.push(n[r].toJSON());return t},fromJSON:function(e){if(e&&0!==Fe(e)){var t=this,n=t._sheet,r=n.parent;t._slicerSet={};for(var o=0;o<Fe(e);o++){var i=e[o].tableName,a=e[o].columnName;if(i&&a){var s=r._findTable(i);if(s&&-1!==s.getColumnIndexInTable(a)){var l=new Yn(e[o].name,s,a);l.sheet(n),l.fromJSON(e[o]),n.slicers._addInternal(l),n._floatingObjectModel._add(l)}}}}}},e}(),Yn=function(e){function t(e,t,n,r){return R.push(e),Pe(e,t,function(t,r){n.call(this,e,t,r)},r)}function n(e){if(!e)return!1;var t=this,n=t._slicerData;if(e===t.name())return!1;if(n){var r=n._getSheet(),o=r&&r.slicers;if(o){var i={};if(!me(o,e,i))throw i.error}}return!0}function r(e,t){for(var n=this,r=n._tableItemSlicers||[],o=0;o<Fe(r);o++)r[o][e]&&("style"===e?r[o][e](t.toJSONInternal()):r[o][e](t));var i=n.sheet();n._trigger({sheet:i,sheetName:i?i._name:"",slicer:n,propertyName:e})}function o(t,n,r){e.call(this,t,E,M,A,k);var o,i,a=this;a.typeName=T,n&&(o=n._getSheet(),a.sheet(o),i=he(o.slicers,n.tableName())),i||(i=n.getSlicerData()),a._slicerData=i,a[d](r),a._tableItemSlicers=[],a._sourceName=r,a[u](T+"_"+r),a[c](r),a[C](!1),a[w](!1)}var i="name",a="width",l="height",u="nameInFormula",c="captionName",f="columnCount",d="columnName",p="itemHeight",h="showHeader",m="sortState",g="disableResizingAndMoving",_="showNoDataItems",v="showNoDataItemsInLast",y="visuallyNoDataItems",b="isSelected",w="dynamicMove",C="dynamicSize",S="tableName",x="style",T="Slicer",E=100,M=100,A=192,k=250;Re.inherit(o,e);for(var R=[],I=[[i,"",function(e,t,n){_e(this,n,t)},n],[c,"",r],[f,1,r,ie],[p,21,r,ie],[h,!0,r],[m,1,r],[g,!1,function(e,t){var n=this;n.allowMove(!t,!1),n.allowResize(!t,!1),r.call(n,g,t)}],[_,!0,r],[v,!0,r],[y,!0,r],[x,Vn.light1(),r],[d,"",function(e,t){this._sourceName=t,this.captionName(t,!1)}]],O={constructor:o,sourceName:function(){return this._sourceName},nameInFormula:t(u,"",r),onPropertyChanged:r,cloneContent:function(){var e=this,t=e.sheet(),n=e._slicerData,r=new Wn(e.name(),n,e.columnName());return r[a](e[a](),!1)[l](e[l](),!1)[c](e[c]())[f](e[f]())[p](e[p]())[h](e[h]())[m](e[m]()).isLocked(e.isLocked())[g](e[g]())[_](e[_]())[v](e[v]())[y](e[y]())[x](e[x]().toJSONInternal()).zoomFactor(t._zoomFactor)[b](e[b]()).slicer(e),r.sheet()!==t&&r.sheet(t),e._tableItemSlicers.push(r),r.getDOMElement()},_getSlicerData:function(){return this._slicerData},_needSaveJsonToFloatingObjects:function(){return!1},refresh:function(e){for(var t=this._tableItemSlicers,n=0;n<Fe(t);n++)F(t[n],e)},refreshContent:function(e){var t=this,n=t.sheet().zoom();n!==t._oldZoomFactor&&(t._oldZoomFactor=n,t.refresh(n))},clone:function(e){var t=this;!t.sheet()&&e&&t.sheet(e,!1);var n=new o(t.name(),ve(t),t.columnName());return n.sheet(t.sheet(),!1),n.fromJSON(t.toJSON(),!1,t._slicerData),n},fromJSON:function(t,n,r){var o=this,i=t.tableName,u=t[d];if(t&&!Re.isEmptyObject(t||!i||!u)){e.prototype.fromJSON.call(this,t);var c=o.sheet(),f=c.slicers,p=c.parent,h=r||he(f,i);if(!h){h=p._findTable(i).getSlicerData(),de(f,h)}o._slicerData=h,o[d](u);var m=t.x!==Ve?t.x:E,g=t.y!==Ve?t.y:M;if(o.position(new be.Point(m,g),!1),o[a](t[a]!==Ve?t[a]:A,!1),o[l](t[l]!==Ve?t[l]:k,!1),t.sourceName!==Ve&&(o._sourceName=t.sourceName),R.forEach(function(e){var n=t[e];n!==Ve&&o[e](n,!1)}),t.style!==Ve){var _=s();_.fromJSON(t.style),o.style(_,!1)}}},toJSON:function(){var e=this,t={};["x","y",a,l,w,C,"isLocked","fixedPosition"].forEach(function(n){var r=e[n]();e[n].isDefault(r)&&n!==w&&n!==C||(t[n]=r)});var n=e._sourceName;n&&(t.sourceName=n),e[x]()&&(t[x]=e[x]().toJSON());var r=e._slicerData,o=r.getTable();return o[S]&&(t[S]=o[S]()),R.forEach(function(n){var r=e[n]();n===x||e[n].isDefault(r)||(t[n]=r)}),t},_trigger:function(e){var t=this.sheet();t&&t._trigger(be.Events.SlicerChanged,e)}},D=0,P=Fe(I);D<P;D++)O[I[D][0]]=t(I[D][0],I[D][1],I[D][2],I[D][3]);return Re.extend(o.prototype,O),o}(Se.FloatingObject);Me={ItemSlicer:jn,SlicerStyleInfo:Nn,SlicerBorder:Fn,SlicerStyle:Ln,SlicerStyles:Vn,TableSlicerData:Un,Slicer:Yn,SlicerCollection:zn},e.exports=Me},function(e,t,n){var r=n(1),o=r.Commands,i=r.GC$,a=o.ActionBase,s=function(e){function t(t,n){e.call(this),this._sheet=t,this._command=n}i.inherit(t,e);var n={canExecute:function(){return!!this._command.slicerData},execute:function(){var e=this,t=e._command;if(e.canExecute()){var n=e._sheet;return e._beforeAction(n,!0),t.slicerData.doFilter(t.columnName,{exclusiveRowIndexes:t.newValue}),e._afterAction(n,!0),!0}return!1},canUndo:function(){return!!this._command.slicerData},undo:function(){var e=this,t=e._command;if(e.canUndo()){var n=e._sheet;return e._beforeAction(n,!0),t.slicerData.doFilter(t.columnName,{exclusiveRowIndexes:t.oldValue}),e._afterAction(n,!0),!0}return!1}};return i.extend(t.prototype,n),t}(a),l=function(e){function t(t,n){e.call(this),this._sheet=t,this._command=n}i.inherit(t,e);var n={canExecute:function(){return!!this._command.slicerData},execute:function(){var e=this,t=e._command;if(e.canExecute()){var n=e._sheet;return e._beforeAction(n,!0),t.slicerData.doUnfilter(t.columnName),e._afterAction(n,!0),!0}return!1},canUndo:function(){return!!this._command.slicerData},undo:function(){var e=this,t=e._command;if(e.canUndo()){var n=e._sheet;return e._beforeAction(n,!0),t.slicerData.doFilter(t.columnName,{exclusiveRowIndexes:t.value}),e._afterAction(n,!0),!0}return!1}};return i.extend(t.prototype,n),t}(a),u=function(e){function t(t,n){e.call(this),this._sheet=t,this._command=n}i.inherit(t,e);var n={canExecute:function(){return!!this._command.slicer},execute:function(){var e=this,t=e._command;if(e.canExecute()){var n=e._sheet;return e._beforeAction(n,!0),t.slicer[t.propertyName](t.newValue),e._afterAction(n,!0),!0}return!1},canUndo:function(){return!!this._command.slicer},undo:function(){var e=this,t=e._command;if(e.canUndo()){var n=e._sheet;return e._beforeAction(n,!0),t.slicer[t.propertyName](t.oldValue),e._afterAction(n,!0),!0}return!1}};return i.extend(t.prototype,n),t}(a),c=o._executeCommand;o.filterSlicer={canUndo:!0,execute:function(e,t,n){return c(e,s,t,n)}},o.unfilterSlicer={canUndo:!0,execute:function(e,t,n){return c(e,l,t,n)}},o.changeSlicerProperty={canUndo:!0,execute:function(e,t,n){return c(e,u,t,n)}},o.unfilterSlicerByKey={canUndo:!1,execute:function(e,t){var n=o._getWorksheet(e,t),r=n.slicers._getSelectedSlicers();if(1===r.length){var i=r[0],a=i._getSlicerData();if(a){var s=a.getFilteredIndexes(i.columnName());return n._commandManager().execute({cmd:"unfilterSlicer",sheetName:n.name(),slicerData:a,columnName:i.columnName(),value:s})}}}}},function(e,t,n){var t=n(72);n(130),e.exports=t},function(e,t,n){var r=n(1),o=n(5),i=n(0),a=n(72),s=r._util,l=r._createRange,u=s._device(),c=s._browser,f=r.GC$,d=s._createElement,p=i._Types._isNullOrUndefined,h=i._StringHelper,m=document,g=Math.max,_=Math.min,v="position",y="absolute",b="border",w="font",C="background-color",S="top",x="left",T="z-index",E="auto",M="white",A="gcUIElement";f.extend(r._SheetEventHandler.prototype,{_updateValidationUI:function(e,t){function n(e,t){if(e&&e[t])return"function"==typeof e[t]?e[t]():e[t]}var k=this,R=k._sheet,I=R&&R.parent;if(I&&a&&R._disposeValidationUI()){var O=I.getActiveSheet();if(O&&R.name()===O.name()){var D=R.getDataValidator(e,t);if(D){var P=R.getCellRect(e,t);if(!k._isInvalidRect(P)){var N=I._getContainerDiv(),F=s._getPreferredZIndex(I.getHost());if(D&&n(D,"showInputMessage")&&n(D,"inputMessage")){var L=h._replace,H=h._escapeHtml,V=L(H(n(D,"inputTitle")),"\n","<br/>"),j=L(H(n(D,"inputMessage")),"\n","<br/>"),B=d("span");f(B).css(v,y).css(b,"1px #C0C0C0 solid").css("padding","3px 8px 3px 8px").css(C,"#FFFFFF").css("box-shadow","1px 2px 5px rgba(0,0,0,0.4)").css(w,"normal normal normal 12px/normal Arial").width(E).height(E).css(S,P.y+P.height+5).css(x,P.x+P.width/2).css(T,F).html("<b>"+V+"</b><br/>"+j).attr(A,"gcValidationInputMessage").appendTo(N),R._validationInputMessage=B}if(D&&3===n(D,"type")&&n(D,"inCellDropdown")){for(var U=n(D,"condition").getValidListImp(R,e,t),W=U.length,z=d("select"),Y=R.getText(e,t),G=-1,K=m.createDocumentFragment(),X=0;X<W;X++){var q=U[X].text;if(!(p(q)||r._supportsCalc&&q instanceof o.CalcError)){G<0&&q===Y&&(G=X),q instanceof Date&&(q=i._DateTimeHelper._localeFormat(q,"M/d/yyyy h:mm:ss"));var J=d("option");J.value=q,J.text=q,K.appendChild(J)}}z.appendChild(K),z.selectedIndex=G>0?G:0;var Z=R.getActualStyle(e,t),Q=R._render,$=Z&&Z.font?Z.font:Q._getDefaultFont();R._zoomFactor>1&&($=Q._getZoomFont($));var ee=R.getSpans(l(e,t,1,1)),te=1;ee&&ee.length>0&&ee[0]&&(te=ee[0].colCount);var ne=t+te-1==R.getColumnCount()-1,re=R._getZoomRowHeight(e);re=R.parent&&R.parent.options.useTouchLayout?_(50,re):_(15,re);var oe,ie,ae,se,le,ue=u,ce=c.safari&&(ue.ipad||ue.iphone);ce?(oe=P.width+3,ie=P.height+3,ae=P.y-1.5,se=P.x-1.5,le=M):(oe=g(P.width+(ne?0:re),R.defaults.colWidth),ie=W>8?140:E,ae=P.y+P.height,se=P.x+P.width+(ne?0:re)-oe,le="");var fe=f(z).css("outline","none").css(v,y).css(w,$).css(T,F).css(C,le).width(oe).height(ie).css(S,ae).css(x,se).attr(A,"gcValidationSelect").appendTo(N).attr("size",W>2?W:2).hide().bind("click",function(){k._commitSelectValue(z,e,t,U),ce&&f(R._validationButton).show()}).bind("keydown",function(n){13!==n.keyCode||n.ctrlKey||n.shiftKey||n.altKey?27!==n.keyCode||n.ctrlKey||n.shiftKey||n.altKey||f(z).hide():k._commitSelectValue(z,e,t,U),ce&&f(R._validationButton).show()});ce&&fe.bind("blur",function(){k._commitSelectValue(z,e,t,U),f(R._validationButton).show()}),R._validationSelect=z;var de=d("input");de.type="image",de.src=a._getImageSrc(),de.alt="v",f(de).css(v,y).width(re).height(re).css(S,P.y+P.height-(re+3)).css(x,P.x+P.width-(ne?re:0)).css(T,F).css(C,M).css(b,"1px solid gray").attr(A,"gcValidationButton").appendTo(N).bind("click",function(){R.isEditing()&&!R.endEdit()||(f(R._validationSelect).toggle().focus(),ce&&f(R._validationButton).toggle())}),R._validationButton=de}}}}}}})},function(e,t,n){n(132),n(73),n(133);var t=n(36);t.SR={},t.SR.en=n(74),e.exports=t},function(e,t,n){function r(e){return e.rowCount}function o(e){return e.colCount}function i(e,t){return e.getRowCount(t)}function a(e,t){return e.getColumnCount(t)}function s(e,t,n,i){return!!(e&&t&&t.containsRange(e))&&(!p(n)&&(1===n&&e.row===t.row&&r(e)===r(t)||0===n&&e.col===t.col&&o(e)===o(t))||!(p(i)||(2!==i&&3!==i||e.col!==t.col||o(e)!==o(t))&&(0!==i&&1!==i||e.row!==t.row||r(e)!==r(t))))}function l(e,t,n,r,o){var i=e.getSelections();e._clearSelectionImp(),e.addSelection(t,n,r,o),e._raiseSelectionChanged(i);var a=t>0?t:e._getFirstVisualRow(),s=n>0?n:e._getFirstVisualColumn();e._setActiveCellImp(a,s,e._activeRowViewportIndex,e._activeColViewportIndex)}function u(e,t){var n=this;b.call(n),n._sheet=e,n._command=t}var c=n(1),f=n(0),d=n(36),p=f._Types._isNullOrUndefined,h=null,m=c._createRange,g=c.GC$,_=Math.max,v=Math.floor,y=c.Commands,b=y.ActionBase,w=y._ChangedCells,C=y._CopyMoveHelper,S=C._saveViewportInfo,x=C._raiseRangeDataChanged,T=y._CopyMoveCellsInfo,E=c.Events,M=1023,A="startRange",k="fillRange",R="autoFillType",I="fillDirection",O="cancel",D="fill",P="dragDrop",N=y._performUndo,F=y._saveColumnHeaderInfo,L=y._saveViewportInfoForDragDrop,H=y._saveTableInfo,V=y._saveRowHeaderInfo,j=function(){return f._getResource(d.SR)()},B={fillAuto:function(e,t,n){if(!t)throw new Error(j().Exp_RangeIsNull);var r=this,o=n.fillType,i=n.series,a=n.direction,l=n.step,u=n.stop,c=new d._FillImp(r);s(e,t,a?h:i,a)&&(e&&(r._eventHandler._dragFillStartRange=e),4===o?c._fillAuto(t,i,!1,n.withTag):0===o?c._fillAutoByDirection(t,a):1===o||2===o?c._fillLinearOrGrowth(1===o,t,i,l,u):3===o&&c._seriesFillRange(t,i,3,l,p(u)?h:f._DateTimeHelper._toOADate(u),n.unit),r._invalidate())}};g.extend(c.Worksheet.prototype,B),c.Worksheet._registerFeature(D,{setHost:function(e){if(e){var t=this._commandManager();t[D]||t.register(D,y[D]),t[P]||t.register(P,y[P])}}}),c.Workbook._registerFeature(D,{init:function(){this.options.allowUserDragFill=!0}});var U=function(e){function t(t,n){var i=this,a=n[I],s=0===a,l=s||1===a,u=n[k],c=n[A],f=c.row,d=c.col,p=r(c),h=o(c);e.call(i),i._sheet=t,i._dragFillExtent=n,4===n[R]?i._clearValueUndoAction=new y._ClearValueUndoAction(t,[n[k]]):i._wholeFillRange=l?m(f,s?u.col:d,p,h+o(u)):m(2===a?u.row:f,d,p+r(u),h),i._fillSeries=l?1:0}g.inherit(t,e);var n={canExecute:function(){var e=this,t=e._sheet,n=e._dragFillExtent,i=n[A],a=n[k];return!!t._canChange(a.row,a.col,r(a),o(a))&&(4===n[R]||!a.intersect(i.row,i.col,r(i),o(i)))},execute:function(){var e=this;if(e.canExecute()){var t=e._dragFillExtent,n=t[k],i=e._sheet;e._beforeAction(i);try{c._supportsCalc&&i.suspendCalcService(),e.saveState(),4===t[R]?e._executeDragFillClear(i):e._executeDragFill(i)}finally{e._afterAction(i),c._supportsCalc&&i.resumeCalcService(!1),i._updateTableSlicer&&i._updateTableSlicer(n.row,n.col,r(n),o(n));var a=[];i.isDirtySuspended()||(e._savedAfterFilledChangedCells=new w(i,n,M),e._savedAfterFilledChangedCells._mergeCellsHasDiffData(e._savedBeforeFillChangedCells._getCellsData()),a=e._savedAfterFilledChangedCells._getChangedCells()),x(i,n.row,n.col,r(n),o(n),a,1)}}},_executeDragFillClear:function(e){var t=this;t._clearValueUndoAction.execute(e);var n,i=t._dragFillExtent,a=i[A],s=i[k],l=0===t._fillSeries,u=r(a),c=o(a),f=l?_(1,u-r(s)):u,d=l?c:_(1,c-o(s));a.equals(s)||(n=m(a.row,a.col,f,d),e._setActiveCellImp(_(e._getFirstVisualRow(),n.row),_(e._getFirstVisualColumn(),n.col),e._activeRowViewportIndex,e._activeColViewportIndex),e._clearSelectionImp(),e.addSelection(n.row,n.col,r(n),o(n)))},_executeDragFill:function(e){var t,n,i=this,a=i._sheet,s=i._dragFillExtent[A],l=i._dragFillExtent[k],u=i._dragFillExtent[R],f=i._wholeFillRange,d={fillType:4,series:i._fillSeries,withTag:!0};if(1===u)a.fillAuto(s,f,d);else if(0===u){var p=4^M;i._copyCells(s,l,p)}else if(6===u){var m=516^M;i._copyCells(s,l,m)}else if(2===u)i._copyCells(s,l,192);else if(3===u){var g=!(1!==r(s)||1!==o(s)||-1===s.row&&-1!==s.col||-1===s.col&&-1!==s.row);if(g){var v=187;i._copyCells(s,l,v)}else{var y=a._getActualRange(f),b=y.row,w=y.col,C=r(y),S=o(y),x=new c._SheetModel(r(y),o(y),h);for(t=0;t<C;t++)for(n=0;n<S;n++)x.setStyle(t,n,a._getStyleObject(b+t,w+n));for(a.fillAuto(s,f,d),t=0;t<C;t++)for(n=0;n<S;n++)a._setStyleObject(b+t,w+n,x.getStyle(t,n))}}a._setActiveCellImp(_(e._getFirstVisualRow(),f.row),_(e._getFirstVisualColumn(),f.col),e._activeRowViewportIndex,e._activeColViewportIndex),e._selectionModel&&e._clearSelectionImp(),a.addSelection(f.row,f.col,r(f),o(f))},_copyCells:function(e,t,n){var i,a,s,l,u,c=this,f=c._sheet,d=f._getActualRange(e),p=f._getActualRange(t),h=d.row,m=d.col,g=r(d),_=o(d),y=p.row,b=p.col,w=r(p),C=o(p),S=c._dragFillExtent[I],x=3===S,T=1===S,E=v(w/g),M=w%g,A=v(C/_),k=C%_;if(0===c._fillSeries){for(i=0;i<E;i++)l=x?y+i*g:y+w-(i+1)*g,f._copyToCore(h,m,l,b,g,_,n,!0);0!==M&&(a=x?h:h+(E+1)*g-w,l=x?y+g*E:y+w-E*g-M,f._copyToCore(a,m,l,b,M,_,n,!0))}else{for(i=0;i<A;i++)u=T?b+i*_:b+C-(i+1)*_,f._copyToCore(h,m,y,u,g,_,n,!0);0!==k&&(s=T?m:m+(A+1)*_-C,u=T?b+_*A:b+C-A*_-k,f._copyToCore(h,s,y,u,g,k,n,!0))}},saveState:function(){var e=this,t=e._dragFillExtent;4===t[R]?e._clearValueUndoAction.saveState():e._savedStartViewportCells=e._saveRangeStates(t[A]),e._sheet.isDirtySuspended()||(e._savedBeforeFillChangedCells=new w(e._sheet,t[k],M)),e._savedFilledViewportCells=e._saveRangeStates(t[k])},_saveRangeStates:function(e){var t=this._sheet,n=t._getActualRange(e),i=new T(r(n),o(n));return S(t,i,n.row,n.col,M),i},undo:function(){var e=this,t=e._sheet,n=!1;if(e.canUndo()){e._beforeAction(t,!0);try{c._supportsCalc&&t.suspendCalcService();var i=t.getSelections(),a=e._dragFillExtent,s=t._fillDialog,l=a[k];n=4===a[R]?e._undoDragClear(t):e._undoDragFill(t),!t._skipCloseDragFillSmartTag&&s&&s.close(),x(t,l.row,l.col,r(l),o(l),e._savedAfterFilledChangedCells?e._savedAfterFilledChangedCells._getChangedCells():[],1),t._raiseSelectionChanging(i,t.getSelections())&&t._raiseSelectionChanged(i)}finally{e._afterAction(t,!0),c._supportsCalc&&t.resumeCalcService(!1)}}return n},_undoDragClear:function(e){var t=this,n=t._dragFillExtent[A],i=n.row,a=n.col,s=t._clearValueUndoAction.undo(e);return e._setActiveCellImp(_(e._getFirstVisualRow(),i),_(e._getFirstVisualColumn(),a),e._activeRowViewportIndex,e._activeColViewportIndex),e._clearSelectionImp(),e.addSelection(i,a,r(n),o(n)),s},_undoDragFill:function(e){var t=this,n=t._dragFillExtent,i=n[A],a=i.row,s=i.col;c._supportsCalc&&e.suspendCalcService();try{t._undoRangeStates(t._savedFilledViewportCells,n[k]),t._undoRangeStates(t._savedStartViewportCells,i),e._setActiveCellImp(_(e._getFirstVisualRow(),a),_(e._getFirstVisualColumn(),s),e._activeRowViewportIndex,e._activeColViewportIndex),e._clearSelectionImp(),e.addSelection(a,s,r(i),o(i))}finally{c._supportsCalc&&e.resumeCalcService(!1)}return e.invalidateLayout(),!0},_undoRangeStates:function(e,t){var n=this._sheet,r=n._getActualRange(t);C._undoCellsInfo(n,e,r.row,r.col,3)}};return g.extend(t.prototype,n),t}(b),W=function(e){function t(t,n){var r=this;e.call(r),r._sheet=t,r._fillExtent=n,r._startRange=n[A],r._fillRange=n[k],r._autoFillType=n[R],r._fillDirection=n[I]}g.inherit(t,e);var n={execute:function(){var e=this,t=!1;if(e.canExecute()){var n=e._sheet,i=e._fillRange;e.saveState(),e._beforeAction(n,!0);try{var a=n._getActualRange(i),s=new T(r(a),o(a));S(n,s,a.row,a.col,M),e._savedFilledViewportCells=s;var l=n._eventHandler,u={sheet:n,sheetName:n._name};u[O]=!1,u[k]=i,u[R]=e._autoFillType,u[I]=e._fillDirection,n._trigger(E.DragFillBlock,u),l._currentDragFillType=u[R],l._isCancelDragFill=u[O],e._executeDragFillAction(u),delete u[O],n._trigger(E.DragFillBlockCompleted,u),t=!0}finally{e._applyDataChanged(!0,n,i)}}return t},_executeDragFillAction:function(e){var t=this,n=t._sheet,i=n._eventHandler,a=t._fillRange,s=t._autoFillType,l=n._getActualRange(a);if(i._currentDragFillType=s,i._preFillCellsInfo=new T(r(l),o(l)),S(n,i._preFillCellsInfo,l.row,l.col,M),!i._isCancelDragFill){var u={};u[A]=t._startRange,u[k]=a,u[R]=5===e[R]?s:e[R],u[I]=t._fillDirection;var c=new U(n,u);n.suspendEvent(),c.execute(),n.resumeEvent(),t._fillExtent._dragFillUndoAction=c}},saveState:function(){var e=this;e._sheet.isDirtySuspended()||(e._savedBeforeFillChangedCells=new w(e._sheet,e._fillRange,M))},undo:function(){var e=this,t=!1;if(e.canUndo()){var n=e._sheet,r=e._fillRange;e.saveState(),e._beforeAction(n);try{t=e._fillExtent._dragFillUndoAction.undo()}finally{e._applyDataChanged(!1,n,r)}}return t},_applyDataChanged:function(e,t,n){var i=this;i._afterAction(t,e);var a=[];t.isDirtySuspended()||(i._savedAfterFilledChangedCells=new w(t,n,M),i._savedAfterFilledChangedCells._mergeCellsHasDiffData(i._savedBeforeFillChangedCells._getCellsData()),a=i._savedAfterFilledChangedCells._getChangedCells()),x(t,n.row,n.col,r(n),o(n),a,1)}};return g.extend(t.prototype,n),t}(b);g.inherit(u,b),g.extend(u.prototype,{canExecute:function(){var e=this,t=e._sheet,n=e._command,o=n.fromRow,s=n.fromColumn,l=r(n),u=n.columnCount,c=n.toRow,f=n.toColumn;return!!t._isValidRange(o,s,l,u,i(t),a(t))&&(!(!n.insert&&!t._isValidRange(c,f,l,u,i(t),a(t)))&&(t._canChange(c,f,l,u)&&t._canChange(o,s,l,u)))},execute:function(){var e=this,t=!1;if(e.canExecute()){var n=e._sheet,o=e._command;e.saveState();var s,u,c,f=o.fromRow,d=o.fromColumn,p=o.toRow,h=o.toColumn,m=r(o),g=o.columnCount,_=o.option;e._beforeAction(n,!0);try{if(o.insert){if(d>=0&&f<0){s=d,u=h,c=g;var v=h;n.addColumns(u,c),o.copy?n.copyTo(-1,u<=s?s+c:s,-1,u,-1,c,_):(n.moveTo(-1,u<=s?s+c:s,-1,u,-1,c,_),n.deleteColumns(u<=s?s+c:s,c),s<u&&(v=u-c)),l(n,-1,v,i(n),c)}else if(f>=0&&d<0){s=f,u=p,c=m;var y=p;n.addRows(u,c),o.copy?n.copyTo(u<=s?s+c:s,-1,u,-1,c,-1,_):(n.moveTo(u<=s?s+c:s,-1,u,-1,c,-1,_),n.deleteRows(u<=s?s+c:s,c),s<u&&(y=u-c)),l(n,y,-1,c,a(n))}}else if(o.copy?n.copyTo(f,d,p,h,m,g,_):n.moveTo(f,d,p,h,m,g,_),n){l(n,p,h,m,g);var b=o._state;o.copy||n.isDirtySuspended()||(b._savedFromAfterPastedChangedCells=e._mergeCellsData(n,b._savedFromViewportCells.data,b._savedFromBeforePastedChangedCells,f,d,m,g)),n.isDirtySuspended()||(b._savedToAfterPastedChangedCells=e._mergeCellsData(n,b._savedToViewportCells.data,b._savedToBeforePastedChangedCells,p,h,m,g))}t=!0}finally{n._eventHandler._dragRect={},e._afterAction(n,!0)}}return t},_mergeCellsData:function(e,t,n,r,o,i,a){if(t&&t._isValueOrFormulaSaved()){var s=new w(e,m(r,o,i,a),this._command.option);return s._mergeCellsHasDiffData(n._getCellsData()),C._raiseRangeDataChanged(e,r,o,i,a,s._getChangedCells(),0),s}},saveState:function(){var e,t=this,n=t._sheet,o=t._command,s=o._state={},l=o.fromRow,u=o.fromColumn,c=o.toRow,f=o.toColumn,d=o.option,p=l<0?0:l,h=u<0?0:u,g=c<0?0:c,_=f<0?0:f,v=l<0?i(n):r(o),y=u<0?a(n):o.columnCount;if(o.insert){if(u<0&&l>=0){var b=n.tables;!o.copy&&b&&b._has(g,-1,1,-1)&&(e=V(n,p,v,d),s._savedFromRowHeaderCells=e.headerCells,s._savedFromRows=e.rows,s._savedFromViewportCells=L(n,p,h,v,y,d))}}else l<0&&(e=F(n,_,y,d),s._savedToColumnHeaderCells=e.headerCells,s._savedToColumns=e.columns,o.copy||(e=F(n,h,y,d),s._savedFromColumnHeaderCells=e.headerCells,s._savedFromColumns=e.columns)),u<0&&(e=V(n,g,v,d),s._savedToRowHeaderCells=e.headerCells,s._savedToRows=e.rows,o.copy||(e=V(n,p,v,d),s._savedFromRowHeaderCells=e.headerCells,s._savedFromRows=e.rows)),s._savedToTables=H(n,g,_,v,y),s._savedToViewportCells=L(n,g,_,v,y,d),o.copy||(s._savedFromTables=H(n,p,h,v,y),s._savedFromViewportCells=L(n,p,h,v,y,d),n.isDirtySuspended()||(s._savedFromBeforePastedChangedCells=new w(n,m(p,h,v,y),d))),n.isDirtySuspended()||(s._savedToBeforePastedChangedCells=new w(n,m(g,_,v,y),d));s._savedAcitveRowViewportIndex=n._activeRowViewportIndex,s._savedAcitveColumnViewportIndex=n._activeColViewportIndex,s._savedActiveRow=n._activeRowIndex,s._savedActiveColumn=n._activeColIndex},undo:function(){var e=this,n=0;if(e.canUndo()){var o=e._sheet,s=e._command,u=s.fromRow,c=s.fromColumn,f=s.toRow,d=s.toColumn,p=r(s),m=s.columnCount;if(!o._isValidRange(u,c,p,m,i(o),a(o)))return!1;if(!s.insert&&!o._isValidRange(f,d,p,m,i(o),a(o)))return!1;var g,_,v,y=s._state;e._beforeAction(o,!0);try{if(s.insert){if(!(c>=0&&u>=0))if(c>=0){var b=c;g=m,s.copy?o.deleteColumns(d,g):(_=d,v=c,c<d?_=d-g:v=c+g,o.addColumns(v,g),o.copyTo(-1,v<=_?_+g:_,-1,v,-1,g,s.option),o.deleteColumns(v<=_?_+g:_,g),_<v&&(b=v-g)),o&&l(o,-1,b,i(o),g),n++}else if(u>=0){g=p;var w=u;s.copy?o.deleteRows(f,g):(_=f,v=u,u<f?_=f-g:v=u+g,o.addRows(v,g),n+=N(e,y._savedFromViewportCells),n+=N(e,y._savedFromRowHeaderCells),n+=N(e,y._savedFromRows),n||o.copyTo(v<=_?_+g:_,-1,v,-1,g,-1,s.option),o.deleteRows(v<=_?_+g:_,g),_<v&&(w=v-g)),o&&l(o,w,-1,g,a(o)),n++}}else{var S=u<0?0:u,x=c<0?0:c,T=f<0?0:f,E=d<0?0:d,M=u<0?i(o):p,A=c<0?a(o):m;t._supportsCalc&&C._clearFormula(o,T,E,M,A);var k=h,R=h,I=y._savedFromViewportCells;!s.copy&&I&&I.data&&I.data._isValueOrFormulaSaved()&&(R=C._getValues(o,S,x,M,A));var O=y._savedToViewportCells;O&&O.data&&O.data._isValueOrFormulaSaved()&&(k=C._getValues(o,T,E,M,A)),n+=N(e,y._savedToTables),n+=N(e,y._savedToColumnHeaderCells),n+=N(e,y._savedToColumns),n+=N(e,O),n+=N(e,y._savedToRowHeaderCells),n+=N(e,y._savedToRows),n+=N(e,y._savedFromTables),n+=N(e,y._savedFromColumnHeaderCells),n+=N(e,y._savedFromColumns),n+=N(e,I),n+=N(e,y._savedFromRowHeaderCells),n+=N(e,y._savedFromRows),n&&o&&(l(o,u,c,p,m),k&&C._raiseRangeDataChanged(o,T,E,M,A,y._savedToAfterPastedChangedCells?y._savedToAfterPastedChangedCells._getChangedCells():[],0),R&&C._raiseRangeDataChanged(o,S,x,M,A,y._savedFromAfterPastedChangedCells?y._savedFromAfterPastedChangedCells._getChangedCells():[],0))}if(n&&o){if(-1!==y._savedActiveRow&&-1!==y._savedActiveColumn){var D=o.getSelections()[0];D.contains(y._savedActiveRow,y._savedActiveColumn)?o._setActiveCellCore(y._savedActiveRow,y._savedActiveColumn):o._setActiveCellCore(D.row,D.col)}-2!==y._savedAcitveRowViewportIndex&&-2!==y._savedAcitveColumnViewportIndex&&-1!==y._savedActiveRow&&-1!==y._savedActiveColumn&&o.showCell(y._savedActiveRow,y._savedActiveColumn,3,3)}}finally{e._afterAction(o,!0)}}return n>0}}),y[D]={canUndo:!0,execute:function(e,t,n){return y._executeCommand(e,W,t,n)}},y[P]={canUndo:!0,execute:function(e,t,n){return y._executeCommand(e,u,t,n)}}},function(e,t,n){function r(e){return e.rowViewportIndex}function o(e){return e.colViewportIndex}function i(e){return e.frozenRowCount()}function a(e){return e.frozenColumnCount()}function s(e){return e.hitTestType}function l(e,t){return e.getRowCount(t)}function u(e,t){return e.getColumnCount(t)}function c(e){return e.colCount}function f(e){return e.rowCount}function d(e){return e.height}function p(e){return e.width}function h(e,t,n,r,o){e.globalCompositeOperation="source-over",e.strokeStyle=b.BLUE_COLOR,e.save();var i;t===r?(e.rect(t-2,n,7,I(o-n)),e.clip(),e.beginPath(),n<o?(n-=3,o+=3):(n+=3,o-=3),i=M(t,n,r,o,L,2)):n===o&&(e.rect(t,n-2,I(r-t),7),e.clip(),e.beginPath(),t<r?(t-=3,r+=3):(t+=3,r-=3),i=M(t,n,r,o,L,1)),i._paintLine(e),e.stroke(),e.beginPath(),e.restore()}function m(e,t,n,r,o,i,a,s,l,u,c){var f=t?x.DragDropBlock:x.DragDropBlockCompleted,d={sheet:e,sheetName:e._name,fromRow:n,fromCol:r,toRow:o,toCol:i,rowCount:a,colCount:s,copy:l,insert:u,copyOption:c};return t&&(d.cancel=!1),e._trigger(f,d),d.cancel}var g=n(1),_=n(0),v=n(5),y=n(36),b=n(7),w=g.GC$,C=g._createRange,S=g._supportsCalc,x=g.Events,T=_._Types._isNullOrUndefined,E=g.Rect,M=g._createLine,A=null,k=void 0,R=Math.min,I=Math.abs,O=Math.max,D=5,P=3,N="drag",F="corner",L="black",H=function(){return _._getResource(y.SR)()};w.extend(g._SheetEventHandler.prototype,{_startDragDropping:function(e){var t=this;if(!t._isDragDropping){var n=t._sheet,i=A;if(1===n._selectionModel.length?i=n._selectionModel[0]:n._selectionModel.length<1&&(i=n._getSpanModel().get(n._activeRowIndex,n._activeColIndex)),i){t._isDragDropping=!0,t._isWorking=!0,t._dragDropFromRange=i;var a=n.getRangeRect(r(e),o(e),i),l=t._dragRect;l.x=a.x,l.y=a.y,l.width=a.width-1,l.height=a.height-1,l.row=i.row,l.col=i.col,l.rowCount=f(i),l.colCount=c(i);var u=n._getActualRange(i),d=e.row,p=e.col;d<u.row&&(d=u.row),d>=u.row+f(u)&&(d=u.row+f(u)-1),p<u.col&&(p=u.col),p>=u.col+c(u)&&(p=u.col+c(u)-1),l.hitRow=d,l.hitCol=p,l.rowOffset=d-u.row,l.colOffset=p-u.col,t._startHitInfo={_scrollRowViewportIndex:r(e),_scrollColViewportIndex:o(e),_hitTestType:s(e)},t._startScroll()}}},_continueDragDropping:function(){var e=this;if(e._startHitInfo&&e._isWorking&&e._isDragDropping&&e._dragDropFromRange){var t=e._mousePosition,n=e._dragRect,r=n.width/2,o=n.x+r,i=n.height/2,a=n.y+i;n.hitTarget={x:t.x,y:t.y};var s=e._getHitRowIndex(),l=e._getHitColumnIndex(),u=!1;(I(o-t.x)>r+5||I(a-t.y)>i+5)&&(u=!0),s>=0&&l>=0&&u&&e._updateDragDropRect(s,l),e._continueScroll()}},_updateDragDropRect:function(e,t){var n=this;if(n._isDragDropping&&n._dragDropFromRange){var r=n._sheet,o=n._dragRect,i=r._getActiveSelectedRange();-1===i.row&&-1!==i.col?(o.row=-1,o.col=O(0,R(u(r)-c(o),t-o.colOffset))):-1!==i.row&&-1===i.col?(o.row=O(0,R(l(r)-f(o),e-o.rowOffset)),o.col=-1):(o.row=o.row<0?-1:O(0,R(l(r)-f(o),e-o.rowOffset)),o.col=o.col<0?-1:O(0,R(u(r)-c(o),t-o.colOffset))),o.hitRow=e,o.hitCol=t;var a=r._getActualRange(o),s=n._oldDragRange;if(!(s&&a.row===s.row&&a.col===s.col&&f(a)===f(s)&&c(a)===c(s)&&a.row>r._getFirstVisualRow()&&a.col>r._getFirstVisualColumn()&&a.row+f(a)-1<r._getLastVisualRow()&&a.col+c(a)-1<r._getLastVisualColumn())){n._actualDragRange=a,r._render._refreshDragDropIndicator(),n._oldDragRange=a;var d=r.parent;if(d&&d.options.showDragDropTip){var p=o.x+o.width+D,h=o.y+o.height+D;d._showTooltip(n._getDragDropRectString(a),p,h)}}}},_getDragDropRectString:function(e){if(e&&S){var t,n=this._sheet,r=n._getActiveSelectedRange(),o=n.getActiveRowIndex(),i=n.getActiveColumnIndex();if(o=o<0?0:o,i=i<0?0:i,1===f(r)&&1===c(r))t=v._createCellExpression(A,A,e.row-o,e.col-i,!0,!0);else{var a,s,l,u;-1===r.row&&r.col>=0?(a=l=v.BAND_INDEX_CONST,s=e.col-i,u=e.col-i+c(r)-1):-1===r.col&&r.row>=0?(s=u=v.BAND_INDEX_CONST,a=e.row-o,l=e.row-o+f(r)-1):r.row>=0&&r.col>=0&&(a=e.row-o,l=e.row-o+f(r)-1,s=e.col-i,u=e.col-i+c(r)-1),t=v._createRangeExpression(A,A,a,s,l,u,!0,!0,!0,!0)}return n._getCalcServiceInternal().unparse(n._getSheetSource(),t,o,i)}return k},_stopDragDrop:function(){var e=this,t=!1,n="",r=!1,o=e._sheet,i=A;e._startHitInfo=A,e._stopScroll();var a=o._getActiveSelectedRange();if(i=a&&(f(a)>0||c(a)>0)?{r:a.row,c:a.col,rc:f(a),cc:c(a)}:{r:o._activeRowIndex,c:o._activeColIndex,rc:1,cc:1},!0===e._isDragDropping&&!0===e._isWorking){var s=i.r,l=i.c,u=i.rc,d=i.cc,p=e._dragRect.row,h=e._dragRect.col,g={fromRow:s,fromColumn:l,rowCount:u,columnCount:d,toRow:p,toColumn:h,isDragInsert:e._isDragInsert,isDragCopy:e._isDragCopy};o._trigger(x.BeforeDragDrop,g),n=g.invalidMessage;var _=o.options.dragDropCopyToOptions||1023;n&&0!==n.length||(!e._isDragInsert||-1!==s&&-1!==l?p===s&&h===l||((o._hasPartSpans(s,l,u,d)||o._hasPartSpans(p,h,u,d))&&(t=!0,n=H().Exp_ChangeMergedCell),t||S&&(o._hasPartArrayFormulas(s,l,u,d)||o._hasPartArrayFormulas(p,h,u,d))&&(t=!0,n=H().Exp_ChangePartOfArray),!t&&o.options.isProtected&&(!e._isDragCopy&&o._isAnyCellInRangeLocked(C(s,l,u,d))||o._isAnyCellInRangeLocked(C(p,h,u,d)))&&(t=!0,n=H().Exp_CellReadOnly),t||m(o,!0,s,l,p,h,u,d,e._isDragCopy,!1,_)||(r=o._commandManager().execute({cmd:"dragDrop",sheetName:o.name(),fromRow:s,fromColumn:l,toRow:p,toColumn:h,rowCount:u,columnCount:d,copy:e._isDragCopy,insert:!1,option:_}),m(o,!1,s,l,p,h,u,d,e._isDragCopy,!1,_))):l>=0&&s<0?(e._isDragCopy&&(h<=l||h>=l+d)||!e._isDragCopy&&(h<l||h>l+d))&&((o._hasPartSpans(-1,l,-1,d)||o._hasPartSpans(-1,h,-1,0))&&(t=!0,n=H().Exp_ChangeMergedCell),!t&&o.options.isProtected&&(t=!0,n=H().Exp_ColumnReadOnly),t||m(o,!0,-1,l,-1,h,-1,d,e._isDragCopy,!0,_)||(r=o._commandManager().execute({cmd:"dragDrop",sheetName:o.name(),fromRow:-1,fromColumn:l,toRow:-1,toColumn:h,rowCount:-1,columnCount:d,copy:e._isDragCopy,insert:!0,option:_}),m(o,!1,-1,l,-1,h,-1,d,e._isDragCopy,!0,_))):s>=0&&l<0&&(e._isDragCopy&&(p<=s||p>=s+u)||!e._isDragCopy&&(p<s||p>s+u))&&((o._hasPartSpans(s,-1,u,-1)||o._hasPartSpans(p,-1,0,-1))&&(t=!0,n=H().Exp_ChangeMergedCell),t||S&&(o._hasPartArrayFormulas(s,-1,u,-1)||o._hasPartArrayFormulas(p,-1,0,-1))&&(t=!0,n=H().Exp_ChangePartOfArray),!t&&o.options.isProtected&&(t=!0,n=H().Exp_RowReadOnly),t||m(o,!0,s,-1,p,-1,u,-1,e._isDragCopy,!0,_)||(r=o._commandManager().execute({cmd:"dragDrop",sheetName:o.name(),fromRow:s,fromColumn:-1,toRow:p,toColumn:-1,rowCount:u,columnCount:-1,copy:e._isDragCopy,insert:!0,option:_}),m(o,!1,s,-1,p,-1,u,-1,e._isDragCopy,!0,_))))}e._isWorking=!1,e._isDragDropping=!1,e._dragDropFromRange=A,e._isDragInsert=!1,e._isDragCopy=!1,e._oldDragRange=A,e._removeTooltip(),r||(e._dragRect={},o.repaint()),t&&o._raiseInvalidOperation(3,n)},_startDragFill:function(e){var t=this;!0!==t._isDraggingFill&&!0!==t._isWorking&&(t._updateDragFillStartRange(),t._dragFillStartRange&&(t._isWorking=!0,t._isDraggingFill=!0,t._isDragAroundIndicator=!0,t._dragStartRowViewport=e,t._dragStartColumnViewport=o(e),t._dragToRowViewport=r(e),t._dragToColumnViewport=o(e),t._updateDragStartRangeViewports(),t._startHitInfo={_scrollRowViewportIndex:r(e),_scrollColViewportIndex:o(e),_hitTestType:s(e)},t._startScroll()))},_updateDragStartRangeViewports:function(){var e=this,t=i(e._sheet),n=a(e._sheet),r=e._dragFillStartTopRow();r>=0&&r<t?e._dragFillStartTopRowViewport=0:r>=t&&r<=l(e._sheet)&&(e._dragFillStartTopRowViewport=1),e._isDragFillWholeColumns()?e._dragFillStartBottomRowViewport=1:e._dragFillStartBottomRowViewport=e._dragStartRowViewport;var o=e._dragFillStartLeftColumn();o>=0&&o<n?e._dragFillStartLeftColumnViewport=0:o>=n&&o<=u(e._sheet)&&(e._dragFillStartLeftColumnViewport=1),e._isDragFillWholeRows()?e._dragFillStartRightColumnViewport=1:e._dragFillStartRightColumnViewport=e._dragStartColumnViewport},_continueDragFill:function(){var e=this;if(e._startHitInfo&&e._isDraggingFill&&e._isWorking&&e._dragFillStartRange){if(e._dragToRowViewport=e._getHitRowViewportIndex(),e._dragToColumnViewport=e._getHitColumnViewportIndex(),e._dragToRow=e._getHitRowIndex(),e._dragToColumn=e._getHitColumnIndex(),e._dragToRow>=0&&e._dragToColumn>=0){e._updateCurrentFillSettings(),e._updateCurrentFillRange();var t=e._sheet.parent,n=!1;e._getDragFillFrameRange()&&(n=e._validateFillRange(e._dragFillStartRange,e._currentFillRange,!0)),t&&t.options.showDragFillTip&&n&&e._showDragFillTooltip(),e._refreshDragFill()}e._continueScroll()}},_getDragFillTooltipContent:function(){var e,t=this,r=t._sheet,o=t._dragFillStartRange,i=t._currentFillRange,a=r.parent.options.defaultDragFillType,s=t._getDragAutoFillType(3===a?5:a),l=t._getCurrentFillDirection(),u=t._getDragFillFrameRange();if(1===s){e=0===l||1===l?1:0;var c=new y._FillImp(r),f=c._fillAuto(u,e,!0),d=t._getAvailableRange(l,i,o),p=r.getActualStyle(d.row,d.col),h=p.cellType||r._getDefaultCellType(),m=p.formatter?p.formatter:p._autoFormatter,g=n(10),v=g&&g.GeneralFormatter;f instanceof Date&&v&&(m=new v(_.CultureManager._getCultureInfo().DateTimeFormat.shortDatePattern+" hh:mm:ss AM/PM;@",0));var b=t._startHitInfo,w=3;b&&(w=b._hitTestType);var C={sheet:r,row:d.row,col:d.col,sheetArea:w};return h.format(f,m,C)}if(0===s){d=t._getAvailableRange(l,i,o);return r.getFormula(d.row,d.col)?A:r.getText(d.row,d.col)}return A},_getAvailableRange:function(e,t,n){var r=n.row,o=n.col,i=f(n),a=c(n),s=C(r,o,1,1);if(3===e){var l=f(t)%i;l=0===l?r+i-1:r+l-1,s.row=l,s.col=o}else 1===e?(l=c(t)%a,l=0===l?o+a-1:o+l-1,s.row=r,s.col=l):0===e?(l=c(t)%a,l=0===l?o:o+a-l,s.row=r,s.col=l):2===e&&(l=f(t)%i,l=0===l?r:r+i-l,s.row=l,s.col=o);return s},_showDragFillTooltip:function(){var e=this,t=e._sheet;if(4===e._getDragAutoFillType()||e._isDragFillWholeRows()||e._isDragFillWholeColumns())return e._removeTooltip(),A;var n,r,o,i=e._getCurrentFillDirection(),a=e._getDragFillFrameRange(),s=t._getRangeWholeRect(a);o=e._getDragFillTooltipContent(),3===i?(n=s.x+s.width+P,r=s.y+s.height+P):1===i?(n=s.x+s.width+P,r=s.y+s.height+P):0===i?(n=s.x+P,r=s.y+s.height+P):2===i&&(n=s.x+s.width+P,r=s.y+P),e._showTooltip(o,n,r)},_refreshDragFill:function(){var e=this;e._clearDragFill(),e._refreshSelectionBorder(),e._paintDragFill(),e._oldDragFillFrameRange=e._getDragFillFrameRange()},_clearDragFill:function(){var e=this._sheet;if(this._oldDragFillFrameRange){var t=e._getRangeWholeRect(this._oldDragFillFrameRange);t.x-=2,t.y-=2,t.width+=4,t.height+=4,e._render._copyDoubleBufferRect(t)}},_refreshSelectionBorder:function(e){this._sheet._render._repaintSelection(this._dragFillStartRange,A,e)},_paintDragFill:function(){var e=this._sheet,t=e._render,n=this._getDragFillFrameRange();if(n){var r=t._getCtx(),o=e._getRangeWholeRect(n);r.save(),r.beginPath(),t._paintDragRectangle(r,o),r.restore()}},_updateCurrentFillRange:function(){this._currentFillRange=this._getCurrentFillRange()},_isDragFillWholeRows:function(){return-1===this._dragFillStartRange.col&&-1!==this._dragFillStartRange.row},_isDragFillWholeColumns:function(){return-1===this._dragFillStartRange.row&&-1!==this._dragFillStartRange.col},_isDragClear:function(){return 4===this._currentFillDirection||5===this._currentFillDirection},_getCurrentFillRange:function(){var e=this,t=-1,n=-1,r=-1,o=-1;switch(e._currentFillDirection){case 0:e._isDragFillWholeColumns()?(t=-1,r=-1):(t=e._dragFillStartTopRow(),r=f(e._dragFillStartRange)),n=e._dragToColumn,o=e._dragFillStartLeftColumn()-n;break;case 1:e._isDragFillWholeColumns()?(t=-1,r=-1):(t=e._dragFillStartTopRow(),r=f(e._dragFillStartRange)),n=e._dragFillStartRightColumn()+1,o=e._dragToColumn-n+1;break;case 2:t=e._dragToRow,r=e._dragFillStartTopRow()-t,e._isDragFillWholeRows()?(n=-1,o=-1):(n=e._dragFillStartLeftColumn(),o=c(e._dragFillStartRange));break;case 3:t=e._dragFillStartBottomRow()+1,r=e._dragToRow-t+1,e._isDragFillWholeRows()?(n=-1,o=-1):(n=e._dragFillStartLeftColumn(),o=c(e._dragFillStartRange));break;case 5:t=e._dragToRow,r=e._dragFillStartBottomRow()-t+1,e._isDragFillWholeRows()?(n=-1,o=-1):(n=e._dragFillStartLeftColumn(),o=c(e._dragFillStartRange));break;case 4:e._isDragFillWholeColumns()?(t=-1,r=-1):(t=e._dragFillStartRange.row,r=f(e._dragFillStartRange)),n=e._dragToColumn,o=e._dragFillStartRightColumn()-n+1}return C(t,n,r,o)},_dragFillStartBottomRowLayout:function(){var e=this._dragFillStartBottomRow();return-1!==e?this._sheet._getRowLayout(this._dragFillStartBottomRowViewport).findRow(e):A},_dragFillToViewportBottomRowLayout:function(){return this._sheet._getRowLayout(this._dragToRowViewport).findRow(this._dragFillToViewportBottomRow())},_dragFillToViewportBottomRow:function(){return this._sheet.getViewportBottomRow(this._dragToRowViewport)},_dragFillStartRightColumnLayout:function(){var e=this._dragFillStartRightColumn();return-1!==e?this._sheet._getColumnLayout(this._dragFillStartRightColumnViewport).findCol(e):A},_dragFillToViewportRightColumnLayout:function(){return this._sheet._getColumnLayout(this._dragToColumnViewport).findCol(this._dragFillToViewportRightColumn())},_dragFillToViewportRightColumn:function(){return this._sheet.getViewportRightColumn(this._dragToColumnViewport)},_updateCurrentFillSettings:function(){var e,t,n=this,r=n._isDragFillWholeRows(),o=n._isDragFillWholeColumns(),i=w(n._sheet._getCanvas()).offset(),a=n._mousePosition.e,s=n._mousePosition.x,l=n._mousePosition.y,u=a.pageX-i.left,c=a.pageY-i.top,f=!1;if(r||o)o?n._dragToColumn>=n._dragFillStartLeftColumn()&&n._dragToColumn<=n._dragFillStartRightColumn()?n._currentFillDirection=4:n._dragToColumn<n._dragFillStartLeftColumn()?n._currentFillDirection=0:n._dragToColumn>n._dragFillStartRightColumn()&&(n._currentFillDirection=1):r&&(n._dragToRow>=n._dragFillStartTopRow()&&n._dragToRow<=n._dragFillStartBottomRow()?n._currentFillDirection=5:n._dragToRow<n._dragFillStartTopRow()?n._currentFillDirection=2:n._dragToRow>n._dragFillStartBottomRow()&&(n._currentFillDirection=3));else if(n._dragToRow>=n._dragFillStartTopRow()&&n._dragToRow<=n._dragFillStartBottomRow())if(n._dragToColumn>=n._dragFillStartLeftColumn()&&n._dragToColumn<=n._dragFillStartRightColumn())if(e=I(n._dragToColumn-n._dragFillStartRightColumn()),(t=I(n._dragToRow-n._dragFillStartBottomRow()))>e)n._currentFillDirection=5;else if(t<e)n._currentFillDirection=4;else{var d=n._dragFillStartBottomRowLayout();if(d||(d=n._dragFillToViewportBottomRowLayout()),l>d.y+d.height)n._currentFillDirection=3;else{var p=n._dragFillStartRightColumnLayout();p||(p=n._dragFillToViewportRightColumnLayout());var h=p.x+p.width-s,m=d.y+d.height-l;u>=p.x&&u<=p.x+p.width&&c>=d.y&&c<=d.y+d.height?n._currentFillDirection=h>=m?4:5:f=!0}}else n._dragToColumn<n._dragFillStartLeftColumn()?n._currentFillDirection=0:n._dragToColumn>n._dragFillStartRightColumn()&&(n._currentFillDirection=1);else n._dragToRow<n._dragFillStartTopRow()?n._dragToColumn>=n._dragFillStartLeftColumn()&&n._dragToColumn<=n._dragFillStartRightColumn()?n._currentFillDirection=2:n._dragToColumn<n._dragFillStartLeftColumn()?(e=I(n._dragToColumn-n._dragFillStartLeftColumn()),t=I(n._dragToRow-n._dragFillStartTopRow()),n._currentFillDirection=t>=e?2:0):n._dragToColumn>n._dragFillStartRightColumn()&&(e=I(n._dragToColumn-n._dragFillStartRightColumn()),t=I(n._dragToRow-n._dragFillStartTopRow()),n._currentFillDirection=t>=e?2:1):n._dragToRow>n._dragFillStartBottomRow()&&(n._dragToColumn>=n._dragFillStartLeftColumn()&&n._dragToColumn<=n._dragFillStartRightColumn()?n._currentFillDirection=3:n._dragToColumn<n._dragFillStartLeftColumn()?(e=I(n._dragToColumn-n._dragFillStartLeftColumn()),t=I(n._dragToRow-n._dragFillStartBottomRow()),n._currentFillDirection=t>=e?3:0):n._dragToColumn>n._dragFillStartRightColumn()&&(e=I(n._dragToColumn-n._dragFillStartRightColumn()),t=I(n._dragToRow-n._dragFillStartBottomRow()),n._currentFillDirection=t>=e?3:1));var g=n._sheet._render._dragFillIndicatorRect;if(g){var _=n._dragFillStartBottomRow(),v=n._dragFillStartRightColumn(),y=_+1,b=v+1,C=n._sheet.getRowHeight(_,3),S=n._sheet.getColumnWidth(v,3),x=n._sheet.getRowHeight(y,3),T=n._sheet.getColumnWidth(b,3),E=g.x+g.width/2-R(10,S/2),M=g.x+g.width/2+R(10,T/2),A=g.y+g.height/2-R(10,C/2),k=g.y+g.height/2+R(10,x/2),O=!1;r||o?o?O=E<=u&&u<=M:r&&(O=A<=c&&c<=k):O=E<=u&&u<=M&&A<=c&&c<=k,O||f?(n._isDragAroundIndicator=!0,n._currentFillDirection=4):n._isDragAroundIndicator=!1}},_dragFillStartTopRow:function(){return this._dragFillStartRange?-1===this._dragFillStartRange.row?0:this._dragFillStartRange.row:-1},_dragFillStartBottomRow:function(){var e=this;return e._dragFillStartRange?-1===e._dragFillStartRange.row?l(e._sheet)-1:e._dragFillStartRange.row+f(e._dragFillStartRange)-1:-1},_dragFillStartLeftColumn:function(){return this._dragFillStartRange?-1===this._dragFillStartRange.col?0:this._dragFillStartRange.col:-1},_dragFillStartRightColumn:function(){var e=this;return e._dragFillStartRange?-1===e._dragFillStartRange.col?u(e._sheet)-1:e._dragFillStartRange.col+c(e._dragFillStartRange)-1:-1},_endDragFill:function(){var e=this,t=e._sheet;if(e._startHitInfo=A,e._stopScroll(),e._removeTooltip(),!e._isDraggingFill||!e._isWorking)return void e._resetDragFill();e._isDraggingFill=!1,e._isWorking=!1;var n=e._getDragFillFrameRange();if(n){if(!e._validateFillRange(e._dragFillStartRange,e._currentFillRange)||e._isDragAroundIndicator)e._resetDragFill(),e._refreshSelection(n);else{var r=e._getDragAutoFillType();t._commandManager().execute({cmd:"fill",sheetName:t.name(),startRange:t._eventHandler._dragFillStartRange,fillRange:e._currentFillRange,autoFillType:r,fillDirection:t._eventHandler._getCurrentFillDirection()});!e._isCancelDragFill&&e._isDragFill()&&t.parent.options.showDragFillSmartTag&&4!==e._currentDragFillType?e._showDragFillSmartTag(e._currentDragFillType):e._refreshSelection(n),e._resetDragFill()}}},_showDragFillSmartTag:function(e){var t=this._sheet,n=t._render._dragFillIndicatorRect,r={x:n.x+n.width,y:n.y+n.height,fillType:e};t._fillDialog=new y._FillDialog(t.parent._getContainerDiv(),t,r),t._fillDialog._open()},_updateDragFillStartRange:function(){var e=this._sheet;1===e._selectionModel.length?this._dragFillStartRange=e._selectionModel[0]:e._activeRowIndex>=0&&e._activeColIndex>=0&&(this._dragFillStartRange=C(e._activeRowIndex,e._activeColIndex,1,1))},_resetDragFill:function(){this._isWorking=!1,this._isDraggingFill=!1},_refreshSelection:function(e){this._sheet._render._repaintSelection(e)},_getDragAutoFillType:function(e){var t=this,n=t._sheet;e!==k||n.parent.options.defaultDragFillType;return t._isDragClear()?4:1!==f(t._dragFillStartRange)||1!==c(t._dragFillStartRange)||t._isDragFillWholeColumns()||t._isDragFillWholeRows()?t._isControlPressed?0:1:t._isControlPressed?1:0},_getDragFillFrameRange:function(){var e=this;if(!e._dragFillStartRange)return A;if(e._isDragClear())return e._dragFillStartRange;if(!e._currentFillRange)return A;var t=0,n=0,r=0,o=0;return e._isVerticalDragFill()?(t=2===e._currentFillDirection?e._currentFillRange.row:e._dragFillStartRange.row,n=f(e._dragFillStartRange)+f(e._currentFillRange),r=e._dragFillStartRange.col,o=c(e._dragFillStartRange)):(t=e._dragFillStartRange.row,n=f(e._dragFillStartRange),r=0===e._currentFillDirection?e._currentFillRange.col:e._dragFillStartRange.col,o=c(e._dragFillStartRange)+c(e._currentFillRange)),C(t,r,n,o)},_validateFillRange:function(e,t,n){function r(e,t,n){var r=t.row===n.row&&t.rowCount===n.rowCount,o=t.col===n.col&&t.colCount===n.colCount;if(!r&&!o)return!1;var i=e.getSpan(t.row,t.col);if(!i||!i.equals(t))return!1;for(var a=0;a<n.rowCount;a++)for(var s=0;s<n.colCount;s++){var l=e.getSpan(n.row+a,n.col+s);if(!l||l.rowCount!==i.rowCount||l.colCount!==i.colCount)return!1;o&&(a+=i.rowCount),r&&(s+=i.colCount)}return!0}var o=this._sheet,i=!0,a="";return o._getSpanModel().hasSpans(t.row,t.col,f(t),c(t))&&!r(o,e,t)&&(i=!1,a=H().Exp_FillRangeContainsMergedCell),i&&o.options.isProtected&&o._isAnyCellInRangeLocked(t)&&(i=!1,a=H().Exp_FillCellsReadOnly),i||n||o._raiseInvalidOperation(2,a),i},_isDragFill:function(){return this._isIncreaseFill()||this._isDecreaseFill()},_isIncreaseFill:function(){return 3===this._currentFillDirection||1===this._currentFillDirection},_isDecreaseFill:function(){return 0===this._currentFillDirection||2===this._currentFillDirection},_isVerticalDragFill:function(){return 2===this._currentFillDirection||3===this._currentFillDirection||5===this._currentFillDirection},_getCurrentFillDirection:function(){var e=this._currentFillDirection;return e>=0&&e<=3?e:4===e?0:5===e?2:3},_getDragInfo:function(e,t,n){var i=this,a=A,s=r(e),l=o(e);if(T(s)||T(l))return a;var u=i._sheet,c=u.parent,f=u._getActiveSelectedRange();if(-1===f.row&&-1===f.col)return a;if(s>=0&&l>=0&&1===u._selectionModel.length){if(i._inGrayArea(s,l,t,n))return a;var d=u.getRangeRect(s,l,f);if(d.x-4<t&&t<d.x+4&&d.y<=n&&n<d.y+d.height&&(a={action:N,side:"left"}),!a){var p=i._sheet._render._dragFillIndicatorRect;p&&p.x<=t&&t<=p.x+p.width&&p.y<=n&&n<=p.y+p.height&&(a={action:N,side:F})}a||d.x+d.width-4<t&&t<d.x+d.width+4&&d.y<=n&&n<d.y+d.height&&(a={action:N,side:"right"}),a||d.y-4<n&&n<d.y+4&&d.x<=t&&t<d.x+d.width&&(a={action:N,side:"top"}),a||d.y+d.height-4<n&&n<d.y+d.height+4&&d.x<=t&&t<d.x+d.width&&(a={action:N,side:"bottom"}),a&&(t<d.x||t>d.x+d.width||n<d.y||n>d.y+d.height)&&(a.outside=!0)}return c&&c.options.allowUserDragDrop||a&&a.side!==F&&(a.side=A),c&&c.options.allowUserDragFill||a&&a.side===F&&(a.side=A),a}}),w.extend(g._SheetRender.prototype,{_getDragFillIndicatorRect:function(e,t){var n=this._sheet,r=e.x,o=e.y,i=p(e),a=d(e),s=n._getActiveSelectedRange(),l=n._getSheetLayout(),u=4,c=-2.5;t>2007&&(u=5,c=-3);var f=new E(-4,-4,u,u);return-1===s.col?(f.x=l._frozenX,f.y=o+a+c):-1===s.row?(f.x=r+i+c,f.y=l._frozenY):(f.x=r+i+c,f.y=o+a+c),f},_paintDragFillIndicator:function(e,t,n,r,o){var i=this,a=i._sheet,s=a._getSheetLayout(),l=a.parent,u=l&&l._themeVersion,c=i._getDragFillIndicatorRect(r,u),f=c.x,h=c.y,m=p(c),_=d(c),v=s._viewportRect(t,n);if((!o||c.intersectRect(o))&&c.intersectRect(v)){var y=-1.5;u>2007&&(y=-1);var b=new E(f+y,h+y,m+2,_+2);b.x=O(b.x,v.x),b.y=O(b.y,v.y),i._copyDoubleBufferRect(b),e.save(),o&&!o.containsRect(c)&&(e.rect(o.x,o.y,p(o),d(o)),e.clip()),e.beginPath(),e.fillStyle=g._ThemeContext._getColor(a,a.getSelectionBorderColor()),e.fillRect(f,h,m,_),i._dragFillIndicatorRect=new E(c.x,c.y,4,4),e.beginPath(),e.restore()}},_paintDragRectangle:function(e,t){var n=t.x,r=t.y,o=n+p(t),i=r+d(t);h(e,n,r,o,r),h(e,n,i,o,i),h(e,n,r,n,i),h(e,o,r,o,i)},_paintDragDropIndicator:function(e,t){var n=this,r=n._sheet,o=r._eventHandler._dragRect,i=o.hitTarget;if(o&&i){var a,s=o.hitCol,l=o.hitRow,u=r._eventHandler._isDragInsert,c=r._dragOldRect;if(e.save(),!0!==u||-1!==o.row&&-1!==o.col)c&&(a=new E(c.x-2,c.y-2,p(c)+4,d(c)+4),n._copyDoubleBufferRect(a,t),n._repaintSelection(r._getActiveSelectedRange(),t)),e.rect(t.x,t.y,p(t),d(t)),e.clip(),e.beginPath(),n._paintDragRectangle(e,o);else if(-1===o.row&&-1!==o.col){var f=r._getColumnLayout(0).findCol(s);if(f||(f=r._getColumnLayout(1).findCol(s)),f||(f=r._getColumnLayout(2).findCol(s)),f){var m=f.x,g=p(f);o.col=s,i.x>m+g/2&&(o.col<r._getLastFullyVisibleColumn()||o.col===r._getLastVisualColumn())&&(m=f.x+p(f),o.col++),c&&0===p(c)||(c=r._eventHandler._dragRect),c&&(a=new E(c.x-2,c.y-2,p(c)+4,d(c)+4),n._copyDoubleBufferRect(a,t),n._repaintSelection(r._getActiveSelectedRange(),t)),r._insertDragRect=new E(m,o.y,0,d(o)),e.rect(t.x,t.y,p(t),d(t)),e.clip(),e.beginPath(),h(e,m,o.y,m,o.y+d(o))}}else if(-1!==o.row&&-1===o.col){var _=r._getRowLayout(0).findRow(l);if(_||(_=r._getRowLayout(1).findRow(l)),_||(_=r._getRowLayout(2).findRow(l)),_){var v=_.y,y=d(_);o.row=l,i.y>v+y/2&&(o.row<r._getLastFullyVisibleRow()||o.row===r._getLastVisualRow())&&(v=_.y+d(_),o.row++),c&&0===d(c)||(c=r._eventHandler._dragRect),c&&(a=new E(c.x-2,c.y-2,p(c)+4,d(c)+4),n._copyDoubleBufferRect(a,t),n._repaintSelection(r._getActiveSelectedRange(),t)),r._insertDragRect=new E(o.x,v,p(o),0),e.rect(t.x,t.y,p(t),d(t)),e.clip(),e.beginPath(),h(e,o.x,v,o.x+p(o),v)}}e.beginPath(),e.restore()}},_refreshDragDropIndicator:function(){var e=this,t=e._sheet,n=t._currentTarget;if(n&&n.dragInfo){var r=e._getCtx(),o=t._getSheetLayout(),i=t._eventHandler._actualDragRange,a=t._eventHandler._dragRect,s=t._getRangeWholeRect(i),l=t.frozenTrailingColumnCount(),u=t.frozenTrailingRowCount(),c=t.getColumnCount()-l,f=t.getRowCount()-u,h=o._viewportRect(1,1);l>0&&i.col+i.colCount<=c&&s.x+p(s)>h.x+p(h)&&s.intersectRect(h)&&(s=s.getIntersectRect(h)),u>0&&i.row+i.rowCount<=f&&s.y+d(s)>h.y+d(h)&&s.intersectRect(h)&&(s=s.getIntersectRect(h));var m=new E(o._frozenX,o._frozenY,o._frozenTrailingX+o._frozenTrailingWidth,o._frozenTrailingY+o._frozenTrailingHeight);p(s)>0&&d(s)>0?(a.x=s.x,a.y=s.y,a.width=p(s)-1,a.height=d(s)-1,e._paintDragDropIndicator(r,m)):0!==p(s)&&0!==d(s)||(a.x=s.x,a.y=s.y,a.width=p(s),a.height=d(s),e._paintDragDropIndicator(r,m));var g=t._eventHandler._isDragInsert;t._dragOldRect=!0===g?t._insertDragRect:new E(a.x,a.y,p(a),d(a))}}})},function(e,t,n){var t=n(19);n(135),n(136),n(137),n(138),t.SR={},t.SR.en=n(75),e.exports=t},function(e,t,n){var r=n(1),o=n(5),i=r.CalcEngine,a=n(19),s=r._createRange,l=r.GC$,u=l.extend,c=null,f=Math.max,d=Math.min,p=a._stringToRange,h=a._rangeToString;u(r._SheetEventHandler.prototype,{_startFormulaRangeAppending:function(e){var t=this,n=t._sheet,r=n._formulaTextBox;if(r){var o=n.frozenRowCount(),i=n.frozenColumnCount(),a=r._isAppending;a&&t._formulaRangeAppendingInfo||(t._formulaRangeAppendingInfo={anchorRow:-1,anchorCol:-1,leadingRow:-1,leadingCol:-1});var l,u=n.getRowCount(),c=n.getColumnCount(),f=e.hitTestType,d=e.row,p=e.col,m=t.shift,g=t.ctrl,_=t._formulaRangeAppendingInfo,v=_.anchorRow,y=_.anchorCol,b=-1,w=-1;0===f?(b=o?n._getFirstVisualRow():n._scrollTopRow,w=i?n._getFirstVisualColumn():n._scrollLeftCol,l=s(-1,-1,-1,-1),r._appendRange(h(n,l),m,!g),t._isWorking=!0):1===f?(b=o?n._getFirstVisualRow():n._scrollTopRow,w=p,l=n._getExtendedRange(0,p,u-1,p),m&&y>=0&&(l=n._getExtendedRange(0,p,u-1,y)),l=s(-1,l.col,-1,l.colCount),r._appendRange(h(n,l),m,!g),t._isWorking=!0):2===f?(b=d,w=i?n._getFirstVisualColumn():n._scrollLeftCol,l=n._getExtendedRange(d,0,d,c-1),m&&v>=0&&(l=n._getExtendedRange(d,0,v,c-1)),l=s(l.row,-1,l.rowCount,-1),r._appendRange(h(n,l),m,!g),t._isWorking=!0):3===f&&(b=d,w=p,l=n._getExtendedRange(d,p,d,p),l=s(l.row,l.col,1,1),m&&v>=0&&y>=0&&(l=n._getExtendedRange(d,p,v,y)),r._appendRange(h(n,l),m,!g),t._isWorking=!0),t._isFormulaRangeAppending=t._isWorking,m&&a||(_.anchorRow=b,_.anchorCol=w,_.leadingRow=b,_.leadingCol=w),t._startHitInfo={_scrollRowViewportIndex:e.rowViewportIndex,_scrollColViewportIndex:e.colViewportIndex,_hitTestType:e.hitTestType},t._startScroll()}},_clearFormulaTextbox:function(e){var t=!1,n=a._formulatextboxAcrossSheetSingleton._formulatextboxAcrossSheetInstance;if(n&&n._dom){var o=n._sheet,i=e._formulaTextBox;if(i&&o.setFormula(n._rowIndex,n._columnIndex,i.text()),o!==e){if(r.Commands._FormulatextboxCommands._changeSheetForFormulaTextboxAcrossSheet(o),!o.endEdit())return;t=!0}else i&&(i.destroy(),e._formulaTextBox=c),n._clear()}return t},_continueFormulaRangeAppending:function(){var e=this,t=e._startHitInfo;if(t&&e._isWorking){var n=t._hitTestType;3===n?e._continueFormulaRangeCellAppending():2===n?e._continueFormulaRangeRowAppending():1===n&&e._continueFormulaRangeColumnAppending()}},_continueFormulaRangeCellAppending:function(){var e=this,t=e._formulaRangeAppendingInfo,n=t.anchorRow,r=t.anchorCol,o=e._getHitRowIndex(),i=e._getHitColumnIndex();if(n>=0&&r>=0&&o>=0&&i>=0){var a=e._sheet,s=a._getExtendedRange(o,i,n,r),l=h(a,s);if(l){a._formulaTextBox._appendRange(l,!0,!1)}}e._continueScroll()},_continueFormulaRangeRowAppending:function(){var e=this,t=e._formulaRangeAppendingInfo.anchorRow,n=e._getHitRowIndex();if(t>=0&&n>=0){var r=e._sheet,o=r._getExtendedRange(n,0,t,r.getColumnCount()-1);o=s(o.row,-1,o.rowCount,-1);var i=h(r,o);if(i){r._formulaTextBox._appendRange(i,!0,!1)}}e._continueScroll()},_continueFormulaRangeColumnAppending:function(){var e=this,t=e._formulaRangeAppendingInfo.anchorCol,n=e._getHitColumnIndex();if(t>=0&&n>=0){var r=e._sheet,o=r._getExtendedRange(0,n,r.getRowCount()-1,t);o=s(-1,o.col,-1,o.colCount);var i=h(r,o);if(i){r._formulaTextBox._appendRange(i,!0,!1)}}e._continueScroll()},_stopFormulaRangeAppending:function(){var e=this;e._stopScroll(),e._startHitInfo=c,e._isWorking=!1,e._isFormulaRangeAppending=!1},_startFormulaRangeMoving:function(e){var t=this,n=t._sheet,r=n._formulaTextBox,o=e.formulaRangeHitInfo;if(o&&o.inBorder&&r){r._isAppending&&r._stopAppending(),r.close();var i=o.paramRange,a=i&&i.text;if(a){var s=p(n,a);if(s){var l=n._getActualRange(s),u=e.row,c=e.col;u<l.row&&(u=l.row),u>=l.row+l.rowCount&&(u=l.row+l.rowCount-1),c<l.col&&(c=l.col),c>=l.col+l.colCount&&(c=l.col+l.colCount-1);var f=u-l.row,d=c-l.col;t._isWorking=!0,t._isFormulaRangeMoving=!0,t._formulaRangeMovingInfo={paramRange:i,fromRange:s,rowOffset:f,colOffset:d},t._startHitInfo={_scrollRowViewportIndex:e.rowViewportIndex,_scrollColViewportIndex:e.colViewportIndex,_hitTestType:e.hitTestType},t._startScroll()}}}},_continueFormulaRangeMoving:function(){var e=this;if(e._isWorking&&e._isFormulaRangeMoving){var t=e._getHitRowIndex(),n=e._getHitColumnIndex();if(t>=0&&n>=0){var r=e._formulaRangeMovingInfo,o=r.fromRange,i=r.rowOffset,a=r.colOffset,l=r.toRow,u=r.toCol,c=t,p=n;if(c!==l||p!==u){r.toRow=c,r.toCol=p;var m=e._sheet,g=m.getRowCount(),_=m.getColumnCount(),v=o.row,y=o.col,b=o.rowCount,w=o.colCount,C=v<0?-1:f(0,d(g-b,t-i)),S=y<0?-1:f(0,d(_-w,n-a)),x=h(m,s(C,S,b,w));if(x){m._formulaTextBox._repalceRange(r.paramRange.index,x)}}}e._continueScroll()}},_stopFormulaRangeMoving:function(){var e=this;e._stopScroll(),e._isWorking=!1,e._isFormulaRangeMoving=!1,e._formulaRangeMovingInfo=c},_startFormulaRangeResizing:function(e){var t=this,n=t._sheet,r=n._formulaTextBox,o=e.formulaRangeHitInfo;if(o&&r){r._isAppending&&r._stopAppending();var i=o.paramRange,a=i&&i.text;if(i&&a){var s=p(n,a);if(s){var l,u,c,f,d=s.row,h=s.row<0?-1:s.row+s.rowCount-1,m=s.col,g=s.col<0?-1:s.col+s.colCount-1;if(o.inTopLeft)l=h,u=g,c=d,f=m;else if(o.inTopRight)l=h,u=m,c=d,f=g;else if(o.inBottomLeft)l=d,u=g,c=h,f=m;else{if(!o.inBottomRight)return;l=d,u=m,c=h,f=g}t._isWorking=!0,t._isFormulaRangeResizing=!0,t._formulaRangeResizingInfo={paramRange:i,anchorRow:l,anchorCol:u,toRow:c,toCol:f},t._startHitInfo={_scrollRowViewportIndex:e.rowViewportIndex,_scrollColViewportIndex:e.colViewportIndex,_hitTestType:e.hitTestType},t._startScroll()}}}},_dealMouseDownInFormulatextbox:function(e,t){var n=e._formulaTextBox;return n&&n._canAppendRange()?(this._startFormulaRangeAppending(t),!0):!!this._clearFormulaTextbox(e)},_continueFormulaRangeResizing:function(){var e=this;if(e._isWorking&&e._isFormulaRangeResizing){var t=e._getHitRowIndex(),n=e._getHitColumnIndex();if(t>=0&&n>=0){var r=e._formulaRangeResizingInfo,o=r.anchorRow,i=r.anchorCol,a=r.toRow,l=r.toCol,u=t,c=n;if(u!==a||c!==l){r.toRow=u,r.toCol=c;var p=e._sheet,m=p.getRowCount(),g=p.getColumnCount(),_=o<0?m-1:o,v=i<0?g-1:i,y=d(_,u),b=d(v,c),w=f(_,u)-y+1,C=f(v,c)-b+1;0===y&&w===m&&(y=-1,w=-1),0===b&&C===g&&(b=-1,C=-1);var S=h(p,s(y,b,w,C));if(S){p._formulaTextBox._repalceRange(r.paramRange.index,S)}}}e._continueScroll()}},_stopFormulaRangeResizing:function(){var e=this;e._stopScroll(),e._isWorking=!1,e._isFormulaRangeResizing=!1,e._formulaRangeResizingInfo=c;var t=e._sheet._formulaTextBox;if(t._isSelectMode){t._appendingStart=1;var n=t.text().lastIndexOf(",",t.caret());-1!==n&&(t._appendingStart=n+1)}},_getFormulaRangeHitInfo:function(e,t,n){var r=this._sheet,o=r._formulaTextBox,i=o&&o._getRanges();if(!i||0===i.length)return c;var s=e.rowViewportIndex,l=e.colViewportIndex;if(this._inGrayArea(s,l,t,n))return c;for(var u,f,d,h=i.length-1;h>=0;h--)if(u=i[h],!1!==u.allowDrag){var m=a._formulatextboxAcrossSheetSingleton._formulatextboxAcrossSheetInstance;if((!m||!m._text)&&(f=p(r,u.text))){d=r.getRangeRect(s,l,f);var g=5,_=d.x-2,v=d.x+d.width+1-g,y=d.y-2,b=d.y+d.height+1-g;if(_+g<=t&&t<v&&(y+1<=n&&n<=y+3||b+1<=n&&n<=b+3))return{paramRange:u,inBorder:!0};if(y+g<=n&&n<b&&(_+1<=t&&t<=_+3||v+1<=t&&t<=v+3))return{paramRange:u,inBorder:!0};if(v<=t&&t<v+g&&b<=n&&n<b+g)return{paramRange:u,inBottomRight:!0};if(_<=t&&t<_+g&&b<=n&&n<b+g)return{paramRange:u,inBottomLeft:!0};if(v<=t&&t<v+g&&y<=n&&n<y+g)return{paramRange:u,inTopRight:!0};if(_<=t&&t<_+g&&y<=n&&n<y+g)return{paramRange:u,inTopLeft:!0}}}return c},_changeFormulaReference:function(){var e=this,t=e._sheet,n=t._formulaTextBox;if(n){var r,a,s=t._activeRowIndex,l=t._activeColIndex,u=t.parent,f=u&&1===u.options.referenceStyle,d=new i.SheetParserContext(t,f,o._createCellIdentity(s,l)),p=new o.Parser;if(n._isAppending)for(var h=n._getAppendingRanges(),m=0;m<h.length;m++){r=h[m];try{a=p.parse(d,r.text)}catch(e){a=c}if(a&&1===a.type){var g=!a._isCell;e._changeRangeExpressionReference(a,s,l,g,g),n._repalceRange(r.index,p.unparse(d,a))}}else{if(!(r=n._getActiveRange()))return;try{a=p.parse(d,r.text)}catch(e){a=c}if(!a)return;if(1!==a.type||a._isCell)1===a.type&&(e._changeCellExpressionReference(a,s,l),n._repalceRange(r.index,p.unparse(d,a)));else{var _=r.textOffset+r.text.lastIndexOf(":");if(n.caret()<=_){e._changeRangeExpressionReference(a,s,l,!0,!1);var v=p.unparse(d,a);n._repalceRange(r.index,v),n.caret(r.textOffset+v.lastIndexOf(":"))}else e._changeRangeExpressionReference(a,s,l,!1,!0),n._repalceRange(r.index,p.unparse(d,a))}}}},_changeRangeExpressionReference:function(e,t,n,r,o){var i=e.rowRelative,a=e.columnRelative;r&&(i&&a?(e.rowRelative=!1,e.columnRelative=!1,e.row+=t,e.column+=n):i?(e.columnRelative=!0,e.column-=n):a?(e.rowRelative=!0,e.columnRelative=!1,e.row-=t,e.column+=n):(e.columnRelative=!0,e.column-=n));var s=e.endRowRelative,l=e.endColumnRelative;o&&(s&&l?(e.endRowRelative=!1,e.endColumnRelative=!1,e.endRow+=t,e.endColumn+=n):s?(e.endColumnRelative=!0,e.endColumn-=n):l?(e.endRowRelative=!0,e.endColumnRelative=!1,e.endRow-=t,e.endColumn+=n):(e.endColumnRelative=!0,e.endColumn-=n))},_changeCellExpressionReference:function(e,t,n){var r=e.rowRelative,o=e.columnRelative;r&&o?(e.rowRelative=!1,e.columnRelative=!1,e.row+=t,e.column+=n):r?(e.columnRelative=!0,e.column-=n):o?(e.rowRelative=!0,e.columnRelative=!1,e.row-=t,e.column+=n):(e.columnRelative=!0,e.column-=n)}})},function(e,t,n){function r(e){var t=e._formulaTextBox,n=e._eventHandler;return t._isAppending?n._formulaRangeAppendingInfo:n._formulaRangeAppendingInfo={anchorRow:e._activeRowIndex,anchorCol:e._activeColIndex,leadingRow:e._leadingCellRow,leadingCol:e._leadingCellCol}}function o(e,t,n,o,i){var a=e._formulaTextBox,s=e.parent,l=s&&s.options;if(a&&a._canAppendRange()&&l&&l.allowUserEditFormula&&l.enableFormulaTextbox){var u=r(e),c=u.anchorRow,f=u.anchorCol,d=u.leadingRow,m=u.leadingCol;v(o)&&(o=c),v(i)&&(i=f);var g,_,y,b,w,C=e._eventHandler;switch(t){case 3:w=e._getMoveLeftCell(o,i,n,d);break;case 4:w=e._getMoveRightCell(o,i,n,d);break;case 1:w=e._getMoveUpCell(o,i,n,m);break;case 2:w=e._getMoveDownCell(o,i,n,m);break;case 5:w=e._getMoveFirstCell();break;case 6:w=e._getMoveLastCell()}if(w&&(g=w.row,_=w.col,y=w.leadingCellRow?w.leadingCellRow:g,b=w.leadingCellCol?w.leadingCellCol:_,e._canMoveCurrentTo(g,_))){u.anchorRow=g,u.anchorCol=_,u.leadingRow=y,u.leadingCol=b;var S=h(C._sheet,new p(g,_,1,1));S&&a._appendRange(S,!1,!0),g>=0&&_>=0&&e._scrollByMoveCell(g,_)}}}function i(e,t){if(e){if(2===e._editorStatus)return!1;var n=e._formulaTextBox;return n&&n._canAppendRange()?(o(e,t,!1),!0):(n&&(e=y._handleFormulaTextboxAcrossSheet(e)),e._moveActiveCell(t,!1),!0)}return!1}function a(e,t,n,r){if(e){if(2===e._editorStatus)return!1;var i=e._formulaTextBox;return i&&i._canAppendRange()?(o(e,t,!1,n,r),!0):(i&&(e=y._handleFormulaTextboxAcrossSheet(e)),e._moveActiveCell(t,!1,n,r),!0)}return!1}function s(e,t,n){var o=e._formulaTextBox,i=e.parent,a=i&&i.options;if(o&&o._canAppendRange()&&a&&a.allowUserEditFormula&&a.enableFormulaTextbox){var s,l=e._eventHandler,u=r(e),c=u.anchorRow,f=u.anchorCol;if(o._isAppending){var d=o._getActiveRange();s=m(e,d.text)}else s=p(c,f,1,1);if(s){var g=e._getKeyboardSelectedRange(s,t,n,c,f),_=h(l._sheet,g);_&&o._appendRange(_,!0,!1)}}}function l(e,t,n){if(e){if(2===e._editorStatus)return!1;var r=e._formulaTextBox;return r&&r._canAppendRange()?(s(e,t,n),!0):(r&&(e=y._handleFormulaTextboxAcrossSheet(e)),!!e.endEdit()&&(e._changeActiveSelectedRange(t,n),!0))}return!1}var u=n(1),c=n(19),f=void 0,d=u.Commands,p=u._createRange,h=c._rangeToString,m=c._stringToRange,g=c._detachFormulaTextBox,_=n(0),v=_._Types._isNullOrUndefined;d._navigateNoWrap=i,d._navigateNoWrapFrom=a,d._alterSelection=l;var y=function(){function e(){}return e._commitArrayFormula=function(t){return e._handleFormulaTextboxAcrossSheet(t)},e._commitInputNavigationDown=function(t){return e._handleFormulaTextboxAcrossSheet(t)},e._commitInputNavigationUp=function(t){return e._handleFormulaTextboxAcrossSheet(t)},e._handleFormulaTextboxAcrossSheet=function(t){var n=t,r=c._formulatextboxAcrossSheetSingleton._formulatextboxAcrossSheetInstance;return r&&r._text&&(n=r._sheet,e._changeSheetForFormulaTextboxAcrossSheet(n)),n},e._changeSheetForFormulaTextboxAcrossSheet=function(e,t){void 0===t&&(t=!0);var n=e.parent,r=c._formulatextboxAcrossSheetSingleton._formulatextboxAcrossSheetInstance;r&&r._text&&n._changeSheetForFormulaAcrossSheet(e,t)},e._navigationPageUp=function(t,n,o){var i=!1,a=t._formulaTextBox;if(a&&a._canAppendRange()){var s=r(t);s.anchorRow=n,s.leadingRow=n;var l=h(t,p(s.anchorRow,s.anchorCol,1,1));l&&a._appendRange(l,!1,!0),t._setTopRow(o),i=!0}else a&&(t=e._handleFormulaTextboxAcrossSheet(t));return{sheet:t,r:i}},e._navigationPageDown=function(t,n,o){var i=!1,a=t._formulaTextBox;if(a&&a._canAppendRange()){var s=r(t);s.anchorRow=n,s.leadingRow=n;var l=h(t,p(s.anchorRow,s.anchorCol,1,1));l&&a._appendRange(l,!1,!0),t._setTopRow(o),i=!0}else a&&(t=e._handleFormulaTextboxAcrossSheet(t));return{sheet:t,r:i}},e._navigationFirst=function(t){var n=!1,r=t._formulaTextBox,i=t._activeRowIndex,a=t._activeColIndex;return r&&r._canAppendRange()?(r._isAppending||(t._eventHandler._formulaRangeAppendingInfo={anchorRow:i,anchorCol:a,leadingRow:t._leadingCellRow,leadingCol:t._leadingCellCol}),o(t,5,!1,i,a),n=!0):r&&(t=e._handleFormulaTextboxAcrossSheet(t)),{sheet:t,r:n}},e._navigationLast=function(t){var n=!1,r=t._formulaTextBox,i=t._activeRowIndex,a=t._activeColIndex;return r&&r._canAppendRange()?(r._isAppending||(t._eventHandler._formulaRangeAppendingInfo={anchorRow:i,anchorCol:a,leadingRow:t._leadingCellRow,leadingCol:t._leadingCellCol}),o(t,6,!1,i,a),n=!0):r&&(t=e._handleFormulaTextboxAcrossSheet(t)),{sheet:t,r:n}},e._moveToNextCell=function(t){return e._handleFormulaTextboxAcrossSheet(t)},e._moveToPreviousCell=function(t){return e._handleFormulaTextboxAcrossSheet(t)},e._cancelInput=function(t){var n=c._formulatextboxAcrossSheetSingleton._formulatextboxAcrossSheetInstance;if(c&&n&&n._text){t=n._sheet;var r=n._rowIndex,o=n._columnIndex;e._changeSheetForFormulaTextboxAcrossSheet(t,!1),g(t),t._setActiveCellAndSelection(r,o,f,f,1)}},e}();u.Commands._FormulatextboxCommands=y},function(e,t,n){var r=n(1),o=r.GC$,i=n(19),a=null,s=void 0,l=function(){function e(){var e=this;e._rowIndex=-1,e._columnIndex=-1,e._text="",e._caret=-1,e._sheet=null,e._isAppending=!1,e._appendingIndex=-1,e._dom=null,e._workbook=null,e._canvasOffset=null}return e.prototype={constructor:e,_clear:function(){var e=this;e._removeDom(),e._rowIndex=-1,e._columnIndex=-1,e._text="",e._caret=-1,e._isAppending=!1,e._appendingIndex=-1,e._sheet=null,e._workbook=null,e._canvasOffset=null},_removeDom:function(){var e=this;if(!e._sheet._disposed){var t=e._sheet.getCellType(e._rowIndex,e._columnIndex),n={sheet:e._sheet,row:e._rowIndex,col:e._columnIndex,sheetArea:3};e._dom&&e._dom.firstChild&&t.deactivateEditor(e._dom.firstChild.firstChild,n)}o(e._dom).remove(),e._dom=null},_save:function(e){var t=this;e._formulaTextBox&&(t._text=e._formulaTextBox.text(),t._rowIndex=e.getActiveRowIndex(),t._columnIndex=e.getActiveColumnIndex(),t._caret=e._formulaTextBox.caret(),t._isAppending=e._formulaTextBox._isAppending,t._appendingIndex=e._formulaTextBox._appendingStartIndex(),t._isSelectMode=e._formulaTextBox._isSelectMode,t._selectModeId=e._formulaTextBox._selectModeId,t._sheet=e,t._workbook=e.parent,t._canvasOffset=e._eventHandler._getCanvasPosition())},_update:function(e){var t=this;e._formulaTextBox&&(t._text=e._formulaTextBox.text(),t._caret=e._formulaTextBox.caret(),t._isAppending=e._formulaTextBox._isAppending,t._appendingIndex=e._formulaTextBox._appendingStartIndex())},_exportInfo:function(e){var t=this;e._formulaTextBox&&(e._formulaTextBox._isSelectMode=t._isSelectMode,e._formulaTextBox._selectModeId=t._selectModeId,e._formulaTextBox.text(t._text),e._formulaTextBox.caret(t._caret),t._isAppending&&(e._formulaTextBox._startAppending(),e._formulaTextBox._appendingStartIndex(t._appendingIndex)))},_handleFormulatextboxBeforeChange:function(e){var t=e.oldSheet,n=e.newSheet,r=this,o=t._formulaTextBox;if(o)if(o.close(),(!r._sheet||r._sheet._disposed)&&o._canAppendRange()||r._selectModeId!==o._selectModeId){r._save(t);var i=t.getValue(t._activeRowIndex,t._activeColIndex,3);t.suspendEvent();try{if(!t.endEdit(!0))return}finally{t.resumeEvent()}t.setValue(t._activeRowIndex,t._activeColIndex,i,3,!0),t._editorStatus=1,e.needTriggerSheetChange=!1}else r._text&&r._sheet===n?(r._update(t),o.destroy(),t._formulaTextBox=a,e.needTriggerSheetChange=!1):r._text&&r._sheet!==n&&(r._update(t),o.destroy(),t._formulaTextBox=a,e.needTriggerSheetChange=!1)},_handleFormulatextboxAfterChange:function(e){var t=e.oldSheet,n=e.newSheet,r=this;if(!n._disposed)if(r._dom&&""===r._text&&(t._loadAndSetSheetSelections(),r._clear()),r._text&&r._sheet===n){if(n._editorStatus=0,n._setActiveCellAndSelection(r._rowIndex,r._columnIndex,s,s,0),n.suspendEvent(),r._isSelectMode){var o=i._createEditorElement(n.parent._host);i._attachFormulaTextBox(n,o),n._editorStatus=2,n._render._paintFormulaTextBox()}else n.startEdit(!1);n.resumeEvent(),r._exportInfo(n),r._updateEditor(n,r._rowIndex,r._columnIndex),t._loadAndSetSheetSelections(),r._clear()}else r._text&&!r._dom?(n._editorStatus=1,t._editorStatus=1,r._createHiddenDomForFormulaAcrossSheet(n),n._saveAndClearSheetSelections()):r._text&&r._sheet!==n&&(n._editorStatus=1,t._editorStatus=1,r._createHiddenDomForFormulaAcrossSheet(n),t._loadAndSetSheetSelections(),n._saveAndClearSheetSelections())},_createHiddenDomForFormulaAcrossSheet:function(e){var t=this,n=t._sheet;if(!n._disposed){var r,s=t._rowIndex,l=t._columnIndex,u=n.getCellType(s,l),c={sheet:n,row:s,col:l,sheetArea:3,canvasOffset:this._canvasOffset},f=u.isImeAware(c);if(f){e._editorStatus=1,r=u._createCellTypeElement(c),t._dom&&t._removeDom(),t._dom=r,o(r).css("position","absolute");var d=n.getCellRect(s,l);o(r).attr("id","across");var p=n.getActualStyle(s,l);u._activateEditorWrapper(r,p,d,c);(t._workbook&&t._workbook.getHost()||document.body).insertBefore(r,a);var h=u.getEditingElement();t._isSelectMode&&o(r).css({display:"none"}),i._attachFormulaTextBox(e,h),r.firstChild&&!t._isSelectMode&&u.focus(r.firstChild.firstChild),t._exportInfo(e),u._updateEditorWrapper(r,p,d,c)}}},_updateEditor:function(e,t,n){var r=e.getCellType(t,n),o=e._editor,i=e._getSheetLayout(),a=e.getActualStyle(t,n),s=e.getCellRect(t,n);if(s&&s.width>0&&s.height>0&&s.x>=i._frozenX&&s.y>=i._frozenY&&s.x+s.width<=i._frozenTrailingX+i._frozenTrailingWidth&&s.y+s.height<=i._frozenTrailingY+i._frozenTrailingHeight){var l={sheet:e,row:t,col:n,sheetArea:3};o&&o.parentNode&&r._updateEditorWrapper(o.parentNode.parentNode,a,s,l,!0)}}},e}(),u=function(){function e(){}return e._handleFormulatextboxAcrossSheetBeforeTabChange=function(e,t){i._formulatextboxAcrossSheetSingleton._formulatextboxAcrossSheetInstance||(i._formulatextboxAcrossSheetSingleton._formulatextboxAcrossSheetInstance=new l),i._formulatextboxAcrossSheetSingleton._formulatextboxAcrossSheetInstance._handleFormulatextboxBeforeChange(t)},e._handleFormulatextboxAcrossSheetAfterTabChange=function(e,t){i._formulatextboxAcrossSheetSingleton._formulatextboxAcrossSheetInstance._handleFormulatextboxAfterChange(t)},e}();i._formulatextboxAcrossSheetSingleton=u,e.exports=i},function(e,t,n){function r(e,t,n,r,o){var s=e._sheet,l=s._eventHandler,f=s._formulaTextBox,d=f&&f._getRanges(),p=d&&d.length;if(!(p<=0)){var h=e._getClipRect(n,r,o);if(h){t.save(),t.rect(h.x,h.y,h.width,h.height),t.clip(),t.beginPath();for(var m,g,_,v,y,b=[],w=l.isFormulaRangeHoving,C=l._formulRangeHovingInfo,S=l._isFormulaRangeMoving,x=l._formulaRangeMovingInfo,T=l._isFormulaRangeResizing,E=l._formulaRangeResizingInfo,M=0;M<p;M++)if(m=d[M],g=m.text,_=m.ranges&&m.ranges.length>0?m.ranges:[c(s,g)]){var A=a._formulatextboxAcrossSheetSingleton._formulatextboxAcrossSheetInstance;if(A&&A._sheet)if(u._contains(g,"!")){var k=u._leftBefore(g,"!");if(s.name()!==k&&"'"+s.name()+"'"!==k)continue}else{var R=u._leftBefore(g,"["),I=s.tables;if(!(s.getCustomNames()[R]||I&&I.findByName(R)))continue}v=e._getPaintingRects(n,r,_,h);for(var O=0;O<v.length;O++){var D=v[O];if(D&&D.width>0&&D.height>0){if(y=f._getRangeColor(M),f._isAppendingRange(m)?(w&&C.paramRange.index===M&&(t.beginPath(),t.lineWidth=2,t.strokeStyle=y,t.rect(D.x+1,D.y+1,D.width-3,D.height-3),t.stroke()),e._paintDashRect(t,D,y)):w&&C.paramRange.index===M||S&&x.paramRange.index===M||T&&E.paramRange.index===M?(t.beginPath(),t.lineWidth=2,t.strokeStyle=y,t.rect(D.x+1,D.y+1,D.width-3,D.height-3),t.stroke()):(t.beginPath(),t.lineWidth=2,t.strokeStyle=y,t.rect(D.x,D.y,D.width-1,D.height-1),t.stroke()),f._isActiveRange(m)){var P=i._ColorHelper._fromString(y);P.a=.1,t.beginPath(),t.fillStyle=i._ColorHelper._toString(P),t.fillRect(D.x+1,D.y+1,D.width-3,D.height-3)}b.push({rect:D,color:y,allowDrag:m.allowDrag})}}}if(b.length>0){var N=b.length;for(M=0;M<N;M++){D=b[M].rect,y=b[M].color;var F=5,L=D.x-2,H=D.x+D.width+1-F,V=D.y-2,j=D.y+D.height+1-F;!1!==b[M].allowDrag&&((A=a._formulatextboxAcrossSheetSingleton._formulatextboxAcrossSheetInstance)&&A._text||(t.beginPath(),t.fillStyle=y,t.fillRect(L,V,F,F),t.fillRect(H,V,F,F),t.fillRect(L,j,F,F),t.fillRect(H,j,F,F)))}}t.beginPath(),t.restore()}}}var o=n(1),i=n(0),a=n(19),s=o.GC$,l=s.extend,u=i._StringHelper,c=a._stringToRange;l(o._SheetRender.prototype,{_paintFormulaTextBox:function(){var e=this,t=e._sheet;if(!(t._layoutSuspended>0)){var n=t._getSheetLayout(),r=e._getCtx();e._copyDoubleBuffer(n.x,n.y,n.width,n.height),e._paintAdornment(r)}}}),o.Worksheet._registerFeature("formulatextboxrender",{paintAdornment:function(e){var t,n,o,i=this,a=e.ctx,s=e.clipRect,l=i._render,u=i._getSheetLayout();if(i._formulaTextBox)for(n=0;n<=2;n++)for(o=0;o<=2;o++)(t=u._viewportRect(n,o))&&0!==t.width&&0!==t.height&&r(l,a,n,o,s)}})},function(e,t,n){function r(e){return n(o(e))}function o(e){var t=i[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var i={"./Helper/common":11,"./SR/common":39,"./zhSR/common":140};r.keys=function(){return Object.keys(i)},r.resolve=o,e.exports=r,r.id=139},function(e,t){e.exports={Exp_InvalidDateFormat:"无效日期格式",Exp_InvalidExponentFormat:"无效指数格式",Exp_InvalidSemicolons:"无效格式 : 过多分号",Exp_InvalidNumberGroupSize:"数值组大小范围必须在 1 到 9 之间。",Exp_BadFormatSpecifier:"错误的格式指示符",Exp_InvalidNumberFormat:"无效数值格式",Exp_InvalidCast:"无效转换异常",Exp_Separator:"在文化信息中，小数点分隔符, 数组分隔符和列分隔符必须不相同。"}},function(e,t,n){function r(e){return n(o(e))}function o(e){var t=i[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var i={"./SR/formatter":41,"./zhSR/formatter":142};r.keys=function(){return Object.keys(i)},r.resolve=o,e.exports=r,r.id=141},function(e,t){e.exports={Exp_TokenIsNull:"标志为空。",Exp_InvalidBackslash:"字符 '\\' 无法被计算。",Exp_FormatIllegal:"无效格式。",Exp_ValueIsNull:"数值为空",Exp_DuplicatedDescriptor:"重复的描述被添加。",Exp_TokenIllegal:"无效标志。",Exp_ValueIllegal:"无效数值。",Exp_InvalidCast:"无效转换异常"}},function(e,t,n){function r(e){return n(o(e))}function o(e){var t=i[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var i={"./SR/calc":43,"./zhSR/calc":144};r.keys=function(){return Object.keys(i)},r.resolve=o,e.exports=r,r.id=143},function(e,t){function n(e,t){return{description:e,parameters:t}}function r(e,t){return{name:e,repeatable:t}}e.exports={Exp_InvalidCast:"无效转换异常",Exp_FormulaInvalid:"您输入的公式包含无效字符: '{0}' 在 {1} 索引处。",Exp_InvalidFunctionName:"无效函数名",Exp_InvalidOverrideFunction:"不能重写内置函数",Exp_InvalidArray:"无效数组",Exp_OverrideNotAllowed:"尝试重写函数，但重写行为是不被允许的。",Exp_NoSyntax:"没有语法在 '{0}' 处匹配到语法 '{1}'。",Exp_IsValid:"'{0}' 是无效的。",Exp_InvalidParameters:"在 {0} 处存在无效函数参数。",Exp_InvalidArrayColumns:"列数组长度在 {0} 处不相等。",Exp_ExprIsNull:"参数 'expr' 是空",Exp_InvalidNull:"无效空异常",Exp_InvalidOperation:"无效操作异常",Exp_ArgumentNull:"空参数异常",Exp_CriteriaIsNull:"条件为空",Exp_Format:"格式",Exp_ArrayFromulaPart:"你不能仅改变数组公式的一部分。",Exp_NotSupported:"不支持异常",_builtInFunctionsResource:{ABS:n("该函数返回指定数字的绝对值。",[r("value")]),ACCRINT:n("该函数返回定期付息证券的应计利息。",[r("issue"),r("first"),r("settle"),r("rate"),r("par"),r("frequency"),r("basis")]),ACCRINTM:n("该函数返回在到期日支付利息的有价证券的应计利息。",[r("issue"),r("maturity"),r("rate"),r("par"),r("basis")]),ACOS:n("该函数返回数字的反余弦值。反余弦值是角度，它的余弦值为数字。返回的角度值以弧度表示，范围是0到pi。",[r("value")]),ACOSH:n("该函数返回number参数的反双曲余弦值。参数必须大于或等于1。反双曲余弦值的双曲余弦即为number，因此ACOSH(COSH(number))等于number。",[r("value")]),ADDRESS:n("该函数在给出指定行数和列数的情况下，可以使用ADDRESS函数获取工作表单元格的地址。",[r("row"),r("column"),r("absnum"),r("a1style"),r("sheettext")]),AMORDEGRC:n("该函数返回每个结算期间的折旧值。该函数主要为法国会计系统提供。如果某项资产是在该结算期的中期购入的，则按直线折旧法计算。该函数与函数AMORLINC相似，不同之处在于该函数中用于计算的折旧系数取决于资产的寿命。",[r("cost"),r("datepurchased"),r("firstperiod"),r("salvage"),r("period"),r("drate"),r("basis")]),AMORLINC:n("该函数返回每个结算期间的折旧值，该函数为法国会计系统提供。如果某项资产是在结算期间的中期购入的，则按线性折旧法计算。",[r("cost"),r("datepurchased"),r("firstperiod"),r("salvage"),r("period"),r("drate"),r("basis")]),AND:n("该函数返回逻辑与。如果每一个参数都是TRUE时返回TRUE。",[r("logical1"),r("logical2")]),ASIN:n("该函数返回参数的反正弦值。反正弦值为一个角度，该角度的正弦值即等于此函数的number参数。返回的角度值将以弧度表示，范围为-pi/2到pi/2。",[r("value")]),ASINH:n("该函数返回参数的反双曲正弦值。反双曲正弦值的双曲正弦即等于此函数的number参数值，因此ASINH(SINH(number))等于number参数值。",[r("value")]),ATAN:n("该函数返回反正切值。反正切值为角度，起正切值即等于number参数值。返回的角度值将以弧度表示，范围为-pi/2到pi/2。",[r("value")]),ATAN2:n("该函数返回给定X及Y坐标值的反正切值。",[r("x"),r("y")]),ATANH:n("该函数返回参数的反双曲正切值。",[r("value")]),AVEDEV:n("该函数返回一组数据与其均值的绝对偏差的平均值，AVEDEV用于评测这组数据的离散度。",[r("value1"),r("value2",!0)]),AVERAGE:n("该函数返回参数的平均值。",[r("value1"),r("value2",!0)]),AVERAGEA:n("该函数计算参数列表中数值的平均值，包括文本和逻辑值。",[r("value1"),r("value2",!0)]),AVERAGEIF:n("返回某个区域内满足给定条件的所有单元格的平均值。",[r("value1"),r("value2",!0),r("condition")]),AVERAGEIFS:n("该函数返回满足多重条件的所有单元格的平均值。",[r("value1"),r("condition1"),r("value2",!0),r("condition2...")]),BESSELI:n("该函数返回修正Bessel函数值，它与用纯虚数参数运算时的Bessel函数值相等。",[r("value"),r("order")]),BESSELJ:n("该函数返回Bessel函数值。",[r("value"),r("order")]),BESSELK:n("该函数返回修正Bessel函数值，它与用纯虚数参数运算时的Bessel函数值相等。",[r("value"),r("order")]),BESSELY:n("该函数返回Bessel函数值，该函数也称作诺伊曼函数。",[r("value"),r("order")]),BETADIST:n("该函数返回累积beta分布的概率密度函数。",[r("x"),r("alpha"),r("beta"),r("lower"),r("upper")]),BETAINV:n("该函数返回指定beta分布累积beta分布的概率密度函数的反函数值。",[r("prob"),r("alpha"),r("beta"),r("lower"),r("upper")]),BIN2DEC:n("该函数将二进制数转换为十进制数。",[r("number")]),BIN2HEX:n("该函数将二进制数转换为十六进制数。",[r("number"),r("places")]),BIN2OCT:n("该函数将二进制数转换为八进制数。",[r("number"),r("places")]),BINOMDIST:n("该函数返回一元二项式分布的概率值。",[r("x"),r("n"),r("p"),r("cumulative")]),CEILING:n("该函数将参数向上舍入。",[r("value"),r("signif")]),CHAR:n("该函数返回对应数字代码的字符。",[r("value")]),CHIDIST:n("该函数返回 χ2 分布的单尾概率。",[r("value"),r("deg")]),CHIINV:n("该函数返回 χ2 分布单尾概率的反函数值。",[r("prob"),r("deg")]),CHITEST:n("该函数返回独立性检测值。",[r("obs_array"),r("exp_array")]),CHOOSE:n("该函数返回从值得列表中选择值。",[r("index"),r("value1"),r("value2",!0)]),CLEAN:n("该函数删除文本中所有非打印字符。",[r("text")]),CODE:n("该函数返回文本字符串中第一个字符的数字代码。返回的代码对应于计算机当前使用的字符串。",[r("text")]),COLUMN:n("该函数返回引用的列号。",[r("reference")]),COLUMNS:n("该函数返回引用中包含的列数。",[r("array")]),COMBIN:n("该函数计算从给定数目的对象集合中提取若干对象的组合数。",[r("k"),r("n")]),COMPLEX:n("该函数将实系数和虚系数转换为复数。",[r("realcoeff"),r("imagcoeff"),r("suffix")]),CONCATENATE:n("该函数将两个或多个文本字符串合并为一个文本字符串。",[r("text1"),r("text2"),r("....")]),CONFIDENCE:n("该函数返回总体平均值的置信区间。",[r("alpha"),r("stdev"),r("size")]),CONVERT:n("该函数将数字从一种度量系统转换为另一种度量系统。",[r("number"),r("from-unit"),r("to-unit")]),CORREL:n("该函数返回两个数据集之间的相关系数。",[r("array1"),r("array2")]),COS:n("该函数返回数字的余弦值。",[r("angle")]),COSH:n("该函数返回数字的双曲余弦值。",[r("value")]),COUNT:n("该函数计算参数列表中数字的个数。",[r("value1"),r("value2",!0)]),COUNTA:n("该函数计算区域中不为空的单元格的个数。",[r("value1"),r("value2",!0)]),COUNTBLANK:n("该函数计算指定单元格区域中空白单元格的个数。",[r("cellrange")]),COUNTIF:n("该函数计算区域内符合给定条件的单元格的数量。",[r("cellrange"),r("condition")]),COUNTIFS:n("该函数计算区域内符合多个条件的单元格的数量。",[r("cellrange"),r("condition")]),COUPDAYBS:n("该函数返回从付息期开始到成交日之间的天数。",[r("settlement"),r("maturity"),r("frequency"),r("basis")]),COUPDAYS:n("该函数返回包含成交日的付息天数。",[r("settlement"),r("maturity"),r("frequency"),r("basis")]),COUPDAYSNC:n("该函数返回从结算日到下一付息日之间的天数。",[r("settlement"),r("maturity"),r("frequency"),r("basis")]),COUPNCD:n("该函数返回一个表示在结算日之后下一个付息日的数字。",[r("settlement"),r("maturity"),r("frequency"),r("basi")]),COUPNUM:n("该函数返回在结算日和到期日之间付息次数，向上舍入到最近的整数。",[r("settlement"),r("maturity"),r("frequency"),r("basis")]),COUPPCD:n("该函数返回表示结算日之前的付息日的数字。",[r("settlement"),r("maturity"),r("frequency"),r("basis")]),COVAR:n("该函数返回协方差，即两个数据集中每对数据点的偏差乘积的平均值。",[r("array1"),r("array2")]),CRITBINOM:n("该函数返回累积二项式分布大于等于临界值的最小值。",[r("n"),r("p"),r("alpha")]),CUMIPMT:n("该函数返回两个付款期之间累积支付的利息。",[r("rate"),r("nper"),r("pval"),r("startperiod"),r("endperiod"),r("paytype")]),CUMPRINC:n("该函数返回两个付款期之间为贷款累积支付的本金。",[r("rate"),r("nper"),r("pval"),r("startperiod"),r("endperiod"),r("paytype")]),DATE:n("该函数返回DateTime对象，代表了一个独有的日期，通过定制年，月和日。",[r("year"),r("month"),r("day")]),DATEDIF:n("该函数返回两个日期间的天，月和年的数目。",[r("date1"),r("date2"),r("outputcode")]),DATEVALUE:n("该函数将文本格式的日期转换为日期对象。",[r("date_string")]),DAVERAGE:n("该函数返回列表或数据库中满足指定条件的记录字段（列）中的数值的平均值。",[r("database"),r(" field"),r(" criteria")]),DAY:n("该函数将序列号转换为月份日期。",[r("date")]),DAYS360:n("该函数以一年360天为基准计算两个日期间的天数。",[r("startdate"),r("enddate"),r("method")]),DB:n("该函数使用固定余额递减法，返回一笔资产在给定期间内的折旧值。",[r("cost"),r("salvage"),r("life"),r("period"),r("month")]),DCOUNT:n("该函数计算数据库中包含数字的单元格的数量。",[r("database"),r(" field"),r(" criteria")]),DCOUNTA:n("该函数计算数据库中非空单元格的数量。",[r("database"),r(" field"),r(" criteria")]),DDB:n("该函数使用双倍余额递减法或其他指定方法，返回一笔资产在给定期间内的折旧值。",[r("cost"),r("salvage"),r("life"),r("period"),r("factor")]),DEC2BIN:n("该函数将十进制数转换为二进制数。",[r("number"),r("places")]),DEC2HEX:n("该函数将十进制数转换为十六进制数。",[r("number"),r("places")]),DEC2OCT:n("该函数将十进制数转换为八进制数。",[r("number"),r("places")]),DEGREES:n("该函数将弧度转换为度。",[r("angle")]),DELTA:n("该函数测试两个数值是否相等。如果number1= number2，则返回1，否则返回0。",[r("value1"),r("value2")]),DEVSQ:n("该函数返回数据点与各自样本平均值偏差的平方和。",[r("value1"),r("value2",!0)]),DGET:n("该函数从列表或数据库的列中提取符合指定条件的单个值。",[r("database"),r(" field"),r(" criteria")]),DISC:n("该函数返回有价证券的贴现率。",[r("settle"),r("mature"),r("pricep"),r("redeem"),r("basis")]),DMAX:n("该函数返回列表或数据库中满足指定条件的记录字段（列）中的最大数字。",[r("database"),r(" field"),r(" criteria")]),DMIN:n("该函数返回列表或数据库中满足指定条件的记录字段（列）中的最小数字。",[r("database"),r(" field"),r(" criteria")]),DOLLAR:n("该函数依照货币格式将小数四舍五入到指定的位数并转换成文本。",[r("value"),r("digits")]),DOLLARDE:n("该函数将按分数表示的价格转换为按小数表示的价格。",[r("fractionaldollar"),r("fraction")]),DOLLARFR:n("该函数将以小数表示的价格转换为以分数表示的价格。",[r("decimaldollar"),r("fraction")]),DPRODUCT:n("该函数将数据库中符合条件的记录的特定字段中的值相乘。",[r("database"),r(" field"),r(" criteria")]),DSTDEV:n("该函数返回利用列表或数据库中满足指定条件的记录字段（列）中的数字作为一个样本估算出的样本总体标准偏差。",[r("database"),r(" field"),r(" criteria")]),DSTDEVP:n("该函数返回利用列表或数据库中满足指定条件的记录字段（列）中的数字作为样本总体计算出的总体标准偏差。",[r("database"),r(" field"),r(" criteria")]),DSUM:n("该函数返回列表或数据库中满足指定条件的记录字段（列）中的数字之和。",[r("database"),r(" field"),r(" criteria")]),DURATION:n("该函数返回假设面值 ￥100 的定期付息有价证券的修正期限。",[r("settlement"),r("maturity"),r("coupon"),r("yield"),r("frequency"),r("basis")]),DVAR:n("该函数返回利用列表或数据库中满足指定条件的记录字段（列）中的数字作为一个样本估算出的样本总体方差。",[r("database"),r(" field"),r(" criteria")]),DVARP:n("该函数返回利用列表或数据库中满足指定条件的记录字段（列）中的数字作为样本总体计算出的样本总体方差。",[r("database"),r(" field"),r(" criteria")]),EDATE:n("该函数返回用于表示开始日期之前或之后月数的日期的序列号。",[r("startdate"),r("months")]),EFFECT:n("该函数利用给定的名义年利率和每年的复利期数，计算有效的年利率。",[r("nomrate"),r("comper")]),EOMONTH:n("该函数返回指定月数之前或之后的月份的最后一天的序列号。",[r("startdate"),r("months")]),ERF:n("该函数返回误差函数在上下限之间的积分。",[r("limit"),r("upperlimit")]),ERFC:n("该函数返回从 x 到 ∞（无穷）积分的 ERF 函数的补余误差函数。",[r("lowerlimit")]),"ERROR.TYPE":n("该函数返回对应于错误类型的数字。",[r("errorvalue")]),EURO:n("该函数将数字转换为欧元形式，将数字由欧元形式转换为欧盟成员国货币形式，或利用欧元作为中间货币将数字由某一欧盟成员国货币转化为另一欧盟成员国货币的形式（三角转换关系）。",[r("code")]),EUROCONVERT:n("该函数将数字转换为欧元形式，将数字由欧元形式转换为欧盟成员国货币形式，或利用欧元作为中间货币将数字由某一欧盟成员国货币转化为另一欧盟成员国货币的形式（三角转换关系）。只有采用了欧元的欧盟 (EU) 成员国货币才能进行这些转换。此函数所使用的是由欧盟 (EU) 建立的固定转换汇率。",[r("currency"),r("source"),r("target"),r("fullprecision"),r("triangulation")]),EVEN:n("该函数返回沿绝对值增大方向取整后最接近的偶数。",[r("value")]),EXACT:n("该函数用于比较两个字符串：如果它们完全相同，则返回 TRUE；否则，返回 FALSE。",[r("text1"),r("text2")]),EXP:n("该函数返回 e 的 n 次方。",[r("value")]),EXPONDIST:n("该函数返回指数分布。",[r("value"),r("lambda"),r("cumulative")]),FACT:n("该函数返回数字的阶乘。",[r("number")]),FACTDOUBLE:n("该函数返回数字的双倍阶乘。",[r("number")]),FALSE:n("该函数返回逻辑值 FALSE。",[]),FDIST:n("该函数返回 F 概率分布。使用此函数可以确定两个数据集是否存在变化程度上的不同。",[r("value"),r("degnum"),r("degden")]),FIND:n("该函数在一个文本值中查找另一个文本值（区分大小写）。",[r("findtext"),r("intext"),r("start")]),FINV:n("该函数返回 F 概率分布的反函数值。",[r("p"),r("degnum"),r("degden")]),FISHER:n("该函数返回 Fisher 变换值。",[r("value")]),FISHERINV:n("该函数返回 Fisher 变换的反函数值。",[r("value")]),FIXED:n("该函数将数字按指定的小数位数进行取整，利用句号和逗号，以小数格式对该数进行格式设置，并以文本形式返回结果。",[r("num"),r("digits"),r("notcomma")]),FLOOR:n("该函数向绝对值减小的方向舍入数字。",[r("value"),r("signif")]),FORECAST:n("该函数根据已有的数值计算或预测未来值。",[r("value"),r("Yarray"),r("Xarray")]),FREQUENCY:n("该函数计算数值在某个区域内的出现频率，然后返回一个垂直数组。",[r("dataarray"),r("binarray")]),FTEST:n("该函数返回 F 检验的结果。F 检验返回的是当数组 1 和数组 2 的方差无明显差异时的单尾概率。",[r("array1"),r("array2")]),FV:n("该函数基于固定利率及等额分期付款方式，返回某项投资的未来值。",[r("rate"),r("numper"),r("paymt"),r("pval"),r("type")]),FVSCHEDULE:n("该函数基于一系列复利返回本金的未来值。函数 FVSCHEDULE 用于计算某项投资在变动或可调利率下的未来值。",[r("principal"),r("schedule")]),GAMMADIST:n("该函数返回 γ 分布。",[r("x"),r("alpha"),r("beta"),r("cumulative")]),GAMMAINV:n("该函数返回 γ 累积分布函数的反函数。",[r("p"),r("alpha"),r("beta")]),GAMMALN:n("该函数返回 γ 函数的自然对数，Γ(x)。",[r("value")]),GCD:n("该函数返回最大公约数。",[r("number1"),r("number2")]),GEOMEAN:n("该函数返回正数数组或区域的几何平均值。",[r("value1"),r("value2",!0)]),GESTEP:n("该函数检验数字是否大于阈值。",[r("number"),r("step")]),GROWTH:n("该函数根据现有的数据预测指数增长值。根据现有的 x 值和 y 值，GROWTH 函数返回一组新的 x 值对应的 y 值。",[r("y"),r("x"),r("newx"),r("constant")]),HARMEAN:n("该函数返回调和平均值。",[r("value1"),r("value2",!0)]),HEX2BIN:n("该函数将十六进制数转换为二进制数。",[r("number"),r(" places")]),HEX2DEC:n("该函数将十六进制数转换为十进制数。",[r("number")]),HEX2OCT:n("该函数将十六进制数转换为八进制数。",[r("number"),r(" places")]),HLOOKUP:n("该函数查找数组的首行，并返回指定单元格的值。",[r("value"),r("array"),r("row"),r("approx")]),HOUR:n("返回时间值的小时数。",[r("time")]),HYPGEOMDIST:n("该函数返回超几何分布。 ",[r("x"),r("n"),r("M"),r("N")]),IF:n("使用逻辑函数 IF 函数时，如果条件为真，该函数将返回一个值；如果条件为假，函数将返回另一个值。",[r("valueTest"),r("valueTrue"),r("valueFalse")]),IFERROR:n("该函数如果公式的计算结果错误，则返回您指定的值；否则返回公式的结果。",[r("value"),r("error")]),IMABS:n("该函数返回复数的绝对值（模数）。",[r("complexnum")]),IMAGINARY:n("该函数返回复数的虚系数。",[r("complexnum")]),IMARGUMENT:n("该函数返回参数 theta，即以弧度表示的角。",[r("complexnum")]),IMCONJUGATE:n("该函数返回以 x+yi 或 x+yj 文本格式表示的复数的共轭复数。",[r("complexnum")]),IMCOS:n("该函数返回以 x+yi 或 x+yj 文本格式表示的复数的余弦。",[r("complexnum")]),IMDIV:n("该函数返回以 x+yi 或 x+yj 文本格式表示的两个复数的商。",[r("complexnum"),r("complexdenom")]),IMEXP:n("该函数返回以 x+yi 或 x+yj 文本格式表示的复数的指数。",[r("complexnum")]),IMLN:n("该函数返回以 x+yi 或 x+yj 文本格式表示的复数的自然对数。",[r("complexnum")]),IMLOG2:n("该函数返回以 x+yi 或 x+yj 文本格式表示的复数的以 2 为底数的对数。",[r("complexnum")]),IMLOG10:n("该函数返回以 x + yi 或 x + yj 文本格式表示的复数的常用对数（以 10 为底数）。",[r("complexnum")]),IMPOWER:n("该函数返回以 x+yi 或 x+yj 文本格式表示的复数的 n 次幂。",[r("complexnum"),r("powernum")]),IMPRODUCT:n("该函数返回以 x+yi 或 x+yj 文本格式表示的 1 至 29 个复数的乘积。",[r("complexnum1"),r("complexnum2",!0)]),IMREAL:n("该函数返回以 x+yi 或 x+yj 文本格式表示的复数的实系数。",[r("complexnum")]),IMSIN:n("该函数返回以 x+yi 或 x+yj 文本格式表示的复数的正弦值。",[r("complexnum")]),IMSQRT:n("该函数返回以 x+yi 或 x+yj 文本格式表示的复数的平方根。",[r("complexnum")]),IMSUB:n("该函数返回以 x+yi 或 x+yj 文本格式表示的两个复数的差。",[r("complexnum1"),r("complexnum2")]),IMSUM:n("该函数返回以 x+yi 或 x+yj 文本格式表示的两个或多个复数的和。",[r("complexnum1"),r("complexnum2",!0)]),INDEX:n("该函数返回表格或区域中的值或值。",[r("return"),r("row"),r("col"),r("area")]),INDIRECT:n("该函数返回由文本字符串指定的引用。",[r("ref_text"),r("a1_style")]),INT:n("该函数将数字向下舍入到最接近的整数。",[r("value")]),INTERCEPT:n("该函数利用现有的 x 值与 y 值计算并返回直线与 y 轴的截距。",[r("dependent"),r("independent")]),INTRATE:n("该函数计算并返回一次性付息证券的利率。",[r("settle"),r("mature"),r("invest"),r("redeem"),r("basis")]),IPMT:n("此函数基于固定利率及等额分期付款方式，返回给定期数内对投资的利息偿还额。",[r("rate"),r("per"),r("nper"),r("pval"),r("fval"),r("type")]),IRR:n("该函数返回由数值代表的一组现金流的内部收益率。",[r("arrayvals"),r("estimate")]),ISBLANK:n("该函数检验指定的值，表达式或者引用单元格的内容是否为空。",[r("cellreference")]),ISERR:n("该函数检验一个值，表达式或者引用单元格的内容是否为除去 #N/A 的任意错误值。",[r("cellreference")]),ISERROR:n("此函数检验一个值，表达式或者引用单元格的内容是否为任意错误值。",[r("cellreference")]),ISEVEN:n("此函数检验一个值，表达式或者引用单元格的内容是否为偶数。",[r("cellreference")]),ISLOGICAL:n("此函数检验一个值，表达式或者引用单元格的内容是否是一个逻辑值（布尔型值）。",[r("cellreference")]),ISNA:n("此函数检验一个值，表达式或者引用单元格的内容包含值不存在（#N/A）错误值。",[r("cellreference")]),ISNONTEXT:n("此函数检验一个值，表达式或者引用单元格的内容是否为不是文本的任意数据类型。",[r("cellreference")]),ISNUMBER:n("此函数检验一个值，表达式或者引用单元格的内容是否是数值。",[r("cellreference")]),ISODD:n("此函数检验一个值，表达式或者引用单元格的内容是否为奇数。",[r("cellreference")]),ISPMT:n("此函数计算特定投资期内要支付的利息。",[r("rate"),r("per"),r("nper"),r("pv")]),ISREF:n("此函数检验一个值，表达式或者引用单元格的内容是到另外单元格的引用。",[r("cellreference")]),ISTEXT:n("此函数检验一个值，表达式或者引用单元格的内容是否是文本型数据。",[r("cellreference")]),KURT:n("此函数返回数据集的峰值。",[r("value1"),r("value2"),r("value3"),r("value4",!0)]),LARGE:n("此函数返回数据集中第 n 个最大值。",[r("array"),r("n")]),LCM:n("此函数返回整数的最小公倍数。",[r("number1"),r("number2")]),LEFT:n("此函数返回文本字符串中第一个字符或前几个字符。",[r("mytext"),r("num_chars")]),LEN:n("此函数返回文本字符串中的字符数。",[r("value")]),LINEST:n("此函数计算与现有数据最佳拟合的直线，来计算某直线的统计值，然后返回描述此直线的数组。",[r("y"),r("x"),r("constant"),r("stats")]),LN:n("此函数返回指定数字的自然对数。",[r("value")]),LOG:n("此函数按所指定的底数，返回一个数的对数。",[r("number"),r("base")]),LOG10:n("此函数返回以 10 为底的对数。",[r("value")]),LOGEST:n("此函数在回归分析中，计算最符合数据的指数回归拟合曲线，并返回描述该曲线的数值数组。",[r("y"),r("x"),r("constant"),r("stats")]),LOGINV:n("此函数返回 x 的对数累积分布函数的反函数，此处的 LN(x) 是含有 mean 与 stdev 参数的正态分布。",[r("prob"),r("mean"),r("stdev")]),LOGNORMDIST:n("此函数返回 x 的对数累积分布函数，其中 ln(x) 是服从参数 mean 和 stdev 的正态分布。使用此函数可以分析经过对数变换的数据。",[r("x"),r("mean"),r("stdev")]),LOOKUP:n("此函数可从单行或单列区域或者从一个数组返回值。LOOKUP 函数具有两种语法形式：向量形式和数组形式。",[r("lookupvalue"),r("lookupvector"),r("resultvector")]),LOWER:n("此函数将一个文本字符串中的所有大写字母转换为小写字母。",[r("string")]),MATCH:n("此函数返回指定值在单元格区域中的相对位置。",[r("value1"),r("array"),r("type")]),MAX:n("此函数返回一组值中的最大值。",[r("value1"),r("value2",!0)]),MAXA:n("此函数返回参数列表中的最大值。",[r("value1"),r("value2",!0)]),MDETERM:n("此函数返回一个数组的矩阵行列式的值。",[r("array")]),MDURATION:n("此函数返回假设面值 ￥100 的有价证券的 Macauley 修正期限。",[r("settlement"),r("maturity"),r("coupon"),r("yield"),r("frequency"),r("basis")]),MEDIAN:n("此函数返回给定数值的中值。中值是在一组数值中居于中间的数值。",[r("value1"),r("value2",!0)]),MID:n("此函数返回文本字符串中从指定位置开始的特定数目的字符，该数目由用户指定。",[r("text"),r("start_num"),r("num_chars")]),MIN:n("此函数返回一组值中的最小值。",[r("value1"),r("value2",!0)]),MINA:n("此函数返回一组包含文本和逻辑值的值中的最小值。",[r("value1"),r("value2",!0)]),MINUTE:n("此函数返回时间值中的分钟。为一个介于 0 到 59 之间的整数。",[r("time")]),MINVERSE:n("此函数返回数组中存储的矩阵的逆距阵。",[r("array")]),MIRR:n("此函数返回某一连续期间内现金流的修正内部收益率。 函数 MIRR 同时考虑了投资的成本和现金再投资的收益率。",[r("arrayvals"),r("payment_int"),r("income_int")]),MMULT:n("此函数返回两个数组的矩阵乘积。",[r("array1"),r("array2")]),MOD:n("此函数返回两数相除的余数。",[r("dividend"),r("divisor")]),MODE:n("此函数返回在某一数组或数据区域中出现频率最多的数值。",[r("value1"),r("value2",!0)]),MONTH:n("此函数返回以序列号表示的日期中的月份。",[r("date")]),MROUND:n("此函数返回参数按指定基数舍入后的数值。",[r("number"),r("multiple")]),MULTINOMIAL:n("此函数返回参数和的阶乘与各参数阶乘乘积的比值。",[r("value1"),r("value2",!0)]),N:n("此函数返回转化为数值后的值。",[r("value")]),NA:n("此函数返回错误值 #N/A。错误值 #N/A 表示“无法得到有效值”。",[]),NEGBINOMDIST:n("此函数返回负二项式分布。",[r("x"),r("r"),r("p")]),NETWORKDAYS:n("此函数返回参数开始日期和结束日期之间完整的工作日数值。 工作日不包括周末和专门指定的假期。",[r("startdate"),r("enddate"),r("holidays")]),NOMINAL:n("此函数基于给定的实际利率和年复利期数，返回名义年利率。",[r("effrate"),r("comper")]),NORMDIST:n("此函数返回指定平均值和标准偏差的正态分布函数。 此函数在统计方面应用范围广泛（包括假设检验）。",[r("x"),r("mean"),r("stdev"),r("cumulative")]),NORMINV:n("此函数返回指定平均值和标准偏差的正态累积分布函数的反函数。",[r("prob"),r("mean"),r("stdev")]),NORMSDIST:n("此函数返回标准正态累积分布函数。",[r("value")]),NORMSINV:n("此函数返回标准正态累积分布函数的反函数。该分布的平均值为 0，标准偏差为 1。",[r("prob")]),NOT:n("此函数对参数值求反。当要确保一个值不等于某一特定值时，可以使用 NOT 函数。",[r("value")]),NOW:n("此函数返回当前的日期和时间。",[]),NPER:n("此函数基于固定利率及等额分期付款方式，返回某项投资的总期数。",[r("rate"),r("paymt"),r("pval"),r("fval"),r("type")]),NPV:n("此函数通过使用贴现率以及一系列未来支出（负值）和收入（正值），返回一项投资的净现值。",[r("discount"),r("value1"),r("value2",!0)]),OCT2BIN:n("此函数将八进制数转换为二进制数。",[r("number"),r("places")]),OCT2DEC:n("此函数将八进制数转换为十进制数。",[r("number")]),OCT2HEX:n("此函数将八进制数转换为十六进制数。",[r("number"),r("places")]),ODD:n("此函数返回对指定数值进行向上舍入后的奇数。",[r("value")]),ODDFPRICE:n("此函数返回首期付息日不固定（长期或短期）的面值 ￥100 的有价证券价格。",[r("settle"),r("maturity"),r("issue"),r("first"),r("rate"),r("yield"),r("redeem"),r("freq"),r("basis")]),ODDFYIELD:n("此函数返回首期付息日不固定的有价证券（长期或短期）的收益率。",[r("settle"),r("maturity"),r("issue"),r("first"),r("rate"),r("price"),r("redeem"),r("freq"),r("basis")]),ODDLPRICE:n("T此函数返回末期付息日不固定的面值 ￥100 的有价证券（长期或短期）的价格。",[r("settle"),r("maturity"),r("last"),r("rate"),r("yield"),r("redeem"),r("freq"),r("basis")]),ODDLYIELD:n("此函数返回末期付息日不固定的有价证券（长期或短期）的收益率。",[r("settle"),r("maturity"),r("last"),r("rate"),r("price"),r("redeem"),r("freq"),r("basis")]),OFFSET:n("此函数以指定的引用为参照系，通过给定偏移量得到新的引用。 返回的引用可以为一个单元格或单元格区域。并可以指定返回的行数或列数。",[r("reference"),r("rows"),r("cols"),r("height"),r("width")]),OR:n("此函数在其参数组中，任何一个参数逻辑值为 TRUE，即返回 TRUE； 任何一个参数的逻辑值为 FALSE，即返回 FALSE。",[r("argument1"),r("argument2...")]),PEARSON:n("此函数返回 Pearson（皮尔生）乘积矩相关系数 r，这是一个范围在 -1.0 到 1.0 之间（包括 -1.0 和 1.0 在内）的无量纲指数，反映了两个数据集合之间的线性相关程度。 ",[r("array_ind"),r("array_dep")]),PERCENTILE:n("此函数 返回区域中数值的第 n 个百分点的值。",[r("array"),r("n")]),PERCENTRANK:n("此函数返回特定数值在一个数据集中的百分比排位。",[r("array"),r("n"),r("sigdig")]),PERMUT:n("此函数返回从给定数目的对象集合中选取的若干对象的排列数。",[r("k"),r("n")]),PI:n("此函数返回 PI 值 3.1415926536。",[]),PMT:n("此函数基于固定利率及等额分期付款方式，返回贷款的每期付款额。",[r("rate"),r("nper"),r("pval"),r("fval"),r("type")]),POISSON:n("此函数返回泊松分布。",[r("nevents"),r("mean"),r("cumulative")]),POWER:n("此函数返回给定数字的乘幂。",[r("number"),r("power")]),PPMT:n("此函数基于固定利率及等额分期付款方式，返回投资在某一给定期间内的本金偿还额。",[r("rate"),r("per"),r("nper"),r("pval"),r("fval"),r("type")]),PRICE:n("此函数返回定期付息的面值 ￥100 的有价证券的价格。",[r("settlement"),r("maturity"),r("rate"),r("yield"),r("redeem"),r("frequency"),r("basis")]),PRICEDISC:n("此函数返回折价发行的面值 ￥100 的有价证券的价格。",[r("settle"),r("mature"),r("discount"),r("redeem"),r("basis")]),PRICEMAT:n("此函数返回到期付息的面值 ￥100 的有价证券的价格。",[r("settle"),r("mature"),r("issue"),r("rate"),r("yield"),r("basis")]),PROB:n("此函数返回区域中的数值落在指定区间内的概率。",[r("array"),r("probs"),r("lower"),r("upper")]),PRODUCT:n("此函数可计算用作参数的所有数字的乘积，然后返回乘积。",[r("value1"),r("value2",!0)]),PROPER:n("此函数将文本字符串的首字母及任何非字母字符之后的首字母转换成大写。",[r("text")]),PV:n("此函数返回投资的现值。现值为一系列未来付款的当前值的累积和。例如，借入方的借入款即为贷出方贷款的现值。",[r("rate"),r("numper"),r("paymt"),r("fval"),r("type")]),QUARTILE:n("此函数返回数据集的四分位数。",[r("array"),r("quart")]),QUOTIENT:n("此函数返回商的整数部分，该函数可用于舍掉商的小数部分。",[r("numerator"),r("denominator")]),RADIANS:n("此函数将角度转换为弧度。",[r("value")]),RAND:n("此函数返回大于等于 0 及小于 1 的均匀分布随机实数。",[]),RANDBETWEEN:n("此函数返回位于指定的两个数之间的一个随机整数。",[r("lower"),r("upper")]),RANK:n("此函数返回一个数字在数字列表中的排位。数字的排位是其大小与列表中其他值的比值（如果列表已排过序，则数字的排位就是它当前的位置）。",[r("number"),r("array"),r("order")]),RATE:n("此函数返回年金的各期利率。",[r("nper"),r("pmt"),r("pval"),r("fval"),r("type"),r("guess")]),RECEIVED:n("此函数返回一次性付息的有价证券到期收回的金额。",[r("settle"),r("mature"),r("invest"),r("discount"),r("basis")]),REPLACE:n("此函数使用其他文本字符串并根据所指定的字符数替换某文本字符串中的部分文本。",[r("old_text"),r("start_char"),r("num_chars"),r("new_text")]),REPT:n("此函数按照给定的次数重复显示文本。",[r("text"),r("number")]),RIGHT:n("此函数根据所指定的字符数返回文本字符串中最后一个或多个字符。",[r("text"),r("num_chars")]),ROMAN:n("此函数将阿拉伯数字转换为其等价的文本形式的罗马数字。",[r("number"),r("style")]),ROUND:n("此函数可将某个数字四舍五入为指定的位数。",[r("value"),r("places")]),ROUNDDOWN:n("此函数靠近零值，向下（绝对值减小的方向）舍入数字。",[r("value"),r("places")]),ROUNDUP:n("此函数远离零值，向上舍入数字。",[r("value"),r("places")]),ROW:n("此函数返回引用的行号。",[r("reference")]),ROWS:n("此函数返回引用或数组的行数。",[r("array")]),RSQ:n("此函数返回根据 y s 和 x s 中数据点计算得出的 Pearson 乘积矩相关系数的平方。",[r("array_dep"),r("array_ind")]),SEARCH:n("此函数在一个文本值中查找另一个文本值并返回第一个文本字符串的起始位置的编号，该编号从第二个文本字符串的第一个字符算起。",[r("string1"),r("string2")]),SECOND:n("此函数返回时间值的秒数。返回的秒数为 0 到 59 之间的整数。",[r("time")]),SERIESSUM:n("此函数返回幂级数之和。",[r("x"),r("n"),r("m"),r("coeff")]),SIGN:n("此函数返回数字的符号。",[r("cellreference")]),SIN:n("此函数返回给定角度的正弦值。",[r("angle")]),SINH:n("此函数返回某一数字的双曲正弦值。",[r("value")]),SKEW:n("此函数返回分布的不对称度。",[r("number1"),r("number2",!0)]),SLN:n("此函数返回某项资产在一个期间中的线性折旧值。",[r("cost"),r("salvage"),r("life")]),SLOPE:n("此函数返回根据 array_dep 和 array_ind 中的数据点拟合的线性回归直线的斜率。",[r("array_dep"),r("array_ind")]),SMALL:n("此函数返回数据集中第 n 个最小值。",[r("array"),r("n")]),SQRT:n("此函数返回正平方根。",[r("value")]),SQRTPI:n("此函数返回某数与 pi 的乘积的平方根。",[r("multiple")]),STANDARDIZE:n("此函数返回以 mean 为平均值，以 stdev 为标准偏差的分布的正态化数值。",[r("x"),r("mean"),r("stdev")]),STDEVA:n("此函数基于样本（包括数字、文本和逻辑值）估算标准偏差。",[r("value1"),r("value2",!0)]),STDEVP:n("此函数基于整个样本总体计算标准偏差。",[r("value1"),r("value2",!0)]),STDEVPA:n("此函数基于总体（包括数字、文本和逻辑值）计算标准偏差。",[r("value1"),r("value2",!0)]),STEYX:n("此函数返回通过线性回归法计算每个 x 的 y 预测值时所产生的标准误差。 标准误差用来度量根据单个 x 变量计算出的 y 预测值的误差量。",[r("array_dep"),r("array_ind")]),SUBSTITUTE:n("此函数在文本字符串中用新文本替换旧文本。",[r("text"),r("old_piece"),r("new_piece"),r("instance")]),SUBTOTAL:n("此函数返回列表或数据库中的分类汇总。",[r("functioncode"),r("value1"),r("value2",!0)]),SUM:n("此函数返回某一单元格区域中所有数字之和。",[r("value1"),r("value2",!0)]),SUMIF:n("此函数按给定条件对指定单元格求和。",[r("array"),r("condition"),r("sumrange")]),SUMIFS:n("此函数对区域中满足多个条件的单元格求和。",[r("array"),r("conditionarray"),r("condition",!0)]),SUMPRODUCT:n("此函数在给定的几组数组中，将数组间对应的元素相乘，并返回乘积之和。",[r("array1"),r("array2",!0)]),SUMSQ:n("此函数返回参数的平方和。",[r("value1"),r("value2",!0)]),SUMX2MY2:n("此函数返回两数组中对应数值的平方差之和。",[r("array_x"),r("array_y")]),SUMX2PY2:n("此函数返回两数组中对应数值的平方和之和。",[r("array_x"),r("array_y")]),SUMXMY2:n("此函数返回两数组中对应数值之差的平方和。",[r("array_x"),r("array_y")]),SYD:n("此函数返回某项资产按年限总和折旧法计算的指定期间的折旧值。",[r("cost"),r("salvage"),r("life"),r("period")]),T:n("此函数返回指定单元格的文本。",[r("value")]),TAN:n("此函数返回给定角度的正切值。",[r("angle")]),TANH:n("此函数返回某一数字的双曲正切。",[r("value")]),TBILLEQ:n("此函数返回国库券的等效收益率。",[r("settle"),r("mature"),r("discount")]),TBILLPRICE:n("此函数返回面值 ￥100 的国库券的价格。",[r("settle"),r("mature"),r("discount")]),TBILLYIELD:n("此函数返回国库券的收益率。",[r("settle"),r("mature"),r("priceper")]),TDIST:n("此函数返回 t 分布的百分点（概率）。",[r("x"),r("deg"),r("tails")]),TEXT:n("此函数格式化一个数值并将其转换成文本。",[r("value"),r("text")]),TIME:n("此函数返回指定时间的时间间隔对象。",[r("hour"),r("minutes"),r("seconds")]),TIMEVALUE:n("此函数返回由文本字符串所代表的时间的时间间隔对象值。",[r("time_string")]),TINV:n("此函数返回作为概率和自由度函数的学生 t 分布的 t 值。",[r("prog"),r("deg")]),TODAY:n("此函数返回当前的日期和时间。",[]),TRANSPOSE:n("此函数 TRANSPOSE 函数可返回转置单元格区域，即将行单元格区域转置成列单元格区域，反之亦然。",[r("array")]),TREND:n("此函数返回一条线性回归拟合线的值。 即找到适合已知数组 y s 和 x s 的直线（用最小二乘法）， 并返回指定数组 newx s 在直线上对应的 y 值。",[r("y"),r("x"),r("newx"),r("constant")]),TRIM:n("此函数除了单词之间的单个空格外，清除文本中所有的空格。",[r("text")]),TRIMMEAN:n("此函数返回数据集的内部平均值。函数 TRIMMEAN 先从数据集的头部和尾部除去一定百分比的数据点，然后再求平均值。",[r("array"),r("percent")]),TRUE:n("此函数返回逻辑值 TRUE。",[]),TRUNC:n("此函数将指定数字的小数部分截去，返回整数。",[r("value"),r("precision")]),TTEST:n("此函数返回与学生 t 检验相关的概率。",[r("array1"),r("array2"),r("tails"),r("type")]),TYPE:n("此函数返回数值的类型。",[r("value")]),UPPER:n("此函数将文本转换为大写形式。",[r("string")]),VALUE:n("此函数将代表数字的文本字符串转换成数字。",[r("text")]),VAR:n("此函数计算基于给定样本的方差。",[r("value1"),r("value2",!0)]),VARA:n("此函数基于样本（包括数字、文本和逻辑值）估算方差。",[r("value1"),r("value2",!0)]),VARP:n("此函数计算基于整个样本总体的方差。",[r("value1"),r("value2",!0)]),VARPA:n("此函数计算基于总体（包括数字、文本和逻辑值）估算方差",[r("value1"),r("value2",!0)]),VDB:n("此函数使用双倍余额递减法或其他指定的方法，返回指定的任何期间内（包括部分期间）的资产折旧值。函数 VDB 代表可变余额递减法。",[r("cost"),r("salvage"),r("life"),r("start"),r("end"),r("factor"),r("switchnot")]),VLOOKUP:n("此函数在表格数组的首列查找指定的值，并由此返回表格数组当前行中其他列的值。",[r("value"),r("array"),r("colindex"),r("approx")]),WEEKDAY:n("此函数返回某日期为星期几。默认情况下，其值为 1（星期天）到 7（星期六）之间的整数。",[r("date"),r("type")]),WEEKNUM:n("此函数返回一个数字，该数字代表一年中的第几周。",[r("date"),r("weektype")]),WEIBULL:n("此函数返回韦伯分布。使用此函数可以进行可靠性分析，比如计算设备的平均故障时间。",[r("x"),r("alpha"),r("beta"),r("cumulative")]),WORKDAY:n("此函数返回某日期（起始日期）之前或之后相隔指定工作日的某一日期的日期值。",[r("startdate"),r("numdays"),r("holidays")]),XIRR:n("此函数返回一组现金流的内部收益率，这些现金流不一定定期发生。",[r("values"),r("dates"),r("guess")]),XNPV:n("此函数返回一组现金流的净现值，这些现金流不一定定期发生。",[r("rate"),r("values"),r("dates")]),YEAR:n("此函数返回某日期对应的年份。",[r("date")]),YEARFRAC:n("此函数 返回 start 和 end 之间的天数占全年天数的百分比。",[r("startdate"),r("enddate"),r("basis")]),YIELD:n("此函数返回定期付息有价证券的收益率，函数 YIELD 用于计算债券收益率。",[r("settle"),r("maturity"),r("rate"),r("price"),r("redeem"),r("frequency"),r("basis")]),YIELDDISC:n("此函数返回折价发行的有价证券的年收益率。",[r("settle"),r("maturity"),r("price"),r("redeem"),r("basis")]),YIELDMAT:n("此函数返回到期付息的有价证券的年收益率。",[r("settle"),r("maturity"),r("issue"),r("issrate"),r("price"),r("basis")]),ZTEST:n("此函数返回 z 检验的单尾概率值。对于给定的假设总体平均值 μ0，ZTEST 返回样本平均值大于数据集（数组）中观察平均值的概率，即观察样本平均值。",[r("array"),r("x"),r("sigma")]),HBARSPARKLINE:n("此函数返回用于一个用于描绘横向条状迷你图的数据集。",[r("value"),r("colorScheme")]),VBARSPARKLINE:n("此函数返回用于一个用于描绘竖向柱状型迷你图的数据集。",[r("value"),r("colorScheme")]),VARISPARKLINE:n("此函数返回用于一个用于描绘方差迷你图的数据集。",[r("variance"),r("reference"),r("mini"),r("maxi"),r("mark"),r("tickunit"),r("legend"),r("colorPositive"),r("colorNegative"),r("vertical")]),PIESPARKLINE:n("此函数返回用于一个用于描绘饼形迷你图的数据集。",[r("range|percentage"),r("color",!0)]),AREASPARKLINE:n("此函数返回用于一个用于描绘面积迷你图的数据集。",[r("points"),r("mini"),r("maxi"),r("line1"),r("line2"),r("colorPositive"),r("colorNegative")]),SCATTERSPARKLINE:n("此函数返回用于一个用于描绘散点迷你图的数据集。",[r("points1"),r("points2"),r("minX"),r("maxX"),r("minY"),r("maxY"),r("hLine"),r("vLine"),r("xMinZone"),r("xMaxZone"),r("yMinZone"),r("yMaxZone"),r("tags"),r("drawSymbol"),r("drawLines"),r("color1"),r("color2"),r("dash")]),LINESPARKLINE:n("此函数返回用于一个用于描绘折线迷你图的数据集。",[r("data"),r("dataOrientation"),r("dateAxisData"),r("dateAxisOrientation"),r("setting")]),COLUMNSPARKLINE:n("此函数返回用于一个用于描绘柱形迷你图的数据集。",[r("data"),r("dataOrientation"),r("dateAxisData"),r("dateAxisOrientation"),r("setting")]),WINLOSSSPARKLINE:n("此函数返回用于一个用于描绘盈亏迷你图的数据集。",[r("data"),r("dataOrientation"),r("dateAxisData"),r("dateAxisOrientation"),r("setting")]),BULLETSPARKLINE:n("此函数返回用于一个用于描绘子弹迷你图的数据集。",[r("measure"),r("target"),r("maxi"),r("good"),r("bad"),r("forecast"),r("tickunit"),r("colorScheme"),r("vertical")]),SPREADSPARKLINE:n("此函数返回用于一个用于描绘散布迷你图的数据集。",[r("points"),r("showAverage"),r("scaleStart"),r("scaleEnd"),r("style"),r("colorScheme"),r("vertical")]),STACKEDSPARKLINE:n("此函数返回用于一个用于描绘堆积迷你图的数据集。",[r("points"),r("colorRange"),r("labelRange"),r("maximum"),r("targetRed"),r("targetGreen"),r("targetBlue"),r("tragetYellow"),r("color"),r("highlightPosition"),r("vertical"),r("textOrientation"),r("textSize")]),BOXPLOTSPARKLINE:n("此函数返回用于一个用于描绘箱线迷你图的数据集。",[r("points"),r("boxPlotClass"),r("showAverage"),r("scaleStart"),r("scaleEnd"),r("acceptableStart"),r("acceptableEnd"),r("colorScheme"),r("style"),r("vertical")]),CASCADESPARKLINE:n("此函数返回用于一个用于描绘瀑布迷你图的数据集。",[r("pointsRange"),r("pointIndex"),r("labelsRange"),r("minimum"),r("maximum"),r("colorPositive"),r("colorNegative"),r("vertical")]),PARETOSPARKLINE:n("此函数返回用于一个用于描绘阶梯瀑布迷你图的数据集。",[r("points"),r("pointIndex"),r("colorRange"),r("target"),r("target2"),r("highlightPosition"),r("label"),r("vertical")]),MONTHSPARKLINE:n("此函数返回用于一个用于描绘月份迷你图的数据集。",[r("year"),r("month"),r("dataRange"),r("emptyColor"),r("startColor"),r("middleColor"),r("endColor")]),YEARSPARKLINE:n("此函数返回用于一个用于描绘年份迷你图的数据集。",[r("year"),r("dataRange"),r("emptyColor"),r("startColor"),r("middleColor"),r("endColor")]),"CEILING.PRECISE":n("此函数返回一个数字，该数字向上舍入为最接近的整数或最接近的有效位的倍数。",[r("number"),r("signif")]),"COVARIANCE.S":n("此函数返回样本协方差，即两个数据集中每对数据点的偏差乘积的平均值。",[r("array1"),r("array2")]),"FLOOR.PRECISE":n("此函数向绝对值减小的方向舍入数字。",[r("number"),r("signif")]),"PERCENTILE.EXC":n("此函数返回区域中数值的第 n 个百分点的值。",[r("array"),r("n")]),"QUARTILE.EXC":n("此函数返回数据集的四分位数。",[r("array"),r("quart")]),"RANK.AVG":n("此函数返回一个数字在数字列表中的排位。数字的排位是其大小与列表中其他值的比值（如果列表已排过序，则数字的排位就是它当前的位置）。",[r("number"),r("array"),r("order")]),"MODE.MULT":n("此函数返回一组数据或数据区域中出现频率最高或重复出现的数值的垂直数组。",[r("number1"),r("number2",!0)]),"STDEV.P":n("此函数估算基于样本的标准偏差。",[r("value1"),r("value2",!0)]),"VAR.P":n("此函数计算基于给定样本的方差。",[r("value1"),r("value2",!0)]),"COVARIANCE.P":n("此函数返回协方差（成对偏差乘积的平均值）。",[r("array1"),r("array2")]),"MODE.SNGL":n("此函数返回在某一数组或数据区域中出现频率最多的数值。",[r("value1"),r("value2",!0)]),"PERCENTILE.INC":n("此函数返回区域中数值的第 n 个百分点的值。",[r("array"),r("n")]),"QUARTILE.INC":n("此函数返回数据集的四分位数。",[r("array"),r("quart")]),"RANK.EQ":n("此函数返回一个数字在数字列表中的排位。数字的排位是其大小与列表中其他值的比值（如果列表已排过序，则数字的排位就是它当前的位置）。",[r("number"),r("array"),r("order")]),STDEV:n("此函数估算基于样本的标准偏差。",[r("number1"),r("number2",!0)]),"STDEV.S":n("此函数估算基于样本的标准偏差。",[r("number1"),r("number2",!0)]),"VAR.S":n("此函数计算基于给定样本的方差。",[r("value1"),r("value2",!0)]),"BETA.INV":n("此函数返回指定 Beta 分布的累积分布函数的反函数。",[r("prob"),r("alpha"),r("beta"),r("lower"),r("upper")]),"BINOM.DIST":n("此函数返回二项式分布的概率值。",[r("x"),r("n"),r("p"),r("cumulative")]),"BINOM.INV":n("此函数返回使累积二项式分布小于或等于临界值的最小值。",[r("n"),r("p"),r("alpha")]),"CHISQ.DIST.RT":n("此函数返回 χ2 分布的单尾概率。",[r("value"),r("deg")]),"CHISQ.INV.RT":n("此函数返回 χ2 分布的单尾概率的反函数。",[r("prob"),r("deg")]),"CHISQ.TEST":n("此函数返回独立性检验值。",[r("obs_array"),r("exp_array")]),"CONFIDENCE.NORM":n("此函数返回总体平均值的置信区间。",[r("alpha"),r("stdev"),r("size")]),"EXPON.DIST":n("此函数返回指数分布。",[r("value"),r("lambda"),r("cumulative")]),"F.DIST.RT":n("此函数返回 F 概率分布。",[r("value"),r("degnum"),r("degden")]),"F.INV.RT":n("此函数返回 F 概率分布的反函数。",[r("p"),r("degnum"),r("degden")]),"F.TEST":n("此函数返回 F 检验的结果。",[r("array1"),r("array2")]),"GAMMA.DIST":n("此函数返回 γ 分布。",[r("x"),r("alpha"),r("beta"),r("cumulative")]),"GAMMA.INV":n("此函数返回 γ 累积分布函数的反函数。",[r("p"),r("alpha"),r("beta")]),"LOGNORM.INV":n("此函数返回对数累积分布的反函数。",[r("prob"),r("mean"),r("stdev")]),"NORM.DIST":n("此函数返回正态累积分布。",[r("x"),r("mean"),r("stdev"),r("cumulative")]),"NORM.INV":n("此函数返回标准正态累积分布的反函数。",[r("prob"),r("mean"),r("stdev")]),"NORM.S.INV":n("此函数返回标准正态累积分布函数的反函数。",[r("prob")]),"PERCENTRANK.INC":n("此函数返回数据集中值的百分比排位。",[r("array"),r("n"),r("signif")]),"POISSON.DIST":n("此函数返回泊松分布。",[r("nevents"),r("mean"),r("cumulative")]),"T.INV.2T":n("此函数返回学生的 t 分布的反函数。",[r("prog"),r("deg")]),"T.TEST":n("此函数返回与学生的 t 检验相关的概率。",[r("array1"),r("array2"),r("tails"),r("type")]),"WEIBULL.DIST":n("此函数返回 Weibull 分布。",[r("x"),r("alpha"),r("beta"),r("cumulative")]),"Z.TEST":n("此函数返回 z 检验的单尾概率值。",[r("array"),r("x"),r("sigma")]),"T.DIST.RT":n("此函数返回学生的 t 分布。",[r("x"),r("deg")]),"T.DIST.2T":n("此函数返回学生的 t 分布的百分点（概率）。",[r("x"),r("deg")]),"ISO.CEILING":n("此函数将数字向上舍入到最接近的整数或基数的最接近倍数。",[r("number"),r("signif")]),"BETA.DIST":n("此函数返回 Beta 累积分布函数。",[r("x"),r("alpha"),r("beta"),r("cumulative"),r("lower"),r("upper")]),"GAMMALN.PRECISE":n("此函数返回伽玛函数的自然对数，Γ(x)。",[r("value")]),"ERF.PRECISE":n("此函数返回误差函数。",[r("lowerlimit")]),"ERFC.PRECISE":n("此函数返回从 x 到无穷大积分的互补 ERF 函数。",[r("lowerlimit")]),"PERCENTRANK.EXC":n("此函数返回某个数值在一个数据集中的百分比（0 到 1，不包括 0 和 1）排位。",[r("array"),r("n"),r("signif")]),"HYPGEOM.DIST":n("此函数返回超几何分布。",[r("x"),r("n"),r("M"),r("N"),r("cumulative")]),"LOGNORM.DIST":n("此函数返回对数累积分布函数。",[r("x"),r("mean"),r("stdev"),r("cumulative")]),"NEGBINOM.DIST":n("此函数返回负二项式分布。",[r("x"),r("r"),r("p"),r("cumulative")]),"NORM.S.DIST":n("此函数返回标准正态累积分布。",[r("z"),r("cumulative")]),"T.DIST":n("此函数返回学生的 t 分布的百分点（概率）。",[r("x"),r("deg"),r("cumulative")]),"F.DIST":n("此函数返回 F 概率分布。",[r("x"),r("degnum"),r("degden"),r("cumulative")]),"CHISQ.DIST":n("此函数返回累积 Beta 概率密度函数。",[r("x"),r("deg"),r("cumulative")]),"F.INV":n("此函数返回 F 概率分布的反函数。",[r("probability"),r("degnum"),r("degden")]),"T.INV":n("此函数返回作为概率和自由度函数的学生 t 分布的 t 值。",[r("probability"),r("deg")]),"CHISQ.INV":n("此函数返回累积 Beta 概率密度函数。",[r("probability"),r("deg")]),"CONFIDENCE.T":n("此函数返回总体平均值的置信区间（使用学生的 t 分布）。",[r("alpha"),r("stdev"),r("size")]),"NETWORKDAYS.INTL":n("此函数返回两个日期之间的所有工作日数。",[r("startdate"),r("enddate"),r("weekend"),r("holidays")]),"WORKDAY.INTL":n("此函数返回指定的若干个工作日之前或之后的日期的序列号（使用自定义周末参数）。周末参数指明周末有几天以及是哪几天。",[r("startdate"),r("numdays"),r("weekend"),r("holidays")]),REFRESH:n("此函数决定了在什么时机重新计算公式，可以通过 evaluateMode 参数来指定是在单元格引用的值发生变化的时候、只计算一次还是以一定的时间间隔重复计算。",[r("formula"),r("evaluateMode"),r("interval")])}}},function(e,t,n){function r(e){return n(o(e))}function o(e){var t=i[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var i={"./Helper/sheet":46,"./SR/sheet":56,"./Worksheet":6,"./zhSR/sheet":146};r.keys=function(){return Object.keys(i)},r.resolve=o,e.exports=r,r.id=145},function(e,t,n){!function(){var e=n(26),t=e.Spread.Sheets.GC$,r=e.Spread.Common.CultureManager,o=t("meta[name='spreadjs culture']");if(o.length>0){var i=t(o[o.length-1]).attr("content");null!==i&&void 0!==i&&null!==i&&"zh-cn"===i.toLowerCase()&&r.culture("zh-cn")}}(),e.exports={Exp_NotSupported:"不支持异常",Exp_PasteExtentIsNull:"pasteExtent为空",Exp_InvalidPastedArea:"粘贴的区域应该与拷贝的区域或剪贴的区域大小相同。",Exp_ChangePartOfArray:"无法仅改变部分的数组。",Exp_InvalidAndSpace:"无效的 {0}: {1} (必须在 {2} 到 {3} 之间)。",Exp_SrcIsNull:"参数 'src' 为空",Exp_DestIsNull:"参数 'dest' 为空",Exp_InvalidCustomFunction:"无效自定义函数",Exp_InvalidCustomName:"无效自定义名称",Exp_IndexOutOfRange:"索引超出区间!",Exp_InvalidRange:"无效区间",Exp_ArgumentOutOfRange:"参数超出范围",Exp_PasteSourceCellsLocked:"源表单的单元格被锁定。",Exp_InvalidCopyPasteSize:"复制和粘贴的区域大小不一致。",Exp_PasteDestinationCellsLocked:"您尝试改变的单元格是被保护的，因此是只读的。",Exp_PasteChangeMergeCell:"不能仅改变合并单元格的一部分。",Tip_Row:"行: ",Tip_Column:"列: ",Tip_Height:"高度: {0} 像素",Tip_Width:"宽度: {0} 像素",NewTab:"新建...",Exp_EmptyNamedStyle:"命名样式的名称不能为空",Exp_SheetNameInvalid:"表单名不能为空且不能包含以下字符 : *, :, [, ], ?, \\, /",Exp_ArrayFromulaSpan:"合并单元格的数组公式不是有效的。",Exp_DestSheetIsNull:"destSheet为空。",Exp_SheetIsNull:"sheet为空。",Exp_OverlappingSpans:"操作将带来重复的合并效果。",NeedCanvasSupport:"你需要一个完全支持HTML5 Canvas的浏览器来运行SpreadJS",ls1:["895b84845700000000000000000000000000634f62676563300000678b4f72674e966757907f304e65907f8b534e966d8b75903000008b60548b8b5390904e520000000000000000000000000000000000000000000030","7f896104ce5370726561642e536865657473d09b802f2f01020d0a2cc430482cc5502c30e8720234f6e872b8efc5504bd52814020d0ae6c5a8e2f7d101aef63073616c65732e7861406772617065636974792e636f6d02"],ls2:["895b84845700000000000000000000000000634f626765633000004e65907f8b53524f0000005930","7f896104ce5370726561642e536865657473d09b802f2f01020d0a34f6e872b8ef69597b307d2902"],ls3:["6762528b538b3000008f8800000000000000000000000000ff6097899951535f546c8b538b3000004e658b534e968b4f7590300000595d8d4eff8b578d4e904e4e67628b538b30000059975e52ff8b5390904e520000000000000000000000000000000000000000000030","2a7e30b8efc1020d0ad04c5370726561642e5368656574730ca800819648d69708d5b8efc1020d0a34f6b8efc550c4302814020d0a82f22d700cf7282d70aef62de57eb8efc1020d0a82002ea90cf7d101aef63073616c65732e7861406772617065636974792e636f6d02"],ls4:["65658b538b30000059975e52ff8b5390904e520000000000000000000000000000000000000000000030","e048b8efc1020d0a82002ea90cf7d101aef63073616c65732e7861406772617065636974792e636f6d02"],ls5:["895b84845700000000000000000000000000634f626765633000004e65907f8b535d8f67ff00008b5390904e520000000000000000000000000000000000000000000083535e5230","7f896104ce5370726561642e536865657473d09b802f2f01020d0a34f6e872b8eff2c71f0c0d0af7d101aef63073616c65732e7861406772617065636974792e636f6db7d62ea902"],ls6:["6772674e895b848457000000000000000000000000004e548b7572ff67535f51525363673000005997835f6b5f6367ff8b817500000000000000000000000030","2c482c3a7f896104ce5370726561642e536865657473a7c1d528480c2ad6978d06d18843020d0a8200b797630f88430cf7f4353430302d3635372d3630303802"]}},function(e,t,n){function r(e){return n(o(e))}function o(e){var t=i[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var i={"./SR/binding":58,"./zhSR/binding":148};r.keys=function(){return Object.keys(i)},r.resolve=o,e.exports=r,r.id=147},function(e,t){e.exports={Exp_NotSupportedDataSource:"数据源不支持！"}},function(e,t,n){function r(e){return n(o(e))}function o(e){var t=i[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var i={"./SR/outlines":60,"./zhSR/outlines":150};r.keys=function(){return Object.keys(i)},r.resolve=o,e.exports=r,r.id=149},function(e,t){e.exports={Exp_InvalidIndex:"无效索引",Exp_InvalidCount:"无效数量",Exp_InvalidLevel:"无效层级",Exp_GroupInfoIsNull:"groupInfo为空"}},function(e,t,n){function r(e){return n(o(e))}function o(e){var t=i[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var i={"./SR/touch":61,"./zhSR/touch":152};r.keys=function(){return Object.keys(i)},r.resolve=o,e.exports=r,r.id=151},function(e,t){e.exports={ToolStrip_PasteText:"粘贴",ToolStrip_CutText:"剪贴",ToolStrip_CopyText:"复制",ToolStrip_AutoFillText:"自动填充"}},function(e,t,n){function r(e){return n(o(e))}function o(e){var t=i[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var i={"./SR/flocatingobject":64,"./zhSR/flocatingobject":154};r.keys=function(){return Object.keys(i)},r.resolve=o,e.exports=r,r.id=153},function(e,t){e.exports={Exp_FloatingObjectHasSameNameError:"当前表单已经包含一个具有相同名称的浮动对象。",Exp_FloatingObjectNameEmptyError:"浮动对象必须具有名称。"}},function(e,t,n){function r(e){return n(o(e))}function o(e){var t=i[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var i={"./SR/conditionalFormats":65,"./zhSR/conditionalFormats":156};r.keys=function(){return Object.keys(i)},r.resolve=o,e.exports=r,r.id=155},function(e,t){e.exports={Exp_RuleIsNull:"参数 'rule' 是空",Exp_NotSupported:"不支持异常"}},function(e,t,n){function r(e){return n(o(e))}function o(e){var t=i[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var i={"./SR/filter":68,"./zhSR/filter":158};r.keys=function(){return Object.keys(i)},r.resolve=o,e.exports=r,r.id=157},function(e,t){e.exports={Exp_InvalidColumnIndex:"无效列索引。",SortAscending:"升序",SortDescending:"降序",OK:"确定",Cancel:"取消",Search:"搜索",CheckAll:"全选",UncheckAll:"取消全选",Blanks:"(空)",Exp_FilterItemIsNull:"筛选项为空。"}},function(e,t,n){function r(e){return n(o(e))}function o(e){var t=i[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var i={"./SR/table":70,"./zhSR/table":160};r.keys=function(){return Object.keys(i)},r.resolve=o,e.exports=r,r.id=159},function(e,t){e.exports={Exp_DragDropShiftTableCell:"此操作是不允许的。此操作试图在你表单的表格中改变单元格。",Exp_DragDropChangePartOfTable:"无法完成此操作: 您正在尝试将部分的表格行或列以此方式更改，这是不允许的。",Exp_TableEmptyNameError:"表格的名称不能为空。",Exp_TableNameInvalid:"表格的名称无效。",Exp_TableInvalidRow:"无效的行索引或行数。",Exp_TableInvalidColumn:"无效的列索引或列数。",Exp_TableIntersectError:"表格不能相交。",Exp_TableHasSameNameError:"当前表单已包含具有相同名称的表格。",Exp_TableDataSourceNullError:"表格数据源不能为空。",Exp_TableMoveOutOfRange:"表格不能被移出表单。",Exp_TableResizeOutOfRange:"无效的行数，列数和表格大小不能超出表单。",Exp_ArrayFormulaTable:"多个单元格数组公式在表格中是不允许的。",Exp_TableResizeInvalidRange:"标题必须保留在同一行上，并且最终表格区域必须覆盖原有表格区域。"}},function(e,t,n){function r(e){return n(o(e))}function o(e){var t=i[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var i={"./SR/slicer":71,"./zhSR/slicer":162};r.keys=function(){return Object.keys(i)},r.resolve=o,e.exports=r,r.id=161},function(e,t){e.exports={Blank:"(空)",Exp_SlicerNameInvalid:"切片器的名称无效。",Exp_SlicerNameExist:"切片器的名称已经存在，请赋予其唯一名。"}},function(e,t,n){function r(e){return n(o(e))}function o(e){var t=i[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var i={"./SR/fill":74,"./zhSR/fill":164};r.keys=function(){return Object.keys(i)},r.resolve=o,e.exports=r,r.id=163},function(e,t){e.exports={CopyCells:"复制单元格",FillSeries:"以序列方式填充",FillFormattingOnly:"仅填充格式",FillWithoutFormatting:"不带格式填充",Exp_NumberOnly:"仅对数字有效",Exp_RangeContainsMergedCell:"区域内不应包含合并单元格。",Exp_TargetContainsMergedCells:"目标区域不应包含合并单元格。",Exp_MergedCellsIdentical:"此行为需要合并单元格的大小一致。",Exp_FillRangeContainsMergedCell:"无法填充一片包含合并单元格的区域。",Exp_FillCellsReadOnly:"您尝试填充的单元格是被保护的，因此它是只读的。",Exp_ChangeMergedCell:"无法仅改变合并单元格的一部分",Exp_ColumnReadOnly:"您尝试修改的列是被保护的，因此它是只读的。",Exp_RowReadOnly:"您尝试修改的行是被保护的，因此它是只读的。",Exp_CellReadOnly:"您尝试修改的单元格是被保护的，因此它是只读的。",Exp_RangeIsNull:"区间为空",Exp_ChangePartOfArray:"无法仅改变部分的数组。"}},function(e,t,n){function r(e){return n(o(e))}function o(e){var t=i[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var i={"./SR/formulaTextBox":75,"./zhSR/formulaTextBox":166};r.keys=function(){return Object.keys(i)},r.resolve=o,e.exports=r,r.id=165},function(e,t){function n(e,t){return{name:e,description:t}}e.exports={Fbx_Summary:"概要",Fbx_TableName_Description:"表格名为 ",Fbx_CustomName_Description:"自定义名称为 ",_tableFunctionsResource:[n("#All","返回表或指定表列的完整内容，包括列标题、数据和汇总行"),n("#Data","返回表或指定表列的数据单元格"),n("#Headers","返回表或指定表列的列标题"),n("#Totals","返回表或指定表列的汇总行"),n("@","此行")]}}])}).call(t,n(2))},,,,function(e,t){function n(e,t,n){return{type:i,payload:{timeout:e,actionToWatch:t,actionToDispatch:n}}}function r(e){return{type:a,payload:{actionToRemove:e}}}function o(){var e={};return function(t){return function(n){return function(r){function o(t){var n=t.timeout,r=t.actionToWatch,o=t.actionToDispatch,i=e[r];i&&i.timeoutId&&clearTimeout(i.timeoutId);var a=l({timeout:n,actionToDispatch:o,dispatching:!1});e[r]=a}function s(t){var n=t.actionToRemove,r=e[n];r&&(clearTimeout(r.timeoutId),delete e[n])}function l(e){return e.timeoutId=setTimeout(function(){t.dispatch(e.actionToDispatch)},e.timeout),e}var u=r.type,c=r.payload;return u===i?o(c):s(u===a?c:{actionToRemove:u}),n(r)}}}}Object.defineProperty(t,"__esModule",{value:!0}),t.addTimeout=n,t.removeTimeout=r,t.default=o;var i="@@TIMEOUT/ADD_TIMEOUT",a="@@TIMEOUT/REMOVE_TIMEOUT"},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),n(749);var o=n(750),i=r(o),a=n(440),s=r(a),l=n(613),u=r(l),c={AddUserDialog:u.default,SharedUsersDialog:s.default,Popover:i.default};t.default=c,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){c.hasOwnProperty(e)||u.default.bind(e,f(e)),c[e]=t}function i(e){c[e]=null}function a(e){var t=document.createElement("div");return t.innerHTML=e,t.innerText.trim()}function s(e){return e.replace(/(<a\s+)/g,"@$1")}Object.defineProperty(t,"__esModule",{value:!0}),t.subscribePush=o,t.unsubscribePush=i,t.washHTML=a,t.markMentionText=s;var l=n(33),u=r(l),c={},f=function(e){return function(t){return c[e]&&c[e].call(null,t)}}},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(754),i=r(o);t.default=i.default,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(606),i=r(o),a=n(607),s=r(a);i.default.Button=s.default,t.default=i.default,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e){h&&i();var t=(0,d.qsa)(p);t.length&&(h=(0,u.render)(l.default.createElement(f.default,a({},e,{onClose:i})),t[0]))}function i(){var e=(0,d.qsa)(p);e.length&&(0,u.unmountComponentAtNode)(e[0]),h=null}Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};t.showFileMover=o,t.removeFileMover=i;var s=n(0),l=r(s),u=n(13),c=n(777),f=r(c),d=n(87),p="#file-mover",h=null},,,,,,,,,,,,function(e,t,n){"use strict";function r(e){var t="transition"+e+"Timeout",n="transition"+e;return function(e){if(e[n]){if(null==e[t])return new Error(t+" wasn't supplied to ReactCSSTransitionGroup: this can cause unreliable animations and won't be supported in a future version of React. See https://fb.me/react-animation-transition-group-timeout for more information.");if("number"!=typeof e[t])return new Error(t+" must be a number (in milliseconds)")}}}var o=n(215),i=n(7),a=n(798),s=n(800),l=o.createClass({displayName:"ReactCSSTransitionGroup",propTypes:{transitionName:s.propTypes.name,transitionAppear:o.PropTypes.bool,transitionEnter:o.PropTypes.bool,transitionLeave:o.PropTypes.bool,transitionAppearTimeout:r("Appear"),transitionEnterTimeout:r("Enter"),transitionLeaveTimeout:r("Leave")},getDefaultProps:function(){return{transitionAppear:!1,transitionEnter:!0,transitionLeave:!0}},_wrapChild:function(e){return o.createElement(s,{name:this.props.transitionName,appear:this.props.transitionAppear,enter:this.props.transitionEnter,leave:this.props.transitionLeave,appearTimeout:this.props.transitionAppearTimeout,enterTimeout:this.props.transitionEnterTimeout,leaveTimeout:this.props.transitionLeaveTimeout},e)},render:function(){return o.createElement(a,i({},this.props,{childFactory:this._wrapChild}))}});e.exports=l},function(e,t,n){function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n={};return(0,S.forEach)(t,function(e){n[e.id]={permission:e.permission,role:e.role}}),{type:"UPDATE_PERMISSIONS",payload:r({},e,n)}}function i(e,t,n){return{type:"PATCH_PERMISSIONS",payload:{fileGuid:e,userId:t,permission:{role:n}}}}function a(e,t){return function(n){return 0!=+t.code?n((0,x.error)("GET_SHARED_USERS",t)):Promise.all([n(d(t.data)),n(o(e,t.data)),n(s(e,t.data))])}}function s(e,t){return{type:"PATCH_SHARED_USERS",payload:r({},e,(0,S.map)(t,"id"))}}function l(e){return function(t){return t({type:"GET_SHARED_USERS"}),(0,C.ajaxGet)("/smapi/files/"+e+"/collaborators").then(function(n){return t(a(e,n))},function(e){return t((0,x.error)("GET_SHARED_USERS",e))})}}function u(){var e="GET_RECENT_CONTACTS";return function(t){return t({type:e}),(0,C.ajaxGet)("/smapi/users/mine/recent_contacts").then(function(e){return t(c(e))},function(n){return t((0,x.error)(e,n))})}}function c(e){return function(t){return 0!=+e.code?t((0,x.error)("GET_RECENT_CONTACTS",e)):Promise.all([t(d(e.data)),t(f(e.data))])}}function f(e){return{type:"PATCH_RECENT_CONTACTS",payload:(0,S.map)(e,"id")}}function d(e){var t=(0,S.map)(e,"id");return{type:"PATCH_USERS",payload:(0,S.zipObject)(t,e)}}function p(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"editor",r="SET_PERMISSION";return function(o){switch(n){case"remove":return(0,C.ajaxDelete)("/smapi/files/"+e+"/collaborators/"+t).then(function(t){return o(h(t,e))},function(e){return o((0,x.error)(r,e))});case"add":return(0,C.ajaxPost)("/smapi/files/"+e+"/collaborators",{userId:t,role:"editor"}).then(function(t){return o(h(t,e))},function(e){return o((0,x.error)(r,e))});default:return(0,C.ajaxPatch)("/smapi/files/"+e+"/collaborators/"+t,{role:n}).then(function(r){return o(h(r,e,t,n))},function(e){return o((0,x.error)(r,e))})}}}function h(e,t,n,r){return function(o){return 0!=+e.code?o((0,x.error)("SET_PERMISSION",e)):r?r?o(i(t,n,e.data.role)):void 0:o(l(t))}}function m(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n){return(0,C.ajaxGet)("/smapi/teams/mine/members?pagination=true&perPage=20&page="+e).then(function(r){return n(g(e,r,t))},function(e){return n((0,x.error)("GET_TEAM_MEMBERS",e))})}}function g(e,t,n){return function(r){return 0!=+t.code?r((0,x.error)("GET_TEAM_MEMBERS",t,n)):Promise.all([r(d(t.data)),r(_(e,t.data))])}}function _(e,t){return{type:"UPDATE_TEAM_MEMBER",payload:{page:e,teamMembers:(0,S.map)(t,"id")}}}function v(e){return function(t){return(0,C.ajaxGet)("/smapi/files/"+e).then(function(e){return t(y(e))},function(e){return t((0,x.error)("GET_FILE",e))})}}function y(e){return function(t){return t(0!=+e.code?(0,x.error)("GET_FILE",e):b(e.data))}}function b(e){return{type:"PATCH_FILES",payload:r({},e.guid,e)}}function w(e,t){var n="UPDATE_FILE";return function(r,o){var i=o(),a=i.storage,s=a.files[e],u=function(o){return 0!==o.code?r((0,x.error)(n,o)):Promise.all([r(b((0,S.assign)({},s,t))),r(l(e))])};return(0,C.ajaxPatch)("/smapi/files/"+e,t).then(function(e){return u(e)},function(e){return r((0,x.error)(n,e))})}}Object.defineProperty(t,"__esModule",{value:!0}),t.getSharedUsers=l,t.getRecentContacts=u,t.getRecentContactsSuccess=c,t.updateRecentContacts=f,t.updateUserStorage=d,t.setPermission=p,t.setPermissionSuccess=h,t.getTeamMembers=m,t.getTeamMembersSuccess=g,t.getFile=v,t.getFileSuccess=y,t.updateFileStorage=b,t.patchFile=w;var C=n(22),S=n(1),x=n(748)},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];switch(t.type){case"PATCH_USERS":return(0,f.default)({},e,t.payload);default:return e}}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];switch(t.type){case"PATCH_FILES":return(0,f.default)({},e,t.payload);default:return e}}function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];switch(t.type){case"UPDATE_PERMISSIONS":return(0,f.default)({},e,t.payload);case"PATCH_PERMISSIONS":var n=t.payload,r=n.fileGuid,o=n.userId,i=n.permission;return e[r][o]=i,(0,f.default)({},e);default:return e}}function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];switch(t.type){case"PATCH_SHARED_USERS":return(0,f.default)({},e,t.payload);default:return e}}function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1];switch(t.type){case"PATCH_RECENT_CONTACTS":return t.payload;default:return e}}function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1];switch(t.type){case"UPDATE_TEAM_MEMBER":var n=t.payload,r=n.teamMembers;return 1==n.page?r:[].concat(e).concat(r);default:return e}}Object.defineProperty(t,"__esModule",{value:!0});var c=n(345),f=r(c),d=n(151);t.default=(0,d.combineReducers)({users:o,files:i,permissions:a,filePermissions:s,recentContacts:l,teamMembers:u}),e.exports=t.default},function(e,t,n){(function(e,r,o){function i(e){return e&&e.__esModule?e:{default:e}}function a(){if("enterprise_expired"===C.accountType){var e=new Date,t=new Date(e.getFullYear(),0,0),n=e-t,r=864e5,o=Math.floor(n/r);if(o>(d.default.get("lastSeen")||0)){var i="";i=["creator","admin"].indexOf(C.team_role)?'<div>石墨文档企业版已到期。目前无法新建／导入文档、添加企业成员，但已有文档仍可以正常编辑与共享。</div><br><div>您可以购买或续费企业版服务，也可以删除企业退回到个人版（不会影响任何文档和共享关系）。</div><br><div>致电 400-006-0506 获取购买与折扣信息，或前往 <a href="/enterprise/billing" target="_blank" style="color: #4A90E2; text-decoration: underline;">企业管理</a> 页面。</div>':"<div>石墨文档企业版已到期。目前无法新建／导入文档、添加企业成员，但已有文档仍可以正常编辑与共享。</div><br><div>请尽快提醒管理员购买或续费企业版服务，或者删除企业退回到个人版（不会影响任何文档和共享关系）。</div><br><div>致电 400-006-0506 获取购买与折扣信息。</div>";var a={title:"试用到期提醒",description:i,buttons:[{type:"button",buttonLabel:"知道了",customClass:"btn btn-ok",closeAfterClick:!0}]};return(0,c.default)(a),d.default.set("lastSeen",o,{expires:7}),!0}return!1}}function s(){h.default.needToGuide()&&w&&w.survey&&(w.survey=null,(0,c.default)({customClass:"paid-survey-modal",buttons:[],title:"",description:'<span id="survey-letter"></span><span id="survey-computer"></span><div>石墨文档 @ 你：</div><br><div>感谢您参与本次用户调研，我们已将「石墨文档高级版」<b>2 个月免费</b> 使用机会冲入您的账户。如未收到，请联系我们的客服人员。</div><div>我们还要偷偷告诉您：「石墨文档企业版」即将上线，如您的团队有需求，请联系邮箱<a href="mailto:wangxi@shimo.im">wangxi@shimo.im</a> , 我们同样会奉上 <b>专属折扣</b>。</div>'}))}function l(){g.default.bind("File",function(t){var n=t.data;w.readonly&&e("#doc-title-input").html((0,v.default)(n.name));var o=w.currentFile&&w.currentFile.id;n.id===o&&n.is_delete>=1&&r("/desktop")}),g.default.bind("Contact",function(e){o.isArray(e.data)||(e.data=[e.data]),e.data.forEach(function(e){b.default.push(e)})}),g.default.bind("Unsubscribe",function(e){var t=e.data;"desktop"===t.channel&&(w.desktopNotification=t.is_delete)})}Object.defineProperty(t,"__esModule",{value:!0}),t.checkEnterpriseExpired=a,t.targetedPaidUsersSurvey=s,t.hookSocket=l;var u=n(146),c=i(u),f=n(89),d=i(f),p=n(552),h=i(p),m=n(33),g=i(m),_=n(148),v=i(_),y=n(48),b=i(y),w=window.cow,C=w.currentUser;t.default=function(){s(),l()}}).call(t,n(2),n(23),n(1))},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"render",value:function(){return u.default.createElement("div",{className:"bubble-wrap"},u.default.createElement("div",{className:"bubble-outter"}),u.default.createElement("div",{className:"bubble-inner"}))}}]),t}(l.Component);t.default=c,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(786),f=r(c),d=n(726),p=r(d),h=n(615),m=r(h),g=n(796),_=r(g),v=window.cow,y=function(e){function t(e){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return a(t,e),s(t,[{key:"render",value:function(){var e=this.props.file,t=[0,-3].indexOf(v.currentFile.type)>-1,n=t?u.default.createElement(_.default,null):null,r=v.authorized?u.default.createElement("div",{className:"list-share-box"},u.default.createElement(p.default.Popover,null)):null,o=v.authorized?u.default.createElement(f.default,null):null;return u.default.createElement("div",{className:"s-menu-btn-wrap"},n,r,o,u.default.createElement(m.default,{file:e}))}}]),t}(l.Component);t.default=y,y.propTypes={file:l.PropTypes.object},e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n){return n||a.default.alert({title:t.message,type:"error"}),{type:e+"_FAILED",error:t}}Object.defineProperty(t,"__esModule",{value:!0}),t.error=o;var i=n(5),a=r(i)},function(e,t){},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),i=r(o),a=n(268),s=n(751),l=r(s),u=n(752),c=function(){return i.default.createElement(a.Provider,{store:l.default},i.default.createElement(u.TeamworkPopoverContainer,null))};t.default=c,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(151),i=n(672),a=r(i),s=n(744),l=r(s),u=n(252),c={storage:{}},f=(0,o.combineReducers)({modals:u.reducer,storage:l.default});t.default=(0,a.default)(f,c),e.exports=t.default},function(e,t,n){(function(e){function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.TeamworkPopoverContainer=void 0;var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(0),f=o(c),d=n(268),p=n(151),h=n(743),m=r(h),g=n(275),_=o(g),v=n(603),y=o(v),b=n(609),w=o(b),C=n(612),S=o(C),x=n(72),T=o(x),E=n(9),M=o(E),A=function(t){function n(e){i(this,n);var t=a(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t.handleVisibleChange=t.handleVisibleChange.bind(t),t.handleContentSwitch=t.handleContentSwitch.bind(t),t.handleTriggerClick=t.handleTriggerClick.bind(t),t.setUnVisible=t.setUnVisible.bind(t),t.state={visible:!1,content:"show"},t.popstateHandler=function(){return t.setState({visible:!1})},t}return s(n,t),u(n,null,[{key:"propTypes",get:function(){return{fileGuid:c.PropTypes.string,storage:c.PropTypes.object,maxShareCount:c.PropTypes.number,getSharedUsers:c.PropTypes.func,setPermission:c.PropTypes.func,cleanModals:c.PropTypes.func,pushModal:c.PropTypes.func,popModal:c.PropTypes.func}}},{key:"defaultProps",get:function(){return{fileGuid:cow.currentFile.guid}}}]),u(n,[{key:"componentDidMount",value:function(){e(window).on("popstate",this.setUnVisible)}},{key:"componentWillUnmount",value:function(){e(window).off("popstate",this.setUnVisible)}},{key:"setUnVisible",value:function(){this.setState({visible:!1})}},{key:"handleVisibleChange",value:function(e){!1===e?(T.default.checkIsWelcomeFile()&&M.default.notify("guideTip:visible",{tag:"teamwork",value:!1}),this.setState({visible:e,content:"show"})):this.setState({visible:e})}},{key:"handleContentSwitch",value:function(e){var t=this;setTimeout(function(){t.setState({content:e})},100)}},{key:"handleTriggerClick",value:function(){T.default.checkIsWelcomeFile()&&M.default.notify("guideTip:visible",{tag:"teamwork",value:!1})}},{key:"renderContent",value:function(){var e=this,t=void 0;if(!this.state.visible)return t;var n=(0,p.bindActionCreators)(m,this.props.dispatch);switch(this.state.content){case"show":t=f.default.createElement(y.default,l({},this.props,n,{onButtonClick:this.handleContentSwitch,file:this.file,overflow:[0,25]}));break;case"add":t=f.default.createElement(w.default,l({},this.props,n,{showButton:!0,onButtonClick:function(){return e.handleContentSwitch("show")},file:this.file,overflow:[0,25]}));break;case"transfer":t=f.default.createElement(S.default,l({},this.props,n,{showButton:!0,onButtonClick:function(){return e.handleContentSwitch("show")},fileGuid:this.file,overflow:[0,25]}))}return t}},{key:"render",value:function(){var e={points:["tr","br"],offset:[0,2]};return f.default.createElement(_.default,{align:e,overlayClassName:"teamwork-popover",visible:this.state.visible,onVisibleChange:this.handleVisibleChange,content:this.renderContent()},f.default.createElement("div",{className:"teamwork-popover-trigger",onClick:this.handleTriggerClick},"协作"))}},{key:"file",get:function(){var e=this.props.storage,t=e.files[cow.currentFile.guid];return t&&(t.teamId=t.teamId||0),t}}]),n}(c.Component);t.default=A;var k=function(e){return e},R=(0,d.connect)(k)(A);t.TeamworkPopoverContainer=R}).call(t,n(2))},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(728),f=r(c),d=n(729),p=n(20),h=r(p),m={empty:"添加",editor:"可以编辑",commentator:"只能评论",reader:"只能阅读"},g=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleActionClick=n.handleActionClick.bind(n),n}return a(t,e),s(t,null,[{key:"propTypes",get:function(){return{userId:l.PropTypes.number,email:l.PropTypes.string,permission:l.PropTypes.shape({permission:l.PropTypes.string,isCreator:l.PropTypes.bool,isOutsider:l.PropTypes.bool,fromParent:l.PropTypes.bool}),file:l.PropTypes.object,ownDropdown:l.PropTypes.bool,handleActionClick:l.PropTypes.func,getPopupContainer:l.PropTypes.func,classPrefix:l.PropTypes.string}}},{key:"defaultProps",get:function(){return{permission:{permission:"empty"},file:{teamId:void 0},ownDropdown:!1,getPopupContainer:function(){return document.body}}}}]),s(t,[{key:"handleActionClick",value:function(e){var t=e.key;switch(t){case"commentator":case"reader":if(!cow.currentUser.teamId)return;default:var n={id:this.props.userId,email:this.props.email};this.props.handleActionClick(n,t)}}},{key:"renderTransferOverlay",value:function(){return u.default.createElement(f.default,{className:"roles-menu",onClick:this.handleActionClick},u.default.createElement(f.default.Item,{key:"transfer"},u.default.createElement("span",null,"转让所有权")))}},{key:"renderPermissionOverlay",value:function(){var e=(0,h.default)("roles-menu",{personal:!cow.currentUser.teamId});return u.default.createElement(f.default,{className:e,onClick:this.handleActionClick},u.default.createElement(f.default.Item,{className:"item-editable",key:"editor"},u.default.createElement("span",null,"可以编辑"),u.default.createElement("span",null,"可以编辑、评论、分享文件")),u.default.createElement(f.default.Item,{className:"item-commentable",key:"commentator"},u.default.createElement("span",null,"只能评论"),u.default.createElement("span",null,"只能评论、不能编辑、分享文件"),u.default.createElement("div",{className:"tooltip s-tooltip right"},"企业版选项")),u.default.createElement(f.default.Item,{className:"item-readonly",key:"reader"},u.default.createElement("span",null,"只能阅读"),u.default.createElement("span",null,"不能编辑、评论、分享文件"),u.default.createElement("div",{className:"tooltip s-tooltip right"},"企业版选项")),u.default.createElement(f.default.Divider,null),u.default.createElement(f.default.Item,{className:"danger",key:"remove"},"移除"))}},{key:"render",value:function(){var e=this,t=void 0,n=this.props,r=n.permission,o=n.getPopupContainer;if("owner"===r.role){var i=this.props.userId===cow.currentUser.id,a=cow.currentUser.teamId===this.props.file.teamId&&("admin"===cow.currentUser.teamRole||"creator"===cow.currentUser.teamRole);t=i||a?u.default.createElement(d.Button,{mask:!0,getPopupContainer:o,overlay:this.renderTransferOverlay()},"所有者"):u.default.createElement("div",{className:"sm-dropdown-button no-overlay ownship"},"所有者")}else t="empty"===r.permission?u.default.createElement("div",{className:"sm-dropdown-button no-overlay",onClick:function(){return e.handleActionClick({key:"add"})}},m[r.permission]):u.default.createElement(d.Button,{mask:!0,getPopupContainer:o,overlay:this.renderPermissionOverlay()},m[r.role]);return t}}]),t}(l.Component);t.default=g,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(){}Object.defineProperty(t,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(0),f=r(c),d=n(604),p=r(d),h=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={openKeys:[]},n.handleClick=n.handleClick.bind(n),n.handleOpenChange=n.handleOpenChange.bind(n),n}return a(t,e),u(t,null,[{key:"propTypes",get:function(){return{mode:c.PropTypes.oneOf(["vertical","horizontal","inline"]),selectedKeys:c.PropTypes.arrayOf(c.PropTypes.string),defaultSelectedKeys:c.PropTypes.arrayOf(c.PropTypes.string),openKeys:c.PropTypes.arrayOf(c.PropTypes.string),defaultOpenKeys:c.PropTypes.arrayOf(c.PropTypes.string),onClick:c.PropTypes.func,className:c.PropTypes.string,prefixCls:c.PropTypes.string,onOpenChange:c.PropTypes.func}}},{key:"defaultProps",get:function(){return{prefixCls:"sm-menu",onClick:s,onOpenChange:s,className:""}}}]),u(t,[{key:"componentWillReceiveProps",value:function(e){"inline"===this.props.mode&&"inline"!==e.mode&&(this.switchModeFromInline=!0),"openKeys"in e&&this.setOpenKeys(e.openKeys)}},{key:"handleClick",value:function(e){this.setOpenKeys([]),this.props.onClick(e)}},{key:"handleOpenChange",value:function(e){this.setOpenKeys(e),this.props.onOpenChange(e)}},{key:"setOpenKeys",value:function(e){"openKeys"in this.props||this.setState({openKeys:e})}},{key:"render",value:function(){var e={};return"inline"!==this.props.mode&&(e={openKeys:this.state.openKeys,onClick:this.handleClick,onOpenChange:this.handleOpenChange}),f.default.createElement(p.default,l({},this.props,e))}}]),t}(c.Component);t.default=h,h.Divider=d.Divider,h.Item=d.Item,h.SubMenu=d.SubMenu,h.ItemGroup=d.ItemGroup,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(67),i=r(o),a=n(37),s=r(a),l=n(145),u=r(l),c=n(605),f=r(c),d=n(340),p=(0,u.default)({displayName:"Menu",propTypes:{openSubMenuOnMouseEnter:s.default.bool,closeSubMenuOnMouseLeave:s.default.bool,selectedKeys:s.default.arrayOf(s.default.string),defaultSelectedKeys:s.default.arrayOf(s.default.string),defaultOpenKeys:s.default.arrayOf(s.default.string),openKeys:s.default.arrayOf(s.default.string),mode:s.default.string,onClick:s.default.func,onSelect:s.default.func,onDeselect:s.default.func,onDestroy:s.default.func,openTransitionName:s.default.string,openAnimation:s.default.oneOfType([s.default.string,s.default.object]),level:s.default.number,eventKey:s.default.string,selectable:s.default.bool,children:s.default.any},mixins:[f.default],getDefaultProps:function(){return{openSubMenuOnMouseEnter:!0,closeSubMenuOnMouseLeave:!0,selectable:!0,onClick:d.noop,onSelect:d.noop,onOpenChange:d.noop,onDeselect:d.noop,defaultSelectedKeys:[],defaultOpenKeys:[]}},getInitialState:function(){var e=this.props,t=e.defaultSelectedKeys,n=e.defaultOpenKeys;return"selectedKeys"in e&&(t=e.selectedKeys||[]),"openKeys"in e&&(n=e.openKeys||[]),{selectedKeys:t,openKeys:n}},componentWillReceiveProps:function(e){var t={};"selectedKeys"in e&&(t.selectedKeys=e.selectedKeys||[]),"openKeys"in e&&(t.openKeys=e.openKeys||[]),this.setState(t)},onDestroy:function(e){var t=this.state,n=this.props,r=t.selectedKeys,o=t.openKeys,i=r.indexOf(e);"selectedKeys"in n||-1===i||r.splice(i,1),i=o.indexOf(e),"openKeys"in n||-1===i||o.splice(i,1)},onItemHover:function(e){var t=this,n=e.item,r=this.props,o=r.mode,i=r.closeSubMenuOnMouseLeave,a=e.openChanges,s=void 0===a?[]:a;"inline"!==o&&!i&&n.isSubMenu&&function(){var r=t.state.activeKey,o=t.getFlatInstanceArray().filter(function(e){return e&&e.props.eventKey===r})[0];o&&o.props.open&&(s=s.concat({key:n.props.eventKey,item:n,originalEvent:e,open:!0}))}(),s=s.concat(this.getOpenChangesOnItemHover(e)),s.length&&this.onOpenChange(s)},onSelect:function(e){var t=this.props;if(t.selectable){var n=this.state.selectedKeys,r=e.key;n=t.multiple?n.concat([r]):[r],"selectedKeys"in t||this.setState({selectedKeys:n}),t.onSelect((0,i.default)({},e,{selectedKeys:n}))}},onClick:function(e){this.props.onClick(e)},onOpenChange:function(e){var t=this.props,n=this.state.openKeys.concat(),r=!1,o=function(e){var t=!1;if(e.open)(t=-1===n.indexOf(e.key))&&n.push(e.key);else{var o=n.indexOf(e.key);t=-1!==o,t&&n.splice(o,1)}r=r||t};Array.isArray(e)?e.forEach(o):o(e),r&&("openKeys"in this.props||this.setState({openKeys:n}),t.onOpenChange(n))},onDeselect:function(e){var t=this.props;if(t.selectable){var n=this.state.selectedKeys.concat(),r=e.key,o=n.indexOf(r);-1!==o&&n.splice(o,1),"selectedKeys"in t||this.setState({selectedKeys:n}),t.onDeselect((0,i.default)({},e,{selectedKeys:n}))}},getOpenTransitionName:function(){var e=this.props,t=e.openTransitionName,n=e.openAnimation;return t||"string"!=typeof n||(t=e.prefixCls+"-open-"+n),t},isInlineMode:function(){return"inline"===this.props.mode},lastOpenSubMenu:function(){var e=[],t=this.state.openKeys;return t.length&&(e=this.getFlatInstanceArray().filter(function(e){return e&&-1!==t.indexOf(e.props.eventKey)})),e[0]},renderMenuItem:function(e,t,n){if(!e)return null;var r=this.state,o={openKeys:r.openKeys,selectedKeys:r.selectedKeys,openSubMenuOnMouseEnter:this.props.openSubMenuOnMouseEnter};return this.renderCommonMenuItem(e,t,n,o)},render:function(){var e=(0,i.default)({},this.props);return e.className+=" "+e.prefixCls+"-root",this.renderRoot(e)}});t.default=p,e.exports=t.default},function(e,t,n){"use strict";function r(){var e=[].slice.call(arguments,0);return 1===e.length?e[0]:function(){for(var t=0;t<e.length;t++)e[t]&&e[t].apply&&e[t].apply(this,arguments)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r,e.exports=t.default},function(e,t,n){"use strict";e.exports=n(758)},function(e,t,n){"use strict";function r(e,t,n){n=n||{},9===t.nodeType&&(t=o.getWindow(t));var r=n.allowHorizontalScroll,i=n.onlyScrollIfNeeded,a=n.alignWithTop,s=n.alignWithLeft,l=n.offsetTop||0,u=n.offsetLeft||0,c=n.offsetBottom||0,f=n.offsetRight||0;r=void 0===r||r;var d=o.isWindow(t),p=o.offset(e),h=o.outerHeight(e),m=o.outerWidth(e),g=void 0,_=void 0,v=void 0,y=void 0,b=void 0,w=void 0,C=void 0,S=void 0,x=void 0,T=void 0;d?(C=t,T=o.height(C),x=o.width(C),S={left:o.scrollLeft(C),top:o.scrollTop(C)},b={left:p.left-S.left-u,top:p.top-S.top-l},w={left:p.left+m-(S.left+x)+f,top:p.top+h-(S.top+T)+c},y=S):(g=o.offset(t),_=t.clientHeight,v=t.clientWidth,y={left:t.scrollLeft,top:t.scrollTop},b={left:p.left-(g.left+(parseFloat(o.css(t,"borderLeftWidth"))||0))-u,top:p.top-(g.top+(parseFloat(o.css(t,"borderTopWidth"))||0))-l},w={left:p.left+m-(g.left+v+(parseFloat(o.css(t,"borderRightWidth"))||0))+f,top:p.top+h-(g.top+_+(parseFloat(o.css(t,"borderBottomWidth"))||0))+c}),b.top<0||w.top>0?!0===a?o.scrollTop(t,y.top+b.top):!1===a?o.scrollTop(t,y.top+w.top):b.top<0?o.scrollTop(t,y.top+b.top):o.scrollTop(t,y.top+w.top):i||(a=void 0===a||!!a,a?o.scrollTop(t,y.top+b.top):o.scrollTop(t,y.top+w.top)),r&&(b.left<0||w.left>0?!0===s?o.scrollLeft(t,y.left+b.left):!1===s?o.scrollLeft(t,y.left+w.left):b.left<0?o.scrollLeft(t,y.left+b.left):o.scrollLeft(t,y.left+w.left):i||(s=void 0===s||!!s,s?o.scrollLeft(t,y.left+b.left):o.scrollLeft(t,y.left+w.left)))}var o=n(759);e.exports=r},function(e,t,n){"use strict";function r(e){var t=void 0,n=void 0,r=void 0,o=e.ownerDocument,i=o.body,a=o&&o.documentElement;return t=e.getBoundingClientRect(),n=t.left,r=t.top,n-=a.clientLeft||i.clientLeft||0,r-=a.clientTop||i.clientTop||0,{left:n,top:r}}function o(e,t){var n=e["page"+(t?"Y":"X")+"Offset"],r="scroll"+(t?"Top":"Left");if("number"!=typeof n){var o=e.document;n=o.documentElement[r],"number"!=typeof n&&(n=o.body[r])}return n}function i(e){return o(e)}function a(e){return o(e,!0)}function s(e){var t=r(e),n=e.ownerDocument,o=n.defaultView||n.parentWindow;return t.left+=i(o),t.top+=a(o),t}function l(e,t,n){var r="",o=e.ownerDocument,i=n||o.defaultView.getComputedStyle(e,null);return i&&(r=i.getPropertyValue(t)||i[t]),r}function u(e,t){var n=e[x]&&e[x][t];if(C.test(n)&&!S.test(t)){var r=e.style,o=r[E],i=e[T][E];e[T][E]=e[x][E],r[E]="fontSize"===t?"1em":n||0,n=r.pixelLeft+M,r[E]=o,e[T][E]=i}return""===n?"auto":n}function c(e,t){for(var n=0;n<e.length;n++)t(e[n])}function f(e){return"border-box"===A(e,"boxSizing")}function d(e,t,n){var r={},o=e.style,i=void 0;for(i in t)t.hasOwnProperty(i)&&(r[i]=o[i],o[i]=t[i]);n.call(e);for(i in t)t.hasOwnProperty(i)&&(o[i]=r[i])}function p(e,t,n){var r=0,o=void 0,i=void 0,a=void 0;for(i=0;i<t.length;i++)if(o=t[i])for(a=0;a<n.length;a++){var s=void 0;s="border"===o?o+n[a]+"Width":o+n[a],r+=parseFloat(A(e,s))||0}return r}function h(e){return null!=e&&e==e.window}function m(e,t,n){if(h(e))return"width"===t?P.viewportWidth(e):P.viewportHeight(e);if(9===e.nodeType)return"width"===t?P.docWidth(e):P.docHeight(e);var r="width"===t?["Left","Right"]:["Top","Bottom"],o="width"===t?e.offsetWidth:e.offsetHeight,i=A(e),a=f(e,i),s=0;(null==o||o<=0)&&(o=void 0,s=A(e,t),(null==s||Number(s)<0)&&(s=e.style[t]||0),s=parseFloat(s)||0),void 0===n&&(n=a?O:R);var l=void 0!==o||a,u=o||s;if(n===R)return l?u-p(e,["border","padding"],r,i):s;if(l){var c=n===I?-p(e,["border"],r,i):p(e,["margin"],r,i);return u+(n===O?0:c)}return s+p(e,k.slice(n),r,i)}function g(e){var t=void 0,n=arguments;return 0!==e.offsetWidth?t=m.apply(void 0,n):d(e,N,function(){t=m.apply(void 0,n)}),t}function _(e,t,n){var r=n;{if("object"!==(void 0===t?"undefined":b(t)))return void 0!==r?("number"==typeof r&&(r+="px"),void(e.style[t]=r)):A(e,t);for(var o in t)t.hasOwnProperty(o)&&_(e,o,t[o])}}function v(e,t){"static"===_(e,"position")&&(e.style.position="relative");var n=s(e),r={},o=void 0,i=void 0;for(i in t)t.hasOwnProperty(i)&&(o=parseFloat(_(e,i))||0,r[i]=o+t[i]-n[i]);_(e,r)}var y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},w=/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,C=new RegExp("^("+w+")(?!px)[a-z%]+$","i"),S=/^(top|right|bottom|left)$/,x="currentStyle",T="runtimeStyle",E="left",M="px",A=void 0;"undefined"!=typeof window&&(A=window.getComputedStyle?l:u);var k=["margin","border","padding"],R=-1,I=2,O=1,D=0,P={};c(["Width","Height"],function(e){P["doc"+e]=function(t){var n=t.document;return Math.max(n.documentElement["scroll"+e],n.body["scroll"+e],P["viewport"+e](n))},P["viewport"+e]=function(t){var n="client"+e,r=t.document,o=r.body,i=r.documentElement,a=i[n];return"CSS1Compat"===r.compatMode&&a||o&&o[n]||a}});var N={position:"absolute",visibility:"hidden",display:"block"};c(["width","height"],function(e){var t=e.charAt(0).toUpperCase()+e.slice(1);P["outer"+t]=function(t,n){return t&&g(t,e,n?D:O)};var n="width"===e?["Left","Right"]:["Top","Bottom"];P[e]=function(t,r){if(void 0===r)return t&&g(t,e,R);if(t){var o=A(t);return f(t)&&(r+=p(t,["padding","border"],n,o)),_(t,e,r)}}}),e.exports=y({getWindow:function(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow},offset:function(e,t){if(void 0===t)return s(e);v(e,t)},isWindow:h,each:c,css:_,clone:function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);if(e.overflow)for(var n in e)e.hasOwnProperty(n)&&(t.overflow[n]=e.overflow[n]);return t},scrollLeft:function(e,t){if(h(e)){if(void 0===t)return i(e);window.scrollTo(t,a(e))}else{if(void 0===t)return e.scrollLeft;e.scrollLeft=t}},scrollTop:function(e,t){if(h(e)){if(void 0===t)return a(e);window.scrollTo(i(e),t)}else{if(void 0===t)return e.scrollTop;e.scrollTop=t}},viewportWidth:0,viewportHeight:0},P)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(67),i=r(o),a=n(0),s=r(a),l=n(37),u=r(l),c=n(145),f=r(c),d=(0,f.default)({displayName:"DOMWrap",propTypes:{tag:u.default.string,hiddenClassName:u.default.string,visible:u.default.bool},getDefaultProps:function(){return{tag:"div"}},render:function(){var e=(0,i.default)({},this.props);e.visible||(e.className=e.className||"",e.className+=" "+e.hiddenClassName);var t=e.tag;return delete e.tag,delete e.hiddenClassName,delete e.visible,s.default.createElement(t,e)}});t.default=d,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(300),i=r(o),a=n(67),s=r(a),l=n(0),u=r(l),c=n(37),f=r(c),d=n(145),p=r(d),h=n(762),m=r(h),g=n(339),_=r(g),v=n(20),y=r(v),b=n(340),w=0,C=(0,p.default)({displayName:"SubMenu",propTypes:{parentMenu:f.default.object,title:f.default.node,children:f.default.any,selectedKeys:f.default.array,openKeys:f.default.array,onClick:f.default.func,onOpenChange:f.default.func,rootPrefixCls:f.default.string,eventKey:f.default.string,multiple:f.default.bool,active:f.default.bool,onSelect:f.default.func,closeSubMenuOnMouseLeave:f.default.bool,openSubMenuOnMouseEnter:f.default.bool,onDeselect:f.default.func,onDestroy:f.default.func,onItemHover:f.default.func,onMouseEnter:f.default.func,onMouseLeave:f.default.func,onTitleMouseEnter:f.default.func,onTitleMouseLeave:f.default.func,onTitleClick:f.default.func},mixins:[n(763)],getDefaultProps:function(){return{onMouseEnter:b.noop,onMouseLeave:b.noop,onTitleMouseEnter:b.noop,onTitleMouseLeave:b.noop,onTitleClick:b.noop,title:""}},getInitialState:function(){return this.isSubMenu=1,{defaultActiveFirst:!1}},componentWillUnmount:function(){var e=this.props,t=e.onDestroy,n=e.eventKey,r=e.parentMenu;t&&t(n),r.subMenuInstance===this&&this.clearSubMenuTimers()},onDestroy:function(e){this.props.onDestroy(e)},onKeyDown:function(e){var t=e.keyCode,n=this.menuInstance,r=this.isOpen();if(t===_.default.ENTER)return this.onTitleClick(e),this.setState({defaultActiveFirst:!0}),!0;if(t===_.default.RIGHT)return r?n.onKeyDown(e):(this.triggerOpenChange(!0),this.setState({defaultActiveFirst:!0})),!0;if(t===_.default.LEFT){var o=void 0;if(!r)return;return o=n.onKeyDown(e),o||(this.triggerOpenChange(!1),o=!0),o}return!r||t!==_.default.UP&&t!==_.default.DOWN?void 0:n.onKeyDown(e)},onOpenChange:function(e){this.props.onOpenChange(e)},onMouseEnter:function(e){var t=this.props;this.clearSubMenuLeaveTimer(t.parentMenu.subMenuInstance!==this),t.onMouseEnter({key:t.eventKey,domEvent:e})},onTitleMouseEnter:function(e){var t=this.props,n=t.parentMenu,r=t.eventKey,o=this;this.clearSubMenuTitleLeaveTimer(n.subMenuInstance!==o),n.menuItemInstance&&n.menuItemInstance.clearMenuItemMouseLeaveTimer(!0);var i=[];t.openSubMenuOnMouseEnter&&i.push({key:r,item:o,trigger:"mouseenter",open:!0}),t.onItemHover({key:r,item:o,hover:!0,trigger:"mouseenter",openChanges:i}),this.setState({defaultActiveFirst:!1}),t.onTitleMouseEnter({key:r,domEvent:e})},onTitleMouseLeave:function(e){var t=this,n=this.props,r=n.parentMenu,o=n.eventKey;r.subMenuInstance=this,r.subMenuTitleLeaveFn=function(){"inline"===n.mode&&n.active&&n.onItemHover({key:o,item:t,hover:!1,trigger:"mouseleave"}),n.onTitleMouseLeave({key:n.eventKey,domEvent:e})},r.subMenuTitleLeaveTimer=setTimeout(r.subMenuTitleLeaveFn,100)},onMouseLeave:function(e){var t=this,n=this.props,r=n.parentMenu,o=n.eventKey;r.subMenuInstance=this,r.subMenuLeaveFn=function(){if("inline"!==n.mode){var r=t.isOpen();r&&n.closeSubMenuOnMouseLeave&&n.active?n.onItemHover({key:o,item:t,hover:!1,trigger:"mouseleave",openChanges:[{key:o,item:t,trigger:"mouseleave",open:!1}]}):(n.active&&n.onItemHover({key:o,item:t,hover:!1,trigger:"mouseleave"}),r&&n.closeSubMenuOnMouseLeave&&t.triggerOpenChange(!1))}n.onMouseLeave({key:o,domEvent:e})},r.subMenuLeaveTimer=setTimeout(r.subMenuLeaveFn,100)},onTitleClick:function(e){var t=this.props;t.onTitleClick({key:t.eventKey,domEvent:e}),t.openSubMenuOnMouseEnter||(this.triggerOpenChange(!this.isOpen(),"click"),this.setState({defaultActiveFirst:!1}))},onSubMenuClick:function(e){this.props.onClick(this.addKeyPath(e))},onSelect:function(e){this.props.onSelect(e)},onDeselect:function(e){this.props.onDeselect(e)},getPrefixCls:function(){return this.props.rootPrefixCls+"-submenu"},getActiveClassName:function(){return this.getPrefixCls()+"-active"},getDisabledClassName:function(){return this.getPrefixCls()+"-disabled"},getSelectedClassName:function(){return this.getPrefixCls()+"-selected"},getOpenClassName:function(){return this.props.rootPrefixCls+"-submenu-open"},saveMenuInstance:function(e){this.menuInstance=e},addKeyPath:function(e){return(0,s.default)({},e,{keyPath:(e.keyPath||[]).concat(this.props.eventKey)})},triggerOpenChange:function(e,t){var n=this.props.eventKey;this.onOpenChange({key:n,item:this,trigger:t,open:e})},clearSubMenuTimers:function(){var e=void 0;this.clearSubMenuLeaveTimer(e),this.clearSubMenuTitleLeaveTimer(e)},clearSubMenuTitleLeaveTimer:function(){var e=this.props.parentMenu;e.subMenuTitleLeaveTimer&&(clearTimeout(e.subMenuTitleLeaveTimer),e.subMenuTitleLeaveTimer=null,e.subMenuTitleLeaveFn=null)},clearSubMenuLeaveTimer:function(){var e=this.props.parentMenu;e.subMenuLeaveTimer&&(clearTimeout(e.subMenuLeaveTimer),e.subMenuLeaveTimer=null,e.subMenuLeaveFn=null)},isChildrenSelected:function(){var e={find:!1};return(0,b.loopMenuItemRecusively)(this.props.children,this.props.selectedKeys,e),e.find},isOpen:function(){return-1!==this.props.openKeys.indexOf(this.props.eventKey)},renderChildren:function(e){var t=this.props,n={mode:"horizontal"===t.mode?"vertical":t.mode,visible:this.isOpen(),level:t.level+1,inlineIndent:t.inlineIndent,focusable:!1,onClick:this.onSubMenuClick,onSelect:this.onSelect,onDeselect:this.onDeselect,onDestroy:this.onDestroy,selectedKeys:t.selectedKeys,eventKey:t.eventKey+"-menu-",openKeys:t.openKeys,openTransitionName:t.openTransitionName,openAnimation:t.openAnimation,onOpenChange:this.onOpenChange,closeSubMenuOnMouseLeave:t.closeSubMenuOnMouseLeave,defaultActiveFirst:this.state.defaultActiveFirst,multiple:t.multiple,prefixCls:t.rootPrefixCls,id:this._menuId,ref:this.saveMenuInstance};return u.default.createElement(m.default,n,e)},render:function(){var e,t=this.isOpen();this.haveOpen=this.haveOpen||t;var n=this.props,r=this.getPrefixCls(),o=(e={},(0,i.default)(e,n.className,!!n.className),(0,i.default)(e,r+"-"+n.mode,1),e);o[this.getOpenClassName()]=t,o[this.getActiveClassName()]=n.active,o[this.getDisabledClassName()]=n.disabled,o[this.getSelectedClassName()]=this.isChildrenSelected(),this._menuId||(n.eventKey?this._menuId=n.eventKey+"$Menu":this._menuId="$__$"+ ++w+"$Menu"),o[r]=!0,o[r+"-"+n.mode]=1;var a={},l={},c={};n.disabled||(a={onClick:this.onTitleClick},l={onMouseLeave:this.onMouseLeave,onMouseEnter:this.onMouseEnter},c={onMouseEnter:this.onTitleMouseEnter,onMouseLeave:this.onTitleMouseLeave});var f={};return"inline"===n.mode&&(f.paddingLeft=n.inlineIndent*n.level),u.default.createElement("li",(0,s.default)({className:(0,y.default)(o)},l),u.default.createElement("div",(0,s.default)({style:f,className:r+"-title"},c,a,{"aria-expanded":t,"aria-owns":this._menuId,"aria-haspopup":"true"}),n.title),this.renderChildren(n.children))}});C.isSubMenu=1,t.default=C,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(184),i=r(o),a=n(67),s=r(a),l=n(0),u=r(l),c=n(37),f=r(c),d=n(145),p=r(d),h=n(605),m=r(h),g=n(342),_=r(g),v=(0,p.default)({displayName:"SubPopupMenu",propTypes:{onSelect:f.default.func,onClick:f.default.func,onDeselect:f.default.func,onOpenChange:f.default.func,onDestroy:f.default.func,openTransitionName:f.default.string,openAnimation:f.default.oneOfType([f.default.string,f.default.object]),openKeys:f.default.arrayOf(f.default.string),closeSubMenuOnMouseLeave:f.default.bool,visible:f.default.bool,children:f.default.any},mixins:[m.default],onDeselect:function(e){this.props.onDeselect(e)},onSelect:function(e){this.props.onSelect(e)},onClick:function(e){this.props.onClick(e)},onOpenChange:function(e){this.props.onOpenChange(e)},onDestroy:function(e){this.props.onDestroy(e)},onItemHover:function(e){var t=e.openChanges,n=void 0===t?[]:t;n=n.concat(this.getOpenChangesOnItemHover(e)),n.length&&this.onOpenChange(n)},getOpenTransitionName:function(){return this.props.openTransitionName},renderMenuItem:function(e,t,n){if(!e)return null;var r=this.props,o={openKeys:r.openKeys,selectedKeys:r.selectedKeys,openSubMenuOnMouseEnter:!0};return this.renderCommonMenuItem(e,t,n,o)},render:function(){var e=this.renderFirst;if(this.renderFirst=1,this.haveOpened=this.haveOpened||this.props.visible,!this.haveOpened)return null;var t=!0;!e&&this.props.visible&&(t=!1);var n=(0,s.default)({},this.props);n.className+=" "+n.prefixCls+"-sub";var r={};return n.openTransitionName?r.transitionName=n.openTransitionName:"object"===(0,i.default)(n.openAnimation)&&(r.animation=(0,s.default)({},n.openAnimation),t||delete r.animation.appear),u.default.createElement(_.default,(0,s.default)({},r,{showProp:"visible",component:"",transitionAppear:t}),this.renderRoot(n))}});t.default=v,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(339),i=r(o),a=n(258),s=r(a),l=n(764),u=r(l),c=n(13),f=r(c);t.default={componentDidMount:function(){this.componentDidUpdate()},componentDidUpdate:function(){"inline"!==this.props.mode&&(this.props.open?this.bindRootCloseHandlers():this.unbindRootCloseHandlers())},handleDocumentKeyUp:function(e){e.keyCode===i.default.ESC&&this.props.onItemHover({key:this.props.eventKey,item:this,hover:!1})},handleDocumentClick:function(e){if(!(0,u.default)(f.default.findDOMNode(this),e.target)){this.props.onItemHover({hover:!1,item:this,key:this.props.eventKey}),this.triggerOpenChange(!1)}},bindRootCloseHandlers:function(){this._onDocumentClickListener||(this._onDocumentClickListener=(0,s.default)(document,"click",this.handleDocumentClick),this._onDocumentKeyupListener=(0,s.default)(document,"keyup",this.handleDocumentKeyUp))},unbindRootCloseHandlers:function(){this._onDocumentClickListener&&(this._onDocumentClickListener.remove(),this._onDocumentClickListener=null),this._onDocumentKeyupListener&&(this._onDocumentKeyupListener.remove(),this._onDocumentKeyupListener=null)},componentWillUnmount:function(){this.unbindRootCloseHandlers()}},e.exports=t.default},function(e,t,n){"use strict";function r(e,t){for(var n=t;n;){if(n===e)return!0;n=n.parentNode}return!1}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(67),i=r(o),a=n(0),s=r(a),l=n(37),u=r(l),c=n(145),f=r(c),d=n(339),p=r(d),h=n(20),m=r(h),g=n(340),_=(0,f.default)({displayName:"MenuItem",propTypes:{rootPrefixCls:u.default.string,eventKey:u.default.string,active:u.default.bool,children:u.default.any,selectedKeys:u.default.array,disabled:u.default.bool,title:u.default.string,onSelect:u.default.func,onClick:u.default.func,onDeselect:u.default.func,parentMenu:u.default.object,onItemHover:u.default.func,onDestroy:u.default.func,onMouseEnter:u.default.func,onMouseLeave:u.default.func},getDefaultProps:function(){return{onSelect:g.noop,onMouseEnter:g.noop,onMouseLeave:g.noop}},componentWillUnmount:function(){var e=this.props;e.onDestroy&&e.onDestroy(e.eventKey),e.parentMenu.menuItemInstance===this&&this.clearMenuItemMouseLeaveTimer()},onKeyDown:function(e){if(e.keyCode===p.default.ENTER)return this.onClick(e),!0},onMouseLeave:function(e){var t=this,n=this.props,r=n.eventKey,o=n.parentMenu;o.menuItemInstance=this,o.menuItemMouseLeaveFn=function(){n.active&&n.onItemHover({key:r,item:t,hover:!1,domEvent:e,trigger:"mouseleave"})},o.menuItemMouseLeaveTimer=setTimeout(o.menuItemMouseLeaveFn,30),n.onMouseLeave({key:r,domEvent:e})},onMouseEnter:function(e){var t=this.props,n=t.eventKey,r=t.parentMenu;this.clearMenuItemMouseLeaveTimer(r.menuItemInstance!==this),r.subMenuInstance&&r.subMenuInstance.clearSubMenuTimers(),t.onItemHover({key:n,item:this,hover:!0,domEvent:e,trigger:"mouseenter"}),t.onMouseEnter({key:n,domEvent:e})},onClick:function(e){var t=this.props,n=this.isSelected(),r=t.eventKey,o={key:r,keyPath:[r],item:this,domEvent:e};t.onClick(o),t.multiple?n?t.onDeselect(o):t.onSelect(o):n||t.onSelect(o)},getPrefixCls:function(){return this.props.rootPrefixCls+"-item"},getActiveClassName:function(){return this.getPrefixCls()+"-active"},getSelectedClassName:function(){return this.getPrefixCls()+"-selected"},getDisabledClassName:function(){return this.getPrefixCls()+"-disabled"},clearMenuItemMouseLeaveTimer:function(){var e=this.props,t=e.parentMenu;t.menuItemMouseLeaveTimer&&(clearTimeout(t.menuItemMouseLeaveTimer),t.menuItemMouseLeaveTimer=null,t.menuItemMouseLeaveFn=null)},isSelected:function(){return-1!==this.props.selectedKeys.indexOf(this.props.eventKey)},render:function(){var e=this.props,t=this.isSelected(),n={};n[this.getActiveClassName()]=!e.disabled&&e.active,n[this.getSelectedClassName()]=t,n[this.getDisabledClassName()]=e.disabled,n[this.getPrefixCls()]=!0,n[e.className]=!!e.className;var r=(0,i.default)({},e.attribute,{title:e.title,className:(0,m.default)(n),role:"menuitem","aria-selected":t,"aria-disabled":e.disabled}),o={};e.disabled||(o={onClick:this.onClick,onMouseLeave:this.onMouseLeave,onMouseEnter:this.onMouseEnter});var a=(0,i.default)({},e.style);return"inline"===e.mode&&(a.paddingLeft=e.inlineIndent*e.level),s.default.createElement("li",(0,i.default)({style:a},r,o),e.children)}});_.isMenuItem=1,t.default=_,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),i=r(o),a=n(37),s=r(a),l=n(145),u=r(l),c=(0,u.default)({displayName:"MenuItemGroup",propTypes:{renderMenuItem:s.default.func,index:s.default.number,className:s.default.string,rootPrefixCls:s.default.string},getDefaultProps:function(){return{disabled:!0}},renderInnerMenuItem:function(e,t){var n=this.props;return(0,n.renderMenuItem)(e,n.index,t)},render:function(){var e=this.props,t=e.className,n=void 0===t?"":t,r=e.rootPrefixCls,o=r+"-item-group-title",a=r+"-item-group-list";return i.default.createElement("li",{className:n+" "+r+"-item-group"},i.default.createElement("div",{className:o},e.title),i.default.createElement("ul",{className:a},i.default.Children.map(e.children,this.renderInnerMenuItem)))}});c.isMenuItemGroup=!0,t.default=c,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),i=r(o),a=n(37),s=r(a),l=n(145),u=r(l),c=(0,u.default)({displayName:"Divider",propTypes:{disabled:s.default.bool,className:s.default.string,rootPrefixCls:s.default.string},getDefaultProps:function(){return{disabled:!0}},render:function(){var e=this.props,t=e.className,n=void 0===t?"":t,r=e.rootPrefixCls;return i.default.createElement("li",{className:n+" "+r+"-item-divider"})}});t.default=c,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(769),i=r(o);t.default=i.default,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){for(var n=Object.getOwnPropertyNames(t),r=0;r<n.length;r++){var o=n[r],i=Object.getOwnPropertyDescriptor(t,o);i&&i.configurable&&void 0===e[o]&&Object.defineProperty(e,o,i)}return e}function i(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):o(e,t))}Object.defineProperty(t,"__esModule",{value:!0});var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c=n(0),f=r(c),d=n(37),p=r(d),h=n(13),m=r(h),g=n(341),_=r(g),v=n(770),y=r(v),b=function(e){function t(n){a(this,t);var r=s(this,e.call(this,n));return w.call(r),r.state="visible"in n?{visible:n.visible}:{visible:n.defaultVisible},r}return l(t,e),t.prototype.componentWillReceiveProps=function(e){var t=e.visible;void 0!==t&&this.setState({visible:t})},t.prototype.getMenuElement=function(){var e=this.props,t=e.overlay,n=e.prefixCls,r={prefixCls:n+"-menu",onClick:this.onClick};return"string"==typeof t.type&&delete r.prefixCls,f.default.cloneElement(t,r)},t.prototype.getPopupDomNode=function(){return this.refs.trigger.getPopupDomNode()},t.prototype.render=function(){var e=this.props,t=e.prefixCls,n=e.children,r=e.transitionName,o=e.animation,a=e.align,s=e.placement,l=e.getPopupContainer,c=e.showAction,d=e.hideAction,p=e.overlayClassName,h=e.overlayStyle,m=e.trigger,g=i(e,["prefixCls","children","transitionName","animation","align","placement","getPopupContainer","showAction","hideAction","overlayClassName","overlayStyle","trigger"]);return f.default.createElement(_.default,u({},g,{prefixCls:t,ref:"trigger",popupClassName:p,popupStyle:h,builtinPlacements:y.default,action:m,showAction:c,hideAction:d,popupPlacement:s,popupAlign:a,popupTransitionName:r,popupAnimation:o,popupVisible:this.state.visible,afterPopupVisibleChange:this.afterVisibleChange,popup:this.getMenuElement(),onPopupVisibleChange:this.onVisibleChange,getPopupContainer:l}),n)},t}(c.Component);b.propTypes={minOverlayWidthMatchTrigger:p.default.bool,onVisibleChange:p.default.func,prefixCls:p.default.string,children:p.default.any,transitionName:p.default.string,overlayClassName:p.default.string,animation:p.default.any,align:p.default.object,overlayStyle:p.default.object,placement:p.default.string,overlay:p.default.node,trigger:p.default.array,showAction:p.default.array,hideAction:p.default.array,getPopupContainer:p.default.func,visible:p.default.bool,defaultVisible:p.default.bool},b.defaultProps={minOverlayWidthMatchTrigger:!0,prefixCls:"rc-dropdown",trigger:["hover"],showAction:[],hideAction:[],overlayClassName:"",overlayStyle:{},defaultVisible:!1,onVisibleChange:function(){},placement:"bottomLeft"};var w=function(){var e=this;this.onClick=function(t){var n=e.props,r=n.overlay.props;"visible"in n||e.setState({visible:!1}),r.onClick&&r.onClick(t)},this.onVisibleChange=function(t){var n=e.props;"visible"in n||e.setState({visible:t}),n.onVisibleChange(t)},this.afterVisibleChange=function(t){if(t&&e.props.minOverlayWidthMatchTrigger){var n=e.getPopupDomNode(),r=m.default.findDOMNode(e);r.offsetWidth>n.offsetWidth&&(n.style.width=r.offsetWidth+"px")}}};t.default=b,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={adjustX:1,adjustY:1},o=[0,0],i=t.placements={topLeft:{points:["bl","tl"],overflow:r,offset:[0,-4],targetOffset:o},topCenter:{points:["bc","tc"],overflow:r,offset:[0,-4],targetOffset:o},topRight:{points:["br","tr"],overflow:r,offset:[0,-4],targetOffset:o},bottomLeft:{points:["tl","bl"],overflow:r,offset:[0,4],targetOffset:o},bottomCenter:{points:["tc","bc"],overflow:r,offset:[0,4],targetOffset:o},bottomRight:{points:["tr","br"],overflow:r,offset:[0,4],targetOffset:o}};t.default=i},function(e,t,n){function r(e,t,n){var r=!0,s=!0;if("function"!=typeof e)throw new TypeError(a);return i(n)&&(r="leading"in n?!!n.leading:r,s="trailing"in n?!!n.trailing:s),o(e,t,{leading:r,maxWait:t,trailing:s})}var o=n(772),i=n(175),a="Expected a function";e.exports=r},function(e,t,n){function r(e,t,n){function r(t){var n=v,r=y;return v=y=void 0,x=t,w=e.apply(r,n)}function c(e){return x=e,C=setTimeout(p,t),T?r(e):w}function f(e){var n=e-S,r=e-x,o=t-n;return E?u(o,b-r):o}function d(e){var n=e-S,r=e-x;return void 0===S||n>=t||n<0||E&&r>=b}function p(){var e=i();if(d(e))return h(e);C=setTimeout(p,f(e))}function h(e){return C=void 0,M&&v?r(e):(v=y=void 0,w)}function m(){void 0!==C&&clearTimeout(C),x=0,v=S=y=C=void 0}function g(){return void 0===C?w:h(i())}function _(){var e=i(),n=d(e);if(v=arguments,y=this,S=e,n){if(void 0===C)return c(S);if(E)return C=setTimeout(p,t),r(S)}return void 0===C&&(C=setTimeout(p,t)),w}var v,y,b,w,C,S,x=0,T=!1,E=!1,M=!0;if("function"!=typeof e)throw new TypeError(s);return t=a(t)||0,o(n)&&(T=!!n.leading,E="maxWait"in n,b=E?l(a(n.maxWait)||0,t):b,M="trailing"in n?!!n.trailing:M),_.cancel=m,_.flush=g,_}var o=n(175),i=n(773),a=n(669),s="Expected a function",l=Math.max,u=Math.min;e.exports=r},function(e,t,n){var r=n(150),o=function(){return r.Date.now()};e.exports=o},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e){return e<10?"0"+e:e}function i(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"/",i=new Date,a=+i/1e3,s=new Date(e),l=+new Date(e)/1e3;if(t){var u=a-l;if(u<60)return"刚刚";if(u<3600)return parseInt(u/60,10)+"分钟前"}var c=new Date(i.getFullYear()+"/"+(i.getMonth()+1)+"/"+i.getDate()+" 00:00:00"),f=new Date(e),d=864e5,p=c-f+d,h=o(s.getHours())+":"+o(s.getMinutes());if(p>0&&p<=d)return n?"今天":"今天 "+h;if(p>d&&p<=2*d)return n?"昨天":"昨天 "+h;var m=r,g=""+(s.getMonth()+1)+m+s.getDate()+" "+h;return n&&(g=""+(s.getMonth()+1)+m+s.getDate()),s.getFullYear()!==i.getFullYear()&&(g=""+s.getFullYear()+m+g),g}Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),s=r(a),l=n(608),u=r(l),c=function(e){var t=i(e.children,e.hasOwnProperty("within1Hour")&&e.within1Hour,e.hasOwnProperty("onlyDate")&&e.onlyDate,e.dateSymbol),n=e.before,r=e.after;return s.default.createElement(u.default,null,n+t+r)};c.propTypes={children:a.PropTypes.string,within1Hour:a.PropTypes.bool,onlyDate:a.PropTypes.bool,dateSymbol:a.PropTypes.string,before:a.PropTypes.string,after:a.PropTypes.string},c.defaultProps={within1Hour:!1,onlyDate:!1,dateSymbol:"/",before:"",after:""},t.default=c,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=r(u),f=n(20),d=r(f),p=n(611),h=r(p),m=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleScroll=n.handleScroll.bind(n),n.state={scrolledToEnd:!1},n}return a(t,e),l(t,null,[{key:"propTypes",get:function(){return{className:u.PropTypes.string,loadMore:u.PropTypes.func,hasMore:u.PropTypes.bool,spinning:u.PropTypes.bool,defaultText:u.PropTypes.node,noMoreText:u.PropTypes.node}}},{key:"defaultProps",get:function(){return{className:"",loadMore:function(){},hasMore:!0,spinning:!1,defaultText:"正在加载下一页...",noMoreText:"已经是最后一页了."}}}]),l(t,[{key:"handleScroll",value:function(e){var t=e.target;t.scrollTop+t.offsetHeight===t.firstChild.offsetHeight&&this.handleLoadMore()}},{key:"handleLoadMore",value:function(){this.state.scrolledToEnd||this.setState({scrolledToEnd:!0}),this.props.loadMore()}},{key:"renderLoadMore",value:function(){var e=this.props,t=e.hasMore,n=e.defaultText,r=e.noMoreText;return c.default.createElement("div",{className:"load-more"},t?n:r)}},{key:"render",value:function(){var e=(0,d.default)("infinite-scroll",this.props.className);return c.default.createElement(h.default,s({},this.props,{className:e,spinning:this.props.spinning,onScroll:this.handleScroll}),this.props.children,this.state.scrolledToEnd&&this.renderLoadMore())}}]),t}(u.Component);t.default=m,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(5),f=r(c),d=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={inviteUrl:null},n.isDingtalkPc=f.default.isDingtalkPc(),n}return a(t,e),s(t,null,[{key:"propTypes",get:function(){return{fileGuid:l.PropTypes.string,fileType:l.PropTypes.string}}},{key:"defaultProps",get:function(){return{fileGuid:cow.currentFile.guid,fileType:cow.pageType}}}]),s(t,[{key:"componentDidMount",value:function(){var e=this;f.default.get("/api/file/"+this.props.fileGuid+"/invite_link").then(function(t){e.setState({inviteUrl:f.default.getQrImageUrl(114,t.data.link)})})}},{key:"render",value:function(){return u.default.createElement("div",{className:"wechat-invite"},this.isDingtalkPc?null:u.default.createElement("span",{className:"btn"},"添加微信好友"),u.default.createElement("div",{className:"invite-link-popup"},u.default.createElement("p",null,"微信扫一扫"),u.default.createElement("img",{src:this.state.inviteUrl}),u.default.createElement("p",null,"把链接发送给好友",u.default.createElement("br",null),"邀请好友加入")))}}]),t}(l.Component);t.default=d,e.exports=t.default},function(e,t,n){(function(r){function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=o(u),f=n(51),d=o(f),p=n(778),h=o(p),m=n(780),g=o(m),_=n(781),v=o(_),y=n(782),b=o(y),w=n(72),C=n(783),S=o(C),x=n(5),T=o(x),E=n(146),M=o(E);n(784);var A=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={loaderVisible:!1,currentDirectory:{},selectedDirectory:{},visible:!0,isMoved:!1},n.onNavigatorBack=n.onNavigatorBack.bind(n),n.onDirectoryClick=n.onDirectoryClick.bind(n),n.startMove=n.startMove.bind(n),n.socketHooker=n.socketHooker.bind(n),n}return s(t,e),l(t,null,[{key:"propTypes",get:function(){return{sourceFile:u.PropTypes.object,onSuccess:u.PropTypes.func,onFail:u.PropTypes.func,onCancel:u.PropTypes.func,onClose:u.PropTypes.func}}},{key:"defaultProps",get:function(){return{onSuccess:function(){},onFail:function(){},onCancel:function(){},onClose:function(){}}}}]),l(t,[{key:"componentDidMount",value:function(){var e=this;(0,S.default)(this.socketHooker),this.mounted=!0,this.redirectDirectoryByChild(this.props.sourceFile).then(function(t){e.directoryOfSourceFile=t},function(){e.directoryOfSourceFile=null})}},{key:"componentWillUnmount",value:function(){this.mounted=!1,this.directoryOfSourceFile=null}},{key:"socketHooker",value:function(e){var t=this;if(this.mounted&&!this.state.isMoved){var n=e.guid,o=this.state.currentDirectory,i=this.props.sourceFile;["removePermission","delete"].indexOf(e.type)>-1?e.guid&&e.guid===i.guid?(T.default.alert({title:"文件已被删除，移动失败",type:"error"}),this.props.onClose()):r.remove(o.children,{guid:n})?this.setState({currentDirectory:o}):o.guid===n&&this.redirectDesktop():["add","getPermission","update"].indexOf(e.type)>-1&&(0,w.getDirectoryInfo)(e.file).then(function(n){var o=n.file,i=n.crumbInfo,a=o,s=r.get(i,"includedFileGuid",""),l=r.get(i,"crumbList",[]),u=e.file;if(s&&l.length){var c=t.state.currentDirectory;a.guid===c.guid?"update"===e.type?c.children=c.children.map(function(e){return e.guid===u.guid?u:e}):1===u.type?c.children.unshift(u):c.children.push(u):c.guid===u.guid&&(u.children=c.children,c=u),c.children=[].concat(c.children),t.mounted&&t.setState({currentDirectory:c})}})}}},{key:"redirectDirectoryByChild",value:function(e){var t=this;return new Promise(function(n,r){e||r(),t.setState({loaderVisible:!0},function(){(0,w.getDirectoryInfo)(e).then(function(e){var r=e.file;r.children&&(r.children=t.topAlignDirectory(r.children)),t.setState({currentDirectory:r,loaderVisible:!1},function(){n(r)})},function(e){T.default.alert({title:e.message,type:"error"}),t.redirectDesktop(),r(e)})})})}},{key:"redirectDirectory",value:function(e){var t=this;return new Promise(function(n,r){t.state.loaderVisible||(e&&e.children?(t.setState({currentDirectory:e}),n(e)):t.setState({loaderVisible:!0},function(){(0,w.getFile)(e.guid).then(function(e){e.children&&(e.children=t.topAlignDirectory(e.children)),t.setState({currentDirectory:e,loaderVisible:!1},function(){return n(e)})},function(e){T.default.alert(e.message),t.redirectDesktop(),r(e)})}))})}},{key:"redirectDesktop",value:function(){var e=this;this.setState({loaderVisible:!1},function(){e.redirectDirectory({guid:""})})}},{key:"topAlignDirectory",value:function(e){return r.sortBy(e,[function(e){return 1!==e.type}])}},{key:"onNavigatorBack",value:function(){var e=this.state,t=e.currentDirectory;e.loaderVisible||this.redirectDirectoryByChild(t)}},{key:"onDirectoryClick",value:function(e){this.redirectDirectory(e)}},{key:"confirmPreMove",value:function(e){var t=this,n=this.props.sourceFile,o=this.state.currentDirectory,i=this.directoryOfSourceFile,a=n.shortcut_id?"shortcut":"file",s=n.guid,l=o.guid;if(o.children.some(function(e){return e.guid===n.guid}))return T.default.alert({title:"移动成功"}),void this.props.onClose();this.setState({loaderVisible:!0}),(0,w.moveToFolder)(s,l,a,"info").then(function(n){if(0===n.code&&n.data&&"dialog"===n.data.type){var a=n.data.data,s=a.addUserCount,l=a.removeUserCount;if(s||l){var u={confirmFun:function(){e()},abortFun:function(){t.setState({visible:!0})}};s&&!l?r.assign(u,{title:"分享文件？",description:"移动后文件将与所有共享文件夹「"+o.name+"」的协作者共享。"}):!s&&l?r.assign(u,{title:"部分协作者可能失去访问权限？",description:"您正在将文档移出共享文件夹「"+i.name+"」，部分协作者将无权限访问该文档。"}):s&&l&&r.assign(u,{title:"部分协作者可能失去访问权限？",description:"移动后文件将与所有共享文件夹「"+o.name+"」的协作者共享。<br />您正在将文档移出共享文件夹「"+i.name+"」，部分协作者将无权限访问该文档。"}),t.setState({visible:!1,loaderVisible:!1},function(){(0,M.default)(u)})}}else 0===n.code&&n.data&&n.data.success?(T.default.alert({title:"移动成功"}),t.props.onClose(),t.props.onSuccess()):t.setState({visible:!0,loaderVisible:!1})},function(e){1===e.code&&e.error&&t.setState({visible:!1},function(){(0,M.default)({title:"没有权限移动",description:e.error,buttons:[{buttonLabel:"确定",customClass:"btn btn-ok",onClick:function(){return t.setState({visible:!0,loaderVisible:!1})},closeAfterClick:!0}]})})})}},{key:"startMove",value:function(){var e=this,t=this.props,n=t.sourceFile,r=t.onSuccess,o=this.state,i=o.currentDirectory;o.loaderVisible||this.confirmPreMove(function(){var t=n.shortcut_id?"shortcut":"file",o=n.guid,a=i.guid;e.setState({loaderVisible:!0,isMoved:!0},function(){(0,w.moveToFolder)(o,a,t,"action").then(function(t){0===t.code&&(T.default.alert({title:"移动成功"}),e.props.onClose(),r())},function(){T.default.alert({title:"移动失败"}),e.setState({loaderVisible:!1,isMoved:!1})})})})}},{key:"render",value:function(){var e=this.state,t=e.loaderVisible,n=e.currentDirectory,r=e.visible,o=this.props,i=o.onClose,a=o.sourceFile,s=n.children||[];return c.default.createElement(d.default,{onClose:i,open:r,customClass:"file-mover-dialog"},c.default.createElement(g.default,{visible:t}),c.default.createElement(v.default,{disable:!n.id,title:n.name,onClose:this.props.onClose,onBack:this.onNavigatorBack}),c.default.createElement(h.default,{onItemClick:this.onDirectoryClick,sourceFileId:a.id,isLoading:t,files:s}),c.default.createElement(b.default,{targetFolder:n,onAction:this.startMove}))}}]),t}(u.Component);t.default=A,e.exports=t.default}).call(t,n(1))},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(779),f=r(c),d=function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.onItemClick=e.onItemClick.bind(e),e}return a(t,e),s(t,null,[{key:"propTypes",get:function(){return{sourceFileId:l.PropTypes.number,files:l.PropTypes.array,onItemClick:l.PropTypes.func,isLoading:l.PropTypes.bool}}},{key:"defaultProps",get:function(){return{files:[],onItemClick:function(){}}}}]),s(t,[{key:"onItemClick",value:function(e){this.props.onItemClick(e)}},{key:"renderItems",value:function(){var e=this.props,t=e.files,n=e.sourceFileId,r=e.isLoading,o=this.onItemClick,i=[];return t.forEach(function(e){var t=e.id===n&&1===e.type;i.push(u.default.createElement(f.default,{key:e.id,file:e,isSourceFile:t,onClick:o}))}),i.length?i:r?null:u.default.createElement("div",{className:"list-empty"},u.default.createElement("div",{className:"list-empty-icon"}),u.default.createElement("div",{className:"list-empty-text"},"没有文件"))}},{key:"render",value:function(){return u.default.createElement("ul",{className:"file-mover-list"},this.renderItems())}}]),t}(l.Component);t.default=d,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=r(u),f=n(20),d=r(f),p=n(271),h=r(p),m=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=e.file,o=e.isSourceFile;return n.state={tipVisible:!1,disable:1!==r.type||r.permissions&&!r.permissions.editable||o},n.timerId=-1,n.onClick=n.onClick.bind(n),n.onMouseEnter=n.onMouseEnter.bind(n),n.onMouseOut=n.onMouseOut.bind(n),n}return s(t,e),l(t,null,[{key:"propTypes",get:function(){return{isSourceFile:u.PropTypes.bool,file:u.PropTypes.object,onClick:u.PropTypes.func}}}]),l(t,[{key:"componentWillReceiveProps",value:function(e){var t=e.file,n=e.isSourceFile,r=1!==t.type||t.permissions&&!t.permissions.editable||n;r!==this.state.disable&&this.setState({disable:r})}},{key:"componentWillUnmount",value:function(){this.clearTimerId()}},{key:"clearTimerId",value:function(){this.timerId>-1&&(clearTimeout(this.timerId),this.timerId=-1)}},{key:"onClick",value:function(){var e=this.props.file;!this.state.disable&&this.props.onClick(e)}},{key:"onMouseEnter",value:function(){var e=this,t=this.state.tipVisible;this.clearTimerId(),t||(this.timerId=setTimeout(function(){e.setState({tipVisible:!0})},1e3))}},{key:"onMouseOut",value:function(){this.clearTimerId(),this.state.tipVisible&&this.setState({tipVisible:!1})}},{key:"renderTitle",value:function(){var e=this.props,t=e.file,n=e.isSourceFile,r="";if(1!==t.type&&(r="这不是文件夹，不能移动到这里"),t.permissions&&!t.permissions.editable&&(r="只能阅读的文件夹"),n&&(r="正在被移动的文件夹"),r){var o={pointerEvents:"none"};return c.default.createElement(h.default,{title:r,align:{offset:[0,-12]},arrowPointAtCenter:!0,placement:"bottom",visible:this.state.tipVisible,offsetTop:-20},c.default.createElement("span",{className:"file-name-text",style:o},t.name))}return c.default.createElement("span",{className:"file-name-text"},t.name)}},{key:"render",value:function(){var e,t=this.props.file,n=this.state.disable,r=t.parent_id,i=t.share_count,a=t.type,s=1===a?"folder":-1===a?"spreadsheet":"doc",l=(0,d.default)({"file-list-item":!0,disable:n}),u=0===r&&i>0||r>0&&i>0,f=(0,d.default)((e={"file-icon":!0,"file-sprite":!0},o(e,"file-"+s+"-icon",!0),o(e,"file-shared",u),e)),p={pointerEvents:"none"};return c.default.createElement("li",{key:t.id,"data-id":t.id,onClick:this.onClick,onMouseEnter:this.onMouseEnter,onMouseOut:this.onMouseOut,className:l},c.default.createElement("i",{className:f,style:p}),this.renderTitle(),t.starred&&c.default.createElement("i",{className:"file-tag-icon file-star-icon active",style:p}),1!==t.type&&u&&c.default.createElement("i",{className:"file-tag-icon file-shared-icon",style:p}),1===t.type&&c.default.createElement("i",{className:"enter-folder-icon",style:p}))}}]),t}(u.Component);t.default=m,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"render",value:function(){return this.props.visible?u.default.createElement("div",{className:"file-list-loader"},u.default.createElement("div",{className:"spinner"})):null}}],[{key:"propTypes",get:function(){return{visible:l.PropTypes.bool}}}]),t}(l.Component);t.default=c,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.onGobackClick=e.onGobackClick.bind(e),e.onCloseClick=e.onCloseClick.bind(e),e}return a(t,e),s(t,null,[{key:"propTypes",get:function(){return{title:l.PropTypes.string,onBack:l.PropTypes.func,onClose:l.PropTypes.func,disable:l.PropTypes.bool}}},{key:"defaultProps",get:function(){return{title:"我的桌面",onBack:function(){},onClose:function(){},disable:!1}}}]),s(t,[{key:"onGobackClick",value:function(){var e=this.props,t=e.onBack;!e.disable&&t()}},{key:"onCloseClick",value:function(){(0,this.props.onClose)()}},{key:"render",value:function(){var e=this.props,t=e.title,n=e.disable;return u.default.createElement("div",{className:"file-mover-navigator"},u.default.createElement("a",{href:"javascript:void(0)",className:n?"disable":"",style:{display:"inline-block"},onClick:this.onGobackClick},u.default.createElement("i",{className:"navigator-back"}),u.default.createElement("span",{className:"navigator-title"},t)),u.default.createElement("a",{href:"javascript:void(0)",onClick:this.onCloseClick,className:"file-mover-close"},u.default.createElement("i",{className:"dialog-close-icon"})))}}]),t}(l.Component);t.default=c,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.onClick=e.onClick.bind(e),e}return a(t,e),s(t,null,[{key:"propTypes",get:function(){return{targetFolder:l.PropTypes.object,onAction:l.PropTypes.func}}},{key:"defaultProps",get:function(){return{onAction:function(){}}}}]),s(t,[{key:"onClick",value:function(){(0,this.props.onAction)()}},{key:"render",value:function(){var e=this.props.targetFolder;return u.default.createElement("div",{className:"file-mover-action"},u.default.createElement("button",{onClick:this.onClick,className:"sm-btn sm-btn-primary file-mover-btn"},"移动到 "+(e.name||"我的桌面")))}}]),t}(l.Component);t.default=c,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e=e||function(){},i.default.bind("File",function(t){"update"===t.db_event?e(+t.data.is_delete>0?{type:"delete",guid:t.data.guid}:{type:"update",file:t.data}):"create"===t.db_event&&e({type:"add",file:t.data})}),i.default.bind("Permission",function(t){"destroy"===t.db_event?e({type:"removePermission",guid:t.data.guid}):"create"===t.db_event&&e({type:"getPermission",file:t.data.file})})};var o=n(33),i=r(o);e.exports=t.default},function(e,t){},function(e,t){},function(e,t,n){(function(r){function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=o(u),f=n(256),d=o(f),p=n(5),h=o(p),m=n(33),g=o(m),_=n(22),v=n(9),y=o(v),b=n(72),w=o(b),C=n(21),S=n(69),x=n(787),T=o(x),E=n(444),M=o(E),A=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={open:!1,isEnableShare:!1,readOnly:!1,isEnterprise:!1,isPasswordProtected:!1,password:(0,M.default)("cow","currentFile","password")?cow.currentFile.password:null},n.changeShareState=n.changeShareState.bind(n),n.changePassword=n.changePassword.bind(n),n.onToggleBtn=n.onToggleBtn.bind(n),n.componentClick=n.componentClick.bind(n),n}return s(t,e),l(t,[{key:"componentDidMount",value:function(){this.mounted=!0,this.init(),y.default.attach("doc:init",this.init,{scope:this})}},{key:"componentWillUnmount",value:function(){this.mounted=!1,y.default.detach("doc:init",this.init)}},{key:"componentClick",value:function(){this.setState({open:!1})}},{key:"onToggleBtn",value:function(){w.default.checkIsWelcomeFile()&&y.default.notify("guideTip:visible",{tag:"share",value:!1}),this.setState({open:!this.state.open})}},{key:"changeShareStatusAjax",value:function(e,t,n){var r="";(0,C.isSheet)(cow.pageType)?r=cow.currentSheetGuid:(0,C.isDoc)(cow.pageType)&&(r=cow.currentDocGuid),(0,_.ajaxPatch)(S.SET_EXTERNAL_LINK.replace("{%guid%}",r),{shareMode:e,passwordProtected:t}).then(function(t){if("function"==typeof n)if(0===t.code)n(!0),(0,C.setShareMode)(e),(0,C.setPasswordProtected)(t.data.passwordProtected,t.data.password),h.default.alert({title:"设置成功"});else{n(!1);var r=t.message||t.error,o={type:"error",title:r};h.default.alert(o)}},function(){h.default.alert({type:"error",title:"网络异常，设置失败"}),"function"==typeof n&&n(!1)})}},{key:"changePasswordAjax",value:function(e){var t="";(0,C.isSheet)(cow.pageType)?t=cow.currentSheetGuid:(0,C.isDoc)(cow.pageType)&&(t=cow.currentDocGuid),(0,_.ajaxPatch)(S.SET_EXTERNAL_LINK.replace("{%guid%}",t),{resetPassword:1}).then(function(t){if(0===t.code)"function"==typeof e&&e(!0,t.data.password),(0,C.setPasswordProtected)(!0,t.data.password),h.default.alert({title:"设置成功"});else{"function"==typeof e&&e(!1);var n={type:"error",title:t.error};t.error.length>=20&&(n.title="设置失败",n.content=t.error),h.default.alert(n)}},function(){h.default.alert({type:"error",title:"网络异常，设置失败"}),"function"==typeof e&&e(!1)}).catch(function(){h.default.alert({type:"error",title:"设置失败"}),"function"==typeof e&&e(!1)})}},{key:"updateShareState",value:function(e,t){var n={isEnableShare:!1,readOnly:!1,isEnterprise:!1,isPasswordProtected:!1};"private"===e?n.isEnableShare=!1:"readonly"===e?(n.isEnableShare=!0,n.readOnly=!0):"editable"===e?n.isEnableShare=!0:"enterprise_editable"===e?(n.isEnableShare=!0,n.isEnterprise=!0):"enterprise_readonly"===e&&(n.isEnableShare=!0,n.readOnly=!0,n.isEnterprise=!0),n.isPasswordProtected=t,n.password=(0,M.default)("cow","currentFile","password")?cow.currentFile.password:null,this.setState(n)}},{key:"changeShareState",value:function(e,t,n){var r=this,o=(0,C.getShareMode)(),i=this.state.isPasswordProtected;o===e&&i===t||this.changeShareStatusAjax(e,t?1:0,function(o){o?(r.updateShareState(e,t),"function"==typeof n&&n(null)):"function"==typeof n&&n(!0)})}},{key:"changePassword",value:function(e){var t=this;this.changePasswordAjax(function(n,r){n?(t.setState({password:r}),"function"==typeof e&&e(null)):"function"==typeof e&&e(!0)})}},{key:"init",value:function(){this.initShareStatus(),this.setState({shareList:[]})}},{key:"initShareStatus",value:function(){this.updateShareState((0,C.getShareMode)(),(0,C.getPasswordProtected)()),this.initPush()}},{key:"initPush",value:function(){var e=this;g.default.bind("File",function(t){if(e.mounted&&r.get(window,"cow.currentFile.guid")===t.data.guid){var n=t.data.shareMode;(0,C.setShareMode)(n),(0,C.setPasswordProtected)(t.data.passwordProtected,t.data.password),e.updateShareState(n,t.data.passwordProtected)}})}},{key:"render",value:function(){var e=this.state.open?"":"hide",t=this.state,n=t.isEnableShare,r=t.readOnly,o=t.isEnterprise,i=t.isPasswordProtected,a=t.password;return c.default.createElement("div",{className:"share-btn-wrap"},c.default.createElement("div",{className:"s-btn sm-share-btn "+(this.state.open?"active":""),onTouchTap:this.onToggleBtn},"分享"),c.default.createElement("div",{className:"sheet-share-dropdown with-trangle "+e},c.default.createElement(T.default,{isEnableShare:n,readOnly:r,isEnterprise:o,isPasswordProtected:i,password:a,onShareStateChange:this.changeShareState,onPasswordChange:this.changePassword})))}}]),t}(u.Component);t.default=(0,d.default)(A),e.exports=t.default}).call(t,n(1))},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();n(788);var l=n(0),u=r(l),c=n(789),f=r(c),d=n(791),p=r(d),h=n(443),m=r(h),g=n(444),_=r(g),v=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"render",value:function(){var e=this.props,t=e.isEnableShare,n=e.readOnly,r=e.isEnterprise,o=e.isPasswordProtected,i=e.password,a=e.onShareStateChange,s=e.onPasswordChange,l=(0,_.default)("cow","currentUser","accountType")&&!!cow.currentUser.accountType.match(/^personal_/),c=void 0;return c=t?r?o?"public-enterprise-password":"public-enterprise":l?"public-personal":o?"public-password":"public":l?"private-personal":"private",u.default.createElement("div",{className:"scw"},(0,m.default)(c).when("private",function(){return u.default.createElement(f.default,{onStateChange:a})}).when("private-personal",function(){return u.default.createElement(f.default,{personal:l,onStateChange:a})}).when("public",function(){return u.default.createElement(p.default,{readOnly:n,onStateChange:a})}).when("public-password",function(){return u.default.createElement(p.default,{isPasswordProtected:!0,password:i,readOnly:n,onStateChange:a,onPasswordChange:s})}).when("public-enterprise",function(){return u.default.createElement(p.default,{enterprise:!0,readOnly:n,onStateChange:a})}).when("public-enterprise-password",function(){return u.default.createElement(p.default,{enterprise:!0,isPasswordProtected:!0,password:i,readOnly:n,onStateChange:a,onPasswordChange:s})}).when("public-personal",function(){return u.default.createElement(p.default,{personal:!0,readOnly:n,onStateChange:a,isPasswordProtected:o,password:i})}).done())}}]),t}(l.Component);v.defaultProps={isEnableShare:!1,readOnly:!1,isEnterprise:!1,isPasswordProtected:!1,password:null},v.propTypes={isEnableShare:l.PropTypes.bool,readOnly:l.PropTypes.bool,isEnterprise:l.PropTypes.bool,isPasswordProtected:l.PropTypes.bool,password:u.default.PropTypes.oneOfType([u.default.PropTypes.string,null]),onShareStateChange:l.PropTypes.func,onPasswordChange:l.PropTypes.func},t.default=v,e.exports=t.default},function(e,t){},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l);n(790);var c=n(443),f=r(c),d=n(444),p=r(d),h="shimo-share-new-feature-has-presented",m=function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={isPersonalNotPresented:!window.localStorage.getItem(h)},e.onModeClick=e.onModeClick.bind(e),e}return a(t,e),s(t,[{key:"componentDidUpdate",value:function(){window.localStorage.getItem(h)||window.localStorage.setItem(h,"1")}},{key:"onModeClick",value:function(e,t){var n=this;return function(r){r.preventDefault(),"function"==typeof n.props.onStateChange&&n.props.onStateChange(e,t)}}},{key:"nothing",value:function(e){e.preventDefault()}},{key:"render",value:function(){var e=this.props.personal,t=this.state.isPersonalNotPresented,n=(0,p.default)("cow","currentFile","shareMode")&&cow.currentFile.shareMode.match(/editable/)?"editable":"readonly";return u.default.createElement("div",{className:"private-content"},u.default.createElement("a",{className:"option",href:"#",onClick:this.onModeClick(n,!1)},u.default.createElement("div",{className:"icon public"},u.default.createElement("div",{className:"glyph glyph-public"})),u.default.createElement("div",{className:"text"},u.default.createElement("div",{className:"title"},"公开链接分享"),u.default.createElement("div",{className:"descr"},"有链接的人可以访问"))),u.default.createElement("a",{className:e?"option disabled":"option",href:"#",onClick:e?this.nothing:this.onModeClick(n,!0)},u.default.createElement("div",{className:"icon password"},u.default.createElement("div",{className:"glyph glyph-password"}),(0,f.default)(!e&&t).when(!0,function(){return u.default.createElement("div",{className:"flag feature-new"},"新功能")}).done(),(0,f.default)(e).when(!0,function(){return u.default.createElement("div",{className:"flag feature-enterprise"},"企业版功能")}).done()),u.default.createElement("div",{className:"text"},u.default.createElement("div",{className:"title"},"密码链接分享"),u.default.createElement("div",{className:"descr"},"有密码和链接的人可以访问"))),u.default.createElement("a",{className:e?"option disabled":"option",href:"#",onClick:e?this.nothing:this.onModeClick("enterprise_"+n,!1)},u.default.createElement("div",{className:"icon enterprise"},u.default.createElement("div",{className:"glyph glyph-enterprise"}),(0,f.default)(e).when(!0,function(){return u.default.createElement("div",{className:"flag feature-enterprise"},"企业版功能")}).done()),u.default.createElement("div",{className:"text"},u.default.createElement("div",{className:"title"},"仅企业内部共享"),u.default.createElement("div",{className:"descr"},"所有企业成员可以访问"))),u.default.createElement("a",{className:e?"option disabled":"option",href:"#",onClick:e?this.nothing:this.onModeClick("enterprise_"+n,!0)},u.default.createElement("div",{className:"icon enterprise-password"},u.default.createElement("div",{className:"glyph glyph-enterprise-password"}),(0,f.default)(e).when(!0,function(){return u.default.createElement("div",{className:"flag feature-enterprise"},"企业版功能")}).done()),u.default.createElement("div",{className:"text"},u.default.createElement("div",{className:"title"},"仅企业内部加密共享"),u.default.createElement("div",{className:"descr"},"所有企业成员可以通过密码访问"))),u.default.createElement("hr",{className:"separator"}),u.default.createElement("a",{className:"option",href:"#",onClick:this.onModeClick("private",!1)},u.default.createElement("div",{className:"icon private"},u.default.createElement("div",{className:"glyph glyph-private"})),u.default.createElement("div",{className:"text"},u.default.createElement("div",{className:"title"},"私有文档"),u.default.createElement("div",{className:"descr"},"只有协作者可以访问"),u.default.createElement("div",{className:"glyph glyph-checker"}))))}}]),t}(l.Component);m.defaultProps={personal:!1},m.propTypes={personal:u.default.PropTypes.bool,onStateChange:u.default.PropTypes.func},t.default=m,e.exports=t.default},function(e,t){},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l);n(792);var c=n(443),f=r(c),d=n(327),p=r(d),h=n(5),m=r(h),g=n(793),_=r(g),v=function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={isPriorityListVisible:!1},e.onReadonlyVisibleChange=e.onReadonlyVisibleChange.bind(e),e.onModeChange=e.onModeChange.bind(e),e.onPasswordProtectedChange=e.onPasswordProtectedChange.bind(e),e.onEnterpriseChange=e.onEnterpriseChange.bind(e),e.onPasswordChange=e.onPasswordChange.bind(e),e}return a(t,e),s(t,[{key:"componentDidMount",value:function(){document.documentElement.addEventListener("click",this.onReadonlyVisibleChange),this.initCopy()}},{key:"componentDidUpdate",value:function(){this.initCopy()}},{key:"componentWillUnmount",value:function(){document.documentElement.removeEventListener("click",this.onReadonlyVisibleChange)}},{key:"initCopy",value:function(){var e=new p.default(this.refs.copy);e.on("success",function(){m.default.alert({title:"复制成功！",delay:1500})}),e.on("error",function(){m.default.alert({title:"复制失败！",delay:1500,type:"error"})})}},{key:"onReadonlyVisibleChange",value:function(e){var t=this;setTimeout(function(){e.target===t.refs["priority-content"]?t.setState({isPriorityListVisible:!t.state.isPriorityListVisible}):t.setState({isPriorityListVisible:!1})},0)}},{key:"onModeChange",value:function(e,t){var n=this;return function(r){r.preventDefault();var o=n.props.onStateChange;"function"==typeof o&&o(e,t)}}},{key:"onPasswordProtectedChange",value:function(e){var t=this;return function(n){var r=t.props.onStateChange;"function"==typeof r&&r(e,n)}}},{key:"onPasswordChange",value:function(e){e.preventDefault();var t=this.props.onPasswordChange;"function"==typeof t&&t()}},{key:"onEnterpriseChange",value:function(e){var t=this;return function(n,r){var o=function(e){return"enterprise_"+e.replace("enterprise_","")},i=function(e){return e.replace("enterprise_","")};"function"==typeof t.props.onStateChange&&t.props.onStateChange(n?o(e):i(e),t.props.isPasswordProtected,r)}}},{key:"generateMode",value:function(e,t){return e?t?"enterprise_readonly":"enterprise_editable":t?"readonly":"editable"}},{key:"render",value:function(){var e=this.state.isPriorityListVisible,t=this.props,n=t.isPasswordProtected,r=t.enterprise,o=t.personal,i=t.readOnly,a=t.password,s=this.generateMode(r,i);return u.default.createElement("div",{className:"public-content"},u.default.createElement("div",{className:"content-header"},function(){return n&&r?u.default.createElement("div",{className:"icon enterprise-password"},u.default.createElement("div",{className:"glyph glyph-enterprise-password"})):n?u.default.createElement("div",{className:"icon password"},u.default.createElement("div",{className:"glyph glyph-password"})):r?u.default.createElement("div",{className:"icon enterprise"},u.default.createElement("div",{className:"glyph glyph-enterprise"})):u.default.createElement("div",{className:"icon public"},u.default.createElement("div",{className:"glyph glyph-public"}))}(),function(){return n&&r?u.default.createElement("div",{className:"text"},u.default.createElement("div",{className:"title"},"仅企业内部加密共享"),u.default.createElement("div",{className:"descr"},"所有企业成员可以通过密码访问")):n?u.default.createElement("div",{className:"text"},u.default.createElement("div",{className:"title"},"密码链接分享"),u.default.createElement("div",{className:"descr"},"有密码和链接的人可以访问")):r?u.default.createElement("div",{className:"text"},u.default.createElement("div",{className:"title"},"仅企业内部共享"),u.default.createElement("div",{className:"descr"},"所有企业成员可以访问")):u.default.createElement("div",{className:"text"},u.default.createElement("div",{className:"title"},"公开链接分享"),u.default.createElement("div",{className:"descr"},"有链接的人可以访问"))}(),u.default.createElement("div",{className:"priority"},u.default.createElement("div",{className:"priority-content",ref:"priority-content"},i?"只能阅读":"可以编辑"),e?u.default.createElement("div",{className:"priority-list"},u.default.createElement("a",{href:"#",className:"priority-item",onClick:this.onModeChange(r?"enterprise_editable":"editable",n)},u.default.createElement("div",{className:"priority-title"},"可以编辑"),u.default.createElement("div",{className:"priority-descr"},"可以编辑、评论、分享文件")),u.default.createElement("a",{href:"#",className:"priority-item",onClick:this.onModeChange(r?"enterprise_readonly":"readonly",n)},u.default.createElement("div",{className:"priority-title"},"只能阅读"),u.default.createElement("div",{className:"priority-descr"},"不能编辑、评论、分享文件")),u.default.createElement("div",{className:"priority-separator"}),u.default.createElement("a",{href:"#",id:"priority-cancel-item",className:"priority-cancel-item",onClick:this.onModeChange("private",!1)},u.default.createElement("div",{className:"priority-title"},"取消共享"))):null)),u.default.createElement("div",{className:"copy-section"},u.default.createElement("div",{className:"copy-url"},u.default.createElement("input",{type:"text",readOnly:!0,className:"copy-input",value:location.href+"/「"+m.default.cutName(cow.currentFile.name,30)+"」"+(a?"访问密码 "+a:"")})),u.default.createElement("span",{className:"copy-button",ref:"copy","data-clipboard-action":"copy","data-clipboard-target":".copy-input"},"复制链接")),u.default.createElement("div",{className:"qrcode-section"},u.default.createElement("div",{className:"qrcode",style:{backgroundImage:"url("+m.default.getQrImageUrl(115,location.href)+")",backgroundPosition:"-7px -7px",backgroundSize:"115px 115px"}}),u.default.createElement("div",{className:"qrcode-text"},"扫一扫",u.default.createElement("br",null),"分享给朋友")),u.default.createElement("div",{className:"options-section"},u.default.createElement("div",{className:"checkbox-wrapper"},u.default.createElement(_.default,{disabled:o&&!n,checked:n,onChange:this.onPasswordProtectedChange(s)},(0,f.default)(o).when(!0,"需要密码才能访问（企业版功能）").when(!1,"需要密码才能访问").done())),u.default.createElement("div",{className:"checkbox-wrapper",style:{marginTop:10}},u.default.createElement(_.default,{disabled:o,checked:r,onChange:this.onEnterpriseChange(s)},(0,f.default)(o).when(!0,"仅企业内部共享（企业版功能）").when(!1,"仅企业内部共享").done())),n?u.default.createElement("div",{className:"password-section"},u.default.createElement("input",{type:"text",className:"password",value:a,readOnly:!0}),o?null:u.default.createElement("a",{href:"#",className:"change-password",onClick:this.onPasswordChange},"更换密码")):null,o&&!n?u.default.createElement("a",{href:"/company/register?from=share",target:"_blank",className:"try-enterprise-edition"},"免费试用企业版"):null))}}]),t}(l.Component);v.defaultProps={isPasswordProtected:!1,password:null,enterprise:!1,personal:!1,readOnly:!0},v.propTypes={isPasswordProtected:u.default.PropTypes.bool,password:u.default.PropTypes.oneOfType([u.default.PropTypes.string,null]),enterprise:u.default.PropTypes.bool,personal:u.default.PropTypes.bool,readOnly:u.default.PropTypes.bool,onStateChange:u.default.PropTypes.func,onPasswordChange:u.default.PropTypes.func},t.default=v,e.exports=t.default},function(e,t){},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onChange=n.onChange.bind(n),n}return a(t,e),s(t,[{key:"onChange",value:function(){this.props.disabled||"function"==typeof this.props.onChange&&this.props.onChange(!this.props.checked)}},{key:"render",value:function(){var e=this.props,t=e.disabled,n=e.checked,r=e.children;return u.default.createElement("div",{className:"checkbox"+(t?" disabled":"")+(n&&!t?" checked":""),onClick:this.onChange},u.default.createElement("div",{className:"checker"},u.default.createElement("div",{className:"glyph glyph-checkbox-checker"})),r)}}]),t}(l.Component);c.defaultProps={disabled:!1,checked:!1},c.propTypes={disabled:u.default.PropTypes.bool,checked:u.default.PropTypes.bool,onChange:u.default.PropTypes.func},t.default=c,e.exports=t.default},function(e,t){},function(e,t,n){"use strict";(function(r){function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=o(u),f=n(441),d=o(f),p=n(5),h=o(p),m=n(34),g=o(m),_=function(e){function t(){return i(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),l(t,[{key:"close",value:function(e){"export-dialog show"===e.target.className&&this.props.close()}},{key:"doExport",value:function(e){var t={title:r("#doc-title-input").val(),type:e,guid:window.cow.currentFile.guid};window.location.origin||(window.location.origin=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:""));var n=function(e,t){t=encodeURIComponent(decodeURIComponent(t));var n=document.createElement("a");if(n.href=location.origin+"/download/export?filename="+e,n.href+="&downloadAs="+t,n.download=t,!d.default.detectIE)return d.default.simulate(n,"click");window.location=n};h.default.alert({title:"正在导出…"}),g.default.get(location.origin+"/export",t,function(t){return n(t.data.filename,r("#doc-title-input").val()+"."+e)},function(){return h.default.alert({title:"下载出错，请重试。",type:"error"})}),this.props.close()}},{key:"render",value:function(){return c.default.createElement("div",{className:"export-dialog show",onClick:this.close.bind(this)},c.default.createElement("div",{className:"export-box"},c.default.createElement("div",{className:"export-header"},c.default.createElement("span",{className:"title"},"导出"),c.default.createElement("span",{className:"icon-close hicon",onClick:this.props.close})),c.default.createElement("div",{className:"export-content"},c.default.createElement("div",{className:"export-pdf"},c.default.createElement("span",{className:"export-sprite pdf",onClick:this.doExport.bind(this,"pdf")}),c.default.createElement("span",{className:"text"},"PDF")),c.default.createElement("div",{className:"export-word"},c.default.createElement("span",{className:"export-sprite docx",onClick:this.doExport.bind(this,"docx")}),c.default.createElement("span",{className:"text"},"Word")),c.default.createElement("div",{className:"export-jpg"},c.default.createElement("span",{className:"export-sprite jpg",onClick:this.doExport.bind(this,"jpg")}),c.default.createElement("span",{className:"text"},"JPG")),c.default.createElement("div",{className:"error-msg"}))))}}]),t}(u.Component);t.default=_,_.propTypes={close:c.default.PropTypes.func},e.exports=t.default}).call(t,n(2))},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(72),f=r(c),d=n(9),p=r(d);n(797);var h=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"_showHistory",value:function(){p.default.notify("history:toggle"),f.default.checkIsWelcomeFile()&&p.default.notify("guideTip:visible",{tag:"history",value:!1})}},{key:"render",value:function(){return u.default.createElement("div",{className:"history-icon",onClick:this._showHistory})}}]),t}(l.Component);t.default=h,e.exports=t.default},function(e,t){},function(e,t,n){"use strict";var r=n(215),o=n(799),i=n(7),a=n(29),s=r.createClass({displayName:"ReactTransitionGroup",propTypes:{component:r.PropTypes.any,childFactory:r.PropTypes.func},getDefaultProps:function(){return{component:"span",childFactory:a.thatReturnsArgument}},getInitialState:function(){return{children:o.getChildMapping(this.props.children)}},componentWillMount:function(){this.currentlyTransitioningKeys={},this.keysToEnter=[],this.keysToLeave=[]},componentDidMount:function(){var e=this.state.children;for(var t in e)e[t]&&this.performAppear(t)},componentWillReceiveProps:function(e){var t=o.getChildMapping(e.children),n=this.state.children;this.setState({children:o.mergeChildMappings(n,t)});var r;for(r in t){var i=n&&n.hasOwnProperty(r);!t[r]||i||this.currentlyTransitioningKeys[r]||this.keysToEnter.push(r)}for(r in n){var a=t&&t.hasOwnProperty(r);!n[r]||a||this.currentlyTransitioningKeys[r]||this.keysToLeave.push(r)}},componentDidUpdate:function(){var e=this.keysToEnter;this.keysToEnter=[],e.forEach(this.performEnter);var t=this.keysToLeave;this.keysToLeave=[],t.forEach(this.performLeave)},performAppear:function(e){this.currentlyTransitioningKeys[e]=!0;var t=this.refs[e];t.componentWillAppear?t.componentWillAppear(this._handleDoneAppearing.bind(this,e)):this._handleDoneAppearing(e)},_handleDoneAppearing:function(e){var t=this.refs[e];t.componentDidAppear&&t.componentDidAppear(),delete this.currentlyTransitioningKeys[e];var n=o.getChildMapping(this.props.children);n&&n.hasOwnProperty(e)||this.performLeave(e)},performEnter:function(e){this.currentlyTransitioningKeys[e]=!0;var t=this.refs[e];t.componentWillEnter?t.componentWillEnter(this._handleDoneEntering.bind(this,e)):this._handleDoneEntering(e)},_handleDoneEntering:function(e){var t=this.refs[e];t.componentDidEnter&&t.componentDidEnter(),delete this.currentlyTransitioningKeys[e];var n=o.getChildMapping(this.props.children);n&&n.hasOwnProperty(e)||this.performLeave(e)},performLeave:function(e){this.currentlyTransitioningKeys[e]=!0;var t=this.refs[e];t.componentWillLeave?t.componentWillLeave(this._handleDoneLeaving.bind(this,e)):this._handleDoneLeaving(e)},_handleDoneLeaving:function(e){var t=this.refs[e];t.componentDidLeave&&t.componentDidLeave(),delete this.currentlyTransitioningKeys[e];var n=o.getChildMapping(this.props.children);n&&n.hasOwnProperty(e)?this.performEnter(e):this.setState(function(t){var n=i({},t.children);return delete n[e],{children:n}})},render:function(){var e=[];for(var t in this.state.children){var n=this.state.children[t];n&&e.push(r.cloneElement(this.props.childFactory(n),{ref:t,key:t}))}return r.createElement(this.props.component,this.props,e)}});e.exports=s},function(e,t,n){"use strict";var r=n(316),o={getChildMapping:function(e){return e?r(e):e},mergeChildMappings:function(e,t){function n(n){return t.hasOwnProperty(n)?t[n]:e[n]}e=e||{},t=t||{};var r={},o=[];for(var i in e)t.hasOwnProperty(i)?o.length&&(r[i]=o,o=[]):o.push(i);var a,s={};for(var l in t){if(r.hasOwnProperty(l))for(a=0;a<r[l].length;a++){var u=r[l][a];s[r[l][a]]=n(u)}s[l]=n(l)}for(a=0;a<o.length;a++)s[o[a]]=n(o[a]);return s}};e.exports=o},function(e,t,n){"use strict";var r=n(215),o=n(195),i=n(801),a=n(802),s=n(317),l=17,u=r.createClass({displayName:"ReactCSSTransitionGroupChild",propTypes:{name:r.PropTypes.oneOfType([r.PropTypes.string,r.PropTypes.shape({enter:r.PropTypes.string,leave:r.PropTypes.string,active:r.PropTypes.string}),r.PropTypes.shape({enter:r.PropTypes.string,enterActive:r.PropTypes.string,leave:r.PropTypes.string,leaveActive:r.PropTypes.string,appear:r.PropTypes.string,appearActive:r.PropTypes.string})]).isRequired,appear:r.PropTypes.bool,enter:r.PropTypes.bool,leave:r.PropTypes.bool,appearTimeout:r.PropTypes.number,enterTimeout:r.PropTypes.number,leaveTimeout:r.PropTypes.number},transition:function(e,t,n){var r=o.findDOMNode(this);if(!r)return void(t&&t());var s=this.props.name[e]||this.props.name+"-"+e,l=this.props.name[e+"Active"]||s+"-active",u=null,c=function(e){e&&e.target!==r||(clearTimeout(u),i.removeClass(r,s),i.removeClass(r,l),a.removeEndEventListener(r,c),t&&t())};i.addClass(r,s),this.queueClass(l),n?(u=setTimeout(c,n),this.transitionTimeouts.push(u)):a.addEndEventListener(r,c)},queueClass:function(e){this.classNameQueue.push(e),this.timeout||(this.timeout=setTimeout(this.flushClassNameQueue,l))},flushClassNameQueue:function(){this.isMounted()&&this.classNameQueue.forEach(i.addClass.bind(i,o.findDOMNode(this))),this.classNameQueue.length=0,this.timeout=null},componentWillMount:function(){this.classNameQueue=[],this.transitionTimeouts=[]},componentWillUnmount:function(){this.timeout&&clearTimeout(this.timeout),this.transitionTimeouts.forEach(function(e){clearTimeout(e)})},componentWillAppear:function(e){this.props.appear?this.transition("appear",e,this.props.appearTimeout):e()},componentWillEnter:function(e){this.props.enter?this.transition("enter",e,this.props.enterTimeout):e()},componentWillLeave:function(e){this.props.leave?this.transition("leave",e,this.props.leaveTimeout):e()},render:function(){return s(this.props.children)}});e.exports=u},function(e,t,n){"use strict";function r(e,t){for(var n=e;n.parentNode;)n=n.parentNode;var r=n.querySelectorAll(t);return-1!==Array.prototype.indexOf.call(r,e)}var o=n(3),i={addClass:function(e,t){return/\s/.test(t)&&o(!1),t&&(e.classList?e.classList.add(t):i.hasClass(e,t)||(e.className=e.className+" "+t)),e},removeClass:function(e,t){return/\s/.test(t)&&o(!1),t&&(e.classList?e.classList.remove(t):i.hasClass(e,t)&&(e.className=e.className.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,""))),e},conditionClass:function(e,t,n){return(n?i.addClass:i.removeClass)(e,t)},hasClass:function(e,t){return/\s/.test(t)&&o(!1),e.classList?!!t&&e.classList.contains(t):(" "+e.className+" ").indexOf(" "+t+" ")>-1},matchesSelector:function(e,t){return(e.matches||e.webkitMatchesSelector||e.mozMatchesSelector||e.msMatchesSelector||function(t){return r(e,t)}).call(e,t)}};e.exports=i},function(e,t,n){"use strict";function r(){var e=document.createElement("div"),t=e.style;"AnimationEvent"in window||delete s.animationend.animation,"TransitionEvent"in window||delete s.transitionend.transition;for(var n in s){var r=s[n];for(var o in r)if(o in t){l.push(r[o]);break}}}function o(e,t,n){e.addEventListener(t,n,!1)}function i(e,t,n){e.removeEventListener(t,n,!1)}var a=n(12),s={transitionend:{transition:"transitionend",WebkitTransition:"webkitTransitionEnd",MozTransition:"mozTransitionEnd",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd"},animationend:{animation:"animationend",WebkitAnimation:"webkitAnimationEnd",MozAnimation:"mozAnimationEnd",OAnimation:"oAnimationEnd",msAnimation:"MSAnimationEnd"}},l=[];a.canUseDOM&&r();var u={addEndEventListener:function(e,t){if(0===l.length)return void window.setTimeout(t,0);l.forEach(function(n){o(e,n,t)})},removeEndEventListener:function(e,t){0!==l.length&&l.forEach(function(n){i(e,n,t)})}};e.exports=u},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var n=(0,u.qsa)(e)[0],r=t.currentUser;n&&(0,l.render)(s.default.createElement(f.default,{currentUser:r}),n)}function i(e){var t=(0,u.qsa)(e)[0];t&&(0,l.unmountComponentAtNode)(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.mount=o,t.unmount=i;var a=n(0),s=r(a),l=n(13),u=n(87),c=n(330),f=r(c);t.default=f.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=document.querySelector(e);t&&(0,l.render)(s.default.createElement(c.default,{onlyUnread:!0}),t)}function i(e){var t=document.querySelector(e);t&&(0,l.unmountComponentAtNode)(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.mount=o,t.unmount=i,n(805);var a=n(0),s=r(a),l=n(13),u=n(806),c=r(u);t.default=c.default},function(e,t){},function(e,t,n){(function(r){function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=o(u),f=(n(1),n(275)),d=o(f),p=n(807),h=o(p),m=n(22),g=n(337),_=o(g),v=n(581),y=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleVisibleChange=n.handleVisibleChange.bind(n),n.hideGuideTip=n.hideGuideTip.bind(n),n.state={visible:!1,unpeaked:0,guideTipVisible:!1},n}return s(t,e),l(t,null,[{key:"propTypes",get:function(){return{messages:u.PropTypes.array}}},{key:"defaultProps",get:function(){return{messages:[]}}}]),l(t,[{key:"componentDidMount",value:function(){var e=this;this.getMessageCount(),this.interval=setInterval(function(){return e.getMessageCount()},6e4)}},{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"showGuideTip",value:function(){location.href.match(/from=tutorial/)&&this.setState({guideTipVisible:!0,positionNodeElement:document.getElementsByClassName("message-popover-trigger")[0]})}},{key:"hideGuideTip",value:function(){location.href.match(/from=tutorial/)&&this.setState({guideTipVisible:!1},function(){return r("/desktop")})}},{key:"getMessageCount",value:function(){var e=this;(0,m.ajaxGet)("/smapi/notifications/unpeeked_count").then(function(t){e.setState({unpeaked:t.data||0})})}},{key:"handleVisibleChange",value:function(e){!0===e&&(0,v.track)("click","message","popup"),this.setState({visible:e,unpeaked:0})}},{key:"renderContent",value:function(){return c.default.createElement(h.default,null)}},{key:"renderBadge",value:function(){var e=this.state.unpeaked>99?"99+":this.state.unpeaked;return c.default.createElement("span",{className:"badge"},c.default.createElement("em",null,e))}},{key:"render",value:function(){return c.default.createElement(d.default,{arrowPointAtCenter:!0,destroyTooltipOnHide:!0,align:{offset:[60,3]},overlayClassName:"message-popover",visible:this.state.visible,onVisibleChange:this.handleVisibleChange,content:this.renderContent()},c.default.createElement("div",{className:"message-popover-trigger",onClick:this.hideGuideTip},c.default.createElement("div",{className:"icon icon-message"},this.state.unpeaked>0&&this.renderBadge()),c.default.createElement(_.default,{text:"来自 石墨文档 的新消息",placement:"bottomRight",colorName:"blue",hasBubble:!1,offsetLeft:10,offsetTop:20,visible:this.state.guideTipVisible,positionNodeElement:this.state.positionNodeElement})))}}]),t}(u.Component);t.default=y,e.exports=t.default}).call(t,n(23))},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(20),f=r(c),d=n(22),p=n(610),h=n(808),m=r(h),g=n(581),_=function(e,t){var n="/smapi/notifications?action=peek&status="+e;return t&&(n+="&lt="+t),(0,d.ajaxGet)(n).then(function(e){return e.data})},v=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleFilterClick=n.handleFilterClick.bind(n),n.handleReadAllClick=n.handleReadAllClick.bind(n),n.handleLoadMore=n.handleLoadMore.bind(n),n.readMessage=n.readMessage.bind(n),n.joinTeam=n.joinTeam.bind(n),n.state={loaded:!1,unread:0,filter:"all",hasMore:!0,messages:[]},n}return a(t,e),s(t,[{key:"componentDidMount",value:function(){this.getMessages(),this.getMessageCount()}},{key:"handleFilterClick",value:function(e){var t=this;if((0,g.track)("click","message",e.target.className),"span"===e.target.tagName.toLowerCase()){var n=e.target.className;this.setState({filter:n,loaded:!1,messages:[]},function(){t.getMessages()})}}},{key:"handleReadAllClick",value:function(){var e=this;(0,g.track)("click","message","read_all"),(0,d.ajaxPost)("/smapi/notifications/action/read_all",{}).then(function(){var t=e.state.messages.map(function(e){return e.status="read",e});e.setState({unread:0,messages:t})})}},{key:"handleLoadMore",value:function(){var e=this,t=this.state.messages,n=t[t.length-1].id;return _(this.state.filter,n).then(function(n){var r=t;n.length>0&&(r=[].concat(r,n)),e.setState({hasMore:n.length>=20,messages:r})})}},{key:"getMessages",value:function(){var e=this;return _(this.state.filter).then(function(t){e.setState({messages:t,loaded:!0})})}},{key:"getMessageCount",value:function(){var e=this;return(0,d.ajaxGet)("/smapi/notifications/unread_count").then(function(t){e.setState({unread:t.data||0})})}},{key:"readMessage",value:function(e){var t=this;return(0,d.ajaxPatch)("/smapi/notifications/"+e+"?status=read").then(function(){var e=t.state.unread-1;e<=0&&(e=0),t.setState({unread:e})})}},{key:"joinTeam",value:function(e){return(0,d.ajaxPost)("/smapi/users/me/action/join_team_by_invitation",{teamId:e})}},{key:"renderMessageItems",value:function(){var e=this,t="all"===this.state.filter?"没有通知":"没有未读通知",n=this.state.messages;return 0===n.length?u.default.createElement("div",{className:"empty"},t):n.map(function(t){var n=(0,m.default)(t.notification.type);return u.default.createElement(n,{key:t.id,message:t,joinTeam:e.joinTeam,readMessage:e.readMessage})})}},{key:"render",value:function(){var e=(0,f.default)("filter",this.state.filter);return u.default.createElement("div",{className:"message-box"},u.default.createElement("div",{className:"panel"},u.default.createElement("div",{className:e,onClick:this.handleFilterClick},u.default.createElement("span",{className:"all"},"全部通知"),u.default.createElement("span",{className:"unread"},"未读 ("+this.state.unread+")")),u.default.createElement("div",{className:"btn btn-link",onClick:this.handleReadAllClick},"标记全部已读")),u.default.createElement(p.InfiniteScroll,{noMoreText:"没有更多通知了",key:this.state.filter,spinning:!this.state.loaded,hasMore:this.state.hasMore,loadMore:this.handleLoadMore},this.renderMessageItems()))}}]),t}(l.Component);t.default=v,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=document.createElement("div");return t.innerHTML=e,t.innerText.trim()}function i(e){return e.replace(/(<a\s+)/g,"@$1")}function a(e,t){var n=(0,m.get)(e,t);return n||("name"===t?"未知用户":"avatar"===t?"/static/unmd5/default-avatar-moke.png":"team.name"===t?"未知团队":void 0)}Object.defineProperty(t,"__esModule",{value:!0}),t.Member=t.Invitation=t.System=t.Team=t.Mention=t.Destroy=t.Teamwork=t.Comment=t.Default=void 0,t.washHTML=o,t.markMentionText=i,t.default=function(e){var t=d.default.TYPES[e];return g[t]||g.default};var s=n(0),l=r(s),u=n(20),c=r(u),f=n(809),d=r(f),p=n(270),h=r(p),m=n(1),g={};t.Default=g.default=function(e){return l.default.createElement("noscript",null)},t.Comment=g.comment=function(e){var t=e.message.notification,n=t.user,r=t.file;return l.default.createElement(d.default,e,l.default.createElement("img",{className:"message-icon",src:a(n,"avatar")}),l.default.createElement("div",{className:"message-title"},l.default.createElement(h.default,{size:8},a(n,"name")),l.default.createElement("span",null,"评论了"),l.default.createElement(h.default,{className:"file-name",size:20},r.name)),l.default.createElement(h.default,{className:"message-content",size:78},o(i(t.msg))))},t.Teamwork=g.teamwork=function(e){var t=e.message.notification,n=t.user,r=t.file,o=(0,c.default)("message-icon",r.type);return l.default.createElement(d.default,e,l.default.createElement("div",{className:o}),l.default.createElement("div",{className:"message-title"},l.default.createElement(h.default,{size:8},a(n,"name")),l.default.createElement("span",null,t.msg)),l.default.createElement(h.default,{className:"message-content",size:36},r&&r.name))},t.Destroy=g.destroy=function(e){var t=e.message.notification,n=t.user,r=t.file,o=(0,c.default)("message-icon",r.type);return l.default.createElement(d.default,e,l.default.createElement("div",{className:o}),l.default.createElement("div",{className:"message-title"},l.default.createElement(h.default,{size:8},a(n,"name")),l.default.createElement("span",null,t.msg)),l.default.createElement(h.default,{className:"message-content",size:36},r&&r.name))},t.Mention=g.mention=function(e){var t=e.message.notification,n=t.user,r=t.file;return l.default.createElement(d.default,e,l.default.createElement("img",{className:"message-icon",src:a(n,"avatar")}),l.default.createElement("div",{className:"message-title"},l.default.createElement(h.default,{size:8},a(n,"name")),l.default.createElement("span",null,t.msg)),l.default.createElement(h.default,{className:"message-content",size:36},r.name))},t.Team=g.team=function(e){var t=e.message.notification,n=t.user,r=(0,c.default)("message-icon","team");return l.default.createElement(d.default,e,l.default.createElement("div",{className:r}),l.default.createElement("div",{className:"message-title"},l.default.createElement(h.default,{size:8},a(n,"name")),l.default.createElement("span",null,t.msg)))},t.System=g.system=function(e){var t=e.message.notification,n=(0,c.default)("message-icon","system");return l.default.createElement(d.default,e,l.default.createElement("div",{className:n}),l.default.createElement("div",{className:"message-title"},l.default.createElement("span",null,t.msg),t.link&&l.default.createElement("span",{className:"link"},"了解更多")))},t.Invitation=g.invitation=function(e){var t=e.message.notification,n=t.user,r=(0,c.default)("message-icon","team");return l.default.createElement(d.default,e,l.default.createElement("div",{className:r}),l.default.createElement("div",{className:"message-title"},l.default.createElement(h.default,{size:8},a(n,"name")),l.default.createElement("span",null,t.msg),l.default.createElement(h.default,{className:"team-name"},a(n,"team.name"))))},t.Member=g.member=function(e){var t=e.message.notification,n=t.user;t.file;return l.default.createElement(d.default,e,l.default.createElement("img",{className:"message-icon",src:a(n,"avatar")}),l.default.createElement("div",{className:"message-title"},l.default.createElement(h.default,{size:8},a(n,"name")),l.default.createElement("span",null,t.msg)))}},function(e,t,n){(function(r){function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=o(u),f=n(20),d=o(f),p=n(270),h=n(5),m=o(h),g={0:"comment",1:"mention",2:"teamwork",3:"team",4:"invitation",5:"member",6:"destroy",20:"system"},_=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleClick=n.handleClick.bind(n),n.state={status:e.message.status},n}return s(t,e),l(t,null,[{key:"propTypes",get:function(){return{message:u.PropTypes.object,readMessage:u.PropTypes.func,joinTeam:u.PropTypes.func}}}]),l(t,[{key:"componentWillReceiveProps",value:function(e){"read"===e.message.status&&this.setState({status:"read"})}},{key:"handleClick",value:function(e){var t=this.props.message,n=t.notification;"read"!==t.status&&this.readMessage(this.props.message.id);var o=n.link,i=n.file,a=i&&i.type,s=o;o&&a&&("document"===a?s="/doc"+s:"spreadsheet"!==a&&"sheet"!==a||(s="/"+(a+s))),"mark-read"!==e.target.className&&r(s)}},{key:"readMessage",value:function(e){var t=this,n=this.state.status;this.setState({status:"read"}),this.props.readMessage(e).catch(function(e){t.setState({status:n})})}},{key:"renderExtra",value:function(){var e=this,t=this.props.message.notification.user.team.id,n=cow.currentUser.teamId===t,o=n?"已加入":"加入",i=(0,d.default)("btn",{"btn-ok":!n,"btn-disabled":n}),a=function(o){return o.preventDefault(),n?o.stopPropagation():cow.currentUser.teamId?m.default.alert({title:"请先退出当前企业",type:"error"}):e.props.joinTeam(t).then(function(e){if(e.code)return m.default.alert({title:e.message,type:"error"});r("/enterprise")})};return c.default.createElement("button",{className:i,onClick:a},o)}},{key:"render",value:function(){var e=this.props.message,t=e.notification,n=(e.status,(0,d.default)("message-item","type-"+g[t.type],{read:"read"===this.state.status,unread:"read"!==this.state.status}));return c.default.createElement("div",{className:n,onClick:this.handleClick},this.props.children,c.default.createElement("div",{className:"message-meta"},20===t.type&&c.default.createElement("span",{className:"offcial"},"系统通知・"),c.default.createElement(p.Timeago,null,t.createdAt)),c.default.createElement("div",{className:"message-extra"},4===t.type&&this.renderExtra()),c.default.createElement("div",{className:"mark-read"}))}}]),t}(u.Component);t.default=_,_.TYPES=g,e.exports=t.default}).call(t,n(23))},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=e.data,n=e.desktopNotification,r=window.cow,o=r.desktopNotification,a=r.currentUser,s=r.pageType,l=r.currentFile;o&&n&&t.notification.user.id!==a.id&&"doc"===s&&l.id===t.notification.file_id&&i(t.notification.file.name,t.notification.user.name+" "+(0,u.washHTML)((0,u.markMentionText)(t.notification.msg)),{icon:t.notification.user.avatar})}function i(e,t,n,r){var o=window,i=o.Notification;if(void 0===i)return!1;var s=function(){var o=new i(e,a({body:t},n));o.onclick=r,setTimeout(function(){return o.close()},6e3)};"granted"===i.permission?s():i.requestPermission().then(function(e){return"granted"===e&&s()})}Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};t.default=function(){l.default.bind("Notification_v2",o)};var s=n(33),l=r(s),u=n(727);e.exports=t.default},function(e,t,n){(function(r){function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(13),c=n(0),f=o(c),d=n(552),p=o(d),h=n(147),m=n(337),g=(o(m),n(9)),_=o(g),v=n(89),y=o(v),b=n(343),w=o(b);n(812);var C=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={withCookie:!1,sDate:null,eDate:null,visible:!1,text:"",link:"",recordTag:"",customize:null,openNewTab:!0},n.onCloseClick=n.onCloseClick.bind(n),n}return s(t,e),l(t,null,[{key:"propTypes",get:function(){return{currentUser:c.PropTypes.object}}}]),l(t,[{key:"componentDidMount",value:function(){this.initStatus()}},{key:"onCloseClick",value:function(){this.setState({visible:!1});var e=this.state,t=e.recordTag,n=e.withCookie,r=e.sDate,o=e.eDate;if(t)if("special"===t&&["renewal","expiration"].indexOf(p.default.accountTypeStatus)>-1)p.default.removeMembershipTip();else if(n){if(y.default.get(t))return;if(o){var i=r?Date.parse(r):Date.now(),a=Date.parse(o),s=Math.ceil((a-i)/864e5);y.default.set(t,!0,{expires:s})}else y.default.set(t,!0)}else p.default.removeTipAjax(t)}},{key:"filterNotification",value:function(e){var t=this;return h.notifications.length?r.maxBy(h.notifications.filter(function(n){if(!n.enable)return!1;var r=n.recordTag;if(n.withCookie&&y.default.get(r))return!1;if(n.startDate||n.endDate){var o=new Date(n.startDate),i=new Date(n.endDate),a=new Date;if(a<o||a>i)return!1}if(r&&e&&e[r])return!1;if(n.targetUser){var s=n.targetUser,l=t.props.currentUser,u=l.accountType;if(void 0!==s.personal){if(!s.personal&&["personal_free","personal_premium"].indexOf(u)>-1)return!1;if(s.personal&&-1===["personal_free","personal_premium"].indexOf(u))return!1}if(void 0!==s.isEnterprise&&s.isEnterprise&&["personal_free","personal_premium"].indexOf(u)>-1)return!1;if(void 0!==s.isEnterpriseOfficial){if(s.isEnterpriseOfficial&&(-1===l.accountType.indexOf("enterprise")||!l.isOfficial))return!1;if(!s.isEnterpriseOfficial&&l.accountType.indexOf("enterprise")>-1&&l.isOfficial)return!1}}return!0}),"order"):null}},{key:"initStatus",value:function(){var e=this,t=this.props.currentUser;"enterprise_dingtalk"!==t.accountType&&p.default.needToGuide()&&p.default.checkIsReady().then(function(n){var r=e.filterNotification(n);if(r)return void e.setState({withCookie:r.withCookie,sDate:r.sDate,eDate:r.eDate,text:r.text,recordTag:r.recordTag,link:r.targetLink,openNewTab:r.openNewTab,visible:!0,customize:r.customize});p.default.getMembershipInfo().then(function(){var r=t.accountType;if(t.accountTypeExpiredAt){var o=new Date(t.accountTypeExpiredAt),i=new Date;if(o<i)p.default.shouldNotifyExpiration&&(p.default.accountTypeStatus="expiration","enterprise_expired"!==r&&e.setState({text:"石墨个人高级版已到期，点此升级",link:"/payment",visible:!0,openNewTab:!0,recordTag:"special"}));else{var a=Math.ceil((o-i)/864e5);a<=7&&p.default.shouldNotifyRenewal&&(p.default.accountTypeStatus="renewal","personal_premium"===t.accountType?e.setState({text:"石墨个人高级版剩余"+a+"天，点此续费",link:"/payment",visible:!0,openNewTab:!0,recordTag:"special"}):"enterprise_standard"===t.accountType&&_.default.notify("enterprise-payment:renewal",o))}}else n.upgrade_pro?e.setState({visible:!1}):"personal_free"!==t.accountType?(e.setState({visible:!1}),p.default.removeTipAjax("upgrade_pro")):e.setState({text:"升级石墨账号",link:"/payment",visible:!0,openNewTab:!0,recordTag:"upgrade_pro"})})})}},{key:"customizedOnClick",value:function(e){var t=this;if("invite-friends"===e){var n=this.props.currentUser,r="invite-friends-modal-container";this.infModalContainer=document.getElementById(r),this.infModalContainer||(this.infModalContainer=document.createElement("div"),this.infModalContainer.id=r,document.body.appendChild(this.infModalContainer)),(0,u.render)(f.default.createElement(w.default,{onClose:function(){return(0,u.unmountComponentAtNode)(t.infModalContainer)},currentUser:n}),this.infModalContainer)}}},{key:"render",value:function(){var e=this,t=this.state,n=t.visible,r=t.text,o=t.link,i=t.openNewTab,a=t.customize;return n?a?f.default.createElement("div",{className:"header-notification-wrap"},f.default.createElement("span",{className:"header-notification-link",onClick:function(){return e.customizedOnClick(a)}},r),f.default.createElement("span",{className:"team-sprite header-item-icon header-notification-close",onClick:this.onCloseClick})):f.default.createElement("div",{className:"header-notification-wrap"},f.default.createElement("a",{className:"header-notification-link",href:o,target:i?"_blank":"",dangerouslySetInnerHTML:{__html:r}}),f.default.createElement("span",{className:"team-sprite header-item-icon header-notification-close",onClick:this.onCloseClick})):null}}]),t}(c.Component);t.default=C,e.exports=t.default}).call(t,n(1))},function(e,t){},function(e,t,n){(function(r,o){function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(0),f=i(c),d=n(814),p=i(d),h=n(616),m=i(h),g=n(72),_=i(g),v=n(5),y=i(v),b=n(256),w=i(b);n(816);var C=function(e){function t(e){a(this,t);var n=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state=t.initState,n.handleSearchEntryClick=n.handleSearchEntryClick.bind(n),n.handleSearchInputKeydown=n.handleSearchInputKeydown.bind(n),n.handleSearchInputKeyup=r.debounce(n.handleSearchInputKeyup.bind(n),300),n.handleResultItemHovered=n.handleResultItemHovered.bind(n),n.handleResultItemClick=n.handleResultItemClick.bind(n),n.handleSearchInputChange=n.handleSearchInputChange.bind(n),n.handleScrollEnd=n.handleScrollEnd.bind(n),n.handleClearClick=n.handleClearClick.bind(n),n.componentClick=n.componentClick.bind(n),n.search=n.search.bind(n),n}return l(t,e),u(t,null,[{key:"initState",get:function(){return{active:!1,results:[],page:0,keyword:"",lastKeyword:"",pageCount:0,selectedIndex:-1,count:0,dropdownVisible:!1}}}]),u(t,[{key:"componentClick",value:function(){this.clearAndReset()}},{key:"clearAndReset",value:function(e){this.setState(t.initState,function(){"function"==typeof e&&e()})}},{key:"handleSearchEntryClick",value:function(){var e=this;this.setState({active:!0},function(){setTimeout(function(){e.refs.searchInput.focus()},200)})}},{key:"handleSearchInputChange",value:function(e){this.setState({keyword:e.target.value})}},{key:"scrollToFixedPosition",value:function(e,t){var n=document.getElementsByClassName("search-result-item")[t];if(n){var r=n.getBoundingClientRect();if(e&&r.top<=100||!e&&r.top>=390){var o=document.getElementsByClassName("search-result-list")[0];o&&o&&(o.scrollTop=o.scrollTop+200*(e?-1:1))}}}},{key:"handleSearchInputKeydown",value:function(e){var t=e.keyCode,n=y.default.keyCodes,r=this.state,i=r.results,a=r.selectedIndex;if(t===n.UP)a>0&&this.setState({selectedIndex:this.state.selectedIndex-1}),this.scrollToFixedPosition(!0,this.state.selectedIndex);else if(t===n.DOWN)a<i.length-1&&this.setState({selectedIndex:a+1}),this.scrollToFixedPosition(!1,this.state.selectedIndex);else if(t===n.ENTER){var s=i[a];if(s){var l=s.source,u=l.type,c=l.guid,f="document"===u?"doc":u,d="/"+f+"/"+c;this.clearAndReset(function(){o(d)})}}[n.UP,n.DOWN,n.ENTER].indexOf(t)>-1&&(e.preventDefault(),e.stopPropagation())}},{key:"handleSearchInputKeyup",value:function(e){var t=this;if(!([y.default.keyCodes.UP,y.default.keyCodes.DOWN,y.default.keyCodes.ENTER].indexOf(e.keyCode)>-1)){var n=e.target.value.trim();n&&n!==this.state.lastKeyword?this.setState({lastKeyword:n,isLoading:!0,dropdownVisible:!0,page:0,count:0,pageCount:0},function(){t.search(n)}):n||n===this.state.lastKeyword||this.setState({lastKeyword:"",isLoading:!1,dropdownVisible:!1})}}},{key:"handleResultItemHovered",value:function(e){this.state.selectedIndex!==e&&this.setState({selectedIndex:e})}},{key:"handleResultItemClick",value:function(){this.clearAndReset()}},{key:"handleClearClick",value:function(){var e=this;this.setState(r.assign({},t.initState,{active:!0}),function(){e.refs.searchInput.focus()})}},{key:"search",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;_.default.searchFile(e,n,r).then(function(e){var n=e.page,r=e.pageCount,o=e.count,i=e.results;n>0&&(i=t.state.results.concat(i)),t.setState({page:n,results:i,pageCount:r,count:o,isLoading:!1})},function(){t.setState({results:[]})})}},{key:"searchNextPage",value:function(){var e=this,t=this.state,n=t.keyword,r=t.page,o=t.pageCount;!t.isLoading&&r+1<o&&this.setState({isLoading:!0},function(){setTimeout(function(){e.search(n,r+1)},1e3)})}},{key:"handleScrollEnd",value:function(){this.searchNextPage()}},{key:"renderEntryWithAnimation",value:function(){var e={verticalAlign:"middle"},t=this.state.active?[f.default.createElement("div",{key:0,className:"search-input-wrap"},f.default.createElement("span",{className:"search-input-icon"}),f.default.createElement("input",{ref:"searchInput",type:"text",placeholder:"输入文件名、文件内容搜索",className:"form-control header-search-input",value:this.state.keyword,onChange:this.handleSearchInputChange,onKeyDown:this.handleSearchInputKeydown,onKeyUp:this.handleSearchInputKeyup}),this.state.keyword?f.default.createElement("a",{className:"search-clear-icon",onClick:this.handleClearClick,href:"javascript:void(0);"}):null)]:[f.default.createElement("a",{key:1,className:"file-search-entry",onClick:this.handleSearchEntryClick,href:"javascript:void(0);"},f.default.createElement("span",{style:e,className:"header-search-icon"}),f.default.createElement("span",{style:e},"搜索"))];return f.default.createElement(m.default,{transitionName:"file-search",transitionAppearTimeout:100,transitionEnterTimeout:120,transitionLeaveTimeout:100,transitionAppear:!0},t)}},{key:"render",value:function(){var e=this.state.selectedIndex;return f.default.createElement("div",{className:"header-search-wrap"},this.renderEntryWithAnimation(),f.default.createElement(p.default,{selectedIndex:e,onScrollEnd:this.handleScrollEnd,isLoading:this.state.isLoading,visible:this.state.dropdownVisible,onItemHovered:this.handleResultItemHovered,onItemClick:this.handleResultItemClick,results:this.state.results}))}}]),t}(c.Component);t.default=(0,w.default)(C),e.exports=t.default}).call(t,n(1),n(23))},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(815),f=r(c),d=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onScroll=n.onScroll.bind(n),n}return a(t,e),s(t,null,[{key:"propTypes",get:function(){return{results:l.PropTypes.array,visible:l.PropTypes.bool,isLoading:l.PropTypes.bool,selectedIndex:l.PropTypes.number,onItemHovered:l.PropTypes.func,onItemClick:l.PropTypes.func,onScrollEnd:l.PropTypes.func}}}]),s(t,[{key:"onScroll",value:function(e){var t=this.props,n=t.isLoading,r=t.onScrollEnd,o=this.refs.resultList,i=o.scrollHeight-o.scrollTop-o.clientHeight;!n&&i<=0&&"function"==typeof r&&r(),e.stopPropagation(),e.preventDefault()}},{key:"renderResultItems",value:function(){var e=this.props,t=e.results,n=e.selectedIndex,r=e.onItemHovered,o=e.onItemClick;return t.map(function(e,t){var i=n===t;return u.default.createElement(f.default,{isSelected:i,onMouseOver:r,onClick:o,key:t,index:t,data:e})})}},{key:"render",value:function(){var e=this.props,t=e.results,n=e.visible,r=e.isLoading;return n?!r&&t&&0===t.length?u.default.createElement("div",{className:"search-result-wrap"},u.default.createElement("div",{className:"search-no-result"},u.default.createElement("span",null,"无搜索结果"))):u.default.createElement("div",{className:"search-result-wrap"},u.default.createElement("ul",{className:"scrollable search-result-list",ref:"resultList",onScroll:this.onScroll,style:{maxHeight:"437px"}},this.renderResultItems(),r?u.default.createElement("div",{className:"search-loading"},u.default.createElement("div",{className:"spinner"})):null)):null}}]),t}(l.Component);t.default=d,e.exports=t.default},function(e,t,n){(function(r){function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=o(u),f=n(20),d=o(f),p=n(148),h=o(p),m=n(270),g=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onMouseOver=n.onMouseOver.bind(n),n.onClick=n.onClick.bind(n),n}return s(t,e),l(t,null,[{key:"propTypes",get:function(){return{data:u.PropTypes.object,onMouseOver:u.PropTypes.func,index:u.PropTypes.number,isSelected:u.PropTypes.bool,onClick:u.PropTypes.func}}}]),l(t,[{key:"onMouseOver",value:function(){var e=this.props.onMouseOver;"function"==typeof e&&e(this.props.index)}},{key:"onClick",value:function(){var e=this.props,t=e.data,n=e.onClick,o=t.source,i=o.type,a=o.guid,s="/"+("document"===i?"doc":i)+"/"+a;"function"==typeof n&&n(),r(s)}},{key:"getName",value:function(){var e=this.props.data.source.name,t=this.props.data.highlight.name,n="";return t&&t[0]?n=t[0]:e&&e[0]&&(n=e[0]),(0,h.default)(n)}},{key:"getInnerContent",value:function(){var e=this.props.data,t=e.source.type,n=e.highlight.content,r="";"sheet"===t||"spreadsheet"===t?r="<i>表格</i>":"document"!==t&&"newdoc"!==t||(r=n&&n[0]?n[0]:"<i>空</i>");try{r=(0,h.default)(decodeURI(r))}catch(e){r=(0,h.default)(r)}return r}},{key:"render",value:function(){var e=this.props,t=e.isSelected,n=e.data,r=n.source,o=r.updated_at,i=r.starred,a=r.type,s=a;"document"===a||"newdoc"===a?s="doc":"sheet"===a&&(s="spreadsheet");var l=this.getName(),u=(0,d.default)({"search-result-item":!0,active:t,folder:"folder"===a,file:"folder"!==a});if(!l)return null;var f=this.getInnerContent();return c.default.createElement("li",{className:u,onClick:this.onClick,onMouseOver:this.onMouseOver},c.default.createElement("div",{className:"search-result-info"},c.default.createElement("span",{className:"search-list-icon "+s}),c.default.createElement("span",{className:"search-result-title",dangerouslySetInnerHTML:{__html:l}}),c.default.createElement("span",{className:"search-result-time"},c.default.createElement(m.Timeago,null,o)),i?c.default.createElement("span",{className:"search-star-icon"}):null),"folder"!==a?c.default.createElement("div",{className:"search-result-content"},c.default.createElement("span",{className:"search-result-content-text",dangerouslySetInnerHTML:{__html:f}})):null)}}]),t}(u.Component);t.default=g,e.exports=t.default}).call(t,n(23))},function(e,t){},function(e,t,n){(function(r,o){function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(0),f=i(c),d=n(671),p=i(d),h=n(582),m=i(h),g=n(818),_=i(g),v=n(33),y=i(v),b=n(9),w=i(b),C=n(20),S=i(C),x=n(5),T=i(x),E=n(72),M=n(337),A=i(M),k=n(21),R=function(e){function t(e){a(this,t);var n=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={tableTitle:e.currentFile.name,userId:e.currentUser.id,shareStatus:(0,k.getShareMode)(),starred:e.currentFile.starred,guideTipVisible:!1},n.onStarBtnClick=n.onStarBtnClick.bind(n),n.handleGuideTipVisibleChange=n.handleGuideTipVisibleChange.bind(n),n}return l(t,e),u(t,null,[{key:"propTypes",get:function(){return{currentFile:c.PropTypes.object,currentUser:c.PropTypes.object}}}]),u(t,[{key:"componentDidMount",value:function(){this.isUnmount=!1,this._init()}},{key:"componentWillUnmount",value:function(){this.isUnmount=!0,w.default.detach("guideTip:visible:desktop",this.handleGuideTipVisibleChange)}},{key:"handleGuideTipVisibleChange",value:function(e){var t=r.assign({},this.state);t.guideTipVisible=e,!this.state.guideTipVisible&&e&&(t.positionNodeElement=document.getElementsByClassName("header-back-up")[0]),this.setState(t)}},{key:"_onTitleChange",value:function(){}},{key:"_onTitleBlur",value:function(){var e=this.refs.tableName.getValue();e!==this.state.tableTitle&&(0,E.updateTitle)(e)}},{key:"_init",value:function(){var e=this;this._initPush(),(0,E.checkIsWelcomeFile)()&&(0,E.starFile)(window.cow.currentFile.id).then(function(){e.setState({starred:!0})})}},{key:"_initPush",value:function(){var e=this;y.default.bind("File",function(t){if(!e.isUnmount){var n=e.props,r=n.currentFile,o=n.currentUser;if(!(["spreadsheet","sheet","doc","newdoc"].indexOf(window.cow.pageType)<0)&&"update"===t.db_event&&+t.data.id==+r.id)if(0==+t.data.is_delete){var i=t.data.name;w.default.notify("file:updateTitle",i)}else 1==+t.data.is_delete&&+t.data.deleted_by!=+o.id&&e._backParent()}}),y.default.bind("StarredFile",function(t){if(!e.isUnmount){var n=e.props.currentFile;if(t.data.fileId===n.id){var r="create"===t.action;n.starred=r,e.setState({starred:r})}}}),w.default.detach("file:updateTitle",this._updateTitle),w.default.attach("file:updateTitle",this._updateTitle,{scope:this}),w.default.detach("guideTip:visible:desktop",this.handleGuideTipVisibleChange),w.default.attach("guideTip:visible:desktop",this.handleGuideTipVisibleChange)}},{key:"_updateTitle",value:function(e){this.setState({tableTitle:e}),this.props.currentFile.name=e,this.refs.tableName&&(document.title=e,this.refs.tableName.setValue(e))}},{key:"_backParent",value:function(){if(this._isBackFromSheet()){var e=(0,E.checkIsWelcomeFile)();if(e&&this.setState({guideTipVisible:!1}),e&&window.cow.authorized&&window.cow.currentUser&&!window.cow.currentUser.lastVisit)return void(window.location.href="/desktop?from=tutorial");var t=void 0,n=void 0;o.len>0?o.back():(t=this.props.currentFile,n=window.cow.authorized&&t.parent&&t.parent.guid?"/folder/"+t.parent.guid:"/desktop",o(n))}}},{key:"_isBackFromSheet",value:function(){var e=!0;return"sheet"===window.cow.pageType&&(window.cow.isEmptyQueue()||(e=!1,T.default.alert({title:"当前表格正在保存中，为防止数据丢失，请勿离开。",type:"error"}))),e}},{key:"onStarBtnClick",value:function(){var e=this,t=this.props.currentFile.id;this.state.starred?(0,E.unstarFile)(t).then(function(){e.setState({starred:!1})},function(e){T.default.alert({title:e.message,type:"error"})}):(0,E.starFile)(t).then(function(){e.setState({starred:!0})},function(e){T.default.alert({title:e.message,type:"error"})})}},{key:"renderStatusBar",value:function(){var e=this.props.currentFile,t=e.type,n=e.role,r=e.permissions,o=this.state.userId;return-1!==t&&-3!==t||n||r.editable?o>0?f.default.createElement(m.default,{customClassName:"s-header-time"}):0===t?f.default.createElement(m.default,{customClassName:"s-header-time"}):-1===t||-3===t?f.default.createElement(m.default,{customClassName:"writeable-sheet-status-bar s-header-time"}):void 0:null}},{key:"render",value:function(){var e=this,t=this.props.currentFile,n=[0,-1,-2,-3],r=t.type;if(n.indexOf(r)>-1){var o=(0,S.default)({"header-star-btn":!0,"s-header-star-btn":!0,active:this.state.starred}),i=(0,S.default)({"team-icon-sheet":-1===r||-3===r,"team-icon-doc":0===r||-2===r}),a=f.default.createElement("a",{className:o,onClick:this.onStarBtnClick},f.default.createElement("span",{className:"team-sprite team-icon-star mark-star-icon"}),f.default.createElement("span",{className:"s-tooltip"},this.state.starred?"取消标星":"标星"));if(this.state.userId>0)return f.default.createElement("div",{className:"s-header"},f.default.createElement("a",{className:"header-back-up",onClick:function(t){return e._backParent(t)}},f.default.createElement("span",{className:"header-back-icon"})),f.default.createElement("span",{className:"header-crumb-arrow little-icon-sprite"}),f.default.createElement("span",{className:"left-sheet-img team-sprite "+i}),f.default.createElement("span",{className:"s-header-text"},f.default.createElement(p.default,{customClass:"title-input",defaultValue:this.state.tableTitle?this.state.tableTitle:"无标题",placeholder:"无标题",maxWidth:"240px",autoWidth:!0,onBlur:function(t){return e._onTitleBlur(t)},onChange:function(t){return e._onTitleChange(t)},tooltip:"重命名",ref:"tableName"})),this.props.currentFile.authorized?f.default.createElement(_.default,{guid:this.props.currentFile.guid}):null,a,f.default.createElement(A.default,{text:"返回桌面",placement:"right",offsetLeft:12,offsetTop:12,visible:this.state.guideTipVisible,positionNodeElement:this.state.positionNodeElement}),this.renderStatusBar());var s=t.team,l=void 0;if(s&&s.resources&&(l=f.default.createElement("img",{className:"header-logo-img",src:s.resources.desktopLogo})),0===r)return f.default.createElement("div",{className:"s-header"},f.default.createElement("a",{href:"/",className:"home-link doc-logo "+(l?"":"logo-22")},l),this.renderStatusBar());if(-1===r||-3===r)return f.default.createElement("div",{className:"s-header"},f.default.createElement("div",{className:"s-home-link-wrap"},f.default.createElement("a",{className:"s-home-link "+(l?"custom-logo":""),href:"/"},l)),f.default.createElement("span",{className:"sheet-img-not-loggin left-sheet-img team-sprite team-icon-sheet"}),f.default.createElement("div",{className:"s-title"},window.cow.tempCurrentFile.name),this.renderStatusBar())}return f.default.createElement("a",{className:"header-logo logo-22",href:"/desktop"})}}]),t}(c.Component);t.default=R,e.exports=t.default}).call(t,n(1),n(23))},function(e,t,n){(function(r){function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=o(u),f=(n(22),n(216)),d=n(177),p=n(72),h=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={isLoading:!0,ancestors:[],active:!1},n}return s(t,e),l(t,[{key:"componentDidMount",value:function(){this._getAncestors(),this.handleOtherClick=this._otherClick.bind(this),(0,d.on)(document.getElementsByTagName("html")[0],"click",this.handleOtherClick)}},{key:"componentWillUnmount",value:function(){(0,d.off)(document.getElementsByTagName("html")[0],"click",this.handleOtherClick)}},{key:"_otherClick",value:function(e){void 0!==this.state.active&&this.state.active&&(e.target.className.match(/crumb-dropdown-btn/)||this.setState({active:!1}))}},{key:"_renderCrumbList",value:function(e){var t=this,n=[];if(this.state.isLoading)return c.default.createElement("div",{className:"crumb-loading"},c.default.createElement("img",{className:"crumb-loading-img",src:"https://assets-cdn.shimo.im/assets/images/loading-b67e5a67dc.gif"}));var r=[22,20,18,16];return e.forEach(function(e,o){var i=o>3?3:o,a=(0,f.cutLength)(e.name,r[i]),s=a===e.name?"":e.name;n.push(c.default.createElement("li",{key:o,className:"crumb-list-item",title:s,"data-href":e.link,"data-type":e.type,onClick:t._onCrumbListClick.bind(t)},c.default.createElement("a",{className:"crumb-list-link crumb-list-indent"+i,href:"javascript:void(0);"},c.default.createElement("span",{className:"little-icon-sprite crumb-list-icon crumb-"+e.type+"-icon"}),c.default.createElement("span",{className:"crumb-item-name"},a))))}),n}},{key:"_onCrumbListClick",value:function(e){var t=e.currentTarget,n=t.getAttribute("data-href");n&&r(n)}},{key:"_toggleDropdown",value:function(){this.setState({active:!this.state.active})}},{key:"_getAncestors",value:function(){var e=this,t=this.props.guid;this.setState({isLoading:!0}),(0,p.getAncestors)(t).then(function(t){e.setState({isLoading:!1,ancestors:t})})}},{key:"render",value:function(){var e=this.state.ancestors||[],t=this.state.active?"active":"";return c.default.createElement("div",{className:"crumb-wrap"},c.default.createElement("a",{className:"crumb-dropdown-btn little-icon-sprite",onClick:this._toggleDropdown.bind(this)}),c.default.createElement("ul",{className:"crumb-dropdown-wrap "+t},this._renderCrumbList(e)))}}]),t}(u.Component);t.default=h,h.propTypes={guid:u.PropTypes.string},e.exports=t.default}).call(t,n(23))},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(616),f=r(c),d=n(9),p=r(d),h=n(20),m=r(h),g=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={cooperators:[]},n}return a(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this;p.default.detach("cooperation:updateAvatar"),p.default.attach("cooperation:updateAvatar",function(t){e.setState({cooperators:[].concat(t)})})}},{key:"componentWillUnmount",value:function(){p.default.detach("cooperation:updateAvatar")}},{key:"renderAvatars",value:function(){var e=this.state.cooperators,t=[];return e.forEach(function(e,n){var r={zIndex:110-n-1,right:28*(n+1)+"px"};t.push(u.default.createElement("div",{key:e.id,className:"header-avatar",style:r},u.default.createElement("div",{className:"avatar-wrap"},u.default.createElement("img",{src:e.avatar,alt:e.name})),u.default.createElement("span",{className:"header-avatar-color",style:{backgroundColor:e.color}}),u.default.createElement("span",{className:"tooltip header-avatar-tooltip s-tooltip"},e.name)))}),t}},{key:"render",value:function(){var e=(0,m.default)({"header-avatar-wrap":!0,"header-avatar-wrap-anonymous":window.cow.currentUser.id<0,"header-avatar-wrap-unauthorized":!window.cow.authorized&&window.cow.currentUser.id>0});return u.default.createElement("div",{className:e},u.default.createElement(f.default,{transitionName:"header-avatar",transitionAppearTimeout:100,transitionEnterTimeout:1e3,transitionLeaveTimeout:300,transitionAppear:!0},this.renderAvatars()))}}]),t}(l.Component);t.default=g,e.exports=t.default},function(e,t,n){(function(r,o){function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(0),f=i(c),d=n(337),p=i(d),h=n(87),m=n(177),g=n(72),_=[{fileName:"示例 - 待办事项",targetElementSelector:'.editbar-list-item[data-key="checklist"]',offsetTop:3,offsetLeft:-7,needExpand:!1,expandElementSelector:"",text:"点这里，添加任务列表",autoHide:!1,hideTriggerElementSelectror:'.editbar-list-item[data-key="checklist"]'},{fileName:"示例 - 会议记录",targetElementSelector:"#upload-attachment",offsetTop:-7,offsetLeft:0,needExpand:!0,expandElementSelector:"#doc-insert",text:"点这里，插入附件",autoHide:!0,hideTriggerElementSelectror:""}],v=function(e){function t(){a(this,t);var e=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={guideTipVisible:!1,text:"",positionNodeElement:null},e.hideGuideTip=e.hideGuideTip.bind(e),e.handlePadReady=e.handlePadReady.bind(e),e}return l(t,e),u(t,[{key:"componentDidMount",value:function(){r(window).off("pad_ready",this.handlePadReady),r(window).on("pad_ready",this.handlePadReady)}},{key:"componentWillUpdate",value:function(e,t){var n=this.state;n.hideTriggerElementSelectror&&!t.hideTriggerElementSelectror?this.bindTriggerEvent(t):!n.hideTriggerElementSelectror&&t.hideTriggerElementSelectror?this.unbindTriggerEvent(n):n.hideTriggerElementSelectror!==t.hideTriggerElementSelectror&&(this.unbindTriggerEvent(n),this.bindTriggerEvent(t))}},{key:"componentWillUnmount",value:function(){r(window).off("pad_ready",this.handlePadReady),this.unbindTriggerEvent(this.state)}},{key:"bindTriggerEvent",value:function(e){if(e||(e=this.state),e.hideTriggerElementSelectror){var t=(0,h.qsa)(e.hideTriggerElementSelectror);t.length&&(0,m.on)(t[0],"click",this.hideGuideTip)}}},{key:"unbindTriggerEvent",value:function(e){if(e||(e=this.state),e.hideTriggerElementSelectror){var t=(0,h.qsa)(e.hideTriggerElementSelectror);t.length&&(0,m.off)(t[0],"click",this.hideGuideTip)}}},{key:"getGuideConfig",value:function(){return(0,g.checkIsExampleFile)()&&_.length?o.find(_,{fileName:window.cow.currentFile.name}):null}},{key:"handlePadReady",value:function(){var e=this;setTimeout(function(){var t=e.getGuideConfig();if(t){if(t.needExpand&&t.expandElementSelector){var n=(0,h.qsa)(t.expandElementSelector);n.length&&n[0].click()}if(t.targetElementSelector){var r=(0,h.qsa)(t.targetElementSelector);r.length&&e.setState({guideTipVisible:!0,positionNodeElement:r[0],text:t.text,hideTriggerElementSelectror:t.hideTriggerElementSelectror,autoHide:!!t.autoHide,offsetTop:o.isNumber(t.offsetTop)?t.offsetTop:0,offsetLeft:o.isNumber(t.offsetLeft)?t.offsetLeft:0},function(){e.bindTriggerEvent(e.state)})}}},2e3)}},{key:"hideGuideTip",value:function(){this.setState({guideTipVisible:!1})}},{key:"render",value:function(){var e=this.state,t=e.offsetLeft,n=e.offsetTop,r=e.autoHide,o=e.guideTipVisible,i=e.positionNodeElement,a=e.text;return f.default.createElement(p.default,{text:a,placement:"left",autoHide:r,offsetLeft:t,offsetTop:n,visible:o,onNeedHide:this.hideGuideTip,positionNodeElement:i})}}]),t}(c.Component);t.default=v,e.exports=t.default}).call(t,n(2),n(1))},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l);n(822);var c=n(408),f=r(c),d=n(22),p=function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.openLink=e.openLink.bind(e),e}return a(t,e),s(t,null,[{key:"propTypes",get:function(){return{mode:l.PropTypes.string}}},{key:"defaultProps",get:function(){return{mode:"list"}}}]),s(t,[{key:"clearUrlParam",value:function(e){var t=f.default.parse(e,!0);return delete t.search,delete t.query.corpid,delete t.query.dingtalkcode,f.default.format(t)}},{key:"openLink",value:function(){if(DingTalkPC&&DingTalkPC.checkIsReady){var e=this.clearUrlParam(window.location.href);DingTalkPC.checkIsReady(function(){DingTalkPC.runtime.permission.requestAuthCode({corpId:cow.signInfo.corpId,onSuccess:function(t){var n=t.code;DingTalkPC.biz.util.openLink({url:e+"?dingtalkcode="+n+"&corpid="+cow.signInfo.corpId})},onFail:function(e){console.error("requestAuthCode3",e),(0,d.ajaxPost)("/api/log/jserror",{msg:"dingtalk_requestAuthCode_3",url:window.location.href,error_code:e.errorCode,error_message:JSON.stringify(e)})}})})}}},{key:"render",value:function(){var e=this.props.mode;return u.default.createElement("a",{onClick:this.openLink,className:"dt-external-entry dt-mode-"+e},u.default.createElement("div",{className:"dt-external-tag"},"在浏览器中打开"))}}]),t}(l.Component);t.default=p,e.exports=t.default},function(e,t){},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(20),f=r(c),d=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleClick=n.handleClick.bind(n),n.reactive=n.reactive.bind(n),n.state={active:!0,activedChild:null},n}return a(t,e),s(t,null,[{key:"propTypes",get:function(){}}]),s(t,[{key:"handleClick",value:function(e){this.setState({active:!1,activedChild:e})}},{key:"reactive",value:function(){this.setState({active:!0,activedChild:null})}},{key:"render",value:function(){var e=this,t=u.default.Children.map(this.props.children,function(t){var n=t.props.name;return u.default.cloneElement(t,{key:n,actived:e.state.activedChild===n,onBtnClick:e.handleClick.bind(e,n),onClose:e.reactive})}),n=(0,f.default)("fixed-box",{active:this.state.active});return u.default.createElement("div",{className:n},t)}}]),t}(l.Component);t.default=d,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(578),f=r(c),d=n(1),p=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={unreadCount:0},n.onVisibleChange=n.onVisibleChange.bind(n),n.onUnreadChange=n.onUnreadChange.bind(n),n.onOfflineMessageChange=n.onOfflineMessageChange.bind(n),n}return a(t,e),s(t,null,[{key:"propTypes",get:function(){return{actived:l.PropTypes.bool,onClose:l.PropTypes.func,onBtnClick:l.PropTypes.func}}}]),s(t,[{key:"componentDidMount",value:function(){new f.default({trigger:"meiqia-btn",moduleType:this.getModuleType(),onVisibleChange:this.onVisibleChange,onUnreadChange:this.onUnreadChange,onOfflineMessageChange:this.onOfflineMessageChange,dataArgs:this.getUserInfo()})}},{key:"getUserInfo",value:function(){if(!cow.currentUser||cow.currentUser.id<0)return{};var e=window.cow.currentUser,t=new Date(e.created_at),n="",r=e.accountType;"personal_free"===r?n="基础免费":"personal_premium"===r?n="个人高级":"enterprise_dingding"===r?n="钉钉":"enterprise_standard"===r&&(n="企业");var o={};return e.team&&(o.enterpriseId=e.team.enterpriseId,o.enterprise=e.team.name,o.userRole=e.teamRole),(0,d.assign)({avatar:e.avatar,name:e.name,realName:e.name,isOfficial:e.isOfficial?"是":"否",registerAt:t.getFullYear()+"/"+(t.getMonth()+1)+"/"+t.getDate(),userType:n,email:e.email||"",mobile:e.mobile||"",userId:e.id},o)}},{key:"getModuleType",value:function(){var e=3;return cow.currentUser&&cow.currentUser.id>0&&cow.currentUser.isOfficial&&(e=4),e}},{key:"onVisibleChange",value:function(e){e?(this.props.onBtnClick(),this.state.unreadCount>0&&this.setState({unreadCount:0})):this.props.onClose()}},{key:"onUnreadChange",value:function(e){this.setState({unreadCount:e.data.length})}},{key:"onOfflineMessageChange",value:function(e){this.setState({unreadCount:e})}},{key:"render",value:function(){return u.default.createElement("div",null,u.default.createElement("div",{className:"fixed-button meiqia-btn"},"反馈"),u.default.createElement("div",{className:"meiqia-unread-msg"},u.default.createElement("span",{className:"meiqia-msg-count "+(0===this.state.unreadCount?"hide":"")},this.state.unreadCount),u.default.createElement("div",{className:"meiqia-msg-content hide"})))}}]),t}(l.Component);t.default=p,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(20),f=r(c),d=n(54),p=n(445),h=r(p),m=n(826),g=r(m),_=n(827),v=r(_),y=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=(0,p.getDefaultData)();return n.state={selectedGroup:r.groupTag,selectedItem:r.item.tag},n.tabDidChange=n.tabDidChange.bind(n),n.tabWillChange=n.tabWillChange.bind(n),n.handleListClick=n.handleListClick.bind(n),n}return a(t,e),s(t,null,[{key:"propTypes",get:function(){return{actived:l.PropTypes.bool,onBtnClick:l.PropTypes.func,onClose:l.PropTypes.func}}}]),s(t,[{key:"handleListClick",value:function(e,t){this.setState({selectedGroup:e,selectedItem:t})}},{key:"tabDidChange",value:function(){}},{key:"tabWillChange",value:function(e,t){var n=h.default[t];this.setState({selectedGroup:n.tag,selectedItem:n.items[0].tag})}},{key:"renderTabs",value:function(){return h.default.map(function(e){return u.default.createElement(d.TabItem,{key:e.tag,title:e.label})})}},{key:"render",value:function(){var e=this.state,t=e.selectedGroup,n=e.selectedItem,r=(0,p.getGroupIndex)(t),o=(0,f.default)("user-guide",{active:this.props.actived});return u.default.createElement("div",null,u.default.createElement("div",{className:"fixed-button",onClick:this.props.onBtnClick},"帮助"),u.default.createElement("div",{className:o},u.default.createElement("span",{className:"hicon icon-close",onClick:this.props.onClose}),u.default.createElement(d.Tab,{customClass:"sm-nav-tabs user-guide-nav-tabs large",disableSetWidth:!0,selectedIndex:r,tabWillChange:this.tabWillChange},this.renderTabs()),u.default.createElement("div",{className:"guide-content-wrapper"},u.default.createElement(g.default,{selectedGroup:t,selectedItem:n,onSelect:this.handleListClick}),u.default.createElement(v.default,{selectedGroup:t,selectedItem:n}))))}}]),t}(l.Component);t.default=y,e.exports=t.default},function(e,t,n){(function(r){function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=o(u),f=n(20),d=o(f),p=n(445),h=o(p),m=n(87),g=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.scrollTimer=-1,n.state={selectedItem:"assignTask",showFadeMask:!0},n.onScroll=r.debounce(n.onScroll.bind(n),100),n}return s(t,e),l(t,null,[{key:"propTypes",get:function(){return{groupData:u.PropTypes.array,selectedGroup:u.PropTypes.string,selectedItem:u.PropTypes.string,onSelect:u.PropTypes.func}}},{key:"defaultProps",get:function(){return{selectedGroup:"",onSelect:function(){}}}}]),l(t,[{key:"componentWillReceiveProps",value:function(e){var t=this;e.selectedGroup&&e.selectedGroup!==this.props.selectedGroup&&this.setState({selectedItem:(0,p.isIncludeGroup)(e.selectedItem,e.selectedGroup)?e.selectedItem:(0,p.getFirstTagInGroup)(e.selectedGroup)},function(){t.adjustScrollPosition()})}},{key:"adjustScrollPosition",value:function(){var e=this.state.selectedItem,t=this.props.selectedGroup,n=this.refs.listWrap,r=this.refs[t+"_"+e];if(n&&r){var o=n.getBoundingClientRect(),i=r.getBoundingClientRect(),a=i.bottom-o.bottom,s=o.top-i.top;a>=0?(0,m.scrollWithAnimation)(n,n.scrollTop+a+.67*o.height):s>=0&&(0,m.scrollWithAnimation)(n,n.scrollTop-s)}}},{key:"onClick",value:function(e,t){this.setState({selectedItem:t}),this.props.onSelect(e,t)}},{key:"onScroll",value:function(e){var t=e.target;t.scrollHeight-(t.scrollTop+t.clientHeight)<=10?this.state.showFadeMask&&this.setState({showFadeMask:!1}):this.state.showFadeMask||this.setState({showFadeMask:!0})}},{key:"render",value:function(){var e=this,t=this.state,n=t.selectedItem,r=t.showFadeMask,o=h.default.map(function(t){var r=t.items.map(function(r){var o=(0,d.default)({active:r.tag===n,"guide-list-item":!0});return c.default.createElement("li",{className:o,ref:t.tag+"_"+r.tag,key:r.tag,onClick:e.onClick.bind(e,t.tag,r.tag)},r.label)});return c.default.createElement("li",{className:"guide-group",ref:"group_"+t.tag,key:t.tag,"data-tag":t.tag},c.default.createElement("label",{className:"group-label"},t.label),c.default.createElement("ul",{className:"guide-group-list"},r))}),i=(0,d.default)({"guide-list-wrapper":!0,"scroll-bottom":!r});return c.default.createElement("div",{className:i},c.default.createElement("ul",{ref:"listWrap",onScroll:this.onScroll,className:"guide-list"},o))}}]),t}(u.Component);t.default=g,e.exports=t.default}).call(t,n(1))},function(e,t,n){(function(r){function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=o(u),f=n(445),d=function(e){function t(){i(this,t);var e=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={isLoaded:!1},e.onImageLoaded=e.onImageLoaded.bind(e),e.onImageClick=e.onImageClick.bind(e),e}return s(t,e),l(t,null,[{key:"propTypes",get:function(){return{selectedItem:u.PropTypes.string,selectedGroup:u.PropTypes.string}}}]),l(t,[{key:"onImageLoaded",value:function(){this.setState({isLoaded:!0})}},{key:"onImageClick",value:function(e){var t=e.target.src;t&&window.open(t)}},{key:"renderLoader",value:function(){return this.state.isLoaded?null:c.default.createElement("div",{className:"spinner"})}},{key:"render",value:function(){var e=this.props,t=e.selectedItem,n=e.selectedGroup,o=(0,f.getItemData)(n,t),i={};return this.state.isLoaded||r.assign(i,{opacity:.3,pointerEvents:"none"}),c.default.createElement("div",{className:"guide-content"},c.default.createElement("p",{className:"guide-desc",dangerouslySetInnerHTML:{__html:o.desc}}),c.default.createElement("img",{style:i,className:"guide-img",onLoad:this.onImageLoaded,onClick:this.onImageClick,src:o.img}),this.renderLoader())}}]),t}(u.Component);t.default=d,e.exports=t.default}).call(t,n(1))},,function(e,t,n){(function(t,r){e.exports=function(e){var o=n(0),i=n(13),a=n(544),s=n(268),l=s.Provider,u=n(842),c=n(1211),f=n(1212),d=n(709),p=n(534),h=n(33),m=n(5),g=n(579),_=n(702),v=n(582),y=n(1213),b=n(89),w=n(1214),C=n(21),S=n(910),x="sheet-header",T=e.isReadonly,E=e.isDingTalk,M=e.SpreadsheetContainer,A=e.guid,k=e.sheetId;k=e.sheetId||b.get(e.guid+":sheet"),a();var R,I=m.isMobile(),O=u.getInstance();c(O),S.getInst({store:O,guid:A}),T?(A=window.cow.currentSheetGuid=window.cow.tempCurrentFile.guid,t.stop()):window.cow.currentSheetGuid=A,p.setCurrentSheetId(k),R=O.dispatch(f.getSpreadsheet(A)),R.then(function(e){g.inc(),window.cow.authorized=e.authorized||e.role,window.cow.usingNewSeq&&w(O,d),window.cow.currentFile=e,document.title=e.name,I||T||_.sheet.show(),E&&!m.isDingtalkPcSidebar()&&i.render(o.createElement(v,null),document.getElementById("dingtalk-status-wrapper")),m.isDingtalkPcSidebar()&&i.render(o.createElement(l,{store:O},o.createElement(y,{isDingTalk:E,guid:A})),document.getElementById(x)),T||I&&i.render(o.createElement(l,{store:O},o.createElement(y,{isDingTalk:E,guid:A})),document.getElementById(x)),i.render(o.createElement(l,{store:O},o.createElement(M,{guid:A})),document.getElementById("sheet-view")),setTimeout(function(){if(g.done(),r("#sheet-view").addClass("ready"),r("#pad-loading").addClass("hide"),window.cow.authorized&&m.isMobile()&&!m.isDingtalk()){var e=C.getShareMode();r(".share-link").removeClass().addClass("share-link share-"+e)}},100),h.getConnectSocket().then(function(){O.dispatch(d.sendClientStatus("ready"))})}).catch(function(e){console.dir(e),setTimeout(function(){g.done(),m.alert({title:e?e.message:"加载出错"})},0)})}}).call(t,n(23),n(2))},,,,,function(e,t,n){(function(e,r){function o(e){return e&&e.__esModule?e:{default:e}}function i(e){var t=e.getSelections(),n=t.length;return n?x(e,t[n-1]):{row:0,col:0,rowCount:1,colCount:1}}function a(t,n){var r=[];return n=n||l(t),e.forEach(n,function(e){for(var t=e.row,n=e.col,o=e.rowCount,i=e.colCount,a=t,s=t+o-1;a<=s;a++)for(var l=n,u=n+i-1;l<=u;l++)r.push([a,l])}),r}function s(e){return new qe.CellRange(e,0,0,e.getRowCount(),e.getColumnCount())}function l(t){var n=t.getSelections(),r=[];return e.forEach(n,function(e){r.push(x(t,e))}),r}function u(t){var n=t.getSelections(),r=[];return e.forEach(n,function(e){var t=e.row,n=e.col,o=e.rowCount;if(-1===n)for(var i=t,a=t+o-1;i<=a;i++)r.push(i)}),r}function c(t){var n=t.getSelections(),r=[];return e.forEach(n,function(e){var t=e.row,n=e.col,o=e.colCount;if(-1===t)for(var i=n,a=n+o-1;i<=a;i++)r.push(i)}),r}function f(t){var n=[];return e.forEach(t,function(e){var t=e.row,r=e.col,o=e.rowCount,i=e.colCount;n.push(new qe.Range(t,r,o,i))}),n}function d(e){e._tab.disableNewTab=!0,e.sheets.forEach(function(e){return p(e)})}function p(e){e.options.isProtected=!0,Je&&(e.options.addReadonlyForMobile=!0)}function h(e){e.options.isProtected&&(e.options.isProtected=!1,Je&&(e.options.addReadonlyForMobile=!1))}function m(e){return{row:e.getActiveRowIndex(),col:e.getActiveColumnIndex()}}function g(t,n){var r=_(t.attrs||{}),o=[];return e.forEach(r,function(e){for(var r=Oe(e,2),i=r[0],a=r[1],s=v(t,i),l=0,u=n.length;l<u;l++){var c=n[l],f=c.row,d=c.col,p=c.rowCount,h=c.colCount;if(s&&s.ranges()&&s.intersects(f,d,p,h)){o.push(a);break}}}),o}function _(t){var n=[];return e.forIn(t,function(e,t){t.match(/condition-format-/)&&(e&&"string"==typeof e&&(e=JSON.parse(e)),n.push([t,e]))}),n}function v(e,t){for(var n=e.conditionalFormats,r=n._rules,o=void 0,i=0,a=r.length;i<a;i++){var s=r[i];if(s.name()===t){o=s;break}}return o}function y(t,n,r){k(function(){e.forEach(n,function(e){t.setRowHeight(e,r)})})()}function b(t,n,r){k(function(){e.forEach(n,function(e){t.setColumnWidth(e,r)})})()}function w(e,t){for(var n=t.row,r=t.col,o=t.rowCount,i=t.colCount,a=0,s=n,l=n+o-1;s<=l;s++)for(var u=r,c=r+i-1;u<=c&&(e.getValue(s,u)&&a++,!(a>1));u++);return a>1}function C(t){var n=t.getSelections(),r=!0;return e.forEach(n,function(e){if(-1!==e.col)return void(r=!1)}),n.length&&r}function S(t){var n=t.getSelections(),r=!0;return e.forEach(n,function(e){if(-1!==e.row)return void(r=!1)}),n.length&&r}function x(e,t){var n=e.getRowCount(),r=e.getColumnCount(),o=qe.CellRange,i=-1===t.row,a=-1===t.col;return i&&a?new o(e,0,0,n,r):i?new o(e,0,t.col,n,t.colCount):a?new o(e,t.row,0,t.rowCount,r):t}function T(e){var t=e.frozenRowCount(),n=e.getRowCount()-e.frozenTrailingRowCount()-t,r=t,o=0===n?r:r+n-1,i=e._getSheetLayout()._viewportHeight;return e._scrollTopRow===e._getTopRowWhenLastRowShowComplete(i,r,o)}function E(e,t,n){var r=e.getCellType(t,n),o=e._editor,i=null;if(r&&o){var a=e.getFormula(t,n,!0);if(a)i="="+a;else{var s=e.getActualStyle(t,n),l=e.getValue(t,n),u={sheet:e,row:t,col:n,sheetArea:3};i=r._formatEditorValue(o,s,l,u)}}return i}function M(e){for(var t=i(e),n=t.row,r=t.col,o=t.rowCount,a=t.colCount,s={},l=n,u=n+o-1;l<=u;l++)for(var c=r,f=r+a-1;c<=f;c++)s[l+"-"+c]=e._getCompositeStyle(l,c,3);return t.cellsObj=s,t}function A(e,t,n){function r(e,t){for(var n in t)t.hasOwnProperty(n)&&"_id"!==n&&(e[n]=t[n]);return e}for(var o=t.row,i=t.col,a=t.rowCount,s=t.colCount,l=t.cellsObj,u=n.row,c=n.col,f=n.rowCount,d=n.colCount,p=u,h=u+f-1;p<=h;p++)for(var m=c,g=c+d-1;m<=g;m++){var _=(p-u)%a+o+"-"+((m-c)%s+i),v=new qe.Style,y=r(v,l[_]);y.cellType=e.getCellType(p,m),e._setStyleWithoutLocked(p,m,y)}e.setSelection(u,c,f,d)}function k(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"sheet";return function(){var r=this[n];r.suspendPaint(),t&&r.suspendCalcService(),e.apply(this,arguments),t&&r.resumeCalcService(),r.resumePaint()}}function R(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"sheet";return function(){var n=this[t];n.suspendPaint(),n.suspendEvent(),n.suspendCalcService(),e.apply(this,arguments),n.resumeCalcService(),n.resumeEvent(),n.resumePaint()}}function I(t,n){var r=n||t.floatingObjects.all(),o=!1;return e.forEach(r,function(e){if(e.isSelected())return void(o=!0)}),o}function O(e,t,n){var r=e.frozenRowCount(),o=e.frozenColumnCount(),i=e.getViewportLeftColumn(1),a=e.getViewportRightColumn(1),s=e.getViewportTopRow(1),l=e.getViewportBottomRow(1),u=void 0,c=void 0;return(t<r||t>=s&&t<=l)&&(u=!0),(n<o||n>=i&&n<=a)&&(c=!0),u&&c}function D(e,t,n){for(var r=0,o=0,i=0;i<n;i++)r+=e.getColumnWidth(i);for(var a=0;a<t;a++)o+=e.getRowHeight(a);return{x:r,y:o}}function P(t){var n=t.pictures.all(),r=[];return e.forEach(n,function(e){e.isSelected()&&r.push(e)}),r}function N(e,t,n,o){var i=r("."+(o?We.HISTORY_VIEW_CLASSNAME:We.SHEET_VIEW_CLASSNAME)).offset(),a=i.left,s=i.top;return e.hitTest(t-a,n-s)}function F(e,t,n){var r=N(e,t,n),o=r.row,i=r.col,a=r.hitTestType,s=qe.SheetArea,l=s.rowHeader,u=s.colHeader,c=s.viewport,f=s.corner;B(e.getSelections(),o,i)||(a===f?j(e):a===l?H(e,o):a===u?V(e,i):a===c&&(e.clearSelection(),e.endEdit(),e.setActiveCell(o,i)))}function L(e,t){var n=t.row,r=t.col,o=t.rowCount,i=t.colCount;e.setSelection(n,r,o,i)}function H(e,t){e.setSelection(t,-1,1,e.getColumnCount())}function V(e,t){e.setSelection(-1,t,e.getRowCount(),1)}function j(e){e.setSelection(-1,-1,e.getRowCount(),e.getColumnCount())}function B(t,n,r){var o=!1;return e.forEach(t,function(e){if(e.contains(n,r))return void(o=!0)}),o}function U(t,n){var o=a(t,n),i=!0;return e.forEach(o,function(e){var n=Oe(e,2),o=n[0],a=n[1];if(r.trim(t.getValue(o,a)))return void(i=!1)}),i}function W(t,n){n=n||l(t);var r=a(t,n),o=!0;return e.forEach(r,function(e){var n=Oe(e,2),r=n[0],i=n[1],a=t.getValue(r,i),s=(0,Ye.getCellAttrs)(t,r,i);if(a||Object.keys(s).length)return void(o=!1)}),o}function z(t,n,r,o,i){function a(e,t,n,r,o,i,a,l){if(a.formula)return null;if(a.link)return Y(e,t,n);if(l)return s(e,t,n);var u=t-r,c=n-o,f=i&&i[u];return f&&f.length>c?f[c]:s(e,t,n)}function s(e,t,n){var r=e.getValue(t,n);return"object"===(void 0===r?"undefined":Ie(r))&&(r=e.getText(t,n)),r}var l=[],u=n.row,c=n.col;return e.forEach(r,function(n){var r=Oe(n,3),s=r[0],f=r[1],d=r[2],p=(0,Ye.getCellAttrs)(t,s,f);p=e.assign((0,ze.clearAttrs)(d.attrs),p);var h=a(t,s,f,u,c,o,p,i);l.push([s,f,d,{value:h,attrs:p}])}),l}function Y(e,t,n){var r=e.getCellType(t,n);return r&&r._value}function G(e,t,n){var r=e.getCellType(t,n);return(0,Ye.isLinkType)(r)}function K(e,t,n){var r=qe.CellRange;return"row"===n?new r(e,0,0,t,e.getColumnCount()):new r(e,0,0,e.getRowCount(),t)}function X(t,n){var r=m(t),o=r.row,i=r.col;if(!e.isNil(o)&&!e.isNil(i))return(0,Ye.getCellAttrs)(t,o,i)[n]}function q(t){var n=[],r=(0,Xe.getSheetAttrs)(t);return e.forIn(r,function(e,t){t.match(/lock-/)&&e&&n.push([t,e])}),n}function J(t,n){var r=q(t),o=[];return n=n||l(t),r.forEach(function(t){var r=t[1];e.find(n,function(t){return!!e.find(r.ranges,function(e){return re(t,e)})})&&o.push(t)}),o}function Z(e){return!(!(0,Xe.getSheetAttrs)(e,"lock")&&!te(e))}function Q(e,t){var n=e.options;n.isProtected=!t,Te(e),n.isLockedByUser=!1}function $(e){e.name(e.name())}function ee(e){return!!(0,Xe.getSheetAttrs)(e,"lock")}function te(t){return!!e.find(q(t),function(e){return e[1]})}function ne(e,t){var n=Oe(e,2),r=n[0],o=n[1],i=Oe(t,2),a=i[0],s=i[1],l=Math.max(o,s)-Math.min(r,a)+1,u=o-r+1+(s-a+1)-l;return u>0?u:0}function re(e,t){var n=e.row,r=e.col,o=e.rowCount,i=e.colCount,a=t.row,s=t.col;return n<a+t.rowCount&&a<n+o&&r<s+t.colCount&&s<r+i}function oe(e,t){var n=Oe(t,2),r=n[0],o=n[1],i=Pe.default.parsePosition,a=i(r),s=i(o),l=a.row,u=a.col,c=s.row,f=s.col;return new qe.CellRange(e,l,u,c-l+1,f-u+1)}function ie(e){var t=e.row,n=e.col,r=e.rowCount,o=e.colCount,i=Pe.default.stringifyPosition;return[i(t,n),i(t+r-1,n+o-1)]}function ae(e,t){return{row:e,col:t,rowCount:1,colCount:1}}function se(t,n){var r=t.guid();return!!e.find(n.sheets,function(e){return r===e.guid()})}function le(e){var t=500,n=500,r=e.width,o=e.height;return r>n&&(o=Math.round(n*o/r),r=n),o>t&&(r=Math.round(t*r/o),o=t),{width:r,height:o}}function ue(e,t,n,r){for(var o={},i=[],a="(空)",s=void 0,l=n,u=n+r;l<u;l++)s=e.getText(l,t),s=s?s.trim():s,""===s?o[a]||(i.push(a),o[a]=!0):o[s]||(i.push(s),o[s]=!0);return i}function ce(e,t){var n=void 0,o=void 0,i=void 0;t.target?(n=t.target,o=n.tagName.toLowerCase(),i=n.files[0]):i=t.file;var a=_e(i),s=Ze.fileSize||512e4,l=r.Deferred(),u=Qe;return s!==1/0&&i.size>s?("enterprise_dingding"===cow.currentUser.accountType&&(u.description="最大上传10M的图片/附件，购买<b>企业版</b>无此限制"),(0,Ue.default)(u)):(a.then(function(e){l.resolve(e)}).fail(function(e){l.reject(e)}).always(function(){n&&(n.value="","form"===o?n.reset():n.form.reset())}),l.promise())}function fe(e){var t=r.Deferred(),n=new Image;return n.onload=function(){t.resolve({url:e,img:n})},n.onerror=function(e){t.reject(e)},n.src=e,t.promise()}function de(t){var n=S(t),r=C(t),o=i(t),a=o.row,s=o.colCount,l=o.rowCount,u=0,c=t.filterRowsVisibleInfo.rowsVisibleInfo;return e.forEach(e.keys(c),function(e){(e=parseInt(e,10))>a&&e<a+l&&u++}),{colCount:r?1:s,rowCount:n?1:l-u}}function pe(t){var n=l(t)[0],r=t.getSpans(n)[0];return e.isEqual(n,r)}function he(e){return 0!==e.frozenRowCount()||0!==e.frozenColumnCount()}function me(e){var t=this.getAllSelections(e)[0],n=t.row,r=t.col;return e.getCellRect(n,r)}function ge(e){return e.rowFilter().range}function _e(e){var t=r.Deferred();return Ke.default.prepareUploadInfo().then(function(){var n=new He.default({accessToken:window.cow.accessToken});return n.getInfo({qs:{server:"qiniu",type:"images"},body:[e.name]}).then(function(r){var o=r[0];n.upload(e,o).then(function(e){return t.resolve(e)}).catch(function(e){return t.reject(e)})}).catch(function(e){return t.reject(e)})}).catch(function(e){t.reject(e)}),t.promise()}function ve(e,t){var n=[];e.ops.forEach(function(e){"object"!==Ie(e.data)||n.length||(n=Object.keys(e.data.cells.proto))});var r=we(n[0]),o=t.getViewportHeight(1),i=t.getViewportWidth(1);if(r){var a=r.row,s=r.col,l=t.getCellRect(a,s),u=l.x,c=l.y;(!u||!c||u>i||c>o)&&t.showCell(a,s,qe.VerticalPosition.center,qe.HorizontalPosition.center)}}function ye(t,n){return e.find(t.sheets,function(e){return e.guid()+""==n+""})}function be(e,t){var n=0;return t.sheets.forEach(function(t,r){t.guid()===e&&(n=r)}),n}function we(e){return"string"!=typeof e?null:Pe.default.parsePosition(e.toUpperCase())}function Ce(e){var t=[],n=[];Object.keys(e).forEach(function(e){var r=we(e),o=r.row,i=r.col;t.push(o),n.push(i)}),t.sort(function(e,t){return e-t}),n.sort(function(e,t){return e-t});var r=t[0],o=n[0];return{row:r,col:o,rowCount:t[t.length-1]-r+1,colCount:n[n.length-1]-o+1}}function Se(e){var t=qe.StorageType,n=t.style|t.data;try{e.clear(0,0,e.getRowCount(),e.getColumnCount(),qe.SheetArea.viewport,n)}catch(e){console.error("reset style error:"+e)}}function xe(e){e.getRange(0,0,e.getRowCount(),e.getColumnCount(),Fe.default.Spread.Sheets.SheetArea.viewport).locked(!1)}function Te(e){e.getRange(0,0,e.getRowCount(),e.getColumnCount(),Fe.default.Spread.Sheets.SheetArea.viewport).locked(!0)}function Ee(e,t,n){var r=t.row,o=t.col,i=t.rowCount,a=t.colCount;new qe.CellRange(e,r,o,i,a).locked(!n).tag(null)}function Me(e,t){var n=e.sheets.filter(function(e){return t!==e.zoom()});0!==n.length&&k(function(){n.forEach(function(e){e.zoom(t)})})()}function Ae(e,t){var n=t.row,r=t.col,o=t.rowCount,i=t.colCount;return e._getSpanModel().hasPartSpans(n,r,o,i)}function ke(t,n){return e.some(t,function(t){return t.sheetName===n.sheetName&&e.some(t.ranges,function(e){return e.containsRange(n.range)})})}function Re(t,n){return!e.isEqual(t,n)}Object.defineProperty(t,"__esModule",{value:!0});var Ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Oe=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.getCurSelection=i,t.getAllSelectedCellCoords=a,t.getSheetSelection=s,t.getAllSelections=l,t.getAllSelectedRows=u,t.getAllSelectedColumns=c,t.selectionsToRanges=f,t.protectSpread=d,t.protectSheet=p,t.unProtectSheet=h,t.getActiveCell=m,t.getConditionFormatsByRanges=g,t.getConditionFormatsFromAttrs=_,t.getConditionFormatByName=v,t.setMultiRowHeight=y,t.setMultiColumnWidth=b,t.isRangeHasMultiValues=w,t.isSelectedRows=C,t.isSelectedColumns=S,t.getActualCellRange=x,t.isVerticalScrollToBottom=T,t.getCellEditValue=E,t.getPaintInfo=M,t.doPaintCellsStyle=A,t.paintWrap=k,t.paintWrapAll=R,t.isFloatingObjectSelected=I,t.isCellVisible=O,t.getCellOffset=D,t.getActivePictures=P,t.getCellByOffset=N,t.selectedCellsByOffset=F,t.setSelection=L,t.selectRow=H,t.selectColumn=V,t.selectAll=j,t.isCellInSelections=B,t.isNullSelections=U,t.isEmptySelections=W,t.collabAndApplyPastedCellsValAttrs=z,t.getLinkText=Y,t.isCellLinkType=G,t.getCellRangeByRowOrCol=K,t.getActiveCellAttrByName=X,t.getSheetCellLocks=q,t.getSelectionsCellLocks=J,t.isSheetLocked=Z,t.resetSheetLocks=Q,t.repaintLockStyle=$,t.isWorksheetLocked=ee,t.hasCellLocks=te,t.getRangeIntersectCount=ne,t.isRangeIntersect=re,t.lockRange2CellRange=oe,t.cellRange2LockRange=ie,t.cell2Range=ae,t.isSheetExsit=se,t.getImageDefaultSize=le,t.getRowsText=ue,t.uploadImage=ce,t.verifyImg=fe,t.getSelectionCountForContextmenu=de,t.isMergedCell=pe,t.isSheetFrozened=he,t.getActiveCellPosition=me,t.getFilterRange=ge,t.scrollToCellByCS=ve,t.getSheetById=ye,t.getSheetIndexById=be,t.getCellCoordByPos=we,t.transformCellsToRange=Ce,t.resetSheetStyles=Se,t.unLockAllCells=xe,t.lockAllCells=Te,t.unLockCellsByRange=Ee,t.setSheetsZoom=Me,t.isSelectionCanNotBeMerged=Ae,t.isRangeContainsSelf=ke,t.isCellChanged=Re;var De=n(53),Pe=o(De),Ne=n(721),Fe=o(Ne),Le=n(266),He=o(Le),Ve=n(147),je=o(Ve),Be=n(146),Ue=o(Be),We=n(533),ze=n(253),Ye=n(909),Ge=n(5),Ke=o(Ge),Xe=n(926),qe=Fe.default.Spread.Sheets,Je=Ke.default.isMobile(),Ze=je.default.initLimition(),Qe={title:"达到上限",description:"最大上传10M的图片/附件，升级<b>石墨高级版</b>无此限制",buttons:[{type:"link-button",buttonLabel:"了解详情",href:"/payment",target:"_blank",customClass:"btn-ok",closeAfterClick:!0},{type:"button",buttonLabel:"取消",customClass:"",closeAfterClick:!0}]}}).call(t,n(1),n(2))},function(e,t,n){function r(e,t){t=o(t,e);for(var n=0,r=t.length;null!=e&&n<r;)e=e[i(t[n++])];return n&&n==r?e:void 0}var o=n(836),i=n(644);e.exports=r},function(e,t,n){function r(e,t){return o(e)?e:i(e,t)?[e]:a(s(e))}var o=n(261),i=n(715),a=n(976),s=n(979);e.exports=r},,,,function(e,t,n){var r;!function(o,i,a){function s(e,t,n){if(e.addEventListener)return void e.addEventListener(t,n,!1);e.attachEvent("on"+t,n)}function l(e){if("keypress"==e.type){var t=String.fromCharCode(e.which);return e.shiftKey||(t=t.toLowerCase()),t}return w[e.which]?w[e.which]:C[e.which]?C[e.which]:String.fromCharCode(e.which).toLowerCase()}function u(e,t){return e.sort().join(",")===t.sort().join(",")}function c(e){var t=[];return e.shiftKey&&t.push("shift"),e.altKey&&t.push("alt"),e.ctrlKey&&t.push("ctrl"),e.metaKey&&t.push("meta"),t}function f(e){if(e.preventDefault)return void e.preventDefault();e.returnValue=!1}function d(e){if(e.stopPropagation)return void e.stopPropagation();e.cancelBubble=!0}function p(e){return"shift"==e||"ctrl"==e||"alt"==e||"meta"==e}function h(){if(!b){b={};for(var e in w)e>95&&e<112||w.hasOwnProperty(e)&&(b[w[e]]=e)}return b}function m(e,t,n){return n||(n=h()[e]?"keydown":"keypress"),"keypress"==n&&t.length&&(n="keydown"),n}function g(e){return"+"===e?["+"]:(e=e.replace(/\+{2}/g,"+plus"),e.split("+"))}function _(e,t){var n,r,o,i=[];for(n=g(e),o=0;o<n.length;++o)r=n[o],x[r]&&(r=x[r]),t&&"keypress"!=t&&S[r]&&(r=S[r],i.push("shift")),p(r)&&i.push(r);return t=m(r,i,t),{key:r,modifiers:i,action:t}}function v(e,t){return null!==e&&e!==i&&(e===t||v(e.parentNode,t))}function y(e){function t(e){e=e||{};var t,n=!1;for(t in b)e[t]?n=!0:b[t]=0;n||(S=!1)}function n(e,t,n,r,o,i){var a,s,l=[],c=n.type;if(!g._callbacks[e])return[];for("keyup"==c&&p(e)&&(t=[e]),a=0;a<g._callbacks[e].length;++a)if(s=g._callbacks[e][a],(r||!s.seq||b[s.seq]==s.level)&&c==s.action&&("keypress"==c&&!n.metaKey&&!n.ctrlKey||u(t,s.modifiers))){var f=!r&&s.combo==o,d=r&&s.seq==r&&s.level==i;(f||d)&&g._callbacks[e].splice(a,1),l.push(s)}return l}function r(e,t,n,r){g.stopCallback(t,t.target||t.srcElement,n,r)||!1===e(t,n)&&(f(t),d(t))}function o(e){"number"!=typeof e.which&&(e.which=e.keyCode);var t=l(e);if(t)return"keyup"==e.type&&w===t?void(w=!1):void g.handleKey(t,c(e),e)}function a(){clearTimeout(v),v=setTimeout(t,1e3)}function h(e,n,o,i){function s(t){return function(){S=t,++b[e],a()}}function u(n){r(o,n,e),"keyup"!==i&&(w=l(n)),setTimeout(t,10)}b[e]=0;for(var c=0;c<n.length;++c){var f=c+1===n.length,d=f?u:s(i||_(n[c+1]).action);m(n[c],d,i,e,c)}}function m(e,t,r,o,i){g._directMap[e+":"+r]=t,e=e.replace(/\s+/g," ");var a,s=e.split(" ");if(s.length>1)return void h(e,s,t,r);a=_(e,r),g._callbacks[a.key]=g._callbacks[a.key]||[],n(a.key,a.modifiers,{type:a.action},o,e,i),g._callbacks[a.key][o?"unshift":"push"]({callback:t,modifiers:a.modifiers,action:a.action,seq:o,level:i,combo:e})}var g=this;if(e=e||i,!(g instanceof y))return new y(e);g.target=e,g._callbacks={},g._directMap={};var v,b={},w=!1,C=!1,S=!1;g._handleKey=function(e,o,i){var a,s=n(e,o,i),l={},u=0,c=!1;for(a=0;a<s.length;++a)s[a].seq&&(u=Math.max(u,s[a].level));for(a=0;a<s.length;++a)if(s[a].seq){if(s[a].level!=u)continue;c=!0,l[s[a].seq]=1,r(s[a].callback,i,s[a].combo,s[a].seq)}else c||r(s[a].callback,i,s[a].combo);var f="keypress"==i.type&&C;i.type!=S||p(e)||f||t(l),C=c&&"keydown"==i.type},g._bindMultiple=function(e,t,n){for(var r=0;r<e.length;++r)m(e[r],t,n)},s(e,"keypress",o),s(e,"keydown",o),s(e,"keyup",o)}if(o){for(var b,w={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},C={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},S={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},x={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},T=1;T<20;++T)w[111+T]="f"+T;for(T=0;T<=9;++T)w[T+96]=T.toString();y.prototype.bind=function(e,t,n){var r=this;return e=e instanceof Array?e:[e],r._bindMultiple.call(r,e,t,n),r},y.prototype.unbind=function(e,t){var n=this;return n.bind.call(n,e,function(){},t)},y.prototype.trigger=function(e,t){var n=this;return n._directMap[e+":"+t]&&n._directMap[e+":"+t]({},e),n},y.prototype.reset=function(){var e=this;return e._callbacks={},e._directMap={},e},y.prototype.stopCallback=function(e,t){var n=this;return!((" "+t.className+" ").indexOf(" mousetrap ")>-1)&&(!v(t,n.target)&&("INPUT"==t.tagName||"SELECT"==t.tagName||"TEXTAREA"==t.tagName||t.isContentEditable))},y.prototype.handleKey=function(){var e=this;return e._handleKey.apply(e,arguments)},y.addKeycodes=function(e){for(var t in e)e.hasOwnProperty(t)&&(w[t]=e[t]);b=null},y.init=function(){var e=y(i);for(var t in e)"_"!==t.charAt(0)&&(y[t]=function(t){return function(){return e[t].apply(e,arguments)}}(t))},y.init(),o.Mousetrap=y,void 0!==e&&e.exports&&(e.exports=y),(r=function(){return y}.call(t,n,t,e))!==a&&(e.exports=r)}}("undefined"!=typeof window?window:null,"undefined"!=typeof window?document:null)},,function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e){return T(x,e)}var i=n(151),a=n(437),s=r(a),l=n(438),u=r(l),c=n(725),f=r(c),d=n(896),p=r(d),h=n(897),m=r(h),g=n(899),_=r(g),v=n(900),y=r(v),b=n(901),w=r(b),C=n(902),S=r(C);e.exports=function(){var e=null;return{getInstance:function(){return e||(e=o()),e},destory:function(){e=null}}}();var x=(0,i.combineReducers)({spreadsheet:p.default,msg:m.default,handsontable:_.default,collaborators:y.default,selection:w.default,lockpermission:S.default}),T=(0,i.applyMiddleware)(s.default,u.default,(0,f.default)())(i.createStore)},,,,,function(e,t,n){function r(e){var t=this.__data__=new o(e);this.size=t.size}var o=n(652),i=n(934),a=n(935),s=n(936),l=n(937),u=n(938);r.prototype.clear=i,r.prototype.delete=a,r.prototype.get=s,r.prototype.has=l,r.prototype.set=u,e.exports=r},function(e,t,n){function r(e,t,n,a,s){return e===t||(null==e||null==t||!i(e)&&!i(t)?e!==e&&t!==t:o(e,t,n,a,r,s))}var o=n(951),i=n(199);e.exports=r},function(e,t,n){function r(e,t,n,r,u,c){var f=n&s,d=e.length,p=t.length;if(d!=p&&!(f&&p>d))return!1;var h=c.get(e);if(h&&c.get(t))return h==t;var m=-1,g=!0,_=n&l?new o:void 0;for(c.set(e,t),c.set(t,e);++m<d;){var v=e[m],y=t[m];if(r)var b=f?r(y,v,m,t,e,c):r(v,y,m,e,t,c);if(void 0!==b){if(b)continue;g=!1;break}if(_){if(!i(t,function(e,t){if(!a(_,t)&&(v===e||u(v,e,n,r,c)))return _.push(t)})){g=!1;break}}else if(v!==y&&!u(v,y,n,r,c)){g=!1;break}}return c.delete(e),c.delete(t),g}var o=n(952),i=n(955),a=n(956),s=1,l=2;e.exports=r},function(e,t,n){function r(e){return e===e&&!o(e)}var o=n(175);e.exports=r},function(e,t){function n(e,t){return function(n){return null!=n&&(n[e]===t&&(void 0!==t||e in Object(n)))}}e.exports=n},,function(e,t,n){function r(e){return"function"==typeof e?e:null==e?a:"object"==typeof e?s(e)?i(e[0],e[1]):o(e):l(e)}var o=n(927),i=n(974),a=n(338),s=n(261),l=n(985);e.exports=r},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(702),i=r(o);t.default=function(e){var t=e.guid,r=e.isAjaxForce;n.e(5).then(function(){var e=n(1060).ListContainer,o=n(1061);i.default.list.show(),o({guid:t,ListContainer:e,isAjaxForce:r})}.bind(null,n)).catch(n.oe)},e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){n.e(6).then(function(){(0,n(1062).initDoc)(e,t)}.bind(null,n)).catch(n.oe)},e.exports=t.default},,function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){n.e(7).then(function(){(0,n(1063).initDoc)(e,t)}.bind(null,n)).catch(n.oe)},e.exports=t.default},function(e,t,n){(function(r){var o,i,a=function(e,t){function n(){this.constructor=e}for(var r in t)s.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},s={}.hasOwnProperty;o=[n(5),n(840),n(889),n(9)],void 0!==(i=function(e,t,n,o){return new(function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return a(i,t),i.prototype.init=function(){return this.$editor=r("#innerdocbody"),this.$pad=r("#pad-view"),this.initConfig(),this.initBinding()},i.prototype.initConfig=function(){return this.metaKey=e.isMac()?"command":"ctrl",this.baseConfig="shift+"+this.metaKey+"+",this.docConfig={up:"handleFontUp",down:"handleFontDown",p:"handleComment",k:"handleTitle",u:'li[data-key="insertorderedlist"]',i:'li[data-key="insertunorderedlist"]',y:'li[data-key="checklist"]',l:"handleHistory",o:"handleDirectory",x:"handleAddShare"},this.listConfig={},this.commonConfig={e:"handleNewHome"},this.inDoc="k u i y up down"},i.prototype.initBinding=function(){var e,t,n,o,i,a,s,l,u;u=this,i=this.docConfig,e=function(){var e,t;return e=n,t=o,Mousetrap.bind(u.baseConfig+e,function(n){if(0===u.$pad.length&&(u.$pad=r("#pad-view")),0===u.$editor.length&&(u.$editor=r("#innerdocbody")),n.preventDefault?n.preventDefault():n.returnValue=!1,!u.$pad.hasClass("hide")&&(!u.inDoc.match(new RegExp("\\b"+e+"\\b"))||u.$editor.is(":focus"))&&("p"!==e||u.$editor.is(":focus")||r(".selection-comment-input").is(":focus")))return"function"==typeof u[t]?u[t]():r(t).click(),!1})};for(n in i)o=i[n],e();a=this.listConfig,t=function(){var e,t;return e=n,t=o,Mousetrap.bind(e,function(e){var n;if("home"===(n=window.cow.pageType)||"folder"===n)return r(t).click(),e.preventDefault?e.preventDefault():e.returnValue=!1})};for(n in a)o=a[n],t();s=this.commonConfig,l=[];for(n in s)o=s[n],l.push(function(){var e,t;return e=n,t=o,Mousetrap.bind(u.baseConfig+e,function(e){return u[t](),e.preventDefault?e.preventDefault():e.returnValue=!1})}());return l},i.prototype.handleFontUp=function(){return this.handleFontChange("up")},i.prototype.handleFontDown=function(){return this.handleFontChange("down")},i.prototype.handleComment=function(){var e,t,n;return n=r("#select-comment"),t=r(".close-temp"),e=r(".temp-list"),"none"===window.getComputedStyle(e[0]).getPropertyValue("display")?n.click():t.click()},i.prototype.handleFontChange=function(e){var t,n,o;if(window.getSelection().toString().length&&(o={9:1,10:2,11:3,12:4,14:5,18:6,24:7,30:8,36:9},t=r(".size-txt").text()))return n=o[t],"up"===e?n++:n--,n=Math.min(Math.max(n,1),9),r("#size-list [data-value='"+n+"']").trigger("click",[!0])},i.prototype.handleTitle=function(){var e,t,n;return e={"普通":-1,"小标题":1,"中标题":2,"大标题":3},t=r(".type-txt").text(),n=e[t],3===n?n=-1:-1===n?n=1:n++,r(".font-type-item [data-value='"+n+"']").trigger("click",[!0])},i.prototype.handleHistory=function(){return o.notify("history:toggle")},i.prototype.handleDirectory=function(){return o.notify("directory:toggle")},i.prototype.handleAddShare=function(){var e,t,o;return o=r("#teamworker-setting"),t=r(".teamworker-inner"),e=r(".teamworker-close"),!o.hasClass("hide")&&t.hasClass("share-menu")?e.click():new n("#teamworker-setting")},i.prototype.handleNewHome=function(){return window.open("http:///shimo.im/desktop")},i}(e.DomModule))("body")}.apply(t,o))&&(e.exports=i)}).call(t,n(2))},function(e,t,n){(function(r,o,i){var a,s,l=function(e,t){function n(){this.constructor=e}for(var r in t)u.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},u={}.hasOwnProperty;a=[n(5),n(895),n(891),n(892),n(893),n(894),n(890),n(48),n(152),n(194),n(257),n(147)],void 0!==(s=function(e,t,n,a,s,u,c,f,d,p,h,m){return function(g){function _(){return _.__super__.constructor.apply(this,arguments)}return l(_,g),_.prototype.inited=!1,_.prototype.init=function(t,n){var i;!1!==window.cow.authorized&&(i=this,this.cow=window.cow,this.defaultAvatar="https://assets-cdn.shimo.im/assets/images/invited-f41924e412.png",this.option=this.option=r.extend({file:window.cow.currentFile,isTeamCreator:this.isTeamCreator},n),this.teamId=this.option.teamId,this.isTeamCreator=this.option.isTeamCreator,this.readOnly=this.option.readOnly=this.option.readOnly||!1,this.isMobile=e.isMobile,this.maxTeamworkerCount=m.initLimition().teamworkerCount,this.modal=void 0===this.option.modal||this.option.modal,this.teamId?(this.memberList=[],this.membersObj={}):this.file=this.option.file,this.option.shareList?this.renderShareList():this.renderTeamworker(),this.sharedUserlist={current:[],grand:[]},this.show(),this.$view.click(function(e){if(o(e.target).is(i.$view)&&i.modal)return i.hide()}))},_.prototype.renderTeamworker=function(){return this.$view.html(r.template(t)(this.option)),this.$shareMenu=this.$view.find(".share-menu"),this.$emailInput=this.$shareMenu.find(".teamworker-input"),this.$searchList=this.$shareMenu.find(".search-user-list"),this.$userList=this.$shareMenu.find(".teamworker-user-list"),this.$delBtn=this.$view.find(".teamworker-input-clear"),this.$listItem=this.$view.closest(".ob-li"),this.$notFound=this.$view.find(".user-not-found"),this.$teamworkerRight=o(".teamworker-content-right"),this.$teamworkerShadow=o(".teamworker-list-shadow"),this.$inviteBtn=o(".invite-users"),this.$inviteLinkPopup=this.$view.find(".invite-link-popup"),this.$inviteLinkBtn=this.$view.find("a.btn.invite-link"),this.$inviteLinkQr=this.$inviteLinkPopup.find("img"),this.showShareMenu(),this.waitingInvited=[]},_.prototype.renderShareList=function(){return this.$view.html(r.template(n)(this.option)),this.$userList=this.$view.find(".teamworker-content"),this.$shareNumber=this.$view.find(".teamworker-number"),this.$teamworkerShadow=o(".sharelist-content-shadow"),this.showShareList()},_.prototype.showShareList=function(){return this.teamId?this.getTeamMembers("",!0):this.getUserList("",!0)},_.prototype.renderTeamworkerInner=function(){return this.$userList.find("ul").html(""),this.renderRecentlyContacts()},_.prototype.renderRecentlyContacts=function(){var t;return t=this,e.get("/api/share/recent_contact",{},function(e){var n,o,i;return t.recentContacts=i=e.data,t.teamId?r.forEach(i,function(e){t.membersObj[e.id]?e.shareClass="is-shared":e.shareClass=""}):r.forEach(i,function(e){window.cow.shareObj[e.id]?e.shareClass="is-shared":e.shareClass=""}),o={userList:i.filter(function(e){return e.status>-1}),title:"最近"},this.recentlyObject=o,n=r.template(c)({contactsList:[o]}),t.$userList.find("ul").prepend(n)})},_.prototype.renderContacts=function(){var e,t,n,o,i,a;return a=this,t=f.contacts,i={},r.forIn(t,function(e,t){var n;if(-1!==e.status)return n=e.name_pinyin.substr(0,1),a.teamId?a.membersObj[e.id]?e.shareClass="is-shared":e.shareClass="":window.cow.shareObj[e.id]?e.shareClass="is-shared":e.shareClass="",n.match(/[a-zA-Z]/)||(n="#"),i[n]?i[n].userList.push(e):i[n]={title:n.toUpperCase(),userList:[e]}}),o=r.values(i),o.sort(function(e,t){return e.title>t.title?1:-1}),o[0]&&"#"===o[0].title&&(n=o.shift(),o.push(n)),e=r.template(c)({contactsList:o}),this.$userList.find("ul").append(e)},_.prototype.renderSearchList=function(){var e,t;return t=this,this.$searchList.find("ul").html(""),r.forEach(this.searchUsers,function(e){var n,o;o=!1,r.each(t.waitingInvited,function(t){if(o=e.id?e.id===t.id:e.email===t.email)return o}),n=t.teamId?t.membersObj:window.cow.shareObj,n[e.id]?e.shareClass="is-shared":e.shareClass=o?"is-checked":""}),e={userList:this.searchUsers,title:""},u=r.template(c)({contactsList:[e]}),this.$searchList.find("ul").append(u)},_.prototype.renderInvitedUser=function(){var e,t,n;return n="待添加成员"+(this.waitingInvited.length?"("+this.waitingInvited.length+")":""),e={userList:this.waitingInvited,title:n,titleClass:"invite-title"},t=r.template(c)({contactsList:[e]}),this.$teamworkerRight.find("ul").html(t),this.waitingInvited.length?this.$inviteBtn.removeClass("disable"):this.$inviteBtn.addClass("disable")},_.prototype.changeListShadow=function(){return this.$userList.find("ul").height()>this.$userList.height()?this.$teamworkerShadow.show():this.$teamworkerShadow.hide()},_.prototype.eventMap={"click .dropdown-btn":"dropClick","click .dropdown":"stopPropagation","click .search-list li":"shareClick","click .user-input .input-group-addon":"handlerUserInput","click .share-ob ":"showShareMenu","click .share-ob":"onlineStatusWatch","mouseover .search-list li":"searchHover","click .icon-close:first":"close","click .add-share":"openAddShare","keyup .teamworker-input":"emailInputKeyup","keydown .teamworker-input":"emailInputKeydown","click .teamworker-input-clear":"clearInput","click .invite-users":"inviteUsers","click .cancel-invite":"closeInvite","click .share-user-remove":"cancelShare","click .share-menu-content .share-user-li":"pickUser","click .invite-link":"inviteLinks","click *":"hideInviteLinkPopup","click .team-role-item":"roleItemClick"},_.prototype.domEvents={dropClick:function(e,t){var n,r,i,a,s,l,u,c,f,d;r=o(t),l=r.hasClass("active"),h.clearDropdown(),this.$view.find(".is-dropup").removeClass("is-dropup"),this.$view.find(".has-drop").removeClass("has-drop"),a=this.$view.find(".user-list>.share-user-li"),l||(i=o(t).closest(".user-li"),f=this.$view.find(".sharelist-content").scrollTop(),s=i.find(".role-dropdown-wrap").height()+20+10,d=a.index(i),u=36*(d+1)-f,c=this.$view.find(".sharelist-content").height()-u,i.addClass("has-drop"),n=r.addClass("active").next(".dropdown").addClass("active"),c<s&&n.addClass("is-dropup")),e.stopPropagation()},stopPropagation:function(e,t){return e.stopPropagation(),e.preventDefault(),!1},closeInvite:function(){return"sharelist"===this.option.pre?this.renderShareList():(o(".teamworker-close").click(),this.isTeamCreator?this.gotoCurrentTeam():void 0)},inviteUsers:function(){if(!this.$inviteBtn.hasClass("disable"))return this.$inviteBtn.addClass("disable").text("请求中..."),this.invite()},pickUser:function(e,t){var n,i,a,s,l,u,c,d,p,h,m,g,_,v;if(d=o.Deferred(),d.then(function(e){return function(t){if(t)return e.waitingInvited.push(t)}}(this)),d.then(function(e){return function(){return e.renderInvitedUser()}}(this)),n=o(t),i=n.find(".operation-icon"),!i.hasClass("is-shared"))return h=i.hasClass("is-checked"),m=i.hasClass("is-remove"),v=n.attr("data-user-id"),p=n.attr("data-user-email"),v?(a=this.$view.find(".teamworker-user-li[data-user-id="+v+"] .operation-icon"),s="id",l=v):(a=this.$view.find(".teamworker-user-li[data-user-email='"+p+"'] .operation-icon"),s="email",l=p),this.waitingInvited=r.remove(this.waitingInvited,function(e){return e[s]+""!=l+""}),h||m?(a.removeClass("is-checked"),d.resolve()):(a.addClass("is-checked"),v?(_=f.contacts[v],_?(_.shareClass="is-remove",c=o.extend(!0,{},_),d.resolve(c)):(g=n.find(".share-user-name").text(),u=n.find(".share-user-avatar img").attr("src"),c={name:g,email:p,id:v,avatar:u,shareClass:"is-remove"},d.resolve(c))):(c={name:"邮件邀请",email:p,avatar:this.defaultAvatar,shareClass:"is-remove"},cooperation.getUserInfo(p).done(function(e){return function(e){return 0===e.code&&(c.name=e.data.name,c.avatar=e.data.avatar),d.resolve(c)}}())))},openAddShare:function(){return Infinity!==this.maxTeamworkerCount&&cow.shareList.length>=this.maxTeamworkerCount&&!this.isTeamCreator?void this.showOutCountWarning():this.readOnly?o(".teamworker-close").click():(this.renderTeamworker(),this.option.pre="sharelist")},cancelShare:function(t){var n,r,i,a,s,l,u;return a=this,u=o(t.target).parents(".user-li"),l=+u.attr("data-user-id"),r=u.hasClass("verified"),l===window.cow.currentUser.id?n="确认要删除对你自己的共享吗？<br />删除后你将无权限访问该文件":(s=f.get(l),i=r?s.email:s.name,n='确认要删除对<span class="blue">'+i+"</span>的共享吗？<br />删除后该成员将无权限访问该文件"),a.tempHide(),p.show({okCallback:function(){return a.tempShow(),a.showCancelInviteStatus(u),e.post("/api/share/delete",{guid:a.file.guid,user_id:l},function(){return l===window.cow.currentUser.id?(a.hide(),e.alert({title:"已删除对你自己的共享"})):(a.getUserList(!0,!0),e.alert({title:"已删除<span class='blue'>"+f.get(l).name+"</span>"}))},function(){return e.alert({title:"删除失败",type:"error"}),a.showCancelInviteStatus(u,"confirm")})},cancelCallback:function(){return a.tempShow()},headText:"删除共享",bodyText:n})},shareClick:function(e,t){},handlerUserInput:function(){return this.handlerUserInput.apply(this,arguments)},onlineStatusWatch:function(){return d.watch("shareMenu",this.$shareMenu,function(e){return this.find("ul li[data-user-id="+e+"]")})},emailInputKeydown:function(t){var n;(n=t.keyCode)===e.keyCodes.UP||n===e.keyCodes.DOWN?t.preventDefault():t.keyCode===e.keyCodes.ENTER&&this.handlerUserInput(t)},emailInputKeyup:function(t){var n;return t.keyCode===e.keyCodes.ESC&&this.hide(),n=this.$emailInput.val().trim(),n?this.showSearchList():this.hideSearchList(),t.keyCode===e.keyCodes.UP?(this.selectSearchItem("up"),this.scrollSearch()):t.keyCode===e.keyCodes.DOWN?(this.selectSearchItem("down"),this.scrollSearch()):(this.$emailInput.parents(".user-input").removeClass("has-error"),this.search(t.target.value))},searchHover:function(e,t){var n;if(n=o(t),!n.hasClass("active"))return this.$searchList.find("li").removeClass("active"),n.addClass("active")},close:function(){return this.hide()},clearInput:function(e){return this.$emailInput.val("").focus(),this.hideSearchList(),this.$notFound.hide()},inviteLinks:function(){return this,this.$inviteLinkPopup.toggleClass("hide"),this.$inviteLinkPopup.hasClass("hide")||this.$inviteLinkQr.prop("src",""),e.get("/api/file/"+this.file.guid+"/invite_link").then(function(t){return function(n){var r;return r=e.getQrImageUrl(114,n.data.link),t.$inviteLinkQr.prop("src",r)}}(this))},hideInviteLinkPopup:function(e){var t;if(this.modal){if(t=o(e.target),0===this.$view.find(".invite-link-popup").length)return;!t.is(this.$inviteLinkPopup.find("*"))&&!t.is(this.$inviteLinkBtn)&&!this.$inviteLinkPopup.hasClass("hide")&&this.$inviteLinkPopup.addClass("hide")}},roleItemClick:function(e,t){var n,i,a,s,l,u;if(s=this,n=o(t),a=o(t).attr("action-type"),i=o(t).closest(".user-li"),h.clearDropdown(),i.length>0){if(l=i.attr("data-user-id"),u=s.membersObj[l],void 0===l)return;if("delete"===a||"cancel-invite"===a)return p.show({okCallback:function(){return s.removeTeamMember(l).then(function(){return i.remove(),r.remove(s.memberList,function(e){return+e.id==+l}),delete s.membersObj[l]}).fail(function(){})},headText:"移除成员",bodyText:"<div>确定要移除 "+u.name+" 吗？</div><div>移除后该成员将无权限访问该文件夹</div>"});if(r.includes(["admin","member","visitor"],a))return this.changeMemberRole(l,a).then(function(e){return i.find(".role-title").text(e),i.find(".team-role-list li").removeClass("checked"),n.addClass("checked")}).fail(function(){})}}},_.prototype.getMobileShareList=function(){var e,t;return e=this.sharedUserlist,t=[],"",r.forEach(e.current,function(e){return t.push(e.name)}),r.forEach(e.grand,function(e){return r.forEach(e.users,function(e){if(t.length<4)return t.push(e.name)})}),t.length<=3?t.toString()+'<span class="m-icon">':t.slice(0,3).toString()+'...<span class="m-icon">'},_.prototype.showCancelInviteStatus=function(e,t){return null==t&&(t="loading"),"loading"===t?(t="userlist-"+t,e.find(".status").hide(),e.find(".status."+t).show()):e.find(".status").attr("style","")},_.prototype.showShareMenu=function(e,t){return this.teamId?this.getTeamMembers():this.getUserList()},_.prototype.showSearchList=function(){return this.$delBtn.show(),this.$emailInput.addClass("search-result-shown"),this.$searchList.show(),this.$userList.hide()},_.prototype.hideSearchList=function(){return this.$emailInput.val("").removeClass("search-result-shown"),this.$delBtn.hide(),this.$searchList.hide(),this.$userList.show()},_.prototype.selectSearchItem=function(e){var t,n,r;return n=this.$searchList.find("li"),void 0===e?n.removeClass("active").first().addClass("active"):(t=this.$searchList.find("li.active"),0!==t.length?(r=t.attr("data-index"),"up"===e&&r>0&&t.prev().length>0&&t.removeClass("active").prev().addClass("active"),"down"===e&&r<n.length-1&&t.next().length>0?t.removeClass("active").next().addClass("active"):void 0):void 0)},_.prototype.updateAttr=function(t,n){return e.post("/api/file/"+n,t,function(){})},_.prototype.showInviteStatus=function(e){return this.$activeSearchLi.find("span.icon-add,span.icon-loading,span.icon-remind").hide(),this.$activeSearchLi.find("span.icon-"+e).show()},_.prototype.invite=function(){var t,n,o,i,a;if(i=this,this.waitingInvited.length)return a="",n={},i.teamId?(n={team_id:this.teamId,users:[]},a="/team_members/invite"):(n={file_id:this.file.id,users:[]},a="/api/invite"),o=!1,Infinity===this.maxTeamworkerCount||this.isTeamCreator||(t=this.maxTeamworkerCount-cow.shareList.length,t<=0?o=!0:this.waitingInvited.length>t&&(o=!0)),o?(i.$inviteBtn.removeClass("disable").text("确定"),void i.showOutCountWarning()):(r.forEach(this.waitingInvited,function(e){var t;return t=e.id?e.id:e.email,n.users.push(t)}),n.users.length>0?e.post(a,n).then(function(t){return 0===t.code&&t.data.success?(e.alert({title:"邀请成功！"}),i.renderShareList()):(e.alert({title:"添加失败",type:"error"}),i.$inviteBtn.removeClass("disable").text("确定"))}).fail(function(){return e.alert({title:"添加失败",type:"error"}),i.$inviteBtn.removeClass("disable").text("确定")}):void 0)},_.prototype.showOutCountWarning=function(){var e;return e=this.maxTeamworkerCount,p.show({headText:"到达上限",bodyText:"最多添加"+e+"个协作者，升级<b>石墨高级版</b>无此限制",buttons:[{type:"link-button",buttonLabel:"了解详情",href:"/payment",target:"_blank",customClass:"btn btn-ok",closeAfterClick:!0},{type:"button",buttonLabel:"取消",customClass:"btn btn-cancel",closeAfterClick:!0}]})},_.prototype.setTplClassName=function(e){return e.isOwner?(e.tplClassName="user-admin",e.tplTitle="管理员"):"verified"!==e.status&&"verified"!==e._status?(e.tplClassName="user-wait-confirm",e.tplTitle="成员"):(e.tplTitle="成员",e.tplClassName="user-normal",+e.id===window.cow.currentUser.id?e.tplClassName="user-self":void 0)},_.prototype.getTeamMembers=function(t,n){var o,i,a;return null==t&&(t=!0),a=this,i=function(){var e,t;return n?(e=a.membersObj[cow.currentUser.id].team_role,t=r.template(s)({myRole:e,userList:a.memberList,readOnly:a.readOnly}),a.$userList.find("ul").html(t),a.memberList&&a.$shareNumber.text("团队成员("+a.memberList.length+")")):a.renderTeamworkerInner(),a.changeListShadow()},t||n?(o=function(e){var t;return t=e.data,t.map(function(e){switch(+e.id===window.cow.currentUser.id&&(e.isSelf=!0),e.team_role){case"creator":e.roleTitle="创建者";break;case"admin":e.roleTitle="管理员";break;case"member":e.roleTitle="成员"}return a.membersObj[e.id]=e}),t=t.sort(function(e,t){return("admin"===t.team_role)-("admin"===e.team_role)}).sort(function(e,t){return("creator"===t.team_role)-("creator"===e.team_role)}),a.memberList=t},e.get("/smapi/teams/mine/members").then(function(e){if(0===e.code)return o(e),i()})):i()},_.prototype.getUserList=function(t,n){var o,i,s;return null==t&&(t=!0),s=this,i=function(){var e;return n?(e=r.template(a)(s.sharedUserlist),s.$userList.find("ul").html(e),window.shareList&&s.$shareNumber.text("成员("+window.shareList.length+")")):(s.renderTeamworkerInner(),s.$emailInput.focus()),s.changeListShadow()},t||n?(o=function(e){var t;return t=e.data,t.grandUsers=[],t.grand.map(function(e){return e.users=[],e.user_ids.split(",").forEach(function(t){var n;if(f.exists(t))return n=f.get(t),n._status="verified",n.isOwner=+e.user_id==+t,+n.id===window.cow.currentUser.id&&(n.isSelf=!0),s.setTplClassName(n),e.users.push(n)}),t.grandUsers=t.grandUsers.concat(e.users),e}),t.grandUsers=t.grandUsers.sort(function(e,t){return t.status-e.status}).sort(function(e,t){return!!t.isSelf-!!e.isSelf}).sort(function(e,t){return t.isOwner-e.isOwner}),t.current.map(function(e){return e.online=d.isOnline(e.id),+e.id===window.cow.currentUser.id&&(e.isSelf=!0),s.setTplClassName(e),e}),t.current=t.current.sort(function(e,t){return t.status-e.status}).sort(function(e,t){return!!t.isSelf-!!e.isSelf}).sort(function(e,t){return t.isOwner-e.isOwner}),s.sharedUserlist=t,window.shareList=t.grandUsers.concat(e.data.current),cow.shareList=window.shareList},e.post("/api/share/"+s.file.guid,{},function(e){if(0===e.code)return o(e),i()},function(t){if("err_shortcut_inside"===t.message)return e.alert({title:"文件夹中有他人分享的文档/文件夹，无法添加共享人",type:"error"}),s.hide()})):i()},_.prototype.search=function(t){var n;return n=this,this.searchUsers=f.search(t,n.recentContacts||[]).filter(function(e){return+e.id!=+window.cow.currentUser.id&&e.status>-1}).map(function(e,t){return e.index=t,e}),0===this.searchUsers.length&&t?e.regs.email.test(t)?(this.searchUsers.push({name:"邮件邀请",email:t,avatar:this.defaultAvatar}),this.$notFound.hide()):this.$notFound.text("无搜索结果").show():this.$notFound.hide(),this.renderSearchList()},_.prototype.scrollSearch=function(){var e,t,n,r;if(t=this.$searchList.find(".active").index(),n=this.$searchList.scrollTop(),e=50,150,(r=e*t)-n>e-e||r<n)return this.$searchList.scrollTop(r)},_.prototype.handlerUserInput=function(e){var t;this.$searchLi=this.$searchList.find(".share-user-li"),t=this.$searchLi.find(".operation-icon"),1!==this.$searchLi.length||t.hasClass("is-shared")||t.hasClass("is-checked")||(this.$searchLi.click(),this.$delBtn.click())},_.prototype.toggleOverflow=function(e){return e?o("body,html").addClass("overflow-hidden"):o("body,html").removeClass("overflow-hidden")},_.prototype.show=function(){return this.$view.removeClass("hide").click(),this.toggleOverflow(!0)},_.prototype.tempHide=function(){return this.$view.addClass("hide"),this.toggleOverflow(!1)},_.prototype.tempShow=function(){return this.$view.removeClass("hide"),o("body").click(),this.toggleOverflow(!0)},_.prototype.hide=function(){if(this.$view.hasClass("show")?this.$view.removeClass("show"):(this.$view.off(),this.$view.addClass("hide")),o("body").click(),this.toggleOverflow(!1),this.isTeamCreator)return this.gotoCurrentTeam()},_.prototype.gotoCurrentTeam=function(){return this.cow.currentTeam=this.teamId,i("/team/"+this.teamId+"/files")},_.prototype.removeTeamMember=function(t){var n,r,i,a,s;return i=o.Deferred(),a=this,n="/team_members/delete",s=this.membersObj[t],r={team_id:a.teamId,user_id:t},e.post(n,r).then(function(t){if(0===t.code)return e.alert({title:"已删除<span class='blue'>"+s.name+"</span>"}),i.resolve()}).fail(function(t){return e.alert({title:"删除<span class='blue'>"+s.name+"</span>失败",type:"error"}),i.reject()}),i.promise()},_.prototype.changeMemberRole=function(t,n){var r,i,a,s,l;return a=o.Deferred(),s=this,r="/team_members/change_role",l=this.membersObj[t],i={team_id:s.teamId,user_id:t,role:n},e.post(r,i).then(function(t){var r;if(0===t.code){switch(r="",n){case"admin":r="管理员";break;case"member":r="成员";break;case"visitor":r="访客"}return e.alert({title:"已将<span class='blue'>"+l.name+"</span>修改为"+r}),a.resolve(r)}return e.alert({title:"更新<span class='blue'>"+l.name+"</span>角色失败"}),a.reject()}).fail(function(t){return e.alert({title:"更新<span class='blue'>"+l.name+"</span>角色失败"}),a.reject()}),a.promise()},_}(e.DomModule)}.apply(t,a))&&(e.exports=s)}).call(t,n(1),n(2),n(23))},function(e,t){e.exports='<% _.each(contactsList, function(userObject) { %>\n    <% if (userObject.userList.length && userObject.title || userObject.titleClass === "invite-title") {%>\n        <li class="share-li-title teamworker-li-title <%= userObject.titleClass %>"><%= userObject.title %></li>\n    <% } %>\n    <% _.each(userObject.userList, function (user) { %>\n        <li class="share-user-li teamworker-user-li <%= user.online?\'online\':\'\' %> <%= user.status || \'\' %>" data-share-id="<%= user.share_id %>" data-user-id="<%= user.id %>" data-user-email="<%= user.email %>">\n            <span class="share-user-avatar">\n                <img src="<%= user.avatar%>">\n                <span class="online-circle"></span>\n            </span>\n            <span class="share-user-name ellipsis teamworker-user-name"><%= user.name %></span>\n            <span class="share-user-email ellipsis teamworker-user-email"><%= user.email || \'石墨用户\'%></span>\n            <span class="operation-icon doc-share-icon <%= user.shareClass%>"></span>\n        </li>\n    <% }) %>\n<% }) %>\n\n\n\n'},function(e,t){e.exports='<div class="sharelist-dialog teamworker-inner">\n    <div class="share-title teamworker-title">\n        <span class="teamworker-number">成员</span>\n        <span class="hicon icon-close teamworker-close"></span>\n    </div>\n\n    <div class="teamworker-content sharelist-content">\n        <ul class="user-list"></ul>\n    </div>\n    <div class="sharelist-content-shadow"></div>\n    <div class="teamworker-footer">\n        \n        <a href="javascript:void(0);" class="teamworker-btn add-share btn btn-ok"><% if (readOnly) {print(\'完成\')} else {print(\'添加成员\')}%></a>\n    </div>\n</div>'},function(e,t){e.exports='<% if (grandUsers.length > 0) { %>\n    <li class="share-li-title user-li-title">共享文件夹</li>\n<% } %>\n<% _.each(grandUsers, function (user) {   %>\n    <li class="grand-li share-user-li user-li <%= user.online?\'online\':\'\' %> <%= user.status || \'\' %>" data-share-id="<%= user.share_id %>" data-user-id="<%= user.id %>" data-user-email="<%= user.email %>">\n        <span class="share-user-avatar">\n            <img src="<%= user.avatar%>">\n            <span class="online-circle"></span>\n        </span>\n        <span class="share-user-name ellipsis"><%= user.name %></span>\n        <span class="share-user-email ellipsis"><%= user.email || \'石墨用户\' %></span>\n        <span class="share-status share-user-identity <%= user.tplClassName %>"><%= user.tplTitle %></span>\n    </li>\n<% }) %>\n\n<% if (current.length > 0) { %>\n    <li class="share-li-title user-li-title <% if (grandUsers.length == 0) {%>no-grand<%}%>">与<%= grandUsers.length > 0 ? \'另\' : \'\' %><%= current.length %>人分享</li>\n<% } %>\n<% _.each(current, function (user) {   %>\n    <li class="share-user-li user-li <%= user.online?\'online\':\'\' %> <%= user.status || \'\' %>" data-share-id="<%= user.share_id %>" data-user-id="<%= user.id %>" data-user-email="<%= user.email %>">\n        <span class="share-user-avatar">\n            <img src="<%= user.avatar%>">\n            <span class="online-circle"></span>\n        </span>\n        <span class="share-user-name ellipsis"><%= user.name %></span>\n        <span class="share-user-email ellipsis"><%= user.email || \'石墨用户\' %></span>\n        <span class="share-status share-user-identity <%= user.tplClassName %>"><%= user.tplTitle %></span>\n        <% if (user.tplClassName != \'user-admin\') { %>\n        <span class="share-status share-user-remove doc-share-icon"></span>\n        <% } %>\n        <span class="share-status share-user-loading"><img src="https://assets-cdn.shimo.im/assets/images/loading-b67e5a67dc.gif" /></span>\n    </li>\n<% }) %>\n\n<% if (!grandUsers.length && !current.length) {%>\n    <li class="no-contact">暂无共享者</li>\n<% } %>\n'},function(e,t){e.exports='<% _.each(userList, function (user, index) {   %>\n    <li class="share-user-li user-li <%= user.online?\'online\':\'\' %> <%= user.status || \'\' %>" data-share-id="<%= user.share_id %>" data-user-id="<%= user.id %>" data-user-email="<%= user.email %>">\n        <span class="share-user-avatar">\n            <img src="<%= user.avatar%>">\n            <span class="online-circle"></span>\n        </span>\n        <span class="share-user-name ellipsis"><%= user.name %></span>\n        <span class="share-user-email ellipsis team-user-email"><%= user.email || \'\' %></span>\n        <div class="team-role-select">\n            \x3c!-- 不修改自己的角色，不是管理员没权限，但是可以取消邀请自己邀请的用户, 访客没任何权限 --\x3e\n            <% if (!readOnly && (!user.isSelf && myRole==\'admin\')) { %>\n            <a class="role-select-btn dropdown-btn" href="javascript:void(0);">\n                <span class="team-sprite select-btn-icon"></span>\n            <% } else { %>\n            <a class="role-select-btn" href="javascript:void(0);">\n            <% } %>\n                <span class="role-title"><%=user.roleTitle%></span>\n            </a>\n            <div class="role-dropdown-wrap dropdown">\n                <div class="trangle">\n                    <span class="top"></span>\n                    <span class="down"></span>\n                </div>\n                <ul class="team-role-list">\n                    <li action-type="admin" class="team-role-item <%= (user.role == \'admin\') ? \'checked\' : \'\' %>">\n                        <span>管理员</span>\n                        <span class="select-role-icon team-sprite"></span>\n                    </li>\n                    <li action-type="member" class="team-role-item <%= (user.role == \'member\') ? \'checked\' : \'\' %>">\n                        <span>成员</span>\n                        <span class="select-role-icon team-sprite"></span>\n                    </li>\n                    <li class="team-role-separator"></li>\n                    <li action-type="delete" class="team-role-item">\n                        <span>移除成员</span>\n                    </li>\n                </ul>\n            </div>\n        </div>\n    </li>\n<% }) %>\n'},function(e,t){e.exports='<% if (users.length) { %>\n  <% _.each(users, function (user) { %>\n    <li class="user-li search-li <% if (user.selected) {print(\'active\')} %> " data-user-id="<%= user.id %>" data-user-name="${user.name}" data-email="${user.email}" data-index="${user.index}">\n      <span class="icon">\n        <img src="<%= user.avatar%>">\n        <span class="online-circle"></span>\n      </span>\n      <span class="account-span">\n        <span class="account-name"><%= user.name %></span>\n        <span class="account-email"><%= user.email %></span>\n      </span>\n      <span class="hicon icon-add"></span>\n      <span class="icon-loading"><img src="https://assets-cdn.shimo.im/assets/images/loading-b67e5a67dc.gif" /></span>\n      <span class="hicon icon-remind"></span>\n    </li>\n  <% }) %>\n<% } else { %>\n  <li class="user-not-found">无搜索结果</li>\n<% } %>'},function(e,t){e.exports='<div class="share-menu teamworker-inner">\n    <div class="share-title teamworker-title">\n        <span class="teamworker-number">添加成员</span>\n        <span class="hicon icon-close teamworker-close <%= (typeof isTeamCreator != \'undefined\' && !isTeamCreator)? \'hide\' : \'\' %>"></span>\n    </div>\n    <div class="teamworker-content share-menu-content">\n        <div class="teamworker-content-left">\n            <div class="teamworker-input-box">\n                <input class="form-control teamworker-input" type="text" autocomplete="off" placeholder="输入邮箱、搜索姓名进行添加" />\n                <a class="teamworker-input-clear" href="javascript:void(0);"><span class="hicon icon-delete"></span></a>\n                <ul class="search-list"></ul>\n            </div>\n            \n            <div class="teamworker-user-list">\n                <div class="teamworker-nobody-info hide">\n                    <span class="teamworker-nobody-text">还没有联系人</span>\n                    <span class="teamworker-nobody-text">你可以在上方<strong>输入对方邮箱</strong>直接添加</span>\n                    <% if(typeof teamId == \'undefined\' || !teamId) { %>\n                    <span class="teamworker-nobody-text">或点击下方「<strong>添加微信好友</strong>」按钮</span>\n                    <% } %>\n                </div>\n                <ul></ul>\n            </div>\n\n            <div class="search-user-list">\n                <ul></ul>\n            </div>\n\n            <div class="user-not-found"></div>\n            \n        </div>\n        <div class="teamworker-content-right">\n            <ul>\n                <li class="share-li-title teamworker-li-title invite-title">待添加成员</li>\n            </ul>\n        </div>\n    </div>\n    <div class="teamworker-list-shadow"></div>\n    <div class="invite-link-popup hide">\n        <p>微信扫一扫</p>\n        <img src="" />\n        <p>把文档发送给好友<br />邀请好友加入</p>\n        <div class="arrow-down" style="display: block;">\n          <span class="top"></span>\n          <span class="down"></span>\n        </div>\n    </div>\n    <div class="teamworker-footer">\n        <% if(typeof teamId == \'undefined\' || !teamId) { %>\n          <a href="javascript:void(0);" class="btn teamworker-btn invite-link">添加微信好友</a>\n        <% } %>\n        <a href="javascript:void(0);" class="btn btn-ok teamworker-btn invite-users disable">确定</a>\n        \x3c!-- 团队创建最后的添加成员比较特殊，可以跳过，所以按钮上处理不太一样 --\x3e\n        <a href="javascript:void(0);" class="btn teamworker-btn cancel-invite"><%= (typeof isTeamCreator != \'undefined\' && isTeamCreator)? "跳过" : "取消"%></a>\n    </div>\n</div>\n'},function(e,t,n){var r=n(428).updateState,o={loaded:!1,shownSidebar:null,highLight:!0,data:null,showLockSidebar:!1,zoom:1,sheetId:""};e.exports=function(e,t){switch(e=e||o,t.type){case"TOGGLE_SIDEBAR":var n=e.shownSidebar,i=n!==t.sidebarName?t.sidebarName:null;return r(e,{shownSidebar:i,highLight:!0,showLockSidebar:!1});case"TOGGLE_HIGHLIGHT":return r(e,{highLight:!e.highLight});case"HIDE_SIDEBAR":return r(e,{shownSidebar:null,highLight:!0});case"SPREADSHEET_LOAD":return r(e,{loading:!0,loaded:!1});case"SPREADSHEET_LOAD_SUCCESS":return r(e,{loading:!1,loaded:!0,data:t.result});case"SPREADSHEET_LOAD_FAIL":return r(e,{loading:!1,loaded:!0,error:t.error});case"TOGGLE_LOCK_SIDEBAR":var a,s=e.showLockSidebar;return a=!(s&&!t.status)||!s,r(e,{shownSidebar:null,highLight:!0,showLockSidebar:a});case"CHANGE_SHEET_ZOOM":return r(e,{zoom:t.zoom});case"CHANGE_SHEET_ID":return r(e,{sheetId:t.sheetId})}return e}},function(e,t,n){(function(t){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n){T.default.clear();var r=void 0,o=(0,S.v4)();try{r=window.sheetStorage=new P.default({userId:window.cow.currentUser.id,clientId:o})}catch(e){r=null}return(0,O.updateState)(e,(0,N.assign)(F,{submittedCS:t,revision:n,storage:r,clientId:o}))}function i(e,n,r){var o=e.submittedCS,i=e.committingCS,a=e.userCS,s=e.revision,l=o.compose(i).compose(a);if(!r){var u=void 0;try{u=l.invert(n)}catch(r){return k.default.notify("accept:error","invert_error"),t({submittedCS:C.default.pack(o),committingCS:C.default.pack(i),userCS:C.default.pack(a),newChange:C.default.pack(n),baseRev:s,guid:window.cow.currentFile.guid},"reducer/msg.js",0,0,{name:"sheet_changeset_error",message:"changeset invert error"}),e}T.default.record(u)}var c=e.userCS.compose(n),f=(0,O.updateState)(e,{userCS:c});return y(),_(f),f}function a(e){console.dir(e.userCS);var t,n;if(t=e.submittedCS.compose(e.userCS),!t.isDocument)return console.dir(t.ops),alert("文档出错，请刷新重试！"),e;var r=(0,S.v4)();n=g(e.userCS,e.revision,r,e.clientId),M.default.send("message",n);var o=(0,O.updateState)(e,{status:"sending",committingCS:e.userCS,userCS:new w.Delta,uuid:r});return _(o),o}function s(e){var t,n,r;return r=e.committingCS,e.isReconnect&&0!==r.length?(t=e.submittedCS.compose(r),t.isDocument?(n=g(r,e.revision,e.uuid,e.clientId),M.default.send("message",n),e):(console.dir(t.ops),alert("文档出错，请刷新重试！"),e)):e}function l(e,t,n){return v(e),"REPEAT_COMMIT"===n?(0,O.updateState)(e,{status:"sended",offline:!1,committingCS:new w.Delta}):(0,O.updateState)(e,{status:"sended",offline:!1,submittedCS:e.submittedCS.compose(e.committingCS),committingCS:new w.Delta,revision:t})}function u(e,t,n){if(n<=e.revision)return e;var r;return t=C.default.unpack(t),r=c(e,t),T.default.transform(t),(0,O.updateState)(e,{revision:n,submittedCS:r._a,committingCS:r._x,userCS:r._y,applyCS:r.d,fromPush:!0})}function c(e,t){var n,r,o,i,a,s,l,u;return n=e.userCS,r=e.committingCS,o=e.submittedCS,i=r.transform(t),a=o.compose(t),s=t.transform(r,!0),l=i.transform(n),u=n.transform(i),{_a:a,_x:s,_y:l,d:f(a.compose(s).compose(l),u)}}function f(e,t){for(var n=t.ops,r=n.length,o=[],i=void 0,a=0,s=0;s<r;s++)i=n[s],"object"===b(i.data)||"insert"===i.action?function(){var t=e.ops[a],n=t.getAttributes()||{},r={};i.data.cells.forEach(function(e){var n=i.data.cells.get(e),o=void 0;if(1===n.data)o=1;else{o=t.data.cells.get(e).data}r[e]=new w.CellOperator({action:"insert",data:o,attributes:n.getAttributes()})}),i=new w.TableOperator({action:i.action,attributes:(0,N.assign)({id:n.id},i.getAttributes()),data:{cells:r,rows:i.data.rows,cols:i.data.cols}}),a+=1}():a+=i.data,o.push(i);return new w.Delta(o)}function d(e){var t,n,r=e.submittedCS,o=e.committingCS,i=e.userCS,a=r.compose(o).compose(i);if(!(t=T.default.popUndo()))return e;n=a.invert(t),T.default.pushRedo(n);var s=i.compose(t),l=(0,O.updateState)(e,{userCS:s,applyCS:t,fromPush:!1});return y(),_(l),l}function p(e){var t,n,r=e.submittedCS,o=e.committingCS,i=e.userCS,a=r.compose(o).compose(i);if(!(n=T.default.popRedo()))return e;t=a.invert(n),T.default.record(t);var s=i.compose(n),l=(0,O.updateState)(e,{userCS:s,applyCS:n,fromPush:!1});return y(),_(l),l}function h(e,t,n){if(window.cow.idx)return e;var r={component:"pad",type:"ready"===t?"CLIENT_READY":"CLIENT_QUIT",padId:window.cow.currentSheetGuid,collabId:e.clientId,reconnect:!0,client_rev:e.revision,sessionID:I.default.get("sessionID"),token:I.default.get("token"),protocolVersion:2};return M.default.send("message",r),(0,O.updateState)(e,{isReady:!0,isReconnect:n||!1})}function m(e){return(0,O.updateState)(e,{offline:!0})}function g(e,t,n,r){return{type:"COLLABROOM",component:"pad",padId:window.cow.currentSheetGuid,collabId:r,data:{type:"USER_CHANGES",baseRev:t,changeset:C.default.pack(e),uuid:n}}}function _(e){var t=window.cow.currentFile.guid;if(!window.cow.usingNewSeq&&e.storage){var n=e.storage,r=e.committingCS,o=e.userCS,i=e.revision,a=e.uuid,s={committingCS:{guid:t,rev:i,changeset:C.default.pack(r),uuid:a},userCS:{changeset:C.default.pack(o),rev:i}};n.set(t,s).then(function(){e.offline&&k.default.notify("saveStatus:offlineSuccess")}).catch(function(){e.offline&&k.default.notify("accept:error","storage_exceeded_quota")})}}function v(e){var t=window.cow.currentFile.guid;!window.cow.usingNewSeq&&e.storage&&e.storage.set(t,{committingCS:null,userCS:null})}function y(){k.default.notify("saveStatus:start"),setTimeout(function(){window.cow.curSheetComposeUserChange&&window.cow.curSheetComposeUserChange()},0)}var b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w=n(53),C=r(w),S=n(176),x=n(898),T=r(x),E=n(711),M=r(E),A=n(9),k=r(A),R=n(89),I=r(R),O=n(428),D=n(328),P=r(D),N=n(1),F={status:"sended",offline:!1,isReady:!1,disableUndoRedo:!1,submittedCS:new w.Delta,committingCS:new w.Delta,userCS:new w.Delta,applyCS:null,fromPush:!1,revision:0,isReconnect:!1,uuid:null,storage:null,clientId:null};e.exports=function(e,t){switch(e=e||F,t.type){case"RECEIVE_INIT_SHEET":return o(e,t.submittedCS,t.revision);case"COMPOSE_USER_CHANGES":return i(e,t.newChange,t.disableRecords);case"SEND_CHANGE":return a(e);case"SEND_OFFLINE_CHANGE":return s(e);case"SEND_CHANGE_SUCCESS":return k.default.notify("saveStatus:success"),l(e,t.revision,t.msgType);case"NEW_CHANGE_FROM_SERVER":return k.default.notify("saveStatus:getUpdate"),u(e,t.newChange,t.revision);case"UNDO":return d(e);case"REDO":return p(e);case"DISABLE_UNDO_REDO":return(0,O.updateState)(e,{disableUndoRedo:!0});case"ENABLE_UNDO_REDO":return(0,O.updateState)(e,{disableUndoRedo:!1});case"SEND_CLIENT_STATUS":return h(e,t.status,t.isReconnect);case"OFFLINE":return k.default.notify("saveStatus:offline"),m(e);case"ENABLE_BY_LOCKCELL":return(0,O.updateState)(e,{disableByLockCell:!1});case"DISABLE_BY_LOCKCELL":return(0,O.updateState)(e,{disableByLockCell:!0})}return e}}).call(t,n(573))},function(e,t){var n={undoStack:[],redoStack:[],undoableNum:0,redoableNum:0,maxRecordLen:10,record:function(e){this.undoStack.length>=this.maxRecordLen&&(this.undoableNum-=1,this.undoStack.shift()),this.undoStack.push(e),this.undoableNum+=1},transform:function(e){var t=function(t){return e.transform(t,!0)};this.undoStack=this.undoStack.map(t),this.redoStack=this.redoStack.map(t)},isUndoable:function(){return!!this.undoableNum},isRedoable:function(){return!!this.redoableNum},popUndo:function(){var e=this.undoStack.pop();return this.undoableNum-=1,e},pushRedo:function(e){this.undoStack.length>=this.maxRecordLen&&(this.redoableNum-=1,this.undoStack.shift()),this.redoStack.push(e),this.redoableNum+=1},popRedo:function(){var e=this.redoStack.pop();return this.redoableNum-=1,e},clearUndo:function(){this.undoStack=[],this.undoableNum=0},clearRedo:function(){this.redoStack=[],this.redoableNum=0},clear:function(){this.clearUndo(),this.clearRedo()}};e.exports=n},function(e,t,n){function r(e,t){switch(e=e||i,t.type){case"UPDATE_SELECTED_CELL":return(0,o.updateState)(e,{selectedCellVal:t.selectedCellVal})}return e}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var o=n(428),i={selectedCellVal:""};e.exports=t.default},function(e,t,n){(function(t){function r(e,t){return p.send("message",{type:"COLLABROOM",padId:window.cow.currentSheetGuid,data:{type:"SELECT",sheetId:window.cow.currentSheetId,range:t}}),e}function o(e,n){var r=t.cloneDeep(e.collaborators),o=t.cloneDeep(e.collabUserIds),i=n.data.userInfo.id,a=n.data.sheetId;return n.data.userInfo.color=d.getColor(i),r[a]&&o[a]||(r[a]=[],o[a]={}),void 0!==o[a][i]&&r[a].splice(o[a][i],1),o[a][i]=r[a].length,r[a].push(n),h(e,{collaborators:r,collabUserIds:o})}function i(e,n){var r=t.cloneDeep(e.collaborators);return r=c(r,n),h(e,{collaborators:r,updateCollab:!0})}function a(e,n){var r=t.cloneDeep(e.collaborators);return r=f(r,n),h(e,{collaborators:r,updateCollab:!0})}function s(e,n){var r=t.cloneDeep(e.collaborators);return r=f(r,n),h(e,{collaborators:r,updateCollab:!0})}function l(e){return h(e,{updateCollab:!1})}function u(e){return h(e,{collaborators:{},collabUserIds:{},updateCollab:!1})}function c(e,n){var r,o=n.data.sheetId;return e[o]||(e[o]=[]),r=e[o],t.remove(r,function(e){return e.data.userInfo.id===n.data.userInfo.id}),e}function f(e,t){var n,r=t.data.sheetId,o=0,i=0;for(e[r]||(e[r]=[]),n=e[r],o=0,i=n.length;o<i;o++)if(t.data.userInfo.id==n[o].data.userInfo.id){n[o].data.range=t.data.range;break}return o==i&&(t.data.userInfo.color=d.getColor(t.data.userInfo.id),n.push(t)),e}var d=n(433),p=n(711),h=n(428).updateState,m={collaborators:{},collabUserIds:{},updateCollab:!1};e.exports=function(e,t){switch(e=e||m,t.type){case"SEND_SELECT_CELL":return r(e,t.cords);case"RECIEVE_ENTER_COLLABORATOR":return o(e,t.collaborator);case"RECIEVE_LEAVE_COLLABORATOR":return i(e,t.collaborator);case"RECEIVE_COLLABORATOR_SELECTED":return a(e,t.collaborator);case"RECEIVE_COLLABORATOR_UNSELECTED":return s(e,t.collaborator);case"UPDATE_COLLAB_DONE":return l(e);case"RESET_COLLAB":return u(e)}return e}}).call(t,n(1))},function(e,t,n){var r=n(428).updateState,o={fontSize:"",color:"",background:"",align:"",vertical:"",boldSelected:!1,italicSelected:!1,underlineSelected:!1,strikethroughSelected:!1};e.exports=function(e,t){switch(e=e||o,t.type){case"SET_MENU_SELECTION":return r(e,t.selection)}return e}},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];switch(t.type){case"PATCH_USERS":return(0,l.default)({},t.payload);case"GET_SHARED_USERS_FAILED":return{};default:return e}}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];switch(t.type){case"UPDATE_PERMISSIONS":return(0,l.default)({},e,t.payload);case"PATCH_PERMISSIONS":var n=t.payload,r=n.fileGuid,o=n.userId,i=n.permission;return e[r][o]=i,(0,l.default)({},e);default:return e}}function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];switch(t.type){case"PATCH_SHARED_USERS":return(0,l.default)({},e,t.payload);default:return e}}Object.defineProperty(t,"__esModule",{value:!0});var s=n(345),l=r(s),u=n(151);t.default=(0,u.combineReducers)({users:o,permissions:i,filePermissions:a}),e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var n=s.default.unpack(e);return p.dispatch(d.default.receivedInitSheet(n,t)),n}function i(e,t,n){var r,i=window.cow.tempCurrentFile,a=i.content;if(e===i.guid&&!t&&a)return n||(r=o(a,i.head),r.guid=e),window.cow.tempCurrentFile.authorized=window.cow.authorized,i.tableData=r,Promise.resolve(i);var s="/-/"+e;return(0,l.ajaxGet)(s).then(function(t){var i;if(0===t.code)return i=t.data.file,i.authorized=t.data.authorized,n||(r=o(i.content,i.head),r.guid=e),window.cow.tempCurrentFile=i,i.tableData=r,i;throw new Error(t)}).catch(function(e){throw new Error(e)})}Object.defineProperty(t,"__esModule",{value:!0}),t.resolveTableData=o,t.getSpreadsheetByGuid=i;var a=n(53),s=r(a),l=n(22),u=n(842),c=r(u),f=n(709),d=r(f),p=c.default.getInstance();window.richdoc=s.default},,function(e,t,n){(function(r){function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e){return e}function c(e){return{composeUserChanges:function(t){return e(U.default.composeUserChanges(t))},sendChange:function(){return e(U.default.sendChange())},undo:function(){return e(z.default.undo())},redo:function(){return e(z.default.redo())},enableUndoRedo:function(){return e(z.default.enableUndoRedo())},disableUndoRedo:function(){return e(z.default.disableUndoRedo())},updateCollabDone:function(){return e(j.default.updateCollabDone())},setMenuSelection:function(t){return e(H.default.setMenuSelection(t))},disableByLockCell:function(){return e(z.default.disableByLockCell())},enableByLockCell:function(){return e(z.default.enableByLockCell())},sendSelectCell:function(t){return e(j.default.sendSelectCell(t))},toggleLockSidebar:function(t){return e(F.toggleLockSidebar(t))},changeSheetId:function(t){return e(F.changeSheetId(t))},resetCollab:function(){return e(j.default.resetCollab())},getSharedUsers:function(t){return e(G.getSharedUsers(t))},toogleSidebar:function(t){return e(F.toogleSidebar(t))},hideSidebar:function(){return e(F.hideSidebar())},toogleHighLight:function(){return e(F.toogleHighLight())},addSendChangeTimeout:function(t){return e((0,y.addTimeout)(t,"SEND_CHANGE_SUCCESS",U.default.offline()))},removeSendChangeTimeout:function(){return e((0,y.removeTimeout)("SEND_CHANGE_SUCCESS"))},changeSheetZoom:function(t){return e({type:"CHANGE_SHEET_ZOOM",zoom:t})}}}Object.defineProperty(t,"__esModule",{value:!0});var f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=n(0),p=i(d),h=n(268),m=n(5),g=i(m),_=n(9),v=i(_),y=n(725),b=n(1447),w=i(b),C=n(1564),S=i(C),x=n(1566),T=i(x),E=n(1104),M=i(E),A=n(1103),k=n(1593),R=i(k),I=n(1599),O=i(I),D=n(1602),P=i(D),N=n(1604),F=o(N),L=n(1605),H=i(L),V=n(1158),j=i(V),B=n(709),U=i(B),W=n(1606),z=i(W),Y=n(1607),G=o(Y),K=n(1608),X=i(K),q=function(e){function t(e){a(this,t);var n=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={disableAsync:!1},n.clickNum=0,n._triggerSurprise=n._triggerSurprise.bind(n),n}return l(t,e),f(t,null,[{key:"propTypes",get:function(){return{msg:d.PropTypes.object,spreadsheet:d.PropTypes.object,addSendChangeTimeout:d.PropTypes.func,removeSendChangeTimeout:d.PropTypes.func,toogleSidebar:d.PropTypes.func}}}]),f(t,[{key:"componentWillReceiveProps",value:function(e){var t=this.props,n=t.msg.status,r=e.msg.status,o=t.spreadsheet.shownSidebar,i=e.spreadsheet.shownSidebar;o!==i&&this._toogleTableThin(null!==i);var a=e.msg.storage&&!window.cow.usingNewSeq?15e3:3e4;"sended"===n&&"sending"===r&&t.addSendChangeTimeout(a),"sended"===r&&"sending"===n&&t.removeSendChangeTimeout()}},{key:"shouldComponentUpdate",value:function(e){var t=e.spreadsheet.data;return"sheet"===window.cow.pageType&&t&&t.guid===window.cow.currentSheetGuid}},{key:"componentWillUnmount",value:function(){this.props.removeSendChangeTimeout()}},{key:"_isReadyRender",value:function(){var e=this.props,t=e.spreadsheet.data;return!(!t||t.guid!==window.cow.currentSheetGuid)}},{key:"_hideSidebar",value:function(){this.props.toogleSidebar(null),v.default.notify("keepCellEditStatus")}},{key:"_toogleTableThin",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];r("#sheet-view")[0].classList[e?"add":"remove"]("thin")}},{key:"_triggerSurprise",value:function(){var e=(new Date).getTime();0===this.clickNum&&(this.start=e),0!==this.clickNum&&e-this.start>1e3&&(this.start=e,this.clickNum=0),this.clickNum+=1,3===this.clickNum&&(this.clickNum=0,this.setState({disableAsync:!0}),g.default.alert({title:"已切换到同步模式"}))}},{key:"render",value:function(){var e=this,t=this.props,n=void 0,r=void 0,o=void 0;return this._isReadyRender()?(g.default.isMobile()||g.default.isDingtalkPcSidebar()||(n=p.default.createElement("div",{className:"s-head"},p.default.createElement("div",{className:"s-menu-wrap"},p.default.createElement(R.default,{offline:t.msg.offline,disableUndoRedo:t.msg.disableUndoRedo,disableByLockCell:t.msg.disableByLockCell,selection:t.selection,setMenuSelection:t.setMenuSelection,undo:t.undo,redo:t.redo,toogleSidebar:t.toogleSidebar,hideSidebar:t.hideSidebar,spreadsheet:t.spreadsheet})),p.default.createElement("div",{className:"fx-editor-wrap"},p.default.createElement("div",{className:"fx-left-label"},p.default.createElement("span",{className:"fx-left-label-text",onClick:this._triggerSurprise},p.default.createElement("img",{src:(0,A.getIcon)("fx"),style:{width:12}}))),p.default.createElement("div",{id:"gc-fx-editor",contentEditable:"true",style:{marginLeft:"58px",padding:"5px 0"}})),p.default.createElement("div",{className:"lock-sheet-toolbar-mask"})),r=p.default.createElement(O.default,{highLight:t.spreadsheet.highLight,shown:"history"===t.spreadsheet.shownSidebar,guid:t.spreadsheet.data.guid,toogleHighLight:t.toogleHighLight,toogleSidebar:t.toogleSidebar,hideSidebar:t.hideSidebar}),o=p.default.createElement(X.default,{shown:t.spreadsheet.showLockSidebar,lockpermission:t.lockpermission,toggleLockSidebar:t.toggleLockSidebar,changeSheetId:t.changeSheetId})),p.default.createElement("div",null,n,p.default.createElement("div",{className:"s-body"},p.default.createElement(T.default,{guid:t.guid,menu:t.menu,spreadsheet:t.spreadsheet.data.tableData,msg:t.msg,zoom:t.spreadsheet.zoom,sheetId:t.spreadsheet.sheetId,editor:t.editor,collaborators:t.collaborators,lockpermission:t.lockpermission,disableAsync:this.state.disableAsync,composeUserChanges:t.composeUserChanges,sendChange:t.sendChange,undo:t.undo,redo:t.redo,changeSheetZoom:t.changeSheetZoom,enableUndoRedo:t.enableUndoRedo,disableUndoRedo:t.disableUndoRedo,updateCollabDone:t.updateCollabDone,setMenuSelection:t.setMenuSelection,disableByLockCell:t.disableByLockCell,enableByLockCell:t.enableByLockCell,sendSelectCell:t.sendSelectCell,toggleLockSidebar:t.toggleLockSidebar,changeSheetId:t.changeSheetId,resetCollab:t.resetCollab,getSharedUsers:t.getSharedUsers}),p.default.createElement(M.default,{type:"spreadsheet"})),p.default.createElement("div",{className:"s-history"},p.default.createElement(P.default,{guid:t.guid,msg:t.msg,highLight:t.spreadsheet.highLight,zoom:t.spreadsheet.zoom})),r,o,p.default.createElement(w.default,{style:{marginRight:20,top:98},shown:"formula"===t.spreadsheet.shownSidebar},p.default.createElement(S.default,{onSelect:function(e){return v.default.notify("menu:formulaChange",e)},onClose:function(){return e._hideSidebar()}})))):null}}]),t}(d.Component);t.default=(0,h.connect)(u,c)(q),e.exports=t.default}).call(t,n(2))},,,,function(e,t,n){(function(e){function r(e){return e&&e.__esModule?e:{default:e}}function o(t,n,r){var o=t.getStyle(n,r)||{},i={},a=c(o.font),s=a.fontStyle,l=a.fontWeight,u=a.fontSize,h=p(o.textDecoration),m=t.getSpan(n,r),g=t.getFormula(n,r),v=t.getCellType(n,r);if(e.assign(o,{fontStyle:s,fontWeight:l,fontSize:u},h),e.forIn(o,function(e,t){if(e||0===e)switch(t){case"foreColor":i.color=e;break;case"backColor":i.background=e;break;case"lineThrough":i.strike=e;break;case"underline":i.underline=e;break;case"vAlign":i.vertical=["top","center","bottom"][e];break;case"hAlign":i.align=["left","center","right"][e];break;case"manualAlign":i.manualAlign=e;break;case"borderTop":case"borderRight":case"borderBottom":case"borderLeft":var n=t.toLowerCase().substr(6),r=e,o=r.color,a=r.style;i["border-"+n]=JSON.stringify([o,a])}switch(t){case"fontWeight":"bold"!==e&&"700"!==e||(i.bold=!0);break;case"fontStyle":"italic"===e&&(i.italic=!0);break;case"fontSize":var s=d(e);s&&(i["font-size"]=s);break;case"wordWrap":i.wrap=e?"text-wrap":"text-no-wrap";break;case"formatter":_.INVERT_TEMP_NEW_FORMAT_MAP[e]&&(e=_.INVERT_TEMP_NEW_FORMAT_MAP[e]),i.format=e}}),m&&m.row===n&&m.col===r){var y=m.rowCount,b=m.colCount;i.rowspan=y,i.colspan=b}if(f(v)&&(i.link=t.getValue(n,r),i.linkToolTip=v._linkToolTip),!i.format&&o._autoFormatter&&o._autoFormatter.formatters){var w=o._autoFormatter.formatters[0],C=void 0;w&&(C=w.formatCached),_.INVERT_TEMP_NEW_FORMAT_MAP[C]&&(C=_.INVERT_TEMP_NEW_FORMAT_MAP[C]),i.autoFormatter=C}return g&&(i.formula=g),i}function i(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=[];return e.forEach(n,function(e){for(var n=e.row,o=e.col,i=e.rowCount,s=e.colCount,l=n,u=n+i-1;l<=u;l++)for(var c=o,f=o+s-1;c<=f;c++)r.push([l,c,a(t,l,c)])}),r}function a(e,t,n){var r=o(e,t,n),i=r.format||r.autoFormatter,a=void 0;if(r.formula)a=null;else if(r.link){var l=e.getCellType(t,n);a=l._value}else a=(0,_.isDateFormat)(i)?s(e,e.getValue(t,n),t,n):e.getValue(t,n);return{value:a,attrs:r}}function s(e,t,n,r){return t instanceof Date?(0,b.getDateText)(t):(0,y.isNumeric)(t)?t:e.getText(n,r)}function l(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments[2],o=[];return e.forEach(n,function(n){var i=h(n,3),s=i[0],l=i[1],u=i[2],c=a(t,s,l),f=u.attrs||{};r&&(c.attrs=e.assign((0,v.clearAttrs)(f),c.attrs)),o.push([s,l,u,c])}),o}function u(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=[];return e.forEach(r,function(e){for(var t=e.row,r=e.col,i=e.rowCount,a=e.colCount,s=t,l=t+i-1;s<=l;s++)for(var u=r,c=r+a-1;u<=c;u++)o.push([s,u,{},{attrs:n}])}),o}function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=C[e];if(t)return t;var n=/pt|px/,r=e.split(",");n.test(r[0])||r.unshift("");for(var o=r[0].split(" "),i="",a="",s="",l=0,u=o.length-1;l<u;l++){var c=o[l];"italic"===c?a=c:"bold"===c?i=c:n.test(c)&&(s=c)}return C[e]={fontStyle:a,fontWeight:i,fontSize:s,fontItems:o,items:r},C[e]}function f(e){return e&&e instanceof w.CellTypes.HyperLink}function d(e){return e.indexOf("pt")>-1?e=+e.replace("pt",""):e.indexOf("px")>-1&&(e=Math.round(e.replace("px","")/1.33333)),e}function p(e){var t=w.TextDecorationType,n=t.underline,r=t.lineThrough;return{underline:(e&n)===n,lineThrough:(e&r)===r}}Object.defineProperty(t,"__esModule",{value:!0});var h=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.getCellAttrs=o,t.getCellsByRanges=i,t.getCell=a,t.getDateFormatVal=s,t.appendNewCells=l,t.genNewCellsByAttrs=u,t.splitFont=c,t.isLinkType=f;var m=n(721),g=r(m),_=n(533),v=n(253),y=n(254),b=n(562),w=g.default.Spread.Sheets,C={}}).call(t,n(1))},function(e,t,n){(function(r){Object.defineProperty(t,"__esModule",{value:!0});var o=n(53),i=n(253),a=function(){function e(e){var t=e.store,n=e.guid;this.store=t,this.guid=n,this.preMsgState=null,this.cachedDoc=null,this.cachedSortedDoc=null,this.cachedCells={}}var t={getCurDoc:function(e){var t=this.store,n=this.preMsgState,r=void 0,a=void 0,s=void 0,l=void 0,u=void 0,c=!1,f=t.getState().msg;return c=f===n,c||(s=f.submittedCS,l=f.committingCS,u=f.userCS,r=s.compose(l).compose(u),a=new o.Delta((0,i.sortOps)(r.ops)),this.preMsgState=f,this.cachedDoc=r,this.cachedSortedDoc=a,this.cachedCells={}),e?this.cachedDoc:this.cachedSortedDoc},getCsByCoords:function(e,t,n,r){var i=r.index,a=r.sheetId,s=void 0,l=this.getCurDoc(),u=n||l;if(0===u.length)return null;void 0===i&&(i=this.findTableOpIndexByCs(a,u));var c=i+"-"+e+"-"+t;if(u===l&&this.cachedCells[c])return this.cachedCells[c];var f=u.ops[i].data,d=f.cells,p=(0,o.stringifyPosition)(e,t);return s=d.get(p),s&&(s=s.set({action:"retain"})),this.cachedCells[c]=s,s},getTableOps:function(e){var t=this.getCurDoc();return this.findTableOpByCs(e,t)},getTableOpAttrs:function(e){return this.getTableOps(e).getAttributes()||{}},findTableOpByCs:function(e,t){return t.ops[this.findTableOpIndexByCs(e,t)]},findTableOpIndexByCs:function(e,t){var n=t.ops,o=r.findIndex(n,function(t){var n=t.getAttributes();return n&&n.id===e});return-1===o&&(o=0),o},getCurTableOpIndex:function(e,t,n){return t=t||this.getCurDoc(n),this.findTableOpIndexByCs(e,t)},getTableOpIndexByCs:function(e,t){return this.findTableOpIndexByCs(e,t)},wrapCurSheetCs:function(e,t){var n=t.index,i=t.sheetId,a=this.getCurDoc(!0),s=[],l=void 0;(l=void 0===n?this.getTableOpIndexByCs(i,a):n)>0&&s.push(new o.TableOperator({action:"retain",data:l}));var u=a.ops[l].getAttributes();return e=e.set({attributes:r.extend(e.getAttributes(),{id:u.id})}),s.push(e),new o.Delta(s)},wrapCs:function(e){return e[0]?this.wrapCurSheetCs.apply(this,e):new o.Delta}};e.prototype=t;var n={};return{getInst:function(t){var r=t.store,o=t.guid;if(void 0===n[o]){if(void 0===r)throw new Error("Store parameter must be required");n[o]=new e({store:r,guid:o})}return n[o]},destory:function(e){void 0===e?n={}:delete n[e]}}}();t.default=a,e.exports=t.default}).call(t,n(1))},,function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){window.postMessage&&1===window.postMessage.length&&window.postMessage(JSON.stringify({action:e,data:t}))},e.exports=t.default},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default={DOCUMENT:{READY:"document:ready",SHOW_COMMENTS:"document:showComments",SHOW_IMAGES:"document:showImages",HIDE_MENTION:"document:hideMention",SHOW_MENTION:"document:showMention",INPUT_MENTION:"document:inputMention",OPEN_LINK:"document:openLink",SELECTION_CHANGED:"document:selectionChanged",UPDATE_STATUS:"document:updateStatus",START_COMMENT:"document:startComment"},SHEET:{SELECT_CELL:"sheet:selectCell"},FILE:{SAVE:"file:save",SYNC:"file:sync",DENIED:"file:denied",START_EDITING:"file:startEditing",END_EDITING:"file:endEditing",UPDATE_TITLE:"file:updateTitle",TITLE_STATUS_CHANGED:"file:titleStatusChanged",UPDATE_COOPERATORS:"file:updateCooperators",DENY_ACCESS:"file:denyAccess"}},e.exports=t.default},,,,,,,,,function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"render",value:function(){var e={};return this.props.size&&(e.fontSize=this.props.size+"px"),u.default.createElement("div",{className:"spinner-wrap",style:e},u.default.createElement("div",{className:"spinner-blade"}),u.default.createElement("div",{className:"spinner-blade"}),u.default.createElement("div",{className:"spinner-blade"}),u.default.createElement("div",{className:"spinner-blade"}),u.default.createElement("div",{className:"spinner-blade"}),u.default.createElement("div",{className:"spinner-blade"}),u.default.createElement("div",{className:"spinner-blade"}),u.default.createElement("div",{className:"spinner-blade"}),u.default.createElement("div",{className:"spinner-blade"}),u.default.createElement("div",{className:"spinner-blade"}),u.default.createElement("div",{className:"spinner-blade"}),u.default.createElement("div",{className:"spinner-blade"}))}}],[{key:"propTypes",get:function(){return{size:l.PropTypes.number}}}]),t}(l.Component);t.default=c,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(922),f=r(c),d=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"render",value:function(){if(this.props.show){var e={backgroundColor:this.props.overlayColor||"transparent",position:"absolute",top:"0",right:"0",bottom:"0",left:"0"};return u.default.createElement("div",{style:e},u.default.createElement(f.default,{size:this.props.size}))}return null}}],[{key:"propTypes",get:function(){return{overlayColor:l.PropTypes.string,show:l.PropTypes.bool,size:l.PropTypes.number}}}]),t}(l.Component);t.default=d,e.exports=t.default},function(e,t){function n(){return/firefox/.test(o)}function r(){return window.devicePixelRatio>=2}Object.defineProperty(t,"__esModule",{value:!0});var o=window.navigator.userAgent.toLowerCase();t.default={isFireFox:n,isRetina:r},e.exports=t.default},,function(e,t,n){(function(e,r){function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e){return e&&e.__esModule?e:{default:e}}function a(e){var t=e.invalidType,n=e.message,r="操作失败";10===t?(r="无法排序",n="不能对包含合并单元格的行进行排序"):n.match(/被保护的/)?n="您尝试修改的单元格当前是被保护的。":n.match(/[\u3400-\u9FBF]/)||(n="出现异常，请检查输入是否正确!"),(0,pe.default)({title:r,description:n,abortClass:"hide"})}function s(e,t,n){var r=(0,se.getCellAttrs)(e,t,n),o=r.align,i=r.vertical,a=r.wrap,s=r.bold,l=r.italic,u=r.strike,c=r.underline,f=r.autoFormatter,d=r.format;return d||(d=f),{fontSize:r["font-size"],align:!o&&d?"right":o,vertical:i,wrap:a,boldSelected:s,italicSelected:l,underlineSelected:c,strikethroughSelected:u,format:d}}function l(t,n){var r=[];return e.forEach(n,function(e){var n=e.row,o=e.col,i=t.getSpan(n,o)||{row:n,col:o,rowCount:null,colCount:null};r.push(i)}),r}function u(t,n,r){for(var o=(0,ae.getCellRangeByRowOrCol)(t,e.last(n)+1,r),i=t.getSpans(o),a=[],s=0,l=i.length;s<l;s++)for(var u=i[s],c=u[r],f=u[r+"Count"],d=0,p=n.length;d<p;d++){var h=n[d];if(h>c&&h<=c+f-1){a.push(u);break}}return a}function c(t,n,r){function o(e,t,n){for(var r=e[t],o=e[t+"Count"],i=r,a=r+o;i<a;i++)n.indexOf(i)>-1&&o--;return{count:o}}var i=(0,ae.getCellRangeByRowOrCol)(t,e.last(n)+1,r),a=t.getSpans(i),s=[];return e.forEach(a,function(e){for(var t=e.row,i=e.col,a=e.rowCount,l=e.colCount,u=e[r],c=0,f=0,d=n.length;f<d;f++){if(u===n[f]){var p=o(e,r,n,c),h=p.count;"row"===r&&(h>=2||h>=1&&l>1)?s.push({row:u-c,col:i,rowCount:h,colCount:l}):"col"===r&&(h>=2||h>=1&&a>1)&&s.push({row:t,col:u-c,rowCount:a,colCount:h});break}c+=1}}),s}function f(e){var t=/^(?!^ )[\w\u4e00-\u9fa5 ]+$/g;if(!e.toString().trim())throw new Error("工作表名称不能为空!");if(!t.test(e))throw new Error("工作表名称只能包含中英文,数字,下划线,空格，但不能以空格开始")}function d(t){var n=[],r=(0,ae.getAllSelections)(t);return r.length||(r=[{row:0,col:0,rowCount:1,colCount:1}]),e.forEach(r,function(e){var t=e.row,r=e.col,o=e.rowCount,i=e.colCount;n.push({row:t,col:r,rowCount:o,colCount:i})}),n}function p(t,n){var r=t.conditionalFormats._rules,o={},i={},a=t.attrs||{};return e.forEach(r,function(e){o[e.name()]=e.ranges()}),e.forEach(n,function(t){var n=t.name(),r=o[n];if(r){var s=a[n];!e.isEqual(t.ranges(),r)&&s&&(s.selections=r,i[n]=s)}else i[n]=null}),i}function h(e){var t="保存失败，请复制表格内容到本地，刷新后重新使用";"storage_exceeded_quota"===e&&(t="您的离线存储空间已满，为保证数据不丢失，请在网络恢复后再继续编辑。已有离线编辑内容会在网络连接后自动同步。"),(0,ae.protectSpread)(this.spread),"offline"!==e&&re.default.notify("saveStatus:error"),(0,pe.default)({title:"保存失败",description:t,abortClass:"hide"}),"invert_error"!==e&&r("sheet_changeset_error","",0,0,{name:"sheet_changeset_error",message:e}),console.log("save error:"+e)}function m(t,n,r,o){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"row",a=arguments[5],s={},l=void 0;if(a){var u=[n,r].sort(function(e,t){return e-t});l=e.range(u[0],u[1]+1)}else l=e.range(n,n+o).concat(e.range(r,r+o)).sort(function(e,t){return e-t});return l.forEach(function(e){s[e]="row"===i?{height:t._getActualRowHeight(e),autoFit:t.getAutoFitRowHeight(e)}:{width:t._getActualColumnWidth(e)}}),s}function g(e,t,n){var r=n.fromRow,o=n.fromCol,i=n.toRow,a=n.toCol,s=n.rowCount,l=n.colCount,u=n.insert,c=[];if(u){if(-1===r){var f=[o,a].sort(function(e,t){return e-t});c=[new t(e,0,f[0],e.getRowCount(),f[1]-f[0]+l)]}else{var d=[r,i].sort(function(e,t){return e-t});c=[new t(e,d[0],0,d[1]-d[0]+s,e.getColumnCount())]}}else{c=[(0,ae.getActualCellRange)(e,new t(e,r,o,s,l)),(0,ae.getActualCellRange)(e,new t(e,i,a,s,l))]}return c}function _(e,t){var n=e.lockerId,r=!1,o={},i={readOnly:[],forbid:[],editable:[]},a=e.guid();return t.forEach(function(e){1===e.permission?(i.readOnly.push(e.id),n&&n===e.id&&(r=!0)):2===e.permission?(i.forbid.push(e.id),n&&n===e.id&&(r=!0)):i.editable.push(e.id)}),i.lockerId=r||!n?window.cow.currentUser.id:n,e.lockerId=i.lockerId,o.lock=JSON.stringify(i),a&&(o.id=a),o}function v(e,t,n,r){var o=n?n[0]:"lock-"+ie.default.genGuid(),i={},a={readOnly:[],forbid:[],editable:[],ranges:[],lockerId:null},s=e.guid();return r.forEach(function(e){1===e.permission?a.readOnly.push(e.id):2===e.permission?a.forbid.push(e.id):a.editable.push(e.id)}),a.lockerId=window.cow.currentUser.id,a.ranges.push((0,ae.cellRange2LockRange)(t)),i[o]=JSON.stringify(a),s&&(i.id=s),i}function y(e){return w(e)}function b(e,t){return w(e,t)}function w(t,n){var r={};if(e.isArray(n))e.forEach(n,function(e){r[e]=null});else{r[n||"lock"]=null}var o=t.guid();return o&&(r.id=o),t.lockerId=null,r}function C(e,t){return w(e,t)}function S(t,n,r,o){function i(e){var t=e.rowCount,n=e.colCount;return t<1||n<1}var a=(0,ae.getSheetCellLocks)(t),s={},l="insert"===n,u=l?[(0,ae.getCurSelection)(t)]:(0,ae.getAllSelections)(t);return a.forEach(function(t){var n=$(t,2),a=n[0],c=n[1],f=c.ranges[0],d=e.assign({},f),p=r+"Count",h=f[r],m=h+f[p]-1;u.forEach(function(e){var t=e[p],n=e[r];if(l&&"down"!==o&&"right"!==o&&n--,l)h>n?d[r]+=t:m>n&&(d[p]+=t);else{h>n&&(d[r]-=Math.min(t,h-n));var i=(0,ae.getRangeIntersectCount)([h,m],[n,n+t-1]);i&&(d[p]-=i)}}),e.isEqual(d,f)||(!l&&i(d)?s[a]=null:s[a]=JSON.stringify(e.assign({},c,{ranges:[(0,ae.cellRange2LockRange)(d)]})))}),s}function x(){re.default.notify("spreadsheet:lock:toolbar:enable")}function T(){re.default.notify("spreadsheet:lock:toolbar:disable")}function E(e,t,n,r,o,i){for(var a=[],s=void 0,l=0;l<t;l++)for(var u=0;u<n;u++){var c=e.getFormula(l,u);c&&(s="row"===i?l<r?[l,u]:[l+o,u]:u<r?[l,u]:[l,u+o],a.push([s[0],s[1],(0,se.getCell)(e,l,u)]))}return a}function M(t,n,r,o,i){var a=[],s="row"===i,l=e.clone(o),u=void 0,c=0;if(s)for(var f=0;f<n;f++)if(f!==l[0])for(var d=0;d<r;d++){var p=t.getFormula(f,d);p&&(u=[f-c,d],u[0]>-1&&u[1]>-1&&a.push([u[0],u[1],(0,se.getCell)(t,f,d)]))}else c+=1,l.splice(0,1);else for(var h=0;h<r;h++)if(h!==l[0])for(var m=0;m<n;m++){var g=t.getFormula(m,h);g&&(u=[m,h-c],u[0]>-1&&u[1]>-1&&a.push([u[0],u[1],(0,se.getCell)(t,m,h)]))}else c+=1,l.splice(0,1);return a}function A(t,n){var r=[];return e.forEach(n,function(e){var n=$(e,3),o=n[0],i=n[1],a=n[2],s=t.getFormula(o,i);a.attrs.formula!==s&&r.push([o,i,a,{attrs:{formula:"="+s}}])}),r}function k(e,t,n){e&&(e.attrs||(e.attrs={}),e.attrs[t]=n)}function R(e,t){return e.attrs?t?e.attrs[t]:e.attrs:null}function I(e){return e.hasOwnProperty("lock")}function O(e){for(var t in e)if(t.match(/lock-/))return!0;return!1}function D(e,t,n){var r=e.guid();if("new-filter"===n){return[r,e.getSelections()[0],e.getRowCount(),e.getColumnCount()]}if("clear-filter"===n){var o=t.getCurDoc(!0),i=t.getCurTableOpIndex(e.guid(),o);return[r,o.ops[i].getAttributes()]}if("delete-filter"===n)return[r]}function P(e){var t=(0,ae.getActiveCell)(e),n=t.row,r=t.col,o=te.default.stringifyPosition(n,r),i=e.getCellType(n,r),a=e.getText(n,r),s="8"===i.typeName,l=void 0,u=void 0,c=void 0;return s?(l=a,u=i._text,c=i._linkToolTip):u=a,{url:l,text:u,tooltip:c,stringifyPos:o}}function N(e){var t=this.sheet,n=t.getSelections()[0],r=n.row,o=n.col;t.setFormula(r,o,e+"()"),t.setActiveCell(r,o),t.startEdit(!1,"="+e+"(")}function F(){this.sheet.startEdit()}function L(t){var n=this.sheet,r=n.getRowCount(),o=[];e.forEach(t,function(t){e.times(r,function(e){-1===o.indexOf(e)&&n.getCell(e,t).wordWrap()&&o.push(e)})}),me.autofitRows(n,o)}function H(t){var n=this.sheet,r=[];e.forEach(t,function(e){var t=e[0];-1===r.indexOf(t)&&r.push(t)}),me.autofitRows(n,r)}function V(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=this.sheet,o=[];e.forEach(t,function(e){var t=$(e,4),n=t[0],i=t[1],a=t[3],s=a.value,l=a.attrs;"string"==typeof s&&s.indexOf("\n")>-1&&"text-wrap"!==l.wrap&&r.getCell(n,i).wordWrap(!0),-1===o.indexOf(n)&&o.push(n)}),e.forEach(n,function(e){var t=$(e,1),n=t[0];-1===o.indexOf(n)&&o.push(n)}),me.autofitRows(r,o)}function j(e){var t=this;ie.default.alert({title:"正在导出中，请稍等...",type:""}),setTimeout(function(){var n=t.spread,r=t.props,o=t.needRenderSheet;t.paintWrapAll(function(){for(var e in o){var r=t._getSheetData(e);if(o[e]&&r){var i=(0,ae.getSheetById)(n,e);i&&t._renderSheet(i,r),o[e]=!1}}t.cachedSheetData={}})(),e(n.toJSON(),r.msg.revision)})}function B(t){if(t.isLockedByUser){var n=t.data.dataTable;e.forEach(n,function(t){e.forEach(t,function(e){e.tag&&(delete e.tag,e.style&&(e.style.locked=!1))})})}}function U(e){return W(ue.default.processTableOps(e))}function W(e){var t=e.cellsData,n=e.tableActions,r=e.rows,o=e.cols;return{cellsData:t,tableActions:n,colWidths:(0,fe.data2Attr)(o,"width"),rowHeights:(0,fe.data2Attr)(r,"height"),autoFitRowHeights:(0,fe.data2Attr)(r,"autoFit")}}function z(){ie.default.alert({title:"当前sheet正在计算中，请稍后重试"})}function Y(){ie.default.alert({title:"网络连接错误，请在网络恢复后重试",type:"error"})}function G(){ie.default.alert({title:"数据出错，请复制表格内容到本地，刷新后重新使用",type:"error"})}function K(e,t,n){var r=!1;return e?(r=!0,G()):t?(r=!0,Y()):n||(r=!0,z()),r}function X(t,n,r){function o(t,n){var r=0,o=!1;return e.forEach(t,function(e){var t=e.type,i=e.index,a=e.amount;"insert"===t?i<=n&&(r+=a):(i<n&&(r-=Math.min(a,n-i)),i<=n&&i+a>=n&&(o=!0))}),o?-1:n+r}var i=t._editor,a=t._activeRowIndex,s=t._activeColIndex;if(i){var l=o(n,a),u=o(r,s);l===a&&u===s||(t._activeRowIndex=l,t._activeColIndex=u,-1!==l&&-1!==u||(i.isCellDelete=!0))}}function q(e,t,n){var r=t.getCurDoc(!0),o=r.ops.length,i=r.ops[0],a=i.getAttributes();return[(0,ce.genUniqueId)(r),n,e,o,a]}function J(e,t,n,r){var o=t.getCurDoc(!0),i=t.findTableOpIndexByCs(e,o),a=o.ops[i].getAttributes(),s=a.name;return a.name=n,[i,a,Z(o,s,n,r)]}function Z(t,n,r,o){function i(e){return e.indexOf("!")>-1}for(var a=[],s=function(s,l){var u=t.ops[s],c=u.getAttributes()||{},f=u.data.cells,d={};f.forEach(function(t){var a=f.get(t).getAttributes()||{},s=a.formula;if(s&&i(s)){var l=(0,ge.getTokens)(s),u=l.items.map(function(t){return i(t.value)&&e.startsWith(t.value,n+"!")?t.value.replace(n+"!",r+"!"):t.value}).join("");"="+u!==s&&(d[t]={formula:"="+u,userID:o})}}),a.push([d,c])},l=0,u=t.ops.length;l<u;l++)s(l,u);return a}function Q(e,t,n){var r=t.getCurDoc(!0),o=t.findTableOpIndexByCs(e,r),i=r.ops[o],a=void 0,s=null;return null!==n&&(a=t.findTableOpByCs(n,t.getCurDoc())),a&&(s=a.getAttributes()),[o,te.default.pack(new ee.Delta([i])),s]}Object.defineProperty(t,"__esModule",{value:!0});var $=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.afterInvalidOperation=a,t.collabCellMenuState=s,t.getUpdatedMergeCells=l,t.getCrossMergeCells=u,t.alterMergeAfterDeleteRowOrCol=c,t.checkSheetName=f,t.getConditionalFormatSelections=d,t.getModifiedRulesAfterRowOrColChanged=p,t.showSaveDataError=h,t.getRowOrColAttrsAfterDragDrop=m,t.getDragDropRanges=g,t.generateLockSheetAttr=_,t.generateLockCellAttr=v,t.generateUnlockSheetAttr=y,t.generateUnlockCellAttr=b,t.generateUnlockAllCellAttr=C,t.getModifiedLockAfterRowOrColChanged=S,t.enbaleToolbar=x,t.disableToolbar=T,t.calcCellsBeforeAlterRows=E,t.calcCellsBeforeRemoveRowsOrCols=M,t.calcCellsAfterAlterRows=A,t.setSheetAttrs=k,t.getSheetAttrs=R,t.hasSheetLockProperty=I,t.hasCellLockProperty=O,t.genEditFilterParams=D,t.getInsertLinkInfo=P,t.setFormula=N,t.keepCellEditStatus=F,t.autoFitRowsAfterColumnChanged=L,t.autoFitRowsAfterCellChanged=H,t.autoFitRowsAfterPasted=V,t.getExportJSON=j,t.deleteLockFromSheetJson=B,t.processDataByCS=U,t.processData=W,t.disableActionTip=z,t.offlineTip=Y,t.dataErrorTip=G,t.isDisableOperate=K,t.updateEditPositionAfterApplyCs=X,t.getNewSheetParams=q,t.getUpdateSheetNameParams=J,t.getCopySheetParams=Q;var ee=n(53),te=i(ee),ne=n(9),re=i(ne),oe=n(5),ie=i(oe),ae=n(834),se=n(909),le=n(1002),ue=i(le),ce=n(575),fe=n(1058),de=n(146),pe=i(de),he=n(1003),me=o(he),ge=n(1206)}).call(t,n(1),n(573))},function(e,t,n){function r(e){var t=i(e);return 1==t.length&&t[0][2]?a(t[0][0],t[0][1]):function(n){return n===e||o(n,e,t)}}var o=n(928),i=n(973),a=n(851);e.exports=r},function(e,t,n){function r(e,t,n,r){var l=n.length,u=l,c=!r;if(null==e)return!u;for(e=Object(e);l--;){var f=n[l];if(c&&f[2]?f[1]!==e[f[0]]:!(f[0]in e))return!1}for(;++l<u;){f=n[l];var d=f[0],p=e[d],h=f[1];if(c&&f[2]){if(void 0===p&&!(d in e))return!1}else{var m=new o;if(r)var g=r(p,h,d,e,t,m);if(!(void 0===g?i(h,p,a|s,r,m):g))return!1}}return!0}var o=n(847),i=n(848),a=1,s=2;e.exports=r},function(e,t){function n(){this.__data__=[],this.size=0}e.exports=n},function(e,t,n){function r(e){var t=this.__data__,n=o(t,e);return!(n<0)&&(n==t.length-1?t.pop():a.call(t,n,1),--this.size,!0)}var o=n(653),i=Array.prototype,a=i.splice;e.exports=r},function(e,t,n){function r(e){var t=this.__data__,n=o(t,e);return n<0?void 0:t[n][1]}var o=n(653);e.exports=r},function(e,t,n){function r(e){return o(this.__data__,e)>-1}var o=n(653);e.exports=r},function(e,t,n){function r(e,t){var n=this.__data__,r=o(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}var o=n(653);e.exports=r},function(e,t,n){function r(){this.__data__=new o,this.size=0}var o=n(652);e.exports=r},function(e,t){function n(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}e.exports=n},function(e,t){function n(e){return this.__data__.get(e)}e.exports=n},function(e,t){function n(e){return this.__data__.has(e)}e.exports=n},function(e,t,n){function r(e,t){var n=this.__data__;if(n instanceof o){var r=n.__data__;if(!i||r.length<s-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new a(r)}return n.set(e,t),this.size=n.size,this}var o=n(652),i=n(713),a=n(714),s=200;e.exports=r},function(e,t,n){function r(){this.size=0,this.__data__={hash:new o,map:new(a||i),string:new o}}var o=n(940),i=n(652),a=n(713);e.exports=r},function(e,t,n){function r(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}var o=n(941),i=n(942),a=n(943),s=n(944),l=n(945);r.prototype.clear=o,r.prototype.delete=i,r.prototype.get=a,r.prototype.has=s,r.prototype.set=l,e.exports=r},function(e,t,n){function r(){this.__data__=o?o(null):{},this.size=0}var o=n(654);e.exports=r},function(e,t){function n(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}e.exports=n},function(e,t,n){function r(e){var t=this.__data__;if(o){var n=t[e];return n===i?void 0:n}return s.call(t,e)?t[e]:void 0}var o=n(654),i="__lodash_hash_undefined__",a=Object.prototype,s=a.hasOwnProperty;e.exports=r},function(e,t,n){function r(e){var t=this.__data__;return o?void 0!==t[e]:a.call(t,e)}var o=n(654),i=Object.prototype,a=i.hasOwnProperty;e.exports=r},function(e,t,n){function r(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=o&&void 0===t?i:t,this}var o=n(654),i="__lodash_hash_undefined__";e.exports=r},function(e,t,n){function r(e){var t=o(this,e).delete(e);return this.size-=t?1:0,t}var o=n(655);e.exports=r},function(e,t){function n(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}e.exports=n},function(e,t,n){function r(e){return o(this,e).get(e)}var o=n(655);e.exports=r},function(e,t,n){function r(e){return o(this,e).has(e)}var o=n(655);e.exports=r},function(e,t,n){function r(e,t){var n=o(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}var o=n(655);e.exports=r},function(e,t,n){function r(e,t,n,r,g,v){var y=u(e),b=u(t),w=y?h:l(e),C=b?h:l(t);w=w==p?m:w,C=C==p?m:C;var S=w==m,x=C==m,T=w==C;if(T&&c(e)){if(!c(t))return!1;y=!0,S=!1}if(T&&!S)return v||(v=new o),y||f(e)?i(e,t,n,r,g,v):a(e,t,w,n,r,g,v);if(!(n&d)){var E=S&&_.call(e,"__wrapped__"),M=x&&_.call(t,"__wrapped__");if(E||M){var A=E?e.value():e,k=M?t.value():t;return v||(v=new o),g(A,k,n,r,v)}}return!!T&&(v||(v=new o),s(e,t,n,r,g,v))}var o=n(847),i=n(849),a=n(957),s=n(961),l=n(968),u=n(261),c=n(555),f=n(556),d=1,p="[object Arguments]",h="[object Array]",m="[object Object]",g=Object.prototype,_=g.hasOwnProperty;e.exports=r},function(e,t,n){function r(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new o;++t<n;)this.add(e[t])}var o=n(714),i=n(953),a=n(954);r.prototype.add=r.prototype.push=i,r.prototype.has=a,e.exports=r},function(e,t){function n(e){return this.__data__.set(e,r),this}var r="__lodash_hash_undefined__";e.exports=n},function(e,t){function n(e){return this.__data__.has(e)}e.exports=n},function(e,t){function n(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}e.exports=n},function(e,t){function n(e,t){return e.has(t)}e.exports=n},function(e,t,n){function r(e,t,n,r,o,S,T){switch(n){case C:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case w:return!(e.byteLength!=t.byteLength||!S(new i(e),new i(t)));case d:case p:case g:return a(+e,+t);case h:return e.name==t.name&&e.message==t.message;case _:case y:return e==t+"";case m:var E=l;case v:var M=r&c;if(E||(E=u),e.size!=t.size&&!M)return!1;var A=T.get(e);if(A)return A==t;r|=f,T.set(e,t);var k=s(E(e),E(t),r,o,S,T);return T.delete(e),k;case b:if(x)return x.call(e)==x.call(t)}return!1}var o=n(324),i=n(958),a=n(325),s=n(849),l=n(959),u=n(960),c=1,f=2,d="[object Boolean]",p="[object Date]",h="[object Error]",m="[object Map]",g="[object Number]",_="[object RegExp]",v="[object Set]",y="[object String]",b="[object Symbol]",w="[object ArrayBuffer]",C="[object DataView]",S=o?o.prototype:void 0,x=S?S.valueOf:void 0;e.exports=r},function(e,t,n){var r=n(150),o=r.Uint8Array;e.exports=o},function(e,t){function n(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e]}),n}e.exports=n},function(e,t){function n(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}e.exports=n},function(e,t,n){function r(e,t,n,r,a,l){var u=n&i,c=o(e),f=c.length;if(f!=o(t).length&&!u)return!1;for(var d=f;d--;){var p=c[d];if(!(u?p in t:s.call(t,p)))return!1}var h=l.get(e);if(h&&l.get(t))return h==t;var m=!0;l.set(e,t),l.set(t,e);for(var g=u;++d<f;){p=c[d];var _=e[p],v=t[p];if(r)var y=u?r(v,_,p,t,e,l):r(_,v,p,e,t,l);if(!(void 0===y?_===v||a(_,v,n,r,l):y)){m=!1;break}g||(g="constructor"==p)}if(m&&!g){var b=e.constructor,w=t.constructor;b!=w&&"constructor"in e&&"constructor"in t&&!("function"==typeof b&&b instanceof b&&"function"==typeof w&&w instanceof w)&&(m=!1)}return l.delete(e),l.delete(t),m}var o=n(962),i=1,a=Object.prototype,s=a.hasOwnProperty;e.exports=r},function(e,t,n){function r(e){return o(e,a,i)}var o=n(963),i=n(965),a=n(411);e.exports=r},function(e,t,n){function r(e,t,n){var r=t(e);return i(e)?r:o(r,n(e))}var o=n(964),i=n(261);e.exports=r},function(e,t){function n(e,t){for(var n=-1,r=t.length,o=e.length;++n<r;)e[o+n]=t[n];return e}e.exports=n},function(e,t,n){var r=n(966),o=n(967),i=Object.prototype,a=i.propertyIsEnumerable,s=Object.getOwnPropertySymbols,l=s?function(e){return null==e?[]:(e=Object(e),r(s(e),function(t){return a.call(e,t)}))}:o;e.exports=l},function(e,t){function n(e,t){for(var n=-1,r=null==e?0:e.length,o=0,i=[];++n<r;){var a=e[n];t(a,n,e)&&(i[o++]=a)}return i}e.exports=n},function(e,t){function n(){return[]}e.exports=n},function(e,t,n){var r=n(969),o=n(713),i=n(970),a=n(971),s=n(972),l=n(198),u=n(553),c="[object Map]",f="[object Promise]",d="[object Set]",p="[object WeakMap]",h="[object DataView]",m=u(r),g=u(o),_=u(i),v=u(a),y=u(s),b=l;(r&&b(new r(new ArrayBuffer(1)))!=h||o&&b(new o)!=c||i&&b(i.resolve())!=f||a&&b(new a)!=d||s&&b(new s)!=p)&&(b=function(e){var t=l(e),n="[object Object]"==t?e.constructor:void 0,r=n?u(n):"";if(r)switch(r){case m:return h;case g:return c;case _:return f;case v:return d;case y:return p}return t}),e.exports=b},function(e,t,n){var r=n(269),o=n(150),i=r(o,"DataView");e.exports=i},function(e,t,n){var r=n(269),o=n(150),i=r(o,"Promise");e.exports=i},function(e,t,n){var r=n(269),o=n(150),i=r(o,"Set");e.exports=i},function(e,t,n){var r=n(269),o=n(150),i=r(o,"WeakMap");e.exports=i},function(e,t,n){function r(e){for(var t=i(e),n=t.length;n--;){var r=t[n],a=e[r];t[n]=[r,a,o(a)]}return t}var o=n(850),i=n(411);e.exports=r},function(e,t,n){function r(e,t){return s(e)&&l(t)?u(c(e),t):function(n){var r=i(n,e);return void 0===r&&r===t?a(n,e):o(t,r,f|d)}}var o=n(848),i=n(975),a=n(982),s=n(715),l=n(850),u=n(851),c=n(644),f=1,d=2;e.exports=r},function(e,t,n){function r(e,t,n){var r=null==e?void 0:o(e,t);return void 0===r?n:r}var o=n(835);e.exports=r},function(e,t,n){var r=n(977),o=/^\./,i=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,a=/\\(\\)?/g,s=r(function(e){var t=[];return o.test(e)&&t.push(""),e.replace(i,function(e,n,r,o){t.push(r?o.replace(a,"$1"):n||e)}),t});e.exports=s},function(e,t,n){function r(e){var t=o(e,function(e){return n.size===i&&n.clear(),e}),n=t.cache;return t}var o=n(978),i=500;e.exports=r},function(e,t,n){function r(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(i);var n=function(){var r=arguments,o=t?t.apply(this,r):r[0],i=n.cache;if(i.has(o))return i.get(o);var a=e.apply(this,r);return n.cache=i.set(o,a)||i,a};return n.cache=new(r.Cache||o),n}var o=n(714),i="Expected a function";r.Cache=o,e.exports=r},function(e,t,n){function r(e){return null==e?"":o(e)}var o=n(980);e.exports=r},function(e,t,n){function r(e){if("string"==typeof e)return e;if(a(e))return i(e,r)+"";if(s(e))return c?c.call(e):"";var t=e+"";return"0"==t&&1/e==-l?"-0":t}var o=n(324),i=n(981),a=n(261),s=n(436),l=1/0,u=o?o.prototype:void 0,c=u?u.toString:void 0;e.exports=r},function(e,t){function n(e,t){for(var n=-1,r=null==e?0:e.length,o=Array(r);++n<r;)o[n]=t(e[n],n,e);return o}e.exports=n},function(e,t,n){function r(e,t){return null!=e&&i(e,t,o)}var o=n(983),i=n(984);e.exports=r},function(e,t){function n(e,t){return null!=e&&t in Object(e)}e.exports=n},function(e,t,n){function r(e,t,n){t=o(t,e);for(var r=-1,c=t.length,f=!1;++r<c;){var d=u(t[r]);if(!(f=null!=e&&n(e,d)))break;e=e[d]}return f||++r!=c?f:!!(c=null==e?0:e.length)&&l(c)&&s(d,c)&&(a(e)||i(e))}var o=n(836),i=n(554),a=n(261),s=n(329),l=n(336),u=n(644);e.exports=r},function(e,t,n){function r(e){return a(e)?o(s(e)):i(e)}var o=n(986),i=n(987),a=n(715),s=n(644);e.exports=r},function(e,t){function n(e){return function(t){return null==t?void 0:t[e]}}e.exports=n},function(e,t,n){function r(e){return function(t){return o(t,e)}}var o=n(835);e.exports=r},,,,,,,,,,,,,,,function(e,t,n){(function(t){function r(e){return e&&e.__esModule?e:{default:e}}function o(e){"string"==typeof e&&(e=m.default.unpack(e));var t=e.data,n=l(e),r=i(t.rows.ops),o=i(t.cols.ops);return{tableActions:n,rows:r,cols:o,cellsData:a(t.cells,r,o,e)}}function i(e){function n(e,n){var r=new Array(e);return t.map(r,function(){return n})}for(var r,o,i,a=[],s=0,l=e.length;s<l;s++)r=e[s],o=parseInt(r.data,10),i=r.getAttributes()||{},a=a.concat(n(o,i));return a}function a(e,t,n){var r=[],o=n.length||18,i=t.length||200;return e.forEach(function(t){var n=m.default.parsePosition(t),a=n.row,s=n.col;if(!(a>=i||s>=o)){var l=e.get(t);r.push([a,s,_.default.cells2Value(l),l.getAttributes()])}}),r}function s(e){var t,n,r,o,i,a={rowActions:null,attrsActions:null},s={rowActions:null,attrsActions:null};o=e,i=o.data,n=l(o);for(var f in i)t=i[f],"rows"===f?a=u(t.ops):"cols"===f?s=u(t.ops):"cells"===f&&(r=c(t));return{tableActions:n,rows:a.rowActions,rowsAttr:a.attrsActions,cols:s.rowActions,colsAttr:s.attrsActions,cellsData:r}}function l(e){return e.getAttributes()||{}}function u(e){function n(e,n){var r=new Array(e);return t.map(r,function(){return n})}for(var r=0,o=void 0,i=void 0,a=void 0,s=[],l=["insert","remove"],u=[],c=0,f=e.length;c<f;c++){o=e[c],i=parseInt(o.data),a=o.action,t.includes(l,a)&&u.push({type:a,index:r,amount:i});var d=o.getAttributes()||{};s=s.concat(n(i,d)),r+=i}return{rowActions:u,attrsActions:s}}function c(e){var t=[];return e.forEach(function(n){var r=e.get(n),o=m.default.parsePosition(n),i=o.row,a=o.col;t.push([i,a,_.default.cells2Value(r),r.getAttributes()])}),t}function f(e){for(var t=e.ops,n=[],r=void 0,o=void 0,i=0,a=void 0,s=0,l=t.length;s<l;s++)if(r=t[s],a=r.action,o=r.getAttributes(),"retain"===a)o.name?(n.push(["rename",i,o.name]),i+=1):"object"===p(r.data)?i+=1:i+=r.data;else if("insert"===a){var u=r.data,c=u.rows.length,f=u.cols.length;n.push(["insert",i,[o.name,o.id,c,f]]),i+=1}else"remove"===a&&(n.push(["remove",i,r.data]),i+=r.data);return n}function d(e){function n(e){var n={};return t.forIn(e,function(e,t){t.match(/lock-/)&&(n[t]=e)}),n}var r=0,o=[];return e.ops.forEach(function(e){var i=e.action,a=e.data,s=e.getAttributes(),l=s.hasOwnProperty("lock"),u=n(s);l&&(u.lock=s.lock),!t.isEmpty(u)&&o.push([r,u]),r+="retain"===i?"object"===(void 0===a?"undefined":p(a))?1:a:"remove"===i?a:1}),o}var p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h=n(53),m=r(h),g=n(574),_=r(g);e.exports={changeset2Actions:s,tableOps2Actions:l,changeset2SheetChangeAction:f,changeset2LockActions:d,processTableOps:o,processRow:i,processCell:a}}).call(t,n(1))},function(e,t,n){(function(e){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n){n||u(e,t),l(e,t)}function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments[2];t.forEach(function(t){o(e,t,n)})}function a(t){s(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],"background",function(t){var n=t.userID;return y(e.isNil(n)?F:k.default.getColor(n),.5)})}function s(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments[2],o=arguments[3],i=N.SheetArea.viewport,a={background:"backColor",color:"foreColor"};n.forEach(function(n){var s=b(n,4),l=s[0],u=s[1],c=s[3],f=t.getStyle(l,u)||new N.Style;f[a[r]]=e.isNil(o)?c[r]:"function"==typeof o?o(c):o,t.setStyle(l,u,f,i)})}function l(e,t){var n=b(t,4),r=n[0],o=n[1],i=n[2],a=n[3];if(null!==i)if(a.hasOwnProperty("link"))h(e,t);else if(a.hasOwnProperty("formula")){if(a.formula&&"="!==a.formula)try{N.CalcEngine.evaluateFormula(e,a.formula,0,0,!1),e.setFormula(r,o,a.formula)}catch(e){return void console.error(e)}if(!a.formula){e.setFormula(r,o,"");var s=void 0!==i?i:"";e.setValue(r,o,s)}}else if("string"==typeof i&&i.indexOf("GMT+0800")>-1)e.setValue(r,o,new Date(i));else if((0,T.isDateFormat)(a.format||e.getFormatter(r,o))){var l=(0,E.parseFormat)(i),u=l.parsedVal;e.setValue(r,o,u)}else e.setValue(r,o,i)}function u(t,n){function r(n,r){return e.forIn(n,function(e,n){r=m(t,r,n,e)}),r}function o(e,t){for(var n in t)e[n]=t[n];return e}var i=N.SheetArea.viewport,a=b(n,4),s=a[0],l=a[1],u=a[3],c=t.getStyle(s,l),f=void 0;if(c)f=r(u,c);else{var d=f=new N.Style,h=e.pick(u,L);if(!e.isEmpty(h)){var g=JSON.stringify(h),_=H[g];if(_)f=o(d,_);else{var y=r(h,{});H[g]=y,f=o(d,y)}}}if(u.hasOwnProperty("align")){var w=u.align;w?f.manualAlign=w:w=v(t,n,f),f=m(t,f,"align",w)}else f=m(t,f,"align",v(t,n,f));try{if(u.formula&&!u.hasOwnProperty("format")){var S=N.CalcEngine.parseFormulaToTokens(u.formula.split("")),x=e.find(S,function(e){return 0===e._type&&0===e._subType});if(x&&!O.default.isAbsoluteReference(x._stringValue)){var T=C.default.parsePosition(x._stringValue.toUpperCase()),E=t.getFormatter(T.row,T.col);E&&(f.formatter=E)}}}catch(e){console.log(e,s,l)}t.setStyle(s,l,f,i),p(t,n)}function c(e,t,n){var r=[];t.forEach(function(t){var o=b(t,2),i=o[0],a=o[1],s=[i,a,void 0,n];u(e,s),f(e,s),-1===r.indexOf(i)&&(void 0!==n.wrap||void 0!==n["font-size"])&&r.push(i)}),d(e,r)}function f(e,t){var n=b(t,4),r=n[0],o=n[1],i=n[3];if(i.hasOwnProperty("format")){var a=e.getValue(r,o);if("normal"===i.format){if(a instanceof Date){var s=(0,R.getDateFormatVal)(e,a,r,o);e.setValue(r,o,s)}}else try{!(0,T.isDateFormat)(i.format)||a instanceof Date||null===a?e.setValue(r,o,a):e.setValue(r,o,(0,E.parseFormat)(a).parsedVal)}catch(e){console.log(e,r,o)}}}function d(e,t){t.forEach(function(t){e.autoFitRow(t)})}function p(e,t){var n=b(t,4),r=n[0],o=n[1],i=n[3],a=i.rowspan,s=i.colspan;if(i.hasOwnProperty("rowspan")){a=a||1,s=s||1;var l=e.getSpan(r,o);if(a>1||s>1)try{var u=e.getSpan(r,o);u&&e.removeSpan(u.row,u.col),e.addSpan(r,o,a,s)}catch(e){console.error("合并单元格无法交叉")}else l&&a<=1&&s<=1&&e.removeSpan(r,o)}}function h(t,n){var r=b(n,4),o=r[0],i=r[1],a=r[2],s=r[3],l=s.link,u=s.linkTooltip;if(l){var c=new N.CellTypes.HyperLink;c.text(e.isNil(a)?l:a+""),c.linkToolTip(u),c._value=e.isNil(a)?"":a,t.getCell(o,i).cellType(c).value(l)}else t.getCell(o,i).cellType(void 0).value(a)}function m(t,n,r,o){var i=N.TextDecorationType,a=N.LineBorder;switch(r){case"bold":n=g(t,n,r,o?"bold":T.DEFAULT_STYLE["font-weight"]);break;case"italic":n=g(t,n,r,o?"italic":T.DEFAULT_STYLE["font-style"]);break;case"font-size":n=g(t,n,r,o?o+"pt":T.DEFAULT_STYLE["font-size"]);break;case"underline":n=_(n,o,i.underline);break;case"strike":n=_(n,o,i.lineThrough);break;case"color":n.foreColor=o;break;case"background":n.backColor=o;break;case"align":n.hAlign=N.HorizontalAlign[o];break;case"vertical":n.vAlign=N.VerticalAlign[o||T.DEFAULT_STYLE.vertical];break;case"wrap":n.wordWrap="text-wrap"===o;break;case"format":T.TEMP_NEW_FORMAT_MAP.hasOwnProperty(o)&&(o=T.TEMP_NEW_FORMAT_MAP[o]),n.formatter=o;break;case"border-top":case"border-right":case"border-bottom":case"border-left":var s=e.upperFirst(r.substr(7));o&&(o=JSON.parse(o),o=new a(o[0],o[1])),n["border"+s]=o}return n}function g(e,t,n,r){var o={italic:0,bold:1,"font-size":2};if(!t.font){var i=e.getDefaultStyle();t.font=i.font||T.DEFAULT_STYLE.font}var a=(0,R.splitFont)(t.font),s=a.fontStyle,l=a.fontWeight,u=a.fontSize,c=a.fontItems,f=a.items,d=[s,l,u];return d[o[n]]=r,d=d.filter(function(e){return e}),d.push(c[c.length-1]),f[0]=d.join(" "),t.font=f.join(","),t}function _(e,t,n){var r=e.textDecoration,o=(r&n)===n;return t&&!o?e.textDecoration=r|n:!t&&o&&(e.textDecoration=r-n),e}function v(t,n,r){var o=b(n,4),i=o[0],a=o[1],s=o[2],l=o[3],u=l.hasOwnProperty("format")?l.format:r.formatter,c=l.hasOwnProperty("align")?l.align:r.manualAlign,f=T.DEFAULT_STYLE.align;return c?f=c:l.formula?f="right":l.link?f="left":(u&&"normal"!==u||(0,M.isValidNumber)(e.isNil(s)?t.getValue(i,a):s))&&(f="right"),f}function y(e,t){var n=(0,P.default)(e);return(0,P.default)(n.color.map(function(e){return Math.round(e*t+255*(1-t))})).hex()}Object.defineProperty(t,"__esModule",{value:!0});var b=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.setCell=o,t.setBulkCells=i,t.highlightCellsWithUserId=a,t.setBulkCellsSingleStyle=s,t.setValue=l,t.setStyle=u,t.setBulkCellsStyle=c,t.autofitRows=d,t.setLink=h;var w=n(53),C=r(w),S=n(721),x=r(S),T=n(533),E=n(562),M=n(254),A=n(433),k=r(A),R=n(909),I=n(534),O=r(I),D=n(1154),P=r(D),N=x.default.Spread.Sheets,F="#fff0cf",L=["bold","italic","font-size","underline","strike","color","background","vertical","wrap","format","border-top","border-right","border-bottom","border-left"],H={};window.cachedStyle=H}).call(t,n(1))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){(function(e){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var n=JSON.stringify({action:"unlock_sheet",sheetName:t});b.default.post("/smapi/files/"+e+"/doc_histories",{content:n},function(){},function(e){var t=e.code;console.log("code:",t)})}function i(e,t,n){var r=JSON.stringify({action:n?"update_lock":"lock_sheet",sheetName:t});b.default.post("/smapi/files/"+e+"/doc_histories",{content:r},function(){},function(e){var t=e.code;console.log("code:",t)})}function a(e,t,n,r){var o=(0,w.cellRange2LockRange)(n),i=o[0]+" : "+o[1],a=JSON.stringify({action:r?"update_lock_cell":"lock_cell",sheetName:t,range:i});b.default.post("/smapi/files/"+e+"/doc_histories",{content:a},function(){},function(e){var t=e.code;console.log("code:",t)})}function s(e,t,n){var r=JSON.stringify({action:"unlock_cell",sheetName:t,range:n});b.default.post("/smapi/files/"+e+"/doc_histories",{content:r},function(){},function(e){var t=e.code;console.log("code:",t)})}function l(e){E=e}function u(t){var n=e.find(E,function(e){return e.id===t.id});return!!n&&n.isOutsider}function c(t){var n=e.find(E,function(e){return e.id===t.id});return!!n&&(n.teamId===cow.currentFile.teamId&&("admin"===n.teamRole||"creator"===n.teamRole))}function f(t){var n=e.find(E,function(e){return e.id===t.id});return!!n&&"owner"===n.role}function d(t,n,r){var o=e.find(E,function(e){return e.id===n.id});if(o){var i=o.isOutsider,a=o.teamId===cow.currentFile.teamId&&("admin"===o.teamRole||"creator"===o.teamRole),s="owner"===o.role,l=a||s;if(!(0,C.isEnterprise)(n)||i)return!1;var u=!0;return r&&e.find(r,function(e){return(0,S.getSheetAttrs)(t,e[0]).lockerId!==n.id})&&(u=!1),(l||u||!r)&&1===t.getSelections().length}return!1}function p(t,n){return!(0,x.isHasEditPermission)()||e.find((0,w.getSelectionsCellLocks)(t,n),function(e){return!v(e)})}function h(t){var n=[(0,w.getSheetSelection)(t)];return(0,x.isHasEditPermission)()&&e.find((0,w.getSelectionsCellLocks)(t,n),function(e){return!v(e)})}function m(t,n){var r=e.find(E,function(e){return e.id===n.id});if(r){var o=r.isOutsider,i=r.teamId===cow.currentFile.teamId&&("admin"===r.teamRole||"creator"===r.teamRole),a="owner"===r.role,s=i||a,l=t.lockerId===n.id;return!(!(0,C.isEnterprise)(n)||o)&&(s||l||!(0,w.isWorksheetLocked)(t))}return!1}function g(e){return!(0,x.isHasEditPermission)()||!v((0,S.getSheetAttrs)(e,"lock"))}function _(e,t){return g(e)||p(e,t)}function v(t){if(!t)return!0;var n=T.id,r=e.isArray(t)?t[1]:e.isString(t)?JSON.parse(t):t,o=r.editable;return e.includes(o,n)}Object.defineProperty(t,"__esModule",{value:!0}),t.historyUnlockSheet=o,t.historyLockSheet=i,t.historyLockCell=a,t.historyUnlockCell=s,t.setCollaborators=l,t.isUserOutsider=u,t.isTeamAdmin=c,t.isOwner=f,t.canEditCellLock=d,t.isUserLockedInCellRange=p,t.isUserLockedInCellRangeByAction=h,t.canEditSheetLock=m,t.isUserLockedInSheet=g,t.isUserLocked=_;var y=n(34),b=r(y),w=n(834),C=n(21),S=n(926),x=n(1139),T=window.cow.currentUser,E=null}).call(t,n(1))},,,,,,,,,,,,,function(e,t,n){(function(e){function r(e){return e&&e.__esModule?e:{default:e}}function o(t,n,r){e.isEmpty(n)||(i(t,n.fixedRowsTop,n.fixedColumnsLeft),setTimeout(function(){!r&&c(t,n),f(t,n)}))}function i(e,t,n){void 0===t&&void 0===n||k.default.isMobile()||(t=t||0,n=n||0,e.frozenRowCount(t),e.frozenColumnCount(n),t||n||e.showCell(0,0),M.default.notify("tableAction:frozenChanged",t,n))}function a(t,n){if(!e.isEmpty(n)&&n.hasOwnProperty("filter")){var r=n.filter;(0,I.setSheetAttrs)(t,"filter",r),r?function(){r=JSON.parse(r);var n=D.ConditionalFormatting.TextCompareType.equalsTo,o=r,i=o.pos,a=o.rules,s=D.Filter,l=D.Range,u=S(i,4),c=u[0],f=u[1],d=u[2],p=u[3];t.rowFilter(new s.HideRowFilter(new l(c,f,d,p))),a&&!e.isEmpty(a)&&function(){var r=t.rowFilter(),o=void 0,i=[];for(o in a){var s=a[o],l=s.fields;s.ascending,l.length||i.push(o);var u=(0,R.getRowsText)(t,o,c,d);l=e.difference(u,l),l.forEach(function(e){"(空)"===e&&(e="");var t=new D.ConditionalFormatting.Condition(D.ConditionalFormatting.ConditionType.textCondition,{compareType:n,expected:e});r.addFilterItem(o,t)})}r.filter(),e.forEach(i,function(e){r.unfilter(parseInt(e,10))})}()}():t.rowFilter(null)}}function s(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];e.forEach(n,function(e,n){e&&t.setRowHeight(n,e)}),e.forEach(r,function(e,n){e&&t.setColumnWidth(n,e)})}function l(e,t){e.setAutoFitRows(t)}function u(e){e.conditionalFormats.removeRuleByRange(0,0,e.getRowCount(),e.getColumnCount())}function c(t,n){function r(t,n,r,o){var i=new D.Style,a=D.ConditionalFormatting,s=new a.NormalConditionRule,l=r.ruleType,u=r.value,c=r.value2,f=r.selections,d=r.background;i.backColor=d,"contains"===l?(s.ruleType(a.RuleType.specificTextRule),s.operator(a.TextComparisonOperators.contains),s.text(u)):(s.ruleType(a.RuleType.cellValueRule),s.operator(a.ComparisonOperators[l])),!e.isNil(n)&&s.name(n),s.ranges((0,R.selectionsToRanges)(f)),s.style(i),!("contains"===l)&&s.value1(u),"between"===l&&s.value2(c),t.conditionalFormats.addRule(s,o),(0,I.setSheetAttrs)(t,n,r)}function o(e,t){var n=(0,R.getConditionFormatByName)(e,t);n&&e.conditionalFormats.removeRule(n),(0,I.getSheetAttrs)(e,t)&&delete e.attrs[t]}var i=(0,R.getConditionFormatsFromAttrs)(n);i.sort(function(e,t){return(e[1]?e[1].sortIndex:0)-(t[1]?t[1].sortIndex:0)}),e.forEach(i,function(e){var n=S(e,2),i=n[0],a=n[1];o(t,i),a&&r(t,i,a,a.sortIndex)})}function f(t,n){var r=t.pictures;e.forIn(n,function(e,t){if(t.match(/picture-/))if(e){e=JSON.parse(e),r.get(t)&&r.remove(t),r.add(t,e[0],e[1],e[2],+e[3],+e[4]);var n=r.get(t);n&&n.dynamicSize(!1)}else r.remove(t)})}function d(t,n,r){function o(t,n,o){e.forEach(n,function(e){(0,R.unLockCellsByRange)(t,e,r)}),delete t.attrs[o],C(t,o),(0,R.hasCellLocks)(t)||(0,O.isUserLockedInSheet)(t)||((0,R.resetSheetLocks)(t,r),p(t))}var i=window.cow.currentUser.id,a=t.options;if((0,I.hasCellLockProperty)(n))e.forIn(n,function(n,s){if(s.match(/lock-/)){var l=(0,I.getSheetAttrs)(t,s);if(l&&n&&(0,R.unLockCellsByRange)(t,l.ranges[0],r),n){var u=JSON.parse(n),c=e.includes(u.editable,i);u.ranges=u.ranges.map(function(n){var o=(0,R.lockRange2CellRange)(t,n);return r&&c?o.locked(!1).tag({locked:null}):(t.hasLockedCells||(t.hasLockedCells=!0,a.isProtected=!0,r&&(0,R.unLockAllCells)(t)),o.locked(!0).tag({locked:!0})),e.pick(o,["row","col","rowCount","colCount"])}),(0,I.setSheetAttrs)(t,s,u)}else{var f=(0,I.getSheetAttrs)(t,P),d=(l||f[s]).ranges;o(t,d,s)}}});else{var s=(0,I.getSheetAttrs)(t,P);e.forEach(s,function(e,n){var r=e.ranges;o(t,r,n)})}a.isLockedByUser=(0,R.isSheetLocked)(t),a.canMoveImage=(0,O.isUserLockedInCellRangeByAction)(t),(0,R.repaintLockStyle)(t)}function p(e){e&&delete e.hasLockedCells}function h(t,n,r,o){e.forEach(n,function(e){delete t.attrs[e]}),e.forEach(r,function(e){(0,R.unLockCellsByRange)(t,e,o)}),(0,R.resetSheetLocks)(t,o),t.options.canMoveImage=!1,(0,R.repaintLockStyle)(t)}function m(t,n,r,o){function i(e,t,n){var r=(0,R.getSheetSelection)(e);e.options.isProtected=t,r.tag({locked:n}),!o&&(t?(0,I.disableToolbar)():(0,I.enbaleToolbar)())}var a=window.cow.currentUser.id;if(n){var s=JSON.parse(n),l=s.editable,u=s.lockerId,c=!r||!e.includes(l,a);i(t,c,c),t.lockerId=u}else i(t,!r,!1),t.lockerId=null,C(t,"lock");t.options.isLockedByUser=!!n,(0,I.setSheetAttrs)(t,"lock",n?JSON.parse(n):null),(0,R.repaintLockStyle)(t)}function g(t,n){e.forIn(n,function(n,r){if(r.match(/^lock/))if(n){var o=JSON.parse(n),i=o.ranges;i?(i&&(o.ranges=i.map(function(n){return e.pick((0,R.lockRange2CellRange)(t,n),["row","col","rowCount","colCount"])})),(0,I.setSheetAttrs)(t,r,o)):(0,I.setSheetAttrs)(t,r,o)}else{var a=(0,I.getSheetAttrs)(t,P)||{};a[r]=t.attrs[r],(0,I.setSheetAttrs)(t,P,a),delete t.attrs[r]}}),t.options.isLockedByUser=(0,R.isSheetLocked)(t),(0,R.repaintLockStyle)(t)}function _(e,t,n,r,o){var i=(0,I.getSheetAttrs)(e,P);!r&&i&&(0,I.hasCellLockProperty)(i)&&d(e,null,n),(0,I.hasCellLockProperty)(t)&&d(e,t,n),i=(0,I.getSheetAttrs)(e,P),((0,I.hasSheetLockProperty)(t)||i&&(0,I.hasSheetLockProperty)(i))&&m(e,t.lock,n,o)}function v(t,n){var r=0,o=[];n.map(function(e){var t=S(e,1),n=t[0];"insert"===n?r++:"remove"===n&&(e[1]-=r,r=0,o.push(e))}),o.forEach(function(n){var r=S(n,3),o=r[1],i=r[2];e.times(i,function(){t.removeSheet(o)})}),n.forEach(function(e){var n=S(e,3),r=n[0],o=n[1],i=n[2];if("rename"===r)t.getSheet(o).name(i);else if("insert"===r){var a=S(i,4),s=a[0],l=a[1],u=a[2],c=a[3],f=new D.Worksheet(s,l);f.setRowCount(u),f.setColumnCount(c),t.addSheet(o,f)}})}function y(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=0;e.forEach(n,function(e){var n=e.type,o=e.index,i=e.amount;"insert"===n?t.addRows(o,i):(t.deleteRows(o-r,i),r+=i)})}function b(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=0;e.forEach(n,function(e){var n=e.type,o=e.index,i=e.amount;"insert"===n?t.addColumns(o,i):(t.deleteColumns(o-r,i),r+=i)})}function w(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments[2],o="row"===r?t.deleteRows:t.deleteColumns,i=0;e.forEach(n,function(e){o.call(t,e-i,1),i+=1})}function C(t,n){var r=(0,I.getSheetAttrs)(t,P);r&&delete r[n],e.isEmpty(r)&&t.attrs&&delete t.attrs[P]}Object.defineProperty(t,"__esModule",{value:!0});var S=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.applyTableAttrs=o,t.applyFrozen=i,t.applyFilter=a,t.applyRowColAttrs=s,t.applyAutoFitRows=l,t.removeAllConditionalFormat=u,t.applyConditionalFormat=c,t.applyPictures=f,t.applyCellLocks=d,t.removeKeyOfHasLockedCells=p,t.applyUnlockAllCellLocks=h,t.applySheetLock=m,t.applyLockIcon=g,t.applyLocks=_,t.applySheetChangesActions=v,t.alterRows=y,t.alterCols=b,t.deleteRowsOrColsBulk=w;var x=n(721),T=r(x),E=n(9),M=r(E),A=n(5),k=r(A),R=n(834),I=n(926),O=n(1044),D=T.default.Spread.Sheets,P="deletedLocks"}).call(t,n(1))},function(e,t,n){(function(e){function n(t,n,r){if(!t)return[];var o=new Array(t.length);return e.forEach(t,function(e,t){if(e&&e.hasOwnProperty(n)){var i=e[n]||r;i&&(o[t]=i)}}),o}Object.defineProperty(t,"__esModule",{value:!0}),t.data2Attr=n}).call(t,n(1))},,,,,,,,,,,function(e,t){e.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},function(e,t,n){function r(e,t){return Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)+Math.pow(e[2]-t[2],2)}var o=n(1069),i={};for(var a in o)o.hasOwnProperty(a)&&(i[o[a]]=a);var s=e.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(var l in s)if(s.hasOwnProperty(l)){if(!("channels"in s[l]))throw new Error("missing channels property: "+l);if(!("labels"in s[l]))throw new Error("missing channel labels property: "+l);if(s[l].labels.length!==s[l].channels)throw new Error("channel and label counts mismatch: "+l);var u=s[l].channels,c=s[l].labels;delete s[l].channels,delete s[l].labels,Object.defineProperty(s[l],"channels",{value:u}),Object.defineProperty(s[l],"labels",{value:c})}s.rgb.hsl=function(e){var t,n,r,o=e[0]/255,i=e[1]/255,a=e[2]/255,s=Math.min(o,i,a),l=Math.max(o,i,a),u=l-s;return l===s?t=0:o===l?t=(i-a)/u:i===l?t=2+(a-o)/u:a===l&&(t=4+(o-i)/u),t=Math.min(60*t,360),t<0&&(t+=360),r=(s+l)/2,n=l===s?0:r<=.5?u/(l+s):u/(2-l-s),[t,100*n,100*r]},s.rgb.hsv=function(e){var t,n,r,o=e[0],i=e[1],a=e[2],s=Math.min(o,i,a),l=Math.max(o,i,a),u=l-s;return n=0===l?0:u/l*1e3/10,l===s?t=0:o===l?t=(i-a)/u:i===l?t=2+(a-o)/u:a===l&&(t=4+(o-i)/u),t=Math.min(60*t,360),t<0&&(t+=360),r=l/255*1e3/10,[t,n,r]},s.rgb.hwb=function(e){var t=e[0],n=e[1],r=e[2],o=s.rgb.hsl(e)[0],i=1/255*Math.min(t,Math.min(n,r));return r=1-1/255*Math.max(t,Math.max(n,r)),[o,100*i,100*r]},s.rgb.cmyk=function(e){var t,n,r,o,i=e[0]/255,a=e[1]/255,s=e[2]/255;return o=Math.min(1-i,1-a,1-s),t=(1-i-o)/(1-o)||0,n=(1-a-o)/(1-o)||0,r=(1-s-o)/(1-o)||0,[100*t,100*n,100*r,100*o]},s.rgb.keyword=function(e){var t=i[e];if(t)return t;var n,a=1/0;for(var s in o)if(o.hasOwnProperty(s)){var l=o[s],u=r(e,l);u<a&&(a=u,n=s)}return n},s.keyword.rgb=function(e){return o[e]},s.rgb.xyz=function(e){var t=e[0]/255,n=e[1]/255,r=e[2]/255;return t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92,n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92,r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92,[100*(.4124*t+.3576*n+.1805*r),100*(.2126*t+.7152*n+.0722*r),100*(.0193*t+.1192*n+.9505*r)]},s.rgb.lab=function(e){var t,n,r,o=s.rgb.xyz(e),i=o[0],a=o[1],l=o[2];return i/=95.047,a/=100,l/=108.883,i=i>.008856?Math.pow(i,1/3):7.787*i+16/116,a=a>.008856?Math.pow(a,1/3):7.787*a+16/116,l=l>.008856?Math.pow(l,1/3):7.787*l+16/116,t=116*a-16,n=500*(i-a),r=200*(a-l),[t,n,r]},s.hsl.rgb=function(e){var t,n,r,o,i,a=e[0]/360,s=e[1]/100,l=e[2]/100;if(0===s)return i=255*l,[i,i,i];n=l<.5?l*(1+s):l+s-l*s,t=2*l-n,o=[0,0,0];for(var u=0;u<3;u++)r=a+1/3*-(u-1),r<0&&r++,r>1&&r--,i=6*r<1?t+6*(n-t)*r:2*r<1?n:3*r<2?t+(n-t)*(2/3-r)*6:t,o[u]=255*i;return o},s.hsl.hsv=function(e){var t,n,r=e[0],o=e[1]/100,i=e[2]/100,a=o,s=Math.max(i,.01);return i*=2,o*=i<=1?i:2-i,a*=s<=1?s:2-s,n=(i+o)/2,t=0===i?2*a/(s+a):2*o/(i+o),[r,100*t,100*n]},s.hsv.rgb=function(e){var t=e[0]/60,n=e[1]/100,r=e[2]/100,o=Math.floor(t)%6,i=t-Math.floor(t),a=255*r*(1-n),s=255*r*(1-n*i),l=255*r*(1-n*(1-i));switch(r*=255,o){case 0:return[r,l,a];case 1:return[s,r,a];case 2:return[a,r,l];case 3:return[a,s,r];case 4:return[l,a,r];case 5:return[r,a,s]}},s.hsv.hsl=function(e){var t,n,r,o=e[0],i=e[1]/100,a=e[2]/100,s=Math.max(a,.01);return r=(2-i)*a,t=(2-i)*s,n=i*s,n/=t<=1?t:2-t,n=n||0,r/=2,[o,100*n,100*r]},s.hwb.rgb=function(e){var t,n,r,o,i=e[0]/360,a=e[1]/100,s=e[2]/100,l=a+s;l>1&&(a/=l,s/=l),t=Math.floor(6*i),n=1-s,r=6*i-t,0!=(1&t)&&(r=1-r),o=a+r*(n-a);var u,c,f;switch(t){default:case 6:case 0:u=n,c=o,f=a;break;case 1:u=o,c=n,f=a;break;case 2:u=a,c=n,f=o;break;case 3:u=a,c=o,f=n;break;case 4:u=o,c=a,f=n;break;case 5:u=n,c=a,f=o}return[255*u,255*c,255*f]},s.cmyk.rgb=function(e){var t,n,r,o=e[0]/100,i=e[1]/100,a=e[2]/100,s=e[3]/100;return t=1-Math.min(1,o*(1-s)+s),n=1-Math.min(1,i*(1-s)+s),r=1-Math.min(1,a*(1-s)+s),[255*t,255*n,255*r]},s.xyz.rgb=function(e){var t,n,r,o=e[0]/100,i=e[1]/100,a=e[2]/100;return t=3.2406*o+-1.5372*i+-.4986*a,n=-.9689*o+1.8758*i+.0415*a,r=.0557*o+-.204*i+1.057*a,t=t>.0031308?1.055*Math.pow(t,1/2.4)-.055:12.92*t,n=n>.0031308?1.055*Math.pow(n,1/2.4)-.055:12.92*n,r=r>.0031308?1.055*Math.pow(r,1/2.4)-.055:12.92*r,t=Math.min(Math.max(0,t),1),n=Math.min(Math.max(0,n),1),r=Math.min(Math.max(0,r),1),[255*t,255*n,255*r]},s.xyz.lab=function(e){var t,n,r,o=e[0],i=e[1],a=e[2];return o/=95.047,i/=100,a/=108.883,o=o>.008856?Math.pow(o,1/3):7.787*o+16/116,i=i>.008856?Math.pow(i,1/3):7.787*i+16/116,a=a>.008856?Math.pow(a,1/3):7.787*a+16/116,t=116*i-16,n=500*(o-i),r=200*(i-a),[t,n,r]},s.lab.xyz=function(e){var t,n,r,o=e[0],i=e[1],a=e[2];n=(o+16)/116,t=i/500+n,r=n-a/200;var s=Math.pow(n,3),l=Math.pow(t,3),u=Math.pow(r,3);return n=s>.008856?s:(n-16/116)/7.787,t=l>.008856?l:(t-16/116)/7.787,r=u>.008856?u:(r-16/116)/7.787,t*=95.047,n*=100,r*=108.883,[t,n,r]},s.lab.lch=function(e){var t,n,r,o=e[0],i=e[1],a=e[2];return t=Math.atan2(a,i),n=360*t/2/Math.PI,n<0&&(n+=360),r=Math.sqrt(i*i+a*a),[o,r,n]},s.lch.lab=function(e){var t,n,r,o=e[0],i=e[1],a=e[2];return r=a/360*2*Math.PI,t=i*Math.cos(r),n=i*Math.sin(r),[o,t,n]},s.rgb.ansi16=function(e){var t=e[0],n=e[1],r=e[2],o=1 in arguments?arguments[1]:s.rgb.hsv(e)[2];if(0===(o=Math.round(o/50)))return 30;var i=30+(Math.round(r/255)<<2|Math.round(n/255)<<1|Math.round(t/255));return 2===o&&(i+=60),i},s.hsv.ansi16=function(e){return s.rgb.ansi16(s.hsv.rgb(e),e[2])},s.rgb.ansi256=function(e){var t=e[0],n=e[1],r=e[2];return t===n&&n===r?t<8?16:t>248?231:Math.round((t-8)/247*24)+232:16+36*Math.round(t/255*5)+6*Math.round(n/255*5)+Math.round(r/255*5)},s.ansi16.rgb=function(e){var t=e%10;if(0===t||7===t)return e>50&&(t+=3.5),t=t/10.5*255,[t,t,t];var n=.5*(1+~~(e>50));return[(1&t)*n*255,(t>>1&1)*n*255,(t>>2&1)*n*255]},s.ansi256.rgb=function(e){if(e>=232){var t=10*(e-232)+8;return[t,t,t]}e-=16;var n;return[Math.floor(e/36)/5*255,Math.floor((n=e%36)/6)/5*255,n%6/5*255]},s.rgb.hex=function(e){var t=((255&Math.round(e[0]))<<16)+((255&Math.round(e[1]))<<8)+(255&Math.round(e[2])),n=t.toString(16).toUpperCase();return"000000".substring(n.length)+n},s.hex.rgb=function(e){var t=e.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!t)return[0,0,0];var n=t[0];3===t[0].length&&(n=n.split("").map(function(e){return e+e}).join(""));var r=parseInt(n,16);return[r>>16&255,r>>8&255,255&r]},s.rgb.hcg=function(e){var t,n,r=e[0]/255,o=e[1]/255,i=e[2]/255,a=Math.max(Math.max(r,o),i),s=Math.min(Math.min(r,o),i),l=a-s;return t=l<1?s/(1-l):0,n=l<=0?0:a===r?(o-i)/l%6:a===o?2+(i-r)/l:4+(r-o)/l+4,n/=6,n%=1,[360*n,100*l,100*t]},s.hsl.hcg=function(e){var t=e[1]/100,n=e[2]/100,r=1,o=0;return r=n<.5?2*t*n:2*t*(1-n),r<1&&(o=(n-.5*r)/(1-r)),[e[0],100*r,100*o]},s.hsv.hcg=function(e){var t=e[1]/100,n=e[2]/100,r=t*n,o=0;return r<1&&(o=(n-r)/(1-r)),[e[0],100*r,100*o]},s.hcg.rgb=function(e){var t=e[0]/360,n=e[1]/100,r=e[2]/100;if(0===n)return[255*r,255*r,255*r];var o=[0,0,0],i=t%1*6,a=i%1,s=1-a,l=0;switch(Math.floor(i)){case 0:o[0]=1,o[1]=a,o[2]=0;break;case 1:o[0]=s,o[1]=1,o[2]=0;break;case 2:o[0]=0,o[1]=1,o[2]=a;break;case 3:o[0]=0,o[1]=s,o[2]=1;break;case 4:o[0]=a,o[1]=0,o[2]=1;break;default:o[0]=1,o[1]=0,o[2]=s}return l=(1-n)*r,[255*(n*o[0]+l),255*(n*o[1]+l),255*(n*o[2]+l)]},s.hcg.hsv=function(e){var t=e[1]/100,n=e[2]/100,r=t+n*(1-t),o=0;return r>0&&(o=t/r),[e[0],100*o,100*r]},s.hcg.hsl=function(e){var t=e[1]/100,n=e[2]/100,r=n*(1-t)+.5*t,o=0;return r>0&&r<.5?o=t/(2*r):r>=.5&&r<1&&(o=t/(2*(1-r))),[e[0],100*o,100*r]},s.hcg.hwb=function(e){var t=e[1]/100,n=e[2]/100,r=t+n*(1-t);return[e[0],100*(r-t),100*(1-r)]},s.hwb.hcg=function(e){var t=e[1]/100,n=e[2]/100,r=1-n,o=r-t,i=0;return o<1&&(i=(r-o)/(1-o)),[e[0],100*o,100*i]},s.apple.rgb=function(e){return[e[0]/65535*255,e[1]/65535*255,e[2]/65535*255]},s.rgb.apple=function(e){return[e[0]/255*65535,e[1]/255*65535,e[2]/255*65535]},s.gray.rgb=function(e){return[e[0]/100*255,e[0]/100*255,e[0]/100*255]},s.gray.hsl=s.gray.hsv=function(e){return[0,0,e[0]]},s.gray.hwb=function(e){return[0,100,e[0]]},s.gray.cmyk=function(e){return[0,0,0,e[0]]},s.gray.lab=function(e){return[e[0],0,0]},s.gray.hex=function(e){var t=255&Math.round(e[0]/100*255),n=(t<<16)+(t<<8)+t,r=n.toString(16).toUpperCase();return"000000".substring(r.length)+r},s.rgb.gray=function(e){return[(e[0]+e[1]+e[2])/3/255*100]}},,,,,function(e,t,n){var r=n(0),o=n(54),i=o.DropdownMenu,a=n(216),s=n(253),l=n(534),u=n(9),c=r.createClass({displayName:"MobileMultiSheet",componentDidMount:function(){u.attach("reactSheet:resetCurrentSheetId",this._forceRender)},componentWillUnMount:function(){u.detach("reactSheet:resetCurrentSheetId",this._forceRender)},render:function(){var e,t,n,o,a=this.props.getCurDoc(),l=a.ops,u=[],c=0,f=window.cow.currentSheetId;return this.selectedId=null,1===l.length?(n=l[0],o=n.getAttributes().name||"工作表1",t=r.createElement("div",{className:"single-sheet-wrap"},o)):(e=s.sortOps(l),u=e.map(function(e,t){var n=e.getAttributes(),r=n.id||0;return r===f&&(c=t),{display:n.name||"工作表1",value:r}}),t=r.createElement(i,{menuItems:u,displayKey:"display",valKey:"value",wrapClassName:"dropdown-menu-multi-sheet",forceTap:!0,hasMask:!0,isScroll:!0,itemTpl:this._itemTpl,selectedTpl:this._selectedTpl,selectedIndex:c,onMenuChange:this._onMenuChange})),r.createElement("div",{className:"m-multi-sheet-wrap"},t)},_forceRender:function(){this.forceUpdate()},_itemTpl:function(e,t,n,o){var i=t[o];return r.createElement("span",{className:"menu-item-text"},i)},_selectedTpl:function(e,t,n){var o=t[n],i="";return i=a.cutLength(o,13),r.createElement("div",{className:"selected-item-wrap"},r.createElement("span",{className:"menu-item-text"},i),r.createElement("span",{className:"menu-item-selected-icon s-toolbar-icon"}))},_onMenuChange:function(e,t,n){e.stopPropagation(),this._renderSheet(n.value)},_renderSheet:function(e){l.setCurrentSheetId(e),u.notify("mobileSheet:switched")}});e.exports=c},,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){function n(e){return Object.keys(e).map(function(t){return e[t]?r(t):null}).filter(function(e){return e}).join(" ")}function r(e){return e.replace(i,"$1-$2").toLowerCase()}function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:/^_\w+/,n=Object.getPrototypeOf(e);Object.getOwnPropertyNames(n).forEach(function(n){"constructor"!==n&&"function"==typeof e[n]&&t.test(n)&&(e[n]=e[n].bind(e))})}Object.defineProperty(t,"__esModule",{value:!0}),t.className=n,t.autoBind=o;var i=/([a-z\d])([A-Z])/g},function(e,t,n){function r(e){return(0,o.isRetina)()&&(e+="@2x"),n(1105)("./"+e+".png")}Object.defineProperty(t,"__esModule",{value:!0}),t.getIcon=r;var o=n(924)},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1120),f=r(c),d=n(9),p=r(d),h=function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={activeIndex:-1,urlList:[]},e.onGalleryClosed=e.onGalleryClosed.bind(e),e.onIndexChanged=e.onIndexChanged.bind(e),e.exitImgPreview=e.exitImgPreview.bind(e),e}return a(t,e),s(t,null,[{key:"propTypes",get:function(){return{type:l.PropTypes.string}}}]),s(t,[{key:"componentDidMount",value:function(){this.bindBCEvent()}},{key:"componentWillUnmount",value:function(){p.default.detach("doc:goback",this.exitImgPreview),p.default.detach("spreadsheet:exit",this.exitImgPreview)}},{key:"bindBCEvent",value:function(){var e=this;p.default.attach("img:preview",function(t,n){if(cow.pageType===e.props.type){e.setState({activeIndex:t,urlList:n,show:!0})}}),p.default.attach("doc:goback",this.exitImgPreview),p.default.attach("spreadsheet:exit",this.exitImgPreview)}},{key:"exitImgPreview",value:function(){var e=[];this.setState({activeIndex:-1,urlList:e,show:!1})}},{key:"onGalleryClosed",value:function(){"doc"===cow.pageType?p.default.notify("body:removeOverflowHidden"):"spreadsheet"===cow.pageType&&window.tableInst.listen(),this.setState({show:!1,activeIndex:-1,urlList:[]})}},{key:"onIndexChanged",value:function(e){this.setState({activeIndex:e})}},{key:"render",value:function(){var e=this.state,t=e.activeIndex,n=e.urlList,r=e.show;return 0===n.length?null:u.default.createElement(f.default,{activeIndex:t,onClosed:this.onGalleryClosed,onIndexChanged:this.onIndexChanged,show:r,urlList:n})}}]),t}(l.Component);t.default=h,e.exports=t.default},function(e,t,n){function r(e){return n(o(e))}function o(e){var t=i[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var i={"./check.png":1106,"./check@2x.png":1107,"./document.png":1108,"./document@2x.png":1109,"./folder.png":1110,"./folder@2x.png":1111,"./fx.png":1112,"./fx@2x.png":1113,"./settings.png":1114,"./settings@2x.png":1115,"./sheet.png":1116,"./sheet@2x.png":1117,"./team.png":1118,"./team@2x.png":1119};r.keys=function(){return Object.keys(i)},r.resolve=o,e.exports=r,r.id=1105},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAYAAAAfSC3RAAAABGdBTUEAALGPC/xhBQAAAYxJREFUKBWtkj1Iw1AUhZu/JiJaGrQOIg7+gIOrm6OLDhWEThEsXZSAgxYpLnaxLs5isVMIqcYpUDsJ7i6CSwIOgjhlaFUyxKRNPK8lUtShioHXd5N3v3NObxKL/fGifsNpmjbGMMwCRVHXbL+grusiADkej6+4rjvK9AMCSoRhuAW3bawpz/NeaAIqijJYr9f5n0QMwxjC8xzHcQQa8X3/Fs4XFFELgmADh02aps8zmYwXCRBBnudzAPZYlh1vtVp37Xb7AD01GsWSIAh5KBYQZ7VcLnMEhOAAoHU83yEQ+u6xDk3TvIJjyEKN9AXY57Dvi6L4rqrqDQ7XAOSRYhKJTEQ8sizLKBaLAQGYdDr9DCcPDfNYM1CdhkgCNRnGLKAHDKOE+0tZln0CkavzHuEwjFibaNyFSArNTdRJ1I+oS47jqNls1u0i3d/OVCVJeoPqGdxO0PyK/5VE1CdAx41GQ/sKfTpGSphiCs4FDGsZQqe2bVcQz4nOe/dvn1y1Wp1AzEWANZKkt/lf6g9wPbVswKvbrwAAAABJRU5ErkJggg=="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAABGdBTUEAALGPC/xhBQAAArtJREFUSA3tls+LUlEUx8f3MEXQMK1NrRsFo127hKChgSBa+PzFMBZlMgy0GWedsy3bWDAYJimCP55RDBHRDCRMu9pEIP4LBS10UTr4tO8R73Dfm1u6eNFm3ubcc8+Pzzn3ly4sHH8mr4DF5Hy6dJVK5ZzVai30er1EMpn8RkZJ52GiUiwWTwO2Z7FYrrlcrt18Pu+l9P+kw0KhcMrpdLYAu8B6GI1Gn7vd7lXTgejkpNvtfg/QJQZjcjwevzUVCJgDsHcAXGYQJgH7iS6XTdvDTCZzArDXIhjmDjRNuxmLxfZNARLM7/erSLzEOuLkAcZKPB7fpblDIAVVq9VMLpezcc4zh4qiyD6fr4wDckPgjMa01XA4vMNsMg0oKBgM1mVZXnM4HBcDgcDLVqulMac/SewLnYHngK0IfMbD4fAuOqvwNplgqOAFgiJkgFz0er2LkK/a7faYd+bHBGs0Gk/gd4+fZ2MckPvYs2dMZ1IKhULbCNZViCRhFFKYdsB8dRKwh/Bb101OFSzjZjQafSqySajkCwyiTm5RByKoqqoPAEuLEgK2hc6yIhvNTe4hDksa+/dI5ARgNhKJbDJbvV7fAEyYEMU/RmfCQlj85JRSRVQZm+QldUId0VytVluDLiwMsG2+MD4HP9a9NEiYlSRpg3dgYyRUYQtB18WQHatQwsG7jWJEW8NSTOThPSSNKqRKdR5TBTAFwyMwKqTZbN6ZB0apdEAKAnSdKp5yZok3nU5nBUs+886yRDogTRKUKga0wZxEEp3t4Z4qeKHo6Zr7m7w0Rm+68HhtdjwezzIKOGu0o5iP+G27nk6nfxlts/Qje8IHlEolj91u/wAo/0P6CbClVCrV5X3nHf8VSEnK5fIZm822D+h5dPa13+9fSSQSP+YFGP1mAimA/RkaDAar+L4bkxzr/3UFfgOKbxNQFaUmqAAAAABJRU5ErkJggg=="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAYAAAAfSC3RAAAABGdBTUEAALGPC/xhBQAAAQFJREFUKBWdUksKgzAQTaogLqULj1AKuvQipb1Cz9AL9C5diNBLqEhx11WO4NqF4KfzQidIqi76IMlM5r15Y1CKL6qqukkpz5zPT8dx1DAMjyRJnvN7HZdl+ZoW0Pf9RGuo6/pdFMWJhTsOxnHUIXUWRDSrbVtBjrs4jo++79/zPL+AaIQQMGhkgQWgCeC6royi6OB53pVS6epb2tiRc5wQk0AopUTXdSIIAtk0zR41I5w7osAgBxGGoXZGTGNPqBnhkqMmkCNcARJhCginxW/UrJWNJzPCNUdbzzwj5E420c6ZZ4TcySbaOfP+Fv68Kl5uC+w4F6ZZlm1pdI1+5xTBB3PZj+rTo3izAAAAAElFTkSuQmCC"},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAABGdBTUEAALGPC/xhBQAAAgpJREFUSA3llc1KAlEUgO/ogL/hJJZkadFAgkoIiT2CL9OmZU9Q6yBoUc/gM7g3nI2uhCDKpeFGGH/Gzhm8w7nTnRydIqgDF8+cv++ec++MCiPSbrf1xWJxBaYqMa9UIce0LMsYjUY3jUbjjSQo3W43VS6X38G2QHuIONkmMMyPx+OaoijnmqbdtlqtfTBhcb4wxBHV0UCBXdqd1ev1M2r/SodNMoCxV5DBYMCi0egdTOqiVqu9YF4ymbQ74zXcHWKX3Ofrdzab2XEHIPl8Pgf5ObDdA7QgK+AJRPB8PncWFpat8Xjs1N0D0XW9ALm70+n0AcZ75DiXiifQHYhjw+UW3iG3ZzKZnWKxeAzQtKqqj8Ph8JD78FcAUoeX7gWm8dsglUrlBGypyWRySX0CkI+QBnjpsm5p7BZIqVTSwXZK7cItxXNbR3i3nU6HwTtop4ZCIZZIJFg6nWa9Xu85FotZtGYgIBaCc8Krb58v3zDa8GxN01QikQjlMQEI76Hg9POABbPZrA3AeISGw2GGnfb7fWs5emd0ApDv0A+Ix2A3uKggDEHwEfjUgRC5CZCC3Lqs3u8CNzlDd1f0WVbv73cofGnoOH5KF0Yqm3kQsKyeAJRd4yBAWb2/D/znlwY/wkFkrUuz6h/dz0b8AA0AVZvN5pOfgn5iAGrQOGFmMMJrDMCdfdMysCYFfgCXqFFS+Z1bxAAAAABJRU5ErkJggg=="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAYAAAAfSC3RAAAABGdBTUEAALGPC/xhBQAAALJJREFUKBWdkD0OwjAMhW2IBBMSnKpHgBtQNo7CQrlBJ2aYOAMnoD9kQyyV+Fnih4PUrsVYih3F7/OzQvRncOSy/LhlQqpXEPNmOU/WffO+4C4/oE/Y9nVyli6SFe9P57s+ztrGL1XdGgdBTWwDdT0/0FRAk+kI+ehYqKMpVO5dgFRGTrfD1QlQcdzTFPBOSEoWK0i1ezbDcjR+m/xExLspXV63x8QEhiDeBHRiwPqfHUofSqxfIRSAZe4AAAAASUVORK5CYII="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAABGdBTUEAALGPC/xhBQAAAYJJREFUSA3tVc1KAzEQzmRTa6VSRPBZfAahh1566t2LN99F9CYi9CJ46EHw4BN48BHS7l4KIlj6s7W7GSeB7C5SWNJt9mRgSTI/37czmUkY+x97zgBYvLvR6Ajn4pH2PSujWQHDm5Ngft3v938K8p2X3HpuIdMqjgyuvtLje2tXdc4ivB2+YAnYN+k7JTbb1M/QTgaX3e5SK7MIt1n+ke1CpiF6bBE8WCx4evuY0ubMCjzPMwGIknJZF2FERcGk56iK8JFgyMaYlU5R52GNSIRMjVldjIihUMglg7KO2E+0wHkkeABSpfUQKlShaBzMJ/GqtZ8QSlAAIDTlMnx9/6TFaYl9ZXWSJB0qGkZHaHrRN+FscHE+M1cb6tagY/T7QaSDMxHSYUq98TxyQjSE3rs/J0wRJpyuHM8j1PgmpVxtpHJ6qdx/jQozJ1yuYtlsHrqjOHgg5znhur2Jg7jh4O5uyuni1l4mpel03VqI1B3FwQMgMIQOLtVMEet6kqr9Z3XvX+03sZUQC+wmAAAAAElFTkSuQmCC"},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAOCAYAAAAbvf3sAAAAAXNSR0IArs4c6QAAAUlJREFUKBVjZMACMjIydP7//5/JyMh4cMaMGauQlbAgc0Ds9PR0/X///kWwsbG1AjXxoMtjaAAqqGdiYpo0ZcqUZ+iKQXwmZMGGhgYWoKluQKdcRBZHZjPDOJmZmUqfPn3qB/K1gPifsbHx47Nnz76HycNoRhgDRAM9mwR0f/isWbPcQXygf+KANjpxcXEVfPv2bRnQqQkoTgJKagCdcx2kGASACo4AKV2g4jgpKakAYIi9QtEAlNQEYrj7p0+ffg9owHEgfgn03y+gHKqngXwtZmbm8yAJEAA6URpI/QFir9zcXFGQGNyGkpISbiBf0MHB4TJIIi0trRToxFJJSckSIG36+/fvcJA4HABNswZ6cgVMABTESGw2GBtOAxWXAzUZwgVwMFiACicA5TiB+AAwFODux6GegQWUDIChwD5t2jR4cOJSDBIHANe3bkpopE29AAAAAElFTkSuQmCC"},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAcCAYAAAB75n/uAAAAAXNSR0IArs4c6QAAAwVJREFUSA3VlUtoU1EQhpvkNtW0SFwaob4o1Sqo6FoQBJ8LNz5QClVqmkITG1y4UDGgIu4SG9skIoKgYLci6qK6sCJqH6AFUdwJSVsUJTRtKXn4Tbgp15tzvSniwgMn58ycf/6ZMzPnpq7uHw/HUvkjkYgznU5v0zTtc39//4ydvdMOYDwPBALhTCYzjW40n89PIq81nqv2mkpp1oXD4eWzs7P3i8XihMvlaikUChGHw3HS6XTOm7FmuSYHc3NzFzHc5fP5jpKiPPuz+jTzVcm2Neju7m4l4vdE/CCZTJ6qYrBR2NaAtJyDw818YcOlPLZ1UCqV9oslNxhTMtgoLVMUDAZX0CltpOc1HPONjY2rkfPIxVras+JXeYOurq4rCwsL30nPKx24LJfLfUU3joNgxbiW1fIGYoyju6Sog/TcpsD+WgjNmD+2KeSbdYMPZkORCWAry03mPQK4Izoe33bsZD+GrlOZIgECInDHJn0/Iatx0L7rwVxH18x6ze/310tLk9Yk8ih6efF1ljfo6ekRwyYBNTQ0VDmAaIPX6z2WzWaPg0sBO4Ku3e12H47H42mxk2FZA65/AMPHYDKpVMpXRit+iHolhZ/itjPg94D9rZ0tUwRXm/BhOK7gXVQNDAz8QBhm1tPKHxcP9I2lA6LZomNGzEZGmRvsIIg14Jv4IJYfpfHc0gFG5Q7C8K3RwLjv7e31kp4oX9i94PNg2+Wcgq+Shyp7pYPBwUEXYElRgQK/FKBxQHCJdrxAxG/4ZF/mZX/h/ClODlG7AOstnJa5lV00NDTUioGH+a6vry9rJJc9BKfpGB/rmUQi8Vx0BHQDeR9riE46GI1Gf4pe6QCgPBYheiIg8+DvcidTi8ViU5UzumeYmzXzuCaxK1X0yjYFGAMQgqNFv34Fv+RVWQNYdhPFs78ll2iqUsQLXsdXcyMOTiw5XIWBRjqE7DzdEGedhjzKGqJ4VZ8Hhb2tSlLUSUE76OcR5ifkRxQqYWtZI0DzeDxX6edvRO3mFg95+uLk/xm/ACSoR2rr87JkAAAAAElFTkSuQmCC"},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAALGPC/xhBQAAAopJREFUOBF1kktoE2EQx7PZzaNp2iYhKWrEFyymwaJYX7QIKYjXHAKBtMcc7cWT3nITvOjJc24hCQRvqUVE21IPQhFRU/GgQkFNjMGYV5NsEn+ztFIEP5id+Wbm/5/Ht4rlPyefz89qmrZgtVqnFEV5U61Wt5LJZOPfdOXAAcBO8knDMBR0GdAycltV1SPkFEaj0f1Wq/ULn99ut3+Px+M/BGsSFItFR71enyOQIHFsMBjsEluQDtAufB+Hw+EqYkAYhGTdZrM9jkajZU1YarVaAEcUc4mgEzGQMQA2tAUCna6OSS53BypIN1/o+qlJQOUugSaAPtpHsoCGJB74xrHd4ucYxFpIu1QqjTRY1EAg0GBJ3wi2paJoxniNXkd+4zsHIIJ9fJ+8QsflVCqlaATnK5VKBH2VYICkEZ28Qz/Ct4buAD6NbnBfRk8gl5CVQqGwKiNcZzF3AdlJ1GQMfNskb7DpGraMs5PL5TaoGsGeQUJgzlBQlaFURIjMAXFKB4Nutys7MA9kogf4TR93OYJR5fOSeR/iuIA9j3bzfOexr7CfZyxqT9f1ExBfIyZPKAU+IJt0sqbx2Ww2m69cLleMFk8BPCtkAG5hz4RCIVniLPeb5HqQHvetTqfzwOFwfNaYs5fJZCapOk1Afhp56wkAi1SZY1Z54inIXGiURcHvJ99Dd4aMYIHJiXMac5KkNiQdbAH49kEyfx1bzjjkUswXDofNRVjYwU9AT6jmR9u4v8e+TNINxI1vByli2yHSsV/QwdtYLDYwe5Iu0um00+v16u12WyH4icQldnIHoiB2ttfr3aPyHuRHSd9NJBJfBfeXQC6HTzabvQjBIiAP/u1+v/+cfdUP54j9B/DGSfLRCZVDAAAAAElFTkSuQmCC"},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABGdBTUEAALGPC/xhBQAAA1NJREFUWAnlVz1oU1EUbhKiDZQMQtKMCpUmjXUoiij4NwgKQitKbAkEhcwd1MU/6KCbOtQ1oARCkwyV4mAFh6iLgrioDcWOLk1BaHFIDEn8vpIbzrvvvr60Rh18cLnnnvOdn3feufee19f3jx/PTvwXi8WWSS+RSGzbntdk6G/yHAOYmZnZVSgUbs7Ozu7eaUDUnZubu0VbTjaMKaNCNBoteL3eiWaz+aJSqVyYnp6u53K5sz6f7zL4KZNBYLPg5ycnJ1/CuT8cDj8D9hx4C0tLSwnY/anr2QKg85GRkSKA4wJcAh3CiAveVuQXBFOB89MCZAzCJwB9Ds4J2YsRJtHlE/Z4PPs0bDQUCh2Mx+PzpVKpoWSWGojFYtchkG+ucL2ax4eHh29IY5YAVldXH/GbS0Av6Vartbi2tvZQ2rTVACs3Eok8B+iMBP4ujRd7hWI+j2KuSVuWDFBAACJtSpCJBqYMozkO0iaM5KEmGrpzym0ZyGazB/r7+z9JZUnD4ddGo5FOJpNvJB9b9AS2aAaVv1/yJV2tVkdTqdRnybNlIBAIXJQAjV5ZX18/pjsnhrxarXYU5Iqm01n6/f5LnUWb2MyA09mug+v1+kmTc4ljJuDoteQ50bw7bBlwAvM7uzmnLjHd1ITys50APigltxkBdI3tOgA4NV7BbsG4ybsOANvosJsxJQf2kKLd5u0EEMPVetzNIDEIIOaGU3LbOQADV7CfnyiANq9sbGwcSafT3zX+5jKTyewJBoPvsRgyyXF+XJ2amnoqZbYM4KyeRxH9kCBBDw0MDLzjVhO8TZI8yrAwOqdN2tb1bBkgIJ/P38OJdlsHyzW3GsZH8pDyMbe04wS9j0bljrRB2paBdgs2pgP1NR0iyCSHm/O27ljbtsWUJQMEiDbKAuzFAllQ7V3nRrRkYHBw8BreiD3cH3loG10Rm57OYwmgXC6zWVjoSHtPLCwvLz+QZi09IXs19mzs3QCKKiCKbRHpe4w3GAUvqPgO8zdst7uUoTbk1WxsSi01oAyyOVVtOZ2jVZtoNxNe3Jw8jEoKq82ncMO9Ba+p1ZPROXWNAVDAINiksk/UOxmn61v/NWMQ/OZMO+zZ/gm2DIBCp6fbAJz0Jd9ShFLw39C/AIMuWid1EUC1AAAAAElFTkSuQmCC"},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAYAAAAfSC3RAAAABGdBTUEAALGPC/xhBQAAARBJREFUKBWtUkuKg0AQrY6CuJQsPMIQ0KVLwTMMkyvkDHOBuUsWIswZBBUJ7rLyCK5dCH5Sr5lqGiLJZh5Ud1XXe/2KphX9oW3bb6XUl9T27jhOvyzLNUmSX/tc503T3LYdzPO8cSxd193ruv4U4UGSdV11yjcTE02M40jseIjj+OT7/k9VVWcQjRACAY9MCACXAK7rqiiKPjzPu3CpXH3KizhKjR1iFlDf9zRNEwVBoIZhOKJnhLYjGgJ2oDAMtTNyHntDzwj3HDWBHeEKsAhTQLgZoTiWZalJe0uWZSQ88zi2Y5qmhADsHLXwnhzRtF3tHL3/c5QR3jkKz4wqB3iAVxCeLcyLonil0T3+zjmSBwYCoowJPO3YAAAAAElFTkSuQmCC"},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAABGdBTUEAALGPC/xhBQAAAldJREFUSA3NVc1qIkEQ7lHB3xBXTCTZ6IYdWEElBCLmJB59mb3scZ9gcw4E9rD7DD6DeDXoRU9CIOx6NHgR/BtTNaSG6t7uzGgSNgVNl19XfV9V9cxoCWbdbtfebDbfATpnsK8LOXPHcfrT6fSq2Wz+ZQnWYDDYL5fLD4BtEA+xQ7GLGOYnEom0ZVmX6XT6ut1ufwQIyWlhiGcRzwMHqnQ7q9VqFxx/zociBYiJP2Dj8VjEYrEbmNTXarV6j3mpVMrtjDjUDrFLOgu0r1YrN+4ELJ/PH0P+MWA/QbSgIzAKovB6vfYWEuvWbDbzeI/AbNsuQO7hcrn8BeM99Q6fHKOgGohjw6UadUh4Nps9KBaLn0E0E4lEfk8mk090hrskyA9MvkmYx38Aq1QqXwDbXywW3/iZJEgj5AEmX9ctj90DK5VKNmBnHJeeUry3bYy67fV6At5BNzUUColkMikymYwYDod38Xjc4ZwvEkQiuCd89N37pYIRw7udz+dWNBrlekIShPdQOgzyAwlzuZwrgPEoGg6HBXY6Go2cp9F7o5MEqcIgQhSD3eDihmIoBB+BfzqQIncR5EKqr+P7v4LqHXY6HbXoQL8bjYYbp/Ih+L46pHbq9Tq57k6dm3AK1nUofWko8C13aaS6ilCcOlILMeEUp+OTBHWPMSXvsuv4Agma7sqEU3E7CxLBtruvoInQdFcm3MSDuDRS3SU/l+x3puOTBNUR0BfDj9h0rvJhnFHQ7x/dJMLxIIJ9EDpvtVq3PPElPoj2eb70pYH/sR8YgJW90uojJxd8BIdaajWzP1e6AAAAAElFTkSuQmCC"},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAYAAAAfSC3RAAAABGdBTUEAALGPC/xhBQAAAG9JREFUKBVjYCATMKLru3Tp0n90MRhfT08PQz1MjuHChQtYNaKLg004e/YsVsVw07AwmEBi//79YzA2NmYE0YQwTB0LSOPfv39BFJwGc/AQIPVDTSMoQEAARuPxHlwd2X4Ex+OOHTtIjkdCrqK+PAD7Rmji+c52CAAAAABJRU5ErkJggg=="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAABGdBTUEAALGPC/xhBQAAAMNJREFUSA3tlVEKwyAQRE3peRTEO3hm7yCCHkhLthXWUFcbbT8a85NsVp8zE4mMrWtyAhvFCyEkql/rcc6r3Ftt0rfe3ylwSk+DQoiqYjzfe99MpGtBDKWes0BqDCh3zjWVUZDenpRyA4c9ynqhrXHFgkopcGytneL4HQ8WjDEWwo510TxRYF7hMLNmR4x5y2FOeei+viHDu2ooy9dkzLvILsWW9xSO9WismPf/fxo4HYwxU06HVvRa69+fhy1Rq/9xAg8mbJ6RNEDp7AAAAABJRU5ErkJggg=="},function(e,t,n){(function(r){function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=o(u),f=n(1121),d=o(f),p=n(1122),h=o(p),m=n(1123),g=o(m),_=n(20),v=o(_),y=n(1124),b=o(y),w=n(30),C=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={imageOriginWidth:0,imageOriginHeight:0,imageCurrentWidth:0,imageCurrentHeight:0,imageScale:0,imageStyle:{},disableAction:!0},n.scaleSteps=[.1,.25,.33,.5,.65,.8,1,1.25,1.5,2,2.5,3,3.5,4],n.exitPreview=n.exitPreview.bind(n),n.onKeyup=n.onKeyup.bind(n),n.zoomIn=n.zoomIn.bind(n),n.zoomOut=n.zoomOut.bind(n),n.onImageLoaded=n.onImageLoaded.bind(n),n.onImageStartLoad=n.onImageStartLoad.bind(n),n.onViewerResize=n.onViewerResize.bind(n),n.pan=n.pan.bind(n),n.displayFixedExtent=n.displayFixedExtent.bind(n),n.displayOriginScale=n.displayOriginScale.bind(n),n}return s(t,e),l(t,null,[{key:"propTypes",get:function(){return{activeIndex:u.PropTypes.number,urlList:u.PropTypes.array,show:u.PropTypes.bool,onClosed:u.PropTypes.func.isRequired,onIndexChanged:u.PropTypes.func.isRequired}}}]),l(t,[{key:"componentDidMount",value:function(){document.addEventListener("keyup",this.onKeyup)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keyup",this.onKeyup)}},{key:"exitPreview",value:function(){this.props.onClosed()}},{key:"changeIndex",value:function(e){this.props.onIndexChanged(e)}},{key:"stopEvent",value:function(e){return e.stopPropagation(),e.preventDefault(),!1}},{key:"onImageStartLoad",value:function(){this.setState({disableAction:!0})}},{key:"onImageLoaded",value:function(e,t,n){var r=this,o=e.height,i=e.width,a=t.height,s=t.width,l=n.height-50,u=n.width;this.setState({imageCurrentWidth:s,imageCurrentHeight:a,imageOriginWidth:i,imageOriginHeight:o,viewerHeight:l,viewerWidth:u,disableAction:!1},function(){r.calcImageSize()})}},{key:"calcImageSize",value:function(){var e=this.state,t=e.imageOriginHeight,n=e.imageOriginWidth,r=e.viewerWidth,o=e.viewerHeight,i=this.state,a=i.imageCurrentWidth,s=i.imageCurrentHeight,l=n,u=t,c=u/t,f="0px",d=t/n;if(t>=o&&d<=1.8||n>=r){var p=.9*o/t,h=.9*r/n;c=p>h?h:p,l=n*c,u=t*c}u<=o&&(f=.5*(o-u)+"px");var m=.5*(r-l)+"px",g={position:"absolute",top:f,left:m,maxHeight:"none",maxWidth:"none",width:l,height:u,margin:0};a=l,s=u,this.fixedScale=c,this.fixedOffsetTop=f,this.fixedOffsetLeft=m,this.setState({imageCurrentWidth:a,imageCurrentHeight:s,imageOriginWidth:n,imageOriginHeight:t,imageStyle:g,imageScale:c})}},{key:"zoomIn",value:function(){this.resizeImage(this.getNextScale("zoomIn"))}},{key:"zoomOut",value:function(){this.resizeImage(this.getNextScale("zoomOut"))}},{key:"getNextScale",value:function(e){var t=this.state.imageScale,n=0,r=this.scaleSteps,o=r.length;for(n=0;n<o;n++){var i=r[n];if(t<=i){t="zoomIn"===e&&i-t<.1&&n<o-1?r[n+1]:"zoomOut"===e&&t-i<.1&&n>0?r[n-1]:i;break}}return t}},{key:"pan",value:function(e,t){var n=r.assign({},this.state.imageStyle),o=this.state,i=o.viewerHeight,a=o.viewerWidth;if(a=parseInt(a,10),i=parseInt(i,10),parseInt(n.width,10)>a){var s=this.getMinLeft();t=t>10?10:t,t=t<s?s:t}if(parseInt(n.height,10)>i){var l=this.getMinTop();e=e>10?10:e,e=e<l?l:e}n.top=e+"px",n.left=t+"px",this.setState({imageStyle:n})}},{key:"displayOriginScale",value:function(){this.resizeImage(1)}},{key:"displayFixedExtent",value:function(){var e=this;this.calcImageSize(),setTimeout(function(){e.resizeImage(e.fixedScale)},10)}},{key:"resizeImage",value:function(e){var t=this.state,n=t.imageOriginHeight,o=t.imageOriginWidth,i=t.imageCurrentWidth,a=t.imageCurrentHeight,s=t.imageStyle,l=t.viewerWidth,u=t.viewerHeight,c=s.top,f=s.left;c=parseInt(c,10),f=parseInt(f,10);var d=r.assign({},s),p=n*e,h=o*e;d.width=h,d.height=p;var m=.5*l,g=.5*u;c=p<u?.5*(u-p):g-(g-c)*p/a,f=h<l?.5*(l-h):m-(m-f)*h/i,d.top=c+"px",d.left=f+"px",this.setState({imageStyle:d,imageScale:e,imageCurrentHeight:p,imageCurrentWidth:h})}},{key:"onViewerResize",value:function(e){var t=this;this.setState({viewerWidth:e.width,viewerHeight:e.height},function(){t.calcImageSize()})}},{key:"getMinLeft",value:function(){var e=this.state.viewerWidth,t=this.state.imageStyle;return(e=parseInt(e,10))-parseInt(t.width,10)-10}},{key:"getMinTop",value:function(){var e=this.state.viewerHeight,t=this.state.imageStyle;return(e=parseInt(e,10))-parseInt(t.height,10)-10}},{key:"onKeyup",value:function(e){var t=this.props,n=t.activeIndex,r=t.urlList,o=t.show,i=this.state,a=i.viewerWidth,s=i.imageStyle;if(!o)return this.stopEvent(e);if(e.keyCode===w.keyCodes.DOWN&&n<r.length-1)this.changeIndex(n+1);else if(e.keyCode===w.keyCodes.UP&&n>0)this.changeIndex(n-1);else if(e.keyCode===w.keyCodes.ESC)this.exitPreview();else if(e.keyCode===w.keyCodes.LEFT||e.keyCode===w.keyCodes.RIGHT){var l="number"==typeof a&&a<parseInt(s.width,10),u=parseInt(s.left,10),c=parseInt(s.width,10),f=e.keyCode===w.keyCodes.LEFT?1:-1,d=u-.1*c*f;l&&this.pan(parseInt(s.top,10),d)}return this.stopEvent(e)}},{key:"render",value:function(){var e=this.props,t=e.activeIndex,n=e.show,r=e.urlList,o=e.onIndexChanged,i=this.state,a=i.imageStyle,s=i.imageScale,l=i.viewerHeight,u=i.viewerWidth,f=i.disableAction;if("boolean"==typeof n&&!n||!r&&0===r.length)return null;var p=t>-1&&t<r.length?r[t]:"",m=p.replace(/!thumbnail$/i,"!original"),_=(0,v.default)({modal:t>-1,"gallery-box":!0,"thumb-show":r.length>0}),y=this.scaleSteps,w=s!==y[y.length-1],C=s!==y[0],S=1!==s,x=this.fixedOffsetLeft!==a.left||this.fixedOffsetTop!==a.top||this.fixedScale!==s,T="number"==typeof l&&l<a.height,E="number"==typeof u&&u<a.width;return c.default.createElement("div",{className:_},c.default.createElement(g.default,{imageUrl:m,imageStyle:a||{},enableVerticalScroll:T,enableHorizontalScroll:E,pan:this.pan,onImageStartLoad:this.onImageStartLoad,onViewerResize:this.onViewerResize,onImageLoaded:this.onImageLoaded,exitPreview:this.exitPreview}),c.default.createElement(h.default,{activeIndex:t,urlList:r,onIndexChanged:o}),c.default.createElement(d.default,{zoomIn:this.zoomIn,zoomOut:this.zoomOut,disableAction:f,displayOriginScale:this.displayOriginScale,displayFixedExtent:this.displayFixedExtent,enableZoomIn:w,enableZoomOut:C,enableFixedExtent:x,enableOriginScale:S,activeIndex:t,totalCount:r.length,imageUrl:p}),c.default.createElement(b.default,{urlList:r}))}}]),t}(u.Component);t.default=C,e.exports=t.default}).call(t,n(1))},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleZoomIn=n.handleZoomIn.bind(n),n.handleZoomOut=n.handleZoomOut.bind(n),n.handleDisplayOriginScale=n.handleDisplayOriginScale.bind(n),n.handleDisplayFixedExtent=n.handleDisplayFixedExtent.bind(n),n}return a(t,e),s(t,null,[{key:"propTypes",get:function(){return{activeIndex:l.PropTypes.number.isRequired,totalCount:l.PropTypes.number.isRequired,imageUrl:l.PropTypes.string.isRequired,zoomIn:l.PropTypes.func.isRequired,zoomOut:l.PropTypes.func.isRequired,displayOriginScale:l.PropTypes.func.isRequired,displayFixedExtent:l.PropTypes.func.isRequired,enableZoomIn:l.PropTypes.bool,enableZoomOut:l.PropTypes.bool,enableOriginScale:l.PropTypes.bool,enableFixedExtent:l.PropTypes.bool,disableAction:l.PropTypes.bool}}}]),s(t,[{key:"handleZoomIn",value:function(e){/ disable/.test(e.target.className)||this.props.zoomIn()}},{key:"handleZoomOut",value:function(e){/ disable/.test(e.target.className)||this.props.zoomOut()}},{key:"handleDisplayOriginScale",value:function(e){/ disable/.test(e.target.className)||this.props.displayOriginScale()}},{key:"handleDisplayFixedExtent",value:function(e){/ disable/.test(e.target.className)||this.props.displayFixedExtent()}},{key:"render",value:function(){var e=this.props,t=e.activeIndex,n=e.totalCount,r=e.imageUrl,o=e.disableAction,i=this.props,a=i.enableZoomIn,s=i.enableZoomOut,l=i.enableOriginScale,c=i.enableFixedExtent,f="gallery-action-item",d="gallery-toolbar-icons gallery-toolbar-",p=n>1?t+1+"/"+n:"";return u.default.createElement("div",{className:"gallery-details"},u.default.createElement("span",{className:"gallery-detail-text"},u.default.createElement("number",{className:"gallery-detail-number"},p)),u.default.createElement("div",{className:"gallery-action"},u.default.createElement("a",{className:f+(o||!a?" disable":""),href:"javascript:void(0)",onClick:this.handleZoomIn},u.default.createElement("i",{className:d+"zoom-in"}),u.default.createElement("span",{className:"tooltip s-tooltip top"},"放大")),u.default.createElement("a",{className:f+(o||!s?" disable":""),href:"javascript:void(0)",onClick:this.handleZoomOut},u.default.createElement("i",{className:d+"zoom-out"}),u.default.createElement("span",{className:"tooltip s-tooltip top"},"缩小")),u.default.createElement("a",{className:f+(o||!l?" disable":""),href:"javascript:void(0)",onClick:this.handleDisplayOriginScale},u.default.createElement("i",{className:d+"origin-scale"}),u.default.createElement("span",{className:"tooltip s-tooltip top"},"实际大小")),u.default.createElement("a",{className:f+(o||!c?" disable":""),href:"javascript:void(0)",onClick:this.handleDisplayFixedExtent},u.default.createElement("i",{className:d+"fixed-extent"}),u.default.createElement("span",{className:"tooltip s-tooltip top"},"适应页面")),u.default.createElement("a",{className:f,href:"/download/image?url="+r,target:"_blank",title:"下载图片"},u.default.createElement("i",{className:d+"link-download"}),u.default.createElement("span",{className:"tooltip s-tooltip top"},"下载原图"))))}}]),t}(l.Component);t.default=c,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(20),f=r(c),d=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.renderListItem=n.renderListItem.bind(n),n}return a(t,e),s(t,null,[{key:"propTypes",get:function(){return{urlList:l.PropTypes.array.isRequired,activeIndex:l.PropTypes.number.isRequired,onIndexChanged:l.PropTypes.func.isRequired}}}]),s(t,[{key:"componentDidMount",value:function(){this.adjustActivedThumbnailPosition()}},{key:"shouldComponentUpdate",value:function(e){var t=this.props;return e.urlList.length!==t.urlList.length||(e.activeIndex!==t.activeIndex||e.urlList.some(function(e,n){return t.urlList[n]!==e}))}},{key:"componentDidUpdate",value:function(){this.adjustActivedThumbnailPosition()}},{key:"adjustActivedThumbnailPosition",value:function(){var e=this.refs.galleryList,t=this.refs["thumbnail"+this.props.activeIndex];if(e&&t){var n=t.getBoundingClientRect(),r=e.getBoundingClientRect(),o=n.bottom-r.bottom,i=r.top-n.top;o>=0?e.scrollTop=e.scrollTop+o+.67*r.height:i>=0&&(e.scrollTop=e.scrollTop-i)}}},{key:"onListItemClick",value:function(e,t){var n=this.props,r=n.activeIndex,o=n.onIndexChanged;if(r===e)return void t.stopPropagation();o(e)}},{key:"renderListItem",value:function(e,t){var n=this.props.activeIndex,r={"gallery-list-item":!0,thumb:!0,active:n===t};return u.default.createElement("p",{className:(0,f.default)(r),onClick:this.onListItemClick.bind(this,t),ref:"thumbnail"+t,key:t},u.default.createElement("img",{className:"gallery-list-img",src:e}))}},{key:"render",value:function(){var e=this.props.urlList;return u.default.createElement("div",{className:"gallery-list",ref:"galleryList"},e.map(this.renderListItem))}}]),t}(l.Component);t.default=d,e.exports=t.default},function(e,t,n){(function(r){function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=o(u),f=n(923),d=o(f),p=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={isLoading:!0},n.downTimer=-1,n.isMoving=!1,n.isMouseDown=!1,n.onViewerClick=n.onViewerClick.bind(n),n.onLoad=n.onLoad.bind(n),n.onWindowResize=n.onWindowResize.bind(n),n.onMouseDown=n.onMouseDown.bind(n),n.onMouseMove=n.onMouseMove.bind(n),n.onMouseUp=n.onMouseUp.bind(n),n.onWheel=n.onWheel.bind(n),n.onMouseOut=n.onMouseOut.bind(n),n}return s(t,e),l(t,null,[{key:"propTypes",get:function(){return{imageUrl:u.PropTypes.string.isRequired,exitPreview:u.PropTypes.func,onImageLoaded:u.PropTypes.func,imageStyle:u.PropTypes.object,onViewerResize:u.PropTypes.func,pan:u.PropTypes.func,enableVerticalScroll:u.PropTypes.bool,enableHorizontalScroll:u.PropTypes.bool}}}]),l(t,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.onWindowResize)}},{key:"componentWillReceiveProps",value:function(e){e.imageUrl!==this.props.imageUrl&&this.setState({isLoading:!0})}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onWindowResize)}},{key:"onWindowResize",value:function(){var e={width:this.refs.viewerWrapper.offsetWidth,height:this.refs.viewerWrapper.offsetHeight-50};this.viewerSize=e,this.props.onViewerResize(e)}},{key:"onLoad",value:function(e){var t=this,n=e.target,r={width:n.naturalWidth,height:n.naturalHeight},o={width:n.width,height:n.height},i={width:this.refs.viewerWrapper.offsetWidth,height:this.refs.viewerWrapper.offsetHeight};this.viewerSize=i,this.setState({isLoading:!1},function(){t.props.onImageLoaded(r,o,i)})}},{key:"onViewerClick",value:function(){var e=this.props.exitPreview;this.isMoving?this.isMoving=!1:this.wasOuted?this.wasOuted=!1:"function"==typeof e&&e(),this.downTimer>-1&&(clearTimeout(this.downTimer),this.downTimer=-1)}},{key:"onMouseDown",value:function(e){var t=this;this.isMouseDown=!0,this.lastMousePosition={x:e.clientX,y:e.clientY},this.downTimer>-1&&clearTimeout(this.downTimer),this.downTimer=setTimeout(function(){t.isMoving=!0,console.log(t.isMoving)},200)}},{key:"onMouseMove",value:function(e){if(this.isMouseDown){this.downTimer>-1&&(this.isMoving=!0,clearTimeout(this.downTimer),this.downTimer=-1);var t=this.props,n=t.enableVerticalScroll,o=t.enableHorizontalScroll,i=r.assign({},this.props.imageStyle),a=i.top,s=i.left;s=parseInt(s,10),o&&(s+=e.clientX-this.lastMousePosition.x),a=parseInt(a,10),n&&(a+=e.clientY-this.lastMousePosition.y),this.lastMousePosition={x:e.clientX,y:e.clientY},this.props.pan(a,s)}}},{key:"onMouseOut",value:function(){this.isMoving&&(this.isMoving=!1,this.isMouseDown=!1,this.wasOuted=!0),this.downTimer>-1&&(clearTimeout(this.downTimer),this.downTimer=-1)}},{key:"onMouseUp",value:function(){this.isMouseDown=!1}},{key:"onWheel",value:function(e){var t=r.assign({},this.props.imageStyle),n=this.props,o=n.enableVerticalScroll,i=n.enableHorizontalScroll,a=t.top,s=t.left;a=parseInt(a,10),s=parseInt(s,10),i&&(s-=e.deltaX),o&&(a-=e.deltaY),(i||o)&&this.props.pan(a,s),e.preventDefault(),e.stopPropagation()}},{key:"render",value:function(){var e=this.props,t=e.imageUrl,n=e.imageStyle,o=r.assign({},n);return this.state.isLoading&&(o=r.assign(o,{opacity:"0",width:"0px",height:"0px"})),c.default.createElement("div",{className:"gallery-img-box sheet-gallery-img-box",ref:"viewerWrapper",onWheel:this.onWheel,onMouseMove:this.onMouseMove,onMouseOut:this.onMouseOut,onClick:this.onViewerClick},c.default.createElement(d.default,{show:this.state.isLoading}),c.default.createElement("img",{src:t,className:"gallery-img sheet-gallery-img",style:o||{},draggable:!1,onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onLoad:this.onLoad}),c.default.createElement("a",{className:"hidden-link",href:"javascript:void(0)"}))}}]),t}(u.Component);t.default=p,e.exports=t.default}).call(t,n(1))},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"renderImageObjecList",value:function(){return this.props.urlList.map(function(e,t){var n=e.replace(/!thumbnail$/i,"!original");return u.default.createElement("li",{key:t},u.default.createElement("img",{src:n}))})}},{key:"render",value:function(){var e={position:"fixed",overflow:"hidden",width:"0px",height:"0px",pointerEvents:"none",opacity:0,top:"-1000px",left:"-1000px"};return u.default.createElement("ul",{className:"image-gallery-pre-loader",style:e},this.renderImageObjecList())}}],[{key:"propTypes",get:function(){return{urlList:l.PropTypes.array}}}]),t}(l.Component);t.default=c,e.exports=t.default},,,,function(e,t,n){var r=n(409),o=n(1129),i=Object.prototype,a=i.hasOwnProperty,s=o(function(e,t,n){a.call(e,n)?e[n].push(t):r(e,n,[t])});e.exports=s},function(e,t,n){function r(e,t){return function(n,r){var l=s(n)?o:i,u=t?t():{};return l(n,e,a(r,2),u)}}var o=n(1130),i=n(1131),a=n(853),s=n(261);e.exports=r},function(e,t){function n(e,t,n,r){for(var o=-1,i=null==e?0:e.length;++o<i;){var a=e[o];t(r,a,n(a),e)}return r}e.exports=n},function(e,t,n){function r(e,t,n,r){return o(e,function(e,o,i){t(r,e,n(e),i)}),r}var o=n(1132);e.exports=r},function(e,t,n){var r=n(1133),o=n(1136),i=o(r);e.exports=i},function(e,t,n){function r(e,t){return e&&o(e,t,i)}var o=n(1134),i=n(411);e.exports=r},function(e,t,n){var r=n(1135),o=r();e.exports=o},function(e,t){function n(e){return function(t,n,r){for(var o=-1,i=Object(t),a=r(t),s=a.length;s--;){var l=a[e?s:++o];if(!1===n(i[l],l,i))break}return t}}e.exports=n},function(e,t,n){function r(e,t){return function(n,r){if(null==n)return n;if(!o(n))return e(n,r);for(var i=n.length,a=t?i:-1,s=Object(n);(t?a--:++a<i)&&!1!==r(s[a],a,s););return n}}var o=n(265);e.exports=r},,,function(e,t){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.cow;return"editable"===e.permission||e.isMobile&&e.isMobileEditable}Object.defineProperty(t,"__esModule",{value:!0}),t.isHasEditPermission=n},,,,,,,,,,,,,,,function(e,t,n){"use strict";function r(e,t){if(!(this instanceof r))return new r(e,t);if(t&&t in p&&(t=null),t&&!(t in f))throw new Error("Unknown model: "+t);var n,o;if(e)if(e instanceof r)this.model=e.model,this.color=e.color.slice(),this.valpha=e.valpha;else if("string"==typeof e){var i=c.get(e);if(null===i)throw new Error("Unable to parse color from string: "+e);this.model=i.model,o=f[this.model].channels,this.color=i.value.slice(0,o),this.valpha="number"==typeof i.value[o]?i.value[o]:1}else if(e.length){this.model=t||"rgb",o=f[this.model].channels;var a=d.call(e,0,o);this.color=u(a,o),this.valpha="number"==typeof e[o]?e[o]:1}else if("number"==typeof e)e&=16777215,this.model="rgb",this.color=[e>>16&255,e>>8&255,255&e],this.valpha=1;else{this.valpha=1;var s=Object.keys(e);"alpha"in e&&(s.splice(s.indexOf("alpha"),1),this.valpha="number"==typeof e.alpha?e.alpha:0);var l=s.sort().join("");if(!(l in h))throw new Error("Unable to parse color from object: "+JSON.stringify(e));this.model=h[l];var g=f[this.model].labels,_=[];for(n=0;n<g.length;n++)_.push(e[g[n]]);this.color=u(_)}else this.model="rgb",this.color=[0,0,0],this.valpha=1;if(m[this.model])for(o=f[this.model].channels,n=0;n<o;n++){var v=m[this.model][n];v&&(this.color[n]=v(this.color[n]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}function o(e,t){return Number(e.toFixed(t))}function i(e){return function(t){return o(t,e)}}function a(e,t,n){return e=Array.isArray(e)?e:[e],e.forEach(function(e){(m[e]||(m[e]=[]))[t]=n}),e=e[0],function(r){var o;return arguments.length?(n&&(r=n(r)),o=this[e](),o.color[t]=r,o):(o=this[e]().color[t],n&&(o=n(o)),o)}}function s(e){return function(t){return Math.max(0,Math.min(e,t))}}function l(e){return Array.isArray(e)?e:[e]}function u(e,t){for(var n=0;n<t;n++)"number"!=typeof e[n]&&(e[n]=0);return e}var c=n(1201),f=n(1204),d=[].slice,p=["keyword","gray","hex"],h={};Object.keys(f).forEach(function(e){h[d.call(f[e].labels).sort().join("")]=e});var m={};r.prototype={toString:function(){return this.string()},toJSON:function(){return this[this.model]()},string:function(e){var t=this.model in c.to?this:this.rgb();t=t.round("number"==typeof e?e:1);var n=1===t.valpha?t.color:t.color.concat(this.valpha);return c.to[t.model](n)},percentString:function(e){var t=this.rgb().round("number"==typeof e?e:1),n=1===t.valpha?t.color:t.color.concat(this.valpha);return c.to.rgb.percent(n)},array:function(){return 1===this.valpha?this.color.slice():this.color.concat(this.valpha)},object:function(){for(var e={},t=f[this.model].channels,n=f[this.model].labels,r=0;r<t;r++)e[n[r]]=this.color[r];return 1!==this.valpha&&(e.alpha=this.valpha),e},unitArray:function(){var e=this.rgb().color;return e[0]/=255,e[1]/=255,e[2]/=255,1!==this.valpha&&e.push(this.valpha),e},unitObject:function(){var e=this.rgb().object();return e.r/=255,e.g/=255,e.b/=255,1!==this.valpha&&(e.alpha=this.valpha),e},round:function(e){return e=Math.max(e||0,0),new r(this.color.map(i(e)).concat(this.valpha),this.model)},alpha:function(e){return arguments.length?new r(this.color.concat(Math.max(0,Math.min(1,e))),this.model):this.valpha},red:a("rgb",0,s(255)),green:a("rgb",1,s(255)),blue:a("rgb",2,s(255)),hue:a(["hsl","hsv","hsl","hwb","hcg"],0,function(e){return(e%360+360)%360}),saturationl:a("hsl",1,s(100)),lightness:a("hsl",2,s(100)),saturationv:a("hsv",1,s(100)),value:a("hsv",2,s(100)),chroma:a("hcg",1,s(100)),gray:a("hcg",2,s(100)),white:a("hwb",1,s(100)),wblack:a("hwb",2,s(100)),cyan:a("cmyk",0,s(100)),magenta:a("cmyk",1,s(100)),yellow:a("cmyk",2,s(100)),black:a("cmyk",3,s(100)),x:a("xyz",0,s(100)),y:a("xyz",1,s(100)),z:a("xyz",2,s(100)),l:a("lab",0,s(100)),a:a("lab",1),b:a("lab",2),keyword:function(e){return arguments.length?new r(e):f[this.model].keyword(this.color)},hex:function(e){return arguments.length?new r(e):c.to.hex(this.rgb().round().color)},rgbNumber:function(){var e=this.rgb().color;return(255&e[0])<<16|(255&e[1])<<8|255&e[2]},luminosity:function(){for(var e=this.rgb().color,t=[],n=0;n<e.length;n++){var r=e[n]/255;t[n]=r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4)}return.2126*t[0]+.7152*t[1]+.0722*t[2]},contrast:function(e){var t=this.luminosity(),n=e.luminosity();return t>n?(t+.05)/(n+.05):(n+.05)/(t+.05)},level:function(e){var t=this.contrast(e);return t>=7.1?"AAA":t>=4.5?"AA":""},dark:function(){var e=this.rgb().color;return(299*e[0]+587*e[1]+114*e[2])/1e3<128},light:function(){return!this.dark()},negate:function(){for(var e=this.rgb(),t=0;t<3;t++)e.color[t]=255-e.color[t];return e},lighten:function(e){var t=this.hsl();return t.color[2]+=t.color[2]*e,t},darken:function(e){var t=this.hsl();return t.color[2]-=t.color[2]*e,t},saturate:function(e){var t=this.hsl();return t.color[1]+=t.color[1]*e,t},desaturate:function(e){var t=this.hsl();return t.color[1]-=t.color[1]*e,t},whiten:function(e){var t=this.hwb();return t.color[1]+=t.color[1]*e,t},blacken:function(e){var t=this.hwb();return t.color[2]+=t.color[2]*e,t},grayscale:function(){var e=this.rgb().color,t=.3*e[0]+.59*e[1]+.11*e[2];return r.rgb(t,t,t)},fade:function(e){return this.alpha(this.valpha-this.valpha*e)},opaquer:function(e){return this.alpha(this.valpha+this.valpha*e)},rotate:function(e){var t=this.hsl(),n=t.color[0];return n=(n+e)%360,n=n<0?360+n:n,t.color[0]=n,t},mix:function(e,t){var n=this.rgb(),o=e.rgb(),i=void 0===t?.5:t,a=2*i-1,s=n.alpha()-o.alpha(),l=((a*s==-1?a:(a+s)/(1+a*s))+1)/2,u=1-l;return r.rgb(l*n.red()+u*o.red(),l*n.green()+u*o.green(),l*n.blue()+u*o.blue(),n.alpha()*i+o.alpha()*(1-i))}},Object.keys(f).forEach(function(e){if(-1===p.indexOf(e)){var t=f[e].channels;r.prototype[e]=function(){if(this.model===e)return new r(this);if(arguments.length)return new r(arguments,e);var n="number"==typeof arguments[t]?t:this.valpha;return new r(l(f[this.model][e].raw(this.color)).concat(n),e)},r[e]=function(n){return"number"==typeof n&&(n=u(d.call(arguments),t)),new r(n,e)}}}),e.exports=r},function(e,t,n){(function(r,o){function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),f=n(0),d=i(f),p=n(721),h=i(p),m=n(5),g=i(m),_=n(1207),v=i(_),y=n(834),b=n(909),w=n(146),C=i(w),S=n(9),x=i(S),T=n(54),E=n(1208),M=i(E),A=n(1044),k=function(e){function t(e){a(this,t);var n=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={open:!1,showDialog:!1,resultIndex:0,resultNumber:0,isReadonly:n.props.isReadonly},n.callSearch=n._callSearch.bind(n),n.close=n._close.bind(n),n.afterSheetSwitch=n._afterSheetSwitch.bind(n),n.enter=n._enter.bind(n),n.exit=n._exit.bind(n),n.afterSheetInited=n._afterSheetInited.bind(n),n.callDialog=n._callDialog.bind(n),n.doReplaceAll=n._doReplaceAll.bind(n),n.doReplace=n._doReplace.bind(n),n.resultDown=n._resultDown.bind(n),n}return l(t,e),c(t,null,[{key:"propTypes",get:function(){return{afterCellReplaced:f.PropTypes.func,onScroll:f.PropTypes.func,userCS:f.PropTypes.any,applyCS:f.PropTypes.any,isReadonly:f.PropTypes.bool}}}]),c(t,[{key:"componentDidMount",value:function(){this._enter(),x.default.attach("search:show",this.callSearch),x.default.attach("search:close",this.close),x.default.attach("sheet:switched",this.afterSheetSwitch),x.default.attach("spreadsheet:enter",this.enter),x.default.attach("spreadsheet:exit",this.exit),x.default.attach("spread:inited",this.afterSheetInited)}},{key:"componentWillReceiveProps",value:function(e){this._needReRender(e)&&this._updateAfterSheetChange()}},{key:"componentWillUnmount",value:function(){this._exit(),x.default.detach("search:show",this.callSearch),x.default.detach("search:close",this.close),x.default.detach("sheet:switched",this.afterSheetSwitch),x.default.detach("spreadsheet:enter",this.enter),x.default.detach("spreadsheet:exit",this.exit),x.default.detach("spread:inited",this.afterSheetInited)}},{key:"_afterSheetInited",value:function(e){this.spread=e}},{key:"_afterSheetSwitch",value:function(){this.sheet=this.spread.getActiveSheet(),this._updateHightLight()}},{key:"_needReRender",value:function(e){var t=this.props,n=t.userCS!==e.userCS&&e.userCS.ops.length||e.applyCS&&t.applyCS!==e.applyCS&&e.applyCS.ops.length;return this.state.open&&n}},{key:"_enter",value:function(){v.default.bind("ctrl+f",this._callSearch.bind(this))}},{key:"_exit",value:function(){v.default.unbind("ctrl+f"),this._close()}},{key:"_callSearch",value:function(){var e=this;setTimeout(function(){e._focusInput(),e._selectInput()},0),this._show(),x.default.notify("search:showed")}},{key:"_callDialog",value:function(){var e=this;setTimeout(function(){e._focusInput(),e._selectInputEnd()},0),this.setState({showDialog:!0})}},{key:"_onDragStart",value:function(e){var t=r(e.target);if(t.hasClass("replace-dialog-body")||t.parents(".replace-dialog-body").length||t.hasClass("replace-dialog-footer")||t.parents(".replace-dialog-footer").length)return!1}},{key:"_doReplaceAll",value:function(){var e=this.refs.replace,t=e.value,n=this._getInput().val(),r=this._searchValueMatch(n,!0),o="确定要将此工作表中"+r.length+"处“"+n+"”全部替换为“"+t+"”吗？";(0,C.default)({title:"全部替换",description:o,confirmFun:this._doReplace.bind(this,"all")})}},{key:"_doReplace",value:function(e){var t=this,n=this.refs.replace,r=n.value,i=this._getInput().val(),a=this.state.resultIndex-1,s=this.props.afterCellReplaced,l=[],u=this._searchValueMatch(i,!0),c=void 0;if(!u.length||!u[a])return void this._showNotMatch();"all"!==e&&(u=[u[a]]),o.forEach(u,function(e){var n=t._replaceStr(e,i,r);void 0!==n&&l.push(e.concat([{value:n,attrs:{}}]))}),l.length>0?(c="已将此工作表中"+l.length+"处“"+i+"”替换为“"+r+"”",s&&s(l)):c="没有找到可以替换的匹配项（公式或已锁定单元格无法替换）","all"!==e&&r.indexOf(i)>-1?this._resultDown():this._updateHightLight(this.state.resultIndex),this._updateResultInfo(c)}},{key:"_updateResultInfo",value:function(e){this.state.showDialog&&this.setState({resultInfo:e})}},{key:"_replaceStr",value:function(e,t,n){var r=u(e,2),o=r[0],i=r[1],a=this.spread.getActiveSheet(),s=a.getText(o,i),l=s.replace(new RegExp(t,"g"),n);if(!a.getFormula(o,i)&&!(0,A.isUserLockedInCellRange)(a,[(0,y.cell2Range)(o,i)]))return a.setText(o,i,l),l}},{key:"_show",value:function(){this.state.open||(this.setState({open:!0}),this._reset())}},{key:"_close",value:function(){this.setState({open:!1,showDialog:!1,resultInfo:"",resultNumber:0}),this._reset(),x.default.notify("search:closed")}},{key:"_reset",value:function(){this._getInput().val("")}},{key:"_resultUp",value:function(){this._changeResult(-1)}},{key:"_resultDown",value:function(){this._changeResult(1)}},{key:"_changeResult",value:function(e){var t=this.state.resultNumber,n=this.state.resultIndex+e;1!==t&&(t?(this._focusInput(),this._selectInput(),n>t?n=1:n<1&&(n=t),this._changeActiveCell(n),this.setState({resultIndex:n}),this._updateResultInfo("")):(this._focusInput(),this._showNotMatch()))}},{key:"_changeActiveCell",value:function(e){this._updateHightLight(e)}},{key:"_updateHightLight",value:function(e,t,n){if(this.spread){var r=this._getInput().val(),o=this.props.onScroll,i=!1;"number"!=typeof e&&(e="",i=!0);var a=this._searchValueMatch(r,t),s=Math.min(a.keepIndex||e||(a.length?1:0),a.length),l=a[s-1],c=this.spread.getActiveSheet();if(l){var f=u(l,2),d=f[0],p=f[1];c.setActiveCell(d,p),n||(0,y.isCellVisible)(c,d,p)||(c.showCell(d,p),o&&o())}this.setState({resultNumber:a.length,resultIndex:s}),i&&(a.length?this._updateResultInfo(""):this._showNotMatch())}}},{key:"_showNotMatch",value:function(){this._updateResultInfo("此工作表中没有所要查找的内容")}},{key:"_searchValueMatch",value:function(e,t){return this._findInSheet(e)}},{key:"_findInSheet",value:function(e){for(var t=this.spread.getActiveSheet(),n=[],r=t.getRowCount(),o=t.getColumnCount(),i=r-1,a=o-1,s=0,l=0,u=this._findInSelection(e,{row:s,col:l,rowCount:r,colCount:o}),c=u,f=c.foundRowIndex,d=c.foundColumnIndex;-1!==f&&-1!==d;)n.push([f,d,(0,b.getCell)(t,f,d)]),s=f,l=d+1,l>=a&&s<i&&(s=f+1,l=0),u=this._findInSelection(e,{row:s,col:l,rowCount:r,colCount:o}),f=u.foundRowIndex,d=u.foundColumnIndex;return n}},{key:"_findInSelection",value:function(e,t){var n=t.row,r=t.col,o=t.rowCount,i=t.colCount,a=this.spread,s=h.default.Spread.Sheets.Search,l=new s.SearchCondition,u=a.getActiveSheetIndex();return l.searchString=e,l.startSheetIndex=u,l.endSheetIndex=u,l.searchOrder=s.SearchOrder.zOrder,l.searchTarget=s.SearchFoundFlags.cellText,l.searchFlags=s.SearchFlags.ignoreCase|s.SearchFlags.useWildCards,l.rowStart=n,l.columnStart=r,l.rowEnd=n+o-1,l.columnEnd=r+i-1,a.search(l)}},{key:"_focusInput",value:function(){this.spread.focus(!1),this._getInput().focus()}},{key:"_selectInput",value:function(){this._getInput().select()}},{key:"_getInput",value:function(){return r(this.refs.findbar).find(".findbar-input")}},{key:"_selectInputEnd",value:function(){var e=this._getInput()[0],t=e.value.length;e.setSelectionRange(t,t)}},{key:"_updateAfterSheetChange",value:function(){this._updateHightLight(this.state.resultIndex,!0,!0)}},{key:"_getDialog",value:function(e){var t=this.state,n="";return t.resultNumber<1&&(n="disable"),d.default.createElement(T.Draggable,{onStart:this._onDragStart},d.default.createElement("div",{className:"replace-dialog dialog",ref:"findbar"},d.default.createElement("div",{className:"replace-dialog-header"},d.default.createElement("span",{className:"replace-dialog-header-text"},"查找和替换"),d.default.createElement("span",{className:"replace-dialog-close hicon icon-close",onClick:this.close})),d.default.createElement("div",{className:"replace-dialog-body"},d.default.createElement("div",{className:"replace-body-item"},d.default.createElement("span",{className:"replace-body-item-text"},"查找"),d.default.createElement(M.default,e)),d.default.createElement("div",{className:"replace-body-item"},d.default.createElement("span",{className:"replace-body-item-text"},"替换为"),d.default.createElement("input",{className:"replace-body-item-input",ref:"replace"})),d.default.createElement("div",{className:"replace-dialog-result"},t.resultInfo||"")),d.default.createElement("div",{className:"replace-dialog-footer "+n},d.default.createElement("span",{className:"btn replace-dialog-search",onClick:this.resultDown},"查找"),d.default.createElement("span",{className:"btn replace-dialog-replace",onClick:this.doReplace},"替换"),d.default.createElement("span",{className:"btn replace-dialog-replace-all",onClick:this.doReplaceAll},"全部替换"))))}},{key:"render",value:function(){var e="",t=this.props,n=t.userCS,i=t.applyCS,a=this.state,s=a.open,l=a.showDialog,u=a.isReadonly,c=this.spread,f=c&&(0,A.isUserLockedInSheet)(c.getActiveSheet());if(this.focusAndSelect=!1,g.default.isMobile())return null;s&&(e=" active");var p={updateHightLight:this._updateHightLight.bind(this),resultDown:this._resultDown.bind(this),resultUp:this._resultUp.bind(this),getInput:this._getInput.bind(this),userCS:n,applyCS:i};return p=o.extend(p,this.state),l?(p.defaultVal=r(".findbar-input").val()||"",this._getDialog(p)):d.default.createElement("div",{className:"findbar-container"+e,ref:"findbar"},d.default.createElement("span",{className:"findbar-input-text"},"查找"),d.default.createElement(M.default,p),!u&&!f&&d.default.createElement("span",{className:"findbar-handler findbar-handler-icon",onClick:this.callDialog}),d.default.createElement("span",{className:"findbar-close hicon icon-close",onClick:this.close}))}}]),t}(f.Component);t.default=k,e.exports=t.default}).call(t,n(2),n(1))},function(e,t,n){(function(e,r){function o(e){return e&&e.__esModule?e:{default:e}}function i(t){var n=t.floatingObjects,r=n.all();e.forEach(r,function(e){var t=e._ps.name;t.match(/^collab-\w{16}/)&&n.remove(t)}),E={}}function a(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props,n=this.sheet,r=t.collaborators.collaborators[window.cow.currentSheetId]||[],o=r.map(function(e){return e.data.userInfo.id});Object.keys(E).forEach(function(e){-1===o.indexOf(+e)&&_(n,e)}),e.forEach(r,function(t){var r=t.data,o=r.userInfo,i=r.range,a=o.id,s=E[a];s?e.isEqual(i,s.range)||(_(n,a),d(n,r)):d(n,r)})}function s(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props,n=this.sheet,r=t.collaborators.collaborators[window.cow.currentSheetId]||[];i(n),e.forEach(r,function(e){var t=e.data;d(n,t)})}function l(e,t,n){for(var r=t.row,o=t.col,i=n.collaborators.collaborators[window.cow.currentSheetId]||[],a=void 0,s=0,l=i.length;s<l;s++){var u=i[s].data,d=u.range||x;if(d.row===r&&d.col===o){a=u;break}}c(e),a&&f(e,a)}function u(e,t,n){var r=e.rows,o=e.cols,i=e.tableActions,a=e.cellsData;return r&&r.length||o&&o.length||t&&t.length||n&&n.length||i&&i.hasOwnProperty("filter")||g(a)}function c(e){var t=e.floatingObjects;t.get("collab-name")&&t.remove("collab-name")}function f(e,t){var n=t.range,r=t.userInfo,o=p(e,n),i=o.row,a=o.endRow,s=o.endCol,l=r.color,u=r.name,c=Math.min(h(u)+8,S),f=new C.FloatingObjects.FloatingObject("collab-name",0,0,c,18),d=document.createElement("div"),m=d.style,g=e.frozenRowCount(),_=e.frozenColumnCount(),v=i||a+1,y=s+1,b=_&&_===y,w=g&&g===v,x=(0===i?0:-17)+(w?e.getRowHeight(v):0),T=1-c+(b?e.getColumnWidth(y):0);v=w?v-1:v,y=b?y-1:y,f.dynamicSize(!1),f.allowMove(!1),f.allowResize(!1),m.background=l,d.innerText=u,d.className="collab-floating-object collab-floating-name",f.content(d),f.startRow(v),f.startRowOffset(x),f.startColumn(y),f.startColumnOffset(T),e.floatingObjects.add(f)}function d(t,n,r){var o=n.range,i=n.userInfo,a="collab-"+y.default.genGuid(),s=i.id,l=i.color,u=p(t,o,r),c=u.row,f=u.col,d=u.endRow,h=u.endCol,g=u.rangeWidth,_=u.rangeHeight;m(t,c)||(!r&&(E[s]={range:o,borders:[]}),e.forEach(T,function(e){var n=a+"-"+e,o=void 0,i=void 0;"top"===e||"bottom"===e?(o=g,i=2):(o=2,i=_+1);var u=new C.FloatingObjects.FloatingObject(n,0,0,o,i),p=document.createElement("div"),m=p.style;u.dynamicSize(!1),u.allowMove(!1),u.allowResize(!1),m.background=l,p.className="collab-floating-object collab-floating-border",u.content(p);var v=0,y=0,b=c,w=f;"right"===e?(w=h+1,y=-1):"bottom"===e&&(b=d+1,v=-1),t.floatingObjects.add(u),u.startRow(b),u.startColumn(w),u.startRowOffset(v),u.startColumnOffset(y),!r&&E[s].borders.push(n)}))}function p(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t||x,o=r.row,i=r.col,a=r.rowCount,s=r.colCount,l=o+(n?a-1:0),u=i+(n?s-1:0),c=0,f=0,d=e.getSpan(o,i);if(d){var p=d.rowCount,h=d.colCount;o=d.row,i=d.col,l=o+p-1,u=i+h-1}for(var m=o;m<=l;m++)c+=e.getRowHeight(m);for(var g=i;g<=u;g++)f+=e.getColumnWidth(g);return{row:o,col:i,endRow:l,endCol:u,rangeWidth:f,rangeHeight:c}}function h(e){return r("#font-container").text(e).css("font-size","9pt").width()}function m(e,t){return!1===e.filterRowsVisibleInfo.rowsVisibleInfo[t]}function g(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=!1,n=0,r=e.length;n<r;n++){var o=e[n][3];if(o.hasOwnProperty("rowspan")||o.hasOwnProperty("rowspan")){t=!0;break}}return t}function _(e,t){var n=E[t],r=e.floatingObjects;n&&n.borders.forEach(function(e){r.remove(e)}),delete E[t]}Object.defineProperty(t,"__esModule",{value:!0}),t.removeAllCollabs=i,t.updateCollab=a,t.renderCollab=s,t.renderCollabName=l,t.needReRenderCollabs=u,t.removeCollabName=c,t.addCollabName=f,t.addCollabBorders=d;var v=n(5),y=o(v),b=n(721),w=o(b),C=w.default.Spread.Sheets,S=130,x={row:0,col:0},T=["top","right","bottom","left"],E={}}).call(t,n(1),n(2))},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e){p=a.bind(e),h=s.bind(e),window.addEventListener("mousewheel",h),window.addEventListener("DOMMouseScroll",h),document.addEventListener("keydown",p)}function i(){window.removeEventListener("mousewheel",h),window.removeEventListener("DOMMouseScroll",h),document.removeEventListener("keydown",p)}function a(e){var t=e.which,n=e.altKey;[189,187].indexOf(t)>-1&&(n||e.ctrlKey||e.metaKey)&&e.preventDefault(),n&&189===t&&l(this,-1),n&&187===t&&l(this,1)}function s(e){if(e.altKey){e.preventDefault();l(this,(e.wheelDelta||-1*e.detail)>0?1:-1)}}function l(e,t){var n=e.props,r=n.zoom,o=n.changeSheetZoom,i=void 0===r?d:f.indexOf(100*r);if(!(0===i&&t<0||i===f.length-1&&t>0)){i+=t;var a=f[i]/100;c.default.alert({title:100*a+"%",type:"alert-middle",delay:1e3}),o(a)}}var u=n(5),c=r(u),f=[25,50,75,100,150,200],d=3,p=void 0,h=void 0;e.exports={bindZoomListener:o,unbindZoomListener:i}},function(e,t){function n(e){return{type:"SEND_SELECT_CELL",cords:e}}function r(e){return{type:"RECIEVE_ENTER_COLLABORATOR",collaborator:e}}function o(e){return{type:"RECIEVE_LEAVE_COLLABORATOR",collaborator:e}}function i(e){return{type:"RECEIVE_COLLABORATOR_SELECTED",collaborator:e}}function a(e){return{type:"RECEIVE_COLLABORATOR_UNSELECTED",collaborator:e}}function s(){return{type:"UPDATE_COLLAB_DONE"}}function l(){return{type:"RESET_COLLAB"}}e.exports={sendSelectCell:n,recieveEnterCollaborator:r,recieveLeaveCollaborator:o,recieveCollaboratorSelected:i,recieveCollaboratorUnselected:a,updateCollabDone:s,resetCollab:l}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){function r(e,t,n){return Math.min(Math.max(t,e),n)}function o(e){var t=e.toString(16).toUpperCase();return t.length<2?"0"+t:t}var i=n(1069),a=n(1202),s={};for(var l in i)i.hasOwnProperty(l)&&(s[i[l]]=l);var u=e.exports={to:{}};u.get=function(e){var t,n,r=e.substring(0,3).toLowerCase();switch(r){case"hsl":t=u.get.hsl(e),n="hsl";break;case"hwb":t=u.get.hwb(e),n="hwb";break;default:t=u.get.rgb(e),n="rgb"}return t?{model:n,value:t}:null},u.get.rgb=function(e){if(!e)return null;var t,n,o,a=/^#([a-f0-9]{3,4})$/i,s=/^#([a-f0-9]{6})([a-f0-9]{2})?$/i,l=/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/,u=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/,c=/(\D+)/,f=[0,0,0,1];if(t=e.match(s)){for(o=t[2],t=t[1],n=0;n<3;n++){var d=2*n;f[n]=parseInt(t.slice(d,d+2),16)}o&&(f[3]=Math.round(parseInt(o,16)/255*100)/100)}else if(t=e.match(a)){for(t=t[1],o=t[3],n=0;n<3;n++)f[n]=parseInt(t[n]+t[n],16);o&&(f[3]=Math.round(parseInt(o+o,16)/255*100)/100)}else if(t=e.match(l)){for(n=0;n<3;n++)f[n]=parseInt(t[n+1],0);t[4]&&(f[3]=parseFloat(t[4]))}else{if(!(t=e.match(u)))return(t=e.match(c))?"transparent"===t[1]?[0,0,0,0]:(f=i[t[1]])?(f[3]=1,f):null:null;for(n=0;n<3;n++)f[n]=Math.round(2.55*parseFloat(t[n+1]));t[4]&&(f[3]=parseFloat(t[4]))}for(n=0;n<3;n++)f[n]=r(f[n],0,255);return f[3]=r(f[3],0,1),f},u.get.hsl=function(e){if(!e)return null;var t=/^hsla?\(\s*([+-]?\d*[\.]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/,n=e.match(t);if(n){var o=parseFloat(n[4]);return[(parseFloat(n[1])%360+360)%360,r(parseFloat(n[2]),0,100),r(parseFloat(n[3]),0,100),r(isNaN(o)?1:o,0,1)]}return null},u.get.hwb=function(e){if(!e)return null;var t=/^hwb\(\s*([+-]?\d*[\.]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/,n=e.match(t);if(n){var o=parseFloat(n[4]);return[(parseFloat(n[1])%360+360)%360,r(parseFloat(n[2]),0,100),r(parseFloat(n[3]),0,100),r(isNaN(o)?1:o,0,1)]}return null},u.to.hex=function(){var e=a(arguments);return"#"+o(e[0])+o(e[1])+o(e[2])+(e[3]<1?o(Math.round(255*e[3])):"")},u.to.rgb=function(){var e=a(arguments);return e.length<4||1===e[3]?"rgb("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+")":"rgba("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+", "+e[3]+")"},u.to.rgb.percent=function(){var e=a(arguments),t=Math.round(e[0]/255*100),n=Math.round(e[1]/255*100),r=Math.round(e[2]/255*100);return e.length<4||1===e[3]?"rgb("+t+"%, "+n+"%, "+r+"%)":"rgba("+t+"%, "+n+"%, "+r+"%, "+e[3]+")"},u.to.hsl=function(){var e=a(arguments);return e.length<4||1===e[3]?"hsl("+e[0]+", "+e[1]+"%, "+e[2]+"%)":"hsla("+e[0]+", "+e[1]+"%, "+e[2]+"%, "+e[3]+")"},u.to.hwb=function(){var e=a(arguments),t="";return e.length>=4&&1!==e[3]&&(t=", "+e[3]),"hwb("+e[0]+", "+e[1]+"%, "+e[2]+"%"+t+")"},u.to.keyword=function(e){return s[e.slice(0,3)]}},function(e,t,n){"use strict";var r=n(1203),o=Array.prototype.concat,i=Array.prototype.slice,a=e.exports=function(e){for(var t=[],n=0,a=e.length;n<a;n++){var s=e[n];r(s)?t=o.call(t,i.call(s)):t.push(s)}return t};a.wrap=function(e){return function(){return e(a(arguments))}}},function(e,t,n){"use strict";e.exports=function(e){return!(!e||"string"==typeof e)&&(e instanceof Array||Array.isArray(e)||e.length>=0&&(e.splice instanceof Function||Object.getOwnPropertyDescriptor(e,e.length-1)&&"String"!==e.constructor.name))}},function(e,t,n){function r(e){var t=function(t){return void 0===t||null===t?t:(arguments.length>1&&(t=Array.prototype.slice.call(arguments)),e(t))};return"conversion"in e&&(t.conversion=e.conversion),t}function o(e){var t=function(t){if(void 0===t||null===t)return t;arguments.length>1&&(t=Array.prototype.slice.call(arguments));var n=e(t);if("object"==typeof n)for(var r=n.length,o=0;o<r;o++)n[o]=Math.round(n[o]);return n};return"conversion"in e&&(t.conversion=e.conversion),t}var i=n(1070),a=n(1205),s={};Object.keys(i).forEach(function(e){s[e]={},Object.defineProperty(s[e],"channels",{value:i[e].channels}),Object.defineProperty(s[e],"labels",{value:i[e].labels});var t=a(e);Object.keys(t).forEach(function(n){var i=t[n];s[e][n]=o(i),s[e][n].raw=r(i)})}),e.exports=s},function(e,t,n){function r(){for(var e={},t=l.length,n=0;n<t;n++)e[l[n]]={distance:-1,parent:null};return e}function o(e){var t=r(),n=[e];for(t[e].distance=0;n.length;)for(var o=n.pop(),i=Object.keys(s[o]),a=i.length,l=0;l<a;l++){var u=i[l],c=t[u];-1===c.distance&&(c.distance=t[o].distance+1,c.parent=o,n.unshift(u))}return t}function i(e,t){return function(n){return t(e(n))}}function a(e,t){for(var n=[t[e].parent,e],r=s[t[e].parent][e],o=t[e].parent;t[o].parent;)n.unshift(t[o].parent),r=i(s[t[o].parent][o],r),o=t[o].parent;return r.conversion=n,r}var s=n(1070),l=Object.keys(s);e.exports=function(e){for(var t=o(e),n={},r=Object.keys(t),i=r.length,s=0;s<i;s++){var l=r[s];null!==t[l].parent&&(n[l]=a(l,t))}return n}},function(e,t){function n(e,t,n){this.value=e,this.type=t,this.subtype=n}function r(){this.items=[],this.index=-1,this.add=function(e,t,r){r||(r="");var o=new n(e,t,r);return this.addRef(o),o},this.addRef=function(e,t){void 0===t?this.items.push(e):this.items.splice(t,0,e)},this.insert=function(e,t,r,o){r||(r="");var i=new n(e,t,r);return this.addRef(i,o),i},this.replace=function(e,t,r,o){r||(r="");var i=new n(e,t,r);this.items[o]=i},this.reset=function(){this.index=-1},this.BOF=function(){return this.index<=0},this.EOF=function(){return this.index>=this.items.length-1},this.moveNext=function(){return!this.EOF()&&(this.index+=1,!0)},this.current=function(){return-1===this.index?null:this.items[this.index]},this.next=function(){return this.EOF()?null:this.items[this.index+1]},this.previous=function(){return this.index<1?null:this.items[this.index-1]}}function o(){this.items=[],this.push=function(e){this.items.push(e)},this.pop=function(e){var t=this.items.pop();return new n(e||"",t&&t.type||"",v)},this.token=function(){return this.items.length>0?this.items[this.items.length-1]:null},this.value=function(){return this.token()?this.token().value.toString():""},this.type=function(){return this.token()?this.token().type.toString():""},this.subtype=function(){return this.token()?this.token().subtype.toString():""}}function i(e){for(var t=new r,n=new o,i=0,a=function(){return e.substr(i,1)},k=function(){return e.substr(i,2)},R=function(){return e.substr(i+1,1)},I=function(){return i>=e.length},O="",D=!1,P=!1,N=!1,F=!1,L=/^[1-9]{1}(\.[0-9]+)?E{1}$/;e.length>0;){if(" "!==e.substr(0,1)){"="===e.substr(0,1)&&(e=e.substr(1));break}e=e.substr(1)}for(;!I();)if(D)'"'===a()?(O+='"','"'===R()?i+=1:(D=!1,t.add(O,l,y),O="")):O+=a(),i+=1;else if(P)"'"===a()?"'"===R()?(O+="'",i+=1):(P=!1,O+="'"):O+=a(),i+=1;else if(N)"]"===a()&&(N=!1),O+=a(),i+=1;else if(F)O+=a(),i+=1,-1!==",#NULL!,#DIV/0!,#VALUE!,#REF!,#NAME?,#NUM!,#N/A,".indexOf(","+O+",")&&(F=!1,t.add(O,l,C),O="");else if(-1!=="+-".indexOf(a())&&O.length>1&&O.match(L))O+=a(),i+=1;else if('"'!==a())if("'"!==a())if("["!==a())if("#"!==a())if("{"!==a())if(";"!==a())if("}"!==a())if(" "!==a())-1===",>=,<=,<>,".indexOf(","+k()+",")?-1==="+-*/^&=><".indexOf(a())?-1==="%".indexOf(a())?"("!==a()?","!==a()||A?")"!==a()?(O+=a(),i+=1):(O.length>0&&(t.add(O,l),O=""),t.add(a(),l,y),t.addRef(n.pop()),i+=1):(O.length>0&&(t.add(O,l),O=""),n.type()!==u?t.add(a(),p,M):t.add(a(),f),i+=1):(O.length>0?(n.push(t.add(O,u,_)),t.add(a(),l,y),O=""):(n.push(t.add("",c,_)),t.add(a(),l,y)),i+=1):(O.length>0&&(t.add(O,l),O=""),t.add(a(),h),i+=1):(O.length>0&&(t.add(O,l),O=""),t.add(a(),p),i+=1):(O.length>0&&(t.add(O,l),O=""),t.add(k(),p,w),i+=2);else for(O.length>0&&(t.add(O,l),O=""),t.add("",m),i+=1;" "===a()&&!I();)i+=1;else O.length>0&&(t.add(O,l),O=""),t.addRef(n.pop("ARRAYROWSTOP")),t.addRef(n.pop("ARRAYSTOP")),i+=1;else{if(A){O.length>0&&(t.add(O,l),O=""),n.type()!==u?t.add(a(),p,M):t.add(a(),f),i+=1;continue}O.length>0&&(t.add(O,l),O=""),t.addRef(n.pop()),t.add(",",f),n.push(t.add("ARRAYROW",u,_)),i+=1}else O.length>0&&(t.add(O,g),O=""),n.push(t.add("ARRAY",u,_)),n.push(t.add("ARRAYROW",u,_)),i+=1;else O.length>0&&(t.add(O,g),O=""),F=!0,O+=a(),i+=1;else N=!0,O+=a(),i+=1;else O.length>0&&(t.add(O,g),O=""),O="'",P=!0,i+=1;else O.length>0&&(t.add(O,g),O=""),O='"',D=!0,i+=1;O.length>0&&t.add(O,l);for(var H=new r;t.moveNext();)if(O=t.current(),O.type.toString()!==m)H.addRef(O);else{var V=t.BOF()||t.EOF();V=V&&t.previous()&&(t.previous().type.toString()===u&&t.previous().subtype.toString()===v||t.previous().type.toString()===c&&t.previous().subtype.toString()===v||t.previous().type.toString()===l),(V=V&&t.next()&&(t.next().type.toString()===u&&t.next().subtype.toString()===_||t.next().type.toString()===c&&t.next().subtype.toString()===_||t.next().type.toString()===l))&&H.add(O.value.toString(),p,E)}for(;H.moveNext();)O=H.current(),O.type.toString()!==p||"-"!==O.value.toString()?O.type.toString()!==p||"+"!==O.value.toString()?O.type.toString()!==p||0!==O.subtype.length?O.type.toString()!==l||0!==O.subtype.length?O.type.toString()!==u||"@"===O.value.substr(0,1)&&(O.value=O.value.substr(1).toString()):isNaN(parseFloat(O.value))?"TRUE"===O.value.toString()||"FALSE"===O.value.toString()?O.subtype=w.toString():O.subtype=S.toString():O.subtype=b.toString():-1!=="<>=".indexOf(O.value.substr(0,1))?O.subtype=w.toString():"&"===O.value.toString()?O.subtype=T.toString():O.subtype=x.toString():H.BOF()?O.type=s.toString():H.previous().type.toString()===u&&H.previous().subtype.toString()===v||H.previous().type.toString()===c&&H.previous().subtype.toString()===v||H.previous().type.toString()===h||H.previous().type.toString()===l?O.subtype=x.toString():O.type=s.toString():H.BOF()?O.type=d.toString():H.previous().type.toString()===u&&H.previous().subtype.toString()===v||H.previous().type.toString()===c&&H.previous().subtype.toString()===v||H.previous().type.toString()===h||H.previous().type.toString()===l?O.subtype=x.toString():O.type=d.toString();for(H.reset(),t=new r;H.moveNext();)H.current().type.toString()!==s&&t.addRef(H.current());return t.reset(),t}var a={},s=a.TOK_TYPE_NOOP="noop",l=a.TOK_TYPE_OPERAND="operand",u=a.TOK_TYPE_FUNCTION="function",c=a.TOK_TYPE_SUBEXPR="subexpression",f=a.TOK_TYPE_ARGUMENT="argument",d=a.TOK_TYPE_OP_PRE="operator-prefix",p=a.TOK_TYPE_OP_IN="operator-infix",h=a.TOK_TYPE_OP_POST="operator-postfix",m=a.TOK_TYPE_WSPACE="white-space",g=a.TOK_TYPE_UNKNOWN="unknown",_=a.TOK_SUBTYPE_START="start",v=a.TOK_SUBTYPE_STOP="stop",y=a.TOK_SUBTYPE_TEXT="text",b=a.TOK_SUBTYPE_NUMBER="number",w=a.TOK_SUBTYPE_LOGICAL="logical",C=a.TOK_SUBTYPE_ERROR="error",S=a.TOK_SUBTYPE_RANGE="range",x=a.TOK_SUBTYPE_MATH="math",T=a.TOK_SUBTYPE_CONCAT="concatenate",E=a.TOK_SUBTYPE_INTERSECT="intersect",M=a.TOK_SUBTYPE_UNION="union",A=!1;e.exports={getTokens:i}},function(e,t,n){function r(e,t){e=e.replace("ctrl",s),i.bind(e,function(){return t(),!1})}function o(e){e=e.replace("ctrl",s),i.unbind(e)}var i=n(840),a=n(5),s=a.isMac()?"command":"ctrl";i.prototype.stopCallback=function(){return!1},e.exports={bind:r,unbind:o}},function(e,t,n){var r=n(0),o=n(9);e.exports=r.createClass({displayName:"exports",_onKeyDown:function(e){var t=this.props;t.open&&13===e.keyCode&&t.resultDown()},_onChange:function(){var e=this,t=this.props.getInput().val(),n=t.length?200:0;clearTimeout(this.editTimeout),this.editTimeout=setTimeout(function(){e.props.updateHightLight()},n)},_onFocus:function(){o.notify("tableAction:unlisten")},_onBlur:function(){o.notify("tableAction:listen")},_needArrow:function(e){var t=this.refs["findbar-input"];return t&&t.value||!t&&e},render:function(){var e,t="",n=this.props,o=n.className||"";return n.resultNumber<2&&(t="disable"),this._needArrow(n.defaultVal)&&(e=r.createElement("div",{className:"findbar-arrow"},r.createElement("span",{className:"findbar-arrow-item findbar-arrow-down "+t,onClick:n.resultUp}),r.createElement("span",{className:"findbar-result"},n.resultIndex+"/"+n.resultNumber),r.createElement("span",{className:"findbar-arrow-item findbar-arrow-up "+t,onClick:n.resultDown}))),r.createElement("div",{className:"findbar-input-box"},r.createElement("input",{className:"findbar-input "+o,ref:"findbar-input",defaultValue:n.defaultVal||"",placeholder:"在表格内查找",onKeyDown:this._onKeyDown,onChange:this._onChange,onFocus:this._onFocus,onBlur:this._onBlur}),e)}})},function(e,t,n){(function(r,o){function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),p=n(0),h=a(p),m=n(13),g=a(m),_=n(53),v=a(_),y=n(721),b=a(y),w=n(1003),C=i(w),S=n(1057),x=i(S),T=n(834),E=n(253),M=i(E),A=n(1058),k=n(5),R=a(k),I=n(534),O=a(I),D=n(1002),P=a(D),N=n(9),F=a(N),L=n(1155),H=a(L),V=n(1210),j=n(20),B=a(j),U=n(533),W=n(1157),z=n(910),Y=a(z),G=b.default.Spread.Sheets,K=G.Events,X=R.default.isMobile(),q=22,J=100,Z={},Q=function(e){function t(e){s(this,t);var n=l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.spread=null,n.sheet=null,n.isHistory="history"===e.readonlyType,n.renderSheet=(0,T.paintWrap)(n._renderSheet,!0).bind(n),n.switchSheet=(0,T.paintWrap)(n._switchSheet).bind(n),n.applyCsAction=(0,T.paintWrap)(n._applyCsAction,!0).bind(n),n.applyLockIcons=(0,T.paintWrap)(n._applyLockIcons,!0).bind(n),n.onMouseOver=n._onMouseOver.bind(n),n.showOrHideHighLight=V.showOrHideHighLight.bind(n),n.toggleHighlight=V.toggleHighlight.bind(n),n.collectHighLightCells=V.collectHighLightCells.bind(n),n.collectColorCells=V.collectColorCells.bind(n),n.showHistorySetp=n._showHistorySetp.bind(n),n.scrollToHistory=n._scrollToHistory.bind(n),n.clearCurHistory=V.clearCurHistory.bind(n),n.changeSheetZoom=n._changeSheetZoom.bind(n),n.csStoreInst=Y.default.getInst({guid:e.guid}),n}return u(t,e),d(t,null,[{key:"propTypes",get:function(){return{guid:p.PropTypes.string,msg:p.PropTypes.object,spreadsheet:p.PropTypes.object,readonlyType:p.PropTypes.string,sheetId:p.PropTypes.any,history:p.PropTypes.object,highLight:p.PropTypes.bool}}}]),d(t,[{key:"componentDidMount",value:function(){this._initSpread(),F.default.attach("mobileSheet:switched",this.switchSheet),r(document).on("mousemove",this.onMouseOver);var e=this.props.history;this.isHistory?this.scrollToHistory(e):(0,W.bindZoomListener)(this)}},{key:"componentWillReceiveProps",value:function(e){var t=this,n=this.props,r=e.msg,o=e.historyStep,i=e.history,a=e.zoom;this.isHistory&&(n.highLight!==e.highLight&&this.toggleHighlight(e.highLight),n.historyStep!==o&&this.showHistorySetp(o),n.history!==i&&setTimeout(function(){t.scrollToHistory(i)})),this.changeSheetZoom(a),r&&!this.isHistory&&r.applyCS&&r.applyCS.length>0&&r.applyCS!==n.msg.applyCS&&this._applyChangeset(r.applyCS,r.fromPush)}},{key:"shouldComponentUpdate",value:function(e){return this.props.spreadsheet!==e.spreadsheet}},{key:"componentDidUpdate",value:function(){this._initSpread()}},{key:"componentWillUnmount",value:function(){F.default.detach("mobileSheet:switched",this.switchSheet),r(document).off("mousemove",this.onMouseOver),this.isHistory||(0,W.unbindZoomListener)(),Y.default.destory(this.props.guid)}},{key:"_changeSheetZoom",value:function(e){(0,T.setSheetsZoom)(this.spread,e)}},{key:"_scrollToHistory",value:function(e){var t=v.default.unpack(JSON.parse(e.content).changeset);(0,T.scrollToCellByCS)(t,this.sheet)}},{key:"_showHistorySetp",value:function(e){var t=this,n=this.props.highLight,r=v.default.unpack(e.curStep.delta);this.toggleHighlight(),this._applyHistoryStep(e.cs,r),this.historyCs.ops.forEach(function(n,r){var o=t._processData(n);(0,V.collectColorCells)(r,o,e.curStep)}),(0,T.scrollToCellByCS)(r,this.sheet),V.highlightHistoryStep.call(this,e.curStep,n)}},{key:"_applyChangeset",value:function(e,t){if(e&&e.length){M.isSheetChangeByOps(e)&&this._applySheetChangeCs(e);var n=M.findTableOpInApplyCsById(e,window.cow.currentSheetId);n&&this.applyCsAction(n,t)}}},{key:"_applyHistoryStep",value:function(e,t){var n=this;if(e&&e.length){this.historyCs=this.historyCs.compose(e),M.isSheetChangeByOps(e)&&this._applySheetChangeCs(e);var r=(0,T.getSheetIndexById)(M.getFirstModifiedSheetIdByCs(t),this.spread),o=0;e.ops.forEach(function(e){var t=e.action,r=e.data;if("retain"===t){var i=n.spread.getSheet(o);n.applyCsAction(e,!0,i),o+="object"===(void 0===r?"undefined":f(r))?1:r}else"insert"===t&&(o+=1)}),this.spread.setActiveSheetIndex(r),this.sheet=this.spread.getSheet(r),this.applyLockIcons(e)}}},{key:"_applyCsAction",value:function(e,t,n){var r=n||this.sheet,o=P.default.changeset2Actions(e),i=o.tableActions,a=o.rows,s=o.rowsAttr,l=o.cols,u=o.colsAttr,c=o.cellsData,f=(0,A.data2Attr)(s,"height",q),d=(0,A.data2Attr)(u,"width",J),p=(0,A.data2Attr)(s,"autoFit",q);x.applyTableAttrs(r,i),x.alterRows(r,a),x.alterCols(r,l),x.applyRowColAttrs(r,f,d),C.setBulkCells(r,c),t&&x.applyAutoFitRows(r,p),this.isHistory&&x.applyLocks(r,o.tableActions,!1,t,!0),x.applyFilter(r,i)}},{key:"_applySheetChangeCs",value:function(e){var t=this.spread,n=P.default.changeset2SheetChangeAction(e);if((0,T.paintWrap)(x.applySheetChangesActions).bind(this)(t,n),!this.isHistory){this._setSortCs(null,!0);var r=t.getActiveSheet().guid();r!==window.cow.currentSheetId&&(O.default.setCurrentSheetId(r),this._switchSheet())}}},{key:"_applyLockIcons",value:function(e){var t=this;P.default.changeset2LockActions(e).forEach(function(e){var n=c(e,2),r=n[0],o=n[1],i=t.spread.getSheet(r);i&&x.applyLockIcon(i,o)})}},{key:"_initSpread",value:function(){var e=this.props,t=e.history,n=g.default.findDOMNode(this.refs.hView);this.spread&&this.spread.destroy();var r=this.spread=new G.Workbook(n),o=new v.default.Delta(M.sortOps(e.spreadsheet.ops));this._setSortCs(o),this._initSpreadOptions(),this._initEvents(),this._initMultiSheet(),this.isHistory&&(this.historyCs=o,this.collectHighLightCells(t),this.clearCurHistory(),e.highLight&&this.showOrHideHighLight(t,!0)),setTimeout(function(){return r.refresh()},0),F.default.notify("spread:inited",r)}},{key:"_initSpreadOptions",value:function(){var e=this,t=this.spread.options;t.allowSheetReorder=!1,t.newTabVisible=!1,t.tabEditable=!1,t.scrollbarMaxAlign=!0,t.lockImage=new Image,t.lockImage.src=U.LOCK_IMG_BASE64,t.lockImage.onload=function(){t.lockImage.onload=null,o.forEach(e.spread.sheets,function(e){e.options.isLockedByUser&&(0,T.repaintLockStyle)(e)})}.bind(this),t.lockCellBg=new Image,t.lockCellBg.src=U.LOCK_CELL_BG_BASE64,X&&(t.showHorizontalScrollbar=!1,t.tabStripVisible=!1),this.isHistory&&(t.rightPadding=300)}},{key:"_initEvents",value:function(){var e=this,t=K.ActiveSheetChanged;this.spread.bind(t,function(t,n){var r=n.oldSheet,o=n.newSheet;e.isHistory?e.sheet=o:e._afterActiveSheetChanged(r,o)}),this.refs.wrap.addEventListener("mousewheel",function(e){e.preventDefault()},!1)}},{key:"_initMultiSheet",value:function(){var e=this,t=this.spread,n=this.sortedCs.ops,r=this.isHistory?this.props.sheetId:window.cow.currentSheetId,o=0,i=null;t.removeSheet(0),n.forEach(function(t,n){var r=e.spread,o=t.getAttributes()||{},i=o.name||"工作表1",a=new G.Worksheet(i,o.id);r.addSheet(n,a)}),(0,T.paintWrap)(function(){if(n.forEach(function(t,n){(t.getAttributes()||{}).id===r?(o=n,i=t):e._initSingleSheet(t,n)}),i&&(e.sheet=e._initSingleSheet(i,o),!e.isHistory&&(window.sheet=e.sheet)),!e.sheet){if(e.sheet=t.getSheet(o),e.isHistory)return;window.sheet=e.sheet,O.default.setCurrentSheetId(e.sortedCs.ops[0].getAttributes().id)}t.setActiveSheetIndex(o)},!0,"spread").bind(this)()}},{key:"_initSingleSheet",value:function(e,t){var n=this.spread,r=e.data,o=r.rows,i=r.cols,a=this.props.history,s=n.getSheet(t);s.setRowCount(o.length),s.setColumnCount(i.length);var l=this._processData(e);return this._renderSheet(s,l),this.isHistory&&this.collectColorCells(t,l,a),s}},{key:"_onMouseOver",value:function(e){var t=e.pageX,n=e.pageY,r=this.props.highLight;if(this.isHistory&&r){var o=this.sheet,i=(0,T.getCellByOffset)(o,t,n,this.isHistory),a=i.row,s=i.col,l=this.hoverCell;l&&l.row===a&&l.col===s||this._afterHoveredCellChanged(i)}}},{key:"_afterHoveredCellChanged",value:function(e){this.hoverCell=e;var t=this.spread.getActiveSheetIndex();(0,V.renderUserName)(this.sheet,e,t)}},{key:"_setSortCs",value:function(e,t){e=e||this.csStoreInst.getCurDoc(),t&&this.sortedCs&&this._setNeedRenderSheet(e,this.sortedCs),this.sortedCs=e}},{key:"_setNeedRenderSheet",value:function(e,t){if(!this.isHistory){var n=t.ops;e.ops.forEach(function(e,t){var r=n[t];if(!o.isEqual(e,r)){var i=e.getAttributes().id||"0";Z[i]=!0}})}}},{key:"_resetSheet",value:function(){var e=this.csStoreInst.findTableOpIndexByCs(window.cow.currentSheetId,this.sortedCs),t=this.sortedCs.ops[e],n=this._processData(t);this._switchActiveSheetIndex(),this.sheet=window.sheet=this.spread.getActiveSheet();var r=this.sheet;if(!this.isHistory){var o=G.StorageType,i=o.style|o.data;r.clear(0,0,r.getRowCount(),r.getColumnCount(),G.SheetArea.viewport,i),x.removeAllConditionalFormat(r),Z[r.guid()||"0"]=!1}this.renderSheet(r,n)}},{key:"_renderSheet",value:function(e,t){var n=t.cellsData,r=t.tableActions,o=t.rowHeights,i=t.colWidths,a=t.autoFitRowHeights;this._protectSheet(e),this._setDefaultStyle(e),x.applyTableAttrs(e,r,this.props.highLight),x.applyRowColAttrs(e,o,i),C.setBulkCells(e,n),x.applyAutoFitRows(e,a),this.isHistory&&x.applyLocks(e,r,!1,null,!0),setTimeout(function(){return x.applyFilter(e,r)})}},{key:"_setDefaultStyle",value:function(e){var t=new G.Style;b.default.Spread.Common.CultureManager.culture("zh-cn"),t.textIndent="0.38",t.vAlign=G.VerticalAlign.center,t.font=U.DEFAULT_FONT,e.setDefaultStyle(t,G.SheetArea.viewport),e.options.frozenlineColor="#666666",e.options.allowCellOverflow=!0,e.setColumnWidth(0,50,G.SheetArea.rowHeader)}},{key:"_processData",value:function(e){var t=P.default.processTableOps(e),n=t.cellsData,r=t.tableActions,o=t.rows,i=t.cols;return{cellsData:n,tableActions:r,colWidths:(0,A.data2Attr)(i,"width","cols"),rowHeights:(0,A.data2Attr)(o,"height","rows"),autoFitRowHeights:(0,A.data2Attr)(o,"autoFit")}}},{key:"_protectSheet",value:function(e){e.options.isProtected=!0,X&&(e.options.addReadonlyForMobile=!0)}},{key:"_needRender",value:function(){var e=window.cow.currentSheetId||"0";return Z[e]}},{key:"_switchSheet",value:function(){this._setSortCs(null,!0),this._needRender()?this._resetSheet():X&&this._switchActiveSheetIndex(),F.default.notify("sheet:switched")}},{key:"_switchActiveSheetIndex",value:function(){var e=this.spread,t=this.csStoreInst.findTableOpIndexByCs(window.cow.currentSheetId,this.sortedCs);e.getActiveSheetIndex()!==t&&e.setActiveSheetIndex(t)}},{key:"_afterActiveSheetChanged",value:function(e,t){O.default.setCurrentSheetId(t.guid()),this._switchSheet()}},{key:"render",value:function(){var e=this.props.msg,t=e.userCS,n=e.applyCS,r=(0,B.default)({"h-view":!0,"history-h-view":this.isHistory});return h.default.createElement("div",{className:"h-view-wrap",ref:"wrap"},h.default.createElement("div",{ref:"hView",className:r}),h.default.createElement("div",{id:"font-container",style:{display:"none"}}),h.default.createElement(H.default,{isReadonly:!0,userCS:t,applyCS:n}))}}]),t}(p.Component);t.default=Q,e.exports=t.default}).call(t,n(2),n(1))},function(e,t,n){(function(e){function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function i(t,n,r){function o(e,t){if("路人"!==t)return t;var n=5;return e=Math.abs(e)+"","路人-"+e.substr(e.length-n,n)}var i=I,a=i.id,s=R.userRanges[a][r];if(b.removeCollabName(t),s&&n&&!e.isNil(n.row)&&!e.isNil(n.col)){var l=v.default.stringifyPosition(n.row,n.col),u=void 0,c=void 0;for(var f in s)if(-1!=+f){var d=s[f],p=!0,m=!1,g=void 0;try{for(var _,y=d[Symbol.iterator]();!(p=(_=y.next()).done);p=!0){var w=_.value;if(w&&w.cells[l]){var C=w.topCell,S=C.row,T=C.col;u={row:S,col:T,endRow:S,endCol:T},c=e.assign({},h(f)),c.name=o(f,c.name),c.color=x.default.getColor(f);break}}}catch(e){m=!0,g=e}finally{try{!p&&y.return&&y.return()}finally{if(m)throw g}}if(u)break}u&&b.addCollabName(t,{range:u,userInfo:c})}}function a(e){var t=R.highLight,n=R.userRanges,r=e.content,o=e.id,i=e.delta,a=i?v.default.unpack(i):"string"==typeof r?v.default.unpack(JSON.parse(r).changeset):r,s={},l=0;a.ops.forEach(function(e){if("object"===g(e.data)){var t=E.default.changeset2Actions(e),n=t.cellsData;s[l]=n,l+=1}else l+=e.data}),t[o]=s,n[o]=u(s)}function s(e,t,n){var r=n.id,o=t.cellsData,i=t.tableActions;["background","color","conditionalFormat"].forEach(function(t){var n=R[t],a=n[r]||(n[r]={});if("conditionalFormat"===t)return void(a[e]=i);var s=a[e]=[];o.forEach(function(e){var n=e[3];n&&n[t]&&s.push(e)})})}function l(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.spread,r=e.id,o=(t?["background","highLight"]:["highLight","background"]).concat(["conditionalFormat","color"]);I=e,(0,M.paintWrap)(function(){o.forEach(function(e){var o=R[e][r]||{};for(var i in o){var a=o[i],s=n.getSheet(i);switch(e){case"background":(0,w.setBulkCellsSingleStyle)(s,a,"background",t?"":null);break;case"highLight":t?(0,w.highlightCellsWithUserId)(s,a):(0,w.setBulkCellsSingleStyle)(s,a,"background","");break;case"conditionalFormat":t?(0,C.removeAllConditionalFormat)(s):(0,C.applyConditionalFormat)(s,a);break;case"color":(0,w.setBulkCellsSingleStyle)(s,a,"color",t?"":null)}}})},!0,"spread").bind(this)()}function u(t){function n(e,t){var n=!0,r=!1,o=void 0;try{for(var i,a=t[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){if(i.value.cells[e])return!0}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}}function r(e,t){var n={};return o(e,t,n),{cells:n,topCell:i(n)}}function o(e,t,n){var r=["top","right","bottom","left"],i=[];if("string"==typeof e&&(n[e]=!0,e=[[e]]),e.forEach(function(e){var o=m(e,2),l=o[0],u=o[1];r.forEach(function(e){if(e!==u){var r=a(l,e);r&&t[r]&&!n[r]&&(i.push([r,s(e)]),n[r]=!0)}})}),i.length)return o(i,t,n)}function i(e){return Object.keys(e).map(function(e){return v.default.parsePosition(e)}).sort(function(e,t){return e.col!==t.col?t.col-e.col:e.row-t.row})[0]}function a(e,t){var n=v.default.parsePosition(e),r=n.row,o=n.col;switch(t){case"top":r--;break;case"right":o++;break;case"bottom":r++;break;case"left":o--}return r<0||o<0?null:v.default.stringifyPosition(r,o)}function s(t){var n=["top","right","bottom","left"],r=n.length,o=e.findIndex(n,function(e){return e===t})-2;return n[o>=0?o:o+r]}var l={},u=function(o){var i=t[o],a=l[o]={};i.forEach(function(t){var n=m(t,4),r=n[0],o=n[1],i=n[3],s=e.isNil(i.userID)?-1:i.userID;(a[s]||(a[s]={}))[v.default.stringifyPosition(r,o)]=!0});for(var s in a){var u=a[s],c=[];for(var f in u)n(f,c)||c.push(r(f,u));a[s]=c}};for(var c in t)u(c);return l}function c(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];I&&l.call(this,I,e)}function f(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];a(e),l.call(this,e,t),p.call(this,e)}function d(){I=null}function p(e){var t=this,n=e.id,r=R.userRanges[n]||{},o=void 0,i=void 0;(0,M.paintWrap)(function(){for(var e in r){if(o)break;o=r[e],i=t.spread.getSheet(e),b.removeAllCollabs(i)}if(void 0!==o){var n=Object.keys(o)[0],a=o[n],s={color:x.default.getColor(n)};a&&a.length&&a.forEach(function(e){var t=(0,M.transformCellsToRange)(e.cells),n={range:t,userInfo:s};b.addCollabBorders(i,n,!0)})}},this,"spread").bind(this)()}function h(e){return x.default.getShareUser(e)||k.default.get(e)}Object.defineProperty(t,"__esModule",{value:!0});var m=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.renderUserName=i,t.collectHighLightCells=a,t.collectColorCells=s,t.showOrHideHighLight=l,t.toggleHighlight=c,t.highlightHistoryStep=f,t.clearCurHistory=d;var _=n(53),v=o(_),y=n(1156),b=r(y),w=n(1003),C=n(1057),S=n(433),x=o(S),T=n(1002),E=o(T),M=n(834),A=n(48),k=o(A),R={background:{},conditionalFormat:{},color:{},highLight:{},userRanges:{}},I=void 0}).call(t,n(1))},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}var o=n(9),i=r(o),a=n(1158),s=r(a),l=n(709),u=r(l),c=!1;e.exports=function(e){if(!c){c=!0,i.default.attach("socket:message",function(t){if("sheet"!==window.cow.pageType)return!1;if("COLLABROOM"===t.type){if(["USER_ENTER","USER_LEAVE","SELECT","UNSELECT"].indexOf(t.data.type)>=0&&+t.data.userInfo.id===window.cow.currentUser.id)return!1;switch(t.data.type){case"NEW_CHANGES":window.cow.usingNewSeq||e.dispatch(u.default.receivedNewChange(t.data.changeset,t.data.newRev));break;case"ACCEPT_COMMIT":case"REPEAT_COMMIT":e.dispatch(u.default.sendChangeSuccess(t.data.newRev,t.data.type));break;case"BAD_CHANGESET":i.default.notify("accept:error","data error");break;case"USER_ENTER":e.dispatch(s.default.recieveEnterCollaborator(t));break;case"USER_LEAVE":e.dispatch(s.default.recieveLeaveCollaborator(t));break;case"SELECT":e.dispatch(s.default.recieveCollaboratorSelected(t));break;case"UNSELECT":e.dispatch(s.default.recieveCollaboratorUnselected(t))}}});var t=void 0;i.default.attach("socket:reconnected",function(){if("sheet"!==window.cow.pageType)return!1;e.dispatch(u.default.sendClientStatus("ready",!0)),t&&clearTimeout(t),t=setTimeout(function(){e.dispatch(u.default.sendOfflineChange())},2e3)}),i.default.attach("spreadsheet:exit",function(){e.dispatch(u.default.sendClientStatus("quit"))})}}},function(e,t,n){function r(e){return{types:["SPREADSHEET_LOAD","SPREADSHEET_LOAD_SUCCESS","SPREADSHEET_LOAD_FAIL"],promise:o.getSpreadsheetByGuid(e)}}var o=n(903);e.exports={getSpreadsheet:r}},function(e,t,n){function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function l(e){return{msg:e.msg}}function u(){return{}}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),f=n(0),d=o(f),p=n(268),h=n(5),m=o(h),g=n(33),_=o(g),v=n(9),y=o(v),b=n(671),w=o(b),C=n(582),S=o(C),x=n(1075),T=o(x),E=n(178),M=o(E),A=n(330),k=o(A),R=n(331),I=o(R),O=n(21),D=r(O),P=n(910),N=o(P),F=D.isRNClient(),L=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={tableTitle:window.cow.currentFile.name,userId:window.cow.currentUser.id,authorized:window.cow.currentFile.authorized,shareStatus:D.getShareMode(),msg:n.props.msg,focused:!1,editable:"editable"===D.getPermissionsForCow(window.cow.currentFile).permission},n.csStoreInst=N.default.getInst({guid:e.guid}),n.getCurDoc=n.csStoreInst.getCurDoc.bind(n.csStoreInst),n._onTitleChange=n._onTitleChange.bind(n),n._onTitleBlur=n._onTitleBlur.bind(n),n._onTitleFocus=n._onTitleFocus.bind(n),n}return s(t,e),c(t,null,[{key:"propTypes",get:function(){return{guid:f.PropTypes.string,msg:f.PropTypes.object,isDingTalk:f.PropTypes.bool}}}]),c(t,[{key:"componentDidMount",value:function(){this._init(),m.default.isWechat()&&M.default.init()}},{key:"_titleDom",value:function(){return d.default.createElement("span",{className:"s-header-text"},d.default.createElement(T.default,{getCurDoc:this.getCurDoc}),d.default.createElement(w.default,{customClass:"title-input",defaultValue:this.state.tableTitle?this.state.tableTitle:"无标题",placeholder:"无标题",maxWidth:"100%",inputWidth:"100%",onBlur:this._onTitleBlur,onFocus:this._onTitleFocus,onChange:this._onTitleChange,tooltip:"重命名",enableJsBridge:!0,readOnly:!this.state.editable,ref:"tableName"}))}},{key:"_statusBarDom",value:function(){return d.default.createElement(S.default,{customClassName:"s-header-time"})}},{key:"_onTitleChange",value:function(){if(F){var e=this.refs.tableName.getValue();document.title=e,y.default.notify("file:updateTitle",e)}}},{key:"_onTitleBlur",value:function(){this.setState({focused:!1});var e=this.refs.tableName.getValue();e!==this.state.tableTitle&&(this.setState({tableTitle:e}),this._updateTitle(e))}},{key:"_onTitleFocus",value:function(){this.setState({focused:!0})}},{key:"_init",value:function(){this._initPush()}},{key:"_updateTitle",value:function(e){if(!F){e||(e="无标题");var t={name:e},n=window.cow.currentFile.guid;m.default.post("/api/file/"+n,t).then(function(){window.cow.currentFile.name=e,document.title=e,y.default.notify("file:updateTitle",e)}).fail(function(){console.log("name modify failed")})}}},{key:"_initPush",value:function(){var e=this;_.default.bind("File",function(t){if(!("sheet"!==window.cow.pageType||F&&e.state.focused)&&"update"===t.db_event&&0==+t.data.is_delete&&+t.data.id==+cow.currentFile.id){var n=t.data.name;e.setState({tableTitle:n}),e.refs.tableName.setValue(n)}}),_.default.bind("reconnect",function(){window.cow.readonly||window.cow.pageType})}},{key:"render",value:function(){var e=this.state,t=e.userId,n=e.authorized,r=this.props.isDingTalk;if(m.default.isDingtalkPcSidebar())return n?d.default.createElement("div",{className:"s-header"},d.default.createElement("div",{className:"s-header-container"},d.default.createElement("a",{id:"pad-back-btn","data-href":"/desktop"},d.default.createElement("span",{className:"m-icon"})),this._statusBarDom(),d.default.createElement("div",{id:"mobile-more-btn"},d.default.createElement("span",{className:"m-icon"}))),this._titleDom()):d.default.createElement("div",{className:"s-header"},d.default.createElement("div",{className:"s-header-container"},d.default.createElement("a",{id:"pad-back-btn","data-href":"/desktop"},d.default.createElement("span",{className:"m-icon"})),d.default.createElement("a",{href:"javascript:void(0);",className:"m-sheet-avatar"},d.default.createElement(k.default,{currentUser:window.cow.currentUser})),d.default.createElement("span",{className:"mark-star-container"},d.default.createElement(I.default,{currentFile:window.cow.currentFile,currentUser:window.cow.currentUser}))),this._titleDom());if(r)return d.default.createElement("div",{className:"s-header"},this._titleDom());if(n)return d.default.createElement("div",{className:"s-header"},d.default.createElement("div",{className:"s-header-container"},d.default.createElement("a",{id:"pad-back-btn","data-href":"/desktop"},d.default.createElement("span",{className:"m-icon"})),this._statusBarDom(),d.default.createElement("div",{id:"mobile-more-btn"},d.default.createElement("span",{className:"m-icon"}))),this._titleDom());if(t>0)return d.default.createElement("div",{className:"s-header"},d.default.createElement("div",{className:"s-header-container"},d.default.createElement("a",{id:"pad-back-btn","data-href":"/desktop"},d.default.createElement("span",{className:"m-icon"})),d.default.createElement("a",{href:"javascript:void(0);",className:"m-sheet-avatar"},d.default.createElement(k.default,{currentUser:window.cow.currentUser})),d.default.createElement("span",{className:"mark-star-container"},d.default.createElement(I.default,{currentFile:window.cow.currentFile,currentUser:window.cow.currentUser}))),this._titleDom());var o=window.cow.currentFile.team,i=void 0;return o&&o.resources&&(i=d.default.createElement("img",{className:"header-logo-img",src:o.resources.desktopLogo})),d.default.createElement("div",{className:"s-header"},d.default.createElement("div",{className:"s-header-container editable-sheet-header"},d.default.createElement("a",{href:"/",className:"s-home-link "+(i?"custom-logo":"")},i),!i&&d.default.createElement("a",{href:"/",className:"home-website"},"shimo.im"),d.default.createElement(I.default,{currentFile:window.cow.currentFile,currentUser:window.cow.currentUser})),this._titleDom())}}]),t}(f.Component);t.default=(0,p.connect)(l,u)(L),e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){d||(d=!0,s.default.attach("spread:inited",function(){var n=window.cow.currentFile;f=window._collabClient=new i.default({id:e.getState().msg.clientId,composeUrl:"/smapi/files/{fileId}/compose",pullUrl:"/smapi/files/{fileId}/pull",fileId:n.guid,type:"spreadsheet",editor:{store:e,actions:t,_global:window},userId:window.cow.currentUser.id,store:u.default,rev:n.head,guid:n.guid}),f.once("bad_changeset",function(){s.default.notify("accept:error","bad_changeset")}),f.once("error",function(t){var n=t.message;if("accept_commit_timeout"===n)return void e.dispatch((0,c.offline)());s.default.notify("accept:error",n)})}),s.default.attach("spreadsheet:exit",function(){f.stop()}))};var o=n(716),i=r(o),a=n(9),s=r(a),l=n(328),u=r(l),c=n(709),f=void 0,d=!1;e.exports=t.default},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){var n=window.URL||window.webkitURL;e.exports=function(e,t){try{try{var r;try{var o=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;r=new o,r.append(e),r=r.getBlob()}catch(t){r=new Blob([e])}return new Worker(n.createObjectURL(r))}catch(t){return new Worker("data:application/javascript,"+encodeURIComponent(e))}}catch(e){if(!t)throw Error("Inline worker is not supported");return new Worker(t)}}},,,,,,,function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function i(e){var t=e.shown,n=e.children,r=e.transitionName,i=o(e,["shown","children","transitionName"]),u=l.default.createElement("div",a({key:"transitionName",className:"common-sidebar"},i),s.Children.only(n));return l.default.createElement(c.default,{transitionName:r,transitionEnterTimeout:500,transitionLeaveTimeout:500},t&&u)}Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};t.default=i;var s=n(0),l=r(s),u=n(742),c=r(u);i.defaultProps={transitionName:"common-sidebar--transition"},i.propTypes={shown:s.PropTypes.bool.isRequired,children:s.PropTypes.element.isRequired,transitionName:s.PropTypes.string},e.exports=t.default},,,,,,,,,,,,,function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=e[0],n=h[t]||[];return n.length?n.filter(function(t){return 0===t.indexOf(e)}):[]}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all";return"all"===e?p:"hot"===e?s():m.hasOwnProperty(e)?m[e]:void console.warn("formula catagory not found.")}function a(e){return d.hasOwnProperty(e)?d[e].description:null}function s(){return["SUM","AVERAGE","COUNT","MAX","MIN","IF","SIN","SUMIF"]}Object.defineProperty(t,"__esModule",{value:!0}),t.searchByName=o,t.formulaGroups=i,t.nameToDetail=a;var l=n(1128),u=r(l),c=n(721),f=r(c),d=f.default.Spread.CalcEngine.SR.zh._builtInFunctionsResource,p=Object.keys(d),h=(0,u.default)(p,function(e){return e.charAt(0)}),m=(0,u.default)(p,function(e){return d[e][0]})},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(1581),i=r(o);t.default=i.default,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(271),f=r(c),d=n(581),p=function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.onClick=e.onClick.bind(e),e}return a(t,e),s(t,null,[{key:"propTypes",get:function(){return{name:l.PropTypes.string,value:l.PropTypes.string,onClick:l.PropTypes.func}}},{key:"defaultProps",get:function(){return{onClick:function(){}}}}]),s(t,[{key:"onClick",value:function(){var e=this.props,t=e.onClick,n=e.name,r=e.value;(0,d.track)("new_sheet","font_color",r),t(r,n)}},{key:"render",value:function(){var e=this.props,t=e.name,n=e.value;return t?u.default.createElement(f.default,{trigger:"hover",arrowPointAtCenter:!0,placement:"bottom",title:t},u.default.createElement("div",{className:"color-picker-rect "+(n?"":"no-fill"),style:{background:""+n},onClick:this.onClick})):u.default.createElement("div",{className:"color-picker-rect "+(n?"":"no-fill"),onClick:this.onClick,style:{background:""+n}})}}]),t}(l.Component);t.default=p,e.exports=t.default},function(e,t){function n(e){return o.map(function(t,n){var o=r[n];return!t&&i.indexOf(e)>-1&&(t="#ffffff",o=""),{name:o,value:t}})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;var r=["无填充","漆黑","红","橙","黄","葱绿","湖蓝","天色","紫","白练","鼠","虹","薄卵","蒸栗","白绿","蓝白","天空","紫水晶","白鼠","墨","甚三红","雄黄","金子","薄青","白群","薄花","紫苑","灰青","石墨","红绯","红金","枯茶","绿青","浅葱","薄缥","紫霞","薄钝","黑","朱绯","褐","黑茶","深绿","苍蓝","琉璃","葡萄"],o=["","#0d0015","#fe2c23","#ff9900","#ffd900","#a3e043","#37d9f0","#4da8ee","#aa17d0","#f3f3f1","#949494","#fcdbd6","#fde9d0","#fff0cf","#d4e9d6","#def3f3","#cee0ef","#dfdbec","#dcdedd","#595856","#ee837d","#f8c387","#e6b322","#9abd9d","#83ccd2","#89b0ce","#9389b1","#c1c6ca","#41464b","#d51228","#cf770b","#8d634a","#557b5c","#01a3b0","#3776a6","#765c83","#adadad","#2b2b2b","#a91913","#884702","#563725","#00552e","#00767a","#194e77","#530e6f"],i=["font","border"];e.exports=t.default},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function l(e){var t=e.name,n=e.onSelect,r=(0,g.nameToDetail)(t),o=n.bind(null,t);return d.default.createElement("li",{className:"fp-list__item",onClick:o},d.default.createElement("div",{className:"fp-list__item-name"},t),d.default.createElement("span",{className:"fp-weak-text"},r))}Object.defineProperty(t,"__esModule",{value:!0});var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),f=n(0),d=r(f),p=n(1102),h=n(1565),m=r(h),g=n(1460),_=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={activeCatagory:void 0,searchText:""},n}return s(t,e),c(t,[{key:"_onInput",value:function(e){this.setState({searchText:e}),e?this.props.changeSearchText(e.toUpperCase()):this.props.changeCatagory(this.state.activeCatagory)}},{key:"render",value:function(){var e=this,t=this.props,n=t.formulaNames,r=t.onClose,i=o(t,["formulaNames","onClose"]),a=this.state.searchText;return d.default.createElement("div",{className:"fp-formula-panel"},d.default.createElement("div",{className:"fp-header"},d.default.createElement("span",null,"插入函数"),d.default.createElement("span",{className:"right fp-pointer icon-close hicon",onClick:r})),d.default.createElement("div",{className:"fp-search"},d.default.createElement("span",{className:"team-sprite team-icon-search"}),d.default.createElement("input",{className:"form-control list-item-input fp-search__input",placeholder:"搜索",value:a,onInput:function(t){return e._onInput(t.target.value)}}),d.default.createElement("span",{className:(0,p.className)({"fp-pointer":!0,"team-sprite":!0,"team-icon-delete":!0,"fp--hide":!a.length}),onClick:function(){return e._onInput("")}})),d.default.createElement("ul",{className:"fp-list"},n.length?n.map(function(e){return d.default.createElement(l,u({key:e,name:e},i))}):d.default.createElement("div",{className:"fp-weak-text fp-list__empty"},"无搜索结果")))}}]),t}(f.Component);_.propTypes={onClose:f.PropTypes.func.isRequired,formulaNames:f.PropTypes.array.isRequired,changeSearchText:f.PropTypes.func.isRequired,changeCatagory:f.PropTypes.func.isRequired},l.propTypes={onSelect:f.PropTypes.func.isRequired,name:f.PropTypes.string.isRequired},t.default=(0,m.default)(_),e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=r(u),f=n(1460);t.default=function(e){return function(t){function n(e){o(this,n);var t=i(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t.state={formulaNames:(0,f.formulaGroups)("all")},t}return a(n,t),l(n,[{key:"_search",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=(0,f.searchByName)(e.trim().toUpperCase());this.setState({formulaNames:t})}},{key:"_byCatagory",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"hot";this.setState({formulaNames:(0,f.formulaGroups)(e)})}},{key:"render",value:function(){var t=this,n=s({},this.state,this.props,{changeSearchText:function(e){return t._search(e)},changeCatagory:function(e){return t._byCatagory(e)}});return c.default.createElement(e,n)}}]),n}(u.Component)},e.exports=t.default},function(e,t,n){(function(r,o){function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},d=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),p=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),h=n(0),m=a(h),g=n(13),_=a(g),v=n(53),y=a(v),b=n(721),w=a(b),C=n(20),S=a(C),x=n(176),T=n(9),E=a(T),M=n(21),A=i(M),k=n(1567),R=n(631),I=a(R),O=n(1002),D=a(O),P=n(574),N=n(534),F=a(N),L=n(1003),H=i(L),V=n(1057),j=i(V),B=n(834),U=i(B),W=n(909),z=n(253),Y=i(z),G=n(575),K=a(G),X=n(146),q=a(X),J=n(1058),Z=n(5),Q=a(Z),$=n(1569),ee=a($),te=n(1571),ne=a(te),re=n(1572),oe=a(re),ie=n(1573),ae=a(ie),se=n(1574),le=a(se),ue=n(1575),ce=a(ue),fe=n(1155),de=a(fe),pe=n(1576),he=a(pe),me=n(926),ge=i(me),_e=n(1156),ve=i(_e),ye=n(1577),be=a(ye),we=n(1139),Ce=n(1585),Se=a(Ce),xe=n(1587),Te=a(xe),Ee=n(1588),Me=n(1589),Ae=n(1590),ke=a(Ae),Re=n(533),Ie=n(1044),Oe=n(1157),De=n(632),Pe=a(De),Ne=n(1592),Fe=a(Ne),Le=n(627),He=n(910),Ve=a(He),je=w.default.Spread.Sheets,Be=je.Events,Ue=Q.default.isMobile(),We=Q.default.isIOS(),ze=Q.default.isAndroid(),Ye=A.isRNClient(),Ge=22,Ke=100,Xe=383,qe=U.paintWrap,Je=function(e){function t(e){l(this,t);var n=u(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.isWebWorkerSupported=A.isWorkerSupported()&&!Ye,n.enableWorkerForInit=!1,n.paintWrapAll=U.paintWrapAll.bind(n),n.processSort=n._processSort.bind(n),n.applyStyleAttrs=qe(n._applyStyleAttrs).bind(n),n.renderSheet=qe(n._renderSheet,!0).bind(n),n.applyCsAction=qe(n._applyCsAction,!0).bind(n),n.applyLockIcons=qe(n._applyLockIcons,!0).bind(n),n.renderCollab=qe(ve.renderCollab).bind(n),n.updateCollab=qe(ve.updateCollab).bind(n),n.removeAllCollabs=qe(ve.removeAllCollabs).bind(n),n.autoFitRowsAfterCellChanged=qe(ge.autoFitRowsAfterCellChanged).bind(n),n.autoFitRowsAfterPasted=qe(ge.autoFitRowsAfterPasted).bind(n),n.autoFitRowsAfterColumnChanged=qe(ge.autoFitRowsAfterColumnChanged).bind(n),n.applyCellLocks=qe(j.applyCellLocks).bind(n),n.applyUnlockAllCellLocks=qe(j.applyUnlockAllCellLocks).bind(n),n.doPaintCellsStyle=qe(U.doPaintCellsStyle).bind(n),n.uploadImage=n._uploadImage.bind(n),n.changeFilter=n._changeFilter.bind(n),n.changeFreeze=n._changeFreeze.bind(n),n.clearFormat=n._clearFormat.bind(n),n.paintFormat=n._paintFormat.bind(n),n.doPaint=n._doPaint.bind(n),n.setBorder=n._setBorder.bind(n),n.afterFrozenChanged=n._afterFrozenChanged.bind(n),n.mergeOrUnmergeCells=n._mergeOrUnmergeCells.bind(n),n.setFormula=ge.setFormula.bind(n),n.insertLink=n._insertLink.bind(n),n.setRowHeight=n._setRowHeight.bind(n),n.setColWidth=n._setColWidth.bind(n),n.setLink=n._setLink.bind(n),n.showConditionalFormat=n._showConditionalFormat.bind(n),n.alterConditionalFormat=n._alterConditionalFormat.bind(n),n.switchSheet=n._switchSheet.bind(n),n.getExportJSON=ge.getExportJSON.bind(n),n.onMouseOver=n._onMouseOver.bind(n),n.onWindowResize=n._onWindowResize.bind(n),n.addRow=n._addRow.bind(n),n.onInputFocus=n._setSpreadFocus.bind(n,!1),n.showSaveDataError=n._showSaveDataError.bind(n),n.onDialogClose=n._setSpreadFocus.bind(n,!0),n.onDialogShow=n._setSpreadFocus.bind(n,!1),n.handlerDragOrPasteImageToSheet=n._handlerDragOrPasteImageToSheet.bind(n),n.keepCellEditStatus=ge.keepCellEditStatus.bind(n),n.mobileDoCopy=n._mobileDoCopy.bind(n),n.mobileDoPaste=n._mobileDoPaste.bind(n),n.mobileDoCut=n._mobileDoCut.bind(n),n.mobileDoClean=n._mobileDoClean.bind(n),n.offlined=n._offlined.bind(n),n.reconnected=n._reconnected.bind(n),n.beforeLeave=n._beforeLeave.bind(n),n.setActiveCellValue=n._setActiveCellValue.bind(n),n.processCollab=r.debounce(n._processCollab.bind(n),500,{maxWait:3e3}),n.onLock=n._onLock.bind(n),n.onUnlock=n._onUnlock.bind(n),n.showLockPopup=n._showLockPopup.bind(n),n.enableToolbar=n._enableToolbar.bind(n),n.disableToolbar=n._disableToolbar.bind(n),n.passSpread=n._passSpread.bind(n),n.changeSheetZoom=n._changeSheetZoom.bind(n),n.isWebWorkerSupported&&(n.calcCSworker=(0,Se.default)()),n.hasEditPermission=(0,we.isHasEditPermission)(),n}return c(t,e),p(t,null,[{key:"propTypes",get:function(){return{guid:h.PropTypes.string.isRequired,msg:h.PropTypes.object.isRequired,setMenuSelection:h.PropTypes.func.isRequired,sendSelectCell:h.PropTypes.func.isRequired,updateCollabDone:h.PropTypes.func.isRequired,disableByLockCell:h.PropTypes.func.isRequired,enableByLockCell:h.PropTypes.func.isRequired,spreadsheet:h.PropTypes.object,lockpermission:h.PropTypes.object}}}]),p(t,[{key:"componentDidMount",value:function(){E.default.attach("menu:sort",this.processSort),E.default.attach("menu:style",this.applyStyleAttrs),E.default.attach("menu:border",this.setBorder),E.default.attach("menu:link",this.insertLink),E.default.attach("menu:paintFormat",this.paintFormat),E.default.attach("menu:clearFormat",this.clearFormat),E.default.attach("menu:uploadImage",this.uploadImage),E.default.attach("menu:filter",this.changeFilter),E.default.attach("menu:freeze",this.changeFreeze),E.default.attach("menu:mergeOrUnmergeCells",this.mergeOrUnmergeCells),E.default.attach("menu:formulaChange",this.setFormula),E.default.attach("menu:mousedown",this._menuMousedown),E.default.attach("conditionalFormat:show",this.showConditionalFormat),E.default.attach("accept:error",this.showSaveDataError),E.default.attach("tableAction:frozenChanged",this.afterFrozenChanged),E.default.attach("mobileSheet:switched",this.switchSheet),E.default.attach("btn:getExportJSON",this.getExportJSON),E.default.attach("keepCellEditStatus",this.keepCellEditStatus),E.default.attach("lock:sidebar:setting",this.showLockPopup),E.default.attach("lock:sidebar:delete",this.onUnlock),E.default.attach("spreadsheet:lock:toolbar:enable",this.enableToolbar),E.default.attach("spreadsheet:lock:toolbar:disable",this.disableToolbar),E.default.attach("sidebar:fetchspread",this.passSpread),this._initSpread(),(0,Ee.listenDrag)(this.handlerDragOrPasteImageToSheet),(0,Me.listenPaste)(this.handlerDragOrPasteImageToSheet),this.refs.hView.addEventListener("mousewheel",function(e){return e.preventDefault()},!1),o(document).on("mousemove",this.onMouseOver),o(window).on("resize",this.onWindowResize).on("offline",this.offlined).on("online",this.reconnected).on("beforeunload",this.beforeLeave),(0,Oe.bindZoomListener)(this)}},{key:"componentWillReceiveProps",value:function(e){if(this.isRendered){var t=this.props,n=e.msg,r=e.zoom;this.isSupportOffline=!!n.storage&&this.userID>0,e.disableAsync!==t.disableAsync&&(this.isWebWorkerSupported=!1),"sended"===n.status&&n.userCS.ops.length>0&&!window.cow.usingNewSeq&&t.sendChange(),n.applyCS&&n.applyCS.length>0&&n.applyCS!==t.msg.applyCS&&(this._applyChangeset(n.applyCS,n.fromPush),this._syncIconStyle()),e.collaborators.updateCollab&&this.processCollab(),!t.msg.offline&&n.offline&&this._offlined(),t.msg.offline&&!n.offline&&this._reconnected(),this.saveError||!this.hasEditPermission||!n.isReady||this.sheet.options.isLockedByUser||!this.isSupportOffline&&this.offline||U.unProtectSheet(this.sheet);this.props.lockpermission.users!==e.lockpermission.users&&this.refs.lockPopup.updateUsers(e.lockpermission.users);var o=e.sheetId,i="";o!==i&&(this._changeSheetId(o),t.changeSheetId(i)),this.changeSheetZoom(r)}}},{key:"shouldComponentUpdate",value:function(e){return!(this.props.spreadsheet===e.spreadsheet||!e.spreadsheet)}},{key:"componentDidUpdate",value:function(){this._initSpread()}},{key:"componentWillUnmount",value:function(){E.default.detach("menu:sort",this.processSort),E.default.detach("menu:style",this.applyStyleAttrs),E.default.detach("menu:border",this.setBorder),E.default.detach("menu:link",this.insertLink),E.default.detach("menu:paintFormat",this.paintFormat),E.default.detach("menu:clearFormat",this.clearFormat),E.default.detach("menu:uploadImage",this.uploadImage),E.default.detach("menu:filter",this.changeFilter),E.default.detach("menu:freeze",this.changeFreeze),E.default.detach("menu:mergeOrUnmergeCells",this.mergeOrUnmergeCells),E.default.detach("menu:formulaChange",this.setFormula),E.default.detach("menu:mousedown",this._menuMousedown),E.default.detach("conditionalFormat:show",this.showConditionalFormat),E.default.detach("accept:error",this.showSaveDataError),E.default.detach("mobileSheet:switched",this.switchSheet),E.default.detach("btn:getExportJSON",this.getExportJSON),E.default.detach("keepCellEditStatus",this.keepCellEditStatus),E.default.detach("app:setCellValue",this.setActiveCellValue),E.default.detach("lock:sidebar:setting",this.showLockPopup),E.default.detach("lock:sidebar:delete",this.onUnlock),E.default.detach("spreadsheet:lock:toolbar:enable",this.enableToolbar),E.default.detach("spreadsheet:lock:toolbar:disable",this.disableToolbar),E.default.detach("sidebar:fetchspread",this.passSpread),o(document).off("mousemove",this.onMouseOver),o(window).off("resize",this.onWindowResize).off("offline",this.offlined).off("online",this.reconnected).off("beforeunload",this.beforeLeave),(0,Ee.unListenDrag)(),(0,Me.unListenPaste)(),(0,Oe.unbindZoomListener)(),this._stopWorkers(),this.spread&&this.spread.destroy(),this.opsQueue&&this.opsQueue.destroy(),Ve.default.destory(this.props.guid)}},{key:"_reset",value:function(){this.spread&&this.spread.destroy(),this.csStoreInst=Ve.default.getInst({guid:this.props.guid}),this.spread=null,this.sheet=null,this.offline=!1,this.isRendered=!1,this.clipboardTouchData=null,this.delayActions=[],this.workerInst=[],this.userID=(0,M.getUserId)(),this.needRenderSheet={},this.cachedSheetData={},this.props.msg.storage&&(window.opsQueue=this.opsQueue=new Pe.default({clientId:this.props.msg.clientId,guid:this.props.guid,userId:this.userID}))}},{key:"_initSpread",value:function(){var e=this;this._reset();var t=this.props,n=this.csStoreInst,r=t.composeUserChanges,o=t.enableUndoRedo;t.resetCollab();var i=_.default.findDOMNode(this.refs.hView),a=document.getElementById("gc-fx-editor");a&&(a.innerText="");var s=window.spread=this.spread=new je.Workbook(i,this._getSpreadOptions());(this.fbx=new je.FormulaTextBox.FormulaTextBox(a)).workbook(s);var l=function(t){r(t),e.opsQueue&&e.opsQueue.remove()},u=n.wrapCs.bind(n);this.calcCSQueue=new Fe.default(this.spread,l,o,this._setSortCs.bind(this),u),window.cow.isEmptyQueue=this.calcCSQueue.isEmptyQueue.bind(this.calcCSQueue),this._initEvents(),this._syncOffline().then(function(){var t=n.getCurDoc();return e._setSortCs(t),e._initMultiSheet()}).then(function(){s.refresh(),e._toggleToolbar(s.getActiveSheet()),e._afterSelectionChanged(U.getAllSelections(e.sheet)),E.default.notify("spread:inited",s),E.default.notify("spread:editable:inited",s),e.isRendered=!0,e._hideLoading()})}},{key:"_getSpreadOptions",value:function(){var e=this,t={};return t.allowExtendPasteRange=!0,t.allowSheetReorder=!1,t.showDragFillSmartTag=!1,t.showScrollTip=3,t.showResizeTip=3,t.defaultDragFillType=6,t.bottomPadding=45,t.scrollbarMaxAlign=!0,t.tabEditable=!1,t.cutCopyIndicatorBorderColor="#73a2e3",t.lockImage=new Image,t.lockImage.src=Re.LOCK_IMG_BASE64,t.lockImage.onload=function(){t.lockImage.onload=null,r.forEach(e.spread.sheets,function(e){e.options.isLockedByUser&&U.repaintLockStyle(e)})},t.lockCellBg=new Image,t.lockCellBg.src=Re.LOCK_CELL_BG_BASE64,t.lockCellBg.onload=function(){t.lockCellBg.onload=null;var n=e.spread.getActiveSheet();(0,Ie.isUserLocked)(n,[U.getSheetSelection(n)])&&n.repaint()},t.lockCallback=function(t){var n=e.spread,r=e.spread.options,o=n.getActiveSheet();if(e.hasEditPermission){if(o.options.isLockedByUser&&(0,Ie.isUserLocked)(o)){if(r.lockCallback._isShow)return;r.lockCallback._isShow=!0;var i=U.hasCellLocks(o)?"单元格":"工作表",a=i+"已被锁定",s=t?"当前"+i+"已被锁定，您无法还原历史。如需进行还原，请与该表格的所有者联系。":"您尝试编辑的"+i+"已被锁定。如需进行编辑，请与该表格的所有者联系。";(0,q.default)({title:a,description:s,abortClass:"hide",confirmFun:function(){r.lockCallback._isShow=!1},abortFun:function(){r.lockCallback._isShow=!1}})}}else Q.default.alert({title:"当前协作权限为只读"})},t.lockCallback._isShow=!1,Ue?(t.showHorizontalScrollbar=!1,t.tabStripVisible=!1,t.bottomPadding=0):t.allowUserZoom=!1,Ye&&(t.disableVirtualKeyboard=!0),this.hasEditPermission||(t.newTabVisible=!1),t}},{key:"_changeSheetZoom",value:function(e){U.setSheetsZoom(this.spread,e)}},{key:"_showSaveDataError",value:function(e){this.saveError=!0,ge.showSaveDataError.call(this,e)}},{key:"_changeSheetId",value:function(e){var t=this.spread,n=this.sheet;if(n.guid()!==e){var r=U.getSheetIndexById(e,t);t.setActiveSheetIndex(r),this._afterActiveSheetChanged(n,t.getSheet(r))}}},{key:"_asyncSetMenuSelection",value:function(e){var t=this;clearTimeout(this.selectionTimeout),this.selectionActions=r.assign(this.selectionActions||{},e),this.selectionTimeout=setTimeout(function(){t.props.setMenuSelection(t.selectionActions)},100)}},{key:"_offlined",value:function(){this.spread.options.newTabVisible=!1,this.offline=!0,this.isSupportOffline?Q.default.alert({title:"网络连接错误，所有改动都会离线保存",type:"error"}):this.showSaveDataError("offline")}},{key:"_reconnected",value:function(){if(this.isSupportOffline&&this.hasEditPermission){this.spread.options.newTabVisible=!0,this.offline=!1,Q.default.alert({title:"离线内容已同步"}),U.unProtectSheet(this.sheet)}}},{key:"_beforeLeave",value:function(e){if(!this.calcCSQueue.isEmptyQueue()){var t="后台正在计算中，请勿离开";return e.returnValue=t,t}}},{key:"_processBulkSheetOp",value:function(e){var t=this;return e.map(function(e){var n=void 0;return t.isWebWorkerSupported&&t.enableWorkerForInit&&(n=(0,Se.default)(),t.workerInst.push(n)),t._asyncProcessData(e,n)})}},{key:"_stopWorkers",value:function(){this.calcCSworker&&this.calcCSworker.stop(),this.workerInst.forEach(function(e){e&&e.stop()})}},{key:"_addOpToCache",value:function(e,t){if(this.opsQueue){var n=this.props.msg;e.rev=n.revision,this.opsQueue.add(e,t)}}},{key:"_syncOffline",value:function(){if(!this.opsQueue)return Promise.resolve();var e=this.props,t=this.csStoreInst,n=e.msg.storage;return(0,Le.syncBulkCS)(n,this.opsQueue,this.userID,{guid:e.guid,csStoreInst:t})}},{key:"_initMultiSheet",value:function(){var e=this,t=this.spread,n=this.sortedCs.ops,r=this._processBulkSheetOp(n),o=0,i=null,a=void 0;return t.removeSheet(0),n.forEach(function(t,n){var r=e.spread,i=t.getAttributes()||{},a=i.name||"工作表1",s=new je.Worksheet(a,i.id);r.addSheet(n,s),i.id===window.cow.currentSheetId?o=n:e.needRenderSheet[i.id]=!0}),t.suspendPaint(),t.suspendEvent(),t.suspendCalcService(),r.reduce(function(t,r,s){return t.then(function(){return r}).then(function(t){if(t){var r=n[s],l=r.getAttributes()||{};e.cachedSheetData[l.id]=t,o===s?(i=r,a=t):e._initSingleSheet(r,t,s,!0)}})},Promise.resolve(null)).then(function(){i?e.sheet=window.sheet=e._initSingleSheet(i,a,o):(F.default.setCurrentSheetId(e.sortedCs.ops[0].getAttributes().id),e.sheet=window.sheet=t.getSheet(0))}).then(function(){!Ue&&t.focus(),t.setActiveSheetIndex(o),t.resumeCalcService(),t.resumeEvent(),t.resumePaint()})}},{key:"_initSingleSheet",value:function(e,t,n,r){var o=this.spread,i=e.data,a=i.rows,s=i.cols,l=o.getSheet(n);return l.setRowCount(a.length),l.setColumnCount(s.length),this._renderSheet(l,t,r),l}},{key:"_getSheetData",value:function(e){var t=this.cachedSheetData,n=this.needRenderSheet[e],r=void 0;return"updated"!==n&&(r=t[e],r.isCached=!0),r||(t[e]=r=ge.processDataByCS(this.csStoreInst.findTableOpByCs(e,this.sortedCs))),r}},{key:"_setSortCs",value:function(e,t){e=e||this.csStoreInst.getCurDoc(),t&&this.sortedCs&&this._setNeedRenderSheet(e,this.sortedCs),this.sortedCs=e}},{key:"_setNeedRenderSheet",value:function(e,t){var n=this.needRenderSheet,o=t.ops;e.ops.forEach(function(e,t){var i=o[t];if(!r.isEqual(e,i)){var a=e.getAttributes().id;n[a]="updated"}})}},{key:"_setNeedRenderSheetByApply",value:function(e){var t=this.needRenderSheet;r.forEach(e.ops,function(e){Y.isTableChanged(e)&&(t[(e.getAttributes()||{}).id]="updated")})}},{key:"_resetSheet",value:function(){var e=this,t=this.spread,n=window.cow.currentSheetId,r=this._getSheetData(n);this._switchActiveSheetIndex(),this.sheet=window.sheet=t.getActiveSheet();var o=this.sheet;qe(function(){r.isCached||(U.resetSheetStyles(o),j.removeAllConditionalFormat(o),j.removeKeyOfHasLockedCells(o)),e.needRenderSheet[n]=!1,e._renderSheet(o,r)},!0).call(this)}},{key:"_renderSheet",value:function(e,t,n){var r=t.cellsData,o=t.tableActions,i=t.rowHeights,a=t.colWidths,s=t.autoFitRowHeights;n?(H.setBulkCells(e,r,!0),j.applyLockIcon(e,o)):(this._setDefaultStyle(e),j.applyTableAttrs(e,o),j.applyRowColAttrs(e,i,a),H.setBulkCells(e,r),j.applyAutoFitRows(e,s),j.applyLocks(e,o,this.hasEditPermission),setTimeout(function(){return j.applyFilter(e,o)}))}},{key:"_menuMousedown",value:function(){var e=this.spread;e&&e.focus()}},{key:"_setDefaultStyle",value:function(e){var t=new je.Style;w.default.Spread.Common.CultureManager.culture("zh-cn"),t.vAlign=je.VerticalAlign.center,t.textIndent="0.38",t.font=Re.DEFAULT_FONT,e.setDefaultStyle(t,je.SheetArea.viewport),e.options.allowCellOverflow=!0,e.options.clipBoardOptions=Xe,e.options.dragDropCopyToOptions=Xe,e.options.frozenlineColor="#666666",e.setColumnWidth(0,50,je.SheetArea.rowHeader),this.hasEditPermission&&this.props.msg.isReady||U.protectSheet(e)}},{key:"_initEvents",value:function(){var e=this,t=this.spread,n=this.props,o=Q.default.isMac(),i=t.commandManager(),a=r.assign(w.default.Spread.Commands.Key,{b:66,i:73,u:85}),s=["bold","italic","underline"],l=Be.EditEnding,u=Be.EditEnded,c=Be.DragFillBlock,f=Be.DragFillBlockCompleted,d=Be.RowHeightChanging,p=Be.RowHeightChanged,h=Be.FloatingObjectCuting,m=Be.ColumnWidthChanged,g=Be.PictureChanged,_=Be.ClipboardPasting,v=Be.ClipboardPasted,y=Be.ClipboardChanged,b=Be.ClipboardChanging,C=Be.SelectionChanged,S=Be.InvalidOperation,x=Be.TopRowChanged,T=Be.LeftColumnChanged,E=Be.RangeFiltered,M=Be.RangeSorting,A=Be.RangeSorted,k=Be.SheetTabClick,R=Be.ActiveSheetChanged,I=Be.SheetNameChanged,O=Be.DragDropBlock,D=Be.DragDropBlockCompleted,P=Be.ColumnWidthChanging,N=Be.AutoFitRowHeightChanging,F=Be.AutoFitRowHeightChanged,L=Be.FormulatextboxEditing,H=Be.UserFormulaEnter,V={},j=!1,B=!1,z=function(e,t,n,r){var o=e.getCell(t,n);"string"==typeof r&&r.indexOf("\n")>-1&&!o.wordWrap()&&o.wordWrap(!0)};t.bind(S,function(e,t){ge.afterInvalidOperation(t),B=!0}),t.bind(l,function(t,n){var r=n.row,o=n.col,i=e.sheet._editor;V=i&&i.isCellDelete?null:(0,W.getCell)(e.sheet,r,o),B=!1}),t.bind(u,function(t,n){var o=n.row,i=n.col,a=n.editingText,s=e.sheet,l=r.isNil(a);if(!j){if(j=!1,!V)return(0,q.default)({title:"输入失败",description:"您所编辑的单元格已被其它协作者删除，无法输入。<br>\n            当前编辑内容为"+(a?"：<b>"+a+"</b>":"空"),abortClass:"hide"});var u=V.attrs.link;if((l||"="!==a[0]||!B)&&void 0!==a&&!u){z(s,o,i,a);var c=(0,W.getCell)(s,o,i);if(!U.isCellChanged(V,c))return;var f=null===a&&V.attrs.formula?{formula:null}:{},d={value:a,attrs:f};e._afterCellValueChanged([[o,i,V,d]])}}}),t.bind(L,function(t,n){var r=[],o=n.changedCells,i=e.sheet;j=!0;var a=o.map(function(e){var t=e.row,n=e.col;return(0,W.getCell)(i,t,n)});setTimeout(function(){o.forEach(function(e,t){var n=e.row,o=e.col,s=i.getValue(n,o),l=(0,W.getCell)(i,n,o);z(i,n,o,s),r.push([n,o,a[t],l])}),e._afterCellValueChanged(r)})}),t.bind(c,function(t,n){e._onDragFillBlock(n)}),t.bind(f,function(t,n){e._afterDragFillBlockCompleted(n)}),t.bind(O,function(t,n){e._onDragDropBlock(n)}),t.bind(D,function(t,n){e._afterDragDropBlockCompleted(n)}),t.bind(d,function(e,t){t.header&&(t.cancel=!0)}),t.bind(p,function(t,n){var r=n.rowList;e._afterRowHeightChanged(r)}),t.bind(N,function(t,n){var r=n.rowList,o=r.map(function(t){return[t,e.sheet.getAutoFitRowHeight(t)]});n.oldAutoFitHeight=o}),t.bind(F,function(t,n){var r=n.oldAutoFitHeight,o=n.rowList;e._afterAutoFitRowHeightChanged(r,o)}),t.bind(m,function(t,n){var r=n.colList;e._afterColumnWidthChanged(r)}),t.bind(g,function(t,n){return e._afterPictureChanged(n)}),t.bind(h,function(t,n){return e._afterFloatingObjectCuting(n)});var Y=void 0;t.bind(_,function(t,n){Q.default.alert({title:"正在粘贴，请勿操作...",delay:500}),Y&&clearTimeout(Y);var r=e.sheet.getSelections(),o=(0,Ie.isUserLocked)(e.sheet);if(o||r.length>1)Y=setTimeout(function(){(0,q.default)({title:"无法粘贴",description:o?"不能粘贴内容到被锁定的单元格":"此操作不支持多选",abortClass:"hide"})},300),n.cancel=!0;else{var i=e._collabCellsInPasting(n),a=i.cutCellsAry,s=i.pastedCellAry;n.cutCellsAry=a,n.pastedCellAry=s,n.oldRowLen=e.sheet.getRowCount(),n.oldColLen=e.sheet.getColumnCount()}}),t.bind(v,function(t,n){e._afterClipboardPasted(n)}),t.bind(b,function(t,n){n.isCutting&&(0,Ie.isUserLocked)(e.sheet)&&((0,q.default)({title:"无法粘贴",description:"不能剪切被锁定的单元格",abortClass:"hide"}),n.cancel=!0)}),t.bind(y,function(t,n){return e._afterClipboardChanged(n)}),t.bind(C,function(t,n){var r=n.newSelections;r.length>0&&e._afterSelectionChanged(r)}),t.bind(x,function(){e._toggleAddMultiRows(),e._hideContextMenu()}),t.bind(T,function(){return e._hideContextMenu()}),t.bind(E,function(t,n){var r=n.col,o=n.filterValues;e._afterRangeFiltered(r,o)}),t.bind(M,function(t,n){var r=e.sheet,o=U.getActualCellRange(r,r.rowFilter().range),i=o.row,a=o.col,s=o.rowCount,l=o.colCount,u=(0,W.getCellsByRanges)(r,[{row:i,col:a,rowCount:s,colCount:l}]);n.oldCellsAry=u}),t.bind(A,function(t,n){var r=n.oldCellsAry;e._afterRangeSorted(r)}),t.bind(k,function(t,n){var r=n.sheetTabIndex,o=e.sheet,i=o._formulaTextBox;!o||i&&i._canAppendRange()||o.endEdit(),-1===r&&(e.isNewSheet=!0)}),t.bind(R,function(t,n){var r=n.oldSheet,o=n.newSheet;e._afterActiveSheetChanged(r,o),e.isNewSheet=!1,e._toggleToolbar(o)}),t.bind(I,function(t,n){var r=n.newValue;e._afterSheetNameChanged(r)}),t.bind(P,function(e,t){t.header&&(t.cancel=!0)}),t.bind(H,function(e,t){var n=t.ranges,r=t.row,o=t.col,i=t.sheetName,a={sheetName:i,range:je._createRange(r,o,1,1)};U.isRangeContainsSelf(n,a)&&(t.cancel=!0,B=!0,(0,q.default)({title:"范围选择错误",description:"公式中的单元格引用了公式的结果，从而创建了循环引用,请重新选择。",abortClass:"hide"}))}),this._initMobileEvents(),this._initRnEvent(),i.register("custom-paste",function(){setTimeout(function(){return e._afterPastedByShortCuts()})}),i.register("custom-undo",function(){return n.undo(),!0}),i.register("custom-redo",function(){return n.redo(),!0}),i.register("custom-delete",function(){return e._onDeleteCommand()}),i.register("custom-backspace",function(){return e._onDeleteCommand()}),i.register("custom-select-all",function(){return!e.sheet.isEditing()&&U.selectAll(e.sheet)}),i.register("custom-copy",function(){return U.isFloatingObjectSelected(e.sheet)}),s.forEach(function(t){i.register("shortcut-"+t,function(){return e.applyStyleAttrs(t,!U.getActiveCellAttrByName(e.sheet,t)),!0})}),i.setShortcutKey("custom-delete",a.del,!1,!1,!1,!1),i.setShortcutKey("custom-backspace",a.backspace,!1,!1,!1,!1),i.setShortcutKey("custom-select-all",a.a,!o,!1,!1,o),i.setShortcutKey("custom-copy",a.c,!o,!1,!1,o),i.setShortcutKey("custom-paste",a.v,!o,!1,!1,o),i.setShortcutKey("custom-undo",a.z,!o,!1,!1,o),i.setShortcutKey("custom-redo",a.y,!o,!1,!1,o),s.forEach(function(e){i.setShortcutKey("shortcut-"+e,a[e.charAt(0)],!o,!1,!1,o)})}},{key:"_toggleToolbar",value:function(e){U.isWorksheetLocked(e)?e.options.isProtected?this.disableToolbar():this.enableToolbar():(this.hasEditPermission?this.enableToolbar():this.disableToolbar(),this._containsLockedCells(e))}},{key:"_initMobileEvents",value:function(){var e=this;if((Ue||Q.default.isDingtalkPcSidebar())&&!Ye){var t=this.spread,n=Be.EnterCell,r=Be.CellDoubleClick,i=Be.TouchToolStripOpening,a=Be.EditStarting,s=Be.TopRowChanged;if(t.bind(r,function(){e.onEnterCell||(t.unbind(n,e._onMobileEnterCell),t.bind(n,e._onMobileEnterCell)),e.onEnterCell=!0}),t.bind(i,function(){e._showQuickActions()}),t.bind(a,function(){e._hideQuickActions()}),t.bind(s,function(){e._hideQuickActions()}),We&&o(document).on("focusout",'textarea[gcuielement="gcEditingInput"]',function(){!0===e.onEnterCell&&e._endEditAfterCloseKeyboard()}),ze){var l=window,u=l.innerHeight,c=l.innerWidth;this.winSize=[u,c],o(window).on("orientationchange",function(){e.winSize&&e.winSize.reverse()}).on("resize",function(){window.innerHeight>e.winSize[0]-10&&e._endEditAfterCloseKeyboard()})}}}},{key:"_initRnEvent",value:function(){if(Ye){var e=Be.EditStarting;this.spread.bind(e,function(e,t){t.cancel=!0,E.default.notify("startEdit")}),E.default.attach("app:setCellValue",this.setActiveCellValue)}}},{key:"_setActiveCellValue",value:function(e){var t=e.row,n=e.col,r=e.value,o=(0,W.getCell)(this.sheet,t,n),i={value:r,attrs:{}},a=[t,n].concat((0,P.text2Cell)(o,i));H.setCell(this.sheet,a),this._afterCellValueChanged([[t,n,o,i]])}},{key:"_endEditAfterCloseKeyboard",value:function(){this.sheet.endEdit(),this.onEnterCell=!1,this.spread.unbind(Be.EnterCell,this._onMobileEnterCell)}},{key:"_onMobileEnterCell",value:function(e,t){t.sheet.startEdit(!1)}},{key:"_composeChange",value:function(e,t){this.calcCSQueue.composeChange(e,t)}},{key:"_calcOperator",value:function(e,t,n){var r=this;this._addOpToCache(e,t);var o=e.fnName,i=e.params,a=e.moduleName;if(n){var s=function(){var e=I.default[o].apply(null,i);return r.csStoreInst.wrapCs(e)};return this._wrapPostMessage({type:"sheet-cs-calculate",action:o,params:i},s)}return"multiSheetUtils"===a?K.default[o].apply(null,i):I.default[o].apply(null,i)}},{key:"_asyncProcessData",value:function(e,t){var n=this,r=function(){return D.default.processTableOps(e)};return function(e,t,r){if(!n.isWebWorkerSupported||!n.enableWorkerForInit)return Promise.resolve({res:t()});var o=(0,x.v4)();return e.uuid=o,r.postMessage(e).then(function(e){return r.stop(),e}).catch(function(){r.stop(),n.showSaveDataError()})}({type:"cs-to-action",action:"processTableOps",params:[y.default.pack(new v.Delta([e]))]},r,t).then(function(e){var t=e.res;return ge.processData(t)})}},{key:"_applyChangeset",value:function(e,t,n){if(e&&0!==!e.length){Y.isSheetChangeByOps(e)&&this._applySheetChangeCs(e);var r=Y.findTableOpInApplyCsById(e,window.cow.currentSheetId);this.applyLockIcons(e),r?this.applyCsAction(r,n):t||(this._setNeedRenderSheetByApply(e),(r=Y.findTableOpInApplyCsById(e))&&(F.default.setCurrentSheetId(r.getAttributes().id),this._switchSheet(),this.applyCsAction(r,n)))}}},{key:"_applyCurSheetChangeset",value:function(e){this.applyCsAction(e,!0)}},{key:"_applyCsAction",value:function(e,t){var n=this,r=this.sheet,o=D.default.changeset2Actions(e),i=o.tableActions,a=o.rows,s=o.rowsAttr,l=o.colsAttr,u=o.cols,c=o.cellsData,f=(0,J.data2Attr)(s,"height",Ge),d=(0,J.data2Attr)(l,"width",Ke),p=(0,J.data2Attr)(s,"autoFit",Ge);j.applyTableAttrs(r,i),j.alterRows(r,a),j.alterCols(r,u),j.applyRowColAttrs(r,f,d),H.setBulkCells(r,c),!t&&j.applyAutoFitRows(r,p),j.applyLocks(r,i,this.hasEditPermission,!0),ge.updateEditPositionAfterApplyCs(r,a,u),setTimeout(function(){j.applyFilter(r,i),ve.needReRenderCollabs(o,f,d)&&ve.renderCollab.call(n)})}},{key:"_applySheetChangeCs",value:function(e){var t=this.spread,n=D.default.changeset2SheetChangeAction(e);this._setSortCs(null,!0),j.applySheetChangesActions(t,n);var r=t.getActiveSheet().guid();r!==window.cow.currentSheetId&&(F.default.setCurrentSheetId(r),this._switchSheet(),Ue&&E.default.notify("reactSheet:resetCurrentSheetId"))}},{key:"_applyLockIcons",value:function(e){var t=this;D.default.changeset2LockActions(e).forEach(function(e){var n=d(e,2),r=n[0],o=n[1],i=t.spread.getSheet(r);i&&j.applyLockIcon(i,o)})}},{key:"_processSort",value:function(e){var t=this.sheet,n=e.indexOf("area")>-1,r=n?t.getSelections():[U.getSheetSelection(t)],o=r[0];if(0!==r.length){if(t.getSpans(o).length>0)return void(0,q.default)({title:"无法排序",description:"不能对包含合并单元格的行进行排序",abortClass:"hide"});var i=t.getActiveColumnIndex(),a="asc"===e.substr(0,3),s=U.getActualCellRange(t,o),l=s.row,u=s.col,c=s.rowCount,f=s.colCount;n||(l=0,u=0,c=t.getRowCount(),f=t.getColumnCount());var d=(0,W.getCellsByRanges)(t,[{row:l,col:u,rowCount:c,colCount:f}]);t.sortRange(l,u,c,f,!0,[{index:i,ascending:a}]),n&&t.recalcAll();var p=(0,W.appendNewCells)(t,d,!0),h=[t.guid(),p,this.userID],m={fnName:"editCell2Changeset",params:h};this._composeChange(this._calcOperator(m,!1,!0))}}},{key:"_applyStyleAttrs",value:function(e,t){var n=this.sheet,r=n.guid(),o=s({userID:this.userID},e,t),i=(0,W.genNewCellsByAttrs)(n,o,U.getAllSelections(n));H.setBulkCellsStyle(n,i,o);var a=[r,i,o],l={fnName:"cellAttrs2Changeset",params:a};this._composeChange(this._calcOperator(l,!1,!0))}},{key:"_processCollab",value:function(e){this.updateCollab(e),this.props.updateCollabDone()}},{key:"_insertLink",value:function(){this.refs.link.show(ge.getInsertLinkInfo(this.sheet))}},{key:"_setLink",value:function(e){var t=this.sheet,n=e.url,o=e.text,i=e.tooltip,a=e.stringifyPos,s=y.default.parsePosition(a),l=s.row,u=s.col,c=new je.CellTypes.HyperLink,f=(0,W.getCell)(t,l,u);n?(0!==n.indexOf("http")&&(n="http://"+n,e.url=n),c.text(o),c.linkToolTip(i),c._value=r.isNil(o)?"":o,t.getCell(l,u).cellType(c).value(n)):t.getCell(l,u).cellType(void 0).value(o);var d=[t.guid(),l,u,e,f,this.userID],p={fnName:"link2Cs",params:d};this._composeChange(this._calcOperator(p))}},{key:"_setBorder",value:function(e){var t=this.sheet,n=U.getAllSelections(t),r=t.getRowCount()-1,o=t.getColumnCount()-1,i=[t.guid(),n,e,r,o,this.userID],a={fnName:"border2Cs",params:i},s=this._calcOperator(a),l=d(s,1),u=l[0];this._applyCurSheetChangeset(u),this._composeChange(s)}},{key:"_setRowHeight",value:function(e){var t=this.sheet,n=U.getAllSelectedRows(t),r=_.default.findDOMNode(this.refs.setRowSize),i=+o(r).find(".set-size-input")[0].value;!isNaN(i)&&i>=0&&i<=1e3?(U.setMultiRowHeight(t,n,i),this._closeRowDialog(),this._afterRowHeightChanged(n)):Q.default.alert({title:"设置失败，行高必须在0-1000像素之间",type:"error"}),e.stopPropagation(),e.preventDefault()}},{key:"_setColWidth",value:function(e){var t=this.sheet,n=U.getAllSelectedColumns(t),r=_.default.findDOMNode(this.refs.setColSize),i=+o(r).find(".set-size-input")[0].value;!isNaN(i)&&i>=0&&i<=1e3?(U.setMultiColumnWidth(t,n,i),this._closeColDialog(),this._afterColumnWidthChanged(n)):Q.default.alert({title:"设置失败，列宽必须在0-1000像素之间",type:"error"}),e.stopPropagation(),e.preventDefault()}},{key:"_clearFormat",value:function(){var e=this.sheet,t=(0,W.getCellsByRanges)(e,U.getAllSelections(e)),n=[e.guid(),t,this.userID],r={fnName:"clearFormat2Cs",params:n},o=this._calcOperator(r),i=d(o,1),a=i[0];this._applyCurSheetChangeset(a);var s=U.getActiveCell(e),l=s.row,u=s.col;this._updateCellState(l,u),this._composeChange(o)}},{key:"_resetPaint",value:function(){this.paintInfo=null,this.isPainting=!1,this._asyncSetMenuSelection({paintSelected:!1})}},{key:"_paintFormat",value:function(e){var t=this.sheet,n=t.getSelections(),r=n.length;if(e.paintSelected){if(r>1)return this._resetPaint(),(0,q.default)({title:"无法格式化",description:"不能对多选区格式化",abortClass:"hide"});if(0===r)return this._resetPaint(),(0,q.default)({title:"无法格式化",description:"请先选择需要格式化的区域",abortClass:"hide"});this.paintInfo=U.getPaintInfo(t),this.isPainting=!0}else this.isPainting=!1;this.keepPaint=e.keep}},{key:"_doPaint",value:function(){var e=this.sheet,t=this.paintInfo,n=t.rowCount,r=t.colCount,o=U.getCurSelection(e),i=e.getRowCount(),a=e.getColumnCount(),s=o.row,l=o.col,u=o.rowCount,c=o.colCount;u=Math.min(Math.max(n,u),i-s),c=Math.min(Math.max(r,c),a-l);var f={row:s,col:l,rowCount:u,colCount:c},d=(0,W.getCellsByRanges)(e,[f]);this.doPaintCellsStyle(e,this.paintInfo,f);var p=(0,W.appendNewCells)(e,d);this.autoFitRowsAfterCellChanged(p);var h=[e.guid(),p],m={fnName:"overrideCellsAttrs2Cs",params:h};this._composeChange(this._calcOperator(m))}},{key:"_changeFreeze",value:function(){var e=this.sheet,t=e.guid(),n=e.frozenColumnCount(),r=e.frozenRowCount(),o=void 0,i=void 0;if(r>0||n>0)o=0,i=0;else{var a=U.getCurSelection(e);if(o=a.row,i=a.col,0===o&&0===i)return(0,q.default)({title:"无法冻结",description:"只能冻结所选单元格的以上行和以左列",abortClass:"hide"})}j.applyFrozen(e,o,i);var s={fnName:"tableAttrs2Cs",params:[t,this._wrapTableAttrs({fixedRowsTop:o,fixedColumnsLeft:i})]};this._composeChange(this._calcOperator(s))}},{key:"_changeFilter",value:function(e){var t=this.sheet,n=this.csStoreInst,r=ge.genEditFilterParams(t,n,e),o={fnName:Re.FILTER_FUNC_MAP[e],params:r},i=this._calcOperator(o),a=d(i,1),s=a[0];this._applyCurSheetChangeset(s),this._composeChange(i)}},{key:"_mergeOrUnmergeCells",value:function(){var e=this,t=this.sheet,n=U.getCurSelection(t),r=n.row,o=n.col,i=n.rowCount,a=n.colCount,s=t.getSpan(r,o);if(s&&i<=s.rowCount&&a<=s.colCount)this._unMergeCells(n);else{if(U.isSelectionCanNotBeMerged(t,n))return void Q.default.alert({type:"error",title:"您选择的范围里包含已经合并的单元格，请先解除合并"});if(U.isRangeHasMultiValues(t,n))return(0,q.default)({title:"合并单元格",description:"合并后的单元格将只保留左/上单元格中的值，确定合并吗？",confirmFun:function(){e._mergeCells(n)}});this._mergeCells(n),this._asyncSetMenuSelection({selectionIsMergedCells:!0})}}},{key:"_mergeCells",value:function(e){var t=e.rowCount,n=e.colCount;if(t>1||n>1){var r=(0,W.getCellsByRanges)(this.sheet,[e]),o=[this.sheet.guid(),r,e,this.userID],i={fnName:"mergeCells2Cs",params:o},a=this._calcOperator(i),s=d(a,1),l=s[0];this._applyCurSheetChangeset(l),this._composeChange(a)}}},{key:"_unMergeCells",value:function(e){var t=e.row,n=e.col;H.setBulkCellsStyle(this.sheet,[[t,n]],{rowspan:null,colspan:null});var r=[this.sheet.guid(),{row:t,col:n},this.userID],o={fnName:"unmergeCells2Cs",params:r};this._composeChange(this._calcOperator(o))}},{key:"_wrapTableAttrs",value:function(e){var t=this.sheet.guid();return t&&(e.id=t),e}},{key:"_uploadImage",value:function(e){var t=this;Q.default.alert({title:"图片正在上传, 请稍等"}),U.uploadImage(this.sheet,e).then(function(e){return t._afterUploadImageSuccess(e)})}},{key:"_onDeleteCommand",value:function(){if(!this.sheet.isEditing())return this._doDelete()}},{key:"_doDelete",value:function(){var e=this.sheet,t=U.getActivePictures(e);return t.length>0?this._doDeleteImage(t):this._doDeleteCell(),!0}},{key:"_doDeleteImage",value:function(e){var t=this.sheet,n={};r.forEach(e,function(e){var r=e._ps.name;n[r]=null,t.pictures.remove(r)});var o={fnName:"tableAttrs2Cs",params:[t.guid(),this._wrapTableAttrs(n)]};this._composeChange(this._calcOperator(o))}},{key:"_doDeleteCell",value:function(){var e=this.sheet,t=U.getAllSelectedCellCoords(e),n=[];r.forEach(t,function(t){var o=d(t,2),i=o[0],a=o[1],s=(0,W.getCell)(e,i,a),l={},u=s.attrs;u.formula&&(l.formula=null),u.link&&r.assign(l,{link:null,linkToolTip:null});var c={value:"",attrs:l};n.push([i,a,s,c]);var f=e.getCellType(i,a);(0,W.isLinkType)(f)&&e.setCellType(i,a,new je.CellTypes.Text)}),this.spread.commandManager().execute({cmd:"clear",sheetName:e.name()}),this._afterCellValueChanged(n)}},{key:"_afterUploadImageSuccess",value:function(e){var t=this,n=e.data,r=this.sheet,o=n.images,i="picture-"+Q.default.genGuid(),a=U.getCurSelection(r),s={},l=r.pictures,u=a.row,c=a.col,f=U.getCellOffset(r,u,c),d=f.x,p=f.y,h=U.getImageDefaultSize(n),m=h.width,g=h.height;s[i]=JSON.stringify([o,d,p,m,g]),U.verifyImg(o).then(function(){l.add(i,o,d,p,+m,+g);var e=l.get(i);e&&e.dynamicSize(!1);var n={fnName:"tableAttrs2Cs",params:[r.guid(),t._wrapTableAttrs(s)]};t._composeChange(t._calcOperator(n))}).fail(function(){return Q.default.alert({title:"插入图片失败，请稍后重试",type:"error"})})}},{key:"_afterCellValueChanged",value:function(e){this.autoFitRowsAfterCellChanged(e);var t=[this.sheet.guid(),e,this.userID],n={fnName:"editCell2Changeset",params:t},r=this._calcOperator(n);if(d(r,3)[2])return void(this.opsQueue&&this.opsQueue.remove());this._composeChange(r)}},{key:"_afterDragFillBlockCompleted",value:function(e){var t=e.fillRange,n=e.oldCells,r=this.sheet,o=(0,W.appendNewCells)(r,n,!0);this.autoFitRowsAfterCellChanged(U.getAllSelectedCellCoords(r,[t]));var i=[r.guid(),o,this.userID],a={fnName:"editCell2Changeset",params:i};this._composeChange(this._calcOperator(a,!1,!0))}},{key:"_onDragFillBlock",value:function(e){var t=e.fillRange;e.oldCells=(0,W.getCellsByRanges)(this.sheet,[t])}},{key:"_onDragDropBlock",value:function(e){function t(){var t=this;U.paintWrap(function(){t.spread.commandManager().execute({cmd:"dragDrop",fromColumn:r,toColumn:i,columnCount:l,option:d,sheetName:u,fromRow:o,toRow:a,rowCount:s,copy:c,insert:f}),t._afterDragDropBlockCompleted(e)},!0).call(this)}var n=this.sheet,r=e.fromCol,o=e.fromRow,i=e.toCol,a=e.toRow,s=e.rowCount,l=e.colCount,u=e.sheetName,c=e.copy,f=e.insert,d=e.copyOption,p=U.isNullSelections(n,[{row:a,col:i,rowCount:s,colCount:l}]),h=ge.getDragDropRanges(n,je.CellRange,e);e.oldCells=(0,W.getCellsByRanges)(n,h),e.cancel=!0,p||f?t.call(this):(0,q.default)({title:"拖动替换",description:"是否替换选中的单元格",confirmFun:t.bind(this)})}},{key:"_afterDragDropBlockCompleted",value:function(e){var t=this.sheet,n=t.guid(),r=e.fromRow,o=e.fromCol,i=e.toRow,a=e.toCol,s=e.rowCount,l=e.colCount,u=e.insert,c=e.oldCells,f=ge.getDragDropRanges(t,je.CellRange,e);this.autoFitRowsAfterCellChanged(U.getAllSelectedCellCoords(t,f),"dragDrop");var d=-1===o,p=-1===r,h=ge.getRowOrColAttrsAfterDragDrop,m=void 0;d?m=h(t,r,i,s,"row",u):p&&(m=h(t,o,a,l,"col",u));var g=(0,W.appendNewCells)(t,c,!0),_=[n,g,r,o,m,this.userID],v={fnName:"dragDropBlock2Cs",params:_};this._composeChange(this._calcOperator(v))}},{key:"_afterAutoFitRowHeightChanged",value:function(e,t){var n=this;this.renderCollab(),this._toggleAddMultiRows();var r=!0,o=t.map(function(e){return[e,n.sheet.getAutoFitRowHeight(e)]}),i=[this.sheet.guid(),e,o],a={fnName:"autoFit2Changeset",params:i},s=this._calcOperator(a,r);s[0]&&this._composeChange(s,r)}},{key:"_afterRowHeightChanged",value:function(e){this.renderCollab(),this._toggleAddMultiRows();var t=this.sheet,n={};r.forEach(e,function(e){n[e]=t.getRowHeight(e)});var o=[this.sheet.guid(),e,n],i={fnName:"rowResize2Changeset",params:o},a=!0,s=this._calcOperator(i,a);this._composeChange(s,a)}},{key:"_afterColumnWidthChanged",value:function(e){this.renderCollab();var t={},n=this.sheet;r.forEach(e,function(e){t[e]=n.getColumnWidth(e)}),this.autoFitRowsAfterColumnChanged(e);var o=[this.sheet.guid(),e,t],i={fnName:"colResize2Changeset",params:o};this._composeChange(this._calcOperator(i))}},{key:"_afterFloatingObjectCuting",value:function(e){var t=e.selectedFloatingObjects,n={},o=this.sheet.floatingObjects;if(r.forEach(t,function(e){"1"===o.get(e).typeName&&(n[e]=null)}),!r.isEmpty(n)){var i={fnName:"tableAttrs2Cs",params:[this.sheet.guid(),this._wrapTableAttrs(n)]},a=this._calcOperator(i);this._composeChange(a)}}},{key:"_afterPictureChanged",value:function(e){var t=e.propertyName,n=e.picture,r=n._ps,o=r.name,i=r.src,a=r.x,s=r.y,l=r.width,u=r.height,c={},f=["location","width"];if(["location","position","width","height"].indexOf(t)>-1){var d=f.indexOf(t)>-1;c[o]=JSON.stringify([i,a,s,l,u]);var p={fnName:"tableAttrs2Cs",params:[this.sheet.guid(),this._wrapTableAttrs(c)]},h=this._calcOperator(p,d);this._composeChange(h,d)}}},{key:"_afterClipboardChanged",value:function(e){var t=e.sheet,n=e.isCutting;this.fromSelections=n?U.getAllSelections(t):null,this.isCutting=n,this.clipboardSheet=t}},{key:"_collabCellsInPasting",value:function(e){var t=this,n=e.cellRange,o=[],i=[];this.isCutting&&r.forEach(this.fromSelections,function(e){for(var n=e.row,r=e.col,i=e.rowCount,a=e.colCount,s=n,l=n+i-1;s<=l;s++)for(var u=r,c=r+a-1;u<=c;u++){var f=(0,W.getCell)(t.clipboardSheet,s,u);o.push([s,u,f])}}),n=U.getActualCellRange(this.sheet,n);for(var a=n.row,s=n.row+n.rowCount-1;a<=s;a++)for(var l=n.col,u=n.col+n.colCount-1;l<=u;l++){var c=(0,W.getCell)(this.sheet,a,l);i.push([a,l,c])}return{cutCellsAry:o,pastedCellAry:i}}},{key:"_afterClipboardPasted",value:function(e){var t=e.cellRange,n=e.parsedPastedData,r=e.pasteData,o=e.cutCellsAry,i=e.pastedCellAry,a=e.oldRowLen,s=e.oldColLen,l=e.fromSheet,u=this.sheet,c=this.isCutting,f=u.guid(),d=[U.getActualCellRange(u,t)],p=[];if(c){var h=this.clipboardSheet.guid(),m=h===u.guid(),g=U.getSheetById(this.spread,h);if(o=(0,W.appendNewCells)(g,o,!0),m)p=o;else{var _=[h,o,this.userID],v={fnName:"editCell2Changeset",params:_};this._composeChange(this._calcOperator(v,!0),!0)}}var y=!0,b=[f,t,{oldRowLen:a,oldColLen:s}],w={fnName:"autoCreateRowOrCol2Cs",params:b},C=this._calcOperator(w,y);this._composeChange(C,y),u._cutCopyIndicatorManager._needPaintIndicator(!1),!n&&r.text&&(n=u.parseText(r.text));var S=U.collabAndApplyPastedCellsValAttrs(u,d[0],i,n,l),x=S.concat(p);this.autoFitRowsAfterPasted(S,p);var T=[f,x,this.userID],E={fnName:"editCell2Changeset",params:T},M=!0;this._composeChange(this._calcOperator(E,M,!0),M)}},{key:"_afterPastedByShortCuts",value:function(){var e=this.sheet.pictures.all(),t={};if(r.forEach(e,function(e){var n=e._ps,r=n.name,o=n.src,i=n.x,a=n.y,s=n.width,l=n.height;if(!r.match(/^picture-\w{16}/)){var u="picture-"+Q.default.genGuid();e.name(u),t[u]=JSON.stringify([o,i,a,s,l])}}),Object.keys(t).length>0){if(this.offline)return ge.offlineTip();var n={fnName:"tableAttrs2Cs",params:[this.sheet.guid(),this._wrapTableAttrs(t)]};this._composeChange(this._calcOperator(n))}}},{key:"_afterFrozenChanged",value:function(e,t){this._asyncSetMenuSelection({freezeSelected:e>0||t>0})}},{key:"_afterHoveredCellChanged",value:function(e){this.hoverCell=e,ve.renderCollabName(this.sheet,e,this.props)}},{key:"_afterSelectedCellChanged",value:function(e){var t=e.row,n=e.col;this.activeCell=e,this._updateCellState(t,n),this._updateCollabState(t,n),Ue&&this._hideQuickActions(),Ye&&(0,k.notifySelectCell)(e,this.sheet)}},{key:"_afterSelectionChanged",value:function(e){var t=U.getActualCellRange(this.sheet,e[0]);this._updateSelectionState(t),this._updateConditionalFormatState(),this.isPainting&&(this.doPaint(),this.keepPaint||this._resetPaint());var n=U.getActiveCell(this.sheet),o=n.row,i=n.col;r.isNil(o)||r.isNil(i)||r.isEqual(n,this.activeCell)||this._afterSelectedCellChanged(n),this._asyncSetMenuSelection({selectionIsMergedCells:U.isMergedCell(this.sheet)}),this._containsLockedCells(this.sheet)}},{key:"_containsLockedCells",value:function(e){this.hasEditPermission&&(0,Ie.isUserLockedInCellRange)(e)?this.props.disableByLockCell():this.props.enableByLockCell()}},{key:"_hideContextMenu",value:function(){this.refs.contextmenu&&this.refs.contextmenu.hide()}},{key:"_afterRangeFiltered",value:function(e,t){var n=this.sheet,o=n.guid(),i=n.rowFilter(),a=i.range,s=a.row,l=a.rowCount,u=U.getRowsText(n,e,s,l),c=r.difference(u,t),f=[o,ge.getSheetAttrs(n,"filter"),e,"fields",c],d={fnName:"updateRangeFilters2Cs",params:f};this._composeChange(this._calcOperator(d)),this.renderCollab()}},{key:"_afterRangeSorted",value:function(e){var t=this.sheet,n=(0,W.appendNewCells)(t,e),r=[t.guid(),n,this.userID],o={fnName:"editCell2Changeset",params:r};this._composeChange(this._calcOperator(o)),this.renderCollab()}},{key:"_newSheet",value:function(e){var t=ge.getNewSheetParams(this.spread.getSheetCount()-1,this.csStoreInst,e),n={moduleName:"multiSheetUtils",fnName:"newSheet",params:t},r=this._calcOperator(n),o=t[0];F.default.setCurrentSheetId(o),this._composeChange(Promise.resolve(function(){return r}))}},{key:"_afterActiveSheetChanged",value:function(e,t){var n=this;this.sheet=window.sheet=t,this.isNewSheet?(this._newSheet(t.name()),t.guid(window.cow.currentSheetId),this._setDefaultStyle(t)):(F.default.setCurrentSheetId(t.guid()),this._needRender()&&this._showLoading(),setTimeout(function(){n._switchSheet(),n._hideLoading()}))}},{key:"_needRender",value:function(){var e=window.cow.currentSheetId;return this.needRenderSheet[e]}},{key:"_switchSheet",value:function(){this._setSortCs(null,!0),this._needRender()?this._resetSheet():Ue&&this._switchActiveSheetIndex(),this.sheet=window.sheet=this.spread.getActiveSheet(),this._toggleAddMultiRows(),this._asyncSetMenuSelection({freezeSelected:U.isSheetFrozened(this.sheet)}),E.default.notify("sheet:switched")}},{key:"_switchActiveSheetIndex",value:function(){var e=this.spread,t=this.csStoreInst.findTableOpIndexByCs(window.cow.currentSheetId,this.sortedCs);e.getActiveSheetIndex()!==t&&(e.setActiveSheetIndex(t),this.sheet=window.sheet=e.getSheet(t))}},{key:"_afterSheetNameChanged",value:function(e){var t={fnName:"tableAttrs2Cs",params:[this.sheet.guid(),{name:e}]};this._composeChange(this._calcOperator(t))}},{key:"_updateConditionalFormatState",value:function(){this._asyncSetMenuSelection({conditionalFormatNumber:this._getConditionalFormat().length})}},{key:"_updateSelectionState",value:function(e){var t=e.row,n=e.col,r=e.rowCount,o=e.colCount;this._asyncSetMenuSelection({selectedCell:[t,n,t+r-1,n+o-1,this.sheet.getActiveColumnIndex()]})}},{key:"_updateCellState",value:function(e,t){this._asyncSetMenuSelection(ge.collabCellMenuState(this.sheet,e,t))}},{key:"_updateCollabState",value:function(e,t){this.props.sendSelectCell({row:e,col:t,endRow:e,endCol:t})}},{key:"_openColDialog",value:function(){var e=this.sheet,t=e.getColumnWidth(U.getCurSelection(e).col),n=_.default.findDOMNode(this.refs.setColSize);this.refs.setColSize.show(),setTimeout(function(){return o(n).find(".set-size-input").val(t).select()})}},{key:"_closeColDialog",value:function(){this.refs.setColSize.close()}},{key:"_openRowDialog",value:function(){var e=this.sheet,t=e.getRowHeight(U.getCurSelection(e).row),n=_.default.findDOMNode(this.refs.setRowSize);this.refs.setRowSize.show(),setTimeout(function(){return o(n).find(".set-size-input").val(t).select()})}},{key:"_closeRowDialog",value:function(){this.refs.setRowSize.close()}},{key:"_showQuickActions",value:function(){var e=U.getActiveCellPosition(this.sheet);this.refs.quickActions.show(e)}},{key:"_hideQuickActions",value:function(){this.refs.quickActions.hide()}},{key:"_lockCellCallback",value:function(){var e=this,t=this.props,n=this.sheet,r=U.getCurSelection(n),o=U.getSelectionsCellLocks(n);if(o.length>1)(0,q.default)({title:"无法操作",description:"当前范围包含多个已存在的单元格锁定，请去锁定工作表侧边栏查看。",confirmLabel:"打开锁定侧边栏",confirmFun:function(){t.toggleLockSidebar(!0)}});else{var i=o[0];i&&U.setSelection(n,i[1].ranges[0]),U.isWorksheetLocked(this.sheet)&&!U.getSheetCellLocks(n).length?(0,q.default)({title:"工作表已锁定",description:"当前工作表已锁定，请先解锁工作表，然后再锁定单元格。",confirmLabel:"解锁工作表并继续",confirmFun:function(){e._unlockSheetImp(n),e._showLockPopup(n,r,i)}}):this._showLockPopup(n,r,i)}}},{key:"_lockSheetCallback",value:function(e){var t=this,n=this.spread.getSheet(e),o=U.getSheetCellLocks(n);o.length?(0,q.default)({title:"单元格已锁定",description:"当前工作表内有锁定单元格，如果要锁定工作表需先解锁该工作表内所有单元格。",confirmLabel:"解锁单元格并继续",confirmFun:function(){var i=[],a=[],s=[];r.forEach(o,function(e){i.push(e[0]),a.push(e[1].ranges[0]),s.push(U.cellRange2LockRange(e[1].ranges[0]).join(" : "))});var l=ge.generateUnlockAllCellAttr(n,i),u=t.props.guid,c=n.name();(0,Ie.historyUnlockCell)(u,c,s),t.applyUnlockAllCellLocks(n,i,a,t.hasEditPermission);var f={fnName:"tableAttrs2Cs",params:[n.guid(),l]};t._composeChange(t._calcOperator(f)),t._showLockPopup(t.spread.getSheet(e))}}):this._showLockPopup(this.spread.getSheet(e))}},{key:"_insertRowOrCol",value:function(e,t){function n(e,t,n){for(var o=t.row,i=t.col,a=t.rowCount,s=t.colCount,l=[],u=o,c=o+a-1;u<=c;u++)for(var f=i,d=i+s-1;f<=d;f++){var p=(0,W.getCell)(e,u,f);l.push([u,f,{},{value:p.value,attrs:r.assign(p.attrs,{userID:n})}])}return l}var o=this.sheet,i=o.guid(),a=U.getCurSelection(o),s=o.getColumnCount(),l=o.getRowCount(),u=U.getSelectionCountForContextmenu(o),c=u.colCount,f=u.rowCount,d="row"===e,p=a[e],h=p,m=void 0,g=ge.getCrossMergeCells(o,[p],e),_=d?f:c;"down"===t||"right"===t?(p+=d?a.rowCount:a.colCount,h=p-1):h+=_;var v=void 0,y=void 0,b=ge.calcCellsBeforeAlterRows(o,l,s,p,_,e),w=r.cloneDeep(o.conditionalFormats._rules);if(d){o.addRows(p,f);var C=o._getActualRowHeight(h),S=[];qe(function(){for(var e=0;e<f;e++){var t=p+e;o.copyToWithoutCellType(h,0,t,0,1,s,je.CopyToOptions.style),C!==Ge&&o.setRowHeight(t,C),S.push(t)}})(),v=S,y=C,m={row:p,col:0,rowCount:f,colCount:s}}else{o.addColumns(p,c);var x=o._getActualColumnWidth(h),T=[];qe(function(){for(var e=0;e<c;e++){var t=p+e;o.copyToWithoutCellType(0,h,0,t,l,1,je.CopyToOptions.style),x!==Ke&&o.setColumnWidth(t,x),T.push(t)}})(),v=T,y=x,m={col:p,row:0,rowCount:l,colCount:c}}this.renderCollab();var E=this._alterLockAfterRowOrColChanged("insert",e,t),M=ge.getModifiedRulesAfterRowOrColChanged(o,w),A=ge.getUpdatedMergeCells(o,g),k=n(o,m,this.userID),R=ge.calcCellsAfterAlterRows(o,b),I=ge.getSheetAttrs(o,"filter"),O=[i,e,v,y,E,M,p,_,A,k,R,I,this.userID],D={fnName:"insertRowOrCol2Cs",params:O};this._composeChange(this._calcOperator(D))}},{key:"_deleteRowOrCol",value:function(e){var t=this.sheet,n=t.guid(),o=t.getColumnCount(),i=t.getRowCount(),a=void 0,s=void 0;"row"===e?(a=r.sortBy(U.getAllSelectedRows(t)),s=t.deleteRows):(a=r.sortBy(U.getAllSelectedColumns(t)),s=t.deleteColumns);var l=ge.calcCellsBeforeRemoveRowsOrCols(t,i,o,a,e),u=ge.alterMergeAfterDeleteRowOrCol(t,a,e),c=ge.getCrossMergeCells(t,a,e),f=r.cloneDeep(t.conditionalFormats._rules);qe(function(){for(var e=0,n=0,r=a.length;n<r;n++)s.call(t,a[n]-e,1),e+=1;u.length>0&&u.forEach(function(e){var n=e.row,r=e.col,o=e.rowCount,i=e.colCount;return t.addSpan(n,r,o,i)})})(),this.renderCollab();var d=this._alterLockAfterRowOrColChanged(n,"remove",e),p=ge.getModifiedRulesAfterRowOrColChanged(t,f),h=ge.getUpdatedMergeCells(t,c),m=ge.calcCellsAfterAlterRows(t,l),g=[n,e,d,u,a,p,h,m,this.userID],_={fnName:"deleteRowOrCol2Cs",params:g};this._composeChange(this._calcOperator(_))}},{key:"_deleteSheet",value:function(e){if(!ge.isDisableOperate(this.saveError,this.offline,this.calcCSQueue.isEmptyQueue())){if(this.actionIndex=e,1===this.spread.getSheetCount())return void Q.default.alert({title:"抱歉，无法删除最后一个sheet",type:"error"});this.refs.delSheetConfirm.show(this.spread.sheets[e].name())}}},{key:"_deleteSheetConfirm",value:function(){var e=this.spread,t=this.actionIndex,n=this.csStoreInst,r=e.getSheet(t).guid();this.spread.removeSheet(t),F.default.setCurrentSheetId(e.getActiveSheet().guid()),this._switchSheet(),this.refs.delSheetConfirm.close();var o=n.getCurDoc(!0),i=n.findTableOpIndexByCs(r,o),a=o.ops[i].getAttributes(),s=[i,a],l={moduleName:"multiSheetUtils",fnName:"deleteSheet",params:s},u=this._calcOperator(l);this._composeChange(Promise.resolve(function(){return u}))}},{key:"_renameSheet",value:function(e){if(!ge.isDisableOperate(this.saveError,this.offline,this.calcCSQueue.isEmptyQueue())){this.actionIndex=e;var t=this.spread.getSheet(e).name();this.refs.renameSheetConfirm.show(t)}}},{key:"_renameSheetConfirm",value:function(e,t){t.preventDefault();var n=this.actionIndex,r=this.csStoreInst,o=this.userID;try{ge.checkSheetName(e);var i=this.spread.getSheet(n);i.name(e);var a=ge.getUpdateSheetNameParams(i.guid(),r,e,o),s={moduleName:"multiSheetUtils",fnName:"updateSheetName",params:a},l=this._calcOperator(s);this._composeChange(Promise.resolve(function(){return l}))}catch(t){var u=t.message||"抱歉，工作表名称有冲突";Q.default.alert({title:u,type:"error"})}finally{this.refs.renameSheetConfirm.close()}}},{key:"_copySheet",value:function(e){var t=this;if(!ge.isDisableOperate(this.saveError,this.offline,this.calcCSQueue.isEmptyQueue())){var n=this.spread,r=this.csStoreInst,o=n.getSheet(e),i=n.getSheet(e+1),a=i?i.guid():null,s=o.toJSON(),l=ge.getCopySheetParams(o.guid(),r,a),u={moduleName:"multiSheetUtils",fnName:"copySheet",params:l},c=this._calcOperator(u),f=d(c,3),p=f[0],h=f[1],m=f[2],g=m.getAttributes().name,_=new je.Worksheet(g,h),v=m.data,y=v.rows,b=v.cols;s.name=g,ge.deleteLockFromSheetJson(s),this.paintWrapAll(function(){_.setRowCount(y.length),_.setColumnCount(b.length),_.fromJSON(s),n.addSheet(e+1,_),n.setActiveSheetIndex(e+1),F.default.setCurrentSheetId(h),s.isLockedByUser&&(_.options.isLockedByUser=!1,_.options.isProtected=!1),t.sheet=window.sheet=n.getSheet(e+1)})(),this._composeChange(Promise.resolve(function(){return p}))}}},{key:"_showConditionalFormat",value:function(){this.refs.conditionalFormat.show(this._getConditionalFormat(),ge.getConditionalFormatSelections(this.sheet))}},{key:"_getConditionalFormat",value:function(){var e=this.sheet,t=ge.getConditionalFormatSelections(e);return U.getConditionFormatsByRanges(e,t)}},{key:"_alterConditionalFormat",value:function(e){var t=this.sheet.guid();qe(j.applyConditionalFormat)(this.sheet,e);var n={fnName:"conditionalFormats2Cs",params:[t,e]};this._composeChange(this._calcOperator(n))}},{key:"_alterConditionalFormatAfterRowOrColChanged",value:function(e){var t=this.sheet;return I.default.conditionalFormats2Cs(t.guid(),ge.getModifiedRulesAfterRowOrColChanged(t,e))}},{key:"_alterLockAfterRowOrColChanged",value:function(){var e=ge.getModifiedLockAfterRowOrColChanged.apply(ge,[this.sheet].concat(Array.prototype.slice.call(arguments)));return this.applyCellLocks(this.sheet,e,this.hasEditPermission),e}},{key:"_onMouseOver",value:function(e){var t=e.pageX,n=e.pageY,r=this.sheet;if(r){var o=U.getCellByOffset(r,t,n),i=o.row,a=o.col,s=this.hoverCell;s&&s.row===i&&s.col===a||this._afterHoveredCellChanged(o)}}},{key:"_onWindowResize",value:function(){this._toggleAddMultiRows()}},{key:"_toggleAddMultiRows",value:function(){var e=this.refs.multiRows,t=this.sheet;!Ue&&this.hasEditPermission&&e&&t&&(U.isVerticalScrollToBottom(t)&&!t.options.isProtected?e.show():e.hide())}},{key:"_addRow",value:function(e){var t=this.sheet,n=t.getRowCount();t.addRows(n,e);var r=[t.guid(),n,e],o={fnName:"addRow2Changeset",params:r};this._composeChange(this._calcOperator(o))}},{key:"_setSpreadFocus",value:function(e){this.spread.focus(e)}},{key:"_handlerDragOrPasteImageToSheet",value:function(e){if(this.sheet.options.isProtected)return this.spread.options.lockCallback();e.count>1&&Q.default.alert({title:"一次只能插入一张图片",delay:3e3}),this.uploadImage(e)}},{key:"_syncIconStyle",value:function(){var e=U.getActiveCell(this.sheet),t=e.row,n=e.col;this._updateCellState(t,n)}},{key:"_mobileDoCopy",value:function(){this.clipboardTouchData=this.sheet._doCopy(!0)}},{key:"_mobileDoPaste",value:function(){var e=this.clipboardTouchData,t=e.copyhtml,n=e.copyText;this.sheet._doPaste({pasteText:n,pasteHtml:t})}},{key:"_mobileDoCut",value:function(){this.clipboardTouchData=this.sheet._doCut(!0)}},{key:"_mobileDoClean",value:function(){this._doDeleteCell()}},{key:"_onUnlock",value:function(e,t){if(this.refs.lockPopup.close(),!U.isSheetExsit(e,this.spread))return Q.default.alert({title:"操作失败，当前工作表不存在！"});t?this._unlockCell(e,t):this._unlockSheet(e)}},{key:"_onLock",value:function(e,t,n,r){if(this.refs.lockPopup.close(),!U.isSheetExsit(e,this.spread))return Q.default.alert({title:"操作失败，当前工作表不存在！"});t?this._lockCell(e,t,n,r):this._lockSheet(e,r)}},{key:"_lockCell",value:function(e,t,n,r){var o=ge.generateLockCellAttr(e,t,n,r),i=this.props.guid,a=e.name();(0,Ie.historyLockCell)(i,a,t,!!n),this.applyCellLocks(e,o,this.hasEditPermission);var s={fnName:"tableAttrs2Cs",params:[e.guid(),o]};this._composeChange(this._calcOperator(s))}},{key:"_unlockCell",value:function(e,t){var n=this;(0,q.default)({title:"解除锁定",description:"解除锁定后，对表格有编辑权限的任何人都可以编辑此范围中的内容，确定解除吗?",confirmFun:function(){var r=t[0],o=ge.generateUnlockCellAttr(e,r),i=n.props.guid,a=e.name(),s=U.cellRange2LockRange(t[1].ranges[0]),l=s[0]+" : "+s[1];(0,Ie.historyUnlockCell)(i,a,l),n.applyCellLocks(e,o,n.hasEditPermission);var u={fnName:"tableAttrs2Cs",params:[e.guid(),o]};n._composeChange(n._calcOperator(u))}})}},{key:"_unlockSheet",value:function(e){var t=this;(0,q.default)({title:"解除锁定",description:"解除锁定后，对表格有编辑权限的任何人都可以编辑此范围中的内容，确定解除吗?",confirmFun:function(){return t._unlockSheetImp(e)}})}},{key:"_unlockSheetImp",value:function(e){var t=ge.generateUnlockSheetAttr(e),n=this.props.guid,r=e.name();(0,Ie.historyUnlockSheet)(n,r),j.applySheetLock(e,null,this.hasEditPermission),this._composeTableAttrsChange(e,t)}},{key:"_lockSheet",value:function(e,t){var n=ge.generateLockSheetAttr(e,t),r=this.props.guid,o=e.name();(0,Ie.historyLockSheet)(r,o,U.isWorksheetLocked(e)),j.applySheetLock(e,n.lock,this.hasEditPermission),this._composeTableAttrsChange(e,n)}},{key:"_composeTableAttrsChange",value:function(e,t){var n={fnName:"tableAttrs2Cs",params:[e.guid(),t]};this._composeChange(this._calcOperator(n))}},{key:"_showLockPopup",value:function(e,t,n){this.refs.lockPopup.show(e,t,n)}},{key:"_enableToolbar",value:function(){o(".lock-sheet-toolbar-mask").css("display","none"),o(".s-head .s-menu-wrap .s-menu").children().css("opacity",1),this._toggleAddMultiRows()}},{key:"_disableToolbar",value:function(){o(".s-head .s-menu-wrap .s-menu").children().css("opacity",.5),o(".lock-sheet-toolbar-mask").css("display","block"),this._toggleAddMultiRows()}},{key:"_passSpread",value:function(e){e&&e(this.spread)}},{key:"_postMessage",value:function(e,t){if(!this.isWebWorkerSupported)return Promise.resolve(function(){return t()});var n=this.props,r=(0,x.v4)();return e.uuid=r,n.disableUndoRedo(),this.calcCSworker.postMessage(e).catch(function(){return function(){return t()}})}},{key:"_wrapPostMessage",value:function(e,t){var n=this;return this._postMessage(e,t).then(function(e){if("function"==typeof e)return e;var t=e.res,r=y.default.unpack(t[0]).ops[0];return function(){return n.csStoreInst.wrapCs([r,t[1]])}}).catch(function(){return n.showSaveDataError()})}},{key:"_showLoading",value:function(){var e=_.default.findDOMNode(this.refs.renderLoading);e&&e.classList.remove("hide")}},{key:"_hideLoading",value:function(){var e=_.default.findDOMNode(this.refs.renderLoading);e&&e.classList.add("hide")}},{key:"render",value:function(){var e=this.props.msg,t=e.userCS,n=e.applyCS,r=(0,S.default)({"sm-sheet-view":!0,"h-view":!0,"is-dingtalk":Q.default.isDingtalk(),"is-vendor-client":(0,M.isClient)()});return m.default.createElement("div",{className:"h-view-wrap",ref:"wrap"},!Ue&&m.default.createElement("div",{ref:"renderLoading",className:"s-render-loading h-view",style:{zIndex:1,textAlign:"center",background:"rgba(255,255,255,.8)"}},m.default.createElement("img",{style:{width:"50px",height:"50px",position:"absolute",top:"50%",marginTop:"-35px"},src:"https://assets-cdn.shimo.im/assets/images/loading-b67e5a67dc.gif"})),m.default.createElement("div",{ref:"hView",className:r}),m.default.createElement("span",{id:"font-container",style:{display:"none"}}),!Ue&&this.hasEditPermission&&m.default.createElement(ee.default,{ref:"contextmenu",sheetInst:this}),m.default.createElement(he.default,{ref:"link",setLink:this.setLink,onClose:this.onDialogClose,onShow:this.onDialogShow}),m.default.createElement(oe.default,{ref:"setRowSize",setRowHeight:this.setRowHeight,onClose:this.onDialogClose,onShow:this.onDialogShow}),m.default.createElement(ae.default,{ref:"setColSize",setColWidth:this.setColWidth,onClose:this.onDialogClose,onShow:this.onDialogShow}),m.default.createElement(le.default,{ref:"delSheetConfirm",deleteSheet:this._deleteSheetConfirm.bind(this)}),m.default.createElement(ce.default,{ref:"renameSheetConfirm",renameSheet:this._renameSheetConfirm.bind(this),onClose:this.onDialogClose,onShow:this.onDialogShow}),m.default.createElement(be.default,{ref:"conditionalFormat",guid:this.props.guid,alterConditionalFormat:this.alterConditionalFormat}),m.default.createElement(ke.default,f({ref:"lockPopup"},this.props,{onUnlock:this.onUnlock,onLock:this.onLock})),"}",m.default.createElement(de.default,{onScroll:this._toggleAddMultiRows.bind(this),afterCellReplaced:this._afterCellValueChanged.bind(this),userCS:t,applyCS:n}),!Ue&&this.hasEditPermission&&m.default.createElement(Te.default,{ref:"multiRows",addRow:this.addRow,onInputFocus:this.onInputFocus}),(Ue||Q.default.isDingtalkPcSidebar())&&m.default.createElement(ne.default,{ref:"quickActions",doCopy:this.mobileDoCopy,doPaste:this.mobileDoPaste,doCut:this.mobileDoCut,doClean:this.mobileDoClean}))}}]),t}(h.Component);t.default=Je,e.exports=t.default}).call(t,n(1),n(2))},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.notifySelectCell=void 0;var o=n(1568),i=r(o);t.notifySelectCell=i.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=e.row,r=e.col,o=a.default.stringifyPosition(n,r),i=t.getText(n,r);(0,l.default)(c.default.SHEET.SELECT_CELL,{row:n,col:r,cellValue:i,stringifyPosition:o})};var o=n(9),i=(r(o),n(53)),a=r(i),s=n(912),l=r(s),u=n(913),c=r(u);e.exports=t.default},function(e,t,n){function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=o(u),f=n(834),d=r(f),p=n(1570),h=o(p),m=n(1044),g=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.state={items:n.getItems.call(e.sheetInst)},n.beforeContextmenuShow=n._beforeContextmenuShow.bind(n),n}return s(t,e),l(t,null,[{key:"propTypes",get:function(){return{sheetInst:u.PropTypes.object}}}]),l(t,[{key:"getItems",value:function(){var e=this;return[[[{key:"copy",display:"复制",callback:function(){return e.spread.commandManager().execute({cmd:"copy",sheetName:e.sheet.name()})}},{key:"paste",display:"粘贴",callback:function(){return e.spread.commandManager().execute({cmd:"paste",sheetName:e.sheet.name()})}},{key:"cut",display:"剪切",className:"separator",callback:function(){return e.spread.commandManager().execute({cmd:"cut",sheetName:e.sheet.name()})}},{key:"insert-before",display:function(){return"向上插入 "+d.getSelectionCountForContextmenu(e.sheet).rowCount+" 行"},callback:function(){return e._insertRowOrCol("row")},disabled:function(){return d.isSelectedColumns(e.sheet)}},{key:"insert-after",display:function(){return"向下插入 "+d.getSelectionCountForContextmenu(e.sheet).rowCount+" 行"},callback:function(){return e._insertRowOrCol("row","down")},disabled:function(){return d.isSelectedColumns(e.sheet)}},{key:"delete-row",display:"删除行",callback:function(){return e._deleteRowOrCol("row")},disabled:function(){return!d.isSelectedRows(e.sheet)||d.isSelectedColumns(e.sheet)}},{key:"set-row",display:"设置行高",className:"separator",callback:function(){return e._openRowDialog()},disabled:function(){return!d.isSelectedRows(e.sheet)||d.isSelectedColumns(e.sheet)}},{key:"insert-left",display:function(){return"在左侧插入 "+d.getSelectionCountForContextmenu(e.sheet).colCount+" 列"},callback:function(){return e._insertRowOrCol("col")},disabled:function(){return d.isSelectedRows(e.sheet)}},{key:"insert-right",display:function(){return"在右侧插入 "+d.getSelectionCountForContextmenu(e.sheet).colCount+" 列"},callback:function(){return e._insertRowOrCol("col","right")},disabled:function(){return d.isSelectedRows(e.sheet)}},{key:"delete-col",display:"删除列",callback:function(){return e._deleteRowOrCol("col")},disabled:function(){return!d.isSelectedColumns(e.sheet)||d.isSelectedRows(e.sheet)}},{key:"set-col",display:"设置列宽",className:"separator",callback:function(){return e._openColDialog()},disabled:function(){return!d.isSelectedColumns(e.sheet)||d.isSelectedRows(e.sheet)}},{key:"merge",display:"合并单元格",className:"separator",callback:function(){return e._mergeOrUnmergeCells()},disabled:function(){return d.getAllSelectedCellCoords(e.sheet).length<=1}},{key:"conditional-format",display:function(){var t=e._getConditionalFormat().length;return c.default.createElement("div",{className:"contextmenu-item-container"},"条件格式",!!t&&c.default.createElement("span",{className:"contextmenu-item-number"},t))},callback:function(){return e._showConditionalFormat()}},{key:"lock-cell",display:function(){var t=d.getSelectionsCellLocks(e.sheet).length;return c.default.createElement("div",{className:"contextmenu-item-container"},t?"锁定/解锁单元格":"锁定单元格",!!t&&c.default.createElement("span",{className:"contextmenu-item-number"},t))},callback:function(){e._lockCellCallback()},disabled:function(){if(e.props.msg.offline)return!0;var t=e.sheet,n=d.getSelectionsCellLocks(t);return!(n.length?(0,m.canEditCellLock)(e.sheet,cow.currentUser,n):(0,m.canEditSheetLock)(e.spread.getActiveSheet(),cow.currentUser))}}],{disabled:function(){var t=e.sheet;return d.hasCellLocks(t)&&(0,m.isUserLockedInCellRange)(t)}}],[[{key:"rename-sheet",display:"重命名",callback:function(t){var n=t.index;return e._renameSheet(n)}},{key:"clone-sheet",display:"创建副本",callback:function(t){var n=t.index;return e._copySheet(n)}},{key:"lock-sheet",display:function(t){var n=t.index;return d.isWorksheetLocked(e.spread.getSheet(n))?"锁定/解锁工作表":"锁定工作表"},callback:function(t){var n=t.index;e._lockSheetCallback(n)},disabled:function(t){var n=t.index;if(e.props.msg.offline)return!0;var r=e.spread.sheets[n],o=d.getSheetCellLocks(r);return!(d.isWorksheetLocked(r)?(0,m.canEditSheetLock)(r,cow.currentUser):(0,m.canEditCellLock)(r,cow.currentUser,o))}},{key:"delete-sheet",display:"删除",callback:function(t){var n=t.index;return e._deleteSheet(n)}}],{disabled:function(t){var n=t.index;return(0,m.isUserLockedInSheet)(e.spread.getSheet(n))}}]]}},{key:"_beforeContextmenuShow",value:function(e){var t=e.pageX,n=e.pageY,r=this.props.sheetInst,o=r.spread,i=r.sheet,a=o.getTab().hitTest(t,n),s=window.innerHeight,l=document.getElementById("null_tabStrip");if("tab"===a.element&&s<n+l.offsetHeight+2)return a;d.selectedCellsByOffset(i,t,n)}},{key:"hide",value:function(){this.refs.contextmenu.hide()}},{key:"render",value:function(){var e=this.state.items;return c.default.createElement(h.default,{ref:"contextmenu",beforeShow:this.beforeContextmenuShow,itemsList:e})}}]),t}(u.Component);t.default=g,e.exports=t.default},function(e,t,n){(function(r){function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(0),f=o(c),d=n(13),p=o(d),h=n(533),m=n(21),g=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.state={open:!1,items:e.itemsList[0][0]},n.onClick=n.onClick.bind(n),n.onContextmenu=n.onContextmenu.bind(n),n.itemMouseOver=n.itemMouseOver.bind(n),n}return s(t,e),u(t,null,[{key:"propTypes",get:function(){return{itemsList:c.PropTypes.array,beforeShow:c.PropTypes.func}}}]),u(t,[{key:"componentDidMount",value:function(){r("body").on("click",this.onClick).on("contextmenu",this.onContextmenu),p.default.findDOMNode(this).setAttribute("gcuielement","sm-contextmenu")}},{key:"componentWillUnmount",value:function(){r("body").off("click",this.onClick).off("contextmenu",this.onContextmenu)}},{key:"onClick",value:function(e){r(e.target).parents(".spread-contextmenu").length||this.hide()}},{key:"onContextmenu",value:function(e){var t=this.props.beforeShow;if(r(e.target).parents("."+h.SHEET_VIEW_CLASSNAME).length){var n=t&&t(e);this.show(e,n)}else this.hide();-3===window.cow.currentFile.type&&e.preventDefault()}},{key:"setPosition",value:function(e){var t=e.pageX,n=e.pageY;this.setState({pageX:t,pageY:n})}},{key:"calcPosition",value:function(e,t){var n=e.pageX,r=e.pageY,o=window,i=o.innerWidth,a=o.innerHeight,s=p.default.findDOMNode(this.refs.contextmenu),l=s.offsetHeight,u=s.offsetWidth;if(t){var c=document.getElementById("null_tabStrip"),f=c.offsetHeight;n=t.position,r=a-f-l}else n+u>i&&(n-=u),r+l>a&&(r-=r<l?l/2:l);return{pageX:n,pageY:r}}},{key:"show",value:function(e,t){var n=l(this.props.itemsList,2),r=l(n[0],2),o=r[0],i=r[1],a=l(n[1],2),s=a[0],u=a[1];this.setState({open:!0,items:t?s:o,hitTab:t,cfg:t?u:i}),this.setPosition(this.calcPosition(e,t))}},{key:"hide",value:function(){this.setState({open:!1})}},{key:"itemClick",value:function(){this.hide()}},{key:"itemMouseOver",value:function(e){var t=e.nativeEvent.target,n=t.textContent;if("锁定工作表"!==n&&"锁定单元格"!==n||(0,m.isEnterprise)(cow.currentUser))this.refs.tip.style.display="none";else{"SPAN"===t.tagName&&(t=t.parentNode);var r=this.refs.tip.style;r.display="block";var o=t.offsetHeight,i=t.offsetLeft,a=o+42,s=i+182;"锁定单元格"===n&&(s=i+182,a=o+376),r.top=a+"px",r.left=s+"px"}}},{key:"getListItems",value:function(){var e=this,t=this.state,n=t.open,r=t.items,o=t.hitTab,i=t.cfg,a=o?{index:o.index}:null,s=function(e){var t=!(!i||!i.disabled)&&i.disabled(a);return n&&(t||e&&e(a))};return r.map(function(t,n){var r=t.display,i=(t.key,t.className),l=t.callback,u=t.disabled,c=s(u),d="spread-contextmenu-item "+(i||"")+" "+(c?"disabled":"");return f.default.createElement("li",{key:n,onClick:function(){!c&&l&&l(o),e.itemClick()},className:d,onMouseOver:e.itemMouseOver},"function"==typeof r?r(a):r)})}},{key:"render",value:function(){var e=this.state,t=e.open,n=e.hitTab,r=e.pageX,o=e.pageY,i=n?"tab-menu":"";return f.default.createElement("div",{ref:"contextmenu",className:"spread-contextmenu "+i+" "+(t?"":"hidden"),style:{left:r,top:o}},f.default.createElement("ul",{className:"spread-contextmenu-list"},t&&this.getListItems()),f.default.createElement("div",{ref:"tip",className:"s-tooltip spread-contextmenu-tip"},"企业版功能"))}}]),t}(c.Component);t.default=g,e.exports=t.default}).call(t,n(2))},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=r(u),f=n(13),d=r(f),p=n(20),h=r(p),m=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={visible:!1},n.doCopy=n._doCopy.bind(n),n.doPaste=n._doPaste.bind(n),n.doCut=n._doCut.bind(n),n.doClean=n._doClean.bind(n),n.showPaste=!1,n.isCut=!1,n}return a(t,e),l(t,null,[{key:"propTypes",get:function(){return{doCopy:u.PropTypes.func,doPaste:u.PropTypes.func,doCut:u.PropTypes.func,doClean:u.PropTypes.func}}}]),l(t,[{key:"hide",value:function(){this.setState({visible:!1})}},{key:"show",value:function(e){var t=this._getPos(e);this.setState(s({visible:!0},t))}},{key:"_doCopy",value:function(){var e=this.props.doCopy;this.hide(),this.showPaste=!0,this.isCut=!1,e&&e()}},{key:"_doPaste",value:function(){var e=this.props.doPaste;this.hide(),this.isCut&&(this.showPaste=!1),e&&e()}},{key:"_doCut",value:function(){var e=this.props.doCut;this.hide(),this.showPaste=!0,this.isCut=!0,e&&e()}},{key:"_doClean",value:function(){var e=this.props.doClean;this.hide(),e&&e()}},{key:"_getPos",value:function(e){var t=90,n=e.x,r=e.y,o=e.width,i=e.height,a=n+o/2,s=d.default.findDOMNode(this),l=s.offsetWidth,u=s.offsetHeight,c=document.documentElement.clientWidth,f=r-u+t-10,p=a-l/2,h=!1,m="";return r<u+30&&(h=!0,f=r+i+t+10),p<20&&(p=20,m="arrow_left"),p+l>c&&(p=c-l-40,m="arrow_right"),{top:f,left:p,down:h,arrowPos:m}}},{key:"render",value:function(){var e=this.state,t=e.top,n=e.left,r=e.down,o=e.visible,i=e.arrowPos,a={visibility:o?"visible":"hidden",top:t+"px",left:n+"px"},s=(0,h.default)({"quick-actions":!0,down:r},i);return c.default.createElement("div",{style:a,className:s},c.default.createElement("ul",null,c.default.createElement("li",{onClick:this.doCut},"剪切"),c.default.createElement("li",{onClick:this.doCopy},"复制"),this.showPaste?c.default.createElement("li",{onClick:this.doPaste},"粘贴"):null,c.default.createElement("li",{onClick:this.doClean},"清除")))}}]),t}(u.Component);t.default=m,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(54),f=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"_rowDialogBodyTpl",value:function(){return u.default.createElement("div",{className:"size-dialog-body row-dialog"},u.default.createElement("span",{className:"s-d-label"},"行高",u.default.createElement("span",{className:"s-d-label-info"},"(默认值:22)")),u.default.createElement("form",{className:"s-d-form",onSubmit:this.props.setRowHeight},u.default.createElement("input",{type:"text",className:"set-size-input sm-form-control",defaultValue:22})))}},{key:"show",value:function(){this.refs.dialog.show()}},{key:"close",value:function(){this.refs.dialog.close()}},{key:"render",value:function(){var e=[{customClass:"set-size-btn btn btn-ok",onTap:this.props.setRowHeight,label:"确定"},{customClass:"bind-cancel",label:"取消"}];return u.default.createElement(c.Dialog,{customClass:"set-size-dialog",onClose:this.props.onClose,onShow:this.props.onShow,ref:"dialog",title:"设置行高",bodyTpl:this._rowDialogBodyTpl.bind(this),actions:e})}}],[{key:"propTypes",get:function(){return{setRowHeight:l.PropTypes.func,onShow:l.PropTypes.func,onClose:l.PropTypes.func}}}]),t}(l.Component);t.default=f,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(54),f=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"_colDialogBodyTpl",value:function(){return u.default.createElement("div",{className:"size-dialog-body col-dialog"},u.default.createElement("span",{className:"s-d-label"},"列宽",u.default.createElement("span",{className:"s-d-label-info"},"(默认值:100)")),u.default.createElement("form",{className:"s-d-form",onSubmit:this.props.setColWidth},u.default.createElement("input",{type:"text",className:"set-size-input sm-form-control",defaultValue:100})))}},{key:"show",value:function(){this.refs.dialog.show()}},{key:"close",value:function(){this.refs.dialog.close()}},{key:"render",value:function(){var e=[{customClass:"set-size-btn btn btn-ok",onTap:this.props.setColWidth,label:"确定"},{customClass:"bind-cancel",label:"取消"}];return u.default.createElement(c.Dialog,{customClass:"set-size-dialog",onClose:this.props.onClose,onShow:this.props.onShow,ref:"dialog",title:"设置列宽",bodyTpl:this._colDialogBodyTpl.bind(this),actions:e})}}],[{key:"propTypes",get:function(){return{setColWidth:l.PropTypes.func,onShow:l.PropTypes.func,onClose:l.PropTypes.func}}}]),t}(l.Component);t.default=f,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(54),f=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"_deleteSheetDialogTpl",value:function(){return u.default.createElement("div",{className:"delete-sheet-dialog-desc"},"确认要删除 “",this.state.name,"” 吗？")}},{key:"show",value:function(e){this.setState({name:e}),this.refs.dialog.show()}},{key:"close",value:function(){this.refs.dialog.close()}},{key:"render",value:function(){var e=this.props,t=[{customClass:"delete-sheet-btn btn btn-ok",onTap:e.deleteSheet,label:"确认"},{customClass:"bind-cancel",label:"取消"}];return u.default.createElement(c.Dialog,{ref:"dialog",customClass:"delete-sheet-dialog",title:"删除工作表",bodyTpl:this._deleteSheetDialogTpl.bind(this),actions:t})}}]),t}(l.Component);t.default=f,f.propTypes={deleteSheet:l.PropTypes.func},e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(54),f=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n.handleChange=n._handleChange.bind(n),n}return a(t,e),s(t,[{key:"_renameSheetDialogTpl",value:function(){return u.default.createElement("div",{className:"size-dialog-body row-dialog"},u.default.createElement("form",{className:"s-d-form",onSubmit:this.props.renameSheet.bind(this,this.state.name)},u.default.createElement("input",{type:"text",className:"set-size-input sm-form-control",value:this.state.name,onChange:this.handleChange})))}},{key:"_handleChange",value:function(e){this.setState({name:e.target.value})}},{key:"show",value:function(e){this.setState({name:e}),this.refs.dialog.show()}},{key:"close",value:function(){this.refs.dialog.close()}},{key:"render",value:function(){var e=this.props,t=[{customClass:"delete-sheet-btn btn btn-ok",onTap:e.renameSheet.bind(this,this.state.name),label:"确认"},{customClass:"bind-cancel",label:"取消"}];return u.default.createElement(c.Dialog,{ref:"dialog",customClass:"set-size-dialog",onClose:this.props.onClose,onShow:this.props.onShow,title:"重命名",bodyTpl:this._renameSheetDialogTpl.bind(this),actions:t})}}]),t}(l.Component);t.default=f,f.propTypes={renameSheet:l.PropTypes.func.isRequired},e.exports=t.default},function(e,t,n){(function(r){function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=o(u),f=n(54),d=function(e){function t(){i(this,t);var e=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={visible:!1},e.confirm=e.confirm.bind(e),e.close=e.close.bind(e),e.bodyTpl=e.bodyTpl.bind(e),e}return s(t,e),l(t,null,[{key:"propTypes",get:function(){return{setLink:u.PropTypes.func,link:u.PropTypes.object,onShow:u.PropTypes.func,onClose:u.PropTypes.func}}}]),l(t,[{key:"bodyTpl",value:function(){var e=this.state.link,t=e.url,n=e.text,r=e.stringifyPos;return c.default.createElement("div",{className:"link-dialog-body row-dialog"},c.default.createElement("div",{className:"link-dialog-title"},"给单元格",c.default.createElement("b",null,r),"设置链接："),c.default.createElement("div",{className:"link-dialog-item"},c.default.createElement("div",{className:"link-dialog-item-title"},"地址"),c.default.createElement("input",{className:"link-dialog-item-input",ref:"url",defaultValue:t})),c.default.createElement("div",{className:"link-dialog-item"},c.default.createElement("div",{className:"link-dialog-item-title"},"文本"),c.default.createElement("input",{className:"link-dialog-item-input",ref:"text",defaultValue:n})))}},{key:"show",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.url,n=e.text,r=e.stringifyPos;this.oldData={url:t,text:n,stringifyPos:r},this.setState({link:e,visible:!0})}},{key:"close",value:function(){this.setState({visible:!1})}},{key:"confirm",value:function(){var e=this.props.setLink,t=this.refs.dialog.refs,n={stringifyPos:this.state.link.stringifyPos};["url","text"].map(function(e){n[e]=t[e].value}),r.isEqual(n,this.oldData)||e&&e(n),this.close()}},{key:"render",value:function(){var e=this.state.visible,t=[{customClass:"set-size-btn btn btn-ok",onTap:this.confirm,label:"确定"},{customClass:"bind-cancel",onTap:this.close,label:"取消"}];return c.default.createElement(f.Dialog,{customClass:"set-link-dialog",open:e,onClose:this.props.onClose,onShow:this.props.onShow,ref:"dialog",title:"设置链接",bodyTpl:this.bodyTpl,actions:t})}}]),t}(u.Component);t.default=d,e.exports=t.default}).call(t,n(1))},function(e,t,n){(function(r){function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(0),f=o(c),d=n(54),p=n(1578),h=o(p),m=n(5),g=o(m),_=n(910),v=o(_),y=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={rules:[]},n.sortIndex=0,n.show=n.show.bind(n),n.headTpl=n.headTpl.bind(n),n.bodyTpl=n.bodyTpl.bind(n),n.footTpl=n.footTpl.bind(n),n.addNewRule=n.addNewRule.bind(n),n.deleteRule=n.deleteRule.bind(n),n.alterRule=n.alterRule.bind(n),n.confirm=n.confirm.bind(n),n.close=n.close.bind(n),n.defaultColors=["#e88080","#f59869","#f2e085","#97cfae","#86ced9","#87bce0","#9984af","#f8d0d0","#fcdecf","#fdf2c7","#dff0e6","#ceedf2","#d2eafa","#e4ddeb","#bf3030","#d1622a","#cc8800","#53996f","#30a1b3","#3e82b0","#604080"],n}return s(t,e),u(t,null,[{key:"propTypes",get:function(){return{guid:c.PropTypes.string,alterConditionalFormat:c.PropTypes.func}}}]),u(t,[{key:"headTpl",value:function(e){return f.default.createElement("div",null,e,f.default.createElement("span",{className:"hicon icon-close conditional-format-close",onClick:this.close}))}},{key:"bodyTpl",value:function(){var e=this,t=this.state.rules;return f.default.createElement("div",{className:"conditional-format-list"},t.map(function(t,n){return f.default.createElement(h.default,l({key:t.guid,index:n,deleteRule:e.deleteRule,alterRule:e.alterRule},t))}),!t.length&&f.default.createElement("div",{className:"condition-list-empty"}))}},{key:"footTpl",value:function(){return f.default.createElement("div",{className:"conditional-format-footer"},f.default.createElement("span",{className:"conditional-format-add",onClick:this.addNewRule},"添加新规则"),f.default.createElement("button",{className:"btn btn-ok",onClick:this.confirm},"确定"))}},{key:"show",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1];this.rules=e.map(function(e){return r.extend({},e)}),this.selections=t,e=this._sortRulesByIndex(e);var n=e.length;!n&&(e=[this._genNewRule(n)]),this.setState({rules:e}),this.refs.dialog.show()}},{key:"close",value:function(){this.refs.dialog.close()}},{key:"confirm",value:function(){var e=this.props.alterConditionalFormat;e&&e(this._getModifiedRules()),this.close()}},{key:"_sortRulesByIndex",value:function(e){return e.sort(function(e,t){return e.sortIndex-t.sortIndex})}},{key:"_genNewRule",value:function(e){return this.sortIndex=Math.max(this.sortIndex,this._getLastRuleIndex())+1,{selections:this.selections,ruleType:"equalsTo",value:"",background:this.defaultColors[(r.isNil(e)?this.state.rules.length:e)%this.defaultColors.length],guid:g.default.genGuid(),sortIndex:this.sortIndex}}},{key:"_getLastRuleIndex",value:function(){var e=v.default.getInst({guid:this.props.guid}),t=e.getTableOpAttrs(window.cow.currentSheetId),n=0;return r.forIn(t,function(e,t){t.match(/^condition-format-\w{16}/)&&(e=JSON.parse(e),n=Math.max(n,e?e.sortIndex:0))}),n}},{key:"_getModifiedRules",value:function(){var e=this.rules,t=this.state.rules,n={};return r.forEach(e,function(e){var o=e.guid;-1===r.findIndex(t,["guid",o])&&(n["condition-format-"+o]=null)}),r.forEach(t,function(t){var o=r.find(e,["guid",t.guid]);(!o||o&&!r.isEqual(o,t))&&(n["condition-format-"+t.guid]=t)}),n}},{key:"addNewRule",value:function(){this.setState({rules:this.state.rules.concat([this._genNewRule()])})}},{key:"deleteRule",value:function(e){var t=this.state.rules;t.splice(e,1),this.setState({rules:t})}},{key:"alterRule",value:function(e,t,n){var r=this.state.rules;r[e][t]=n,this.setState({rules:r})}},{key:"render",value:function(){return f.default.createElement(d.Dialog,{ref:"dialog",title:"条件格式",customClass:"conditional-format-dialog",hasActions:!1,keepCenter:!0,headTpl:this.headTpl,bodyTpl:this.bodyTpl,footTpl:this.footTpl})}}]),t}(c.Component);t.default=y,e.exports=t.default}).call(t,n(1))},function(e,t,n){(function(r){function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=o(u),f=n(1579),d=o(f),p=n(1580),h=o(p),m=n(271),g=o(m),_=n(53),v=o(_),y=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n.range=n._convertSelectionsToString(n.props.selections),n.ruleItems=[{display:"等于",value:"equalsTo"},{display:"大于",value:"greaterThan"},{display:"小于",value:"lessThan"},{display:"介于",value:"between"},{display:"文字包含",value:"contains"}],n.deleteRule=n._deleteRule.bind(n),n.ruleTypeChange=n._ruleTypeChange.bind(n),n.backgroundChange=n._backgroundChange.bind(n),n.valueChange=n._valueChange.bind(n),n}return s(t,e),l(t,null,[{key:"propTypes",get:function(){return{index:u.PropTypes.number,selections:u.PropTypes.array,ruleType:u.PropTypes.string,value:u.PropTypes.string,value2:u.PropTypes.string,background:u.PropTypes.string,deleteRule:u.PropTypes.func,alterRule:u.PropTypes.func}}}]),l(t,[{key:"_ruleTypeChange",value:function(e){var t=this.props;(0,t.alterRule)(t.index,"ruleType",e)}},{key:"_backgroundChange",value:function(e){var t=this.props;(0,t.alterRule)(t.index,"background",e)}},{key:"_valueChange",value:function(e){var t=this.props,n=t.alterRule,r=t.index,o=e.target;n(r,o.className.indexOf("condition-item-value2")>-1?"value2":"value",o.value)}},{key:"_deleteRule",value:function(){var e=this.props,t=e.deleteRule,n=e.index;t&&t(n)}},{key:"_convertSelectionsToString",value:function(e){var t=v.default.stringifyPosition,n=[];return r.forEach(e,function(e){var r=e.row,o=e.col,i=e.rowCount,a=e.colCount;n.push(t(r,o)+":"+t(r+i-1,o+a-1))}),n.join(", ")}},{key:"render",value:function(){var e=this.props,t=e.index,n=e.ruleType,r=e.value,o=e.background,i=e.value2,a="between"===n,s="contains"===n,l=s?"请输入文字":"请输入数值";return a&&(l=""),c.default.createElement("div",{className:"condition-item"},c.default.createElement("div",{className:"condition-item-title"},"规则 ",t+1),c.default.createElement("span",{className:"condition-item-delete hicon icon-delete",onClick:this.deleteRule}),c.default.createElement("div",{className:"condition-item-content"},c.default.createElement(g.default,{title:this.range,placement:"bottom"},c.default.createElement("div",{className:"condition-item-input condition-range"},this.range)),c.default.createElement(d.default,{ruleTypes:this.ruleItems,onChange:this.ruleTypeChange,defaultType:n}),c.default.createElement("input",{onInput:this.valueChange,placeholder:l,className:"condition-item-value "+(a?"condition-item-value1":""),defaultValue:r}),a&&c.default.createElement("div",{className:"condition-item-contains"},c.default.createElement("span",{className:"condition-item-contains-line"}),c.default.createElement("input",{onInput:this.valueChange,placeholder:l,className:"condition-item-value condition-item-value2",defaultValue:i})),c.default.createElement(h.default,{onChange:this.backgroundChange,color:o})))}}]),t}(u.Component);t.default=y,e.exports=t.default}).call(t,n(1))},function(e,t,n){(function(r){function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=o(u),f=n(728),d=o(f),p=n(729),h=o(p),m=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={activeIndex:n._getActiveIndex(n.props.defaultType)},n.menuClick=n.menuClick.bind(n),n}return s(t,e),l(t,null,[{key:"propTypes",get:function(){return{ruleTypes:u.PropTypes.array,onChange:u.PropTypes.func,defaultType:u.PropTypes.string}}}]),l(t,[{key:"_getActiveIndex",value:function(e){var t=r.findIndex(this.props.ruleTypes,function(t){var n=t.value;return e===n});return Math.max(t,0)}},{key:"menuClick",value:function(e){var t=e.key;this.setState({activeIndex:this._getActiveIndex(t)}),this.props.onChange(t)}},{key:"ruleMenu",value:function(){var e=this.props.ruleTypes[this.state.activeIndex];return c.default.createElement(d.default,{onClick:this.menuClick},this.props.ruleTypes.map(function(t){var n=t.display,r=t.value,o=r===e.value;return c.default.createElement(d.default.Item,{key:r},n,o&&c.default.createElement("span",{className:"rule-item-selected-icon s-toolbar-icon format-menu-item-selected-icon"}))}))}},{key:"render",value:function(){var e=this.state.activeIndex,t=this.props.ruleTypes[e];return c.default.createElement(h.default,{className:"condition-rule-dropdown",placement:"bottomCenter",overlay:this.ruleMenu()},c.default.createElement("div",{className:"condition-rule condition-item-input",ref:"display"},t.display))}}]),t}(u.Component);t.default=m,e.exports=t.default}).call(t,n(1))},function(e,t,n){(function(r){function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=o(u),f=n(1461),d=o(f),p=n(1463),h=o(p),m=n(256),g=o(m),_=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={popoverVisible:!1,color:n.props.color},n.onBackgroundClick=n._onBackgroundClick.bind(n),n.backgroundChange=n._backgroundChange.bind(n),n.componentClick=n.componentClick.bind(n),n}return s(t,e),l(t,null,[{key:"propTypes",get:function(){return{onChange:u.PropTypes.func,color:u.PropTypes.string}}}]),l(t,[{key:"componentClick",value:function(e){r(e.target).hasClass("color-picker-input")||this.state.popoverVisible&&this.setState({popoverVisible:!1})}},{key:"_onBackgroundClick",value:function(){this.setState({popoverVisible:!this.state.popoverVisible})}},{key:"_backgroundChange",value:function(e){var t=this.props.onChange;t&&t(e),this.setState({color:e,popoverVisible:!1})}},{key:"render",value:function(){var e=this.state,t=e.color,n=e.popoverVisible;return c.default.createElement(d.default,{trigger:"click",placement:"bottom",color:t,visible:n,arrowPointAtCenter:!1,onSelect:this.backgroundChange,colors:(0,h.default)("background")},c.default.createElement("div",{className:"condition-item-input condition-background",onClick:this.onBackgroundClick,style:{background:t}},"背景颜色"))}}]),t}(u.Component);t.default=(0,g.default)(_),e.exports=t.default}).call(t,n(2))},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=r(u),f=n(275),d=r(f),p=n(1582),h=r(p),m=n(1583),g=r(m);n(1584);var _=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={color:e.color},n.onColorChange=n.onColorChange.bind(n),n}return a(t,e),l(t,null,[{key:"propTypes",get:function(){return{prefixCls:u.PropTypes.string,placement:u.PropTypes.string,colors:u.PropTypes.arrayOf(u.PropTypes.shape({name:u.PropTypes.string,value:u.PropTypes.string.isRequired})).isRequired,columnCount:u.PropTypes.number,enableCustom:u.PropTypes.bool,color:u.PropTypes.string,onInvalidate:u.PropTypes.func,onSelect:u.PropTypes.func,arrowPointAtCenter:u.PropTypes.bool,defaultColor:u.PropTypes.string,colorInputPlaceholder:u.PropTypes.string}}},{key:"defaultProps",get:function(){return{placement:"bottom",columnCount:9,colors:[],color:"#41464b",enableCustom:!0,arrowPointAtCenter:!0,onInvalidate:function(){},onSelect:function(){},colorInputPlaceholder:"无填充",defaultColor:""}}}]),l(t,[{key:"componentWillReceiveProps",value:function(e){e.color.toUpperCase()!==this.state.color.toUpperCase()&&this.setState({color:e.color})}},{key:"onColorChange",value:function(e,t){e.toUpperCase()!==this.state.color.toUpperCase()&&this.setState({color:e}),this.props.onSelect(e,t)}},{key:"renderContent",value:function(){var e=this.props,t=e.colors,n=e.columnCount,r=e.onInvalidate;return c.default.createElement("div",null,c.default.createElement(h.default,{columnCount:n,onSelect:this.onColorChange,colors:t}),c.default.createElement(g.default,{color:this.state.color,colorInputPlaceholder:this.props.colorInputPlaceholder,defaultColor:this.props.defaultColor,onChange:this.onColorChange,onInvalidate:r}))}},{key:"renderTrigger",value:function(){var e=this.props.children;if(e){var t=c.default.Children.map(e,function(e){return c.default.cloneElement(e)});if(1===t.length)return c.default.cloneElement(t[0]);if(t.length>1)return c.default.createElement("div",null,t)}return c.default.createElement("button",{style:{width:"100px"}},"color picker")}},{key:"render",value:function(){return c.default.createElement(d.default,s({},this.props,{innerClass:"sm-color-picker",content:this.renderContent()}),this.renderTrigger())}}]),t}(u.Component);t.default=_,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1462),f=r(c),d=function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={selectColor:{}},e.handleColorItemClick=e.handleColorItemClick.bind(e),e}return a(t,e),s(t,null,[{key:"propTypes",get:function(){return{colors:l.PropTypes.array,onSelect:l.PropTypes.func,onWillChange:l.PropTypes.func,columnCount:l.PropTypes.number}}},{key:"defaultProps",get:function(){return{colors:[],onSelect:function(){},onWillChange:function(){}}}}]),s(t,[{key:"handleColorItemClick",value:function(e,t){var n=this.props,r=n.onSelect,o=n.onWillChange;r(e,t),o(this.state.selectColor,{value:e,name:t})}},{key:"renderColorItems",value:function(){var e=this;return this.props.colors.map(function(t,n){return""===t.value||/^\#[0-9a-f]{3}([0-9a-f]{3})?$/i.test(t.value)?u.default.createElement("li",{key:n,className:"color-picker-list-item"},u.default.createElement(f.default,{name:t.name,value:t.value,onClick:e.handleColorItemClick})):null})}},{key:"render",value:function(){var e=this.props,t=e.colors,n=e.columnCount,r={};return t.length>n&&(r.width=19*n+"px"),u.default.createElement("ul",{className:"color-picker-list",style:r},this.renderColorItems())}}]),t}(l.Component);t.default=d,e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1462),f=r(c),d=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={color:n.clearSharp(e.color)},n.onChange=n.onChange.bind(n),n.onKeyUp=n.onKeyUp.bind(n),n.onBlur=n.onBlur.bind(n),n.onColorClick=n.onColorClick.bind(n),n}return a(t,e),s(t,null,[{key:"propTypes",get:function(){return{color:l.PropTypes.string,defaultColor:l.PropTypes.string,onChange:l.PropTypes.func,onInvalidate:l.PropTypes.func,colorInputPlaceholder:l.PropTypes.string}}},{key:"defaultProps",get:function(){return{color:"",onChange:function(){},onInvalidate:function(){},colorInputPlaceholder:"无填充",defaultColor:""}}}]),s(t,[{key:"componentWillReceiveProps",value:function(e){var t=this.clearSharp(e.color);t.toUpperCase()!==this.state.color.toUpperCase()&&this.setState({color:t})}},{key:"onChange",value:function(e){var t=e.target.value;t=t.replace(/[^a-f0-9A-F]/g,""),this.setState({color:t})}},{key:"onKeyUp",value:function(e){13===e.keyCode&&e.target.blur()}},{key:"onBlur",value:function(e){var t="#"+(e.target.value||this.clearSharp(this.props.defaultColor));this.checkColor(t)?t.toUpperCase()!==this.props.color.toUpperCase()?this.props.onChange(t):this.setState({color:t}):"无填充"!==this.props.colorInputPlaceholder||e.target.value?this.props.onChange(this.correctColor(t,!0)):this.props.onChange("")}},{key:"onColorClick",value:function(){this.refs.colorInput.focus(),this.refs.colorInput.select()}},{key:"checkColor",value:function(e){return""===e||/^\#[0-9a-f]{3}([0-9a-f]{3})?$/i.test(e)}},{key:"clearSharp",value:function(e){return e.replace("#","")}},{key:"correctColor",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e=this.clearSharp(e),!this.checkColor("#"+e)){for(var n=[0,0,0,0,0,0],r=0;r<e.length;r++)n[6-e.length+r]=e[r];e=n.join("")}return t&&(e="#"+e),e}},{key:"render",value:function(){var e=this.clearSharp(this.state.color),t={visibility:e?"":"hidden"},n=e?this.correctColor(e,!0):this.clearSharp(this.props.defaultColor);return u.default.createElement("div",{className:"color-picker-input-wrap"},u.default.createElement(f.default,{value:n,onClick:this.onColorClick}),u.default.createElement("label",{className:"color-sharp-label",style:t},"#"),u.default.createElement("input",{type:"text",ref:"colorInput",value:e,placeholder:this.props.colorInputPlaceholder,onChange:this.onChange,onKeyUp:this.onKeyUp,onBlur:this.onBlur,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:"false",maxLength:6,className:"color-picker-input"}))}}]),t}(l.Component);t.default=d,e.exports=t.default},function(e,t){},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(){function e(e){return new Promise(function(t,r){var o=e.uuid;o?(a.default.attach(o,function(e){a.default.detach(o),t(e)}),n.postMessage(e),setTimeout(r,6e4)):(n.postMessage(e),t())})}function t(){n.terminate()}var n=new l.default;return n.onmessage=function(e){var t=e.data;a.default.notify(t.uuid,t)},n.onerror=function(e){console.dir(e)},{postMessage:e,stop:t}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var i=n(9),a=r(i),s=n(1586),l=r(s);e.exports=t.default},function(e,t,n){e.exports=function(){return n(1440)('!function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n={};e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="https://assets-cdn.shimo.im/assets/scripts/",e(e.s=18)}([function(t,e,n){(function(t,r){var i;(function(){function o(t,e){return t.set(e[0],e[1]),t}function a(t,e){return t.add(e),t}function u(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function s(t,e,n,r){for(var i=-1,o=null==t?0:t.length;++i<o;){var a=t[i];e(r,a,n(a),t)}return r}function c(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&!1!==e(t[n],n,t););return t}function l(t,e){for(var n=null==t?0:t.length;n--&&!1!==e(t[n],n,t););return t}function f(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(!e(t[n],n,t))return!1;return!0}function p(t,e){for(var n=-1,r=null==t?0:t.length,i=0,o=[];++n<r;){var a=t[n];e(a,n,t)&&(o[i++]=a)}return o}function h(t,e){return!!(null==t?0:t.length)&&F(t,e,0)>-1}function d(t,e,n){for(var r=-1,i=null==t?0:t.length;++r<i;)if(n(e,t[r]))return!0;return!1}function y(t,e){for(var n=-1,r=null==t?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}function m(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}function g(t,e,n,r){var i=-1,o=null==t?0:t.length;for(r&&o&&(n=t[++i]);++i<o;)n=e(n,t[i],i,t);return n}function v(t,e,n,r){var i=null==t?0:t.length;for(r&&i&&(n=t[--i]);i--;)n=e(n,t[i],i,t);return n}function _(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}function b(t){return t.split("")}function M(t){return t.match(Be)||[]}function w(t,e,n){var r;return n(t,function(t,n,i){if(e(t,n,i))return r=n,!1}),r}function x(t,e,n,r){for(var i=t.length,o=n+(r?1:-1);r?o--:++o<i;)if(e(t[o],o,t))return o;return-1}function F(t,e,n){return e===e?X(t,e,n):x(t,D,n)}function S(t,e,n,r){for(var i=n-1,o=t.length;++i<o;)if(r(t[i],e))return i;return-1}function D(t){return t!==t}function k(t,e){var n=null==t?0:t.length;return n?O(t,e)/n:Ht}function E(t){return function(e){return null==e?it:e[t]}}function C(t){return function(e){return null==t?it:t[e]}}function T(t,e,n,r,i){return i(t,function(t,i,o){n=r?(r=!1,t):e(n,t,i,o)}),n}function N(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}function O(t,e){for(var n,r=-1,i=t.length;++r<i;){var o=e(t[r]);o!==it&&(n=n===it?o:n+o)}return n}function A(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}function j(t,e){return y(e,function(e){return[e,t[e]]})}function P(t){return function(e){return t(e)}}function I(t,e){return y(e,function(e){return t[e]})}function H(t,e){return t.has(e)}function L(t,e){for(var n=-1,r=t.length;++n<r&&F(e,t[n],0)>-1;);return n}function R(t,e){for(var n=t.length;n--&&F(e,t[n],0)>-1;);return n}function $(t,e){for(var n=t.length,r=0;n--;)t[n]===e&&++r;return r}function z(t){return"\\\\"+nr[t]}function W(t,e){return null==t?it:t[e]}function B(t){return Gn.test(t)}function q(t){return Jn.test(t)}function U(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}function Y(t){var e=-1,n=Array(t.size);return t.forEach(function(t,r){n[++e]=[r,t]}),n}function G(t,e){return function(n){return t(e(n))}}function J(t,e){for(var n=-1,r=t.length,i=0,o=[];++n<r;){var a=t[n];a!==e&&a!==ft||(t[n]=ft,o[i++]=n)}return o}function V(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=t}),n}function K(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=[t,t]}),n}function X(t,e,n){for(var r=n-1,i=t.length;++r<i;)if(t[r]===e)return r;return-1}function Z(t,e,n){for(var r=n+1;r--;)if(t[r]===e)return r;return r}function Q(t){return B(t)?et(t):_r(t)}function tt(t){return B(t)?nt(t):b(t)}function et(t){for(var e=Un.lastIndex=0;Un.test(t);)++e;return e}function nt(t){return t.match(Un)||[]}function rt(t){return t.match(Yn)||[]}var it,ot="4.17.4",at=200,ut="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",st="Expected a function",ct="__lodash_hash_undefined__",lt=500,ft="__lodash_placeholder__",pt=1,ht=2,dt=4,yt=1,mt=2,gt=1,vt=2,_t=4,bt=8,Mt=16,wt=32,xt=64,Ft=128,St=256,Dt=512,kt=30,Et="...",Ct=800,Tt=16,Nt=1,Ot=2,At=3,jt=1/0,Pt=9007199254740991,It=1.7976931348623157e308,Ht=NaN,Lt=4294967295,Rt=Lt-1,$t=Lt>>>1,zt=[["ary",Ft],["bind",gt],["bindKey",vt],["curry",bt],["curryRight",Mt],["flip",Dt],["partial",wt],["partialRight",xt],["rearg",St]],Wt="[object Arguments]",Bt="[object Array]",qt="[object AsyncFunction]",Ut="[object Boolean]",Yt="[object Date]",Gt="[object DOMException]",Jt="[object Error]",Vt="[object Function]",Kt="[object GeneratorFunction]",Xt="[object Map]",Zt="[object Number]",Qt="[object Null]",te="[object Object]",ee="[object Promise]",ne="[object Proxy]",re="[object RegExp]",ie="[object Set]",oe="[object String]",ae="[object Symbol]",ue="[object Undefined]",se="[object WeakMap]",ce="[object WeakSet]",le="[object ArrayBuffer]",fe="[object DataView]",pe="[object Float32Array]",he="[object Float64Array]",de="[object Int8Array]",ye="[object Int16Array]",me="[object Int32Array]",ge="[object Uint8Array]",ve="[object Uint8ClampedArray]",_e="[object Uint16Array]",be="[object Uint32Array]",Me=/\\b__p \\+= \'\';/g,we=/\\b(__p \\+=) \'\' \\+/g,xe=/(__e\\(.*?\\)|\\b__t\\)) \\+\\n\'\';/g,Fe=/&(?:amp|lt|gt|quot|#39);/g,Se=/[&<>"\']/g,De=RegExp(Fe.source),ke=RegExp(Se.source),Ee=/<%-([\\s\\S]+?)%>/g,Ce=/<%([\\s\\S]+?)%>/g,Te=/<%=([\\s\\S]+?)%>/g,Ne=/\\.|\\[(?:[^[\\]]*|(["\'])(?:(?!\\1)[^\\\\]|\\\\.)*?\\1)\\]/,Oe=/^\\w*$/,Ae=/^\\./,je=/[^.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|(["\'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))/g,Pe=/[\\\\^$.*+?()[\\]{}|]/g,Ie=RegExp(Pe.source),He=/^\\s+|\\s+$/g,Le=/^\\s+/,Re=/\\s+$/,$e=/\\{(?:\\n\\/\\* \\[wrapped with .+\\] \\*\\/)?\\n?/,ze=/\\{\\n\\/\\* \\[wrapped with (.+)\\] \\*/,We=/,? & /,Be=/[^\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\x7f]+/g,qe=/\\\\(\\\\)?/g,Ue=/\\$\\{([^\\\\}]*(?:\\\\.[^\\\\}]*)*)\\}/g,Ye=/\\w*$/,Ge=/^[-+]0x[0-9a-f]+$/i,Je=/^0b[01]+$/i,Ve=/^\\[object .+?Constructor\\]$/,Ke=/^0o[0-7]+$/i,Xe=/^(?:0|[1-9]\\d*)$/,Ze=/[\\xc0-\\xd6\\xd8-\\xf6\\xf8-\\xff\\u0100-\\u017f]/g,Qe=/($^)/,tn=/[\'\\n\\r\\u2028\\u2029\\\\]/g,en="\\\\ud800-\\\\udfff",nn="\\\\u0300-\\\\u036f",rn="\\\\ufe20-\\\\ufe2f",on="\\\\u20d0-\\\\u20ff",an=nn+rn+on,un="\\\\u2700-\\\\u27bf",sn="a-z\\\\xdf-\\\\xf6\\\\xf8-\\\\xff",cn="\\\\xac\\\\xb1\\\\xd7\\\\xf7",ln="\\\\x00-\\\\x2f\\\\x3a-\\\\x40\\\\x5b-\\\\x60\\\\x7b-\\\\xbf",fn="\\\\u2000-\\\\u206f",pn=" \\\\t\\\\x0b\\\\f\\\\xa0\\\\ufeff\\\\n\\\\r\\\\u2028\\\\u2029\\\\u1680\\\\u180e\\\\u2000\\\\u2001\\\\u2002\\\\u2003\\\\u2004\\\\u2005\\\\u2006\\\\u2007\\\\u2008\\\\u2009\\\\u200a\\\\u202f\\\\u205f\\\\u3000",hn="A-Z\\\\xc0-\\\\xd6\\\\xd8-\\\\xde",dn="\\\\ufe0e\\\\ufe0f",yn=cn+ln+fn+pn,mn="[\'’]",gn="["+en+"]",vn="["+yn+"]",_n="["+an+"]",bn="\\\\d+",Mn="["+un+"]",wn="["+sn+"]",xn="[^"+en+yn+bn+un+sn+hn+"]",Fn="\\\\ud83c[\\\\udffb-\\\\udfff]",Sn="(?:"+_n+"|"+Fn+")",Dn="[^"+en+"]",kn="(?:\\\\ud83c[\\\\udde6-\\\\uddff]){2}",En="[\\\\ud800-\\\\udbff][\\\\udc00-\\\\udfff]",Cn="["+hn+"]",Tn="\\\\u200d",Nn="(?:"+wn+"|"+xn+")",On="(?:"+Cn+"|"+xn+")",An="(?:"+mn+"(?:d|ll|m|re|s|t|ve))?",jn="(?:"+mn+"(?:D|LL|M|RE|S|T|VE))?",Pn=Sn+"?",In="["+dn+"]?",Hn="(?:"+Tn+"(?:"+[Dn,kn,En].join("|")+")"+In+Pn+")*",Ln="\\\\d*(?:(?:1st|2nd|3rd|(?![123])\\\\dth)\\\\b)",Rn="\\\\d*(?:(?:1ST|2ND|3RD|(?![123])\\\\dTH)\\\\b)",$n=In+Pn+Hn,zn="(?:"+[Mn,kn,En].join("|")+")"+$n,Wn="(?:"+[Dn+_n+"?",_n,kn,En,gn].join("|")+")",Bn=RegExp(mn,"g"),qn=RegExp(_n,"g"),Un=RegExp(Fn+"(?="+Fn+")|"+Wn+$n,"g"),Yn=RegExp([Cn+"?"+wn+"+"+An+"(?="+[vn,Cn,"$"].join("|")+")",On+"+"+jn+"(?="+[vn,Cn+Nn,"$"].join("|")+")",Cn+"?"+Nn+"+"+An,Cn+"+"+jn,Rn,Ln,bn,zn].join("|"),"g"),Gn=RegExp("["+Tn+en+an+dn+"]"),Jn=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Vn=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Kn=-1,Xn={};Xn[pe]=Xn[he]=Xn[de]=Xn[ye]=Xn[me]=Xn[ge]=Xn[ve]=Xn[_e]=Xn[be]=!0,Xn[Wt]=Xn[Bt]=Xn[le]=Xn[Ut]=Xn[fe]=Xn[Yt]=Xn[Jt]=Xn[Vt]=Xn[Xt]=Xn[Zt]=Xn[te]=Xn[re]=Xn[ie]=Xn[oe]=Xn[se]=!1;var Zn={};Zn[Wt]=Zn[Bt]=Zn[le]=Zn[fe]=Zn[Ut]=Zn[Yt]=Zn[pe]=Zn[he]=Zn[de]=Zn[ye]=Zn[me]=Zn[Xt]=Zn[Zt]=Zn[te]=Zn[re]=Zn[ie]=Zn[oe]=Zn[ae]=Zn[ge]=Zn[ve]=Zn[_e]=Zn[be]=!0,Zn[Jt]=Zn[Vt]=Zn[se]=!1;var Qn={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"\'n","ſ":"s"},tr={"&":"&amp;","<":"&lt;",">":"&gt;",\'"\':"&quot;","\'":"&#39;"},er={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":\'"\',"&#39;":"\'"},nr={"\\\\":"\\\\","\'":"\'","\\n":"n","\\r":"r","\\u2028":"u2028","\\u2029":"u2029"},rr=parseFloat,ir=parseInt,or="object"==typeof t&&t&&t.Object===Object&&t,ar="object"==typeof self&&self&&self.Object===Object&&self,ur=or||ar||Function("return this")(),sr="object"==typeof e&&e&&!e.nodeType&&e,cr=sr&&"object"==typeof r&&r&&!r.nodeType&&r,lr=cr&&cr.exports===sr,fr=lr&&or.process,pr=function(){try{return fr&&fr.binding&&fr.binding("util")}catch(t){}}(),hr=pr&&pr.isArrayBuffer,dr=pr&&pr.isDate,yr=pr&&pr.isMap,mr=pr&&pr.isRegExp,gr=pr&&pr.isSet,vr=pr&&pr.isTypedArray,_r=E("length"),br=C(Qn),Mr=C(tr),wr=C(er),xr=function t(e){function n(t){if(cs(t)&&!Mp(t)&&!(t instanceof b)){if(t instanceof i)return t;if(bl.call(t,"__wrapped__"))return aa(t)}return new i(t)}function r(){}function i(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=it}function b(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Lt,this.__views__=[]}function C(){var t=new b(this.__wrapped__);return t.__actions__=$i(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=$i(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=$i(this.__views__),t}function X(){if(this.__filtered__){var t=new b(this);t.__dir__=-1,t.__filtered__=!0}else t=this.clone(),t.__dir__*=-1;return t}function et(){var t=this.__wrapped__.value(),e=this.__dir__,n=Mp(t),r=e<0,i=n?t.length:0,o=To(0,i,this.__views__),a=o.start,u=o.end,s=u-a,c=r?u:a-1,l=this.__iteratees__,f=l.length,p=0,h=Kl(s,this.__takeCount__);if(!n||!r&&i==s&&h==s)return Mi(t,this.__actions__);var d=[];t:for(;s--&&p<h;){c+=e;for(var y=-1,m=t[c];++y<f;){var g=l[y],v=g.iteratee,_=g.type,b=v(m);if(_==Ot)m=b;else if(!b){if(_==Nt)continue t;break t}}d[p++]=m}return d}function nt(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Be(){this.__data__=uf?uf(null):{},this.size=0}function en(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}function nn(t){var e=this.__data__;if(uf){var n=e[t];return n===ct?it:n}return bl.call(e,t)?e[t]:it}function rn(t){var e=this.__data__;return uf?e[t]!==it:bl.call(e,t)}function on(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=uf&&e===it?ct:e,this}function an(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function un(){this.__data__=[],this.size=0}function sn(t){var e=this.__data__,n=An(e,t);return!(n<0)&&(n==e.length-1?e.pop():jl.call(e,n,1),--this.size,!0)}function cn(t){var e=this.__data__,n=An(e,t);return n<0?it:e[n][1]}function ln(t){return An(this.__data__,t)>-1}function fn(t,e){var n=this.__data__,r=An(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this}function pn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function hn(){this.size=0,this.__data__={hash:new nt,map:new(nf||an),string:new nt}}function dn(t){var e=Do(this,t).delete(t);return this.size-=e?1:0,e}function yn(t){return Do(this,t).get(t)}function mn(t){return Do(this,t).has(t)}function gn(t,e){var n=Do(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this}function vn(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new pn;++e<n;)this.add(t[e])}function _n(t){return this.__data__.set(t,ct),this}function bn(t){return this.__data__.has(t)}function Mn(t){var e=this.__data__=new an(t);this.size=e.size}function wn(){this.__data__=new an,this.size=0}function xn(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}function Fn(t){return this.__data__.get(t)}function Sn(t){return this.__data__.has(t)}function Dn(t,e){var n=this.__data__;if(n instanceof an){var r=n.__data__;if(!nf||r.length<at-1)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new pn(r)}return n.set(t,e),this.size=n.size,this}function kn(t,e){var n=Mp(t),r=!n&&bp(t),i=!n&&!r&&xp(t),o=!n&&!r&&!i&&Ep(t),a=n||r||i||o,u=a?A(t.length,hl):[],s=u.length;for(var c in t)!e&&!bl.call(t,c)||a&&("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||Lo(c,s))||u.push(c);return u}function En(t){var e=t.length;return e?t[ni(0,e-1)]:it}function Cn(t,e){return na($i(t),Rn(e,0,t.length))}function Tn(t){return na($i(t))}function Nn(t,e,n){(n===it||Vu(t[e],n))&&(n!==it||e in t)||Hn(t,e,n)}function On(t,e,n){var r=t[e];bl.call(t,e)&&Vu(r,n)&&(n!==it||e in t)||Hn(t,e,n)}function An(t,e){for(var n=t.length;n--;)if(Vu(t[n][0],e))return n;return-1}function jn(t,e,n,r){return _f(t,function(t,i,o){e(r,t,n(t),o)}),r}function Pn(t,e){return t&&zi(e,qs(e),t)}function In(t,e){return t&&zi(e,Us(e),t)}function Hn(t,e,n){"__proto__"==e&&Ll?Ll(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function Ln(t,e){for(var n=-1,r=e.length,i=al(r),o=null==t;++n<r;)i[n]=o?it:zs(t,e[n]);return i}function Rn(t,e,n){return t===t&&(n!==it&&(t=t<=n?t:n),e!==it&&(t=t>=e?t:e)),t}function $n(t,e,n,r,i,o){var a,u=e&pt,s=e&ht,l=e&dt;if(n&&(a=i?n(t,r,i,o):n(t)),a!==it)return a;if(!ss(t))return t;var f=Mp(t);if(f){if(a=Ao(t),!u)return $i(t,a)}else{var p=Nf(t),h=p==Vt||p==Kt;if(xp(t))return Ei(t,u);if(p==te||p==Wt||h&&!i){if(a=s||h?{}:jo(t),!u)return s?Bi(t,In(a,t)):Wi(t,Pn(a,t))}else{if(!Zn[p])return i?t:{};a=Po(t,p,$n,u)}}o||(o=new Mn);var d=o.get(t);if(d)return d;o.set(t,a);var y=l?s?wo:Mo:s?Us:qs,m=f?it:y(t);return c(m||t,function(r,i){m&&(i=r,r=t[i]),On(a,i,$n(r,e,n,i,t,o))}),a}function zn(t){var e=qs(t);return function(n){return Wn(n,t,e)}}function Wn(t,e,n){var r=n.length;if(null==t)return!r;for(t=fl(t);r--;){var i=n[r],o=e[i],a=t[i];if(a===it&&!(i in t)||!o(a))return!1}return!0}function Un(t,e,n){if("function"!=typeof t)throw new dl(st);return jf(function(){t.apply(it,n)},e)}function Yn(t,e,n,r){var i=-1,o=h,a=!0,u=t.length,s=[],c=e.length;if(!u)return s;n&&(e=y(e,P(n))),r?(o=d,a=!1):e.length>=at&&(o=H,a=!1,e=new vn(e));t:for(;++i<u;){var l=t[i],f=null==n?l:n(l);if(l=r||0!==l?l:0,a&&f===f){for(var p=c;p--;)if(e[p]===f)continue t;s.push(l)}else o(e,f,r)||s.push(l)}return s}function Gn(t,e){var n=!0;return _f(t,function(t,r,i){return n=!!e(t,r,i)}),n}function Jn(t,e,n){for(var r=-1,i=t.length;++r<i;){var o=t[r],a=e(o);if(null!=a&&(u===it?a===a&&!bs(a):n(a,u)))var u=a,s=o}return s}function Qn(t,e,n,r){var i=t.length;for(n=Ds(n),n<0&&(n=-n>i?0:i+n),r=r===it||r>i?i:Ds(r),r<0&&(r+=i),r=n>r?0:ks(r);n<r;)t[n++]=e;return t}function tr(t,e){var n=[];return _f(t,function(t,r,i){e(t,r,i)&&n.push(t)}),n}function er(t,e,n,r,i){var o=-1,a=t.length;for(n||(n=Ho),i||(i=[]);++o<a;){var u=t[o];e>0&&n(u)?e>1?er(u,e-1,n,r,i):m(i,u):r||(i[i.length]=u)}return i}function nr(t,e){return t&&Mf(t,e,qs)}function or(t,e){return t&&wf(t,e,qs)}function ar(t,e){return p(e,function(e){return os(t[e])})}function sr(t,e){e=Di(e,t);for(var n=0,r=e.length;null!=t&&n<r;)t=t[ra(e[n++])];return n&&n==r?t:it}function cr(t,e,n){var r=e(t);return Mp(t)?r:m(r,n(t))}function fr(t){return null==t?t===it?ue:Qt:Hl&&Hl in fl(t)?Co(t):Ko(t)}function pr(t,e){return t>e}function _r(t,e){return null!=t&&bl.call(t,e)}function xr(t,e){return null!=t&&e in fl(t)}function Sr(t,e,n){return t>=Kl(e,n)&&t<Vl(e,n)}function Dr(t,e,n){for(var r=n?d:h,i=t[0].length,o=t.length,a=o,u=al(o),s=1/0,c=[];a--;){var l=t[a];a&&e&&(l=y(l,P(e))),s=Kl(l.length,s),u[a]=!n&&(e||i>=120&&l.length>=120)?new vn(a&&l):it}l=t[0];var f=-1,p=u[0];t:for(;++f<i&&c.length<s;){var m=l[f],g=e?e(m):m;if(m=n||0!==m?m:0,!(p?H(p,g):r(c,g,n))){for(a=o;--a;){var v=u[a];if(!(v?H(v,g):r(t[a],g,n)))continue t}p&&p.push(g),c.push(m)}}return c}function kr(t,e,n,r){return nr(t,function(t,i,o){e(r,n(t),i,o)}),r}function Er(t,e,n){e=Di(e,t),t=Zo(t,e);var r=null==t?t:t[ra(Sa(e))];return null==r?it:u(r,t,n)}function Cr(t){return cs(t)&&fr(t)==Wt}function Tr(t){return cs(t)&&fr(t)==le}function Nr(t){return cs(t)&&fr(t)==Yt}function Or(t,e,n,r,i){return t===e||(null==t||null==e||!cs(t)&&!cs(e)?t!==t&&e!==e:Ar(t,e,n,r,Or,i))}function Ar(t,e,n,r,i,o){var a=Mp(t),u=Mp(e),s=a?Bt:Nf(t),c=u?Bt:Nf(e);s=s==Wt?te:s,c=c==Wt?te:c;var l=s==te,f=c==te,p=s==c;if(p&&xp(t)){if(!xp(e))return!1;a=!0,l=!1}if(p&&!l)return o||(o=new Mn),a||Ep(t)?go(t,e,n,r,i,o):vo(t,e,s,n,r,i,o);if(!(n&yt)){var h=l&&bl.call(t,"__wrapped__"),d=f&&bl.call(e,"__wrapped__");if(h||d){var y=h?t.value():t,m=d?e.value():e;return o||(o=new Mn),i(y,m,n,r,o)}}return!!p&&(o||(o=new Mn),_o(t,e,n,r,i,o))}function jr(t){return cs(t)&&Nf(t)==Xt}function Pr(t,e,n,r){var i=n.length,o=i,a=!r;if(null==t)return!o;for(t=fl(t);i--;){var u=n[i];if(a&&u[2]?u[1]!==t[u[0]]:!(u[0]in t))return!1}for(;++i<o;){u=n[i];var s=u[0],c=t[s],l=u[1];if(a&&u[2]){if(c===it&&!(s in t))return!1}else{var f=new Mn;if(r)var p=r(c,l,s,t,e,f);if(!(p===it?Or(l,c,yt|mt,r,f):p))return!1}}return!0}function Ir(t){return!(!ss(t)||Bo(t))&&(os(t)?Dl:Ve).test(ia(t))}function Hr(t){return cs(t)&&fr(t)==re}function Lr(t){return cs(t)&&Nf(t)==ie}function Rr(t){return cs(t)&&us(t.length)&&!!Xn[fr(t)]}function $r(t){return"function"==typeof t?t:null==t?jc:"object"==typeof t?Mp(t)?Yr(t[0],t[1]):Ur(t):Wc(t)}function zr(t){if(!qo(t))return Jl(t);var e=[];for(var n in fl(t))bl.call(t,n)&&"constructor"!=n&&e.push(n);return e}function Wr(t){if(!ss(t))return Vo(t);var e=qo(t),n=[];for(var r in t)("constructor"!=r||!e&&bl.call(t,r))&&n.push(r);return n}function Br(t,e){return t<e}function qr(t,e){var n=-1,r=Ku(t)?al(t.length):[];return _f(t,function(t,i,o){r[++n]=e(t,i,o)}),r}function Ur(t){var e=ko(t);return 1==e.length&&e[0][2]?Yo(e[0][0],e[0][1]):function(n){return n===t||Pr(n,t,e)}}function Yr(t,e){return $o(t)&&Uo(e)?Yo(ra(t),e):function(n){var r=zs(n,t);return r===it&&r===e?Bs(n,t):Or(e,r,yt|mt)}}function Gr(t,e,n,r,i){t!==e&&Mf(e,function(o,a){if(ss(o))i||(i=new Mn),Jr(t,e,a,n,Gr,r,i);else{var u=r?r(t[a],o,a+"",t,e,i):it;u===it&&(u=o),Nn(t,a,u)}},Us)}function Jr(t,e,n,r,i,o,a){var u=t[n],s=e[n],c=a.get(s);if(c)return void Nn(t,n,c);var l=o?o(u,s,n+"",t,e,a):it,f=l===it;if(f){var p=Mp(s),h=!p&&xp(s),d=!p&&!h&&Ep(s);l=s,p||h||d?Mp(u)?l=u:Xu(u)?l=$i(u):h?(f=!1,l=Ei(s,!0)):d?(f=!1,l=Pi(s,!0)):l=[]:gs(s)||bp(s)?(l=u,bp(u)?l=Cs(u):(!ss(u)||r&&os(u))&&(l=jo(s))):f=!1}f&&(a.set(s,l),i(l,s,r,o,a),a.delete(s)),Nn(t,n,l)}function Vr(t,e){var n=t.length;if(n)return e+=e<0?n:0,Lo(e,n)?t[e]:it}function Kr(t,e,n){var r=-1;return e=y(e.length?e:[jc],P(So())),N(qr(t,function(t,n,i){return{criteria:y(e,function(e){return e(t)}),index:++r,value:t}}),function(t,e){return Hi(t,e,n)})}function Xr(t,e){return Zr(t,e,function(e,n){return Bs(t,n)})}function Zr(t,e,n){for(var r=-1,i=e.length,o={};++r<i;){var a=e[r],u=sr(t,a);n(u,a)&&si(o,Di(a,t),u)}return o}function Qr(t){return function(e){return sr(e,t)}}function ti(t,e,n,r){var i=r?S:F,o=-1,a=e.length,u=t;for(t===e&&(e=$i(e)),n&&(u=y(t,P(n)));++o<a;)for(var s=0,c=e[o],l=n?n(c):c;(s=i(u,l,s,r))>-1;)u!==t&&jl.call(u,s,1),jl.call(t,s,1);return t}function ei(t,e){for(var n=t?e.length:0,r=n-1;n--;){var i=e[n];if(n==r||i!==o){var o=i;Lo(i)?jl.call(t,i,1):vi(t,i)}}return t}function ni(t,e){return t+Bl(Ql()*(e-t+1))}function ri(t,e,n,r){for(var i=-1,o=Vl(Wl((e-t)/(n||1)),0),a=al(o);o--;)a[r?o:++i]=t,t+=n;return a}function ii(t,e){var n="";if(!t||e<1||e>Pt)return n;do{e%2&&(n+=t),(e=Bl(e/2))&&(t+=t)}while(e);return n}function oi(t,e){return Pf(Xo(t,e,jc),t+"")}function ai(t){return En(rc(t))}function ui(t,e){var n=rc(t);return na(n,Rn(e,0,n.length))}function si(t,e,n,r){if(!ss(t))return t;e=Di(e,t);for(var i=-1,o=e.length,a=o-1,u=t;null!=u&&++i<o;){var s=ra(e[i]),c=n;if(i!=a){var l=u[s];c=r?r(l,s,u):it,c===it&&(c=ss(l)?l:Lo(e[i+1])?[]:{})}On(u,s,c),u=u[s]}return t}function ci(t){return na(rc(t))}function li(t,e,n){var r=-1,i=t.length;e<0&&(e=-e>i?0:i+e),n=n>i?i:n,n<0&&(n+=i),i=e>n?0:n-e>>>0,e>>>=0;for(var o=al(i);++r<i;)o[r]=t[r+e];return o}function fi(t,e){var n;return _f(t,function(t,r,i){return!(n=e(t,r,i))}),!!n}function pi(t,e,n){var r=0,i=null==t?r:t.length;if("number"==typeof e&&e===e&&i<=$t){for(;r<i;){var o=r+i>>>1,a=t[o];null!==a&&!bs(a)&&(n?a<=e:a<e)?r=o+1:i=o}return i}return hi(t,e,jc,n)}function hi(t,e,n,r){e=n(e);for(var i=0,o=null==t?0:t.length,a=e!==e,u=null===e,s=bs(e),c=e===it;i<o;){var l=Bl((i+o)/2),f=n(t[l]),p=f!==it,h=null===f,d=f===f,y=bs(f);if(a)var m=r||d;else m=c?d&&(r||p):u?d&&p&&(r||!h):s?d&&p&&!h&&(r||!y):!h&&!y&&(r?f<=e:f<e);m?i=l+1:o=l}return Kl(o,Rt)}function di(t,e){for(var n=-1,r=t.length,i=0,o=[];++n<r;){var a=t[n],u=e?e(a):a;if(!n||!Vu(u,s)){var s=u;o[i++]=0===a?0:a}}return o}function yi(t){return"number"==typeof t?t:bs(t)?Ht:+t}function mi(t){if("string"==typeof t)return t;if(Mp(t))return y(t,mi)+"";if(bs(t))return gf?gf.call(t):"";var e=t+"";return"0"==e&&1/t==-jt?"-0":e}function gi(t,e,n){var r=-1,i=h,o=t.length,a=!0,u=[],s=u;if(n)a=!1,i=d;else if(o>=at){var c=e?null:kf(t);if(c)return V(c);a=!1,i=H,s=new vn}else s=e?[]:u;t:for(;++r<o;){var l=t[r],f=e?e(l):l;if(l=n||0!==l?l:0,a&&f===f){for(var p=s.length;p--;)if(s[p]===f)continue t;e&&s.push(f),u.push(l)}else i(s,f,n)||(s!==u&&s.push(f),u.push(l))}return u}function vi(t,e){return e=Di(e,t),null==(t=Zo(t,e))||delete t[ra(Sa(e))]}function _i(t,e,n,r){return si(t,e,n(sr(t,e)),r)}function bi(t,e,n,r){for(var i=t.length,o=r?i:-1;(r?o--:++o<i)&&e(t[o],o,t););return n?li(t,r?0:o,r?o+1:i):li(t,r?o+1:0,r?i:o)}function Mi(t,e){var n=t;return n instanceof b&&(n=n.value()),g(e,function(t,e){return e.func.apply(e.thisArg,m([t],e.args))},n)}function wi(t,e,n){var r=t.length;if(r<2)return r?gi(t[0]):[];for(var i=-1,o=al(r);++i<r;)for(var a=t[i],u=-1;++u<r;)u!=i&&(o[i]=Yn(o[i]||a,t[u],e,n));return gi(er(o,1),e,n)}function xi(t,e,n){for(var r=-1,i=t.length,o=e.length,a={};++r<i;){var u=r<o?e[r]:it;n(a,t[r],u)}return a}function Fi(t){return Xu(t)?t:[]}function Si(t){return"function"==typeof t?t:jc}function Di(t,e){return Mp(t)?t:$o(t,e)?[t]:If(Ns(t))}function ki(t,e,n){var r=t.length;return n=n===it?r:n,!e&&n>=r?t:li(t,e,n)}function Ei(t,e){if(e)return t.slice();var n=t.length,r=Tl?Tl(n):new t.constructor(n);return t.copy(r),r}function Ci(t){var e=new t.constructor(t.byteLength);return new Cl(e).set(new Cl(t)),e}function Ti(t,e){var n=e?Ci(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}function Ni(t,e,n){return g(e?n(Y(t),pt):Y(t),o,new t.constructor)}function Oi(t){var e=new t.constructor(t.source,Ye.exec(t));return e.lastIndex=t.lastIndex,e}function Ai(t,e,n){return g(e?n(V(t),pt):V(t),a,new t.constructor)}function ji(t){return mf?fl(mf.call(t)):{}}function Pi(t,e){var n=e?Ci(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}function Ii(t,e){if(t!==e){var n=t!==it,r=null===t,i=t===t,o=bs(t),a=e!==it,u=null===e,s=e===e,c=bs(e);if(!u&&!c&&!o&&t>e||o&&a&&s&&!u&&!c||r&&a&&s||!n&&s||!i)return 1;if(!r&&!o&&!c&&t<e||c&&n&&i&&!r&&!o||u&&n&&i||!a&&i||!s)return-1}return 0}function Hi(t,e,n){for(var r=-1,i=t.criteria,o=e.criteria,a=i.length,u=n.length;++r<a;){var s=Ii(i[r],o[r]);if(s){if(r>=u)return s;return s*("desc"==n[r]?-1:1)}}return t.index-e.index}function Li(t,e,n,r){for(var i=-1,o=t.length,a=n.length,u=-1,s=e.length,c=Vl(o-a,0),l=al(s+c),f=!r;++u<s;)l[u]=e[u];for(;++i<a;)(f||i<o)&&(l[n[i]]=t[i]);for(;c--;)l[u++]=t[i++];return l}function Ri(t,e,n,r){for(var i=-1,o=t.length,a=-1,u=n.length,s=-1,c=e.length,l=Vl(o-u,0),f=al(l+c),p=!r;++i<l;)f[i]=t[i];for(var h=i;++s<c;)f[h+s]=e[s];for(;++a<u;)(p||i<o)&&(f[h+n[a]]=t[i++]);return f}function $i(t,e){var n=-1,r=t.length;for(e||(e=al(r));++n<r;)e[n]=t[n];return e}function zi(t,e,n,r){var i=!n;n||(n={});for(var o=-1,a=e.length;++o<a;){var u=e[o],s=r?r(n[u],t[u],u,n,t):it;s===it&&(s=t[u]),i?Hn(n,u,s):On(n,u,s)}return n}function Wi(t,e){return zi(t,Cf(t),e)}function Bi(t,e){return zi(t,Tf(t),e)}function qi(t,e){return function(n,r){var i=Mp(n)?s:jn,o=e?e():{};return i(n,t,So(r,2),o)}}function Ui(t){return oi(function(e,n){var r=-1,i=n.length,o=i>1?n[i-1]:it,a=i>2?n[2]:it;for(o=t.length>3&&"function"==typeof o?(i--,o):it,a&&Ro(n[0],n[1],a)&&(o=i<3?it:o,i=1),e=fl(e);++r<i;){var u=n[r];u&&t(e,u,r,o)}return e})}function Yi(t,e){return function(n,r){if(null==n)return n;if(!Ku(n))return t(n,r);for(var i=n.length,o=e?i:-1,a=fl(n);(e?o--:++o<i)&&!1!==r(a[o],o,a););return n}}function Gi(t){return function(e,n,r){for(var i=-1,o=fl(e),a=r(e),u=a.length;u--;){var s=a[t?u:++i];if(!1===n(o[s],s,o))break}return e}}function Ji(t,e,n){function r(){return(this&&this!==ur&&this instanceof r?o:t).apply(i?n:this,arguments)}var i=e&gt,o=Xi(t);return r}function Vi(t){return function(e){e=Ns(e);var n=B(e)?tt(e):it,r=n?n[0]:e.charAt(0),i=n?ki(n,1).join(""):e.slice(1);return r[t]()+i}}function Ki(t){return function(e){return g(Cc(cc(e).replace(Bn,"")),t,"")}}function Xi(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var n=vf(t.prototype),r=t.apply(n,e);return ss(r)?r:n}}function Zi(t,e,n){function r(){for(var o=arguments.length,a=al(o),s=o,c=Fo(r);s--;)a[s]=arguments[s];var l=o<3&&a[0]!==c&&a[o-1]!==c?[]:J(a,c);return(o-=l.length)<n?co(t,e,eo,r.placeholder,it,a,l,it,it,n-o):u(this&&this!==ur&&this instanceof r?i:t,this,a)}var i=Xi(t);return r}function Qi(t){return function(e,n,r){var i=fl(e);if(!Ku(e)){var o=So(n,3);e=qs(e),n=function(t){return o(i[t],t,i)}}var a=t(e,n,r);return a>-1?i[o?e[a]:a]:it}}function to(t){return bo(function(e){var n=e.length,r=n,o=i.prototype.thru;for(t&&e.reverse();r--;){var a=e[r];if("function"!=typeof a)throw new dl(st);if(o&&!u&&"wrapper"==xo(a))var u=new i([],!0)}for(r=u?r:n;++r<n;){a=e[r];var s=xo(a),c="wrapper"==s?Ef(a):it;u=c&&Wo(c[0])&&c[1]==(Ft|bt|wt|St)&&!c[4].length&&1==c[9]?u[xo(c[0])].apply(u,c[3]):1==a.length&&Wo(a)?u[s]():u.thru(a)}return function(){var t=arguments,r=t[0];if(u&&1==t.length&&Mp(r))return u.plant(r).value();for(var i=0,o=n?e[i].apply(this,t):r;++i<n;)o=e[i].call(this,o);return o}})}function eo(t,e,n,r,i,o,a,u,s,c){function l(){for(var g=arguments.length,v=al(g),_=g;_--;)v[_]=arguments[_];if(d)var b=Fo(l),M=$(v,b);if(r&&(v=Li(v,r,i,d)),o&&(v=Ri(v,o,a,d)),g-=M,d&&g<c){var w=J(v,b);return co(t,e,eo,l.placeholder,n,v,w,u,s,c-g)}var x=p?n:this,F=h?x[t]:t;return g=v.length,u?v=Qo(v,u):y&&g>1&&v.reverse(),f&&s<g&&(v.length=s),this&&this!==ur&&this instanceof l&&(F=m||Xi(F)),F.apply(x,v)}var f=e&Ft,p=e&gt,h=e&vt,d=e&(bt|Mt),y=e&Dt,m=h?it:Xi(t);return l}function no(t,e){return function(n,r){return kr(n,t,e(r),{})}}function ro(t,e){return function(n,r){var i;if(n===it&&r===it)return e;if(n!==it&&(i=n),r!==it){if(i===it)return r;"string"==typeof n||"string"==typeof r?(n=mi(n),r=mi(r)):(n=yi(n),r=yi(r)),i=t(n,r)}return i}}function io(t){return bo(function(e){return e=y(e,P(So())),oi(function(n){var r=this;return t(e,function(t){return u(t,r,n)})})})}function oo(t,e){e=e===it?" ":mi(e);var n=e.length;if(n<2)return n?ii(e,t):e;var r=ii(e,Wl(t/Q(e)));return B(e)?ki(tt(r),0,t).join(""):r.slice(0,t)}function ao(t,e,n,r){function i(){for(var e=-1,s=arguments.length,c=-1,l=r.length,f=al(l+s),p=this&&this!==ur&&this instanceof i?a:t;++c<l;)f[c]=r[c];for(;s--;)f[c++]=arguments[++e];return u(p,o?n:this,f)}var o=e&gt,a=Xi(t);return i}function uo(t){return function(e,n,r){return r&&"number"!=typeof r&&Ro(e,n,r)&&(n=r=it),e=Ss(e),n===it?(n=e,e=0):n=Ss(n),r=r===it?e<n?1:-1:Ss(r),ri(e,n,r,t)}}function so(t){return function(e,n){return"string"==typeof e&&"string"==typeof n||(e=Es(e),n=Es(n)),t(e,n)}}function co(t,e,n,r,i,o,a,u,s,c){var l=e&bt,f=l?a:it,p=l?it:a,h=l?o:it,d=l?it:o;e|=l?wt:xt,(e&=~(l?xt:wt))&_t||(e&=~(gt|vt));var y=[t,e,i,h,f,d,p,u,s,c],m=n.apply(it,y);return Wo(t)&&Af(m,y),m.placeholder=r,ta(m,t,e)}function lo(t){var e=ll[t];return function(t,n){if(t=Es(t),n=null==n?0:Kl(Ds(n),292)){var r=(Ns(t)+"e").split("e");return r=(Ns(e(r[0]+"e"+(+r[1]+n)))+"e").split("e"),+(r[0]+"e"+(+r[1]-n))}return e(t)}}function fo(t){return function(e){var n=Nf(e);return n==Xt?Y(e):n==ie?K(e):j(e,t(e))}}function po(t,e,n,r,i,o,a,u){var s=e&vt;if(!s&&"function"!=typeof t)throw new dl(st);var c=r?r.length:0;if(c||(e&=~(wt|xt),r=i=it),a=a===it?a:Vl(Ds(a),0),u=u===it?u:Ds(u),c-=i?i.length:0,e&xt){var l=r,f=i;r=i=it}var p=s?it:Ef(t),h=[t,e,n,r,i,l,f,o,a,u];if(p&&Jo(h,p),t=h[0],e=h[1],n=h[2],r=h[3],i=h[4],u=h[9]=h[9]===it?s?0:t.length:Vl(h[9]-c,0),!u&&e&(bt|Mt)&&(e&=~(bt|Mt)),e&&e!=gt)d=e==bt||e==Mt?Zi(t,e,u):e!=wt&&e!=(gt|wt)||i.length?eo.apply(it,h):ao(t,e,n,r);else var d=Ji(t,e,n);return ta((p?xf:Af)(d,h),t,e)}function ho(t,e,n,r){return t===it||Vu(t,gl[n])&&!bl.call(r,n)?e:t}function yo(t,e,n,r,i,o){return ss(t)&&ss(e)&&(o.set(e,t),Gr(t,e,it,yo,o),o.delete(e)),t}function mo(t){return gs(t)?it:t}function go(t,e,n,r,i,o){var a=n&yt,u=t.length,s=e.length;if(u!=s&&!(a&&s>u))return!1;var c=o.get(t);if(c&&o.get(e))return c==e;var l=-1,f=!0,p=n&mt?new vn:it;for(o.set(t,e),o.set(e,t);++l<u;){var h=t[l],d=e[l];if(r)var y=a?r(d,h,l,e,t,o):r(h,d,l,t,e,o);if(y!==it){if(y)continue;f=!1;break}if(p){if(!_(e,function(t,e){if(!H(p,e)&&(h===t||i(h,t,n,r,o)))return p.push(e)})){f=!1;break}}else if(h!==d&&!i(h,d,n,r,o)){f=!1;break}}return o.delete(t),o.delete(e),f}function vo(t,e,n,r,i,o,a){switch(n){case fe:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case le:return!(t.byteLength!=e.byteLength||!o(new Cl(t),new Cl(e)));case Ut:case Yt:case Zt:return Vu(+t,+e);case Jt:return t.name==e.name&&t.message==e.message;case re:case oe:return t==e+"";case Xt:var u=Y;case ie:var s=r&yt;if(u||(u=V),t.size!=e.size&&!s)return!1;var c=a.get(t);if(c)return c==e;r|=mt,a.set(t,e);var l=go(u(t),u(e),r,i,o,a);return a.delete(t),l;case ae:if(mf)return mf.call(t)==mf.call(e)}return!1}function _o(t,e,n,r,i,o){var a=n&yt,u=Mo(t),s=u.length;if(s!=Mo(e).length&&!a)return!1;for(var c=s;c--;){var l=u[c];if(!(a?l in e:bl.call(e,l)))return!1}var f=o.get(t);if(f&&o.get(e))return f==e;var p=!0;o.set(t,e),o.set(e,t);for(var h=a;++c<s;){l=u[c];var d=t[l],y=e[l];if(r)var m=a?r(y,d,l,e,t,o):r(d,y,l,t,e,o);if(!(m===it?d===y||i(d,y,n,r,o):m)){p=!1;break}h||(h="constructor"==l)}if(p&&!h){var g=t.constructor,v=e.constructor;g!=v&&"constructor"in t&&"constructor"in e&&!("function"==typeof g&&g instanceof g&&"function"==typeof v&&v instanceof v)&&(p=!1)}return o.delete(t),o.delete(e),p}function bo(t){return Pf(Xo(t,it,ga),t+"")}function Mo(t){return cr(t,qs,Cf)}function wo(t){return cr(t,Us,Tf)}function xo(t){for(var e=t.name+"",n=cf[e],r=bl.call(cf,e)?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==t)return i.name}return e}function Fo(t){return(bl.call(n,"placeholder")?n:t).placeholder}function So(){var t=n.iteratee||Pc;return t=t===Pc?$r:t,arguments.length?t(arguments[0],arguments[1]):t}function Do(t,e){var n=t.__data__;return zo(e)?n["string"==typeof e?"string":"hash"]:n.map}function ko(t){for(var e=qs(t),n=e.length;n--;){var r=e[n],i=t[r];e[n]=[r,i,Uo(i)]}return e}function Eo(t,e){var n=W(t,e);return Ir(n)?n:it}function Co(t){var e=bl.call(t,Hl),n=t[Hl];try{t[Hl]=it;var r=!0}catch(t){}var i=xl.call(t);return r&&(e?t[Hl]=n:delete t[Hl]),i}function To(t,e,n){for(var r=-1,i=n.length;++r<i;){var o=n[r],a=o.size;switch(o.type){case"drop":t+=a;break;case"dropRight":e-=a;break;case"take":e=Kl(e,t+a);break;case"takeRight":t=Vl(t,e-a)}}return{start:t,end:e}}function No(t){var e=t.match(ze);return e?e[1].split(We):[]}function Oo(t,e,n){e=Di(e,t);for(var r=-1,i=e.length,o=!1;++r<i;){var a=ra(e[r]);if(!(o=null!=t&&n(t,a)))break;t=t[a]}return o||++r!=i?o:!!(i=null==t?0:t.length)&&us(i)&&Lo(a,i)&&(Mp(t)||bp(t))}function Ao(t){var e=t.length,n=t.constructor(e);return e&&"string"==typeof t[0]&&bl.call(t,"index")&&(n.index=t.index,n.input=t.input),n}function jo(t){return"function"!=typeof t.constructor||qo(t)?{}:vf(Nl(t))}function Po(t,e,n,r){var i=t.constructor;switch(e){case le:return Ci(t);case Ut:case Yt:return new i(+t);case fe:return Ti(t,r);case pe:case he:case de:case ye:case me:case ge:case ve:case _e:case be:return Pi(t,r);case Xt:return Ni(t,r,n);case Zt:case oe:return new i(t);case re:return Oi(t);case ie:return Ai(t,r,n);case ae:return ji(t)}}function Io(t,e){var n=e.length;if(!n)return t;var r=n-1;return e[r]=(n>1?"& ":"")+e[r],e=e.join(n>2?", ":" "),t.replace($e,"{\\n/* [wrapped with "+e+"] */\\n")}function Ho(t){return Mp(t)||bp(t)||!!(Pl&&t&&t[Pl])}function Lo(t,e){return!!(e=null==e?Pt:e)&&("number"==typeof t||Xe.test(t))&&t>-1&&t%1==0&&t<e}function Ro(t,e,n){if(!ss(n))return!1;var r=typeof e;return!!("number"==r?Ku(n)&&Lo(e,n.length):"string"==r&&e in n)&&Vu(n[e],t)}function $o(t,e){if(Mp(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!bs(t))||(Oe.test(t)||!Ne.test(t)||null!=e&&t in fl(e))}function zo(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}function Wo(t){var e=xo(t),r=n[e];if("function"!=typeof r||!(e in b.prototype))return!1;if(t===r)return!0;var i=Ef(r);return!!i&&t===i[0]}function Bo(t){return!!wl&&wl in t}function qo(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||gl)}function Uo(t){return t===t&&!ss(t)}function Yo(t,e){return function(n){return null!=n&&(n[t]===e&&(e!==it||t in fl(n)))}}function Go(t){var e=Pu(t,function(t){return n.size===lt&&n.clear(),t}),n=e.cache;return e}function Jo(t,e){var n=t[1],r=e[1],i=n|r,o=i<(gt|vt|Ft),a=r==Ft&&n==bt||r==Ft&&n==St&&t[7].length<=e[8]||r==(Ft|St)&&e[7].length<=e[8]&&n==bt;if(!o&&!a)return t;r&gt&&(t[2]=e[2],i|=n&gt?0:_t);var u=e[3];if(u){var s=t[3];t[3]=s?Li(s,u,e[4]):u,t[4]=s?J(t[3],ft):e[4]}return u=e[5],u&&(s=t[5],t[5]=s?Ri(s,u,e[6]):u,t[6]=s?J(t[5],ft):e[6]),u=e[7],u&&(t[7]=u),r&Ft&&(t[8]=null==t[8]?e[8]:Kl(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=i,t}function Vo(t){var e=[];if(null!=t)for(var n in fl(t))e.push(n);return e}function Ko(t){return xl.call(t)}function Xo(t,e,n){return e=Vl(e===it?t.length-1:e,0),function(){for(var r=arguments,i=-1,o=Vl(r.length-e,0),a=al(o);++i<o;)a[i]=r[e+i];i=-1;for(var s=al(e+1);++i<e;)s[i]=r[i];return s[e]=n(a),u(t,this,s)}}function Zo(t,e){return e.length<2?t:sr(t,li(e,0,-1))}function Qo(t,e){for(var n=t.length,r=Kl(e.length,n),i=$i(t);r--;){var o=e[r];t[r]=Lo(o,n)?i[o]:it}return t}function ta(t,e,n){var r=e+"";return Pf(t,Io(r,oa(No(r),n)))}function ea(t){var e=0,n=0;return function(){var r=Xl(),i=Tt-(r-n);if(n=r,i>0){if(++e>=Ct)return arguments[0]}else e=0;return t.apply(it,arguments)}}function na(t,e){var n=-1,r=t.length,i=r-1;for(e=e===it?r:e;++n<e;){var o=ni(n,i),a=t[o];t[o]=t[n],t[n]=a}return t.length=e,t}function ra(t){if("string"==typeof t||bs(t))return t;var e=t+"";return"0"==e&&1/t==-jt?"-0":e}function ia(t){if(null!=t){try{return _l.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function oa(t,e){return c(zt,function(n){var r="_."+n[0];e&n[1]&&!h(t,r)&&t.push(r)}),t.sort()}function aa(t){if(t instanceof b)return t.clone();var e=new i(t.__wrapped__,t.__chain__);return e.__actions__=$i(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}function ua(t,e,n){e=(n?Ro(t,e,n):e===it)?1:Vl(Ds(e),0);var r=null==t?0:t.length;if(!r||e<1)return[];for(var i=0,o=0,a=al(Wl(r/e));i<r;)a[o++]=li(t,i,i+=e);return a}function sa(t){for(var e=-1,n=null==t?0:t.length,r=0,i=[];++e<n;){var o=t[e];o&&(i[r++]=o)}return i}function ca(){var t=arguments.length;if(!t)return[];for(var e=al(t-1),n=arguments[0],r=t;r--;)e[r-1]=arguments[r];return m(Mp(n)?$i(n):[n],er(e,1))}function la(t,e,n){var r=null==t?0:t.length;return r?(e=n||e===it?1:Ds(e),li(t,e<0?0:e,r)):[]}function fa(t,e,n){var r=null==t?0:t.length;return r?(e=n||e===it?1:Ds(e),e=r-e,li(t,0,e<0?0:e)):[]}function pa(t,e){return t&&t.length?bi(t,So(e,3),!0,!0):[]}function ha(t,e){return t&&t.length?bi(t,So(e,3),!0):[]}function da(t,e,n,r){var i=null==t?0:t.length;return i?(n&&"number"!=typeof n&&Ro(t,e,n)&&(n=0,r=i),Qn(t,e,n,r)):[]}function ya(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=null==n?0:Ds(n);return i<0&&(i=Vl(r+i,0)),x(t,So(e,3),i)}function ma(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=r-1;return n!==it&&(i=Ds(n),i=n<0?Vl(r+i,0):Kl(i,r-1)),x(t,So(e,3),i,!0)}function ga(t){return(null==t?0:t.length)?er(t,1):[]}function va(t){return(null==t?0:t.length)?er(t,jt):[]}function _a(t,e){return(null==t?0:t.length)?(e=e===it?1:Ds(e),er(t,e)):[]}function ba(t){for(var e=-1,n=null==t?0:t.length,r={};++e<n;){var i=t[e];r[i[0]]=i[1]}return r}function Ma(t){return t&&t.length?t[0]:it}function wa(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=null==n?0:Ds(n);return i<0&&(i=Vl(r+i,0)),F(t,e,i)}function xa(t){return(null==t?0:t.length)?li(t,0,-1):[]}function Fa(t,e){return null==t?"":Gl.call(t,e)}function Sa(t){var e=null==t?0:t.length;return e?t[e-1]:it}function Da(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=r;return n!==it&&(i=Ds(n),i=i<0?Vl(r+i,0):Kl(i,r-1)),e===e?Z(t,e,i):x(t,D,i,!0)}function ka(t,e){return t&&t.length?Vr(t,Ds(e)):it}function Ea(t,e){return t&&t.length&&e&&e.length?ti(t,e):t}function Ca(t,e,n){return t&&t.length&&e&&e.length?ti(t,e,So(n,2)):t}function Ta(t,e,n){return t&&t.length&&e&&e.length?ti(t,e,it,n):t}function Na(t,e){var n=[];if(!t||!t.length)return n;var r=-1,i=[],o=t.length;for(e=So(e,3);++r<o;){var a=t[r];e(a,r,t)&&(n.push(a),i.push(r))}return ei(t,i),n}function Oa(t){return null==t?t:tf.call(t)}function Aa(t,e,n){var r=null==t?0:t.length;return r?(n&&"number"!=typeof n&&Ro(t,e,n)?(e=0,n=r):(e=null==e?0:Ds(e),n=n===it?r:Ds(n)),li(t,e,n)):[]}function ja(t,e){return pi(t,e)}function Pa(t,e,n){return hi(t,e,So(n,2))}function Ia(t,e){var n=null==t?0:t.length;if(n){var r=pi(t,e);if(r<n&&Vu(t[r],e))return r}return-1}function Ha(t,e){return pi(t,e,!0)}function La(t,e,n){return hi(t,e,So(n,2),!0)}function Ra(t,e){if(null==t?0:t.length){var n=pi(t,e,!0)-1;if(Vu(t[n],e))return n}return-1}function $a(t){return t&&t.length?di(t):[]}function za(t,e){return t&&t.length?di(t,So(e,2)):[]}function Wa(t){var e=null==t?0:t.length;return e?li(t,1,e):[]}function Ba(t,e,n){return t&&t.length?(e=n||e===it?1:Ds(e),li(t,0,e<0?0:e)):[]}function qa(t,e,n){var r=null==t?0:t.length;return r?(e=n||e===it?1:Ds(e),e=r-e,li(t,e<0?0:e,r)):[]}function Ua(t,e){return t&&t.length?bi(t,So(e,3),!1,!0):[]}function Ya(t,e){return t&&t.length?bi(t,So(e,3)):[]}function Ga(t){return t&&t.length?gi(t):[]}function Ja(t,e){return t&&t.length?gi(t,So(e,2)):[]}function Va(t,e){return e="function"==typeof e?e:it,t&&t.length?gi(t,it,e):[]}function Ka(t){if(!t||!t.length)return[];var e=0;return t=p(t,function(t){if(Xu(t))return e=Vl(t.length,e),!0}),A(e,function(e){return y(t,E(e))})}function Xa(t,e){if(!t||!t.length)return[];var n=Ka(t);return null==e?n:y(n,function(t){return u(e,it,t)})}function Za(t,e){return xi(t||[],e||[],On)}function Qa(t,e){return xi(t||[],e||[],si)}function tu(t){var e=n(t);return e.__chain__=!0,e}function eu(t,e){return e(t),t}function nu(t,e){return e(t)}function ru(){return tu(this)}function iu(){return new i(this.value(),this.__chain__)}function ou(){this.__values__===it&&(this.__values__=Fs(this.value()));var t=this.__index__>=this.__values__.length;return{done:t,value:t?it:this.__values__[this.__index__++]}}function au(){return this}function uu(t){for(var e,n=this;n instanceof r;){var i=aa(n);i.__index__=0,i.__values__=it,e?o.__wrapped__=i:e=i;var o=i;n=n.__wrapped__}return o.__wrapped__=t,e}function su(){var t=this.__wrapped__;if(t instanceof b){var e=t;return this.__actions__.length&&(e=new b(this)),e=e.reverse(),e.__actions__.push({func:nu,args:[Oa],thisArg:it}),new i(e,this.__chain__)}return this.thru(Oa)}function cu(){return Mi(this.__wrapped__,this.__actions__)}function lu(t,e,n){var r=Mp(t)?f:Gn;return n&&Ro(t,e,n)&&(e=it),r(t,So(e,3))}function fu(t,e){return(Mp(t)?p:tr)(t,So(e,3))}function pu(t,e){return er(vu(t,e),1)}function hu(t,e){return er(vu(t,e),jt)}function du(t,e,n){return n=n===it?1:Ds(n),er(vu(t,e),n)}function yu(t,e){return(Mp(t)?c:_f)(t,So(e,3))}function mu(t,e){return(Mp(t)?l:bf)(t,So(e,3))}function gu(t,e,n,r){t=Ku(t)?t:rc(t),n=n&&!r?Ds(n):0;var i=t.length;return n<0&&(n=Vl(i+n,0)),_s(t)?n<=i&&t.indexOf(e,n)>-1:!!i&&F(t,e,n)>-1}function vu(t,e){return(Mp(t)?y:qr)(t,So(e,3))}function _u(t,e,n,r){return null==t?[]:(Mp(e)||(e=null==e?[]:[e]),n=r?it:n,Mp(n)||(n=null==n?[]:[n]),Kr(t,e,n))}function bu(t,e,n){var r=Mp(t)?g:T,i=arguments.length<3;return r(t,So(e,4),n,i,_f)}function Mu(t,e,n){var r=Mp(t)?v:T,i=arguments.length<3;return r(t,So(e,4),n,i,bf)}function wu(t,e){return(Mp(t)?p:tr)(t,Iu(So(e,3)))}function xu(t){return(Mp(t)?En:ai)(t)}function Fu(t,e,n){return e=(n?Ro(t,e,n):e===it)?1:Ds(e),(Mp(t)?Cn:ui)(t,e)}function Su(t){return(Mp(t)?Tn:ci)(t)}function Du(t){if(null==t)return 0;if(Ku(t))return _s(t)?Q(t):t.length;var e=Nf(t);return e==Xt||e==ie?t.size:zr(t).length}function ku(t,e,n){var r=Mp(t)?_:fi;return n&&Ro(t,e,n)&&(e=it),r(t,So(e,3))}function Eu(t,e){if("function"!=typeof e)throw new dl(st);return t=Ds(t),function(){if(--t<1)return e.apply(this,arguments)}}function Cu(t,e,n){return e=n?it:e,e=t&&null==e?t.length:e,po(t,Ft,it,it,it,it,e)}function Tu(t,e){var n;if("function"!=typeof e)throw new dl(st);return t=Ds(t),function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=it),n}}function Nu(t,e,n){e=n?it:e;var r=po(t,bt,it,it,it,it,it,e);return r.placeholder=Nu.placeholder,r}function Ou(t,e,n){e=n?it:e;var r=po(t,Mt,it,it,it,it,it,e);return r.placeholder=Ou.placeholder,r}function Au(t,e,n){function r(e){var n=p,r=h;return p=h=it,v=e,y=t.apply(r,n)}function i(t){return v=t,m=jf(u,e),_?r(t):y}function o(t){var n=t-g,r=t-v,i=e-n;return b?Kl(i,d-r):i}function a(t){var n=t-g,r=t-v;return g===it||n>=e||n<0||b&&r>=d}function u(){var t=cp();if(a(t))return s(t);m=jf(u,o(t))}function s(t){return m=it,M&&p?r(t):(p=h=it,y)}function c(){m!==it&&Df(m),v=0,p=g=h=m=it}function l(){return m===it?y:s(cp())}function f(){var t=cp(),n=a(t);if(p=arguments,h=this,g=t,n){if(m===it)return i(g);if(b)return m=jf(u,e),r(g)}return m===it&&(m=jf(u,e)),y}var p,h,d,y,m,g,v=0,_=!1,b=!1,M=!0;if("function"!=typeof t)throw new dl(st);return e=Es(e)||0,ss(n)&&(_=!!n.leading,b="maxWait"in n,d=b?Vl(Es(n.maxWait)||0,e):d,M="trailing"in n?!!n.trailing:M),f.cancel=c,f.flush=l,f}function ju(t){return po(t,Dt)}function Pu(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new dl(st);var n=function(){var r=arguments,i=e?e.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=t.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new(Pu.Cache||pn),n}function Iu(t){if("function"!=typeof t)throw new dl(st);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}function Hu(t){return Tu(2,t)}function Lu(t,e){if("function"!=typeof t)throw new dl(st);return e=e===it?e:Ds(e),oi(t,e)}function Ru(t,e){if("function"!=typeof t)throw new dl(st);return e=null==e?0:Vl(Ds(e),0),oi(function(n){var r=n[e],i=ki(n,0,e);return r&&m(i,r),u(t,this,i)})}function $u(t,e,n){var r=!0,i=!0;if("function"!=typeof t)throw new dl(st);return ss(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),Au(t,e,{leading:r,maxWait:e,trailing:i})}function zu(t){return Cu(t,1)}function Wu(t,e){return yp(Si(e),t)}function Bu(){if(!arguments.length)return[];var t=arguments[0];return Mp(t)?t:[t]}function qu(t){return $n(t,dt)}function Uu(t,e){return e="function"==typeof e?e:it,$n(t,dt,e)}function Yu(t){return $n(t,pt|dt)}function Gu(t,e){return e="function"==typeof e?e:it,$n(t,pt|dt,e)}function Ju(t,e){return null==e||Wn(t,e,qs(e))}function Vu(t,e){return t===e||t!==t&&e!==e}function Ku(t){return null!=t&&us(t.length)&&!os(t)}function Xu(t){return cs(t)&&Ku(t)}function Zu(t){return!0===t||!1===t||cs(t)&&fr(t)==Ut}function Qu(t){return cs(t)&&1===t.nodeType&&!gs(t)}function ts(t){if(null==t)return!0;if(Ku(t)&&(Mp(t)||"string"==typeof t||"function"==typeof t.splice||xp(t)||Ep(t)||bp(t)))return!t.length;var e=Nf(t);if(e==Xt||e==ie)return!t.size;if(qo(t))return!zr(t).length;for(var n in t)if(bl.call(t,n))return!1;return!0}function es(t,e){return Or(t,e)}function ns(t,e,n){n="function"==typeof n?n:it;var r=n?n(t,e):it;return r===it?Or(t,e,it,n):!!r}function rs(t){if(!cs(t))return!1;var e=fr(t);return e==Jt||e==Gt||"string"==typeof t.message&&"string"==typeof t.name&&!gs(t)}function is(t){return"number"==typeof t&&Yl(t)}function os(t){if(!ss(t))return!1;var e=fr(t);return e==Vt||e==Kt||e==qt||e==ne}function as(t){return"number"==typeof t&&t==Ds(t)}function us(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=Pt}function ss(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function cs(t){return null!=t&&"object"==typeof t}function ls(t,e){return t===e||Pr(t,e,ko(e))}function fs(t,e,n){return n="function"==typeof n?n:it,Pr(t,e,ko(e),n)}function ps(t){return ms(t)&&t!=+t}function hs(t){if(Of(t))throw new sl(ut);return Ir(t)}function ds(t){return null===t}function ys(t){return null==t}function ms(t){return"number"==typeof t||cs(t)&&fr(t)==Zt}function gs(t){if(!cs(t)||fr(t)!=te)return!1;var e=Nl(t);if(null===e)return!0;var n=bl.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&_l.call(n)==Fl}function vs(t){return as(t)&&t>=-Pt&&t<=Pt}function _s(t){return"string"==typeof t||!Mp(t)&&cs(t)&&fr(t)==oe}function bs(t){return"symbol"==typeof t||cs(t)&&fr(t)==ae}function Ms(t){return t===it}function ws(t){return cs(t)&&Nf(t)==se}function xs(t){return cs(t)&&fr(t)==ce}function Fs(t){if(!t)return[];if(Ku(t))return _s(t)?tt(t):$i(t);if(Il&&t[Il])return U(t[Il]());var e=Nf(t);return(e==Xt?Y:e==ie?V:rc)(t)}function Ss(t){if(!t)return 0===t?t:0;if((t=Es(t))===jt||t===-jt){return(t<0?-1:1)*It}return t===t?t:0}function Ds(t){var e=Ss(t),n=e%1;return e===e?n?e-n:e:0}function ks(t){return t?Rn(Ds(t),0,Lt):0}function Es(t){if("number"==typeof t)return t;if(bs(t))return Ht;if(ss(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=ss(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(He,"");var n=Je.test(t);return n||Ke.test(t)?ir(t.slice(2),n?2:8):Ge.test(t)?Ht:+t}function Cs(t){return zi(t,Us(t))}function Ts(t){return t?Rn(Ds(t),-Pt,Pt):0===t?t:0}function Ns(t){return null==t?"":mi(t)}function Os(t,e){var n=vf(t);return null==e?n:Pn(n,e)}function As(t,e){return w(t,So(e,3),nr)}function js(t,e){return w(t,So(e,3),or)}function Ps(t,e){return null==t?t:Mf(t,So(e,3),Us)}function Is(t,e){return null==t?t:wf(t,So(e,3),Us)}function Hs(t,e){return t&&nr(t,So(e,3))}function Ls(t,e){return t&&or(t,So(e,3))}function Rs(t){return null==t?[]:ar(t,qs(t))}function $s(t){return null==t?[]:ar(t,Us(t))}function zs(t,e,n){var r=null==t?it:sr(t,e);return r===it?n:r}function Ws(t,e){return null!=t&&Oo(t,e,_r)}function Bs(t,e){return null!=t&&Oo(t,e,xr)}function qs(t){return Ku(t)?kn(t):zr(t)}function Us(t){return Ku(t)?kn(t,!0):Wr(t)}function Ys(t,e){var n={};return e=So(e,3),nr(t,function(t,r,i){Hn(n,e(t,r,i),t)}),n}function Gs(t,e){var n={};return e=So(e,3),nr(t,function(t,r,i){Hn(n,r,e(t,r,i))}),n}function Js(t,e){return Vs(t,Iu(So(e)))}function Vs(t,e){if(null==t)return{};var n=y(wo(t),function(t){return[t]});return e=So(e),Zr(t,n,function(t,n){return e(t,n[0])})}function Ks(t,e,n){e=Di(e,t);var r=-1,i=e.length;for(i||(i=1,t=it);++r<i;){var o=null==t?it:t[ra(e[r])];o===it&&(r=i,o=n),t=os(o)?o.call(t):o}return t}function Xs(t,e,n){return null==t?t:si(t,e,n)}function Zs(t,e,n,r){return r="function"==typeof r?r:it,null==t?t:si(t,e,n,r)}function Qs(t,e,n){var r=Mp(t),i=r||xp(t)||Ep(t);if(e=So(e,4),null==n){var o=t&&t.constructor;n=i?r?new o:[]:ss(t)&&os(o)?vf(Nl(t)):{}}return(i?c:nr)(t,function(t,r,i){return e(n,t,r,i)}),n}function tc(t,e){return null==t||vi(t,e)}function ec(t,e,n){return null==t?t:_i(t,e,Si(n))}function nc(t,e,n,r){return r="function"==typeof r?r:it,null==t?t:_i(t,e,Si(n),r)}function rc(t){return null==t?[]:I(t,qs(t))}function ic(t){return null==t?[]:I(t,Us(t))}function oc(t,e,n){return n===it&&(n=e,e=it),n!==it&&(n=Es(n),n=n===n?n:0),e!==it&&(e=Es(e),e=e===e?e:0),Rn(Es(t),e,n)}function ac(t,e,n){return e=Ss(e),n===it?(n=e,e=0):n=Ss(n),t=Es(t),Sr(t,e,n)}function uc(t,e,n){if(n&&"boolean"!=typeof n&&Ro(t,e,n)&&(e=n=it),n===it&&("boolean"==typeof e?(n=e,e=it):"boolean"==typeof t&&(n=t,t=it)),t===it&&e===it?(t=0,e=1):(t=Ss(t),e===it?(e=t,t=0):e=Ss(e)),t>e){var r=t;t=e,e=r}if(n||t%1||e%1){var i=Ql();return Kl(t+i*(e-t+rr("1e-"+((i+"").length-1))),e)}return ni(t,e)}function sc(t){return th(Ns(t).toLowerCase())}function cc(t){return(t=Ns(t))&&t.replace(Ze,br).replace(qn,"")}function lc(t,e,n){t=Ns(t),e=mi(e);var r=t.length;n=n===it?r:Rn(Ds(n),0,r);var i=n;return(n-=e.length)>=0&&t.slice(n,i)==e}function fc(t){return t=Ns(t),t&&ke.test(t)?t.replace(Se,Mr):t}function pc(t){return t=Ns(t),t&&Ie.test(t)?t.replace(Pe,"\\\\$&"):t}function hc(t,e,n){t=Ns(t),e=Ds(e);var r=e?Q(t):0;if(!e||r>=e)return t;var i=(e-r)/2;return oo(Bl(i),n)+t+oo(Wl(i),n)}function dc(t,e,n){t=Ns(t),e=Ds(e);var r=e?Q(t):0;return e&&r<e?t+oo(e-r,n):t}function yc(t,e,n){t=Ns(t),e=Ds(e);var r=e?Q(t):0;return e&&r<e?oo(e-r,n)+t:t}function mc(t,e,n){return n||null==e?e=0:e&&(e=+e),Zl(Ns(t).replace(Le,""),e||0)}function gc(t,e,n){return e=(n?Ro(t,e,n):e===it)?1:Ds(e),ii(Ns(t),e)}function vc(){var t=arguments,e=Ns(t[0]);return t.length<3?e:e.replace(t[1],t[2])}function _c(t,e,n){return n&&"number"!=typeof n&&Ro(t,e,n)&&(e=n=it),(n=n===it?Lt:n>>>0)?(t=Ns(t),t&&("string"==typeof e||null!=e&&!Dp(e))&&!(e=mi(e))&&B(t)?ki(tt(t),0,n):t.split(e,n)):[]}function bc(t,e,n){return t=Ns(t),n=null==n?0:Rn(Ds(n),0,t.length),e=mi(e),t.slice(n,n+e.length)==e}function Mc(t,e,r){var i=n.templateSettings;r&&Ro(t,e,r)&&(e=it),t=Ns(t),e=Ap({},e,i,ho);var o,a,u=Ap({},e.imports,i.imports,ho),s=qs(u),c=I(u,s),l=0,f=e.interpolate||Qe,p="__p += \'",h=pl((e.escape||Qe).source+"|"+f.source+"|"+(f===Te?Ue:Qe).source+"|"+(e.evaluate||Qe).source+"|$","g"),d="//# sourceURL="+("sourceURL"in e?e.sourceURL:"lodash.templateSources["+ ++Kn+"]")+"\\n";t.replace(h,function(e,n,r,i,u,s){return r||(r=i),p+=t.slice(l,s).replace(tn,z),n&&(o=!0,p+="\' +\\n__e("+n+") +\\n\'"),u&&(a=!0,p+="\';\\n"+u+";\\n__p += \'"),r&&(p+="\' +\\n((__t = ("+r+")) == null ? \'\' : __t) +\\n\'"),l=s+e.length,e}),p+="\';\\n";var y=e.variable;y||(p="with (obj) {\\n"+p+"\\n}\\n"),p=(a?p.replace(Me,""):p).replace(we,"$1").replace(xe,"$1;"),p="function("+(y||"obj")+") {\\n"+(y?"":"obj || (obj = {});\\n")+"var __t, __p = \'\'"+(o?", __e = _.escape":"")+(a?", __j = Array.prototype.join;\\nfunction print() { __p += __j.call(arguments, \'\') }\\n":";\\n")+p+"return __p\\n}";var m=eh(function(){return cl(s,d+"return "+p).apply(it,c)});if(m.source=p,rs(m))throw m;return m}function wc(t){return Ns(t).toLowerCase()}function xc(t){return Ns(t).toUpperCase()}function Fc(t,e,n){if((t=Ns(t))&&(n||e===it))return t.replace(He,"");if(!t||!(e=mi(e)))return t;var r=tt(t),i=tt(e);return ki(r,L(r,i),R(r,i)+1).join("")}function Sc(t,e,n){if((t=Ns(t))&&(n||e===it))return t.replace(Re,"");if(!t||!(e=mi(e)))return t;var r=tt(t);return ki(r,0,R(r,tt(e))+1).join("")}function Dc(t,e,n){if((t=Ns(t))&&(n||e===it))return t.replace(Le,"");if(!t||!(e=mi(e)))return t;var r=tt(t);return ki(r,L(r,tt(e))).join("")}function kc(t,e){var n=kt,r=Et;if(ss(e)){var i="separator"in e?e.separator:i;n="length"in e?Ds(e.length):n,r="omission"in e?mi(e.omission):r}t=Ns(t);var o=t.length;if(B(t)){var a=tt(t);o=a.length}if(n>=o)return t;var u=n-Q(r);if(u<1)return r;var s=a?ki(a,0,u).join(""):t.slice(0,u);if(i===it)return s+r;if(a&&(u+=s.length-u),Dp(i)){if(t.slice(u).search(i)){var c,l=s;for(i.global||(i=pl(i.source,Ns(Ye.exec(i))+"g")),i.lastIndex=0;c=i.exec(l);)var f=c.index;s=s.slice(0,f===it?u:f)}}else if(t.indexOf(mi(i),u)!=u){var p=s.lastIndexOf(i);p>-1&&(s=s.slice(0,p))}return s+r}function Ec(t){return t=Ns(t),t&&De.test(t)?t.replace(Fe,wr):t}function Cc(t,e,n){return t=Ns(t),e=n?it:e,e===it?q(t)?rt(t):M(t):t.match(e)||[]}function Tc(t){var e=null==t?0:t.length,n=So();return t=e?y(t,function(t){if("function"!=typeof t[1])throw new dl(st);return[n(t[0]),t[1]]}):[],oi(function(n){for(var r=-1;++r<e;){var i=t[r];if(u(i[0],this,n))return u(i[1],this,n)}})}function Nc(t){return zn($n(t,pt))}function Oc(t){return function(){return t}}function Ac(t,e){return null==t||t!==t?e:t}function jc(t){return t}function Pc(t){return $r("function"==typeof t?t:$n(t,pt))}function Ic(t){return Ur($n(t,pt))}function Hc(t,e){return Yr(t,$n(e,pt))}function Lc(t,e,n){var r=qs(e),i=ar(e,r);null!=n||ss(e)&&(i.length||!r.length)||(n=e,e=t,t=this,i=ar(e,qs(e)));var o=!(ss(n)&&"chain"in n&&!n.chain),a=os(t);return c(i,function(n){var r=e[n];t[n]=r,a&&(t.prototype[n]=function(){var e=this.__chain__;if(o||e){var n=t(this.__wrapped__);return(n.__actions__=$i(this.__actions__)).push({func:r,args:arguments,thisArg:t}),n.__chain__=e,n}return r.apply(t,m([this.value()],arguments))})}),t}function Rc(){return ur._===this&&(ur._=Sl),this}function $c(){}function zc(t){return t=Ds(t),oi(function(e){return Vr(e,t)})}function Wc(t){return $o(t)?E(ra(t)):Qr(t)}function Bc(t){return function(e){return null==t?it:sr(t,e)}}function qc(){return[]}function Uc(){return!1}function Yc(){return{}}function Gc(){return""}function Jc(){return!0}function Vc(t,e){if((t=Ds(t))<1||t>Pt)return[];var n=Lt,r=Kl(t,Lt);e=So(e),t-=Lt;for(var i=A(r,e);++n<t;)e(n);return i}function Kc(t){return Mp(t)?y(t,ra):bs(t)?[t]:$i(If(Ns(t)))}function Xc(t){var e=++Ml;return Ns(t)+e}function Zc(t){return t&&t.length?Jn(t,jc,pr):it}function Qc(t,e){return t&&t.length?Jn(t,So(e,2),pr):it}function tl(t){return k(t,jc)}function el(t,e){return k(t,So(e,2))}function nl(t){return t&&t.length?Jn(t,jc,Br):it}function rl(t,e){return t&&t.length?Jn(t,So(e,2),Br):it}function il(t){return t&&t.length?O(t,jc):0}function ol(t,e){return t&&t.length?O(t,So(e,2)):0}e=null==e?ur:Fr.defaults(ur.Object(),e,Fr.pick(ur,Vn));var al=e.Array,ul=e.Date,sl=e.Error,cl=e.Function,ll=e.Math,fl=e.Object,pl=e.RegExp,hl=e.String,dl=e.TypeError,yl=al.prototype,ml=cl.prototype,gl=fl.prototype,vl=e["__core-js_shared__"],_l=ml.toString,bl=gl.hasOwnProperty,Ml=0,wl=function(){var t=/[^.]+$/.exec(vl&&vl.keys&&vl.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),xl=gl.toString,Fl=_l.call(fl),Sl=ur._,Dl=pl("^"+_l.call(bl).replace(Pe,"\\\\$&").replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g,"$1.*?")+"$"),kl=lr?e.Buffer:it,El=e.Symbol,Cl=e.Uint8Array,Tl=kl?kl.allocUnsafe:it,Nl=G(fl.getPrototypeOf,fl),Ol=fl.create,Al=gl.propertyIsEnumerable,jl=yl.splice,Pl=El?El.isConcatSpreadable:it,Il=El?El.iterator:it,Hl=El?El.toStringTag:it,Ll=function(){try{var t=Eo(fl,"defineProperty");return t({},"",{}),t}catch(t){}}(),Rl=e.clearTimeout!==ur.clearTimeout&&e.clearTimeout,$l=ul&&ul.now!==ur.Date.now&&ul.now,zl=e.setTimeout!==ur.setTimeout&&e.setTimeout,Wl=ll.ceil,Bl=ll.floor,ql=fl.getOwnPropertySymbols,Ul=kl?kl.isBuffer:it,Yl=e.isFinite,Gl=yl.join,Jl=G(fl.keys,fl),Vl=ll.max,Kl=ll.min,Xl=ul.now,Zl=e.parseInt,Ql=ll.random,tf=yl.reverse,ef=Eo(e,"DataView"),nf=Eo(e,"Map"),rf=Eo(e,"Promise"),of=Eo(e,"Set"),af=Eo(e,"WeakMap"),uf=Eo(fl,"create"),sf=af&&new af,cf={},lf=ia(ef),ff=ia(nf),pf=ia(rf),hf=ia(of),df=ia(af),yf=El?El.prototype:it,mf=yf?yf.valueOf:it,gf=yf?yf.toString:it,vf=function(){function t(){}return function(e){if(!ss(e))return{};if(Ol)return Ol(e);t.prototype=e;var n=new t;return t.prototype=it,n}}();n.templateSettings={escape:Ee,evaluate:Ce,interpolate:Te,variable:"",imports:{_:n}},n.prototype=r.prototype,n.prototype.constructor=n,i.prototype=vf(r.prototype),i.prototype.constructor=i,b.prototype=vf(r.prototype),b.prototype.constructor=b,nt.prototype.clear=Be,nt.prototype.delete=en,nt.prototype.get=nn,nt.prototype.has=rn,nt.prototype.set=on,an.prototype.clear=un,an.prototype.delete=sn,an.prototype.get=cn,an.prototype.has=ln,an.prototype.set=fn,pn.prototype.clear=hn,pn.prototype.delete=dn,pn.prototype.get=yn,pn.prototype.has=mn,pn.prototype.set=gn,vn.prototype.add=vn.prototype.push=_n,vn.prototype.has=bn,Mn.prototype.clear=wn,Mn.prototype.delete=xn,Mn.prototype.get=Fn,Mn.prototype.has=Sn,Mn.prototype.set=Dn;var _f=Yi(nr),bf=Yi(or,!0),Mf=Gi(),wf=Gi(!0),xf=sf?function(t,e){return sf.set(t,e),t}:jc,Ff=Ll?function(t,e){return Ll(t,"toString",{configurable:!0,enumerable:!1,value:Oc(e),writable:!0})}:jc,Sf=oi,Df=Rl||function(t){return ur.clearTimeout(t)},kf=of&&1/V(new of([,-0]))[1]==jt?function(t){return new of(t)}:$c,Ef=sf?function(t){return sf.get(t)}:$c,Cf=ql?function(t){return null==t?[]:(t=fl(t),p(ql(t),function(e){return Al.call(t,e)}))}:qc,Tf=ql?function(t){for(var e=[];t;)m(e,Cf(t)),t=Nl(t);return e}:qc,Nf=fr;(ef&&Nf(new ef(new ArrayBuffer(1)))!=fe||nf&&Nf(new nf)!=Xt||rf&&Nf(rf.resolve())!=ee||of&&Nf(new of)!=ie||af&&Nf(new af)!=se)&&(Nf=function(t){var e=fr(t),n=e==te?t.constructor:it,r=n?ia(n):"";if(r)switch(r){case lf:return fe;case ff:return Xt;case pf:return ee;case hf:return ie;case df:return se}return e});var Of=vl?os:Uc,Af=ea(xf),jf=zl||function(t,e){return ur.setTimeout(t,e)},Pf=ea(Ff),If=Go(function(t){var e=[];return Ae.test(t)&&e.push(""),t.replace(je,function(t,n,r,i){e.push(r?i.replace(qe,"$1"):n||t)}),e}),Hf=oi(function(t,e){return Xu(t)?Yn(t,er(e,1,Xu,!0)):[]}),Lf=oi(function(t,e){var n=Sa(e);return Xu(n)&&(n=it),Xu(t)?Yn(t,er(e,1,Xu,!0),So(n,2)):[]}),Rf=oi(function(t,e){var n=Sa(e);return Xu(n)&&(n=it),Xu(t)?Yn(t,er(e,1,Xu,!0),it,n):[]}),$f=oi(function(t){var e=y(t,Fi);return e.length&&e[0]===t[0]?Dr(e):[]}),zf=oi(function(t){var e=Sa(t),n=y(t,Fi);return e===Sa(n)?e=it:n.pop(),n.length&&n[0]===t[0]?Dr(n,So(e,2)):[]}),Wf=oi(function(t){var e=Sa(t),n=y(t,Fi);return e="function"==typeof e?e:it,e&&n.pop(),n.length&&n[0]===t[0]?Dr(n,it,e):[]}),Bf=oi(Ea),qf=bo(function(t,e){var n=null==t?0:t.length,r=Ln(t,e);return ei(t,y(e,function(t){return Lo(t,n)?+t:t}).sort(Ii)),r}),Uf=oi(function(t){return gi(er(t,1,Xu,!0))}),Yf=oi(function(t){var e=Sa(t);return Xu(e)&&(e=it),gi(er(t,1,Xu,!0),So(e,2))}),Gf=oi(function(t){var e=Sa(t);return e="function"==typeof e?e:it,gi(er(t,1,Xu,!0),it,e)}),Jf=oi(function(t,e){return Xu(t)?Yn(t,e):[]}),Vf=oi(function(t){return wi(p(t,Xu))}),Kf=oi(function(t){var e=Sa(t);return Xu(e)&&(e=it),wi(p(t,Xu),So(e,2))}),Xf=oi(function(t){var e=Sa(t);return e="function"==typeof e?e:it,wi(p(t,Xu),it,e)}),Zf=oi(Ka),Qf=oi(function(t){var e=t.length,n=e>1?t[e-1]:it;return n="function"==typeof n?(t.pop(),n):it,Xa(t,n)}),tp=bo(function(t){var e=t.length,n=e?t[0]:0,r=this.__wrapped__,o=function(e){return Ln(e,t)};return!(e>1||this.__actions__.length)&&r instanceof b&&Lo(n)?(r=r.slice(n,+n+(e?1:0)),r.__actions__.push({func:nu,args:[o],thisArg:it}),new i(r,this.__chain__).thru(function(t){return e&&!t.length&&t.push(it),t})):this.thru(o)}),ep=qi(function(t,e,n){bl.call(t,n)?++t[n]:Hn(t,n,1)}),np=Qi(ya),rp=Qi(ma),ip=qi(function(t,e,n){bl.call(t,n)?t[n].push(e):Hn(t,n,[e])}),op=oi(function(t,e,n){var r=-1,i="function"==typeof e,o=Ku(t)?al(t.length):[];return _f(t,function(t){o[++r]=i?u(e,t,n):Er(t,e,n)}),o}),ap=qi(function(t,e,n){Hn(t,n,e)}),up=qi(function(t,e,n){t[n?0:1].push(e)},function(){return[[],[]]}),sp=oi(function(t,e){if(null==t)return[];var n=e.length;return n>1&&Ro(t,e[0],e[1])?e=[]:n>2&&Ro(e[0],e[1],e[2])&&(e=[e[0]]),Kr(t,er(e,1),[])}),cp=$l||function(){return ur.Date.now()},lp=oi(function(t,e,n){var r=gt;if(n.length){var i=J(n,Fo(lp));r|=wt}return po(t,r,e,n,i)}),fp=oi(function(t,e,n){var r=gt|vt;if(n.length){var i=J(n,Fo(fp));r|=wt}return po(e,r,t,n,i)}),pp=oi(function(t,e){return Un(t,1,e)}),hp=oi(function(t,e,n){return Un(t,Es(e)||0,n)});Pu.Cache=pn;var dp=Sf(function(t,e){e=1==e.length&&Mp(e[0])?y(e[0],P(So())):y(er(e,1),P(So()));var n=e.length;return oi(function(r){for(var i=-1,o=Kl(r.length,n);++i<o;)r[i]=e[i].call(this,r[i]);return u(t,this,r)})}),yp=oi(function(t,e){var n=J(e,Fo(yp));return po(t,wt,it,e,n)}),mp=oi(function(t,e){var n=J(e,Fo(mp));return po(t,xt,it,e,n)}),gp=bo(function(t,e){return po(t,St,it,it,it,e)}),vp=so(pr),_p=so(function(t,e){return t>=e}),bp=Cr(function(){return arguments}())?Cr:function(t){return cs(t)&&bl.call(t,"callee")&&!Al.call(t,"callee")},Mp=al.isArray,wp=hr?P(hr):Tr,xp=Ul||Uc,Fp=dr?P(dr):Nr,Sp=yr?P(yr):jr,Dp=mr?P(mr):Hr,kp=gr?P(gr):Lr,Ep=vr?P(vr):Rr,Cp=so(Br),Tp=so(function(t,e){return t<=e}),Np=Ui(function(t,e){if(qo(e)||Ku(e))return void zi(e,qs(e),t);for(var n in e)bl.call(e,n)&&On(t,n,e[n])}),Op=Ui(function(t,e){zi(e,Us(e),t)}),Ap=Ui(function(t,e,n,r){zi(e,Us(e),t,r)}),jp=Ui(function(t,e,n,r){zi(e,qs(e),t,r)}),Pp=bo(Ln),Ip=oi(function(t){return t.push(it,ho),u(Ap,it,t)}),Hp=oi(function(t){return t.push(it,yo),u(Wp,it,t)}),Lp=no(function(t,e,n){t[e]=n},Oc(jc)),Rp=no(function(t,e,n){bl.call(t,e)?t[e].push(n):t[e]=[n]},So),$p=oi(Er),zp=Ui(function(t,e,n){Gr(t,e,n)}),Wp=Ui(function(t,e,n,r){Gr(t,e,n,r)}),Bp=bo(function(t,e){var n={};if(null==t)return n;var r=!1;e=y(e,function(e){return e=Di(e,t),r||(r=e.length>1),e}),zi(t,wo(t),n),r&&(n=$n(n,pt|ht|dt,mo));for(var i=e.length;i--;)vi(n,e[i]);return n}),qp=bo(function(t,e){return null==t?{}:Xr(t,e)}),Up=fo(qs),Yp=fo(Us),Gp=Ki(function(t,e,n){return e=e.toLowerCase(),t+(n?sc(e):e)}),Jp=Ki(function(t,e,n){return t+(n?"-":"")+e.toLowerCase()}),Vp=Ki(function(t,e,n){return t+(n?" ":"")+e.toLowerCase()}),Kp=Vi("toLowerCase"),Xp=Ki(function(t,e,n){return t+(n?"_":"")+e.toLowerCase()}),Zp=Ki(function(t,e,n){return t+(n?" ":"")+th(e)}),Qp=Ki(function(t,e,n){return t+(n?" ":"")+e.toUpperCase()}),th=Vi("toUpperCase"),eh=oi(function(t,e){try{return u(t,it,e)}catch(t){return rs(t)?t:new sl(t)}}),nh=bo(function(t,e){return c(e,function(e){e=ra(e),Hn(t,e,lp(t[e],t))}),t}),rh=to(),ih=to(!0),oh=oi(function(t,e){return function(n){return Er(n,t,e)}}),ah=oi(function(t,e){return function(n){return Er(t,n,e)}}),uh=io(y),sh=io(f),ch=io(_),lh=uo(),fh=uo(!0),ph=ro(function(t,e){return t+e},0),hh=lo("ceil"),dh=ro(function(t,e){return t/e},1),yh=lo("floor"),mh=ro(function(t,e){return t*e},1),gh=lo("round"),vh=ro(function(t,e){return t-e},0);return n.after=Eu,n.ary=Cu,n.assign=Np,n.assignIn=Op,n.assignInWith=Ap,n.assignWith=jp,n.at=Pp,n.before=Tu,n.bind=lp,n.bindAll=nh,n.bindKey=fp,n.castArray=Bu,n.chain=tu,n.chunk=ua,n.compact=sa,n.concat=ca,n.cond=Tc,n.conforms=Nc,n.constant=Oc,n.countBy=ep,n.create=Os,n.curry=Nu,n.curryRight=Ou,n.debounce=Au,n.defaults=Ip,n.defaultsDeep=Hp,n.defer=pp,n.delay=hp,n.difference=Hf,n.differenceBy=Lf,n.differenceWith=Rf,n.drop=la,n.dropRight=fa,n.dropRightWhile=pa,n.dropWhile=ha,n.fill=da,n.filter=fu,n.flatMap=pu,n.flatMapDeep=hu,n.flatMapDepth=du,n.flatten=ga,n.flattenDeep=va,n.flattenDepth=_a,n.flip=ju,n.flow=rh,n.flowRight=ih,n.fromPairs=ba,n.functions=Rs,n.functionsIn=$s,n.groupBy=ip,n.initial=xa,n.intersection=$f,n.intersectionBy=zf,n.intersectionWith=Wf,n.invert=Lp,n.invertBy=Rp,n.invokeMap=op,n.iteratee=Pc,n.keyBy=ap,n.keys=qs,n.keysIn=Us,n.map=vu,n.mapKeys=Ys,n.mapValues=Gs,n.matches=Ic,n.matchesProperty=Hc,n.memoize=Pu,n.merge=zp,n.mergeWith=Wp,n.method=oh,n.methodOf=ah,n.mixin=Lc,n.negate=Iu,n.nthArg=zc,n.omit=Bp,n.omitBy=Js,n.once=Hu,n.orderBy=_u,n.over=uh,n.overArgs=dp,n.overEvery=sh,n.overSome=ch,n.partial=yp,n.partialRight=mp,n.partition=up,n.pick=qp,n.pickBy=Vs,n.property=Wc,n.propertyOf=Bc,n.pull=Bf,n.pullAll=Ea,n.pullAllBy=Ca,n.pullAllWith=Ta,n.pullAt=qf,n.range=lh,n.rangeRight=fh,n.rearg=gp,n.reject=wu,n.remove=Na,n.rest=Lu,n.reverse=Oa,n.sampleSize=Fu,n.set=Xs,n.setWith=Zs,n.shuffle=Su,n.slice=Aa,n.sortBy=sp,n.sortedUniq=$a,n.sortedUniqBy=za,n.split=_c,n.spread=Ru,n.tail=Wa,n.take=Ba,n.takeRight=qa,n.takeRightWhile=Ua,n.takeWhile=Ya,n.tap=eu,n.throttle=$u,n.thru=nu,n.toArray=Fs,n.toPairs=Up,n.toPairsIn=Yp,n.toPath=Kc,n.toPlainObject=Cs,n.transform=Qs,n.unary=zu,n.union=Uf,n.unionBy=Yf,n.unionWith=Gf,n.uniq=Ga,n.uniqBy=Ja,n.uniqWith=Va,n.unset=tc,n.unzip=Ka,n.unzipWith=Xa,n.update=ec,n.updateWith=nc,n.values=rc,n.valuesIn=ic,n.without=Jf,n.words=Cc,n.wrap=Wu,n.xor=Vf,n.xorBy=Kf,n.xorWith=Xf,n.zip=Zf,n.zipObject=Za,n.zipObjectDeep=Qa,n.zipWith=Qf,n.entries=Up,n.entriesIn=Yp,n.extend=Op,n.extendWith=Ap,Lc(n,n),n.add=ph,n.attempt=eh,n.camelCase=Gp,n.capitalize=sc,n.ceil=hh,n.clamp=oc,n.clone=qu,n.cloneDeep=Yu,n.cloneDeepWith=Gu,n.cloneWith=Uu,n.conformsTo=Ju,n.deburr=cc,n.defaultTo=Ac,n.divide=dh,n.endsWith=lc,n.eq=Vu,n.escape=fc,n.escapeRegExp=pc,n.every=lu,n.find=np,n.findIndex=ya,n.findKey=As,n.findLast=rp,n.findLastIndex=ma,n.findLastKey=js,n.floor=yh,n.forEach=yu,n.forEachRight=mu,n.forIn=Ps,n.forInRight=Is,n.forOwn=Hs,n.forOwnRight=Ls,n.get=zs,n.gt=vp,n.gte=_p,n.has=Ws,n.hasIn=Bs,n.head=Ma,n.identity=jc,n.includes=gu,n.indexOf=wa,n.inRange=ac,n.invoke=$p,n.isArguments=bp,n.isArray=Mp,n.isArrayBuffer=wp,n.isArrayLike=Ku,n.isArrayLikeObject=Xu,n.isBoolean=Zu,n.isBuffer=xp,n.isDate=Fp,n.isElement=Qu,n.isEmpty=ts,n.isEqual=es,n.isEqualWith=ns,n.isError=rs,n.isFinite=is,n.isFunction=os,n.isInteger=as,n.isLength=us,n.isMap=Sp,n.isMatch=ls,n.isMatchWith=fs,n.isNaN=ps,n.isNative=hs,n.isNil=ys,n.isNull=ds,n.isNumber=ms,n.isObject=ss,n.isObjectLike=cs,n.isPlainObject=gs,n.isRegExp=Dp,n.isSafeInteger=vs,n.isSet=kp,n.isString=_s,n.isSymbol=bs,n.isTypedArray=Ep,n.isUndefined=Ms,n.isWeakMap=ws,n.isWeakSet=xs,n.join=Fa,n.kebabCase=Jp,n.last=Sa,n.lastIndexOf=Da,n.lowerCase=Vp,n.lowerFirst=Kp,n.lt=Cp,n.lte=Tp,n.max=Zc,n.maxBy=Qc,n.mean=tl,n.meanBy=el,n.min=nl,n.minBy=rl,n.stubArray=qc,n.stubFalse=Uc,n.stubObject=Yc,n.stubString=Gc,n.stubTrue=Jc,n.multiply=mh,n.nth=ka,n.noConflict=Rc,n.noop=$c,n.now=cp,n.pad=hc,n.padEnd=dc,n.padStart=yc,n.parseInt=mc,n.random=uc,n.reduce=bu,n.reduceRight=Mu,n.repeat=gc,n.replace=vc,n.result=Ks,n.round=gh,n.runInContext=t,n.sample=xu,n.size=Du,n.snakeCase=Xp,n.some=ku,n.sortedIndex=ja,n.sortedIndexBy=Pa,n.sortedIndexOf=Ia,n.sortedLastIndex=Ha,n.sortedLastIndexBy=La,n.sortedLastIndexOf=Ra,n.startCase=Zp,n.startsWith=bc,n.subtract=vh,n.sum=il,n.sumBy=ol,n.template=Mc,n.times=Vc,n.toFinite=Ss,n.toInteger=Ds,n.toLength=ks,n.toLower=wc,n.toNumber=Es,n.toSafeInteger=Ts,n.toString=Ns,n.toUpper=xc,n.trim=Fc,n.trimEnd=Sc,n.trimStart=Dc,n.truncate=kc,n.unescape=Ec,n.uniqueId=Xc,n.upperCase=Qp,n.upperFirst=th,n.each=yu,n.eachRight=mu,n.first=Ma,Lc(n,function(){var t={};return nr(n,function(e,r){bl.call(n.prototype,r)||(t[r]=e)}),t}(),{chain:!1}),n.VERSION=ot,c(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){n[t].placeholder=n}),c(["drop","take"],function(t,e){b.prototype[t]=function(n){n=n===it?1:Vl(Ds(n),0);var r=this.__filtered__&&!e?new b(this):this.clone();return r.__filtered__?r.__takeCount__=Kl(n,r.__takeCount__):r.__views__.push({size:Kl(n,Lt),type:t+(r.__dir__<0?"Right":"")}),r},b.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}}),c(["filter","map","takeWhile"],function(t,e){var n=e+1,r=n==Nt||n==At;b.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:So(t,3),type:n}),e.__filtered__=e.__filtered__||r,e}}),c(["head","last"],function(t,e){var n="take"+(e?"Right":"");b.prototype[t]=function(){return this[n](1).value()[0]}}),c(["initial","tail"],function(t,e){var n="drop"+(e?"":"Right");b.prototype[t]=function(){return this.__filtered__?new b(this):this[n](1)}}),b.prototype.compact=function(){return this.filter(jc)},b.prototype.find=function(t){return this.filter(t).head()},b.prototype.findLast=function(t){return this.reverse().find(t)},b.prototype.invokeMap=oi(function(t,e){return"function"==typeof t?new b(this):this.map(function(n){return Er(n,t,e)})}),b.prototype.reject=function(t){return this.filter(Iu(So(t)))},b.prototype.slice=function(t,e){t=Ds(t);var n=this;return n.__filtered__&&(t>0||e<0)?new b(n):(t<0?n=n.takeRight(-t):t&&(n=n.drop(t)),e!==it&&(e=Ds(e),n=e<0?n.dropRight(-e):n.take(e-t)),n)},b.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},b.prototype.toArray=function(){return this.take(Lt)},nr(b.prototype,function(t,e){var r=/^(?:filter|find|map|reject)|While$/.test(e),o=/^(?:head|last)$/.test(e),a=n[o?"take"+("last"==e?"Right":""):e],u=o||/^find/.test(e);a&&(n.prototype[e]=function(){var e=this.__wrapped__,s=o?[1]:arguments,c=e instanceof b,l=s[0],f=c||Mp(e),p=function(t){var e=a.apply(n,m([t],s));return o&&h?e[0]:e};f&&r&&"function"==typeof l&&1!=l.length&&(c=f=!1);var h=this.__chain__,d=!!this.__actions__.length,y=u&&!h,g=c&&!d;if(!u&&f){e=g?e:new b(this);var v=t.apply(e,s);return v.__actions__.push({func:nu,args:[p],thisArg:it}),new i(v,h)}return y&&g?t.apply(this,s):(v=this.thru(p),y?o?v.value()[0]:v.value():v)})}),c(["pop","push","shift","sort","splice","unshift"],function(t){var e=yl[t],r=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",i=/^(?:pop|shift)$/.test(t);n.prototype[t]=function(){var t=arguments;if(i&&!this.__chain__){var n=this.value();return e.apply(Mp(n)?n:[],t)}return this[r](function(n){return e.apply(Mp(n)?n:[],t)})}}),nr(b.prototype,function(t,e){var r=n[e];if(r){var i=r.name+"";(cf[i]||(cf[i]=[])).push({name:e,func:r})}}),cf[eo(it,vt).name]=[{name:"wrapper",func:it}],b.prototype.clone=C,b.prototype.reverse=X,b.prototype.value=et,n.prototype.at=tp,n.prototype.chain=ru,n.prototype.commit=iu,n.prototype.next=ou,n.prototype.plant=uu,n.prototype.reverse=su,n.prototype.toJSON=n.prototype.valueOf=n.prototype.value=cu,n.prototype.first=n.prototype.head,Il&&(n.prototype[Il]=au),n},Fr=xr();ur._=Fr,(i=function(){return Fr}.call(e,n,e,r))!==it&&(r.exports=i)}).call(this)}).call(e,n(19),n(20)(t))},function(t,e,n){"use strict";function r(t){var e=t[0].toString(),n=e[e.length-1];return a[e.slice(0,e.length-1)].unpack([n,t[1],t[2]])}var i=n(0);e.Attribute=n(11),e.Delta=n(7);var o={TableOperator:n(25),CellOperator:n(14),TextOperator:n(27),Operator:n(8)};i.assign(e,o),e.pack=function(t){if("function"==typeof t.toJSON)return JSON.stringify(t);throw new Error("Only delta can be packed")},e.unpack=function(t){return e.Delta.unpack(JSON.parse(t))},e.print=function(t){t.print(!0)};var a=i.reduce(Object.keys(o),function(t,e){var n=o[e];return t[n.packId]=n,t},{});e.Delta.operatorUnpacker=r,Object.keys(o).forEach(function(t){o[t].operatorUnpacker=r});var u=n(2);e.parsePosition=u.parsePosition,e.stringifyPosition=u.stringifyPosition},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(0);e.clone=function(t){return"object"!=typeof t||null===t?t:o.cloneDeep(t,function(t){if("object"==typeof t&&t&&"function"==typeof t.clone)return t.clone()})},e.freeze=function(t){return t},e.isFrozen=function(t){return!1};var a=function(){function t(e){r(this,t),this.ops=e,this.index=0,this.offset=0}return i(t,[{key:"hasNext",value:function(){return this.peekLength()<1/0}},{key:"next",value:function(t){t||(t=1/0);var e=this.ops[this.index];if(!e)return null;var n=this.offset,r=e.length;if(0===n&&r===t)return this.index+=1,e;t>=r-n?(t=r-n,this.index+=1,this.offset=0):this.offset+=t;var i={action:e.action,attributes:e.attributes};switch(e.action){case"remove":i.data=t;break;case"retain":if("number"==typeof e.data)i.data=t;else{if("string"==typeof e.data)throw new Error("retain with a string is not allowed");i.data=e.data}break;case"insert":"string"==typeof e.data?i.data=e.data.substr(n,t):"number"==typeof e.data?i.data=t:i.data=e.data}return e.createInstance(i)}},{key:"peekLength",value:function(){var t=this.ops[this.index];return t?t.length-this.offset:1/0}},{key:"peekAction",value:function(){var t=this.ops[this.index];return t?t.action:"retain"}}]),t}();e.OperatorIterator=a,e.parsePosition=function(t){for(var e=0,n=0,r=0;r<t.length;r++){var i=t[r].charCodeAt(0);if(i>=65&&i<=90)n=26*n+i-64;else{if(!(i>=48&&i<=57))throw new Error("Invalid cell position "+t);e=10*e+i-48}}return{row:e-1,col:n-1}},e.stringifyPosition=function(t,e){if(!(t>=0&&e>=0))throw new Error("Invalid cell position "+t+":"+e);for(var n=e+1,r="";n>0;){var i=(n-1)%26;r=String.fromCharCode(65+i)+r,n=Math.floor((n-i)/26)}return r+(t+1)}},function(t,e,n){function r(t,e,n,r){if(t&&0<=n&&n<e){var i,o,a=[];for(o=n;o<e;o++)void 0!==t[o]&&a.push(o);for(i=a.length,o=0;o<i;o++){var u=a[i-o-1],s=t[u];t[u]=null,t[Math.floor(u)+r]=s}}}function i(t,e,n,r){if(t&&0<=n&&n<e){var i,o,a=[],u=n+r;for(o=n;o<e;o++)void 0!==t[o]&&(n<=o&&o<u?t[o]=null:o>=u&&a.push(o));for(i=a.length,o=0;o<i;o++){var s=a[o],c=t[s];t[s]=null,t[Math.floor(s)-r]=c}}}function o(t,e){return t.hasOwnProperty(e)}function a(t,e){return t instanceof e}var u={},s=n(9).CultureManager,c=function(t){return function(){var e=s.culture();if(t&&e){var n=e.substr(0,2).toLowerCase();return t.hasOwnProperty(n)?t[n]:t.en}return{}}};u._addElements=r,u._deleteElements=i,u._getResource=c,u._hasOwnProperty=o,u._isInstanceOf=a,t.exports=u},function(t,e,n){var r={};r._each=function(t,e){if(r._isArraylike(t))for(var n=0,i=t.length;n<i&&!1!==e.call(t[n],n,t[n]);n++);else for(var o in t)if(t.hasOwnProperty(o)&&!1===e.call(t[o],o,t[o]))break;return t},r._isEmptyObject=function(t){return!t||"object"==typeof t&&0===Object.keys(t).length},r._isFunction=function(t){return"function"===r._getType(t)},r._isArray=function(t){return Array.isArray?Array.isArray(t):"array"===r._getType(t)},r._isNumeric=function(t){return!isNaN(parseFloat(t))&&isFinite(t)},r._getType=function(t){if(null===t)return"null";var e=r._class2type;if(!e){e=r._class2type={};for(var n=["Boolean","Number","String","Function","Array","Date","RegExp","Object","Error"],i=0,o=n.length;i<o;i++)e["[object "+n[i]+"]"]=n[i].toLowerCase()}var a=e.toString,u=typeof t;return"object"===u||"function"===u?e[a.call(t)]||"object":u},r._inArray=function(t,e,n){var i;if(e){var o=[].indexOf;if(o)return o.call(e,t,n);for(i=e.length,r._isNullOrUndefined(n)&&(n=0),n=n<0?Math.max(0,i+n):n;n<i;n++)if(n in e&&e[n]===t)return n}return-1},r._merge=function(t,e){var n=e.length,r=t.length,i=0;if("number"==typeof n)for(;i<n;i++)t[r++]=e[i];else for(;void 0!==e[i];)t[r++]=e[i++];return t.length=r,t},r._map=function(t,e,n){var i,o=0,a=t.length,u=r._isArraylike(t),s=[];if(u)for(;o<a;o++)null!==(i=e(t[o],o,n))&&(s[s.length]=i);else for(o in t)t.hasOwnProperty(o)&&null!==(i=e(t[o],o,n))&&(s[s.length]=i);return[].concat.apply([],s)},r._extend=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n,i,o,a,u,s,c=arguments[0]||{},l=1,f=arguments.length,p=!1;for("boolean"==typeof c&&(p=c,c=arguments[1]||{},l=2),"object"==typeof c||r._isFunction(c)||(c={}),f===l&&(c=this,--l);l<f;l++)if(!r._isNullOrUndefined(u=arguments[l]))for(a in u)n=c[a],o=u[a],c!==o&&(p&&o&&(r._isPlainObject(o)||(i=r._isArray(o)))?(i?(i=!1,s=n&&r._isArray(n)?n:[]):s=n&&r._isPlainObject(n)?n:{},c[a]=r._extend(p,s,o)):void 0!==o&&(c[a]=o));return c},r._inherit=function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n},r._isWindow=function(t){return null!==t&&t===t.window},r._isPlainObject=function(t){if(!t||"object"!==r._getType(t)||t.nodeType||r._isWindow(t))return!1;var e={}.hasOwnProperty;try{if(t.constructor&&!e.call(t,"constructor")&&!e.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}var n;for(n in t);return void 0===n||e.call(t,n)},r._isArraylike=function(t){if(r._isNullOrUndefined(t))return!1;var e=t.length,n=r._getType(t);return!r._isWindow(t)&&(!(1!==t.nodeType||!e)||("array"===n||"function"!==n&&(0===e||"number"==typeof e&&e>0&&e-1 in t)))},r._makeArray=function(t,e){var n=e||[];return null!==t&&(r._isArraylike(Object(t))?r._merge(n,"string"==typeof t?[t]:t):[].push.call(n,t)),n},r._isType=function(t,e){return r._isNullOrUndefined(t)?"null"===e:!!e&&(e instanceof Function&&t instanceof e||(typeof t===e||(!("function"!==e||!/^\\s*\\bfunction\\b/.test(""+t))||(Object.prototype.toString.call(t).slice(8,-1).toLowerCase()===e.toLowerCase()||("DateTime"===e||"TimeSpan"===e?t instanceof Date:("string"==typeof e&&"undefined number boolean string".indexOf(e),!1))))))},r._isNullOrUndefined=function(t){return void 0===t||null===t},r._isNumber=function(t,e){return t=n(10)._replaceCultureSymbolToNormal(t,e),r._isType(t,"number")||r._isType(t,"DateTime")||r._isType(t,"TimeSpan")||t&&!r._isType(t,"boolean")&&!isNaN(t)&&!isNaN(parseFloat(t))&&!(t.length>=2&&"0"===t[0]&&"x"===t[1])},r._toDouble=function(t){var e=n(13);return r._isNullOrUndefined(t)||""===t?0:r._isType(t,"number")?t:r._isType(t,"string")&&!isNaN(t)?n(10)._parseLocale(t):r._isType(t,"boolean")?t?1:0:r._isType(t,"DateTime")?e._toOADate(t):r._isType(t,"TimeSpan")?Math.floor(e._toOADate(t)):parseFloat(t)},r._cloneObject=function(t){if(!t)return t;if("number"==typeof t||"string"==typeof t||"boolean"==typeof t||r._isNullOrUndefined(t))return t;if(t.clone)return t.clone();if(t instanceof Date)return new Date(t);var e,n,i;e=t instanceof Object?new t.constructor:new t.constructor(t.valueOf());for(n in t)t.hasOwnProperty(n)&&(i=t[n],t.hasOwnProperty(n)&&e[n]!==i&&(e[n]="object"==typeof i?r._cloneObject(i):i));return e.toString=t.toString,e.valueOf=t.valueOf,e},t.exports=r},function(t,e,n){var r=n(6),i=function(){function t(){}return t._getReg=function(e){var n=t._regDict[e];return n||(n=t._regDict[e]=new RegExp(e,"g")),n.lastIndex=0,n},t._getRegIgnoreCase=function(e){var n=t._regDictIgnoreCase[e];return n||(n=t._regDictIgnoreCase[e]=new RegExp(e,"gi")),n.lastIndex=0,n},t._getWildcardCriteria=function(e,n){if(t._wildcardParseRecord[e])return t._wildcardParseResultBuffer[e];if(t._getReg("[~?*]+").test(e)){for(var r,i=[],o=e.split(""),a=0;a<o.length;a++)r=o[a],"~"===r&&a<o.length-1?(a++,r=o[a],"*"===r||"?"===r?i.push("\\\\"):n&&i.push("~"),i.push(r)):"?"===r?i.push("."):"*"===r?(i.push("."),i.push("*")):i.push(r);return i.join("")}return null},t._getWildcardCriteriaFullMatch=function(e,n){var r=t._getWildcardCriteria(e,n);return r&&(r="^"+r+"$"),r},t._getReplaceSymbol=function(t,e){for(var n="#"+t+"0#",i=1;e.indexOf(n)>0;)n=r._join(n,"#"+t+(i-1)+"#","#"+t+i+"#"),i++;return n},t._regDict={},t._regDictIgnoreCase={},t._wildcardParseRecord={},t._wildcardParseResultBuffer={},t._replaceRegString2NormalString=function(t){return t.replace(/([\\~\\!\\@\\#\\$\\%\\^\\&\\*\\(\\)\\-\\_\\+\\=\\[\\]\\{\\}\\|\\\\\\;\\:\\\'\\"\\,\\.\\/\\<\\>\\?])/,"\\\\$1")},t}();t.exports=i},function(t,e,n){function r(t,e,n){return t.substr(e,n)}function i(t,e,n,r){if(!e)throw new Error;if(""===e)return!0;if(e.length>t.length)return!1;var i=t,o=e;return n&&(i=i.toLowerCase(),o=o.toLowerCase()),r(i,o)}var o=n(4)._isNullOrUndefined,a={_contains:function(t,e,n){return n&&(t=t.toLowerCase(),e=e.toLowerCase()),""===e||t.indexOf(e)>=0},_indexOf:function(t,e,n){if(!n)return t.indexOf(e);if(n){var r=t.toLowerCase(),i=e.toLowerCase();return r.indexOf(i)}return t.indexOf(e)},_trimStart:function(t,e){if(!e)return t;for(var n=t;r(n,0,e.length)===e;)n=r(n,e.length);return n},_trimEnd:function(t,e){if(!e)return t;for(var n=t;r(n,n.length-e.length,e.length)===e;)n=r(n,0,n.length-e.length);return n},_insert:function(t,e,n){if(e<0||e>t.length||o(n))throw new Error;return r(t,0,e)+n+r(t,e,t.length-e)},_remove:function(t,e,n){if(o(n)&&(n=t.length-e),e<0||n<0||e+n>t.length)throw new Error;return r(t,0,e)+r(t,e+n,t.length-e-n)},_startsWith:function(t,e,n){return i(t,e,n,function(t,e){return t.slice(0,e.length)===e})},_endsWith:function(t,e,n){return i(t,e,n,function(t,e){return t.slice(-e.length)===e})},_replace:function(t,e,n,r){if(!e||""===e)throw new Error;return n=(""+n).replace(/\\$/g,"$$$$"),t.replace(new RegExp(e,"g"+(r?"i":"")),n)},_replaceAllNoReg:function(t,e,r,i){return e=n(5)._replaceRegString2NormalString(e),this._replace(t,e,r,i)},_leftBefore:function(t,e){var n=t.indexOf(e);return n<0||n>=t.length?t:r(t,0,n)},_count:function(t,e){for(var n=0,r=t.indexOf(e);r>=0;)n+=1,r=t.indexOf(e,r+1);return n},_join:function(t,e,n){return t.split(e).join(n)},_format:function(t,e){for(var n=t,r=0;r<e.length;r++){var i=new RegExp("\\\\{"+r+"\\\\}","g");n=n.replace(i,e[r])}return n},_padZero:function(t,e,n){for(var r=t.toString(),i=r.length;i<e;i++)r=n?"0"+r:r+"0";return r},_padZeroLeft:function(t,e){return a._padZero(t,e,!0)},_padZeroRight:function(t,e){return a._padZero(t,e,!1)},_compareStringIgnoreCase:function(t,e){return t===e||!t&&!e||t&&e&&t.toLowerCase()===e.toLowerCase()},_toUpperCase:function(t){return t.toUpperCase()},_escapeHtml:function(t){var e={"&":"&amp;","<":"&lt;",">":"&gt;",\'"\':"&quot;","\'":"&#x27;","`":"&#x60;"},r=n(5)._getReg("(?:&|<|>|\\"|\'|`)");return r.test(t)?t.replace(r,function(t){return e[t]}):t},_unescapeHtml:function(t){var e={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":\'"\',"&#x27;":"\'","&#x60;":"`"},r=n(5)._getReg("(?:&amp;|&lt;|&gt;|&quot;|&#x27;|&#x60;)");return r.test(t)?t.replace(r,function(t){return e[t]}):t}};t.exports=a},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(0),a=n(2),u=n(21),s=n(22),c=String.fromCharCode(0),l=n(11),f=function(){function t(e,n){if(r(this,t),this.ops=[],Array.isArray(e)){for(var i=0;i<e.length;i++)this.pushWithMutations(e[i]);n&&this.chopWithMutations()}else"function"==typeof e&&e(this);a.freeze(this)}return i(t,[{key:"freeze",value:function(){a.freeze(this.ops)}},{key:"createCleaner",value:function(){for(var e=[],n=0;n<this.ops.length;n++){var r=this.ops[n],i=r.createInstance({action:"remove",data:r.length});e.push(i)}return new t(e)}},{key:"clone",value:function(){return new t(this.ops.map(a.clone))}},{key:"toJSON",value:function(){return this.ops}},{key:"pack",value:function(){return this.ops.map(function(t){return t.pack()})}},{key:"isDocument",value:function(){for(var t=0;t<this.ops.length;t++)if("insert"!==this.ops[t].action)return!1;return!0}},{key:"isEmpty",value:function(){return 0===this.ops.length}},{key:"_genericPush",value:function(t,e){var n=t.length,r=t[n-1];if(r&&"remove"===r.action&&"insert"===e.action&&(n-=1,r=t[n-1]),!r)return t.unshift(e),t;var i=e.merge(r);return i?t[n-1]=i:n===t.length?t.push(e):t.splice(n,0,e),t}},{key:"push",value:function(e){if(!e.length)return this;var n=this.ops.slice(0);if(Array.isArray(e)){for(var r=!1,i=0;i<e.length;i++)e[i].length&&(r=!0,n=this._genericPush(n,e[i]));if(!r)return this}else n=this._genericPush(n,e);return new t(n)}},{key:"pushWithMutations",value:function(t){return t.length&&this._genericPush(this.ops,t),this}},{key:"concat",value:function(e){var n=this;return e.ops.length?this.ops.length?new t(function(t){t.ops=n.ops.slice(),t.pushWithMutations(e.ops[0]),e.ops.length>1&&(t.ops=t.ops.concat(e.ops.slice(1)))}):e:this}},{key:"_genericChop",value:function(t){for(;t.length&&t[t.length-1].isEmpty();)t.pop();return t}},{key:"chop",value:function(){return new t(this._genericChop(this.ops.slice(0)))}},{key:"chopWithMutations",value:function(){return this._genericChop(this.ops),this}},{key:"slice",value:function(e,n){e=e||0,"number"!=typeof n&&(n=1/0);for(var r=[],i=this.getIter(),o=0;o<n&&i.hasNext();){var a=void 0;o<e?a=i.next(e-o):(a=i.next(n-o),r.push(a)),o+=a.length}return new t(r)}},{key:"getIter",value:function(){return new a.OperatorIterator(this.ops)}},{key:"validate",value:function(){for(var t={},e=0;e<this.ops.length;e++){var n=this.ops[e];if(n&&"TableOperator"===n.name()){var r=n.getAttributes(),i=r.name;if(!i)continue;var o="$$"+i+"$$";if(t.hasOwnProperty(o))throw new Error("Duplicated table name found: "+i);t[o]=!0}}return this}},{key:"compose",value:function(e){for(var n=!(arguments.length<=1||void 0===arguments[1])&&arguments[1],r=this.getIter(),i=e.getIter(),o=[];r.hasNext()||i.hasNext();)if("insert"===i.peekAction())o.push(i.next());else if("remove"===r.peekAction())o.push(r.next());else{var a=Math.min(r.peekLength(),i.peekLength()),u=r.next(a),s=i.next(a);s&&"retain"!==s.action?u&&"retain"!==u.action||o.push(s):u?s?o.push(u.compose(s,n)):o.push(u):o.push(s)}var c=new t(o,!0);return n||c.validate(),c}},{key:"composePosition",value:function(t){for(var e=this.getIter(),n=0;e.hasNext()&&n<=t;){var r=e.peekLength(),i=e.peekAction();switch(e.next(),i){case"remove":if(r>t-n)return null;t-=r;continue;case"insert":t+=r}n+=r}return t}},{key:"invert",value:function(e){for(var n=this.getIter(),r=e.getIter(),i=[];r.hasNext();)if("insert"===r.peekAction()){var o=r.next(),a=o.createInstance({action:"remove",data:o.length});i.push(a)}else{if(!n.hasNext())throw new Error(this.constructor.name+" should be smaller than document");var u=Math.min(n.peekLength(),r.peekLength()),s=n.next(u),c=r.next(u);if("insert"!==s.action)throw new Error("Only document can invert deltas");"retain"===c.action?i.push(s.invert(c)):i.push(s)}return new t(i,!0)}},{key:"invertPosition",value:function(t){for(var e=this.getIter(),n=0;e.hasNext()&&n<=t;){var r=e.peekLength(),i=e.peekAction();switch(e.next(),i){case"insert":if(r>t-n)return null;t-=r;continue;case"remove":t+=r}n+=r}return t}},{key:"transform",value:function(e,n){for(var r=this.getIter(),i=e.getIter(),o=[];i.hasNext();)if("insert"!==r.peekAction()||!n&&"insert"===i.peekAction())if("insert"===i.peekAction())o.push(i.next());else{var a=Math.min(r.peekLength(),i.peekLength()),u=r.next(a),s=i.next(a);if(u&&"remove"===u.action)continue;s&&"remove"===s.action?o.push(s):u?o.push(u.transform(s,n)):o.push(s)}else{var c=r.next();o.push(c.createInstance({action:"retain",data:c.length}))}return new t(o,!0)}},{key:"transformPosition",value:function(t,e){for(var n=this.getIter(),r=0;n.hasNext()&&r<=t;){var i=n.peekLength(),o=n.peekAction();switch(n.next(),o){case"remove":t-=Math.min(i,t-r);continue;case"insert":(r<t||!e)&&(t+=i)}r+=i}return t}},{key:"toString",value:function(){for(var t="",e=0;e<this.ops.length;e++){var n=this.ops[e];if("insert"!==n.action)throw new Error("toString() called on non-document");t+="string"==typeof n.data?n.data:c}return t}},{key:"diff",value:function(e,n){if(this.ops===e.ops)return new t;if(!this.ops.length){if(!e.isDocument())throw new Error("diff() called on non-document");return e}for(var r=o.bind(this.ops[0].createInstance,this.ops[0]),i=[],a=u(this.toString(),e.toString(),n),c=this.getIter(),f=e.getIter(),p=0,h=a.length;p<h;p++)for(var d=a[p],y=d[1].length;y>0;){var m=0;switch(d[0]){case u.INSERT:m=Math.min(f.peekLength(),y),i.push(f.next(m));break;case u.DELETE:m=Math.min(y,c.peekLength()),c.next(m),i.push(r({action:"remove",data:m}));break;case u.EQUAL:m=Math.min(c.peekLength(),f.peekLength(),y);var g=c.next(m),v=f.next(m),_=g.skipDiff()&&v.skipDiff()&&g.name()===v.name()||s(g.data,v.data);_?i.push(r({action:"retain",data:m,attributes:l.diff(g.attributes,v.attributes)})):(i.push(v),i.push(r({action:"remove",data:m})))}y-=m}return new t(i,!0)}},{key:"print",value:function(t){console[t?"group":"groupCollapsed"]("Delta["+this.length+"] with "+this.ops.length+" operators"),this.ops.forEach(function(t){return t.print()}),console.groupEnd()}},{key:"length",get:function(){for(var t=0,e=0;e<this.ops.length;e++)t+=this.ops[e].length;return t}}],[{key:"unpack",value:function(t){var e=this;return new this(t.map(function(t){return e.operatorUnpacker(t)}))}}]),t}();t.exports=f},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t){"function"==typeof t.pack?t.print():"object"==typeof t?Object.keys(t).forEach(function(e){var n=t[e];console.groupCollapsed(e),i(n),console.groupEnd()}):console.log(t)}var o=function(){function t(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&u.return&&u.return()}finally{if(i)throw o}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=n(7),s=n(2).clone,c=n(11),l=n(2),f=function(){function t(e){r(this,t),this.setWithMutations(e);var n="Operator"!==this.name()&&this.isGeneric(),i=n?this.toGeneric():this;return l.freeze(i),i}return a(t,[{key:"name",value:function(){return"Operator"}},{key:"skipDiff",value:function(){return!1}},{key:"isGeneric",value:function(){return"number"==typeof this.data}},{key:"toGeneric",value:function(){return new t({action:this.action,data:this.data,attributes:this.attributes})}},{key:"clone",value:function(){var t=this.createInstance(this);return t.data=s(t.data),t}},{key:"_genericSet",value:function(t){var e={action:this.action,data:this.data,attributes:this.attributes},n=!1,r=t.action;if(r&&r!==e.action){if(n=!0,"insert"!==r&&"retain"!==r&&"remove"!==r)throw new Error(\'Action "\'+r+\'" is invalid\');e.action=r}var i=t.data;if(null!=i&&i!==e.data){if(n=!0,"remove"===e.action&&("number"!=typeof i||i<0))throw new Error("Expect the data of remove action to be a positive number, got "+i);e.data=i}if(null==e.data)throw new Error("Expect data to have a non-empty value, got "+e.data);var o=t.attributes;if(o){var a=typeof o;if("object"===a&&Object.keys(o).length){var u=c.pack(o);u&&e.attributes!==u&&(n=!0,e.attributes=u)}else"string"===a&&e.attributes!==o&&(n=!0,e.attributes=o)}return{changed:n,op:e}}},{key:"set",value:function(t){var e=this._genericSet(t),n=e.changed,r=e.op;return n?this.createInstance(r):this}},{key:"setWithMutations",value:function(t){var e=this._genericSet(t),n=e.op;return this.action=n.action,this.data=n.data,this.attributes=n.attributes,this}},{key:"createInstance",value:function(t){return new this.constructor(t)}},{key:"toJSON",value:function(){return this.pack()}},{key:"pack",value:function(){var t=void 0;switch(this.action){case"insert":t=0;break;case"remove":t=1;break;case"retain":t=2}var e="function"==typeof this.data.pack?this.data.pack():this.data,n=[Number(""+this.constructor.packId+t),e];return this.attributes&&n.push(this.attributes),n}},{key:"getEmbedObject",value:function(){throw new Error("#getEmbedObject() not implemented")}},{key:"isEmpty",value:function(){return"retain"===this.action&&!this.attributes&&"number"==typeof this.data}},{key:"getAttributes",value:function(){return c.unpack(this.attributes)}},{key:"merge",value:function(t){if(this.name()!==t.name())return!1;var e=typeof this.data;return!(this.action!==t.action||e!==typeof t.data||"number"!==e&&"string"!==e||this.attributes!==t.attributes)&&t.set({data:t.data+this.data})}},{key:"compose",value:function(t){if("remove"===this.action)throw new Error("Removing operator cannot compose other operators");if("retain"!==t.action)throw new Error("Only retaining operator can be composed");if(this.constructor!==t.constructor&&!this.isGeneric()&&!t.isGeneric())throw new Error(\'Failed to compose operators. Expect constructor "\'+t.constructor.name+\'" to equal "\'+this.constructor.name+\'"\');var e=void 0;return e="function"==typeof this.data.compose&&t.data.constructor===this.data.constructor?this.data.compose(t.data):"number"==typeof this.data?t.data:this.data,(this.isGeneric()?t:this).createInstance({data:e,attributes:c.merge(this.attributes,t.attributes,"insert"!==this.action),action:this.action})}},{key:"invert",value:function(t){if("insert"!==this.action)throw new Error(\'invert should only apply to the "insert" action (\'+this.constructor.name+")");if("retain"!==t.action)throw new Error("Only retaining operator can be inverted");if(this.constructor!==t.constructor&&!t.isGeneric())throw new Error(\'Failed to invert operators. Expect constructor "\'+t.constructor.name+\'" to equal "\'+this.constructor.name+\'"\');var e=void 0;return e="function"==typeof this.data.invert&&t.data.constructor===this.data.constructor?this.data.invert(t.data):"number"==typeof t.data?t.data:this.data,this.createInstance({data:e,attributes:c.invert(this.attributes,t.attributes),action:"retain"})}},{key:"transform",value:function(t,e){if("retain"!==this.action)throw new Error("Only retaining operator can transform other operators");if("retain"!==t.action)throw new Error("Only retaining operator can be transformd");if(this.constructor!==t.constructor&&!t.isGeneric()&&!this.isGeneric())throw new Error(\'Failed to transform operators. Expect constructor "\'+t.constructor.name+\'" to equal "\'+this.constructor.name+\'"\');return(this.isGeneric()?t:this).createInstance({attributes:c.transform(this.attributes,t.attributes,e),action:"retain",data:"function"==typeof this.data.transform&&"function"==typeof t.data.transform?this.data.transform(t.data,e):t.data})}},{key:"print",value:function(){var t=[this.action+": %c"+this.name(),"color: #51c6ed"];this.attributes&&(t[0]=t[0]+"%c, %O",t.push("font-weight: normal; color: #000",this.attributes.toJS())),console.groupCollapsed.apply(console,t),i(this.data),console.groupEnd()}},{key:"length",get:function(){switch(typeof this.data){case"number":return this.data;case"string":return this.data.length;default:return 1}}}],[{key:"unpack",value:function(t){var e=o(t,3),n=e[0],r=e[1],i=e[2];return new this({action:["insert","remove","retain"][n],data:Array.isArray(r)?u.unpack(r):r,attributes:i})}},{key:"insert",value:function(t,e){return new this({action:"insert",data:t,attributes:e})}},{key:"retain",value:function(t,e){return new this({action:"retain",data:t,attributes:e})}},{key:"remove",value:function(t){return new this({action:"remove",data:t})}}]),t}();f.packId=1,t.exports=f},function(t,e,n){function r(t,e,n){for(var r,i=this,o=0,a=e.length;o<a;o++)r=e[o],i[t][r]=n[o]}var i=n(4),o=void 0,a=null,u=i._inherit,s=i._each,c=function(){function t(){}return t._isValidEraDate=function(t){return t>=this._getEraMin()&&t<=this._getEraMax()},t._getEraDates=function(){var t=l.eras;if(t!==o){for(var e=[],n=0;n<t.length;n++)e[n]=new Date(t[n].startDate.replace(/-/g,"/"));return e}return this._EraDates},t._getEraPropByFormat=function(t){var e,n,r=this;switch(t){case"g":e="symbol",n=r._symbols;break;case"gg":e="abbreviation",n=r._abbreviations;break;case"ggg":e="name",n=r._names;break;default:return[]}var i=l.eras,a=[];if(i!==o){for(var u=0;u<i.length;u++)a[u]=i[u][e];return a}return n},t._getEraMax=function(){var t=l.eras;if(t!==o&&t.length>0){var e=new Date(t[t.length-1].startDate.replace(/-/g,"/"));return e.setFullYear(e.getFullYear()+99),e}return this._EraMax},t._getEraMin=function(){var t=l.eras;return t!==o&&t.length>0?new Date(t[0].startDate.replace(/-/g,"/")):this._EraMin},t._getEraCount=function(){var t=l.eras;return t!==o?t.length:this._EraCount},t._getEraYears=function(){var t=l.eras;if(t!==o){for(var e=[],n=1;n<t.length;n++){var r=new Date(t[n-1].startDate.replace(/-/g,"/")),i=new Date(t[n].startDate.replace(/-/g,"/"));e[n-1]=i.getFullYear()-r.getFullYear()+1}return e[n-1]=99,e}return this._EraYears},t._getEraDate=function(t){var e={};e._era=-1,e._eraYear=-1;var n=this;if(!n._isValidEraDate(t))return e;for(var r=0;r<n._getEraCount();r++){if(t<(r+1!==n._getEraCount()?n._getEraDates()[r+1]:n._addMilliseconds(n._getEraMax(),1))){e._era=r,e._eraYear=t.getFullYear()-n._getEraDates()[r].getFullYear()+1;break}}return e},t._addMilliseconds=function(t,e){var n=new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds());return n.setMilliseconds(n.getMilliseconds()+e),new Date(n.valueOf())},t._getYearFromEra=function(e,n){return t._getEraDates()[e].getFullYear()+n-1},t._parseEraPart=function(e,n){n=n.toUpperCase();for(var r=t._getEraPropByFormat(e),i=0;i<r.length;i++)if(r[i]===n)return i;return-1},t._formatEraPart=function(e,n){var r=t,i=r._getEraDate(n),o=i._era;if(o>=0){var a=r._getEraPropByFormat(e);if(a.length>0)return a[o]}var u=i._eraYear;if(u>=0){var s=u.toString();if("ee"===e)return 1===s.length&&(s="0"+s),s;if("e"===e)return s}return""},t._EraDates=[new Date(1868,8,8),new Date(1912,6,30),new Date(1926,11,25),new Date(1989,0,8)],t._EraCount=4,t._EraYears=[45,15,64,99],t._EraMax=new Date(2087,11,31,23,59,59),t._EraMin=new Date(1868,8,8),t._shortcuts=["1,m","2,t","3,s","4,h"],t._EraIndices=[0,1,2,3,0,1,2,3],t._names=["明治","大正","昭和","平成"],t._symbols=["M","T","S","H"],t._abbreviations=["明","大","昭","平"],t._EraYearMax=99,t}(),l=function(){function t(){this.NumberFormat={currencyDecimalDigits:2,currencyDecimalSeparator:".",currencyGroupSeparator:",",currencyGroupSizes:[3],currencyNegativePattern:0,currencyPositivePattern:0,currencySymbol:"¤",digitSubstitution:1,isReadOnly:!0,numberGroupSizes:[3],nanSymbol:"NaN",nativeDigits:["0","1","2","3","4","5","6","7","8","9"],numberNegativePattern:1,negativeInfinitySymbol:"-Infinity",negativeSign:"-",numberDecimalDigits:2,numberDecimalSeparator:".",numberGroupSeparator:",",positiveInfinitySymbol:"Infinity",positiveSign:"+",percentDecimalDigits:2,percentDecimalSeparator:".",percentGroupSeparator:",",percentGroupSizes:[3],percentNegativePattern:0,percentPositivePattern:0,percentSymbol:"%",perMilleSymbol:"‰",listSeparator:",",arrayListSeparator:",",arrayGroupSeparator:";",dbNumber:{}},this.DateTimeFormat={abbreviatedDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],abbreviatedMonthGenitiveNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],abbreviatedMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],amDesignator:"AM",calendarIsReadOnly:!0,calendarWeekRule:0,Calendar:{MinSupportedDateTime:"@-62135568000000@",MaxSupportedDateTime:"@253402300799999@",AlgorithmType:1,CalendarType:1,Eras:[1],TwoDigitYearMax:2029,isReadOnly:!0},dateSeparator:"/",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],firstDayOfWeek:0,fullDateTimePattern:"dddd, dd MMMM yyyy HH:mm:ss",longDatePattern:"dddd, dd MMMM yyyy",longTimePattern:"HH:mm:ss",monthDayPattern:"MMMM dd",monthGenitiveNames:["January","February","March","April","May","June","July","August","September","October","November","December",""],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December",""],nativeCalendarName:"Gregorian Calendar",pmDesignator:"PM",rfc1123Pattern:"ddd, dd MMM yyyy HH\':\'mm\':\'ss \'GMT\'",shortDatePattern:"YYYY/MM/DD",shortestDayNames:["Su","Mo","Tu","We","Th","Fr","Sa"],shortTimePattern:"HH:mm:ss",sortableDateTimePattern:"yyyy\'-\'MM\'-\'dd\'T\'HH\':\'mm\':\'ss",timeSeparator:":",universalSortableDateTimePattern:"yyyy\'-\'MM\'-\'dd HH\':\'mm\':\'ss\'Z\'",yearMonthPattern:"yyyy MMMM"},this.name=function(){return""},this.id=-1}function e(t){return t.split(" ").join(" ").toUpperCase()}function n(t){for(var n=[],r=0,i=t.length;r<i;r++)n[r]=e(t[r]);return n}function r(t,n,r){var i=e(t),o=n.indexOf(i);return-1===o&&(o=r.indexOf(i)),o}return t.prototype={constructor:t,_getDateTimePattern:function(){return this._dateTimeFormatPattern||(this._dateTimeFormatPattern=v),this._dateTimeFormatPattern},_getMonthIndex:function(t){var e=this;return e._upperMonths||(e._upperMonths=n(e.DateTimeFormat.monthNames),e._upperMonthsGenitive=n(e.DateTimeFormat.monthGenitiveNames)),r(t,e._upperMonths,e._upperMonthsGenitive)},_getAbbrMonthIndex:function(t){var e=this;return e._upperAbbrMonths||(e._upperAbbrMonths=n(e.DateTimeFormat.abbreviatedMonthNames),e._upperAbbrMonthsGenitive=n(e.DateTimeFormat.abbreviatedMonthGenitiveNames)),r(t,e._upperAbbrMonths,e._upperAbbrMonthsGenitive)},_getDayIndex:function(t){var r=this;return r._upperDays||(r._upperDays=n(r.DateTimeFormat.dayNames)),r._upperDays.indexOf(e(t))},_getAbbrDayIndex:function(t){var r=this;return r._upperAbbrDays||(r._upperAbbrDays=n(r.DateTimeFormat.abbreviatedDayNames)),r._upperAbbrDays.indexOf(e(t))}},t}(),f=function(t){function e(){t.apply(this,arguments),r.call(this,"NumberFormat",["currencySymbol","isReadOnly"],["$",!1]),r.call(this,"DateTimeFormat",["fullDateTimePattern","longDatePattern","longTimePattern","shortDatePattern","shortTimePattern","yearMonthPattern","calendarIsReadOnly"],["dddd, MMMM dd, yyyy h:mm:ss tt","dddd, MMMM dd, yyyy","h:mm:ss tt","YYYY/MM/DD","h:mm tt","MMMM, yyyy",!1]),this.name=function(){return"en-US"},this.id=1033}return u(e,t),e}(l),p=function(t){function e(){t.apply(this,arguments);var e={1:{letters:["兆","千","百","十","亿","千","百","十","万","千","百","十",""],numbers:["〇","一","二","三","四","五","六","七","八","九"]},2:{letters:["兆","阡","百","拾","億","阡","百","拾","萬","阡","百","拾",""],numbers:["〇","壱","弐","参","四","伍","六","七","八","九"]},3:{letters:a,numbers:["０","１","２","３","４","５","６","７","８","９"]}};r.call(this,"NumberFormat",["currencyDecimalDigits","currencyNegativePattern","currencySymbol","isReadOnly","nanSymbol","negativeInfinitySymbol","percentNegativePattern","percentPositivePattern","positiveInfinitySymbol","dbNumber"],[0,1,"¥",!1,"NaN (非数値)","-∞",1,1,"+∞",e]);var n=["1","2","3","4","5","6","7","8","9","10","11","12",""],i=["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月",""];r.call(this,"DateTimeFormat",["abbreviatedDayNames","abbreviatedMonthGenitiveNames","abbreviatedMonthNames","amDesignator","calendarIsReadOnly","dayNames","fullDateTimePattern","longDatePattern","longTimePattern","monthDayPattern","monthGenitiveNames","monthNames","nativeCalendarName","pmDesignator","shortDatePattern","shortestDayNames","shortTimePattern","yearMonthPattern"],[["日","月","火","水","木","金","土"],n,n,"午前",!1,["日曜日","月曜日","火曜日","水曜日","木曜日","金曜日","土曜日"],"yyyy\'年\'M\'月\'d\'日\' H:mm:ss","yyyy\'年\'M\'月\'d\'日\'","H:mm:ss","M\'月\'d\'日\'",i,i,"西暦 (日本語)","午後","yyyy/MM/dd",["日","月","火","水","木","金","土"],"H:mm","yyyy\'年\'M\'月\'"]),this.DateTimeFormat.eras=c,this.name=function(){return"ja-JP"},this.id=1041}return u(e,t),e}(l),h=function(t){function e(){t.apply(this,arguments);var e={1:{letters:["兆","千","百","十","亿","千","百","十","万","千","百","十",""],numbers:["○","一","二","三","四","五","六","七","八","九"]},2:{letters:["兆","仟","佰","拾","亿","仟","佰","拾","万","仟","佰","拾",""],numbers:["零","壹","贰","叁","肆","伍","陆","柒","捌","玖"]},3:{letters:a,numbers:["０","１","２","３","４","５","６","７","８","９"]}};r.call(this,"NumberFormat",["currencyNegativePattern","currencySymbol","isReadOnly","nanSymbol","negativeInfinitySymbol","percentNegativePattern","percentPositivePattern","positiveInfinitySymbol","dbNumber"],[2,"¥",!1,"非数字","负无穷大",1,1,"正无穷大",e]);var n=["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月",""],i=["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月",""];r.call(this,"DateTimeFormat",["abbreviatedDayNames","abbreviatedMonthGenitiveNames","abbreviatedMonthNames","amDesignator","calendarIsReadOnly","dayNames","firstDayOfWeek","fullDateTimePattern","longDatePattern","longTimePattern","monthDayPattern","monthGenitiveNames","monthNames","nativeCalendarName","pmDesignator","shortDatePattern","shortestDayNames","shortTimePattern","yearMonthPattern"],[["周日","周一","周二","周三","周四","周五","周六"],n,n,"上午",!1,["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],1,"yyyy\'年\'M\'月\'d\'日\' H:mm:ss","yyyy\'年\'M\'月\'d\'日\'","HH:mm:ss","M\'月\'d\'日\'",i,i,"公历","下午","YYYY/MM/DD",["日","一","二","三","四","五","六"],"H:mm","yyyy\'年\'M\'月\'"]),this.name=function(){return"zh-cn"},this.id=2052}return u(e,t),e}(l),d={invariant:new l,"en-us":new f,"ja-jp":new p,"zh-cn":new h},y=["MM/dd/yyyy","MM/d/yyyy","M/dd/yyyy","M/d/yyyy","yy/MM/dd","yy/MM/d","yy/M/dd","yy/M/d","yyyy/MM/dd","yyyy/MM/d","yyyy/M/dd","yyyy/M/d"],m=["hh:mm:ss","hh:mm:s","hh:m:ss","hh:m:s","h:mm:ss","h:mm:s","h:m:ss","h:m:s","hh:mm:ss tt","hh:mm:s tt","hh:m:ss tt","hh:m:s tt","h:mm:ss tt","h:mm:s tt","h:m:ss tt","h:m:s tt","hh:mm","hh:m","h:mm","h:m","hh:mm tt","hh:m tt","h:mm tt","h:m tt"],g=["MM-dd-yyyy","MM-d-yyyy","M-dd-yyyy","M-d-yyyy","yy-MM-dd","yy-MM-d","yy-M-dd","yy-M-d","yyyy-MM-dd","yyyy-MM-d","yyyy-M-dd","yyyy-M-d","dd-MMMM-yy","dd-MMM-yy"],v=y.concat(m);s(y,function(t,e){s(m,function(t,n){t<m.length-4&&v.push(e+" "+n)})}),v=v.concat(g),s(g,function(t,e){s(m,function(t,n){t<m.length-4&&v.push(e+" "+n)})});var _=function(){function t(){var r="zh-cn";this.culture=function(t){if(0===arguments.length)return r;t&&r!==t&&(r=t.toLowerCase(),e(r))},this.addCultureInfo=function(t,e){var r=e.NumberFormat.numberDecimalSeparator,i=e.NumberFormat.arrayListSeparator,o=e.NumberFormat.arrayGroupSeparator;if(r===e.NumberFormat.listSeparator||o===i){var a=n(3);throw a._getResource(a.SR)().Exp_Separator}d[t.toLowerCase()]=e},this.getCultureInfo=function(t){if(0===arguments.length)return d[r];t="string"==typeof t?t.toLowerCase():t;var e=d,n=a;for(var i in e)if(i===t||e[i].id!==o&&e[i].id===t){n=e[i];break}return n},this._getCultureInfo=function(t){var e=this.getCultureInfo(t);return e||(e=d[r])||(e=new l),e},t.instance=this}function e(t){var e;"function"!=typeof CustomEvent?(e=document.createEvent("CustomEvent"),e.initCustomEvent("cultureChanged",!1,!1,void 0)):e=new CustomEvent("cultureChanged",{}),e.cultureInfo=t,document.dispatchEvent(e)}return"object"==typeof t.instance?t.instance:t}();t.exports={CultureInfo:l,CultureManager:new _}},function(t,e,n){function r(t,e,n){return t.substr(e,n)}function i(t){return u._getReg(t)}var o=n(3),a=n(4)._isNullOrUndefined,u=n(5),s=n(6),c=s._padZeroLeft,l=s._padZeroRight,f=n(9).CultureManager,p=null,h=void 0,d=parseInt,y=parseFloat,m=!1,g=!0,v=Math.floor,_=Math.abs,b=Math.pow,M=function(){return o._getResource(o.SR)()},w=function(){function t(t,e,n){return e&&0!==e.length&&"i"!==e?w().test(e)?o(t,e,n.NumberFormat):u(t,e,n.NumberFormat):n&&n.name.length>0?t.toLocaleString():t.toString()}function e(t,e,n,r,i,o){return n="n",e=O(_(t),r.charAt(0),-1===i?6:i,o.numberGroupSizes,o.numberGroupSeparator,o.numberDecimalSeparator,o.negativeSign),t<0&&(e="-"+e),[e,n]}function n(t,e,n,r,i,o){n=t<0?z[o.numberNegativePattern]:"n",-1===i&&(i=2);var a=y(e),u=v(a);return e=k(a-u,i,o.numberGroupSizes,o.numberGroupSeparator,o.numberDecimalSeparator,o.negativeSign),e=""+(u+(+e>=1?1:0))+e.substring(1),[e,n]}function o(t,r,i){var o=_(t).toString();r||(r="D");var a=-1;r.length>1&&(a=d(r.slice(1),10));var u,s;switch(r.charAt(0)){case"d":case"D":u="n",-1!==a&&(o=c(""+o,a)),t<0&&(o="-"+o);break;case"c":case"C":u=t<0?B[i.currencyNegativePattern]:W[i.currencyPositivePattern],-1===a&&(a=i.currencyDecimalDigits),o=k(_(t),a,i.currencyGroupSizes,i.currencyGroupSeparator,i.currencyDecimalSeparator,i.negativeSign);break;case"n":case"N":u=t<0?z[i.numberNegativePattern]:"n",-1===a&&(a=i.numberDecimalDigits),o=k(_(t),a,i.numberGroupSizes,i.numberGroupSeparator,i.numberDecimalSeparator,i.negativeSign);break;case"p":case"P":u=t<0?$[i.percentNegativePattern]:R[i.percentPositivePattern],-1===a&&(a=i.percentDecimalDigits),o=k(100*_(t),a,i.percentGroupSizes,i.percentGroupSeparator,i.percentDecimalSeparator,i.negativeSign);break;case"F":case"f":s=n(t,o,u,r,a,i),o=s[0],u=s[1];break;case"e":case"E":s=e(t,o,u,r,a,i),o=s[0],u=s[1];break;case"x":case"X":u="n",o=N(t,"x"===r.charAt(0),-1===a?0:a);break;case"g":case"G":var l=t.toString();s=[],s=-1===l.indexOf("e")&&-1===l.indexOf("E")?n(t,o,u,r,a,i):e(t,o,u,r.replace("g","e").replace("G","E"),a,i),o=s[0],u=s[1];break;default:throw new Error(M().Exp_BadFormatSpecifier)}for(var f=/n|\\$|-|%/g,p="";;){var h=f.lastIndex,y=f.exec(u);if(p+=u.slice(h,y?y.index:u.length),!y)break;switch(y[0]){case"n":p+=o;break;case"$":p+=i.currencySymbol;break;case"-":/[1-9]/.test(o)&&(p+=i.negativeSign);break;case"%":p+=i.percentSymbol;break;default:throw new Error(M().Exp_InvalidNumberFormat)}}return p}function u(t,e,n){var r=S(e),i=p;0===t?i=r._zero:t<0&&(i=r._negative),i||(i=r._normal);var o=E(t,i,n)+"";return 1===o.indexOf(n.negativeSign)&&0===o.indexOf(n.currencySymbol)&&(o=o[1]+o[0]+o.substring(2)),o}function w(){return/^(C|c|D|d|E|e|F|f|G|g|N|n|P|p|R|r|X|x)(\\d*)$/g}function x(t,e){for(var n=v(_(t)),i={_integer:1,_decimal:0};n>=10;)n/=10,i._integer++;var o,a=t.toString(),u=a.search(/e/gi),s=a.indexOf(e);if(-1!==u){var c=r(a,0,u),l=r(a,u+1),f=0;-1!==s&&(f=r(c,s+1).length);o=f-y(l),o<0&&(o=0),i._decimal=o}else o=0,-1!==s&&(o=r(a,s+1).length),i._decimal=o;return i}function F(t){for(var e={_symbol:t.charAt(0),_sign:0,_exp:0},n="",r=1;r<t.length;r++)if("+"===(n=t.charAt(r)))e._sign=1;else{if("-"!==n){if("0"===n){e._exp=t.length-r;break}throw new Error(M().Exp_InvalidExponentFormat)}e._sign=-1}return e}function S(t){for(var e=p,n=p,r=p,i={_intPart:p,_decPart:p,_group:m,_scale:0,_percent:0,_permile:0,_exponent:p},o="",u=m,s=m,c=m,l=m,h=m,d=m,y=m,v=m,_=p,b=p,w=[],x=0;x<t.length;x++)if(_=t.charAt(x),u)"\'"!==_?o+=_:(w.push(o),o="",u=m),b=_;else if(s)\'"\'!==_?o+=_:(w.push(o),o="",s=m),b=_;else if(c)w.push(o+_),o="",b=_;else{if(l){if("E"===b||"e"===b){if("+"===_||"-"===_||"0"===_){o+=_;continue}l=m}else if("+"===b||"-"===b){if("0"===_){o+=_;continue}l=m,w.push(o),o=""}else if("0"===b){if("0"===_){o+=_;continue}l=m,y||(y=g,i._exponent=F(o)),w.push(o),o=""}}else if("0"===_||"#"===_){if(v=g,"0"===b||"#"===b){o+=_,b=_;continue}""!==o&&(w.push(o),o="")}else"0"!==b&&"#"!==b||"0"===_||"#"===_||(w.push(o),o="");if(";"===_){if(""!==o&&(l&&!y&&(i._exponent=F(o)),w.push(o),o=""),h?i._decPart=_:i._intPart=w,w=[],a(e))e=i;else if(a(n))n=i;else{if(!a(r))throw new Error(M().Exp_InvalidSemicolons);r=i}h=m,v=m,d&&(i._group=g,d=m),i={}}else if(h||"."!==_)if("\'"===_)u=g;else if(\'"\'===_)s=g;else if("%"===_)i._percent++,""!==o&&(w.push(o),o=""),w.push(_);else if(_===f._getCultureInfo().NumberFormat.perMilleSymbol)i._permile++,w.push(_);else if("0"===_||"#"===_)o+=_;else if(","===_)if(h)""!==o&&(w.push(o),o="");else{if(""!==o&&(w.push(o),o=""),!v)continue;for(var S=g,D="",k=x+1;k<t.length;k++){var E=t.charAt(k);if(""===D)if("\'"===E||\'"\'===E)D=E;else{if("0"===E||"#"===E){S=m;break}if("."===E||";"===E)break}else"\'"!==E&&\'"\'!==E||(D="")}S?i._scale++:d=g}else"E"===_||"e"===_?(l=g,""!==o&&w.push(o),o=_):o+=_;else"#"!==b&&"0"!==b&&(w.push(o),o="#"),""!==o&&(w.push(o),o=""),i._intPart=w,w=[],h=g,v=m,d&&(i._group=g,d=m);b=_}return""!==o&&(l&&!y&&(i._exponent=F(o)),w.push(o)),d&&(i._group=g),h?i._decPart=w:i._intPart=w,a(e)?e=i:a(n)?n=i:a(r)&&(r=i),{_normal:e,_negative:n,_zero:r}}function D(t,e,n){for(var r=e[0],i=1,o=t.length-1,a="",u=0,s=m;o>=0;){if(r<1||r>9)throw new Error(M().Exp_InvalidNumberGroupSize);/\\d/gi.test(t[o])?(s&&(a=n+a,s=m),u++):u=0,a=t[o]+a,u===r&&(s=g,u=0,i<e.length&&(r=e[i],i++)),o--}return a}function k(t,e,n,i,o,a,u){var s=A(t,-e);isFinite(s)||(s=t),t=s;var f,p,h=t.toString(),y=h.split(/e/i);return h=y[0],p=y.length>1?d(y[1],10):0,y=h.split("."),h=y[0],f=y.length>1?y[1]:"",p>0?(f=l(f,p),h+=f.slice(0,p),f=r(f,p)):p<0&&(p=-p,h=t<0?a+c(h.replace(a,""),p+1):c(h,p+1),f=h.slice(-p,h.length)+f,h=h.slice(0,-p)),e>0?(f=f.length>e?f.slice(0,e):l(f,e),f=o+f):f="",u===g?h+f:D(h,n,i,a)+f}function E(t,e,n){var i="";t*=b(100,e._percent),t*=b(1e3,e._permile),t/=b(10,3*e._scale);var o=e._intPart,a=e._decPart;if(!o&&!a)return"";var u,s,l,f,h,d=p,y=p;if(o)for(d="",u=0;u<o.length;u++)s=o[u],/^(0|#)+/g.test(s)&&(d+=s);if(a)for(y="",l=0;l<a.length;l++)f=a[l],/^(0|#)+/g.test(f)&&(y+=f);if(!d&&!y)return(o?o.join(""):"")+(a?a.join(""):"");y||(y="");var v=0,M=x(t,".");if(e._exponent){var w=_(t),F=d?d.length:1;if(w>=1)M._integer>F?(M._integer-=F,M._decimal+=F,t/=b(10,M._integer),v=M._integer):v=(M._integer,0),-1===e._exponent._sign&&(e._exponent._sign=0);else if(w<1&&w>0){e._exponent._sign=-1,M._integer=F,M._decimal-=F;for(var S=b(10,F);10*w<S;)w*=10,v++;t*=b(10,v)}}var E=y.lastIndexOf("0"),C=y.lastIndexOf("#"),T=M._decimal;E>=0&&(T=E+1),C>E&&C<M._decimal&&(T=C+1),a||(T=0);var N=k(t,T,n.numberGroupSizes,n.numberGroupSeparator,n.numberDecimalSeparator,n.negativeSign,g);if(""===N)return(o?o.join(""):"")+(a?a.join(""):"");var O=m;if(o){var A=N.split(".")[0],j=r(A,0,1);j===n.negativeSign&&(A=r(A,1));var L=0,R="",$=d.indexOf("0"),z=1===A.length&&"0"===A?0:A.length,W=-1===$?z:d.length-$;for(A=0===W?"":A,u=o.length-1;u>=0;u--)if(s=o[u],/^(0|#)+/g.test(s))if((R=s+R)!==d){for(var B=s.length,q=A.length-L-1;q>=0&&B>0;q--){var U=A.charAt(q);i=U+i,B--,L++}L>=A.length&&L<W&&B>0&&(i=new Array(B+1).join("0")+i,L+=B)}else{var Y=r(A,0,A.length-L);$>=0&&$<d.length-L-Y.length&&(Y=new Array(d.length-L-$-Y.length+1).join("0")+Y),i=Y+i}else e._exponent&&!O&&/^((E(\\+|-)?|e(\\+|-)?)\\d+)/g.test(s)?(O=g,h="",h+=e._exponent._symbol,h+=H[e._exponent._sign],h+=c(v.toString(),e._exponent._exp),i=h+i):i=s+i;j===n.negativeSign&&(i=j+i),e._group===g&&(i=D(i,n.numberGroupSizes,n.numberGroupSeparator,n.negativeSign))}if(a){var G="";if(T>0){var J=N.indexOf(".");-1!==J&&(G=N.substring(J+1),""===d&&(i+=r(N,0,J)),i+=n.numberDecimalSeparator)}else/^(#+)$/gi.test(y)&&a.join("").length===y.length||(E<=0&&N.indexOf(".")<0&&d===P&&y===I||(i+="."),E>0&&(G=new Array(E+1).join("0")));var V=0;for(l=0;l<a.length;l++)f=a[l],/^(0|#)+/g.test(f)?(i+=r(G,V,f.length),V+=f.length):e._exponent&&!O&&/^((E(\\+|-)?|e(\\+|-)?)\\d+)/g.test(f)?(O=g,h="",h+=e._exponent._symbol,h+=H[e._exponent._sign],h+=c(v.toString(),e._exponent._exp),i+=h):i+=f}var K=i.indexOf("0.");return 0===K&&(K+2===i.length&&0===M._decimal?i=i.replace("0.","."):K+2<i.length&&(/[0-9]+/g.test(i.charAt(K+2))||(i=i.replace("0.",".")))),i}function C(t,e){if(t=a(t)?"":s._trimEnd(t,""),t.match(/^[+-]?infinity$/i))return y(t);if(t.match(/^0x[a-f0-9]+$/i))return d(t,10);var n=e.NumberFormat,i=n.numberNegativePattern,o=T(t,n,i),u=o[0],c=o[1];""===u&&1!==i&&(o=T(t,n,1),u=o[0],c=o[1]),""===u&&(u="+"),c[0]===n.currencySymbol&&(c=r(c,1));var l,f,h=c.indexOf("e");h<0&&(h=c.indexOf("E")),h<0?(f=c,l=p):(f=r(c,0,h),l=r(c,h+1));var m,g,v=f.indexOf(".");v<0?(m=f,g=p):(m=r(f,0,v),g=r(f,v+".".length)),m=m.split(",").join("");var _=",".replace(/\\u00A0/g," ");","!==_&&(m=m.split(_).join(""));var b=u+m;if(g!==p&&(b+="."+g),b[b.length-1]===n.percentSymbol){b=r(b,0,b.length-1),b=s._trimEnd(b,"");var M=b.indexOf(".");-1===M&&(M=b.length);var w="";w+=r(b,0,M-2),w+=".",w+=r(b,M-2,2),w+=r(b,M+1),b=w}if(l!==p){var x=T(l,n,1);""===x[0]&&(x[0]="+"),b+="e"+x[0]+x[1]}return b.match(/^[+-]?\\d*\\.?\\d*(e[+-]?\\d+)?$/)?y(b):NaN}function T(t,e,n){var i=e.negativeSign,o=e.positiveSign,a=s;if(4!==n&&2!==n||(i=" "+i,o=" "+o),4===n||3===n){if(a._endsWith(t,i))return["-",r(t,0,t.length-i.length)];if(a._endsWith(t,o))return["+",r(t,0,t.length-o.length)]}else if(2===n||1===n){if(a._startsWith(t,i))return["-",r(t,i.length)];if(a._startsWith(t,o))return["+",r(t,o.length)]}else{if(0!==n)throw new Error("");if(a._startsWith(t,"(")&&a._endsWith(t,")"))return["-",r(t,1,t.length-2)]}return["",t]}function N(t,e,n){if(0!==_(v(t)-t))throw new Error(M().Exp_BadFormatSpecifier);var r=t>=0?t.toString(16):(L+t+1).toString(16);return r=e?r.toLowerCase():r.toUpperCase(),!a(n)&&r.length<n?c(r,n):r}function O(t,e,n,r,i,o,a){for(var u=0,s=t>=1||0===t;u<1e3;){var l=b(10,u);if(s&&t/l<10||!s&&t*l>=1)break;u++}t=s?_(t)/b(10,u):_(t)*b(10,u);var f=k(t,n,r,i,o,a);return f+=e+(s?"+":"-")+c(u.toString(),3)}function A(t,e){return typeof e===h||0==+e?Math.round(t):(t=+t,e=+e,isNaN(t)||"number"!=typeof e||e%1!=0?NaN:(t=t.toString().split("e"),t=Math.round(+(t[0]+"e"+(t[1]?+t[1]-e:-e))),t=t.toString().split("e"),+(t[0]+"e"+(t[1]?+t[1]+e:e))))}function j(t){var e=f._getCultureInfo().NumberFormat;return"string"==typeof t&&(e=f._getCultureInfo(t).NumberFormat),e}var P="##################0",I="################",H={1:"+",0:"","-1":"-"},L=4294967295,R=["n %","n%","%n","% n"],$=["-n %","-n%","-%n","%-n","%n-","n-%","n%-","-% n","n %-","% n-","% -n","n- %"],z=["(n)","-n","- n","n-","n -"],W=["$n","n$","$ n","n $"],B=["($n)","-$n","$-n","$n-","(n$)","-n$","n-$","n$-","-n $","-$ n","n $-","$ n-","$ -n","n- $","($ n)","(n $)"],q="#dot#",U="#group#";return{_parseLocale:function(t){return C(t,f._getCultureInfo())},_parseInvariant:function(t){return C(t,f._getCultureInfo("invariant"))},_customCultureFormat:function(e,n,r){return r||(r=f._getCultureInfo()),t(e,n,r)},_replaceNormalToCultureSymbol:function(t,e){if("string"!=typeof t)return t;var n=j(e),r=n.numberDecimalSeparator,o=n.numberGroupSeparator;return"."!==r&&(t=t.replace(i("[.]"),q)),","!==o&&(t=t.replace(i("[,]"),U)),"."!==r&&(t=t.replace(i(q),r)),","!==o&&(t=t.replace(i(U),o)),t},_replaceCultureSymbolToNormal:function(t,e){if("string"!=typeof t)return t;var n=j(e),r=n.numberDecimalSeparator,o=n.numberGroupSeparator;return"."!==r&&(t=t.replace(i("["+r+"]"),q)),","!==o&&(t=t.replace(i("["+o+"]"),U)),"."!==r&&(t=t.replace(i(q),".")),","!==o&&(t=t.replace(i(U),",")),t},_parseFloat:function(t,e){return y(this._replaceCultureSymbolToNormal(t,e))},_toHexString:N}}();t.exports=w},function(t,e,n){"use strict";var r=function(){function t(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&u.return&&u.return()}finally{if(i)throw o}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=[{name:"color"},{name:"background"},{name:"font-size"},{name:"width"},{name:"height"},{name:"rowspan"},{name:"colspan"},{name:"align",values:["left","center","right"]},{name:"bold",values:[!1,!0]},{name:"italic",values:[!1,!0]},{name:"underline",values:[!1,!0]},{name:"vertical",values:["top","middle","bottom"]},{name:"strike",values:[!1,!0]},{name:"wrap",values:["text-wrap","text-no-wrap"]},{name:"fixedRowsTop"},{name:"fixedColumnsLeft"},{name:"link"},{name:"format",values:["normal","0,0","0,0.00","0%","0.00%","0.00E+00","(0,0)","(0,0.00)","¥0,0","¥0,0.00","$0,0","$0,0.00","YYYY/MM/DD","YYYY-MM-DD","HH:mm:ss","YYYY/MM/DD HH:mm:ss"]},{name:"formula"},{name:"filter"},{name:"border-top"},{name:"border-right"},{name:"border-bottom"},{name:"border-left"}],o="|",a=":",u=i.reduce(function(t,e,n){return e.index=n,t[e.name]=e,t},{});t.exports={pack:function(t){if("object"==typeof t&&null!==t){var e=[];for(var n in t)if(t.hasOwnProperty(n)){var r=t[n];if(void 0!==r){var i=u[n];i&&(n=i.index,i.values&&null!==r&&-1===(r=i.values.indexOf(r)))||e.push(null===r?n:n+a+JSON.stringify("string"==typeof r?encodeURIComponent(r):r))}}return e.sort().join(o)}},unpack:function(t){if("string"!=typeof t)return{};for(var e={},n=t.split(o),u=0;u<n.length;u++){var s=n[u].split(a),c=r(s,2),l=c[0],f=c[1],p=i[l];if(f){f=JSON.parse(f);var h=typeof f;"string"===h&&(f=decodeURIComponent(f)),p&&(l=p.name,p.values&&"number"===h&&void 0!==p.values[f]&&(f=p.values[f]))}else p&&(l=p.name),f=null;e[l]=f}return e},merge:function(t,e,n){if(n&&!t)return e;if(!e)return t;t=this.unpack(t),e=this.unpack(e);for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r],n||null!==t[r]||delete t[r]);return this.pack(t)},invert:function(t,e){if(e){if(!t)return e.split(o).map(function(t){var e=t.indexOf(a);return-1===e?t:t.slice(0,e)}).join(o);t=this.unpack(t),e=this.unpack(e);for(var n in e)e.hasOwnProperty(n)&&(void 0!==t[n]?e[n]=t[n]:e[n]=null);return this.pack(e)}},transform:function(t,e,n){if(n)return e;if(e){if(!t)return e;t=this.unpack(t),e=this.unpack(e);for(var r in e)e.hasOwnProperty(r)&&void 0!==t[r]&&delete e[r];return this.pack(e)}},diff:function(t,e){if(!t)return e;t=this.unpack(t),e&&(e=this.unpack(e));for(var n={},r=!0,i=e?Object.keys(t).concat(Object.keys(e)):Object.keys(t),o=0;o<i.length;o++){var a=i[o],u=e?e[a]:void 0;t[a]!==u&&(r=!1,n[a]=void 0===u?null:u)}return r?void 0:this.pack(n)}}},function(t,e){function n(t){var e=t&&t.toString();return!/^0+\\d*$/.test(e)&&e-parseFloat(e)+1>=0}function r(t){var e=String(t),n=0;return!isNaN(Number(t))&&e.indexOf(".")>-1&&(n=e.split(".")[1].length),n}function i(t){return!!(n(t)&&t.toString().length>16)}function o(t){return!!(n(t)&&t.toString().length<=16)}function a(t){return n(t)&&t.toString().length<=16?Number(t,10):t}Object.defineProperty(e,"__esModule",{value:!0}),e.isNumeric=n,e.getFractionLen=r,e.isBigNumber=i,e.isValidNumber=o,e.strToNum=a},function(t,e,n){var r=n(3),i=n(6),o=n(17),a=n(9).CultureManager,u=n(4)._isNullOrUndefined,s=i._padZeroLeft,c=null,l=parseInt,f=!1,p=!0,h=Math.floor,d=Math.abs,y=function(){return r._getResource(r.SR)()},m={},g=function(){function t(t,e,n){var r,i,o,a,u,s=f;for(u=n,u.slice(1).forEach(function(t){t&&(s=!0)}),s||(u=u.concat(e._getDateTimePattern())),r=1,i=u.length;r<i;r++)if((a=u[r])&&(s=p,o=b(t,a,e)))return o;return c}function e(t,r,i){function o(){return f||m?f:(f=w.test(r),m=p,f)}function a(t,e){if(g)return g[e];switch(e){case 0:return t.getFullYear();case 1:return t.getMonth();case 2:return t.getDate()}}var u=i.DateTimeFormat,c=u.Calendar.convert;if(!r||!r.length)return i&&i.name.length?c?e(t,u.fullDateTimePattern,i):t.toLocaleString():t.toString();var l,f,m,g,_=u.eras,b="s"===r,M="",w=/([^d]|^)(d|dd)([^d]|$)/g,x=0,F=v();!b&&c&&(g=c.fromGregorian(t));for(var S=-2,D=-2,k={_value:""},E=0;;E++){var C=F.lastIndex,T=F.exec(r),N=r.slice(C,T?T.index:r.length);if(k._value="",x+=n(N,k),M+=k._value,!T)break;if(x%2!=1){var O=t.getFullYear(),A=t.getDay(),j=t.getHours(),P=t.getMinutes(),I=t.getSeconds(),H=t.getMilliseconds(),L=t.getTimezoneOffset();switch(T[0]){case"dddd":M+=u.dayNames[A];break;case"ddd":M+=u.abbreviatedDayNames[A];break;case"dd":case"DD":f=p,M+=s(a(t,2),2);break;case"d":f=p,M+=a(t,2);break;case"MMMM":M+=u.monthGenitiveNames&&o()?u.monthGenitiveNames[a(t,1)]:u.monthNames[a(t,1)];break;case"MMM":M+=u.abbreviatedMonthGenitiveNames&&o()?u.abbreviatedMonthGenitiveNames[a(t,1)]:u.abbreviatedMonthNames[a(t,1)];break;case"MM":M+=s(a(t,1)+1,2);break;case"M":M+=a(t,1)+1;break;case"yyyy":case"YYYY":case"yyy":M+=S>=0?_._formatEraPart("ee",t):s(g?g[0]:O,4);break;case"yy":M+=S>=0?_._formatEraPart("ee",t):s((g?g[0]:O)%100,2);break;case"y":M+=S>=0?_._formatEraPart("e",t):((g?g[0]:O)%100).toString();break;case"hh":l=j%12,0===l&&(l=12),M+=s(l,2);break;case"h":l=j%12,0===l&&(l=12),M+=l;break;case"HH":M+=s(j,2);break;case"H":M+=j.toString();break;case"mm":M+=s(P,2);break;case"m":M+=P.toString();break;case"ss":M+=s(I,2);break;case"s":M+=I.toString();break;case"tt":M+=j<12?u.amDesignator:u.pmDesignator;break;case"t":M+=(j<12?u.amDesignator:u.pmDesignator).charAt(0);break;case"f":M+=s(H,3).charAt(0);break;case"ff":M+=s(H,3).substr(0,2);break;case"fff":M+=s(H,3);break;case"z":l=L/60,M+=(l<=0?"+":"-")+h(d(l));break;case"zz":l=L/60,M+=(l<=0?"+":"-")+s(h(d(l)),2);break;case"zzz":l=L/60,M+=(l<=0?"+":"-")+s(h(d(l)),2)+":"+s(d(L%60),2);break;case"g":case"gg":case"ggg":if(!_)break;if(S===E-1){S=E;break}M+=_._formatEraPart(T[0],t),S=E;break;case"e":case"ee":if(!_){M+=s(g?g[0]:O,4);break}if(D===E-1){D=E;break}M+=_._formatEraPart(T[0],t),D=E;break;case"/":M+=u.dateSeparator;break;case"[h]":case"[hh]":case"[H]":case"[HH]":case"[mm]":case"[ss]":M+=T[0];break;default:throw new Error(y().Exp_InvalidDateFormat)}}else M+=T[0]}return M.toString()}function n(t,e){for(var n=0,r=f,i=0,o=t.length;i<o;i++){var a=t.charAt(i);switch(a){case\'"\':r?e._value+="\'":n++,r=f;break;case"\\\\":r&&(e._value+="\\\\"),r=!r;break;default:e._value+=a,r=f}}return n}function r(t,e){var n=new Date,r=t.DateTimeFormat.eras;if(r&&e<100){var i=r._getEraDate(n)._eraYear;e+=i-i%100,e>t.DateTimeFormat.Calendar.TwoDigitYearMax&&(e-=100)}return e}function v(){return/\\/|dddd|ddd|dd|DD|d|MMMM|MMM|MM|M|yyyy|YYYY|yyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|zzz|zz|z|ggg|gg|g|ee|e|\\[H\\]|\\[HH\\]|\\[h\\]|\\[hh\\]|\\[mm\\]|\\[ss\\]/g}function _(t,e){if(t._parseRegExp){if(t._parseRegExp[e])return t._parseRegExp[e]}else t._parseRegExp={};var r=e;r=r.replace("%M","M"),r=r.replace(/([\\^\\$\\.\\*\\+\\?\\|\\[\\]\\(\\)\\{\\}])/g,"\\\\\\\\$1");for(var i,a="^",u={_value:""},s=[],l=0,f=0,p=v();(i=p.exec(r))!==c;){u._value="";var h=r.slice(l,i.index);if(l=p.lastIndex,f+=n(h,u),a+=u._value,f%2!=1){switch(i[0]){case"dddd":case"ddd":case"MMMM":case"MMM":case"gggg":case"ggg":case"gg":case"g":a+="(\\\\D+)";break;case"tt":case"t":a+="(\\\\D*)";break;case"dd":case"d":case"MM":case"M":case"yy":case"y":case"eee":case"ee":case"e":case"HH":case"H":case"hh":case"h":case"mm":case"m":case"ss":case"s":a+="(\\\\d\\\\d?)";break;case"yyy":case"yyyy":a+="(\\\\d{2}|\\\\d{4})";break;case"fff":a+="(\\\\d{3})";break;case"ff":a+="(\\\\d{2})";break;case"f":a+="(\\\\d)";break;case"zzz":a+="([+-]?\\\\d\\\\d?:\\\\d{2})";break;case"zz":case"z":a+="([+-]?\\\\d\\\\d?)";break;case"/":a+="(\\\\"+t.dateSeparator+")";break;default:throw new Error(y().Exp_InvalidDateFormat)}o._add(s,i[0])}else a+=i[0]}u._value="",n(r.slice(l),u),a+=u._value,a+="$";var d=a.toString().replace(/\\s+/g,"\\\\s+"),m={_regExp:d,_groups:s,_exp:new RegExp(d)};return t._parseRegExp[e]=m,m}function b(t,e,n){t=t.trim();var o=n.DateTimeFormat,a=_(o,e),u=a._exp.exec(t);if(u===c)return c;for(var s,p=a._groups,h=c,d=c,y=c,m=c,g=c,v=0,b=0,M=0,w=0,x=c,F=f,S=0,D=p.length;S<D;S++){var k=u[S+1];if(k)switch(p[S]){case"dd":case"d":if((m=l(k,10))<1||m>31)return c;break;case"MMMM":if((y=n._getMonthIndex(k))<0||y>11)return c;break;case"MMM":if((y=n._getAbbrMonthIndex(k))<0||y>11)return c;break;case"M":case"MM":case"%M":if((y=l(k,10)-1)<0||y>11)return c;break;case"e":case"ee":if((d=r(n,l(k,10)))<0||d>9999)return c;break;case"y":case"yy":case"yyy":case"yyyy":if((d=l(k,10))<0||d>9999)return c;break;case"h":case"hh":case"H":case"HH":if((v=l(k,10))<0)return c;break;case"m":case"mm":if((b=l(k,10))<0||b>59)return c;break;case"s":case"ss":if((M=l(k,10))<0||M>59)return c;break;case"tt":case"t":var E=k.toUpperCase();if(!(F=E===o.pmDesignator.toUpperCase())&&E!==o.amDesignator.toUpperCase())return c;break;case"f":if((w=100*l(k,10))<0||w>999)return c;break;case"ff":if((w=10*l(k,10))<0||w>999)return c;break;case"fff":if((w=l(k,10))<0||w>999)return c;break;case"dddd":if((g=n._getDayIndex(k))<0||g>6)return c;break;case"ddd":if((g=n._getAbbrDayIndex(k))<0||g>6)return c;break;case"zzz":var C=k.split(/:/);if(2!==C.length)return c;if((s=l(C[0],10))<-12||s>13)return c;var T=l(C[1],10);if(T<0||T>59)return c;x=60*s+(i._startsWith(k,"-")?-T:T);break;case"z":case"zz":if((s=l(k,10))<-12||s>13)return c;x=60*s;break;case"g":case"gg":case"ggg":var N=k;if(!N||!o.eras)return c;if((h=o.eras._parseEraPart(p[S],N))<0)return c}}var O,A=/^(\\d|\\d\\d):/.test(t),j=A?new Date(1899,11,30):new Date,P=o.Calendar.convert;if(P&&(O=P.fromGregorian(j)),P||(O=[j.getFullYear(),j.getMonth(),j.getDate()]),d===c?d=O[0]:d<100&&(o.eras?d=o.eras._getYearFromEra(h||0,d):d+=d>=30?1900:2e3),y===c&&(y=O[1]),m===c&&(m=O[2]),P){if((j=P.toGregorian(d,y,m))===c)return c}else{if(j.setFullYear(d,y,m),j.getDate()!==m)return c;if(g!==c&&j.getDay()!==g)return c}if(F&&v<12&&(v+=12),j.setHours(v,b,M,w),x!==c){var I=j.getMinutes()-(x+j.getTimezoneOffset());j.setHours(j.getHours()+I/60,I%60)}return j}return{_customCultureFormat:function(t,n,r){return r||(r=a._getCultureInfo()),e(t,n,r)},_localeFormat:function(t,n,r){return e(t,n,r||a._getCultureInfo())},_parseLocale:function(e,n,r){var i,o;return n||r||void 0===(o=m[e])?(i=n?[e,n]:[e],o=t(e,r||a._getCultureInfo(),i),n||r||(m[e]=o),o?new Date(o):o):o?new Date(o):o},_parseInvariant:function(e,n){return t(e,a._getCultureInfo("invariant"),[e,n])},_parseExact:b,_fromOADate:function(t){var e=t-25569,n=new Date(864e5*e),r=e>=0?1:-1,i=n.getTimezoneOffset(),o=(864e5*t*1440+r-3181192704e6+864e5*i)/1440,a=new Date(o),u=i>=0?1:-1,s=new Date(o+36e5*u),c=s.getTimezoneOffset();if(i!==c){var l=new Date(o+60*(c-i)*1e3);if(i>c){if(-1===u||c===a.getTimezoneOffset())return l}else if(i<c&&(1===u||c===a.getTimezoneOffset()))return l}return a},_toOADate:function(t){return u(t)?0:("number"==typeof t&&(t=new Date(t)),(1440*t.getTime()+3181192704e6-864e5*t.getTimezoneOffset())/124416e6)},_DT:function(t){var e=c,n=p;if(u(t))e=this._fromOADate(0);else if(t instanceof Date)e=new Date(t);else if("string"==typeof t){var r=this._parseLocale(t);r||isNaN(t)||(r=g._fromOADate(parseFloat(t)))||(n=f),e=r}else"number"==typeof t?e=this._fromOADate(t):n=f;if(n)return e;throw y().Exp_InvalidCast}}}();t.exports=g},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn\'t been initialised - super() hasn\'t been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},s=n(8),c=function(t){function e(t){var n,o;return r(this,e),o=n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),i(n,o)}return o(e,t),a(e,[{key:"setData",value:function(t){if(u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),"number"==typeof this.data&&1!==this.data)throw new Error(\'The value of data should be "1", got \'+this.data);return this}},{key:"name",value:function(){return"CellOperator"}}]),e}(s);c.packId=4,t.exports=c},function(t,e,n){(function(e){function r(t){return t&&t.__esModule?t:{default:t}}function i(t){if("retain"===t.action&&1===t.data)return null;var n=t.getAttributes();if(n&&n.formula)return n.formula;if(n&&n.format){var r=t.data.ops[0];if(r&&"remove"!==r.action){var i=(0,g.strToNum)(r.data);return e.isNil(i)?"":i}return""}var o=t.data.ops||[],a=[];return o.forEach(function(t){"remove"===t.action||e.isNil(t.data)||a.push(t.data)}),a.length>1?a.join(""):(0,g.strToNum)(a[0])}function o(t,n,r){function i(t){return e.isNil(t)?0:t.toString().length}var o=c(n.attrs),a=u(t,n),p=a.value,h=a.format,m=i(t.value),g=t.attrs||{};if((0,d.isFormula)(p))return l(p,m,o,r);var v=[];v.push(new f.TextOperator({action:"insert",data:p})),m>0&&v.push((0,y.genRemoveOps)(m));var _={action:"retain",data:new f.Delta(v)},b=s(p,h,g,o);return b.userID=r,Object.keys(b).length>0&&(_.attributes=b),new f.CellOperator(_)}function a(t,e){var n=c(e.attrs),r=u(t,e),i=r.value,o=r.format;return(0,d.isFormula)(i)?[null,{formula:i,align:"right"}]:[i,s(i,o,t.attrs||{},n)]}function u(t,n){var r=n.attrs,i=e.isNil(n.value)?"":n.value,o=void 0;if(i instanceof Date)i=(0,m.getDateText)(i);else{var a=(0,m.parseFormat)(i);o=a.format,i=a.value}return r.format&&(o=r.format),e.isNumber(i)&&(i=i.toString()),{value:i,format:o}}function s(t,n,r,i){var o={};if(r.format&&!n){(!(0,g.isNumeric)(t)||(0,g.isNumeric)(t)&&v.indexOf(r.format)>-1)&&(o.format=null)}return t&&h.default.isUrl(t)?o.link=t:n&&n!==r.format&&(o.format=n),"string"==typeof t&&t.indexOf("\\n")>-1&&"text-wrap"!==r.wrap&&(o.wrap="text-wrap"),r.formula&&(o.formula=i.formula||null),r.link&&(o.link=i.link||null),o=e.assign(i,o)}function c(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return delete t.manualAlign,delete t.autoFormatter,t}function l(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments[3],o=[];return n&&(o=new f.Delta([(0,y.genRemoveOps)(n)])),new f.CellOperator({action:"retain",data:o,attributes:e.assign(r,{formula:t,align:"right",userID:i})})}var f=n(1),p=n(29),h=r(p),d=n(32),y=n(16),m=n(35),g=n(12);t.exports={cells2Value:i,value2Cs:o,formula2Cs:l,text2Cell:a};var v=["YYYY/MM/DD","YYYY/MM/DD HH:mm:ss","HH:mm:ss"]}).call(e,n(0))},function(t,e,n){(function(t){function r(t){return new h.CellOperator({action:"retain",data:1,attributes:t})}function i(t){return new h.Operator({action:"remove",data:t})}function o(t){var e={};for(var n in t)e[n]=null;return e}function a(e,n){var r=e.ops||[],i=2===arguments.length;return t.find(r,function(t){var e=t.getAttributes()||{};return u(t)&&(i&&e.id===n||!i)})}function u(e){var n=e.getAttributes()||{},r=e.action,i=e.data;return!("retain"===r&&"number"==typeof i&&t.isEmpty(n)||"remove"===r)}function s(t){return"retain"!==t.action||"retain"===t.action&&t.getAttributes().name}function c(t){for(var e=t.ops,n=0,r=e.length;n<r;n++)if(s(e[n]))return!0;return!1}function l(t){function e(t,e){return t[0]-e[0]}for(var n,r,i,o,a=[],u=[],s={},c=0,l=t.length;c<l;c++)n=t[c].getAttributes(),r=n.id,i=n.order,u.push([i,r]),s[r]=t[c];o=u.sort(e);for(var f=0,p=o.length;f<p;f++)a.push(s[o[f][1]]);return a}function f(t){var e=[],n=[];return t.ops.forEach(function(t){var r=t.getAttributes(),i=Object.keys(r);"object"===p(t.data)&&e.push(r.id),i.length&&n.push(r.id)}),e.length?e[0]:n.length?n[0]:void 0}Object.defineProperty(e,"__esModule",{value:!0});var p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.changeCellAttrs=r,e.genRemoveOps=i,e.clearAttrs=o,e.findTableOpInApplyCsById=a,e.isTableChanged=u,e.isSheetChangeCs=s,e.isSheetChangeByOps=c,e.sortOps=l,e.getFirstModifiedSheetIdByCs=f;var h=n(1)}).call(e,n(0))},function(t,e){var n=null,r=void 0,i=function(){function t(){}return t._insert=function(t,e,n){t.splice(e,0,n)},t._add=function(t,e){t.push(e)},t._contains=function(t,e){return t.indexOf(e)>-1},t._remove=function(t,e){var n=t.indexOf(e);n>-1&&t.splice(n,1)},t._removeByIndex=function(t,e){return t=t.slice(0,e).concat(t.slice(e+1))},t._indexOf=function(t,e,n){return t.indexOf(e,n)},t._clear=function(t,e,r){if(!(e<0))for(var i=0,o=0;i<r&&o<t.length;o++)t[e+o]=n,i++},t._nextNonEmptyIndex=function(t,e){e<0&&(e=-1);for(var i=e+1,o=i;o<t.length;o++)if(t[o]!==r&&t[o]!==n)return o;return-1},t._getLength=function(t){return t&&t.length},t}();t.exports=i},function(t,e,n){function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function i(t){return t&&t.__esModule?t:{default:t}}var o=n(1),a=i(o),u=n(28),s=r(u),c=n(44),l=r(c);self._wrapCs=function(t){return new o.Delta([t])},onmessage=function(t){var e=t.data,n=e.type,r=e.action,i=e.uuid,o=e.params;if("sheet-cs-calculate"===n){var u=s[r].apply(self,o),c={type:n,action:r,uuid:i,res:[a.default.pack(self._wrapCs(u[0])),u[1]]};postMessage(c)}else if("cs-to-action"===n){var f=a.default.unpack(o[0]).ops[0],p=l[r](f),h={type:n,action:r,uuid:i,res:p};postMessage(h)}}},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e){function n(t,e,n){if(t==e)return t?[[y,t]]:[];(n<0||t.length<n)&&(n=null);var i=a(t,e),o=t.substring(0,i);t=t.substring(i),e=e.substring(i),i=u(t,e);var s=t.substring(t.length-i);t=t.substring(0,t.length-i),e=e.substring(0,e.length-i);var l=r(t,e);return o&&l.unshift([y,o]),s&&l.push([y,s]),c(l),null!=n&&(l=f(l,n)),l}function r(t,e){var r;if(!t)return[[d,e]];if(!e)return[[h,t]];var o=t.length>e.length?t:e,a=t.length>e.length?e:t,u=o.indexOf(a);if(-1!=u)return r=[[d,o.substring(0,u)],[y,a],[d,o.substring(u+a.length)]],t.length>e.length&&(r[0][0]=r[2][0]=h),r;if(1==a.length)return[[h,t],[d,e]];var c=s(t,e);if(c){var l=c[0],f=c[1],p=c[2],m=c[3],g=c[4],v=n(l,p),_=n(f,m);return v.concat([[y,g]],_)}return i(t,e)}function i(t,e){for(var n=t.length,r=e.length,i=Math.ceil((n+r)/2),a=i,u=2*i,s=new Array(u),c=new Array(u),l=0;l<u;l++)s[l]=-1,c[l]=-1;s[a+1]=0,c[a+1]=0;for(var f=n-r,p=f%2!=0,y=0,m=0,g=0,v=0,_=0;_<i;_++){for(var b=-_+y;b<=_-m;b+=2){var M,w=a+b;M=b==-_||b!=_&&s[w-1]<s[w+1]?s[w+1]:s[w-1]+1;for(var x=M-b;M<n&&x<r&&t.charAt(M)==e.charAt(x);)M++,x++;if(s[w]=M,M>n)m+=2;else if(x>r)y+=2;else if(p){var F=a+f-b;if(F>=0&&F<u&&-1!=c[F]){var S=n-c[F];if(M>=S)return o(t,e,M,x)}}}for(var D=-_+g;D<=_-v;D+=2){var S,F=a+D;S=D==-_||D!=_&&c[F-1]<c[F+1]?c[F+1]:c[F-1]+1;for(var k=S-D;S<n&&k<r&&t.charAt(n-S-1)==e.charAt(r-k-1);)S++,k++;if(c[F]=S,S>n)v+=2;else if(k>r)g+=2;else if(!p){var w=a+f-D;if(w>=0&&w<u&&-1!=s[w]){var M=s[w],x=a+M-w;if(S=n-S,M>=S)return o(t,e,M,x)}}}}return[[h,t],[d,e]]}function o(t,e,r,i){var o=t.substring(0,r),a=e.substring(0,i),u=t.substring(r),s=e.substring(i),c=n(o,a),l=n(u,s);return c.concat(l)}function a(t,e){if(!t||!e||t.charAt(0)!=e.charAt(0))return 0;for(var n=0,r=Math.min(t.length,e.length),i=r,o=0;n<i;)t.substring(o,i)==e.substring(o,i)?(n=i,o=n):r=i,i=Math.floor((r-n)/2+n);return i}function u(t,e){if(!t||!e||t.charAt(t.length-1)!=e.charAt(e.length-1))return 0;for(var n=0,r=Math.min(t.length,e.length),i=r,o=0;n<i;)t.substring(t.length-i,t.length-o)==e.substring(e.length-i,e.length-o)?(n=i,o=n):r=i,i=Math.floor((r-n)/2+n);return i}function s(t,e){function n(t,e,n){for(var r,i,o,s,c=t.substring(n,n+Math.floor(t.length/4)),l=-1,f="";-1!=(l=e.indexOf(c,l+1));){var p=a(t.substring(n),e.substring(l)),h=u(t.substring(0,n),e.substring(0,l));f.length<h+p&&(f=e.substring(l-h,l)+e.substring(l,l+p),r=t.substring(0,n-h),i=t.substring(n+p),o=e.substring(0,l-h),s=e.substring(l+p))}return 2*f.length>=t.length?[r,i,o,s,f]:null}var r=t.length>e.length?t:e,i=t.length>e.length?e:t;if(r.length<4||2*i.length<r.length)return null;var o,s=n(r,i,Math.ceil(r.length/4)),c=n(r,i,Math.ceil(r.length/2));if(!s&&!c)return null;o=c?s&&s[4].length>c[4].length?s:c:s;var l,f,p,h;return t.length>e.length?(l=o[0],f=o[1],p=o[2],h=o[3]):(p=o[0],h=o[1],l=o[2],f=o[3]),[l,f,p,h,o[4]]}function c(t){t.push([y,""]);for(var e,n=0,r=0,i=0,o="",s="";n<t.length;)switch(t[n][0]){case d:i++,s+=t[n][1],n++;break;case h:r++,o+=t[n][1],n++;break;case y:r+i>1?(0!==r&&0!==i&&(e=a(s,o),0!==e&&(n-r-i>0&&t[n-r-i-1][0]==y?t[n-r-i-1][1]+=s.substring(0,e):(t.splice(0,0,[y,s.substring(0,e)]),n++),s=s.substring(e),o=o.substring(e)),0!==(e=u(s,o))&&(t[n][1]=s.substring(s.length-e)+t[n][1],s=s.substring(0,s.length-e),o=o.substring(0,o.length-e))),0===r?t.splice(n-i,r+i,[d,s]):0===i?t.splice(n-r,r+i,[h,o]):t.splice(n-r-i,r+i,[h,o],[d,s]),n=n-r-i+(r?1:0)+(i?1:0)+1):0!==n&&t[n-1][0]==y?(t[n-1][1]+=t[n][1],t.splice(n,1)):n++,i=0,r=0,o="",s=""}""===t[t.length-1][1]&&t.pop();var l=!1;for(n=1;n<t.length-1;)t[n-1][0]==y&&t[n+1][0]==y&&(t[n][1].substring(t[n][1].length-t[n-1][1].length)==t[n-1][1]?(t[n][1]=t[n-1][1]+t[n][1].substring(0,t[n][1].length-t[n-1][1].length),t[n+1][1]=t[n-1][1]+t[n+1][1],t.splice(n-1,1),l=!0):t[n][1].substring(0,t[n+1][1].length)==t[n+1][1]&&(t[n-1][1]+=t[n+1][1],t[n][1]=t[n][1].substring(t[n+1][1].length)+t[n+1][1],t.splice(n+1,1),l=!0)),n++;l&&c(t)}function l(t,e){if(0===e)return[y,t];for(var n=0,r=0;r<t.length;r++){var i=t[r];if(i[0]===h||i[0]===y){var o=n+i[1].length;if(e===o)return[r+1,t];if(e<o){t=t.slice();var a=e-n,u=[i[0],i[1].slice(0,a)],s=[i[0],i[1].slice(a)];return t.splice(r,1,u,s),[r+1,t]}n=o}}throw new Error("cursor_pos is out of bounds!")}function f(t,e){var n=l(t,e),r=n[1],i=n[0],o=r[i],a=r[i+1];if(null==o)return t;if(o[0]!==y)return t;if(null!=a&&o[1]+a[1]===a[1]+o[1])return r.splice(i,2,a,o),p(r,i,2);if(null!=a&&0===a[1].indexOf(o[1])){r.splice(i,2,[a[0],o[1]],[0,o[1]]);var u=a[1].slice(o[1].length);return u.length>0&&r.splice(i+2,0,[a[0],u]),p(r,i,3)}return t}function p(t,e,n){for(var r=e+n-1;r>=0&&r>=e-1;r--)if(r+1<t.length){var i=t[r],o=t[r+1];i[0]===o[1]&&t.splice(r,2,[i[0],i[1]+o[1]])}return t}var h=-1,d=1,y=0,m=n;m.INSERT=d,m.DELETE=h,m.EQUAL=y,t.exports=m},function(t,e,n){function r(t){return null===t||void 0===t}function i(t){return!(!t||"object"!=typeof t||"number"!=typeof t.length)&&("function"==typeof t.copy&&"function"==typeof t.slice&&!(t.length>0&&"number"!=typeof t[0]))}function o(t,e,n){var o,l;if(r(t)||r(e))return!1;if(t.prototype!==e.prototype)return!1;if(s(t))return!!s(e)&&(t=a.call(t),e=a.call(e),c(t,e,n));if(i(t)){if(!i(e))return!1;if(t.length!==e.length)return!1;for(o=0;o<t.length;o++)if(t[o]!==e[o])return!1;return!0}try{var f=u(t),p=u(e)}catch(t){return!1}if(f.length!=p.length)return!1;for(f.sort(),p.sort(),o=f.length-1;o>=0;o--)if(f[o]!=p[o])return!1;for(o=f.length-1;o>=0;o--)if(l=f[o],!c(t[l],e[l],n))return!1;return typeof t==typeof e}var a=Array.prototype.slice,u=n(23),s=n(24),c=t.exports=function(t,e,n){return n||(n={}),t===e||(t instanceof Date&&e instanceof Date?t.getTime()===e.getTime():!t||!e||"object"!=typeof t&&"object"!=typeof e?n.strict?t===e:t==e:o(t,e,n))}},function(t,e){function n(t){var e=[];for(var n in t)e.push(n);return e}e=t.exports="function"==typeof Object.keys?Object.keys:n,e.shim=n},function(t,e){function n(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function r(t){return t&&"object"==typeof t&&"number"==typeof t.length&&Object.prototype.hasOwnProperty.call(t,"callee")&&!Object.prototype.propertyIsEnumerable.call(t,"callee")||!1}var i="[object Arguments]"==function(){return Object.prototype.toString.call(arguments)}();e=t.exports=i?n:r,e.supported=n,e.unsupported=r},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn\'t been initialised - super() hasn\'t been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&u.return&&u.return()}finally{if(i)throw o}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},c=n(8),l=n(7),f=n(2),p=n(26),h=function(t){function e(t){var n,o;return r(this,e),o=n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),i(n,o)}return o(e,t),u(e,[{key:"freeze",value:function(){f.freeze(this.data),f.freeze(this.data.rows),f.freeze(this.data.cols)}},{key:"name",value:function(){return"TableOperator"}},{key:"getEmbedObject",value:function(){if("object"!=typeof this.data)throw new Error("data is not an embed object");return{table:this.data}}},{key:"skipDiff",value:function(){return!0}},{key:"_genericSet",value:function(t){var n=s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"_genericSet",this).call(this,t),r=n.changed,i=n.op;if("object"==typeof i.data){if(i.data.rows||(i.data.rows=new l),i.data.cols||(i.data.cols=new l),i.data.cells||(i.data.cells={}),"function"!=typeof i.data.cells.name&&(i.data.cells=new p({action:i.action,cells:i.data.cells})),"function"!=typeof i.data.rows.pack)throw new Error("rows should be a Delta");if("function"!=typeof i.data.cols.pack)throw new Error("cols should be a Delta");"retain"===i.action&&i.data.rows.isEmpty()&&i.data.cols.isEmpty()&&!Object.keys(i.data.cells).length&&(i.data=1)}if("insert"===i.action){if(!i.data.rows.isDocument())throw new Error("rows should be a document");if(!i.data.cols.isDocument())throw new Error("cols should be a document")}return{changed:r,op:i}}},{key:"pack",value:function(){var t=s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"pack",this).call(this);if("object"==typeof t[1]){var n=t[1],r=n.cells,i=n.rows,o=n.cols;if(t[1]=[r.pack()],i.isEmpty()&&o.isEmpty())return t;o.isEmpty()?t[1].push(i.pack()):(t[1].push(i.isEmpty()?0:i.pack()),t[1].push(o.pack()))}return t}},{key:"compose",value:function(t){var n=s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"compose",this).call(this,t);if("number"==typeof this.data||"number"==typeof t.data)return n;var r={rows:n.data.rows.compose(t.data.rows),cols:n.data.cols.compose(t.data.cols)},i=new p({cells:n.data.cells,action:n.action});return i.composeWithMutations(t.data),t.data.cells.forEach(function(e){var n=i.get(e),r=t.data.cells.get(e);i.set(e,n.compose(r))}),r.cells=i,n.set({data:r})}},{key:"invert",value:function(t){var n=this,r=s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"invert",this).call(this,t);if("number"==typeof this.data||"number"==typeof t.data)return r;var i={rows:this.data.rows.invert(t.data.rows),cols:this.data.cols.invert(t.data.cols)},o=new p({cells:t.data.cells,action:r.action});o.composeWithMutations(i,function(t,e){return n.data.cells.get(e).invert(t)});var a=t.data.rows.isEmpty(),u=t.data.cols.isEmpty();return a&&u||this.data.cells.forEach(function(e){var r=f.parsePosition(e),i=r.row,a=r.col;null!==t.data.rows.composePosition(i)&&null!==t.data.cols.composePosition(a)||o.set(e,n.data.cells.get(e))}),i.cells=o,r.set({data:i})}},{key:"transform",value:function(t,n){var r=this,i=s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"transform",this).call(this,t,n);if("number"==typeof this.data||"number"==typeof t.data)return i;var o={rows:i.data.rows.transform(this.data.rows,!n),cols:i.data.cols.transform(this.data.cols,!n)},a={rows:this.data.rows.transform(t.data.rows,n),cols:this.data.cols.transform(t.data.cols,n)},u=new p({cells:t.data.cells,action:i.action});u.composeWithMutations(o);var c=t.data.rows.isEmpty(),l=t.data.cols.isEmpty();return this.data.cells.forEach(function(t){var e=f.parsePosition(t),i=e.row,o=e.col;if(c||(i=a.rows.composePosition(i)),l||(o=a.cols.composePosition(o)),null!==i&&null!==o){var s=f.stringifyPosition(i,o);u.set(s,r.data.cells.get(t).transform(u.get(s),n))}}),a.cells=u,i.set({data:a})}}],[{key:"unpack",value:function(t){if(Array.isArray(t[1])){var n=a(t[1],3),r=n[0],i=n[1],o=n[2];t[1]={rows:i?l.unpack(i):null,cols:o?l.unpack(o):null,cells:r}}return s(e.__proto__||Object.getPrototypeOf(e),"unpack",this).call(this,t)}}]),e}(c);h.packId=3,t.exports=h},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(14),a=n(7),u=n(0),s=n(2),c=function(){function t(e){var n=e.cells,i=e.action;if(r(this,t),this.cells={},"function"==typeof n.name){this.proto=n.proto;for(var o in n.cells)n.cells.hasOwnProperty(o)&&(this.cells[o]=n.cells[o])}else this.proto=n;this.action=i}return i(t,[{key:"name",value:function(){return"CellManager"}},{key:"keys",value:function(){var t=[];return this.forEach(function(e){t.push(e)}),t}},{key:"get",value:function(t){var e=arguments.length<=1||void 0===arguments[1]||arguments[1],n=void 0;return n=void 0===this.cells[t]?this.proto[t]:this.cells[t],n?(e&&Array.isArray(n)&&(n=this.cells[t]=o.operatorUnpacker(n)),n.action&&n.action!==this.action&&(n=this.cells[t]=n.set({action:this.action}))):n=new o({action:this.action,data:"insert"===this.action?new a:1}),n}},{key:"forEach",value:function(t){var e=arguments.length<=1||void 0===arguments[1]||arguments[1];for(var n in this.cells)!this.cells.hasOwnProperty(n)||e&&null===this.cells[n]||t(n);for(var r in this.proto)this.proto.hasOwnProperty(r)&&!this.cells.hasOwnProperty(r)&&null!==this.proto[r]&&t(r)}},{key:"set",value:function(t,e){this.cells[t]=e||null}},{key:"composeWithMutations",value:function(t,e){var n=this,r=t.rows,i=t.cols,o=r.isEmpty(),a=i.isEmpty();if(!o||!a||e){var u={},c={row:{},col:{}};this.forEach(function(t){var l=s.parsePosition(t),f=l.row,p=l.col;if(o||(void 0===c.row[f]&&(c.row[f]=r.composePosition(f)),f=c.row[f]),a||(void 0===c.col[p]&&(c.col[p]=i.composePosition(p)),p=c.col[p]),u[t]||(u[t]=null),null!==f&&null!==p){var h=s.stringifyPosition(f,p),d=n.get(t);u[h]=e?e(d,h):d}},!1),this.cells=u}}},{key:"pack",value:function(){var t=this,e={};return this.forEach(function(n){var r=t.get(n,!1);Array.isArray(r)?e[n]=r:(r.attributes||r.data.isEmpty&&!r.data.isEmpty())&&(e[n]=r.pack())}),u.isEmpty(e)?0:e}}]),t}();t.exports=c},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn\'t been initialised - super() hasn\'t been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},s=n(8),c=function(t){function e(t){var n,o;return r(this,e),o=n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),i(n,o)}return o(e,t),a(e,[{key:"name",value:function(){return"TextOperator"}},{key:"getEmbedObject",value:function(){if("object"!=typeof this.data)throw new Error("data is not an embed object");return this.data}},{key:"setData",value:function(t){switch(u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),this.action){case"insert":if("string"!=typeof this.data&&"object"!=typeof this.data)throw new Error(\'data should be a string or an object for "insert" action, got \'+this.data);break;case"retain":if("number"!=typeof this.data)throw new Error(\'data should be a number for "\'+this.action+\'" action, got \'+this.data)}return this}}]),e}(s);c.packId=2,t.exports=c},function(t,e,n){(function(e){function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o(t,n,r){var i={},o=void 0,a=void 0,u=void 0,s=void 0,c=void 0,l=void 0,f=void 0,p=void 0,h=!1;return n.forEach(function(t){o=t[0],a=t[1],c=t[2],f=t[3],l=e.isNil(c.value)?"":c.value.toString(),u=e.isNil(f.value)?"":f.value.toString(),l===u&&e.isEmpty(f.attrs)||(s=(0,V.stringifyPosition)(o,a),i[s]=(0,K.value2Cs)(c,f,r))}),0===Object.keys(i).length?(h=!0,p=q()):p=R(i),[p,{sheetId:t},h]}function a(t,e,n,r){var i,o,a,u,s=q();return e?(e=JSON.parse(e),i=e.pos,u=i[2],o=i[0],a=o+u,r<0&&o>=n&&o<n+Math.abs(r)?N(t,{filter:null}):(n<=o?o+=r:n>o&&n<=a&&(u+=r),e.pos=[o,i[1],u,i[3]],N(t,{filter:JSON.stringify(e)}))):[s,{sheetId:t}]}function u(t,e,n,r){var i,o,a,u,s=q();return e?(e=JSON.parse(e),i=e.pos,u=i[3],o=i[1],a=o+u,n<=o?o+=r:n>o&&n<=a&&(u+=r),e.pos=[i[0],o,i[2],u],N(t,{filter:JSON.stringify(e)})):[s,{sheetId:t}]}function s(t,e,n){var r=e.oldRowLen,i=e.rowDiff,o=n.oldColLen,a=n.colDiff,u=i>0?z(r,i):null,s=a>0?z(o,a):null,c={};return u&&(c.rows=new V.Delta(u)),s&&(c.cols=new V.Delta(s)),[new V.TableOperator({action:"retain",data:c}),{sheetId:t}]}function c(t,e,n){return[H(z(e,n)),{sheetId:t}]}function l(t,e,n){return[L(z(e,n)),{sheetId:t}]}function f(t,e){return[H($(e)),{sheetId:t}]}function p(t,e){return[L($(e)),{sheetId:t}]}function h(t,e,n){return y(t,e,n,"row")}function d(t,e,n){return y(t,e,n,"col")}function y(t,n,r,i){var o={},a="object"===(void 0===r?"undefined":J(r)),u="row"===i?"height":"width",s="row"===i?H:L;return a?e.forEach(n,function(t){(o[t]={})[u]=r[t]}):o[u]=r,[s(W(n,o,i,a?"multi":null)),{sheetId:t}]}function m(t,n,r){var i={};e.forEach(r,function(t,e){var r=G(t,2),o=r[0],a=r[1],u=n[e][1]||0;(a=a||0)!==u&&(i[o]={autoFit:a})});var o=null;return e.isEmpty(i)||(o=H(B(i,"row"))),[o,{sheetId:t}]}function g(t,e,n){var r=e.row,i=e.col,o=e.rowCount,a=e.colCount,u=n.oldRowLen,c=n.oldColLen,l=r+o-u,f=i+a-c;return l<=0&&f<=0?[q(),{sheetId:t}]:s(t,{oldRowLen:u,rowDiff:l},{oldColLen:c,colDiff:f})}function v(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"row",i="row"===r?H:L,o=q();return e.isEmpty(n)||(o=i(B(n,r))),[o,{sheetId:t}]}function _(t,n){var r={};return e.forEach(n,function(t){var e=G(t,4),n=e[0],i=e[1],o=e[2],a=e[3],u=(0,V.stringifyPosition)(n,i);r[u]=M(o,a)}),[e.isEmpty(r)?q():R(r),{sheetId:t}]}function b(t,n){var r={};return e.forEach(n,function(t){var e=G(t,4),n=e[0],i=e[1],o=e[3],a=(0,V.stringifyPosition)(n,i);r[a]=(0,X.changeCellAttrs)(o.attrs)}),[e.isEmpty(r)?q():R(r),{sheetId:t}]}function M(t,e){var n=w(t,e);return(0,X.changeCellAttrs)(n)}function w(t,n){var r=t.attrs||{},i=(0,X.clearAttrs)(r);return e.assign(i,n.attrs)}function x(t){return new V.CellOperator({action:"retain",data:1,attributes:t})}function F(t,e,n,r,o,a){var u=r.url,s=r.text,c=r.tooltip,l={link:u,linkTooltip:c},f=(0,K.value2Cs)(o,{value:s,attrs:l},a);return[R(i({},(0,V.stringifyPosition)(e,n),f)),{sheetId:t}]}function S(t,n,r,i,o,a){function u(t,e,n){for(var r=G(t,4),a=r[0],u=r[1],s=r[2],c=r[3],l=a;l<=s;l++)for(var f=u;f<=c;f++){var p=Math.min(Math.max(l,0),i),h=Math.min(Math.max(f,0),o),d=(0,V.stringifyPosition)(p,h),y=n[d];y?y.push(e):n[d]=[e]}}var s={},c={},l=G(r,3),f=l[0],p=l[1],h=l[2],d="none"===f?null:JSON.stringify([p,+h]);return e.forEach(n,function(t){var n=Q.default.transformBorder(t,f);e.forIn(n,function(t,e){u(t,e,s)})}),e.forIn(s,function(t,n){var r={userID:a};e.forEach(t,function(t){r["border-"+t]=d}),c[n]=(0,X.changeCellAttrs)(r)}),[e.isEmpty(c)?q():R(c),{sheetId:t}]}function D(t,n,r){var i=["formula","format"],o={};return e.forEach(n,function(t){var n=G(t,3),a=n[0],u=n[1],s=n[2],c=(0,V.stringifyPosition)(a,u),l=s.attrs||{};if(e.forEach(i,function(t){delete l[t]}),Object.keys(l).length){var f=(0,X.clearAttrs)(l);f.userID=r,o[c]=(0,X.changeCellAttrs)(f)}}),[e.isEmpty(o)?q():R(o),{sheetId:t}]}function k(t,n){var r={};return e.forIn(n,function(t,e){r[e]=t&&JSON.stringify(t)}),N(t,r)}function E(t,n,r){var i={};return e.forEach(n,function(t){var e=t.row,n=t.col,o=t.rowCount,a=t.colCount,u=(0,V.stringifyPosition)(e,n);i[u]=(0,X.changeCellAttrs)({rowspan:o,colspan:a,userID:r})}),[e.isEmpty(i)?q():R(i),{sheetId:t}]}function C(t,n,r,i){function a(t){return!t&&0!==t}var u=r.row,s=r.col,c=r.rowCount,l=r.colCount,f=[],p={},h=n[0][2].attrs,d=void 0;return e.forIn(h,function(t,e){-1===["rowspan","colspan","formula"].indexOf(e)&&(p[e]=t)}),n.forEach(function(t){var n=G(t,3),r=n[0],i=n[1],o=n[2],h=o.value,y=o.attrs;if(r===u&&i===s)f.push([r,i,o,{value:h,attrs:(0,tt.assign)(y,{rowspan:c,colspan:l})}]),d=h;else{var m=e.assign((0,X.clearAttrs)(y||{}),p);f.push([r,i,o,{value:"",attrs:m}]),a(d)&&!a(h)&&(d=h,f[0][3].value=h)}}),o(t,f,i)}function T(t,e,n){return b(t,[[e.row,e.col,{},{attrs:{rowspan:null,colspan:null,userID:n}}]])}function N(t,e){return[new V.TableOperator({action:"retain",data:1,attributes:e}),{sheetId:t}]}function O(t,e,n,r){var i=e.row,o=e.col,a=e.rowCount,u=e.colCount,s=i<0?1:i+1,c=a>1?a-1:n-s,l=[s,o,c,u];1===a&&1===u?l=[1,0,n-1,r]:-1===o&&(l=[s,0,c,r]);var f={pos:l,rules:{}};return N(t,{filter:JSON.stringify(f)})}function A(t,e){var n=void 0;return e&&e.filter?(n=JSON.parse(e.filter),n.rules={},N(t,{filter:JSON.stringify(n)})):[null,{sheetId:t}]}function j(t,e,n,r,i){e=JSON.parse(e);var o=e.rules[n];return o||(o={}),o[r]=i,e.rules[n]=o,N(t,{filter:JSON.stringify(e)})}function P(t){return N(t,{filter:null})}function I(t,e,n,r,i,a){var u=-1===r,s=-1===n,c=void 0;u?c=v(t,i,"row"):s&&(c=v(t,i,"col"));var l=o(t,e,a),f=G(l,1),p=f[0],h=p;return c&&(h=p.compose(c[0])),[h,{sheetId:t}]}function H(t){return new V.TableOperator({action:"retain",data:{rows:new V.Delta(t)}})}function L(t){return new V.TableOperator({action:"retain",data:{cols:new V.Delta(t)}})}function R(t){return new V.TableOperator({action:"retain",data:{cells:t}})}function $(t){var n=[],r=0,i=void 0;return t=t.map(function(t){return t+1}),e.forEach(t,function(t){i=t-r,i>1&&n.push(new V.Operator({action:"retain",data:i-1})),n.push(new V.Operator({action:"remove",data:1})),r=t}),n}function z(t,e){var n=[];return t>0&&n.push(new V.Operator({action:"retain",data:t})),n.push(new V.Operator({action:"insert",data:e})),n}function W(t,n,r,i){var o=[],a=0,u=void 0,s=void 0;return t=t.sort(function(t,e){return t-e}).map(function(t){return+t+1}),e.forEach(t,function(t){s="multi"===i?n[t-1]:n,u=t-a,u>1&&o.push(new V.Operator({action:"retain",data:u-1})),o.push(new V.Operator({action:"retain",data:1,attributes:s})),a=t}),o}function B(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"row";return W(Object.keys(t),t,e,"multi")}function q(){return new V.TableOperator({action:"retain",data:{}})}function U(t,e,n,r,i,s,f,p,y,m,g,v,b){var M="row"===e,w=M?h:d,x=w(t,n,r),F=G(x,1),S=F[0],D=new V.TableOperator({action:"retain",data:1,attributes:i}),C=k(t,s),T=G(C,1),N=T[0],O=M?c:l,A=O(t,f,p),j=G(A,1),P=j[0],I=E(t,y,b),H=G(I,1),L=H[0],R=_(t,m),$=G(R,1),z=$[0];S=S.compose(z);var W=void 0,B=o(t,g,b),q=G(B,1),U=q[0];return W=M?a(t,v,f,p)[0]:u(t,v,f,p)[0],[P.compose(S).compose(L).compose(U).compose(W).compose(N).compose(D),{sheetId:t}]}function Y(t,e,n,r,i,a,u,s,c){var l="row"===e,h=new V.TableOperator({action:"retain",data:1,attributes:n}),d=E(t,r,c),y=G(d,1),m=y[0],g=l?f:p,v=g(t,i),_=G(v,1),b=_[0],M=b.compose(m),w=k(t,a),x=G(w,1),F=x[0],S=E(t,u,c),D=G(S,1),C=D[0],T=o(t,s,c),N=G(T,1),O=N[0];return[M.compose(C).compose(O).compose(F).compose(h),{sheetId:t}]}var G=function(){function t(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&u.return&&u.return()}finally{if(i)throw o}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},V=n(1),K=n(15),X=n(16),Z=n(43),Q=r(Z),tt=n(0);t.exports={editCell2Changeset:o,addRowOrCol2Changeset:s,addRow2Changeset:c,addCol2Changeset:l,removeRow2Changeset:f,removeCol2Changeset:p,rowResize2Changeset:h,colResize2Changeset:d,insertRowOrCol2Cs:U,deleteRowOrCol2Cs:Y,autoFit2Changeset:m,autoCreateRowOrCol2Cs:g,rowOrColAttrsToCs:v,link2Cs:F,border2Cs:S,clearFormat2Cs:D,alterMultiMergeCells:E,mergeCells2Cs:C,unmergeCells2Cs:T,overrideCellsAttrs2Cs:_,conditionalFormats2Cs:k,cellAttrs2Changeset:b,genCsByCellAttrs:x,genFilterCsAfterInsertRow:a,genFilterCsAfterInsertCol:u,tableAttrs2Cs:N,newFilter2Cs:O,clearFilter2Cs:A,deleteFilter2Cs:P,updateRangeFilters2Cs:j,dragDropBlock2Cs:I}}).call(e,n(0))},function(t,e,n){(function(e,r){function i(t){return/<[a-z][\\s\\S]*>/i.test(t)}function o(t){return!e.isNil(t)&&e.startsWith(t.toString(),"http")}function a(t){var e,n;return e=l.trim(t),o(e)?\'<a href="\'+(0!==e.indexOf("http")?"http://"+e:e)+\'" target="_blank">\'+e+"</a>":h.test(e)?a(u(e)):p.test(e)?(n=e.match(p)[1],t.replace(p,n)):t}function u(t){return t.match(h)[1]}function s(t){return t&&3!==t.nodeType?t.tagName.toLowerCase():""}function c(t){var e,n="string";return i(t)?(e=document.createElement("div"),e.innerHTML=t,r(e).find("img").length>0&&(n="image")):(f(t)||t.toString().search(/^\\$?\\d+(,\\d{3})*(\\.\\d*)?$/)>=0)&&(n="number"),n}var l=n(31),f=n(12).isNumeric,p=/<a [^>]+>([^<]+)<\\/a>/,h=/^<a [^>]+>([^<]+)<\\/a>$/;t.exports={getTagName:s,getHtmlTextType:c,isHtml:i,isUrl:o,urlify:a}}).call(e,n(0),n(30))},function(t,e,n){var r,i;!function(e,n){"object"==typeof t&&"object"==typeof t.exports?t.exports=e.document?n(e,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return n(t)}:n(e)}("undefined"!=typeof window?window:this,function(n,o){function a(t){var e=!!t&&"length"in t&&t.length,n=ct.type(t);return"function"!==n&&!ct.isWindow(t)&&("array"===n||0===e||"number"==typeof e&&e>0&&e-1 in t)}function u(t,e,n){if(ct.isFunction(e))return ct.grep(t,function(t,r){return!!e.call(t,r,t)!==n});if(e.nodeType)return ct.grep(t,function(t){return t===e!==n});if("string"==typeof e){if(_t.test(e))return ct.filter(e,t,n);e=ct.filter(e,t)}return ct.grep(t,function(t){return rt.call(e,t)>-1!==n})}function s(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}function c(t){var e={};return ct.each(t.match(Ft)||[],function(t,n){e[n]=!0}),e}function l(){Q.removeEventListener("DOMContentLoaded",l),n.removeEventListener("load",l),ct.ready()}function f(){this.expando=ct.expando+f.uid++}function p(t,e,n){var r;if(void 0===n&&1===t.nodeType)if(r="data-"+e.replace(Nt,"-$&").toLowerCase(),"string"==typeof(n=t.getAttribute(r))){try{n="true"===n||"false"!==n&&("null"===n?null:+n+""===n?+n:Tt.test(n)?ct.parseJSON(n):n)}catch(t){}Ct.set(t,e,n)}else n=void 0;return n}function h(t,e,n,r){var i,o=1,a=20,u=r?function(){return r.cur()}:function(){return ct.css(t,e,"")},s=u(),c=n&&n[3]||(ct.cssNumber[e]?"":"px"),l=(ct.cssNumber[e]||"px"!==c&&+s)&&At.exec(ct.css(t,e));if(l&&l[3]!==c){c=c||l[3],n=n||[],l=+s||1;do{o=o||".5",l/=o,ct.style(t,e,l+c)}while(o!==(o=u()/s)&&1!==o&&--a)}return n&&(l=+l||+s||0,i=n[1]?l+(n[1]+1)*n[2]:+n[2],r&&(r.unit=c,r.start=l,r.end=i)),i}function d(t,e){var n=void 0!==t.getElementsByTagName?t.getElementsByTagName(e||"*"):void 0!==t.querySelectorAll?t.querySelectorAll(e||"*"):[];return void 0===e||e&&ct.nodeName(t,e)?ct.merge([t],n):n}function y(t,e){for(var n=0,r=t.length;n<r;n++)Et.set(t[n],"globalEval",!e||Et.get(e[n],"globalEval"))}function m(t,e,n,r,i){for(var o,a,u,s,c,l,f=e.createDocumentFragment(),p=[],h=0,m=t.length;h<m;h++)if((o=t[h])||0===o)if("object"===ct.type(o))ct.merge(p,o.nodeType?[o]:o);else if($t.test(o)){for(a=a||f.appendChild(e.createElement("div")),u=(Ht.exec(o)||["",""])[1].toLowerCase(),s=Rt[u]||Rt._default,a.innerHTML=s[1]+ct.htmlPrefilter(o)+s[2],l=s[0];l--;)a=a.lastChild;ct.merge(p,a.childNodes),a=f.firstChild,a.textContent=""}else p.push(e.createTextNode(o));for(f.textContent="",h=0;o=p[h++];)if(r&&ct.inArray(o,r)>-1)i&&i.push(o);else if(c=ct.contains(o.ownerDocument,o),a=d(f.appendChild(o),"script"),c&&y(a),n)for(l=0;o=a[l++];)Lt.test(o.type||"")&&n.push(o);return f}function g(){return!0}function v(){return!1}function _(){try{return Q.activeElement}catch(t){}}function b(t,e,n,r,i,o){var a,u;if("object"==typeof e){"string"!=typeof n&&(r=r||n,n=void 0);for(u in e)b(t,u,n,r,e[u],o);return t}if(null==r&&null==i?(i=n,r=n=void 0):null==i&&("string"==typeof n?(i=r,r=void 0):(i=r,r=n,n=void 0)),!1===i)i=v;else if(!i)return t;return 1===o&&(a=i,i=function(t){return ct().off(t),a.apply(this,arguments)},i.guid=a.guid||(a.guid=ct.guid++)),t.each(function(){ct.event.add(this,e,i,r,n)})}function M(t,e){return ct.nodeName(t,"table")&&ct.nodeName(11!==e.nodeType?e:e.firstChild,"tr")?t.getElementsByTagName("tbody")[0]||t.appendChild(t.ownerDocument.createElement("tbody")):t}function w(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function x(t){var e=Gt.exec(t.type);return e?t.type=e[1]:t.removeAttribute("type"),t}function F(t,e){var n,r,i,o,a,u,s,c;if(1===e.nodeType){if(Et.hasData(t)&&(o=Et.access(t),a=Et.set(e,o),c=o.events)){delete a.handle,a.events={};for(i in c)for(n=0,r=c[i].length;n<r;n++)ct.event.add(e,i,c[i][n])}Ct.hasData(t)&&(u=Ct.access(t),s=ct.extend({},u),Ct.set(e,s))}}function S(t,e){var n=e.nodeName.toLowerCase();"input"===n&&It.test(t.type)?e.checked=t.checked:"input"!==n&&"textarea"!==n||(e.defaultValue=t.defaultValue)}function D(t,e,n,r){e=et.apply([],e);var i,o,a,u,s,c,l=0,f=t.length,p=f-1,h=e[0],y=ct.isFunction(h);if(y||f>1&&"string"==typeof h&&!ut.checkClone&&Yt.test(h))return t.each(function(i){var o=t.eq(i);y&&(e[0]=h.call(this,i,o.html())),D(o,e,n,r)});if(f&&(i=m(e,t[0].ownerDocument,!1,t,r),o=i.firstChild,1===i.childNodes.length&&(i=o),o||r)){for(a=ct.map(d(i,"script"),w),u=a.length;l<f;l++)s=i,l!==p&&(s=ct.clone(s,!0,!0),u&&ct.merge(a,d(s,"script"))),n.call(t[l],s,l);if(u)for(c=a[a.length-1].ownerDocument,ct.map(a,x),l=0;l<u;l++)s=a[l],Lt.test(s.type||"")&&!Et.access(s,"globalEval")&&ct.contains(c,s)&&(s.src?ct._evalUrl&&ct._evalUrl(s.src):ct.globalEval(s.textContent.replace(Jt,"")))}return t}function k(t,e,n){for(var r,i=e?ct.filter(e,t):t,o=0;null!=(r=i[o]);o++)n||1!==r.nodeType||ct.cleanData(d(r)),r.parentNode&&(n&&ct.contains(r.ownerDocument,r)&&y(d(r,"script")),r.parentNode.removeChild(r));return t}function E(t,e){var n=ct(e.createElement(t)).appendTo(e.body),r=ct.css(n[0],"display");return n.detach(),r}function C(t){var e=Q,n=Kt[t];return n||(n=E(t,e),"none"!==n&&n||(Vt=(Vt||ct("<iframe frameborder=\'0\' width=\'0\' height=\'0\'/>")).appendTo(e.documentElement),e=Vt[0].contentDocument,e.write(),e.close(),n=E(t,e),Vt.detach()),Kt[t]=n),n}function T(t,e,n){var r,i,o,a,u=t.style;return n=n||Qt(t),a=n?n.getPropertyValue(e)||n[e]:void 0,""!==a&&void 0!==a||ct.contains(t.ownerDocument,t)||(a=ct.style(t,e)),n&&!ut.pixelMarginRight()&&Zt.test(a)&&Xt.test(e)&&(r=u.width,i=u.minWidth,o=u.maxWidth,u.minWidth=u.maxWidth=u.width=a,a=n.width,u.width=r,u.minWidth=i,u.maxWidth=o),void 0!==a?a+"":a}function N(t,e){return{get:function(){return t()?void delete this.get:(this.get=e).apply(this,arguments)}}}function O(t){if(t in ae)return t;for(var e=t[0].toUpperCase()+t.slice(1),n=oe.length;n--;)if((t=oe[n]+e)in ae)return t}function A(t,e,n){var r=At.exec(e);return r?Math.max(0,r[2]-(n||0))+(r[3]||"px"):e}function j(t,e,n,r,i){for(var o=n===(r?"border":"content")?4:"width"===e?1:0,a=0;o<4;o+=2)"margin"===n&&(a+=ct.css(t,n+jt[o],!0,i)),r?("content"===n&&(a-=ct.css(t,"padding"+jt[o],!0,i)),"margin"!==n&&(a-=ct.css(t,"border"+jt[o]+"Width",!0,i))):(a+=ct.css(t,"padding"+jt[o],!0,i),"padding"!==n&&(a+=ct.css(t,"border"+jt[o]+"Width",!0,i)));return a}function P(t,e,n){var r=!0,i="width"===e?t.offsetWidth:t.offsetHeight,o=Qt(t),a="border-box"===ct.css(t,"boxSizing",!1,o);if(i<=0||null==i){if(i=T(t,e,o),(i<0||null==i)&&(i=t.style[e]),Zt.test(i))return i;r=a&&(ut.boxSizingReliable()||i===t.style[e]),i=parseFloat(i)||0}return i+j(t,e,n||(a?"border":"content"),r,o)+"px"}function I(t,e){for(var n,r,i,o=[],a=0,u=t.length;a<u;a++)r=t[a],r.style&&(o[a]=Et.get(r,"olddisplay"),n=r.style.display,e?(o[a]||"none"!==n||(r.style.display=""),""===r.style.display&&Pt(r)&&(o[a]=Et.access(r,"olddisplay",C(r.nodeName)))):(i=Pt(r),"none"===n&&i||Et.set(r,"olddisplay",i?n:ct.css(r,"display"))));for(a=0;a<u;a++)r=t[a],r.style&&(e&&"none"!==r.style.display&&""!==r.style.display||(r.style.display=e?o[a]||"":"none"));return t}function H(t,e,n,r,i){return new H.prototype.init(t,e,n,r,i)}function L(){return n.setTimeout(function(){ue=void 0}),ue=ct.now()}function R(t,e){var n,r=0,i={height:t};for(e=e?1:0;r<4;r+=2-e)n=jt[r],i["margin"+n]=i["padding"+n]=t;return e&&(i.opacity=i.width=t),i}function $(t,e,n){for(var r,i=(B.tweeners[e]||[]).concat(B.tweeners["*"]),o=0,a=i.length;o<a;o++)if(r=i[o].call(n,e,t))return r}function z(t,e,n){var r,i,o,a,u,s,c,l=this,f={},p=t.style,h=t.nodeType&&Pt(t),d=Et.get(t,"fxshow");n.queue||(u=ct._queueHooks(t,"fx"),null==u.unqueued&&(u.unqueued=0,s=u.empty.fire,u.empty.fire=function(){u.unqueued||s()}),u.unqueued++,l.always(function(){l.always(function(){u.unqueued--,ct.queue(t,"fx").length||u.empty.fire()})})),1===t.nodeType&&("height"in e||"width"in e)&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],c=ct.css(t,"display"),"inline"===("none"===c?Et.get(t,"olddisplay")||C(t.nodeName):c)&&"none"===ct.css(t,"float")&&(p.display="inline-block")),n.overflow&&(p.overflow="hidden",l.always(function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]}));for(r in e)if(i=e[r],ce.exec(i)){if(delete e[r],o=o||"toggle"===i,i===(h?"hide":"show")){if("show"!==i||!d||void 0===d[r])continue;h=!0}f[r]=d&&d[r]||ct.style(t,r)}else c=void 0;if(ct.isEmptyObject(f))"inline"===("none"===c?C(t.nodeName):c)&&(p.display=c);else{d?"hidden"in d&&(h=d.hidden):d=Et.access(t,"fxshow",{}),o&&(d.hidden=!h),h?ct(t).show():l.done(function(){ct(t).hide()}),l.done(function(){var e;Et.remove(t,"fxshow");for(e in f)ct.style(t,e,f[e])});for(r in f)a=$(h?d[r]:0,r,l),r in d||(d[r]=a.start,h&&(a.end=a.start,a.start="width"===r||"height"===r?1:0))}}function W(t,e){var n,r,i,o,a;for(n in t)if(r=ct.camelCase(n),i=e[r],o=t[n],ct.isArray(o)&&(i=o[1],o=t[n]=o[0]),n!==r&&(t[r]=o,delete t[n]),(a=ct.cssHooks[r])&&"expand"in a){o=a.expand(o),delete t[r];for(n in o)n in t||(t[n]=o[n],e[n]=i)}else e[r]=i}function B(t,e,n){var r,i,o=0,a=B.prefilters.length,u=ct.Deferred().always(function(){delete s.elem}),s=function(){if(i)return!1;for(var e=ue||L(),n=Math.max(0,c.startTime+c.duration-e),r=n/c.duration||0,o=1-r,a=0,s=c.tweens.length;a<s;a++)c.tweens[a].run(o);return u.notifyWith(t,[c,o,n]),o<1&&s?n:(u.resolveWith(t,[c]),!1)},c=u.promise({elem:t,props:ct.extend({},e),opts:ct.extend(!0,{specialEasing:{},easing:ct.easing._default},n),originalProperties:e,originalOptions:n,startTime:ue||L(),duration:n.duration,tweens:[],createTween:function(e,n){var r=ct.Tween(t,c.opts,e,n,c.opts.specialEasing[e]||c.opts.easing);return c.tweens.push(r),r},stop:function(e){var n=0,r=e?c.tweens.length:0;if(i)return this;for(i=!0;n<r;n++)c.tweens[n].run(1);return e?(u.notifyWith(t,[c,1,0]),u.resolveWith(t,[c,e])):u.rejectWith(t,[c,e]),this}}),l=c.props;for(W(l,c.opts.specialEasing);o<a;o++)if(r=B.prefilters[o].call(c,t,l,c.opts))return ct.isFunction(r.stop)&&(ct._queueHooks(c.elem,c.opts.queue).stop=ct.proxy(r.stop,r)),r;return ct.map(l,$,c),ct.isFunction(c.opts.start)&&c.opts.start.call(t,c),ct.fx.timer(ct.extend(s,{elem:t,anim:c,queue:c.opts.queue})),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}function q(t){return t.getAttribute&&t.getAttribute("class")||""}function U(t){return function(e,n){"string"!=typeof e&&(n=e,e="*");var r,i=0,o=e.toLowerCase().match(Ft)||[];if(ct.isFunction(n))for(;r=o[i++];)"+"===r[0]?(r=r.slice(1)||"*",(t[r]=t[r]||[]).unshift(n)):(t[r]=t[r]||[]).push(n)}}function Y(t,e,n,r){function i(u){var s;return o[u]=!0,ct.each(t[u]||[],function(t,u){var c=u(e,n,r);return"string"!=typeof c||a||o[c]?a?!(s=c):void 0:(e.dataTypes.unshift(c),i(c),!1)}),s}var o={},a=t===Ce;return i(e.dataTypes[0])||!o["*"]&&i("*")}function G(t,e){var n,r,i=ct.ajaxSettings.flatOptions||{};for(n in e)void 0!==e[n]&&((i[n]?t:r||(r={}))[n]=e[n]);return r&&ct.extend(!0,t,r),t}function J(t,e,n){for(var r,i,o,a,u=t.contents,s=t.dataTypes;"*"===s[0];)s.shift(),void 0===r&&(r=t.mimeType||e.getResponseHeader("Content-Type"));if(r)for(i in u)if(u[i]&&u[i].test(r)){s.unshift(i);break}if(s[0]in n)o=s[0];else{for(i in n){if(!s[0]||t.converters[i+" "+s[0]]){o=i;break}a||(a=i)}o=o||a}if(o)return o!==s[0]&&s.unshift(o),n[o]}function V(t,e,n,r){var i,o,a,u,s,c={},l=t.dataTypes.slice();if(l[1])for(a in t.converters)c[a.toLowerCase()]=t.converters[a];for(o=l.shift();o;)if(t.responseFields[o]&&(n[t.responseFields[o]]=e),!s&&r&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),s=o,o=l.shift())if("*"===o)o=s;else if("*"!==s&&s!==o){if(!(a=c[s+" "+o]||c["* "+o]))for(i in c)if(u=i.split(" "),u[1]===o&&(a=c[s+" "+u[0]]||c["* "+u[0]])){!0===a?a=c[i]:!0!==c[i]&&(o=u[0],l.unshift(u[1]));break}if(!0!==a)if(a&&t.throws)e=a(e);else try{e=a(e)}catch(t){return{state:"parsererror",error:a?t:"No conversion from "+s+" to "+o}}}return{state:"success",data:e}}function K(t,e,n,r){var i;if(ct.isArray(e))ct.each(e,function(e,i){n||Ae.test(t)?r(t,i):K(t+"["+("object"==typeof i&&null!=i?e:"")+"]",i,n,r)});else if(n||"object"!==ct.type(e))r(t,e);else for(i in e)K(t+"["+i+"]",e[i],n,r)}function X(t){return ct.isWindow(t)?t:9===t.nodeType&&t.defaultView}var Z=[],Q=n.document,tt=Z.slice,et=Z.concat,nt=Z.push,rt=Z.indexOf,it={},ot=it.toString,at=it.hasOwnProperty,ut={},st="2.2.4",ct=function(t,e){return new ct.fn.init(t,e)},lt=/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g,ft=/^-ms-/,pt=/-([\\da-z])/gi,ht=function(t,e){return e.toUpperCase()};ct.fn=ct.prototype={jquery:st,constructor:ct,selector:"",length:0,toArray:function(){return tt.call(this)},get:function(t){return null!=t?t<0?this[t+this.length]:this[t]:tt.call(this)},pushStack:function(t){var e=ct.merge(this.constructor(),t);return e.prevObject=this,e.context=this.context,e},each:function(t){return ct.each(this,t)},map:function(t){return this.pushStack(ct.map(this,function(e,n){return t.call(e,n,e)}))},slice:function(){return this.pushStack(tt.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,n=+t+(t<0?e:0);return this.pushStack(n>=0&&n<e?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:nt,sort:Z.sort,splice:Z.splice},ct.extend=ct.fn.extend=function(){var t,e,n,r,i,o,a=arguments[0]||{},u=1,s=arguments.length,c=!1;for("boolean"==typeof a&&(c=a,a=arguments[u]||{},u++),"object"==typeof a||ct.isFunction(a)||(a={}),u===s&&(a=this,u--);u<s;u++)if(null!=(t=arguments[u]))for(e in t)n=a[e],r=t[e],a!==r&&(c&&r&&(ct.isPlainObject(r)||(i=ct.isArray(r)))?(i?(i=!1,o=n&&ct.isArray(n)?n:[]):o=n&&ct.isPlainObject(n)?n:{},a[e]=ct.extend(c,o,r)):void 0!==r&&(a[e]=r));return a},ct.extend({expando:"jQuery"+(st+Math.random()).replace(/\\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isFunction:function(t){return"function"===ct.type(t)},isArray:Array.isArray,isWindow:function(t){return null!=t&&t===t.window},isNumeric:function(t){var e=t&&t.toString();return!ct.isArray(t)&&e-parseFloat(e)+1>=0},isPlainObject:function(t){var e;if("object"!==ct.type(t)||t.nodeType||ct.isWindow(t))return!1;if(t.constructor&&!at.call(t,"constructor")&&!at.call(t.constructor.prototype||{},"isPrototypeOf"))return!1;for(e in t);return void 0===e||at.call(t,e)},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},type:function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?it[ot.call(t)]||"object":typeof t},globalEval:function(t){var e,n=eval;(t=ct.trim(t))&&(1===t.indexOf("use strict")?(e=Q.createElement("script"),e.text=t,Q.head.appendChild(e).parentNode.removeChild(e)):n(t))},camelCase:function(t){return t.replace(ft,"ms-").replace(pt,ht)},nodeName:function(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()},each:function(t,e){var n,r=0;if(a(t))for(n=t.length;r<n&&!1!==e.call(t[r],r,t[r]);r++);else for(r in t)if(!1===e.call(t[r],r,t[r]))break;return t},trim:function(t){return null==t?"":(t+"").replace(lt,"")},makeArray:function(t,e){var n=e||[];return null!=t&&(a(Object(t))?ct.merge(n,"string"==typeof t?[t]:t):nt.call(n,t)),n},inArray:function(t,e,n){return null==e?-1:rt.call(e,t,n)},merge:function(t,e){for(var n=+e.length,r=0,i=t.length;r<n;r++)t[i++]=e[r];return t.length=i,t},grep:function(t,e,n){for(var r=[],i=0,o=t.length,a=!n;i<o;i++)!e(t[i],i)!==a&&r.push(t[i]);return r},map:function(t,e,n){var r,i,o=0,u=[];if(a(t))for(r=t.length;o<r;o++)null!=(i=e(t[o],o,n))&&u.push(i);else for(o in t)null!=(i=e(t[o],o,n))&&u.push(i);return et.apply([],u)},guid:1,proxy:function(t,e){var n,r,i;if("string"==typeof e&&(n=t[e],e=t,t=n),ct.isFunction(t))return r=tt.call(arguments,2),i=function(){return t.apply(e||this,r.concat(tt.call(arguments)))},i.guid=t.guid=t.guid||ct.guid++,i},now:Date.now,support:ut}),"function"==typeof Symbol&&(ct.fn[Symbol.iterator]=Z[Symbol.iterator]),ct.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(t,e){it["[object "+e+"]"]=e.toLowerCase()});var dt=function(t){function e(t,e,n,r){var i,o,a,u,s,c,f,h,d=e&&e.ownerDocument,y=e?e.nodeType:9;if(n=n||[],"string"!=typeof t||!t||1!==y&&9!==y&&11!==y)return n;if(!r&&((e?e.ownerDocument||e:$)!==O&&N(e),e=e||O,j)){if(11!==y&&(c=gt.exec(t)))if(i=c[1]){if(9===y){if(!(a=e.getElementById(i)))return n;if(a.id===i)return n.push(a),n}else if(d&&(a=d.getElementById(i))&&L(e,a)&&a.id===i)return n.push(a),n}else{if(c[2])return Z.apply(n,e.getElementsByTagName(t)),n;if((i=c[3])&&M.getElementsByClassName&&e.getElementsByClassName)return Z.apply(n,e.getElementsByClassName(i)),n}if(M.qsa&&!U[t+" "]&&(!P||!P.test(t))){if(1!==y)d=e,h=t;else if("object"!==e.nodeName.toLowerCase()){for((u=e.getAttribute("id"))?u=u.replace(_t,"\\\\$&"):e.setAttribute("id",u=R),f=S(t),o=f.length,s=pt.test(u)?"#"+u:"[id=\'"+u+"\']";o--;)f[o]=s+" "+p(f[o]);h=f.join(","),d=vt.test(t)&&l(e.parentNode)||e}if(h)try{return Z.apply(n,d.querySelectorAll(h)),n}catch(t){}finally{u===R&&e.removeAttribute("id")}}}return k(t.replace(ut,"$1"),e,n,r)}function n(){function t(n,r){return e.push(n+" ")>w.cacheLength&&delete t[e.shift()],t[n+" "]=r}var e=[];return t}function r(t){return t[R]=!0,t}function i(t){var e=O.createElement("div");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function o(t,e){for(var n=t.split("|"),r=n.length;r--;)w.attrHandle[n[r]]=e}function a(t,e){var n=e&&t,r=n&&1===t.nodeType&&1===e.nodeType&&(~e.sourceIndex||G)-(~t.sourceIndex||G);if(r)return r;if(n)for(;n=n.nextSibling;)if(n===e)return-1;return t?1:-1}function u(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function s(t){return function(e){var n=e.nodeName.toLowerCase();return("input"===n||"button"===n)&&e.type===t}}function c(t){return r(function(e){return e=+e,r(function(n,r){for(var i,o=t([],n.length,e),a=o.length;a--;)n[i=o[a]]&&(n[i]=!(r[i]=n[i]))})})}function l(t){return t&&void 0!==t.getElementsByTagName&&t}function f(){}function p(t){for(var e=0,n=t.length,r="";e<n;e++)r+=t[e].value;return r}function h(t,e,n){var r=e.dir,i=n&&"parentNode"===r,o=W++;return e.first?function(e,n,o){for(;e=e[r];)if(1===e.nodeType||i)return t(e,n,o)}:function(e,n,a){var u,s,c,l=[z,o];if(a){for(;e=e[r];)if((1===e.nodeType||i)&&t(e,n,a))return!0}else for(;e=e[r];)if(1===e.nodeType||i){if(c=e[R]||(e[R]={}),s=c[e.uniqueID]||(c[e.uniqueID]={}),(u=s[r])&&u[0]===z&&u[1]===o)return l[2]=u[2];if(s[r]=l,l[2]=t(e,n,a))return!0}}}function d(t){return t.length>1?function(e,n,r){for(var i=t.length;i--;)if(!t[i](e,n,r))return!1;return!0}:t[0]}function y(t,n,r){for(var i=0,o=n.length;i<o;i++)e(t,n[i],r);return r}function m(t,e,n,r,i){for(var o,a=[],u=0,s=t.length,c=null!=e;u<s;u++)(o=t[u])&&(n&&!n(o,r,i)||(a.push(o),c&&e.push(u)));return a}function g(t,e,n,i,o,a){return i&&!i[R]&&(i=g(i)),o&&!o[R]&&(o=g(o,a)),r(function(r,a,u,s){var c,l,f,p=[],h=[],d=a.length,g=r||y(e||"*",u.nodeType?[u]:u,[]),v=!t||!r&&e?g:m(g,p,t,u,s),_=n?o||(r?t:d||i)?[]:a:v;if(n&&n(v,_,u,s),i)for(c=m(_,h),i(c,[],u,s),l=c.length;l--;)(f=c[l])&&(_[h[l]]=!(v[h[l]]=f));if(r){if(o||t){if(o){for(c=[],l=_.length;l--;)(f=_[l])&&c.push(v[l]=f);o(null,_=[],c,s)}for(l=_.length;l--;)(f=_[l])&&(c=o?tt(r,f):p[l])>-1&&(r[c]=!(a[c]=f))}}else _=m(_===a?_.splice(d,_.length):_),o?o(null,a,_,s):Z.apply(a,_)})}function v(t){for(var e,n,r,i=t.length,o=w.relative[t[0].type],a=o||w.relative[" "],u=o?1:0,s=h(function(t){return t===e},a,!0),c=h(function(t){return tt(e,t)>-1},a,!0),l=[function(t,n,r){var i=!o&&(r||n!==E)||((e=n).nodeType?s(t,n,r):c(t,n,r));return e=null,i}];u<i;u++)if(n=w.relative[t[u].type])l=[h(d(l),n)];else{if(n=w.filter[t[u].type].apply(null,t[u].matches),n[R]){for(r=++u;r<i&&!w.relative[t[r].type];r++);return g(u>1&&d(l),u>1&&p(t.slice(0,u-1).concat({value:" "===t[u-2].type?"*":""})).replace(ut,"$1"),n,u<r&&v(t.slice(u,r)),r<i&&v(t=t.slice(r)),r<i&&p(t))}l.push(n)}return d(l)}function _(t,n){var i=n.length>0,o=t.length>0,a=function(r,a,u,s,c){var l,f,p,h=0,d="0",y=r&&[],g=[],v=E,_=r||o&&w.find.TAG("*",c),b=z+=null==v?1:Math.random()||.1,M=_.length;for(c&&(E=a===O||a||c);d!==M&&null!=(l=_[d]);d++){if(o&&l){for(f=0,a||l.ownerDocument===O||(N(l),u=!j);p=t[f++];)if(p(l,a||O,u)){s.push(l);break}c&&(z=b)}i&&((l=!p&&l)&&h--,r&&y.push(l))}if(h+=d,i&&d!==h){for(f=0;p=n[f++];)p(y,g,a,u);if(r){if(h>0)for(;d--;)y[d]||g[d]||(g[d]=K.call(s));g=m(g)}Z.apply(s,g),c&&!r&&g.length>0&&h+n.length>1&&e.uniqueSort(s)}return c&&(z=b,E=v),y};return i?r(a):a}var b,M,w,x,F,S,D,k,E,C,T,N,O,A,j,P,I,H,L,R="sizzle"+1*new Date,$=t.document,z=0,W=0,B=n(),q=n(),U=n(),Y=function(t,e){return t===e&&(T=!0),0},G=1<<31,J={}.hasOwnProperty,V=[],K=V.pop,X=V.push,Z=V.push,Q=V.slice,tt=function(t,e){for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1},et="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",nt="[\\\\x20\\\\t\\\\r\\\\n\\\\f]",rt="(?:\\\\\\\\.|[\\\\w-]|[^\\\\x00-\\\\xa0])+",it="\\\\["+nt+"*("+rt+")(?:"+nt+"*([*^$|!~]?=)"+nt+"*(?:\'((?:\\\\\\\\.|[^\\\\\\\\\'])*)\'|\\"((?:\\\\\\\\.|[^\\\\\\\\\\"])*)\\"|("+rt+"))|)"+nt+"*\\\\]",ot=":("+rt+")(?:\\\\(((\'((?:\\\\\\\\.|[^\\\\\\\\\'])*)\'|\\"((?:\\\\\\\\.|[^\\\\\\\\\\"])*)\\")|((?:\\\\\\\\.|[^\\\\\\\\()[\\\\]]|"+it+")*)|.*)\\\\)|)",at=new RegExp(nt+"+","g"),ut=new RegExp("^"+nt+"+|((?:^|[^\\\\\\\\])(?:\\\\\\\\.)*)"+nt+"+$","g"),st=new RegExp("^"+nt+"*,"+nt+"*"),ct=new RegExp("^"+nt+"*([>+~]|"+nt+")"+nt+"*"),lt=new RegExp("="+nt+"*([^\\\\]\'\\"]*?)"+nt+"*\\\\]","g"),ft=new RegExp(ot),pt=new RegExp("^"+rt+"$"),ht={ID:new RegExp("^#("+rt+")"),CLASS:new RegExp("^\\\\.("+rt+")"),TAG:new RegExp("^("+rt+"|[*])"),ATTR:new RegExp("^"+it),PSEUDO:new RegExp("^"+ot),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\\\("+nt+"*(even|odd|(([+-]|)(\\\\d*)n|)"+nt+"*(?:([+-]|)"+nt+"*(\\\\d+)|))"+nt+"*\\\\)|)","i"),bool:new RegExp("^(?:"+et+")$","i"),needsContext:new RegExp("^"+nt+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\\\("+nt+"*((?:-\\\\d)?\\\\d*)"+nt+"*\\\\)|)(?=[^-]|$)","i")},dt=/^(?:input|select|textarea|button)$/i,yt=/^h\\d$/i,mt=/^[^{]+\\{\\s*\\[native \\w/,gt=/^(?:#([\\w-]+)|(\\w+)|\\.([\\w-]+))$/,vt=/[+~]/,_t=/\'|\\\\/g,bt=new RegExp("\\\\\\\\([\\\\da-f]{1,6}"+nt+"?|("+nt+")|.)","ig"),Mt=function(t,e,n){var r="0x"+e-65536;return r!==r||n?e:r<0?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,1023&r|56320)},wt=function(){N()};try{Z.apply(V=Q.call($.childNodes),$.childNodes),V[$.childNodes.length].nodeType}catch(t){Z={apply:V.length?function(t,e){X.apply(t,Q.call(e))}:function(t,e){for(var n=t.length,r=0;t[n++]=e[r++];);t.length=n-1}}}M=e.support={},F=e.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return!!e&&"HTML"!==e.nodeName},N=e.setDocument=function(t){var e,n,r=t?t.ownerDocument||t:$;return r!==O&&9===r.nodeType&&r.documentElement?(O=r,A=O.documentElement,j=!F(O),(n=O.defaultView)&&n.top!==n&&(n.addEventListener?n.addEventListener("unload",wt,!1):n.attachEvent&&n.attachEvent("onunload",wt)),M.attributes=i(function(t){return t.className="i",!t.getAttribute("className")}),M.getElementsByTagName=i(function(t){return t.appendChild(O.createComment("")),!t.getElementsByTagName("*").length}),M.getElementsByClassName=mt.test(O.getElementsByClassName),M.getById=i(function(t){return A.appendChild(t).id=R,!O.getElementsByName||!O.getElementsByName(R).length}),M.getById?(w.find.ID=function(t,e){if(void 0!==e.getElementById&&j){var n=e.getElementById(t);return n?[n]:[]}},w.filter.ID=function(t){var e=t.replace(bt,Mt);return function(t){return t.getAttribute("id")===e}}):(delete w.find.ID,w.filter.ID=function(t){var e=t.replace(bt,Mt);return function(t){var n=void 0!==t.getAttributeNode&&t.getAttributeNode("id");return n&&n.value===e}}),w.find.TAG=M.getElementsByTagName?function(t,e){return void 0!==e.getElementsByTagName?e.getElementsByTagName(t):M.qsa?e.querySelectorAll(t):void 0}:function(t,e){var n,r=[],i=0,o=e.getElementsByTagName(t);if("*"===t){for(;n=o[i++];)1===n.nodeType&&r.push(n);return r}return o},w.find.CLASS=M.getElementsByClassName&&function(t,e){if(void 0!==e.getElementsByClassName&&j)return e.getElementsByClassName(t)},I=[],P=[],(M.qsa=mt.test(O.querySelectorAll))&&(i(function(t){A.appendChild(t).innerHTML="<a id=\'"+R+"\'></a><select id=\'"+R+"-\\r\\\\\' msallowcapture=\'\'><option selected=\'\'></option></select>",t.querySelectorAll("[msallowcapture^=\'\']").length&&P.push("[*^$]="+nt+"*(?:\'\'|\\"\\")"),t.querySelectorAll("[selected]").length||P.push("\\\\["+nt+"*(?:value|"+et+")"),t.querySelectorAll("[id~="+R+"-]").length||P.push("~="),t.querySelectorAll(":checked").length||P.push(":checked"),t.querySelectorAll("a#"+R+"+*").length||P.push(".#.+[+~]")}),i(function(t){var e=O.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&P.push("name"+nt+"*[*^$|!~]?="),t.querySelectorAll(":enabled").length||P.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),P.push(",.*:")})),(M.matchesSelector=mt.test(H=A.matches||A.webkitMatchesSelector||A.mozMatchesSelector||A.oMatchesSelector||A.msMatchesSelector))&&i(function(t){M.disconnectedMatch=H.call(t,"div"),H.call(t,"[s!=\'\']:x"),I.push("!=",ot)}),P=P.length&&new RegExp(P.join("|")),I=I.length&&new RegExp(I.join("|")),e=mt.test(A.compareDocumentPosition),L=e||mt.test(A.contains)?function(t,e){var n=9===t.nodeType?t.documentElement:t,r=e&&e.parentNode;return t===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):t.compareDocumentPosition&&16&t.compareDocumentPosition(r)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},Y=e?function(t,e){if(t===e)return T=!0,0;var n=!t.compareDocumentPosition-!e.compareDocumentPosition;return n||(n=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1,1&n||!M.sortDetached&&e.compareDocumentPosition(t)===n?t===O||t.ownerDocument===$&&L($,t)?-1:e===O||e.ownerDocument===$&&L($,e)?1:C?tt(C,t)-tt(C,e):0:4&n?-1:1)}:function(t,e){if(t===e)return T=!0,0;var n,r=0,i=t.parentNode,o=e.parentNode,u=[t],s=[e];if(!i||!o)return t===O?-1:e===O?1:i?-1:o?1:C?tt(C,t)-tt(C,e):0;if(i===o)return a(t,e);for(n=t;n=n.parentNode;)u.unshift(n);for(n=e;n=n.parentNode;)s.unshift(n);for(;u[r]===s[r];)r++;return r?a(u[r],s[r]):u[r]===$?-1:s[r]===$?1:0},O):O},e.matches=function(t,n){return e(t,null,null,n)},e.matchesSelector=function(t,n){if((t.ownerDocument||t)!==O&&N(t),n=n.replace(lt,"=\'$1\']"),M.matchesSelector&&j&&!U[n+" "]&&(!I||!I.test(n))&&(!P||!P.test(n)))try{var r=H.call(t,n);if(r||M.disconnectedMatch||t.document&&11!==t.document.nodeType)return r}catch(t){}return e(n,O,null,[t]).length>0},e.contains=function(t,e){return(t.ownerDocument||t)!==O&&N(t),L(t,e)},e.attr=function(t,e){(t.ownerDocument||t)!==O&&N(t);var n=w.attrHandle[e.toLowerCase()],r=n&&J.call(w.attrHandle,e.toLowerCase())?n(t,e,!j):void 0;return void 0!==r?r:M.attributes||!j?t.getAttribute(e):(r=t.getAttributeNode(e))&&r.specified?r.value:null},e.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},e.uniqueSort=function(t){var e,n=[],r=0,i=0;if(T=!M.detectDuplicates,C=!M.sortStable&&t.slice(0),t.sort(Y),T){for(;e=t[i++];)e===t[i]&&(r=n.push(i));for(;r--;)t.splice(n[r],1)}return C=null,t},x=e.getText=function(t){var e,n="",r=0,i=t.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)n+=x(t)}else if(3===i||4===i)return t.nodeValue}else for(;e=t[r++];)n+=x(e);return n},w=e.selectors={cacheLength:50,createPseudo:r,match:ht,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(bt,Mt),t[3]=(t[3]||t[4]||t[5]||"").replace(bt,Mt),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||e.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&e.error(t[0]),t},PSEUDO:function(t){var e,n=!t[6]&&t[2];return ht.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":n&&ft.test(n)&&(e=S(n,!0))&&(e=n.indexOf(")",n.length-e)-n.length)&&(t[0]=t[0].slice(0,e),t[2]=n.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(bt,Mt).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=B[t+" "];return e||(e=new RegExp("(^|"+nt+")"+t+"("+nt+"|$)"))&&B(t,function(t){return e.test("string"==typeof t.className&&t.className||void 0!==t.getAttribute&&t.getAttribute("class")||"")})},ATTR:function(t,n,r){return function(i){var o=e.attr(i,t);return null==o?"!="===n:!n||(o+="","="===n?o===r:"!="===n?o!==r:"^="===n?r&&0===o.indexOf(r):"*="===n?r&&o.indexOf(r)>-1:"$="===n?r&&o.slice(-r.length)===r:"~="===n?(" "+o.replace(at," ")+" ").indexOf(r)>-1:"|="===n&&(o===r||o.slice(0,r.length+1)===r+"-"))}},CHILD:function(t,e,n,r,i){var o="nth"!==t.slice(0,3),a="last"!==t.slice(-4),u="of-type"===e;return 1===r&&0===i?function(t){return!!t.parentNode}:function(e,n,s){var c,l,f,p,h,d,y=o!==a?"nextSibling":"previousSibling",m=e.parentNode,g=u&&e.nodeName.toLowerCase(),v=!s&&!u,_=!1;if(m){if(o){for(;y;){for(p=e;p=p[y];)if(u?p.nodeName.toLowerCase()===g:1===p.nodeType)return!1;d=y="only"===t&&!d&&"nextSibling"}return!0}if(d=[a?m.firstChild:m.lastChild],a&&v){for(p=m,f=p[R]||(p[R]={}),l=f[p.uniqueID]||(f[p.uniqueID]={}),c=l[t]||[],h=c[0]===z&&c[1],_=h&&c[2],p=h&&m.childNodes[h];p=++h&&p&&p[y]||(_=h=0)||d.pop();)if(1===p.nodeType&&++_&&p===e){l[t]=[z,h,_];break}}else if(v&&(p=e,f=p[R]||(p[R]={}),l=f[p.uniqueID]||(f[p.uniqueID]={}),c=l[t]||[],h=c[0]===z&&c[1],_=h),!1===_)for(;(p=++h&&p&&p[y]||(_=h=0)||d.pop())&&((u?p.nodeName.toLowerCase()!==g:1!==p.nodeType)||!++_||(v&&(f=p[R]||(p[R]={}),l=f[p.uniqueID]||(f[p.uniqueID]={}),l[t]=[z,_]),p!==e)););return(_-=i)===r||_%r==0&&_/r>=0}}},PSEUDO:function(t,n){var i,o=w.pseudos[t]||w.setFilters[t.toLowerCase()]||e.error("unsupported pseudo: "+t);return o[R]?o(n):o.length>1?(i=[t,t,"",n],w.setFilters.hasOwnProperty(t.toLowerCase())?r(function(t,e){for(var r,i=o(t,n),a=i.length;a--;)r=tt(t,i[a]),t[r]=!(e[r]=i[a])}):function(t){return o(t,0,i)}):o}},pseudos:{not:r(function(t){var e=[],n=[],i=D(t.replace(ut,"$1"));return i[R]?r(function(t,e,n,r){for(var o,a=i(t,null,r,[]),u=t.length;u--;)(o=a[u])&&(t[u]=!(e[u]=o))}):function(t,r,o){return e[0]=t,i(e,null,o,n),e[0]=null,!n.pop()}}),has:r(function(t){return function(n){return e(t,n).length>0}}),contains:r(function(t){return t=t.replace(bt,Mt),function(e){return(e.textContent||e.innerText||x(e)).indexOf(t)>-1}}),lang:r(function(t){return pt.test(t||"")||e.error("unsupported lang: "+t),t=t.replace(bt,Mt).toLowerCase(),function(e){var n;do{if(n=j?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(n=n.toLowerCase())===t||0===n.indexOf(t+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var n=t.location&&t.location.hash;return n&&n.slice(1)===e.id},root:function(t){return t===A},focus:function(t){return t===O.activeElement&&(!O.hasFocus||O.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:function(t){return!1===t.disabled},disabled:function(t){return!0===t.disabled},checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!w.pseudos.empty(t)},header:function(t){return yt.test(t.nodeName)},input:function(t){return dt.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:c(function(){return[0]}),last:c(function(t,e){return[e-1]}),eq:c(function(t,e,n){return[n<0?n+e:n]}),even:c(function(t,e){for(var n=0;n<e;n+=2)t.push(n);return t}),odd:c(function(t,e){for(var n=1;n<e;n+=2)t.push(n);return t}),lt:c(function(t,e,n){for(var r=n<0?n+e:n;--r>=0;)t.push(r);return t}),gt:c(function(t,e,n){for(var r=n<0?n+e:n;++r<e;)t.push(r);return t})}},w.pseudos.nth=w.pseudos.eq;for(b in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})w.pseudos[b]=u(b);for(b in{submit:!0,reset:!0})w.pseudos[b]=s(b);return f.prototype=w.filters=w.pseudos,w.setFilters=new f,S=e.tokenize=function(t,n){var r,i,o,a,u,s,c,l=q[t+" "];if(l)return n?0:l.slice(0);for(u=t,s=[],c=w.preFilter;u;){r&&!(i=st.exec(u))||(i&&(u=u.slice(i[0].length)||u),s.push(o=[])),r=!1,(i=ct.exec(u))&&(r=i.shift(),o.push({value:r,type:i[0].replace(ut," ")}),u=u.slice(r.length));for(a in w.filter)!(i=ht[a].exec(u))||c[a]&&!(i=c[a](i))||(r=i.shift(),o.push({value:r,type:a,matches:i}),u=u.slice(r.length));if(!r)break}return n?u.length:u?e.error(t):q(t,s).slice(0)},D=e.compile=function(t,e){var n,r=[],i=[],o=U[t+" "];if(!o){for(e||(e=S(t)),n=e.length;n--;)o=v(e[n]),o[R]?r.push(o):i.push(o);o=U(t,_(i,r)),o.selector=t}return o},k=e.select=function(t,e,n,r){var i,o,a,u,s,c="function"==typeof t&&t,f=!r&&S(t=c.selector||t);if(n=n||[],1===f.length){if(o=f[0]=f[0].slice(0),o.length>2&&"ID"===(a=o[0]).type&&M.getById&&9===e.nodeType&&j&&w.relative[o[1].type]){if(!(e=(w.find.ID(a.matches[0].replace(bt,Mt),e)||[])[0]))return n;c&&(e=e.parentNode),t=t.slice(o.shift().value.length)}for(i=ht.needsContext.test(t)?0:o.length;i--&&(a=o[i],!w.relative[u=a.type]);)if((s=w.find[u])&&(r=s(a.matches[0].replace(bt,Mt),vt.test(o[0].type)&&l(e.parentNode)||e))){if(o.splice(i,1),!(t=r.length&&p(o)))return Z.apply(n,r),n;break}}return(c||D(t,f))(r,e,!j,n,!e||vt.test(t)&&l(e.parentNode)||e),n},M.sortStable=R.split("").sort(Y).join("")===R,M.detectDuplicates=!!T,N(),M.sortDetached=i(function(t){return 1&t.compareDocumentPosition(O.createElement("div"))}),i(function(t){return t.innerHTML="<a href=\'#\'></a>","#"===t.firstChild.getAttribute("href")})||o("type|href|height|width",function(t,e,n){if(!n)return t.getAttribute(e,"type"===e.toLowerCase()?1:2)}),M.attributes&&i(function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")})||o("value",function(t,e,n){if(!n&&"input"===t.nodeName.toLowerCase())return t.defaultValue}),i(function(t){return null==t.getAttribute("disabled")})||o(et,function(t,e,n){var r;if(!n)return!0===t[e]?e.toLowerCase():(r=t.getAttributeNode(e))&&r.specified?r.value:null}),e}(n);ct.find=dt,ct.expr=dt.selectors,ct.expr[":"]=ct.expr.pseudos,ct.uniqueSort=ct.unique=dt.uniqueSort,ct.text=dt.getText,ct.isXMLDoc=dt.isXML,ct.contains=dt.contains;var yt=function(t,e,n){for(var r=[],i=void 0!==n;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(i&&ct(t).is(n))break;r.push(t)}return r},mt=function(t,e){for(var n=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&n.push(t);return n},gt=ct.expr.match.needsContext,vt=/^<([\\w-]+)\\s*\\/?>(?:<\\/\\1>|)$/,_t=/^.[^:#\\[\\.,]*$/;ct.filter=function(t,e,n){var r=e[0];return n&&(t=":not("+t+")"),1===e.length&&1===r.nodeType?ct.find.matchesSelector(r,t)?[r]:[]:ct.find.matches(t,ct.grep(e,function(t){return 1===t.nodeType}))},ct.fn.extend({find:function(t){var e,n=this.length,r=[],i=this;if("string"!=typeof t)return this.pushStack(ct(t).filter(function(){for(e=0;e<n;e++)if(ct.contains(i[e],this))return!0}));for(e=0;e<n;e++)ct.find(t,i[e],r);return r=this.pushStack(n>1?ct.unique(r):r),r.selector=this.selector?this.selector+" "+t:t,r},filter:function(t){return this.pushStack(u(this,t||[],!1))},not:function(t){return this.pushStack(u(this,t||[],!0))},is:function(t){return!!u(this,"string"==typeof t&&gt.test(t)?ct(t):t||[],!1).length}});var bt,Mt=/^(?:\\s*(<[\\w\\W]+>)[^>]*|#([\\w-]*))$/;(ct.fn.init=function(t,e,n){var r,i;if(!t)return this;if(n=n||bt,"string"==typeof t){if(!(r="<"===t[0]&&">"===t[t.length-1]&&t.length>=3?[null,t,null]:Mt.exec(t))||!r[1]&&e)return!e||e.jquery?(e||n).find(t):this.constructor(e).find(t);if(r[1]){if(e=e instanceof ct?e[0]:e,ct.merge(this,ct.parseHTML(r[1],e&&e.nodeType?e.ownerDocument||e:Q,!0)),vt.test(r[1])&&ct.isPlainObject(e))for(r in e)ct.isFunction(this[r])?this[r](e[r]):this.attr(r,e[r]);return this}return i=Q.getElementById(r[2]),i&&i.parentNode&&(this.length=1,this[0]=i),this.context=Q,this.selector=t,this}return t.nodeType?(this.context=this[0]=t,this.length=1,this):ct.isFunction(t)?void 0!==n.ready?n.ready(t):t(ct):(void 0!==t.selector&&(this.selector=t.selector,this.context=t.context),ct.makeArray(t,this))}).prototype=ct.fn,bt=ct(Q);var wt=/^(?:parents|prev(?:Until|All))/,xt={children:!0,contents:!0,next:!0,prev:!0};ct.fn.extend({has:function(t){var e=ct(t,this),n=e.length;return this.filter(function(){for(var t=0;t<n;t++)if(ct.contains(this,e[t]))return!0})},closest:function(t,e){for(var n,r=0,i=this.length,o=[],a=gt.test(t)||"string"!=typeof t?ct(t,e||this.context):0;r<i;r++)for(n=this[r];n&&n!==e;n=n.parentNode)if(n.nodeType<11&&(a?a.index(n)>-1:1===n.nodeType&&ct.find.matchesSelector(n,t))){o.push(n);break}return this.pushStack(o.length>1?ct.uniqueSort(o):o)},index:function(t){return t?"string"==typeof t?rt.call(ct(t),this[0]):rt.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(ct.uniqueSort(ct.merge(this.get(),ct(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),ct.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return yt(t,"parentNode")},parentsUntil:function(t,e,n){return yt(t,"parentNode",n)},next:function(t){return s(t,"nextSibling")},prev:function(t){return s(t,"previousSibling")},nextAll:function(t){return yt(t,"nextSibling")},prevAll:function(t){return yt(t,"previousSibling")},nextUntil:function(t,e,n){return yt(t,"nextSibling",n)},prevUntil:function(t,e,n){return yt(t,"previousSibling",n)},siblings:function(t){return mt((t.parentNode||{}).firstChild,t)},children:function(t){return mt(t.firstChild)},contents:function(t){return t.contentDocument||ct.merge([],t.childNodes)}},function(t,e){ct.fn[t]=function(n,r){var i=ct.map(this,e,n);return"Until"!==t.slice(-5)&&(r=n),r&&"string"==typeof r&&(i=ct.filter(r,i)),this.length>1&&(xt[t]||ct.uniqueSort(i),wt.test(t)&&i.reverse()),this.pushStack(i)}});var Ft=/\\S+/g;ct.Callbacks=function(t){t="string"==typeof t?c(t):ct.extend({},t);var e,n,r,i,o=[],a=[],u=-1,s=function(){for(i=t.once,r=e=!0;a.length;u=-1)for(n=a.shift();++u<o.length;)!1===o[u].apply(n[0],n[1])&&t.stopOnFalse&&(u=o.length,n=!1);t.memory||(n=!1),e=!1,i&&(o=n?[]:"")},l={add:function(){return o&&(n&&!e&&(u=o.length-1,a.push(n)),function e(n){ct.each(n,function(n,r){ct.isFunction(r)?t.unique&&l.has(r)||o.push(r):r&&r.length&&"string"!==ct.type(r)&&e(r)})}(arguments),n&&!e&&s()),this},remove:function(){return ct.each(arguments,function(t,e){for(var n;(n=ct.inArray(e,o,n))>-1;)o.splice(n,1),n<=u&&u--}),this},has:function(t){return t?ct.inArray(t,o)>-1:o.length>0},empty:function(){return o&&(o=[]),this},disable:function(){return i=a=[],o=n="",this},disabled:function(){return!o},lock:function(){return i=a=[],n||(o=n=""),this},locked:function(){return!!i},fireWith:function(t,n){return i||(n=n||[],n=[t,n.slice?n.slice():n],a.push(n),e||s()),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!r}};return l},ct.extend({Deferred:function(t){var e=[["resolve","done",ct.Callbacks("once memory"),"resolved"],["reject","fail",ct.Callbacks("once memory"),"rejected"],["notify","progress",ct.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var t=arguments;return ct.Deferred(function(n){ct.each(e,function(e,o){var a=ct.isFunction(t[e])&&t[e];i[o[1]](function(){var t=a&&a.apply(this,arguments);t&&ct.isFunction(t.promise)?t.promise().progress(n.notify).done(n.resolve).fail(n.reject):n[o[0]+"With"](this===r?n.promise():this,a?[t]:arguments)})}),t=null}).promise()},promise:function(t){return null!=t?ct.extend(t,r):r}},i={};return r.pipe=r.then,ct.each(e,function(t,o){var a=o[2],u=o[3];r[o[1]]=a.add,u&&a.add(function(){n=u},e[1^t][2].disable,e[2][2].lock),i[o[0]]=function(){return i[o[0]+"With"](this===i?r:this,arguments),this},i[o[0]+"With"]=a.fireWith}),r.promise(i),t&&t.call(i,i),i},when:function(t){var e,n,r,i=0,o=tt.call(arguments),a=o.length,u=1!==a||t&&ct.isFunction(t.promise)?a:0,s=1===u?t:ct.Deferred(),c=function(t,n,r){return function(i){n[t]=this,r[t]=arguments.length>1?tt.call(arguments):i,r===e?s.notifyWith(n,r):--u||s.resolveWith(n,r)}};if(a>1)for(e=new Array(a),n=new Array(a),r=new Array(a);i<a;i++)o[i]&&ct.isFunction(o[i].promise)?o[i].promise().progress(c(i,n,e)).done(c(i,r,o)).fail(s.reject):--u;return u||s.resolveWith(r,o),s.promise()}});var St;ct.fn.ready=function(t){return ct.ready.promise().done(t),this},ct.extend({isReady:!1,readyWait:1,holdReady:function(t){t?ct.readyWait++:ct.ready(!0)},ready:function(t){(!0===t?--ct.readyWait:ct.isReady)||(ct.isReady=!0,!0!==t&&--ct.readyWait>0||(St.resolveWith(Q,[ct]),ct.fn.triggerHandler&&(ct(Q).triggerHandler("ready"),ct(Q).off("ready"))))}}),ct.ready.promise=function(t){return St||(St=ct.Deferred(),"complete"===Q.readyState||"loading"!==Q.readyState&&!Q.documentElement.doScroll?n.setTimeout(ct.ready):(Q.addEventListener("DOMContentLoaded",l),n.addEventListener("load",l))),St.promise(t)},ct.ready.promise();var Dt=function(t,e,n,r,i,o,a){var u=0,s=t.length,c=null==n;if("object"===ct.type(n)){i=!0;for(u in n)Dt(t,e,u,n[u],!0,o,a)}else if(void 0!==r&&(i=!0,ct.isFunction(r)||(a=!0),c&&(a?(e.call(t,r),e=null):(c=e,e=function(t,e,n){return c.call(ct(t),n)})),e))for(;u<s;u++)e(t[u],n,a?r:r.call(t[u],u,e(t[u],n)));return i?t:c?e.call(t):s?e(t[0],n):o},kt=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType};f.uid=1,f.prototype={register:function(t,e){var n=e||{};return t.nodeType?t[this.expando]=n:Object.defineProperty(t,this.expando,{value:n,writable:!0,configurable:!0}),t[this.expando]},cache:function(t){if(!kt(t))return{};var e=t[this.expando];return e||(e={},kt(t)&&(t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,configurable:!0}))),e},set:function(t,e,n){var r,i=this.cache(t);if("string"==typeof e)i[e]=n;else for(r in e)i[r]=e[r];return i},get:function(t,e){return void 0===e?this.cache(t):t[this.expando]&&t[this.expando][e]},access:function(t,e,n){var r;return void 0===e||e&&"string"==typeof e&&void 0===n?(r=this.get(t,e),void 0!==r?r:this.get(t,ct.camelCase(e))):(this.set(t,e,n),void 0!==n?n:e)},remove:function(t,e){var n,r,i,o=t[this.expando];if(void 0!==o){if(void 0===e)this.register(t);else{ct.isArray(e)?r=e.concat(e.map(ct.camelCase)):(i=ct.camelCase(e),e in o?r=[e,i]:(r=i,r=r in o?[r]:r.match(Ft)||[])),n=r.length;for(;n--;)delete o[r[n]]}(void 0===e||ct.isEmptyObject(o))&&(t.nodeType?t[this.expando]=void 0:delete t[this.expando])}},hasData:function(t){var e=t[this.expando];return void 0!==e&&!ct.isEmptyObject(e)}};var Et=new f,Ct=new f,Tt=/^(?:\\{[\\w\\W]*\\}|\\[[\\w\\W]*\\])$/,Nt=/[A-Z]/g;ct.extend({hasData:function(t){return Ct.hasData(t)||Et.hasData(t)},data:function(t,e,n){return Ct.access(t,e,n)},removeData:function(t,e){Ct.remove(t,e)},_data:function(t,e,n){return Et.access(t,e,n)},_removeData:function(t,e){Et.remove(t,e)}}),ct.fn.extend({data:function(t,e){var n,r,i,o=this[0],a=o&&o.attributes;if(void 0===t){if(this.length&&(i=Ct.get(o),1===o.nodeType&&!Et.get(o,"hasDataAttrs"))){for(n=a.length;n--;)a[n]&&(r=a[n].name,0===r.indexOf("data-")&&(r=ct.camelCase(r.slice(5)),p(o,r,i[r])));Et.set(o,"hasDataAttrs",!0)}return i}return"object"==typeof t?this.each(function(){Ct.set(this,t)}):Dt(this,function(e){var n,r;if(o&&void 0===e){if(void 0!==(n=Ct.get(o,t)||Ct.get(o,t.replace(Nt,"-$&").toLowerCase())))return n;if(r=ct.camelCase(t),void 0!==(n=Ct.get(o,r)))return n;if(void 0!==(n=p(o,r,void 0)))return n}else r=ct.camelCase(t),this.each(function(){var n=Ct.get(this,r);Ct.set(this,r,e),t.indexOf("-")>-1&&void 0!==n&&Ct.set(this,t,e)})},null,e,arguments.length>1,null,!0)},removeData:function(t){return this.each(function(){Ct.remove(this,t)})}}),ct.extend({queue:function(t,e,n){var r;if(t)return e=(e||"fx")+"queue",r=Et.get(t,e),n&&(!r||ct.isArray(n)?r=Et.access(t,e,ct.makeArray(n)):r.push(n)),r||[]},dequeue:function(t,e){e=e||"fx";var n=ct.queue(t,e),r=n.length,i=n.shift(),o=ct._queueHooks(t,e),a=function(){ct.dequeue(t,e)};"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===e&&n.unshift("inprogress"),delete o.stop,i.call(t,a,o)),!r&&o&&o.empty.fire()},_queueHooks:function(t,e){var n=e+"queueHooks";return Et.get(t,n)||Et.access(t,n,{empty:ct.Callbacks("once memory").add(function(){Et.remove(t,[e+"queue",n])})})}}),ct.fn.extend({queue:function(t,e){var n=2;return"string"!=typeof t&&(e=t,t="fx",n--),arguments.length<n?ct.queue(this[0],t):void 0===e?this:this.each(function(){var n=ct.queue(this,t,e);ct._queueHooks(this,t),"fx"===t&&"inprogress"!==n[0]&&ct.dequeue(this,t)})},dequeue:function(t){return this.each(function(){ct.dequeue(this,t)})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var n,r=1,i=ct.Deferred(),o=this,a=this.length,u=function(){--r||i.resolveWith(o,[o])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";a--;)(n=Et.get(o[a],t+"queueHooks"))&&n.empty&&(r++,n.empty.add(u));return u(),i.promise(e)}});var Ot=/[+-]?(?:\\d*\\.|)\\d+(?:[eE][+-]?\\d+|)/.source,At=new RegExp("^(?:([+-])=|)("+Ot+")([a-z%]*)$","i"),jt=["Top","Right","Bottom","Left"],Pt=function(t,e){return t=e||t,"none"===ct.css(t,"display")||!ct.contains(t.ownerDocument,t)},It=/^(?:checkbox|radio)$/i,Ht=/<([\\w:-]+)/,Lt=/^$|\\/(?:java|ecma)script/i,Rt={option:[1,"<select multiple=\'multiple\'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Rt.optgroup=Rt.option,Rt.tbody=Rt.tfoot=Rt.colgroup=Rt.caption=Rt.thead,Rt.th=Rt.td;var $t=/<|&#?\\w+;/;!function(){var t=Q.createDocumentFragment(),e=t.appendChild(Q.createElement("div")),n=Q.createElement("input");n.setAttribute("type","radio"),n.setAttribute("checked","checked"),n.setAttribute("name","t"),e.appendChild(n),ut.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,e.innerHTML="<textarea>x</textarea>",ut.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue}();var zt=/^key/,Wt=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Bt=/^([^.]*)(?:\\.(.+)|)/;ct.event={global:{},add:function(t,e,n,r,i){var o,a,u,s,c,l,f,p,h,d,y,m=Et.get(t);if(m)for(n.handler&&(o=n,n=o.handler,i=o.selector),n.guid||(n.guid=ct.guid++),(s=m.events)||(s=m.events={}),(a=m.handle)||(a=m.handle=function(e){return void 0!==ct&&ct.event.triggered!==e.type?ct.event.dispatch.apply(t,arguments):void 0}),e=(e||"").match(Ft)||[""],c=e.length;c--;)u=Bt.exec(e[c])||[],h=y=u[1],d=(u[2]||"").split(".").sort(),h&&(f=ct.event.special[h]||{},h=(i?f.delegateType:f.bindType)||h,f=ct.event.special[h]||{},l=ct.extend({type:h,origType:y,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&ct.expr.match.needsContext.test(i),namespace:d.join(".")},o),(p=s[h])||(p=s[h]=[],p.delegateCount=0,f.setup&&!1!==f.setup.call(t,r,d,a)||t.addEventListener&&t.addEventListener(h,a)),f.add&&(f.add.call(t,l),l.handler.guid||(l.handler.guid=n.guid)),i?p.splice(p.delegateCount++,0,l):p.push(l),ct.event.global[h]=!0)},remove:function(t,e,n,r,i){var o,a,u,s,c,l,f,p,h,d,y,m=Et.hasData(t)&&Et.get(t);if(m&&(s=m.events)){for(e=(e||"").match(Ft)||[""],c=e.length;c--;)if(u=Bt.exec(e[c])||[],h=y=u[1],d=(u[2]||"").split(".").sort(),h){for(f=ct.event.special[h]||{},h=(r?f.delegateType:f.bindType)||h,p=s[h]||[],u=u[2]&&new RegExp("(^|\\\\.)"+d.join("\\\\.(?:.*\\\\.|)")+"(\\\\.|$)"),a=o=p.length;o--;)l=p[o],!i&&y!==l.origType||n&&n.guid!==l.guid||u&&!u.test(l.namespace)||r&&r!==l.selector&&("**"!==r||!l.selector)||(p.splice(o,1),l.selector&&p.delegateCount--,f.remove&&f.remove.call(t,l));a&&!p.length&&(f.teardown&&!1!==f.teardown.call(t,d,m.handle)||ct.removeEvent(t,h,m.handle),delete s[h])}else for(h in s)ct.event.remove(t,h+e[c],n,r,!0);ct.isEmptyObject(s)&&Et.remove(t,"handle events")}},dispatch:function(t){t=ct.event.fix(t);var e,n,r,i,o,a=[],u=tt.call(arguments),s=(Et.get(this,"events")||{})[t.type]||[],c=ct.event.special[t.type]||{};if(u[0]=t,t.delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,t)){for(a=ct.event.handlers.call(this,t,s),e=0;(i=a[e++])&&!t.isPropagationStopped();)for(t.currentTarget=i.elem,n=0;(o=i.handlers[n++])&&!t.isImmediatePropagationStopped();)t.rnamespace&&!t.rnamespace.test(o.namespace)||(t.handleObj=o,t.data=o.data,void 0!==(r=((ct.event.special[o.origType]||{}).handle||o.handler).apply(i.elem,u))&&!1===(t.result=r)&&(t.preventDefault(),t.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,t),t.result}},handlers:function(t,e){var n,r,i,o,a=[],u=e.delegateCount,s=t.target;if(u&&s.nodeType&&("click"!==t.type||isNaN(t.button)||t.button<1))for(;s!==this;s=s.parentNode||this)if(1===s.nodeType&&(!0!==s.disabled||"click"!==t.type)){for(r=[],n=0;n<u;n++)o=e[n],i=o.selector+" ",void 0===r[i]&&(r[i]=o.needsContext?ct(i,this).index(s)>-1:ct.find(i,this,null,[s]).length),r[i]&&r.push(o);r.length&&a.push({elem:s,handlers:r})}return u<e.length&&a.push({elem:this,handlers:e.slice(u)}),a},props:"altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(t,e){return null==t.which&&(t.which=null!=e.charCode?e.charCode:e.keyCode),t}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(t,e){var n,r,i,o=e.button;return null==t.pageX&&null!=e.clientX&&(n=t.target.ownerDocument||Q,r=n.documentElement,i=n.body,t.pageX=e.clientX+(r&&r.scrollLeft||i&&i.scrollLeft||0)-(r&&r.clientLeft||i&&i.clientLeft||0),t.pageY=e.clientY+(r&&r.scrollTop||i&&i.scrollTop||0)-(r&&r.clientTop||i&&i.clientTop||0)),t.which||void 0===o||(t.which=1&o?1:2&o?3:4&o?2:0),t}},fix:function(t){if(t[ct.expando])return t;var e,n,r,i=t.type,o=t,a=this.fixHooks[i];for(a||(this.fixHooks[i]=a=Wt.test(i)?this.mouseHooks:zt.test(i)?this.keyHooks:{}),r=a.props?this.props.concat(a.props):this.props,t=new ct.Event(o),e=r.length;e--;)n=r[e],t[n]=o[n];return t.target||(t.target=Q),3===t.target.nodeType&&(t.target=t.target.parentNode),a.filter?a.filter(t,o):t},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==_()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===_()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&ct.nodeName(this,"input"))return this.click(),!1},_default:function(t){return ct.nodeName(t.target,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}}},ct.removeEvent=function(t,e,n){t.removeEventListener&&t.removeEventListener(e,n)},ct.Event=function(t,e){if(!(this instanceof ct.Event))return new ct.Event(t,e);t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?g:v):this.type=t,e&&ct.extend(this,e),this.timeStamp=t&&t.timeStamp||ct.now(),this[ct.expando]=!0},ct.Event.prototype={constructor:ct.Event,isDefaultPrevented:v,isPropagationStopped:v,isImmediatePropagationStopped:v,isSimulated:!1,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=g,t&&!this.isSimulated&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=g,t&&!this.isSimulated&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=g,t&&!this.isSimulated&&t.stopImmediatePropagation(),this.stopPropagation()}},ct.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(t,e){ct.event.special[t]={delegateType:e,bindType:e,handle:function(t){var n,r=this,i=t.relatedTarget,o=t.handleObj;return i&&(i===r||ct.contains(r,i))||(t.type=o.origType,n=o.handler.apply(this,arguments),t.type=e),n}}}),ct.fn.extend({on:function(t,e,n,r){return b(this,t,e,n,r)},one:function(t,e,n,r){return b(this,t,e,n,r,1)},off:function(t,e,n){var r,i;if(t&&t.preventDefault&&t.handleObj)return r=t.handleObj,ct(t.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof t){for(i in t)this.off(i,e,t[i]);return this}return!1!==e&&"function"!=typeof e||(n=e,e=void 0),!1===n&&(n=v),this.each(function(){ct.event.remove(this,t,n,e)})}});var qt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\\w:-]+)[^>]*)\\/>/gi,Ut=/<script|<style|<link/i,Yt=/checked\\s*(?:[^=]|=\\s*.checked.)/i,Gt=/^true\\/(.*)/,Jt=/^\\s*<!(?:\\[CDATA\\[|--)|(?:\\]\\]|--)>\\s*$/g;ct.extend({htmlPrefilter:function(t){return t.replace(qt,"<$1></$2>")},clone:function(t,e,n){var r,i,o,a,u=t.cloneNode(!0),s=ct.contains(t.ownerDocument,t);if(!(ut.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||ct.isXMLDoc(t)))for(a=d(u),o=d(t),r=0,i=o.length;r<i;r++)S(o[r],a[r]);if(e)if(n)for(o=o||d(t),a=a||d(u),r=0,i=o.length;r<i;r++)F(o[r],a[r]);else F(t,u);return a=d(u,"script"),a.length>0&&y(a,!s&&d(t,"script")),u},cleanData:function(t){for(var e,n,r,i=ct.event.special,o=0;void 0!==(n=t[o]);o++)if(kt(n)){if(e=n[Et.expando]){if(e.events)for(r in e.events)i[r]?ct.event.remove(n,r):ct.removeEvent(n,r,e.handle);n[Et.expando]=void 0}n[Ct.expando]&&(n[Ct.expando]=void 0)}}}),ct.fn.extend({domManip:D,detach:function(t){return k(this,t,!0)},remove:function(t){return k(this,t)},text:function(t){return Dt(this,function(t){return void 0===t?ct.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)})},null,t,arguments.length)},append:function(){return D(this,arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){M(this,t).appendChild(t)}})},prepend:function(){return D(this,arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=M(this,t);e.insertBefore(t,e.firstChild)}})},before:function(){return D(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return D(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(ct.cleanData(d(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map(function(){return ct.clone(this,t,e)})},html:function(t){return Dt(this,function(t){var e=this[0]||{},n=0,r=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!Ut.test(t)&&!Rt[(Ht.exec(t)||["",""])[1].toLowerCase()]){t=ct.htmlPrefilter(t);try{for(;n<r;n++)e=this[n]||{},1===e.nodeType&&(ct.cleanData(d(e,!1)),e.innerHTML=t);e=0}catch(t){}}e&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var t=[];return D(this,arguments,function(e){var n=this.parentNode;ct.inArray(this,t)<0&&(ct.cleanData(d(this)),n&&n.replaceChild(e,this))},t)}}),ct.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,e){ct.fn[t]=function(t){for(var n,r=[],i=ct(t),o=i.length-1,a=0;a<=o;a++)n=a===o?this:this.clone(!0),ct(i[a])[e](n),nt.apply(r,n.get());return this.pushStack(r)}});var Vt,Kt={HTML:"block",BODY:"block"},Xt=/^margin/,Zt=new RegExp("^("+Ot+")(?!px)[a-z%]+$","i"),Qt=function(t){var e=t.ownerDocument.defaultView;return e&&e.opener||(e=n),e.getComputedStyle(t)},te=function(t,e,n,r){var i,o,a={};for(o in e)a[o]=t.style[o],t.style[o]=e[o];i=n.apply(t,r||[]);for(o in e)t.style[o]=a[o];return i},ee=Q.documentElement;!function(){function t(){u.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",u.innerHTML="",ee.appendChild(a);var t=n.getComputedStyle(u);e="1%"!==t.top,o="2px"===t.marginLeft,r="4px"===t.width,u.style.marginRight="50%",i="4px"===t.marginRight,ee.removeChild(a)}var e,r,i,o,a=Q.createElement("div"),u=Q.createElement("div");u.style&&(u.style.backgroundClip="content-box",u.cloneNode(!0).style.backgroundClip="",ut.clearCloneStyle="content-box"===u.style.backgroundClip,a.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",a.appendChild(u),ct.extend(ut,{pixelPosition:function(){return t(),e},boxSizingReliable:function(){return null==r&&t(),r},pixelMarginRight:function(){return null==r&&t(),i},reliableMarginLeft:function(){return null==r&&t(),o},reliableMarginRight:function(){var t,e=u.appendChild(Q.createElement("div"));return e.style.cssText=u.style.cssText="-webkit-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",e.style.marginRight=e.style.width="0",u.style.width="1px",ee.appendChild(a),t=!parseFloat(n.getComputedStyle(e).marginRight),ee.removeChild(a),u.removeChild(e),t}}))}();var ne=/^(none|table(?!-c[ea]).+)/,re={position:"absolute",visibility:"hidden",display:"block"},ie={letterSpacing:"0",fontWeight:"400"},oe=["Webkit","O","Moz","ms"],ae=Q.createElement("div").style;ct.extend({cssHooks:{opacity:{get:function(t,e){if(e){var n=T(t,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(t,e,n,r){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var i,o,a,u=ct.camelCase(e),s=t.style;if(e=ct.cssProps[u]||(ct.cssProps[u]=O(u)||u),a=ct.cssHooks[e]||ct.cssHooks[u],void 0===n)return a&&"get"in a&&void 0!==(i=a.get(t,!1,r))?i:s[e];o=typeof n,"string"===o&&(i=At.exec(n))&&i[1]&&(n=h(t,e,i),o="number"),null!=n&&n===n&&("number"===o&&(n+=i&&i[3]||(ct.cssNumber[u]?"":"px")),ut.clearCloneStyle||""!==n||0!==e.indexOf("background")||(s[e]="inherit"),a&&"set"in a&&void 0===(n=a.set(t,n,r))||(s[e]=n))}},css:function(t,e,n,r){var i,o,a,u=ct.camelCase(e);return e=ct.cssProps[u]||(ct.cssProps[u]=O(u)||u),a=ct.cssHooks[e]||ct.cssHooks[u],a&&"get"in a&&(i=a.get(t,!0,n)),void 0===i&&(i=T(t,e,r)),"normal"===i&&e in ie&&(i=ie[e]),""===n||n?(o=parseFloat(i),!0===n||isFinite(o)?o||0:i):i}}),ct.each(["height","width"],function(t,e){ct.cssHooks[e]={get:function(t,n,r){if(n)return ne.test(ct.css(t,"display"))&&0===t.offsetWidth?te(t,re,function(){return P(t,e,r)}):P(t,e,r)},set:function(t,n,r){var i,o=r&&Qt(t),a=r&&j(t,e,r,"border-box"===ct.css(t,"boxSizing",!1,o),o);return a&&(i=At.exec(n))&&"px"!==(i[3]||"px")&&(t.style[e]=n,n=ct.css(t,e)),A(t,n,a)}}}),ct.cssHooks.marginLeft=N(ut.reliableMarginLeft,function(t,e){if(e)return(parseFloat(T(t,"marginLeft"))||t.getBoundingClientRect().left-te(t,{marginLeft:0},function(){return t.getBoundingClientRect().left}))+"px"}),ct.cssHooks.marginRight=N(ut.reliableMarginRight,function(t,e){if(e)return te(t,{display:"inline-block"},T,[t,"marginRight"])}),ct.each({margin:"",padding:"",border:"Width"},function(t,e){ct.cssHooks[t+e]={expand:function(n){for(var r=0,i={},o="string"==typeof n?n.split(" "):[n];r<4;r++)i[t+jt[r]+e]=o[r]||o[r-2]||o[0];return i}},Xt.test(t)||(ct.cssHooks[t+e].set=A)}),ct.fn.extend({css:function(t,e){return Dt(this,function(t,e,n){var r,i,o={},a=0;if(ct.isArray(e)){for(r=Qt(t),i=e.length;a<i;a++)o[e[a]]=ct.css(t,e[a],!1,r);return o}return void 0!==n?ct.style(t,e,n):ct.css(t,e)},t,e,arguments.length>1)},show:function(){return I(this,!0)},hide:function(){return I(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each(function(){Pt(this)?ct(this).show():ct(this).hide()})}}),ct.Tween=H,H.prototype={constructor:H,init:function(t,e,n,r,i,o){this.elem=t,this.prop=n,this.easing=i||ct.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=r,this.unit=o||(ct.cssNumber[n]?"":"px")},cur:function(){var t=H.propHooks[this.prop];return t&&t.get?t.get(this):H.propHooks._default.get(this)},run:function(t){var e,n=H.propHooks[this.prop];return this.options.duration?this.pos=e=ct.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):H.propHooks._default.set(this),this}},H.prototype.init.prototype=H.prototype,H.propHooks={_default:{get:function(t){var e;return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(e=ct.css(t.elem,t.prop,""),e&&"auto"!==e?e:0)},set:function(t){ct.fx.step[t.prop]?ct.fx.step[t.prop](t):1!==t.elem.nodeType||null==t.elem.style[ct.cssProps[t.prop]]&&!ct.cssHooks[t.prop]?t.elem[t.prop]=t.now:ct.style(t.elem,t.prop,t.now+t.unit)}}},H.propHooks.scrollTop=H.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},ct.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},ct.fx=H.prototype.init,ct.fx.step={};var ue,se,ce=/^(?:toggle|show|hide)$/,le=/queueHooks$/;ct.Animation=ct.extend(B,{tweeners:{"*":[function(t,e){var n=this.createTween(t,e);return h(n.elem,t,At.exec(e),n),n}]},tweener:function(t,e){ct.isFunction(t)?(e=t,t=["*"]):t=t.match(Ft);for(var n,r=0,i=t.length;r<i;r++)n=t[r],B.tweeners[n]=B.tweeners[n]||[],B.tweeners[n].unshift(e)},prefilters:[z],prefilter:function(t,e){e?B.prefilters.unshift(t):B.prefilters.push(t)}}),ct.speed=function(t,e,n){var r=t&&"object"==typeof t?ct.extend({},t):{complete:n||!n&&e||ct.isFunction(t)&&t,duration:t,easing:n&&e||e&&!ct.isFunction(e)&&e};return r.duration=ct.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in ct.fx.speeds?ct.fx.speeds[r.duration]:ct.fx.speeds._default,null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){ct.isFunction(r.old)&&r.old.call(this),r.queue&&ct.dequeue(this,r.queue)},r},ct.fn.extend({fadeTo:function(t,e,n,r){return this.filter(Pt).css("opacity",0).show().end().animate({opacity:e},t,n,r)},animate:function(t,e,n,r){var i=ct.isEmptyObject(t),o=ct.speed(e,n,r),a=function(){var e=B(this,ct.extend({},t),o);(i||Et.get(this,"finish"))&&e.stop(!0)};return a.finish=a,i||!1===o.queue?this.each(a):this.queue(o.queue,a)},stop:function(t,e,n){var r=function(t){var e=t.stop;delete t.stop,e(n)};return"string"!=typeof t&&(n=e,e=t,t=void 0),e&&!1!==t&&this.queue(t||"fx",[]),this.each(function(){var e=!0,i=null!=t&&t+"queueHooks",o=ct.timers,a=Et.get(this);if(i)a[i]&&a[i].stop&&r(a[i]);else for(i in a)a[i]&&a[i].stop&&le.test(i)&&r(a[i]);for(i=o.length;i--;)o[i].elem!==this||null!=t&&o[i].queue!==t||(o[i].anim.stop(n),e=!1,o.splice(i,1));!e&&n||ct.dequeue(this,t)})},finish:function(t){return!1!==t&&(t=t||"fx"),this.each(function(){var e,n=Et.get(this),r=n[t+"queue"],i=n[t+"queueHooks"],o=ct.timers,a=r?r.length:0;for(n.finish=!0,ct.queue(this,t,[]),i&&i.stop&&i.stop.call(this,!0),e=o.length;e--;)o[e].elem===this&&o[e].queue===t&&(o[e].anim.stop(!0),o.splice(e,1));for(e=0;e<a;e++)r[e]&&r[e].finish&&r[e].finish.call(this);delete n.finish})}}),ct.each(["toggle","show","hide"],function(t,e){var n=ct.fn[e];ct.fn[e]=function(t,r,i){return null==t||"boolean"==typeof t?n.apply(this,arguments):this.animate(R(e,!0),t,r,i)}}),ct.each({slideDown:R("show"),slideUp:R("hide"),slideToggle:R("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,e){ct.fn[t]=function(t,n,r){return this.animate(e,t,n,r)}}),ct.timers=[],ct.fx.tick=function(){var t,e=0,n=ct.timers;for(ue=ct.now();e<n.length;e++)(t=n[e])()||n[e]!==t||n.splice(e--,1);n.length||ct.fx.stop(),ue=void 0},ct.fx.timer=function(t){ct.timers.push(t),t()?ct.fx.start():ct.timers.pop()},ct.fx.interval=13,ct.fx.start=function(){se||(se=n.setInterval(ct.fx.tick,ct.fx.interval))},ct.fx.stop=function(){n.clearInterval(se),se=null},ct.fx.speeds={slow:600,fast:200,_default:400},ct.fn.delay=function(t,e){return t=ct.fx?ct.fx.speeds[t]||t:t,e=e||"fx",this.queue(e,function(e,r){var i=n.setTimeout(e,t);r.stop=function(){n.clearTimeout(i)}})},function(){var t=Q.createElement("input"),e=Q.createElement("select"),n=e.appendChild(Q.createElement("option"));t.type="checkbox",ut.checkOn=""!==t.value,ut.optSelected=n.selected,e.disabled=!0,ut.optDisabled=!n.disabled,t=Q.createElement("input"),t.value="t",t.type="radio",ut.radioValue="t"===t.value}();var fe,pe=ct.expr.attrHandle;ct.fn.extend({attr:function(t,e){return Dt(this,ct.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each(function(){ct.removeAttr(this,t)})}}),ct.extend({attr:function(t,e,n){var r,i,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return void 0===t.getAttribute?ct.prop(t,e,n):(1===o&&ct.isXMLDoc(t)||(e=e.toLowerCase(),i=ct.attrHooks[e]||(ct.expr.match.bool.test(e)?fe:void 0)),void 0!==n?null===n?void ct.removeAttr(t,e):i&&"set"in i&&void 0!==(r=i.set(t,n,e))?r:(t.setAttribute(e,n+""),n):i&&"get"in i&&null!==(r=i.get(t,e))?r:(r=ct.find.attr(t,e),null==r?void 0:r))},attrHooks:{type:{set:function(t,e){if(!ut.radioValue&&"radio"===e&&ct.nodeName(t,"input")){var n=t.value;return t.setAttribute("type",e),n&&(t.value=n),e}}}},removeAttr:function(t,e){var n,r,i=0,o=e&&e.match(Ft);if(o&&1===t.nodeType)for(;n=o[i++];)r=ct.propFix[n]||n,ct.expr.match.bool.test(n)&&(t[r]=!1),t.removeAttribute(n)}}),fe={set:function(t,e,n){return!1===e?ct.removeAttr(t,n):t.setAttribute(n,n),n}},ct.each(ct.expr.match.bool.source.match(/\\w+/g),function(t,e){var n=pe[e]||ct.find.attr;pe[e]=function(t,e,r){var i,o;return r||(o=pe[e],pe[e]=i,i=null!=n(t,e,r)?e.toLowerCase():null,pe[e]=o),i}});var he=/^(?:input|select|textarea|button)$/i,de=/^(?:a|area)$/i;ct.fn.extend({prop:function(t,e){return Dt(this,ct.prop,t,e,arguments.length>1)},removeProp:function(t){return this.each(function(){delete this[ct.propFix[t]||t]})}}),ct.extend({prop:function(t,e,n){var r,i,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&ct.isXMLDoc(t)||(e=ct.propFix[e]||e,i=ct.propHooks[e]),void 0!==n?i&&"set"in i&&void 0!==(r=i.set(t,n,e))?r:t[e]=n:i&&"get"in i&&null!==(r=i.get(t,e))?r:t[e]},propHooks:{tabIndex:{get:function(t){var e=ct.find.attr(t,"tabindex");return e?parseInt(e,10):he.test(t.nodeName)||de.test(t.nodeName)&&t.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),ut.optSelected||(ct.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null},set:function(t){var e=t.parentNode;e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex)}}),ct.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){ct.propFix[this.toLowerCase()]=this});var ye=/[\\t\\r\\n\\f]/g;ct.fn.extend({addClass:function(t){var e,n,r,i,o,a,u,s=0;if(ct.isFunction(t))return this.each(function(e){ct(this).addClass(t.call(this,e,q(this)))});if("string"==typeof t&&t)for(e=t.match(Ft)||[];n=this[s++];)if(i=q(n),r=1===n.nodeType&&(" "+i+" ").replace(ye," ")){for(a=0;o=e[a++];)r.indexOf(" "+o+" ")<0&&(r+=o+" ");u=ct.trim(r),i!==u&&n.setAttribute("class",u)}return this},removeClass:function(t){var e,n,r,i,o,a,u,s=0;if(ct.isFunction(t))return this.each(function(e){ct(this).removeClass(t.call(this,e,q(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof t&&t)for(e=t.match(Ft)||[];n=this[s++];)if(i=q(n),r=1===n.nodeType&&(" "+i+" ").replace(ye," ")){for(a=0;o=e[a++];)for(;r.indexOf(" "+o+" ")>-1;)r=r.replace(" "+o+" "," ");u=ct.trim(r),i!==u&&n.setAttribute("class",u)}return this},toggleClass:function(t,e){var n=typeof t;return"boolean"==typeof e&&"string"===n?e?this.addClass(t):this.removeClass(t):ct.isFunction(t)?this.each(function(n){ct(this).toggleClass(t.call(this,n,q(this),e),e)}):this.each(function(){var e,r,i,o;if("string"===n)for(r=0,i=ct(this),o=t.match(Ft)||[];e=o[r++];)i.hasClass(e)?i.removeClass(e):i.addClass(e);else void 0!==t&&"boolean"!==n||(e=q(this),e&&Et.set(this,"__className__",e),this.setAttribute&&this.setAttribute("class",e||!1===t?"":Et.get(this,"__className__")||""))})},hasClass:function(t){var e,n,r=0;for(e=" "+t+" ";n=this[r++];)if(1===n.nodeType&&(" "+q(n)+" ").replace(ye," ").indexOf(e)>-1)return!0;return!1}});var me=/\\r/g,ge=/[\\x20\\t\\r\\n\\f]+/g;ct.fn.extend({val:function(t){var e,n,r,i=this[0];{if(arguments.length)return r=ct.isFunction(t),this.each(function(n){var i;1===this.nodeType&&(i=r?t.call(this,n,ct(this).val()):t,null==i?i="":"number"==typeof i?i+="":ct.isArray(i)&&(i=ct.map(i,function(t){return null==t?"":t+""})),(e=ct.valHooks[this.type]||ct.valHooks[this.nodeName.toLowerCase()])&&"set"in e&&void 0!==e.set(this,i,"value")||(this.value=i))});if(i)return(e=ct.valHooks[i.type]||ct.valHooks[i.nodeName.toLowerCase()])&&"get"in e&&void 0!==(n=e.get(i,"value"))?n:(n=i.value,"string"==typeof n?n.replace(me,""):null==n?"":n)}}}),ct.extend({valHooks:{option:{get:function(t){var e=ct.find.attr(t,"value");return null!=e?e:ct.trim(ct.text(t)).replace(ge," ")}},select:{get:function(t){for(var e,n,r=t.options,i=t.selectedIndex,o="select-one"===t.type||i<0,a=o?null:[],u=o?i+1:r.length,s=i<0?u:o?i:0;s<u;s++)if(n=r[s],(n.selected||s===i)&&(ut.optDisabled?!n.disabled:null===n.getAttribute("disabled"))&&(!n.parentNode.disabled||!ct.nodeName(n.parentNode,"optgroup"))){if(e=ct(n).val(),o)return e;a.push(e)}return a},set:function(t,e){for(var n,r,i=t.options,o=ct.makeArray(e),a=i.length;a--;)r=i[a],(r.selected=ct.inArray(ct.valHooks.option.get(r),o)>-1)&&(n=!0);return n||(t.selectedIndex=-1),o}}}}),ct.each(["radio","checkbox"],function(){ct.valHooks[this]={set:function(t,e){if(ct.isArray(e))return t.checked=ct.inArray(ct(t).val(),e)>-1}},ut.checkOn||(ct.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})});var ve=/^(?:focusinfocus|focusoutblur)$/;ct.extend(ct.event,{trigger:function(t,e,r,i){var o,a,u,s,c,l,f,p=[r||Q],h=at.call(t,"type")?t.type:t,d=at.call(t,"namespace")?t.namespace.split("."):[];if(a=u=r=r||Q,3!==r.nodeType&&8!==r.nodeType&&!ve.test(h+ct.event.triggered)&&(h.indexOf(".")>-1&&(d=h.split("."),h=d.shift(),d.sort()),c=h.indexOf(":")<0&&"on"+h,t=t[ct.expando]?t:new ct.Event(h,"object"==typeof t&&t),t.isTrigger=i?2:3,t.namespace=d.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\\\.)"+d.join("\\\\.(?:.*\\\\.|)")+"(\\\\.|$)"):null,t.result=void 0,t.target||(t.target=r),e=null==e?[t]:ct.makeArray(e,[t]),f=ct.event.special[h]||{},i||!f.trigger||!1!==f.trigger.apply(r,e))){if(!i&&!f.noBubble&&!ct.isWindow(r)){for(s=f.delegateType||h,ve.test(s+h)||(a=a.parentNode);a;a=a.parentNode)p.push(a),u=a;u===(r.ownerDocument||Q)&&p.push(u.defaultView||u.parentWindow||n)}for(o=0;(a=p[o++])&&!t.isPropagationStopped();)t.type=o>1?s:f.bindType||h,l=(Et.get(a,"events")||{})[t.type]&&Et.get(a,"handle"),l&&l.apply(a,e),(l=c&&a[c])&&l.apply&&kt(a)&&(t.result=l.apply(a,e),!1===t.result&&t.preventDefault());return t.type=h,i||t.isDefaultPrevented()||f._default&&!1!==f._default.apply(p.pop(),e)||!kt(r)||c&&ct.isFunction(r[h])&&!ct.isWindow(r)&&(u=r[c],u&&(r[c]=null),ct.event.triggered=h,r[h](),ct.event.triggered=void 0,u&&(r[c]=u)),t.result}},simulate:function(t,e,n){var r=ct.extend(new ct.Event,n,{type:t,isSimulated:!0});ct.event.trigger(r,null,e)}}),ct.fn.extend({trigger:function(t,e){return this.each(function(){ct.event.trigger(t,e,this)})},triggerHandler:function(t,e){var n=this[0];if(n)return ct.event.trigger(t,e,n,!0)}}),ct.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(t,e){ct.fn[e]=function(t,n){return arguments.length>0?this.on(e,null,t,n):this.trigger(e)}}),ct.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}}),ut.focusin="onfocusin"in n,ut.focusin||ct.each({focus:"focusin",blur:"focusout"},function(t,e){var n=function(t){ct.event.simulate(e,t.target,ct.event.fix(t))};ct.event.special[e]={setup:function(){var r=this.ownerDocument||this,i=Et.access(r,e);i||r.addEventListener(t,n,!0),Et.access(r,e,(i||0)+1)},teardown:function(){var r=this.ownerDocument||this,i=Et.access(r,e)-1;i?Et.access(r,e,i):(r.removeEventListener(t,n,!0),Et.remove(r,e))}}});var _e=n.location,be=ct.now(),Me=/\\?/;ct.parseJSON=function(t){return JSON.parse(t+"")},ct.parseXML=function(t){var e;if(!t||"string"!=typeof t)return null;try{e=(new n.DOMParser).parseFromString(t,"text/xml")}catch(t){e=void 0}return e&&!e.getElementsByTagName("parsererror").length||ct.error("Invalid XML: "+t),e};var we=/#.*$/,xe=/([?&])_=[^&]*/,Fe=/^(.*?):[ \\t]*([^\\r\\n]*)$/gm,Se=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,De=/^(?:GET|HEAD)$/,ke=/^\\/\\//,Ee={},Ce={},Te="*/".concat("*"),Ne=Q.createElement("a");Ne.href=_e.href,ct.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:_e.href,type:"GET",isLocal:Se.test(_e.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Te,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\\bxml\\b/,html:/\\bhtml/,json:/\\bjson\\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":ct.parseJSON,"text xml":ct.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?G(G(t,ct.ajaxSettings),e):G(ct.ajaxSettings,t)},ajaxPrefilter:U(Ee),ajaxTransport:U(Ce),ajax:function(t,e){function r(t,e,r,u){var c,f,v,_,M,x=e;2!==b&&(b=2,s&&n.clearTimeout(s),i=void 0,a=u||"",w.readyState=t>0?4:0,c=t>=200&&t<300||304===t,r&&(_=J(p,w,r)),_=V(p,_,w,c),c?(p.ifModified&&(M=w.getResponseHeader("Last-Modified"),M&&(ct.lastModified[o]=M),(M=w.getResponseHeader("etag"))&&(ct.etag[o]=M)),204===t||"HEAD"===p.type?x="nocontent":304===t?x="notmodified":(x=_.state,f=_.data,v=_.error,c=!v)):(v=x,!t&&x||(x="error",t<0&&(t=0))),w.status=t,w.statusText=(e||x)+"",c?y.resolveWith(h,[f,x,w]):y.rejectWith(h,[w,x,v]),w.statusCode(g),g=void 0,l&&d.trigger(c?"ajaxSuccess":"ajaxError",[w,p,c?f:v]),m.fireWith(h,[w,x]),l&&(d.trigger("ajaxComplete",[w,p]),--ct.active||ct.event.trigger("ajaxStop")))}"object"==typeof t&&(e=t,t=void 0),e=e||{};var i,o,a,u,s,c,l,f,p=ct.ajaxSetup({},e),h=p.context||p,d=p.context&&(h.nodeType||h.jquery)?ct(h):ct.event,y=ct.Deferred(),m=ct.Callbacks("once memory"),g=p.statusCode||{},v={},_={},b=0,M="canceled",w={readyState:0,getResponseHeader:function(t){var e;if(2===b){if(!u)for(u={};e=Fe.exec(a);)u[e[1].toLowerCase()]=e[2];e=u[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return 2===b?a:null},setRequestHeader:function(t,e){var n=t.toLowerCase();return b||(t=_[n]=_[n]||t,v[t]=e),this},overrideMimeType:function(t){return b||(p.mimeType=t),this},statusCode:function(t){var e;if(t)if(b<2)for(e in t)g[e]=[g[e],t[e]];else w.always(t[w.status]);return this},abort:function(t){var e=t||M;return i&&i.abort(e),r(0,e),this}};if(y.promise(w).complete=m.add,w.success=w.done,w.error=w.fail,p.url=((t||p.url||_e.href)+"").replace(we,"").replace(ke,_e.protocol+"//"),p.type=e.method||e.type||p.method||p.type,p.dataTypes=ct.trim(p.dataType||"*").toLowerCase().match(Ft)||[""],null==p.crossDomain){c=Q.createElement("a");try{c.href=p.url,c.href=c.href,p.crossDomain=Ne.protocol+"//"+Ne.host!=c.protocol+"//"+c.host}catch(t){p.crossDomain=!0}}if(p.data&&p.processData&&"string"!=typeof p.data&&(p.data=ct.param(p.data,p.traditional)),Y(Ee,p,e,w),2===b)return w;l=ct.event&&p.global,l&&0==ct.active++&&ct.event.trigger("ajaxStart"),p.type=p.type.toUpperCase(),p.hasContent=!De.test(p.type),o=p.url,p.hasContent||(p.data&&(o=p.url+=(Me.test(o)?"&":"?")+p.data,delete p.data),!1===p.cache&&(p.url=xe.test(o)?o.replace(xe,"$1_="+be++):o+(Me.test(o)?"&":"?")+"_="+be++)),p.ifModified&&(ct.lastModified[o]&&w.setRequestHeader("If-Modified-Since",ct.lastModified[o]),ct.etag[o]&&w.setRequestHeader("If-None-Match",ct.etag[o])),(p.data&&p.hasContent&&!1!==p.contentType||e.contentType)&&w.setRequestHeader("Content-Type",p.contentType),w.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+Te+"; q=0.01":""):p.accepts["*"]);for(f in p.headers)w.setRequestHeader(f,p.headers[f]);if(p.beforeSend&&(!1===p.beforeSend.call(h,w,p)||2===b))return w.abort();M="abort";for(f in{success:1,error:1,complete:1})w[f](p[f]);if(i=Y(Ce,p,e,w)){if(w.readyState=1,l&&d.trigger("ajaxSend",[w,p]),2===b)return w;p.async&&p.timeout>0&&(s=n.setTimeout(function(){w.abort("timeout")},p.timeout));try{b=1,i.send(v,r)}catch(t){if(!(b<2))throw t;r(-1,t)}}else r(-1,"No Transport");return w},getJSON:function(t,e,n){return ct.get(t,e,n,"json")},getScript:function(t,e){return ct.get(t,void 0,e,"script")}}),ct.each(["get","post"],function(t,e){ct[e]=function(t,n,r,i){return ct.isFunction(n)&&(i=i||r,r=n,n=void 0),ct.ajax(ct.extend({url:t,type:e,dataType:i,data:n,success:r},ct.isPlainObject(t)&&t))}}),ct._evalUrl=function(t){return ct.ajax({url:t,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})},ct.fn.extend({wrapAll:function(t){var e;return ct.isFunction(t)?this.each(function(e){ct(this).wrapAll(t.call(this,e))}):(this[0]&&(e=ct(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t}).append(this)),this)},wrapInner:function(t){return ct.isFunction(t)?this.each(function(e){ct(this).wrapInner(t.call(this,e))}):this.each(function(){var e=ct(this),n=e.contents();n.length?n.wrapAll(t):e.append(t)})},wrap:function(t){var e=ct.isFunction(t);return this.each(function(n){ct(this).wrapAll(e?t.call(this,n):t)})},unwrap:function(){return this.parent().each(function(){ct.nodeName(this,"body")||ct(this).replaceWith(this.childNodes)}).end()}}),ct.expr.filters.hidden=function(t){return!ct.expr.filters.visible(t)},ct.expr.filters.visible=function(t){return t.offsetWidth>0||t.offsetHeight>0||t.getClientRects().length>0};var Oe=/%20/g,Ae=/\\[\\]$/,je=/\\r?\\n/g,Pe=/^(?:submit|button|image|reset|file)$/i,Ie=/^(?:input|select|textarea|keygen)/i;ct.param=function(t,e){var n,r=[],i=function(t,e){e=ct.isFunction(e)?e():null==e?"":e,r[r.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)};if(void 0===e&&(e=ct.ajaxSettings&&ct.ajaxSettings.traditional),ct.isArray(t)||t.jquery&&!ct.isPlainObject(t))ct.each(t,function(){i(this.name,this.value)});else for(n in t)K(n,t[n],e,i);return r.join("&").replace(Oe,"+")},ct.fn.extend({serialize:function(){return ct.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=ct.prop(this,"elements");return t?ct.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!ct(this).is(":disabled")&&Ie.test(this.nodeName)&&!Pe.test(t)&&(this.checked||!It.test(t))}).map(function(t,e){var n=ct(this).val();return null==n?null:ct.isArray(n)?ct.map(n,function(t){return{name:e.name,value:t.replace(je,"\\r\\n")}}):{name:e.name,value:n.replace(je,"\\r\\n")}}).get()}}),ct.ajaxSettings.xhr=function(){try{return new n.XMLHttpRequest}catch(t){}};var He={0:200,1223:204},Le=ct.ajaxSettings.xhr();ut.cors=!!Le&&"withCredentials"in Le,ut.ajax=Le=!!Le,ct.ajaxTransport(function(t){var e,r;if(ut.cors||Le&&!t.crossDomain)return{send:function(i,o){var a,u=t.xhr();if(u.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(a in t.xhrFields)u[a]=t.xhrFields[a];t.mimeType&&u.overrideMimeType&&u.overrideMimeType(t.mimeType),t.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");for(a in i)u.setRequestHeader(a,i[a]);e=function(t){return function(){e&&(e=r=u.onload=u.onerror=u.onabort=u.onreadystatechange=null,"abort"===t?u.abort():"error"===t?"number"!=typeof u.status?o(0,"error"):o(u.status,u.statusText):o(He[u.status]||u.status,u.statusText,"text"!==(u.responseType||"text")||"string"!=typeof u.responseText?{binary:u.response}:{text:u.responseText},u.getAllResponseHeaders()))}},u.onload=e(),r=u.onerror=e("error"),void 0!==u.onabort?u.onabort=r:u.onreadystatechange=function(){4===u.readyState&&n.setTimeout(function(){e&&r()})},e=e("abort");try{u.send(t.hasContent&&t.data||null)}catch(t){if(e)throw t}},abort:function(){e&&e()}}}),ct.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\\b(?:java|ecma)script\\b/},converters:{"text script":function(t){return ct.globalEval(t),t}}}),ct.ajaxPrefilter("script",function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")}),ct.ajaxTransport("script",function(t){if(t.crossDomain){var e,n;return{send:function(r,i){e=ct("<script>").prop({charset:t.scriptCharset,src:t.url}).on("load error",n=function(t){e.remove(),n=null,t&&i("error"===t.type?404:200,t.type)}),Q.head.appendChild(e[0])},abort:function(){n&&n()}}}});var Re=[],$e=/(=)\\?(?=&|$)|\\?\\?/;ct.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=Re.pop()||ct.expando+"_"+be++;return this[t]=!0,t}}),ct.ajaxPrefilter("json jsonp",function(t,e,r){var i,o,a,u=!1!==t.jsonp&&($e.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&$e.test(t.data)&&"data");if(u||"jsonp"===t.dataTypes[0])return i=t.jsonpCallback=ct.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,u?t[u]=t[u].replace($e,"$1"+i):!1!==t.jsonp&&(t.url+=(Me.test(t.url)?"&":"?")+t.jsonp+"="+i),t.converters["script json"]=function(){return a||ct.error(i+" was not called"),a[0]},t.dataTypes[0]="json",o=n[i],n[i]=function(){a=arguments},r.always(function(){void 0===o?ct(n).removeProp(i):n[i]=o,t[i]&&(t.jsonpCallback=e.jsonpCallback,Re.push(i)),a&&ct.isFunction(o)&&o(a[0]),a=o=void 0}),"script"}),ct.parseHTML=function(t,e,n){if(!t||"string"!=typeof t)return null;"boolean"==typeof e&&(n=e,e=!1),e=e||Q;var r=vt.exec(t),i=!n&&[];return r?[e.createElement(r[1])]:(r=m([t],e,i),i&&i.length&&ct(i).remove(),ct.merge([],r.childNodes))};var ze=ct.fn.load;ct.fn.load=function(t,e,n){if("string"!=typeof t&&ze)return ze.apply(this,arguments);var r,i,o,a=this,u=t.indexOf(" ");return u>-1&&(r=ct.trim(t.slice(u)),t=t.slice(0,u)),ct.isFunction(e)?(n=e,e=void 0):e&&"object"==typeof e&&(i="POST"),a.length>0&&ct.ajax({url:t,type:i||"GET",dataType:"html",data:e}).done(function(t){o=arguments,a.html(r?ct("<div>").append(ct.parseHTML(t)).find(r):t)}).always(n&&function(t,e){a.each(function(){n.apply(this,o||[t.responseText,e,t])})}),this},ct.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){ct.fn[e]=function(t){return this.on(e,t)}}),ct.expr.filters.animated=function(t){return ct.grep(ct.timers,function(e){return t===e.elem}).length},ct.offset={setOffset:function(t,e,n){var r,i,o,a,u,s,c,l=ct.css(t,"position"),f=ct(t),p={};"static"===l&&(t.style.position="relative"),u=f.offset(),o=ct.css(t,"top"),s=ct.css(t,"left"),c=("absolute"===l||"fixed"===l)&&(o+s).indexOf("auto")>-1,c?(r=f.position(),a=r.top,i=r.left):(a=parseFloat(o)||0,i=parseFloat(s)||0),ct.isFunction(e)&&(e=e.call(t,n,ct.extend({},u))),null!=e.top&&(p.top=e.top-u.top+a),null!=e.left&&(p.left=e.left-u.left+i),"using"in e?e.using.call(t,p):f.css(p)}},ct.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){ct.offset.setOffset(this,t,e)});var e,n,r=this[0],i={top:0,left:0},o=r&&r.ownerDocument;if(o)return e=o.documentElement,ct.contains(e,r)?(i=r.getBoundingClientRect(),n=X(o),{top:i.top+n.pageYOffset-e.clientTop,left:i.left+n.pageXOffset-e.clientLeft}):i},position:function(){if(this[0]){var t,e,n=this[0],r={top:0,left:0};return"fixed"===ct.css(n,"position")?e=n.getBoundingClientRect():(t=this.offsetParent(),e=this.offset(),ct.nodeName(t[0],"html")||(r=t.offset()),r.top+=ct.css(t[0],"borderTopWidth",!0),r.left+=ct.css(t[0],"borderLeftWidth",!0)),{top:e.top-r.top-ct.css(n,"marginTop",!0),left:e.left-r.left-ct.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent;t&&"static"===ct.css(t,"position");)t=t.offsetParent;return t||ee})}}),ct.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,e){var n="pageYOffset"===e;ct.fn[t]=function(r){return Dt(this,function(t,r,i){var o=X(t);if(void 0===i)return o?o[e]:t[r];o?o.scrollTo(n?o.pageXOffset:i,n?i:o.pageYOffset):t[r]=i},t,r,arguments.length)}}),ct.each(["top","left"],function(t,e){ct.cssHooks[e]=N(ut.pixelPosition,function(t,n){if(n)return n=T(t,e),Zt.test(n)?ct(t).position()[e]+"px":n})}),ct.each({Height:"height",Width:"width"},function(t,e){ct.each({padding:"inner"+t,content:e,"":"outer"+t},function(n,r){ct.fn[r]=function(r,i){var o=arguments.length&&(n||"boolean"!=typeof r),a=n||(!0===r||!0===i?"margin":"border");return Dt(this,function(e,n,r){var i;return ct.isWindow(e)?e.document.documentElement["client"+t]:9===e.nodeType?(i=e.documentElement,Math.max(e.body["scroll"+t],i["scroll"+t],e.body["offset"+t],i["offset"+t],i["client"+t])):void 0===r?ct.css(e,n,a):ct.style(e,n,r,a)},e,o?r:void 0,o,null)}})}),ct.fn.extend({bind:function(t,e,n){return this.on(t,null,e,n)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,n,r){return this.on(e,t,n,r)},undelegate:function(t,e,n){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",n)},size:function(){return this.length}}),ct.fn.andSelf=ct.fn.addBack,r=[],void 0!==(i=function(){return ct}.apply(e,r))&&(t.exports=i);var We=n.jQuery,Be=n.$;return ct.noConflict=function(t){return n.$===ct&&(n.$=Be),t&&n.jQuery===ct&&(n.jQuery=We),ct},o||(n.jQuery=n.$=ct),ct})},function(t,e){function n(t){for(var e,n=0,r=0,i=t.length;r<i;r++)e=t.charCodeAt(r),e>=0&&e<=255?n++:n+=2;return n}function r(t,e){var n,r={};for(var i in t)n=e(t[i],i),r[n]=t[i];return r}function i(t){return t.replace(/&lt;/gi,"<").replace(/&gt;/gi,">").replace(/&amp;/gi,"&").replace(/&quot;/gi,\'"\').replace(/&apos;/gi,"\'")}function o(t){return t.replace(/^(\\s|&nbsp;)+/g,"")}function a(t){return t.replace(/(\\s|&nbsp;)+$/g,"")}function u(t){return t=o(t),t=a(t)}t.exports={strLen:n,mapKeys:r,unescapeHTML:i,trimLeft:o,trimRight:a,trim:u}},function(t,e,n){(function(e){function r(t){return"string"==typeof t&&"="===t[0]}function i(t){return"string"!=typeof t&&(t=t.toString()),t.indexOf("$")>-1}function o(t){t=t.toUpperCase();var e=null;try{e=c.parsePosition(t)}catch(t){}return e}function a(t){window.cow.currentSheetId=t}function u(t){var e=window.cow.currentFile.guid+":sheet";t?l.set(e,t):l.remove(e)}function s(t){window.cow.currentSheetId=t,u(t);var n,r,i;if(n=location.pathname,"/"===n.substr(0,1)&&(n=n.slice(1)),r=n.split("/"),t)2===r.length?r.push(t):3===r.length&&(r[2]=t),i="/"+r.join("/"),e.replace(i,null,!1,!1);else{var o=r[0];3===r.length&&"m"!==o&&"rn"!==o&&(r.splice(2,1),i="/"+r.join("/"),e.replace(i,null,!1,!1))}}var c=n(1),l=n(34);t.exports={isFormula:r,isAbsoluteReference:i,parsePosition:o,setCurrentSheetId:s,setCurSheetIdOnly:a}}).call(e,n(33))},function(t,e){!function(n){if("object"==typeof e&&void 0!==t)t.exports=n();else if("function"==typeof define&&define.amd)define([],n);else{var r;"undefined"!=typeof window?r=window:"undefined"!=typeof global?r=global:"undefined"!=typeof self&&(r=self),r.page=n()}}(function(){return function t(e,n,r){function i(a,u){if(!n[a]){if(!e[a]){var s="function"==typeof require&&require;if(!u&&s)return s(a,!0);if(o)return o(a,!0);var c=new Error("Cannot find module \'"+a+"\'");throw c.code="MODULE_NOT_FOUND",c}var l=n[a]={exports:{}};e[a][0].call(l.exports,function(t){var n=e[a][1][t];return i(n||t)},l,l.exports,t,e,n,r)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(t,e,n){(function(n){"use strict";function r(t,e){if("function"==typeof t)return r("*",t);if("function"==typeof e)for(var n=new u(t),i=1;i<arguments.length;++i)r.callbacks.push(n.middleware(arguments[i]));else"string"==typeof t?r["string"==typeof e?"redirect":"show"](t,e):r.start(t)}function i(t){if(!t.handled){var e;e=_?v+y.hash.replace("#!",""):y.pathname+y.search,e!==t.canonicalPath&&(r.stop(),t.handled=!1,y.href=t.canonicalPath)}}function o(t){return"string"!=typeof t?t:g?decodeURIComponent(t.replace(/\\+/g," ")):t}function a(t,e){"/"===t[0]&&0!==t.indexOf(v)&&(t=v+(_?"#!":"")+t);var n=t.indexOf("?");if(this.canonicalPath=t,this.path=t.replace(v,"")||"/",_&&(this.path=this.path.replace("#!","")||"/"),this.title=document.title,this.state=e||{},this.state.path=t,this.querystring=~n?o(t.slice(n+1)):"",this.pathname=o(~n?t.slice(0,n):t),this.params={},this.hash="",!_){if(!~this.path.indexOf("#"))return;var r=this.path.split("#");this.path=r[0],this.hash=o(r[1])||"",this.querystring=this.querystring.split("#")[0]}}function u(t,e){e=e||{},this.path="*"===t?"(.*)":t,this.method="GET",this.regexp=f(this.path,this.keys=[],e)}function s(t){if(1===c(t)&&!(t.metaKey||t.ctrlKey||t.shiftKey||t.defaultPrevented)){for(var e=t.path?t.path[0]:t.target;e&&"A"!==e.nodeName;)e=e.parentNode;if(e&&"A"===e.nodeName&&!e.hasAttribute("download")&&"external"!==e.getAttribute("rel")){var i=e.getAttribute("href");if((_||e.pathname!==y.pathname||!e.hash&&"#"!==i)&&!(i&&i.indexOf("mailto:")>-1)&&!e.target&&l(e.href)){var o=e.pathname+e.search+(e.hash||"");void 0!==n&&o.match(/^\\/[a-zA-Z]:\\//)&&(o=o.replace(/^\\/[a-zA-Z]:\\//,"/"));var a=o;0===o.indexOf(v)&&(o=o.substr(v.length)),_&&(o=o.replace("#!","")),v&&a===o||(t.preventDefault(),r.show(a))}}}}function c(t){return t=t||window.event,null===t.which?t.button:t.which}function l(t){var e=y.protocol+"//"+y.hostname;return y.port&&(e+=":"+y.port),t&&0===t.indexOf(e)}var f=t("path-to-regexp");e.exports=r;var p,h,d="undefined"!=typeof document&&document.ontouchstart?"touchstart":"click",y="undefined"!=typeof window&&(window.history.location||window.location),m=!0,g=!0,v="",_=!1;r.callbacks=[],r.exits=[],r.current="",r.len=0,r.base=function(t){if(0===arguments.length)return v;v=t},r.start=function(t){if(t=t||{},!p&&(p=!0,!1===t.dispatch&&(m=!1),!1===t.decodeURLComponents&&(g=!1),!1!==t.popstate&&window.addEventListener("popstate",b,!1),!1!==t.click&&document.addEventListener(d,s,!1),!0===t.hashbang&&(_=!0),m)){var e=_&&~y.hash.indexOf("#!")?y.hash.substr(2)+y.search:y.pathname+y.search+y.hash;r.replace(e,null,!0,m)}},r.stop=function(){p&&(r.current="",r.len=0,p=!1,document.removeEventListener(d,s,!1),window.removeEventListener("popstate",b,!1))},r.show=function(t,e,n,i){var o=new a(t,e);return r.current=o.path,!1!==n&&r.dispatch(o),!1!==o.handled&&!1!==i&&o.pushState(),o},r.back=function(t,e){r.len>0?(history.back(),r.len--):t?setTimeout(function(){r.show(t,e)}):setTimeout(function(){r.show(v,e)})},r.redirect=function(t,e){"string"==typeof t&&"string"==typeof e&&r(t,function(t){setTimeout(function(){r.replace(e)},0)}),"string"==typeof t&&void 0===e&&setTimeout(function(){r.replace(t)},0)},r.replace=function(t,e,n,i){var o=new a(t,e);return r.current=o.path,o.init=n,o.save(),!1!==i&&r.dispatch(o),o},r.dispatch=function(t){function e(){var t=r.exits[u++];if(!t)return n();t(o,e)}function n(){var e=r.callbacks[a++];return t.path!==r.current?void(t.handled=!1):e?void e(t,n):i(t)}var o=h,a=0,u=0;h=t,o?e():n()},r.exit=function(t,e){if("function"==typeof t)return r.exit("*",t);for(var n=new u(t),i=1;i<arguments.length;++i)r.exits.push(n.middleware(arguments[i]))},r.Context=a,a.prototype.pushState=function(){r.len++,history.pushState(this.state,this.title,_&&"/"!==this.path?"#!"+this.path:this.canonicalPath)},a.prototype.save=function(){history.replaceState(this.state,this.title,_&&"/"!==this.path?"#!"+this.path:this.canonicalPath)},r.Route=u,u.prototype.middleware=function(t){var e=this;return function(n,r){if(e.match(n.path,n.params))return t(n,r);r()}},u.prototype.match=function(t,e){var n=this.keys,r=t.indexOf("?"),i=~r?t.slice(0,r):t,a=this.regexp.exec(decodeURIComponent(i));if(!a)return!1;for(var u=1,s=a.length;u<s;++u){var c=n[u-1],l=o(a[u]);void 0===l&&hasOwnProperty.call(e,c.name)||(e[c.name]=l)}return!0};var b=function(){var t=!1;if("undefined"!=typeof window)return"complete"===document.readyState?t=!0:window.addEventListener("load",function(){setTimeout(function(){t=!0},0)}),function(e){if(t)if(e.state){var n=e.state.path;r.replace(n,e.state)}else r.show(y.pathname+y.hash,void 0,void 0,!1)}}();r.sameOrigin=l}).call(this,t("_process"))},{_process:2,"path-to-regexp":3}],2:[function(t,e,n){function r(){}var i=e.exports={};i.nextTick=function(){var t="undefined"!=typeof window&&window.setImmediate,e="undefined"!=typeof window&&window.MutationObserver,n="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(t)return function(t){return window.setImmediate(t)};var r=[];if(e){var i=document.createElement("div");return new MutationObserver(function(){var t=r.slice();r.length=0,t.forEach(function(t){t()})}).observe(i,{attributes:!0}),function(t){r.length||i.setAttribute("yes","no"),r.push(t)}}return n?(window.addEventListener("message",function(t){var e=t.source;if((e===window||null===e)&&"process-tick"===t.data&&(t.stopPropagation(),r.length>0)){r.shift()()}},!0),function(t){r.push(t),window.postMessage("process-tick","*")}):function(t){setTimeout(t,0)}}(),i.title="browser",i.browser=!0,i.env={},i.argv=[],i.on=r,i.addListener=r,i.once=r,i.off=r,i.removeListener=r,i.removeAllListeners=r,i.emit=r,i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")}},{}],3:[function(t,e,n){function r(t){for(var e,n=[],r=0,i=0,o="";null!=(e=m.exec(t));){var a=e[0],s=e[1],c=e.index;if(o+=t.slice(i,c),i=c+a.length,s)o+=s[1];else{o&&(n.push(o),o="");var l=e[2],f=e[3],p=e[4],h=e[5],d=e[6],y=e[7],g="+"===d||"*"===d,v="?"===d||"*"===d,_=l||"/",b=p||h||(y?".*":"[^"+_+"]+?");n.push({name:f||r++,prefix:l||"",delimiter:_,optional:v,repeat:g,pattern:u(b)})}}return i<t.length&&(o+=t.substr(i)),o&&n.push(o),n}function i(t){return o(r(t))}function o(t){for(var e=new Array(t.length),n=0;n<t.length;n++)"object"==typeof t[n]&&(e[n]=new RegExp("^"+t[n].pattern+"$"));return function(n){for(var r="",i=n||{},o=0;o<t.length;o++){var a=t[o];if("string"!=typeof a){var u,s=i[a.name];if(null==s){if(a.optional)continue;throw new TypeError(\'Expected "\'+a.name+\'" to be defined\')}if(y(s)){if(!a.repeat)throw new TypeError(\'Expected "\'+a.name+\'" to not repeat, but received "\'+s+\'"\');if(0===s.length){if(a.optional)continue;throw new TypeError(\'Expected "\'+a.name+\'" to not be empty\')}for(var c=0;c<s.length;c++){if(u=encodeURIComponent(s[c]),!e[o].test(u))throw new TypeError(\'Expected all "\'+a.name+\'" to match "\'+a.pattern+\'", but received "\'+u+\'"\');r+=(0===c?a.prefix:a.delimiter)+u}}else{if(u=encodeURIComponent(s),!e[o].test(u))throw new TypeError(\'Expected "\'+a.name+\'" to match "\'+a.pattern+\'", but received "\'+u+\'"\');r+=a.prefix+u}}else r+=a}return r}}function a(t){return t.replace(/([.+*?=^!:${}()[\\]|\\/])/g,"\\\\$1")}function u(t){return t.replace(/([=!:$\\/()])/g,"\\\\$1")}function s(t,e){return t.keys=e,t}function c(t){return t.sensitive?"":"i"}function l(t,e){var n=t.source.match(/\\((?!\\?)/g);if(n)for(var r=0;r<n.length;r++)e.push({name:r,prefix:null,delimiter:null,optional:!1,repeat:!1,pattern:null});return s(t,e)}function f(t,e,n){for(var r=[],i=0;i<t.length;i++)r.push(d(t[i],e,n).source);return s(new RegExp("(?:"+r.join("|")+")",c(n)),e)}function p(t,e,n){for(var i=r(t),o=h(i,n),a=0;a<i.length;a++)"string"!=typeof i[a]&&e.push(i[a]);return s(o,e)}function h(t,e){e=e||{};for(var n=e.strict,r=!1!==e.end,i="",o=t[t.length-1],u="string"==typeof o&&/\\/$/.test(o),s=0;s<t.length;s++){var l=t[s];if("string"==typeof l)i+=a(l);else{var f=a(l.prefix),p=l.pattern;l.repeat&&(p+="(?:"+f+p+")*"),p=l.optional?f?"(?:"+f+"("+p+"))?":"("+p+")?":f+"("+p+")",i+=p}}return n||(i=(u?i.slice(0,-2):i)+"(?:\\\\/(?=$))?"),i+=r?"$":n&&u?"":"(?=\\\\/|$)",new RegExp("^"+i,c(e))}function d(t,e,n){return e=e||[],y(e)?n||(n={}):(n=e,e=[]),t instanceof RegExp?l(t,e,n):y(t)?f(t,e,n):p(t,e,n)}var y=t("isarray");e.exports=d,e.exports.parse=r,e.exports.compile=i,e.exports.tokensToFunction=o,e.exports.tokensToRegExp=h;var m=new RegExp(["(\\\\\\\\.)","([\\\\/.])?(?:(?:\\\\:(\\\\w+)(?:\\\\(((?:\\\\\\\\.|[^()])+)\\\\))?|\\\\(((?:\\\\\\\\.|[^()])+)\\\\))([+*?])?|(\\\\*))"].join("|"),"g")},{isarray:4}],4:[function(t,e,n){e.exports=Array.isArray||function(t){return"[object Array]"==Object.prototype.toString.call(t)}},{}]},{},[1])(1)})},function(t,e,n){var r,i;!function(o){var a=!1;if(r=o,void 0!==(i="function"==typeof r?r.call(e,n,e,t):r)&&(t.exports=i),a=!0,t.exports=o(),a=!0,!a){var u=window.Cookies,s=window.Cookies=o();s.noConflict=function(){return window.Cookies=u,s}}}(function(){function t(){for(var t=0,e={};t<arguments.length;t++){var n=arguments[t];for(var r in n)e[r]=n[r]}return e}function e(n){function r(e,i,o){var a;if("undefined"!=typeof document){if(arguments.length>1){if(o=t({path:"/"},r.defaults,o),"number"==typeof o.expires){var u=new Date;u.setMilliseconds(u.getMilliseconds()+864e5*o.expires),o.expires=u}o.expires=o.expires?o.expires.toUTCString():"";try{a=JSON.stringify(i),/^[\\{\\[]/.test(a)&&(i=a)}catch(t){}i=n.write?n.write(i,e):encodeURIComponent(String(i)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),e=encodeURIComponent(String(e)),e=e.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent),e=e.replace(/[\\(\\)]/g,escape);var s="";for(var c in o)o[c]&&(s+="; "+c,!0!==o[c]&&(s+="="+o[c]));return document.cookie=e+"="+i+s}e||(a={});for(var l=document.cookie?document.cookie.split("; "):[],f=/(%[0-9A-Z]{2})+/g,p=0;p<l.length;p++){var h=l[p].split("="),d=h.slice(1).join("=");\'"\'===d.charAt(0)&&(d=d.slice(1,-1));try{var y=h[0].replace(f,decodeURIComponent);if(d=n.read?n.read(d,y):n(d,y)||d.replace(f,decodeURIComponent),this.json)try{d=JSON.parse(d)}catch(t){}if(e===y){a=d;break}e||(a[y]=d)}catch(t){}}return a}}return r.set=r,r.get=function(t){return r.call(r,t)},r.getJSON=function(){return r.apply({json:!0},[].slice.call(arguments))},r.defaults={},r.remove=function(e,n){r(e,"",t(n,{expires:-1}))},r.withConverter=e,r}return e(function(){})})},function(t,e,n){(function(t){function r(t){return t&&t.__esModule?t:{default:t}}function i(e){if(y[e])return y[e];var n=null,r=void 0,i=null;if((0,c.isBigNumber)(e))r=e;else{var o={},a=h.getPreferredDisplayFormatter(e.toString(),o);if(r=i=o.value,"General"===a.formatCached)t.isNumber(r)||(r=e);else{var u=a.formatters[0];n=u.formatCached,u._numberFormat._formatType===d&&(r=u.format(r)),s.INVERT_TEMP_NEW_FORMAT_MAP[n]&&(n=s.INVERT_TEMP_NEW_FORMAT_MAP[n])}t.isNil(r)&&(r="")}return y[e]={format:n,value:r,parsedVal:i},y[e]}function o(e){return t.isNil(e)?0:("number"==typeof e&&(e=new Date(e)),(1440*e.getTime()+3181192704e6-864e5*e.getTimezoneOffset())/124416e6)}function a(t){return t=o(t)<1?p(t,"HH:mm:ss"):0===t.getHours()&&0===t.getMinutes()&&0===t.getSeconds()&&0===t.getMilliseconds()?p(t,"yyyy/MM/dd"):p(t,"yyyy/MM/dd HH:mm:ss")}Object.defineProperty(e,"__esModule",{value:!0}),e.parseFormat=i,e.toOADate=o,e.getDateText=a;var u=n(36),s=n(42),c=n(12),l=n(13),f=r(l),p=f.default._localeFormat,h=new u.GeneralFormatter,d=2,y={}}).call(e,n(0))},function(t,e,n){function r(t,e,n){return t.substr(e,n)}function i(t){return T._isNullOrUndefined(t)?"":"boolean"==typeof t?t?"TRUE":"FALSE":"string"==typeof t?t:t.toString()}function o(t,e){if("\\\\"===t[e])throw new Error(H().Exp_InvalidBackslash);if(e-1>0&&e-1<t.length&&"\\\\"===t[e-1]){if(e-2<0)return!0;if(e-2>0&&e-2<t.length)return"\\\\"!==t[e-2]}return!1}function a(t){if(!t)throw new Error(H().Exp_TokenIsNull);return"["+t+"]"}function u(t){if(t===S||t===F||""===t)return t;for(var e="",n=0,r=0;r<t.length;r++){var i=t[r];"["===i?n++:"]"===i?--n<0&&(n=0):0===n&&(e+=i)}return e.toString()}function s(t){return t=c(t,"[",""),c(t,"]","")}function c(t,e,n){return!t||t===B._Empty||f(e,n,!0)?t:(e=e.replace(Y,"\\\\$1"),t.replace(new RegExp(e,"g"),n))}function l(t){for(var e=t.length,n=!1,r="",i=0;i<e;i++){var o=t.charAt(i);"\\\\"===o?(n=!n)||(r+=o):(n=!1,r+=o)}return r}function f(t,e,n){return n?z(t)===z(e):t===e}function p(t,e){1===arguments.length&&(e=!0);for(var n=!1,r="",i=0;i<t.length;i++){var a=t[i];if(\'"\'===a)n=!n;else if(!n&&!((e||"?"!==a&&"/"!==a)&&"_"!==a&&"*"!==a||o(t,i))){"_"===a&&i++;continue}r+=a}return r}function h(t,e){if(!t||t===B._Empty)return!1;for(var n=p(t),r="",i=!1,o=0,a=n.length;o<a;o++){var u=n[o];\'"\'===u&&(i=!i),"E"===u||i||(r+=z(u))}for(var s=0;s<e.length;s++)if(r===e[s]||r.indexOf(e[s])>=0)return!0;return!1}function d(t,e,n){this._partLocaleID=t,this._partDBNumberFormat=e,this.cultureName=n}function y(t){this._originalToken=t}function m(t){var e,n=s(t);return n&&n!==B._Empty?(["<",">","="].indexOf(n[0])>-1?(e=V,e.Name="ConditionalFormatPart"):E._startsWith(n,"DBNum",!0)?(e=Z,e.Name="DBNumberFormatPart"):f(n[0],"$",!1)?(e=Q,e.Name="LocaleIDFormatPart"):v(n)?(e=X,e.Name="ABSTimeFormatPart"):n.length>=3&&(e=K,e.Name="ColorFormatPart"),e):e}function g(t){var e,n=!1;return t=t?t.toString():B._Empty,h(t,["general"])?e=at:et._evaluateFormat(t)?e=et:h(t,["E+","E-","#",".",",","%","0","/"])?(n=!0,e=ot):(n=!0,e=it),{_isDigitalOrText:n,_type:e}}function v(t){var e=z(t),n=e[0];if("h"!==n&&"m"!==n&&"s"!==n)return!1;for(var r=1;r<e.length;r++)if(n!==e[r])return!1;return!0}function _(t,e,n){var r;r=t?t.cultureInfo():L(n);var i=r.NumberFormat.dbNumber;return i?i[e]:F}function b(t,e,n,r,i){var o=t;if(!A(r)&&e instanceof Date){var a=_(n,r.type,i);o=r._replaceNumberString(o,a,!0),1===r.type&&(o=o.replace(new RegExp(P,"g"),I)),o=o.replace("@"+nt._yearFourDigit,C._localeFormat(e,nt._yearFourDigit)),o=o.replace("@"+nt._yearTwoDigit,C._localeFormat(e,nt._yearTwoDigit)),o=r._replaceNumberString(o,a,!1)}return o}function M(t,e,n,r,i){if(!A(r)){var o=_(n,r.type,i);if(!A(o)){var a,u=r._replaceNumberString(t,o,e),s=L(i);return"ja-JP"===s.name()&&u.length>1&&("一千"===(a=u.substr(0,2))||"一百"===a||"一十"===a)&&(u=u.substr(1)),u}}return t}var w=n(37),x=n(41),F=null,S=void 0,D=Math.abs,k={},E=w._StringHelper,C=w._DateTimeHelper,T=w._Types,N=T._isType,O=w._NumberHelper,A=T._isNullOrUndefined,j=w.CultureManager,P="一十",I="十",H=function(){return w._getResource(k.SR)()},L=function(t){return j._getCultureInfo(t)},R=function(t){return L(t).DateTimeFormat},$=function(t){return L(t).NumberFormat},z=function(t){return t&&t.toLowerCase()},W=function(){throw new Error(H().Exp_FormatIllegal)},B={_Empty:"",_format:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(0===arguments.length)return F;for(var n=t[0],r=1;r<arguments.length;r++){var i=new RegExp("\\\\{"+(r-1)+"\\\\}","gm");n=n.replace(i,arguments[r])}return n},_isNullOrEmpty:function(t){return!t||t===B._Empty}},q={_isDigit:function(t){var e=t.charCodeAt(0);return e>=48&&e<=57},_isWhiteSpace:function(t){var e=t.charCodeAt(0);return e>=9&&e<=13||32===e||133===e||160===e}},U={_positive:0,_negative:1,_zero:2,_text:3},Y=new RegExp("([.+?*$^\\\\[\\\\](){}|/])","g"),G=[["M/d","MMM/d","MMMM/d","d/M","d/MMM","d/MMMM","M-d","MMM-d","MMMM-d","d-M","d-MMM","d-MMMM"],["M/y","MMM/y","M/yyyy","MMM/yyyy","M-y","MMM-y","M-yyyy","MMM-yyyy"],["M/d/y","MMM/d/y","MMMM/d/y","M/d/yyyy","MMM/d/yyyy","MMMM/d/yyyy","d/M/y","d/MMM/y","d/MMMM/y","d/M/yyyy","d/MMM/yyyy","d/MMMM/yyyy","yyyy/M/d","M-d-y","MMM-d-y","MMMM-d-y","M-d-yyyy","MMM-d-yyyy","MMMM-d-yyyy","d-M-y","d-MMM-y","d-MMMM-y","d-M-yyyy","d-MMM-yyyy","d-MMMM-yyyy","yyyy-M-d"],["H:m","h:m tt"],["H:m:s","h:m:s tt","H:m:s","h:mm:ss tt"],["H:m:s.FFF","h:m:s.FFF tt"],["M/d H:m","MMM/d H:m","MMMM/d H:m","d/M H:m","d/MMM H:m","d/MMMM H:m","M/y H:m","MMM/y H:m","M/yyyy H:m","MMM/yyyy H:m","M/d/y H:m","MMM/d/y H:m","MMMM/d/y H:m","M/d/yyyy H:m","MMM/d/yyyy H:m","MMMM/d/yyyy H:m","M-d H:m","MMM-d H:m","MMMM-d H:m","d-M H:m","d-MMM H:m","d-MMMM H:m","M-y H:m","MMM-y H:m","M-yyyy H:m","MMM-yyyy H:m","M-d-y H:m","MMM-d-y H:m","MMMM-d-y H:m","M-d-yyyy H:m","MMM-d-yyyy H:m","MMMM-d-yyyy H:m","M/d h:m tt","MMM/d h:m tt","MMMM/d h:m tt","d/M h:m tt","d/MMM h:m tt","d/MMMM h:m tt","M/y h:m tt","MMM/y h:m tt","M/yyyy h:m tt","MMM/yyyy h:m tt","M/d/y h:m tt","MMM/d/y h:m tt","MMMM/d/y h:m tt","M/d/yyyy h:m tt","MMM/d/yyyy h:m tt","MMMM/d/yyyy h:m tt","M-d h:m tt","MMM-d h:m tt","MMMM-d h:m tt","d-M h:m tt","d-MMM h:m tt","d-MMMM h:m tt","M-y h:m tt","MMM-y h:m tt","M-yyyy h:m tt","MMM-yyyy h:m tt","M-d-y h:m tt","MMM-d-y h:m tt","MMMM-d-y h:m tt","M-d-yyyy h:m tt","MMM-d-yyyy h:m tt","MMMM-d-yyyy h:m tt"],["M/d H:m:s","MMM/d H:m:s","MMMM/d H:m:s","d/M H:m:s","d/MMM H:m:s","d/MMMM H:m:s","M/y H:m:s","MMM/y H:m:s","M/yyyy H:m:s","MMM/yyyy H:m:s","M/d/y H:m:s","MMM/d/y H:m:s","MMMM/d/y H:m:s","M/d/yyyy H:m:s","MMM/d/yyyy H:m:s","MMMM/d/yyyy H:m:s","d/M/y H:m:s","d/MMM/y H:m:s","d/MMMM/y H:m:s","d/M/yyyy H:m:s","d/MMM/yyyy H:m:s","d/MMMM/yyyy H:m:s","yyyy/M/d H:m:s","M-d H:m:s","MMM-d H:m:s","MMMM-d H:m:s","d-M H:m:s","d-MMM H:m:s","d-MMMM H:m:s","M-y H:m:s","MMM-y H:m:s","M-yyyy H:m:s","MMM-yyyy H:m:s","M-d-y H:m:s","MMM-d-y H:m:s","MMMM-d-y H:m:s","M-d-yyyy H:m:s","MMM-d-yyyy H:m:s","MMMM-d-yyyy H:m:s","d-M-y H:m:s","d-MMM-y H:m:s","d-MMMM-y H:m:s","d-M-yyyy H:m:s","d-MMM-yyyy H:m:s","d-MMMM-yyyy H:m:s","yyyy-M-d H:m:s","M/d h:m:s tt","MMM/d h:m:s tt","MMMM/d h:m:s tt","d/M h:m:s tt","d/MMM h:m:s tt","d/MMMM h:m:s tt","M/y h:m:s tt","MMM/y h:m:s tt","M/yyyy h:m:s tt","MMM/yyyy h:m:s tt","M/d/y h:m:s tt","MMM/d/y h:m:s tt","MMMM/d/y h:m:s tt","M/d/yyyy h:m:s tt","MMM/d/yyyy h:m:s tt","MMMM/d/yyyy h:m:s tt","d/M/y h:m:s tt","d/MMM/y h:m:s tt","d/MMMM/y h:m:s tt","d/M/yyyy h:m:s tt","d/MMM/yyyy h:m:s tt","d/MMMM/yyyy h:m:s tt","yyyy/M/d h:m:s tt","M/d/yyyy h:mm:ss tt","M-d h:m:s tt","MMM-d h:m:s tt","MMMM-d h:m:s tt","d-M h:m:s tt","d-MMM h:m:s tt","d-MMMM h:m:s tt","M-y h:m:s tt","MMM-y h:m:s tt","M-yyyy h:m:s tt","MMM-yyyy h:m:s tt","M-d-y h:m:s tt","MMM-d-y h:m:s tt","MMMM-d-y h:m:s tt","M-d-yyyy h:m:s tt","MMM-d-yyyy h:m:s tt","MMMM-d-yyyy h:m:s tt","d-M-y h:m:s tt","d-MMM-y h:m:s tt","d-MMMM-y h:m:s tt","d-M-yyyy h:m:s tt","d-MMM-yyyy h:m:s tt","d-MMMM-yyyy h:m:s tt","yyyy-M-d h:m:s tt"],["M/d H:m:s.FFF","MMM/d H:m:s.FFF","MMMM/d H:m:s.FFF","d/M H:m:s.FFF","d/MMM H:m:s.FFF","d/MMMM H:m:s.FFF","M/y H:m:s.FFF","MMM/y H:m:s.FFF","M/yyyy H:m:s.FFF","MMM/yyyy H:m:s.FFF","d/M/y H:m","d/MMM/y H:m","d/MMMM/y H:m","d/M/yyyy H:m","d/mmm/yyyy H:m","d/MMMM/yyyy H:m","yyyy/M/d H:m","M/d/y H:m:s.FFF","MMM/d/y H:m:s.FFF","MMMM/d/y H:m:s.FFF","M/d/yyyy H:m:s","MMM/d/yyyy H:m:s.FFF","MMMM/d/yyyy H:m:s.FFF","d/M/y H:m:s.FFF","d/MMM/y H:m:s.FFF","d/MMMM/y H:m:s.FFF","d/M/yyyy H:m:s.FFF","d/MMM/yyyy H:m:s.FFF","d/MMMM/yyyy H:m:s.FFF","yyyy/M/d H:m:s.FFF","M-d H:m:s.FFF","MMM-d H:m:s.FFF","MMMM-d H:m:s.FFF","d-M H:m:s.FFF","d-MMM H:m:s.FFF","d-MMMM H:m:s.FFF","M-y H:m:s.FFF","MMM-y H:m:s.FFF","M-yyyy H:m:s.FFF","MMM-Yyyy H:m:s.FFF","d-M-y H:m","d-MMM-y H:m","d-MMMM-y H:m","d-M-yyyy H:m","d-MMM-yyyy H:m","d-MMMM-yyyy H:m","yyyy-M-d H:m","M-d-y H:m:s.FFF","MMM-d-y H:m:s.FFF","MMMM-d-y H:m:s.FFF","M-d-yyyy H:m:s","MMM-d-yyyy H:m:s.FFF","MMMM-d-yyyy H:m:s.FFF","D-M-y H:m:s.FFF","d-MMM-y H:m:s.FFF","d-MMMM-y H:m:s.FFF","D-M-yyyy H:m:s.FFF","d-MMM-yyyy H:m:s.FFF","d-MMMM-yyyy H:m:s.FFF","yyyy-M-d H:m:s.FFF","M/d h:m:s.FFF tt","MMM/d h:m:s.FFF tt","MMMM/d h:m:s.FFF tt","d/M h:m:s.FFF tt","d/MMM h:m:s.FFF tt","d/MMMM h:m:s.FFF tt","M/y h:m:s.FFF tt","MMM/y h:m:s.FFF tt","M/yyyy h:m:s.FFF tt","MMM/yyyy h:m:s.FFF tt","d/M/y h:m tt","d/MMM/y h:m tt","d/MMMM/y h:m tt","d/M/yyyy h:m tt","d/mmm/yyyy h:m tt","d/MMMM/yyyy h:m tt","yyyy/M/d h:m tt","M/d/y h:m:s.FFF tt","MMM/d/y h:m:s.FFF tt","MMMM/d/y h:m:s.FFF tt","M/d/yyyy h:m:s tt","MMM/d/yyyy h:m:s.FFF tt","MMMM/d/yyyy h:m:s.FFF tt","d/M/y h:m:s.FFF tt","d/MMM/y h:m:s.FFF tt","d/MMMM/y h:m:s.FFF tt","d/M/yyyy h:m:s.FFF tt","d/MMM/yyyy h:m:s.FFF tt","d/MMMM/yyyy h:m:s.FFF tt","yyyy/M/d h:m:s.FFF tt","M-d h:m:s.FFF tt","MMM-d h:m:s.FFF tt","MMMM-d h:m:s.FFF tt","d-M h:m:s.FFF tt","d-MMM h:m:s.FFF tt","d-MMMM h:m:s.FFF tt","M-y h:m:s.FFF tt","MMM-y h:m:s.FFF tt","M-yyyy h:m:s.FFF tt","MMM-Yyyy h:m:s.FFF tt","d-M-y h:m tt","d-MMM-y h:m tt","d-MMMM-y h:m tt","d-M-yyyy h:m tt","d-MMM-yyyy h:m tt","d-MMMM-yyyy h:m tt","yyyy-M-d h:m tt","M-d-y h:m:s.FFF tt","MMM-d-y h:m:s.FFF tt","MMMM-d-y h:m:s.FFF tt","M-d-yyyy H:m:s tt","MMM-d-yyyy H:m:s.FFF tt","MMMM-d-yyyy h:m:s.FFF tt","d-M-y h:m:s.FFF tt","d-MMM-y h:m:s.FFF tt","d-MMMM-y h:m:s.FFF tt","d-M-yyyy h:m:s.FFF tt","d-MMM-yyyy h:m:s.FFF tt","d-MMMM-yyyy h:m:s.FFF tt","yyyy-M-d h:m:s.FFF tt"]],J=function(){return{pattern:G,formatter:["d-mmm","mmm-yy",R().shortDatePattern,"h:mm","HH:mm:ss","h:mm:ss.0",R().shortDatePattern+" h:mm",R().shortDatePattern+" HH:mm:ss",R().shortDatePattern+" h:mm:ss.0"]}},V=function(){function t(t,n){y.call(this,n);for(var r,i,o,a=this,u=["<=","<>",">=",">","<","="],s=0,c=u.length;s<c;s++)if(r=u[s],E._startsWith(t,r,!0)){i=E._remove(t,0,r.length);var l=parseFloat(i);isNaN(l)||(o=l);break}if(o===F&&o===S)throw new Error(H().Exp_TokenIllegal);a.value=o,a._compareOperator=r,a.isMeetCondition=e(a)}function e(t){var e="var self = this;",n=t._compareOperator;return n="<>"===n?"!=":n,n="="===n?"===":n,e+="return value "+n+" self.value;",new Function(["value"],e)}return t.Name="ConditionalFormatPart",t.prototype={toString:function(){return a(this._compareOperator+this.value.toString())}},t}(),K=function(){function t(t,e){y.call(this,e),this.foreColor=t}return t.Name="ColorFormatPart",t.prototype.toString=function(){return a(this.foreColor)},t}(),X=function(t,e){y.call(this,e);var n,r=this,i=z(t)[0];if("h"===i)n=3600;else if("m"===i)n=60;else{if("s"!==i)throw new Error(H().Exp_TokenIllegal);n=1}r._getTimeSpan=function(t){return Math.floor(t/1e3/n)}};X.Name="ABSTimeFormatPart";var Z=function(){function t(t,e){y.call(this,e);var n=this;if(n.token=t,n.type=parseInt(E._remove(t,0,"dbnum".length),10),n.type<0||n.type>3)throw new Error(H().Exp_TokenIllegal)}function e(t,e,r){var i=t.split(".");if(i){if(1===i.length)return n(i[0],e.numbers,r?e.letters:F);if(2===i.length){return n(i[0],e.numbers,r?e.letters:F)+"."+n(i[1],e.numbers)}}throw new Error(H().Exp_ValueIllegal)}function n(t,e,i){var o=t,a=0,u=F,s=0;if(2===arguments.length){var c="";for(a=0;a<o.length;a++)u=r(o,a,1),s=parseInt(u,10),c+=e[s];return c}if(3===arguments.length){if(!i)return n(t,e);var l=0,f="",p=o.length,h=!1,d=[];for(a=0;a<p;a++){var y=i.length-1-a;y>-1?d.push(i[y].toString()):d.push(B._Empty)}for(var m=[],g=d.length-1;g>=0;g--)m[d.length-g-1]=d[g];d=m;var v=!1;for(g=0;g<p;g++){u=r(o,g,1),s=parseInt(u,10);var _=B._Empty,b=B._Empty;p-g-16>0?(_=e[s],b="",v=!0):g!==p-1&&g!==p-5&&g!==p-9&&g!==p-13?"0"===u?(_="",b="",l+=1):"0"!==u&&0!==l?(_=e[0]+e[s],b=d[g],l=0):(_=e[s],b=d[g],l=0):"0"!==u&&0!==l?(_=e[0]+e[s],b=d[g],l=0):"0"!==u&&0===l||v?(_=e[s],b=d[g],l=0,v=!1):"0"===u&&l>=3?(_="",b="",l+=1):p>=11?(_="",l+=1):(_="",b=d[g],l+=1);_+b===B._Empty||(h=!1),g!==p-13||h||(b=d[g],h=!0),g!==p-9||h||(b=d[g],h=!0),g===p-1&&(b=d[g],h=!0),f=f+_+b}var M=parseInt(t,10);return isNaN(M)||0!==M?f:e[0]}}return t.Name="DBNumberFormatPart",t.prototype={_replaceNumberString:function(t,n,i){if(!t||t===B._Empty)return t;for(var o=t,a=t,u=-1,s=-1,c=!1,l=F,p=F,h=F,d=t.length-1;d>=0;d--){var y=a[d];!isNaN(y)||f(y,".",!1)&&!c?(f(y,".",!1)&&(c=!0),-1===u&&(u=d),s=d):s>-1&&u>-1&&(l=r(a,s,u-s+1),p=parseFloat(l),isNaN(p)||(h=e(l,n,i),o=E._remove(o,s,u-s+1),o=E._insert(o,s,h)),u=-1,s=-1,c=!1)}return s>-1&&u>-1&&(l=r(a,s,u-s+1),p=parseFloat(l),isNaN(p)||(h=e(l,n,i),o=E._remove(o,s,u-s+1),o=E._insert(o,s,h)),u=-1,s=-1,c=!1),o},toString:function(){if(this.type>-1)return a("DBNum"+this.type);throw new Error}},t}(),Q=function(){function t(t,e){y.call(this,e);var n=this;n._content=t;var i=n._content,o=f(i[0],"$",!1),a=i.indexOf("-");if(!(o&&a>-1))throw new Error(H().Exp_TokenIllegal);n._currencySymbol=r(i,1,a-1),i=E._remove(i,0,a+1),i.length>0&&(n._locateID=parseInt(i,16))}return t.Name="LocaleIDFormatPart",t.prototype={cultureInfo:function(){var t=this;return t._cultureInfo||(t._cultureInfo=L(t._locateID),t._currencySymbol&&t._currencySymbol!==B._Empty&&(t._cultureInfo.NumberFormat.isReadOnly||(t._cultureInfo.NumberFormat.currencySymbol=t._currencySymbol))),t._cultureInfo},currencySymbol:function(){return this._currencySymbol?E._replace(this._currencySymbol,"\\\\.","\'.\'"):B._Empty},allowScience:function(){if(this._cultureInfo)return!(0===this._cultureInfo.name().indexOf("ja")||0===this._cultureInfo.name().indexOf("zh"))},toString:function(){return this._content?a(this._content):B._Empty}},t}(),tt=function(){function t(t,e){this.formatCached=t,this.cultureName=e,this.typeName=""}return t.prototype={format:function(t,e){return F},parse:function(t){return F},formatString:function(){return this.formatCached},toJSON:function(){var t={};for(var e in this)this.hasOwnProperty(e)&&(t[e]=this[e]);return t},fromJSON:function(t){if(t)for(var e in t)t[e]!==S&&(this[e]=t[e])}},t}(),et=function(){function t(t,e,n,r,i){d.call(this,e,n,r);var o=this;o._formatString=o._fixFormat(p(t)),o._absTimeParts=i,o._formatType=2,o._init()}function e(t){return E._indexOf(t,nt._hoursSingleDigit[0],!0)>-1||E._indexOf(t,nt._secondSingleDigit[0],!0)>-1}function n(t){return E._indexOf(t,nt._yearTwoDigit[0],!0)>-1||E._indexOf(t,nt._daySingleDigit[0],!0)>-1}return t.prototype={_init:function(){var e=this,n={_value:e._formatString};if(t._evaluateFormat(n._value)){var r=e._processAMPM(n);if(e.hasJD=e._replace(n._value,nt._monthJD,\'"\'+nt._placeholderMonthJD+\'"\',!0,!1,n,!1),e._replace(n._value,nt._monthUnabbreviated,"MMMM",!0,!1,n,!1),e._replace(n._value,nt._monthAbbreviation,"MMM",!0,!1,n,!1),e._replace(n._value,nt._monthTwoDigit,"MM",!0,!1,n,!1),e._replace(n._value,nt._monthSingleDigit,"M",!0,!1,n,!1),e._replace(n._value,nt._dayWeekDayAbbreviation,"ddd",!0,!0,n,!0),e._replace(n._value,nt._dayWeekDayUnabbreviated,"dddd",!0,!0,n,!0),r||(e._replace(n._value,nt._hoursSingleDigit,"H",!0,!0,n,!1),e._replace(n._value,nt._hoursTwoDigit,"HH",!0,!0,n,!1)),e._partDBNumberFormat&&e._partLocaleID&&(e._hasYearDelay=e._hasYearDelay||e._replace(n._value,nt._yearFourDigit,\'"@\'+nt._yearFourDigit+\'"\',!0,!1,n,!0),e._hasYearDelay=e._hasYearDelay||e._replace(n._value,nt._yearTwoDigit,\'"@\'+nt._yearTwoDigit+\'"\',!0,!1,n,!0)),e._absTimeParts)for(var i=0;i<e._absTimeParts.length;i++){var o=e._absTimeParts[i];e._replace(n._value,o._originalToken,"@"+o._originalToken,!0,!0,n,!0)}e._validDateTimeFormatString=n._value}else W()},formatString:function(){return this._formatString},format:function(t){var e=this,n=B._Empty,o=F;try{if(o=C._DT(t),o?t=o:n=t.toString(),o){if(n=C._customCultureFormat(o,e._validDateTimeFormatString,e._partLocaleID&&e._partLocaleID.cultureInfo()||L(e.cultureName)),e.hasJD){var a=L(e.cultureName).DateTimeFormat.monthNames[o.getMonth()];n=E._replace(n,nt._placeholderMonthJD,r(a,0,1))}if(e._absTimeParts)for(var u=24*(C._toOADate(o)-C._toOADate(nt._defaultAbsoluteTime))*60*60*1e3,s=0;s<e._absTimeParts.length;s++){var c=e._absTimeParts[s],l=c._getTimeSpan(u);if(l){var f=c._originalToken.replace("[","\\\\[").replace("]","\\\\]");n=E._replace(n,"@"+f,l)}}}}catch(e){n=i(t)}return b(n,t,e._partLocaleID,e._partDBNumberFormat,e.cultureName)},parse:function(t){if(!t||t===B._Empty)return F;var e=this,n=t,r=z(n);if("true"===r)return!0;if("false"===r)return!1;if(e._validDateTimeFormatString){var i=C._parseExact(n,e._validDateTimeFormatString,L(e.cultureName));if(i)return i}try{var o=C._DT(n);return o&&!isNaN(o)?o:(o=new Date(n),isNaN(o.valueOf())?n:o)}catch(t){return n}},_fixFormat:function(t){for(var e=t,n="",r=!1,i=0;i<e.length;i++){var o=e[i];if(\'"\'===o)r=!r;else if(!r)if("Y"===o||"D"===o||"S"===o||"E"===o||"G"===o)o=z(o);else if("M"===o){var a=e[i-1];f("A",a,!0)||f("P",a,!0)||(o=z(o))}n+=o}return n},_processAMPM:function(t){for(var e=[nt._aMPMTwoDigit,R(this.cultureName).amDesignator+"/"+R(this.cultureName).pmDesignator,nt._aMPMSingleDigit],n=["tt","tt","t"],r=0;r<3;r++)if(E._contains(t._value,e[r],1))return t._value=E._replace(t._value,e[r],n[r],!0),!0;return!1},_replace:function(t,r,i,o,a,u,s){if(o||a){var c=[],l=!0;!n(t)&&e(t)&&(l=!1);for(var p=!1,h=0;h<t.length;h++){var d=t[h];if(e(d)?l=!1:n(d)&&(l=!0),o&&f(d,r[0],s)&&l||a&&f(d,r[0],s)&&!l){for(var y=!0,m=0;m<r.length;m++)if(m+h>=t.length||!f(r[m],t[m+h],s)){y=!1;break}var g=h+r.length-1;if(y&&g+1<t.length){var v=t[g],_=-1;for(_=g+1;_<t.length&&f(v,t[_],s);_++);_>g+1&&(h=_,y=!1)}y&&!p&&c.splice(0,0,h)}\'"\'===d&&(p=!p)}if(u._value=t,c.length>0){for(h=0;h<c.length;h++){var b=c[h];u._value=E._remove(u._value,b,r.length),u._value=E._insert(u._value,b,i)}return!0}return!1}return!1}},t._evaluateFormat=function(t){return h(t,rt)},t}(),nt={_yearTwoDigit:"yy",_yearSingleDigit:"y",_yearFourDigit:"yyyy",_monthSingleDigit:"m",_monthTwoDigit:"mm",_monthAbbreviation:"mmm",_monthUnabbreviated:"mmmm",_monthJD:"mmmmm",_daySingleDigit:"d",_dayTwoDigit:"dd",_dayWeekDayAbbreviation:"aaa",_dayWeekDayUnabbreviated:"aaaa",_hoursSingleDigit:"h",_hoursTwoDigit:"hh",_minuteSingleDigit:"m",_minuteTwoDigit:"mm",_secondSingleDigit:"s",_secondTwoDigit:"ss",_eraYear:"e",_aMPMTwoDigit:"AM/PM",_aMPMSingleDigit:"A/P",_placeholderMonthJD:"@mmmmm",_defaultAbsoluteTime:new Date(1899,11,30,0,0,0,0)},rt=[nt._yearSingleDigit,nt._yearTwoDigit,nt._yearFourDigit,nt._monthSingleDigit,nt._monthTwoDigit,nt._monthAbbreviation,nt._monthUnabbreviated,nt._monthJD,nt._daySingleDigit,nt._dayTwoDigit,nt._dayWeekDayAbbreviation,nt._dayWeekDayUnabbreviated,nt._hoursSingleDigit,nt._hoursTwoDigit,nt._minuteSingleDigit,nt._minuteTwoDigit,nt._secondSingleDigit,nt._secondTwoDigit,"ggg","gg","g","ee","e"],it=function(){function t(t,e,n,r){var i=this;d.call(i,e,n,r);var o=p(t,!1);e&&(o=c(o,i._partLocaleID._originalToken,i._partLocaleID.currencySymbol())),o=u(o),o=l(o),i._formatString=o,i._formatType=3}return t.prototype={format:function(t){try{var e;e=t instanceof Date?C._toOADate(t).toString():i(t);var n=E._replace(this._formatString,\'"\',"");return n!==F&&n!==S&&(e=E._replace(n,"@",e)),e}catch(t){return""}},parse:function(t){return t||""},formatString:function(){return this._formatString}},t}(),ot=function(){function t(t,e,n,i){function o(t,e){var n=[],r=\'"\';if(t===F||""===t)return n;var i,o,a=!1,u=[],s=!1;for(i=0;i<t.length;i++)o=t[i],o!==r||a||(s=!s),a||s||o!==e?u.push(o):(n.push(u.join("")),u=[]),a="\\\\"===o&&!a;return n.push(u.join("")),n}d.call(this,e,n,i);var a=this;a._isGeneralNumber=!1,a._formatType=1,a._fullFormatString=u(t);var s=p(t);if(e&&(s=c(s,a._partLocaleID._originalToken,a._partLocaleID.currencySymbol())),s=u(s),s.indexOf("/")>-1){var l=o(s,"/");if(l&&2===l.length){a._fractionDenominatorFormat=l[1];var f=l[0];if(f){var h=f.lastIndexOf(" ");h>-1?(a._fractionIntegerFormat=r(f,0,h),a._fractionNumeratorFormat=r(f,h+1,f.length-h-1)):a._fractionNumeratorFormat=f}}}a._numberFormatString=s}function e(t,e){if(0===t)return D(e);if(0===e)return D(t);for(var n=Math.max(t,e),r=Math.min(t,e),i=n%r;0!==i;)n=r,r=i,i=n%r;return D(r)}function n(t,e,n,r,i){var o=0,a=0,u=0,s=0,c=Math.ceil;t>0?(s=t-c(t)+1,1===s?(s=0,o=t):o=c(t)-1):t<0&&(o=c(t),s=c(t)-t);var l=Math.pow(10,e-1),f=Math.pow(10,e)-1;l<2&&(l=2),f<2&&(f=2);for(var p=!1,h=0,d=l;d<=f;d++){var y=d*s,m=Math.round(y),g=m/d,v=D(g-s);if((!p||v<D(h-s))&&(p=!0,h=g,a=m,u=d,v<1e-5))break}return n.value=o,r.value=a,i.value=u,p}return t.prototype={formatString:function(){return this._fullFormatString},format:function(t){if(N(t,"boolean"))return t.toString().toUpperCase();var r=this,i=T._toDouble(t);if(isNaN(i)||!isFinite(i)||isNaN(t))return"string"==typeof t?t:F;var o,a,u,s,c,l=L(r.cultureName),f=F;if(r._fractionNumeratorFormat&&r._fractionDenominatorFormat){var p={value:0},h={value:0},d={value:0};if(n(i,r._fractionDenominatorFormat.length,p,h,d)){var y=e(h.value,d.value);if(y>1&&(h.value/=y,d.value/=y),r._fractionIntegerFormat){f="",1===d.value&&(p.value+=h.value,h.value=0,d.value=0),0!==p.value&&(f+=O._customCultureFormat(p.value,r._encodeNumberFormat(r._fractionIntegerFormat),l),f+=" "),0===p.value&&i<0&&(f+=l.NumberFormat.negativeSign),0===i&&(f+="0"),a=r._fractionDenominatorFormat,u=parseFloat(a),isNaN(u)||u>0&&(h.value*=u/d.value,a="",d.value=u,s=Math.ceil(h.value),c=s-h.value,h.value=c<=.5&&c>=0?parseFloat(s.toString()):parseFloat((s-1).toString()));var m=r._fractionNumeratorFormat,g=parseFloat(m);if(!isNaN(g)&&0===g){var v=m.length,_=h.value.toString(),b=_.length;v>b?m=m.substr(0,v-(v-b)):v<b&&(_=_.substr(0,b-(b-v)),h.value=parseInt(_,10))}return 0!==h.value&&(f+=O._customCultureFormat(h.value,r._encodeNumberFormat(m),l).replace(/^0*/,""),f+="/",f+=O._customCultureFormat(d.value,r._encodeNumberFormat(a),l).replace(/^0*/,"")),""===f?"0":f}f="";var w=p.value*d.value+h.value;return a=r._fractionDenominatorFormat,u=parseFloat(a),u>0?(w*=u/d.value,d.value=u,s=Math.ceil(w),c=s-w,w=c<=.5&&c>=0?parseFloat(s.toString()):parseFloat((s-1).toString()),f+=w+"/"+d.value):(f+=O._customCultureFormat(w,r._encodeNumberFormat(r._fractionNumeratorFormat),l).replace(/^0*/,""),f+="/",f+=O._customCultureFormat(d.value,r._encodeNumberFormat(r._fractionDenominatorFormat),l).replace(/^0*/,"")),0===w?"0":f}return i.toString()}return o=O._customCultureFormat(i,r._encodeNumberFormat(r._numberFormatString),l),o=M(o,r._isGeneralNumber,r._partLocaleID,r._partDBNumberFormat,r.cultureName)},parse:function(t){var e=this;if(!t||t===B._Empty)return F;var n=z(t);if("true"===n)return!0;if("false"===n)return!1;t=e._trimSpecialSymbol(t),t=e._trimCurrencySymbol(t);var r=e._trimPercentSign(t),i=r._isPer,o=r._str;if(e._isValidaNumberString(o)){o=E._replaceAllNoReg(o,$(e.cultureName).numberGroupSeparator,"");var a=O._parseFloat(o,e.cultureName);if(!isNaN(a)&&isFinite(a))return i&&(a/=100),a}return F},_isValidaNumberString:function(t){for(var e="",n=0,r=0,i=0,o=!0,a=$(this.cultureName),u=t.length-1;u>-1;u--){if(t[u]===a.numberDecimalSeparator)n++,i>0&&(o=!1),e="";else if("e"===z(t[u]))r++,e="";else if(t[u]===a.numberGroupSeparator)o=3===e.length,i++,e="";else if("-"===t[u]||"+"===t[u]){if(u>0&&"e"!==z(t[u-1]))return!1}else{if(!q._isDigit(t[u]))return!1;e+=t[u]}if(n>1||r>1||!o||1===r&&u===t.length-1)return!1}return!0},_encodeNumberFormat:function(t){if(t){for(var e=t.split(""),n="",r=0;r<e.length-1;)"\\\\"===e[r]?(n+=e[r+1],r+=2):(n+=e[r],r++);r===e.length-1&&"\\\\"!==e[r]&&(n+=e[r]),t=c(n,"?","0")}return t},_trimSpecialSymbol:function(t){for(var e=t,n=[],r=0;r<e.length;r++)q._isDigit(e[r])&&n.push(r);for(var i=$(this.cultureName),o=[i.currencyDecimalSeparator,i.currencyGroupSeparator,i.currencySymbol,i.nanSymbol,i.negativeInfinitySymbol,i.negativeSign,i.numberDecimalSeparator,i.numberGroupSeparator,i.percentDecimalSeparator,i.percentGroupSeparator,i.percentSymbol,i.perMilleSymbol,i.positiveInfinitySymbol,i.positiveSign],a=e.length-1;a>-1;a--){var u=e[a];if(!q._isWhiteSpace(u)||o.indexOf(u.toString())>-1){if("-"===u||"+"===u){var s=a>0?e[a-1].toString():F,c=["e","E","(",$(this.cultureName).currencySymbol];if(c.indexOf(s)<0)break}}else(a<n[0]||n[n.length-1]<a)&&(e=E._remove(e,a,1))}return e},_trimCurrencySymbol:function(t){var e=$(this.cultureName).currencySymbol,n=E._startsWith(t,e)?E._remove(t,0,e.length):t;return n.indexOf(e)<0?n:t},_trimPercentSign:function(t){var e=$(this.cultureName).percentSymbol,n=!0,r=t;return E._startsWith(t,e)?r=E._remove(t,0,e.length):E._endsWith(t,e)?r=E._remove(t,t.length-e.length,e.length):n=!1,E._contains(r,e)&&(n=!1),{_str:r,_isPer:n}}},t}(),at=function(){function t(t,e,n,r){d.call(this,e,n,r),arguments.length>0?((t.indexOf("0")>=0||t.indexOf("#")>=0||t.indexOf(".")>=0||t.indexOf("@")>=0)&&W(),this._fullFormatString=t):this._fullFormatString="General",this._formatType=0}return t.prototype={_getDigitalFormat:function(){var t=this;if(!t._digitalFormat){var e=t._fullFormatString;e=c(e,"General","##################0.################"),t._digitalFormat=new ot(e,t._partLocaleID,t._partDBNumberFormat,t.cultureName),t._digitalFormat._isGeneralNumber=!0}return t._digitalFormat},_getExponentialDigitalFormat:function(){var t=this;return t._exponentialDigitalFormat||(t._exponentialDigitalFormat=new ot("0.#####E+00",t._partLocaleID,t._partDBNumberFormat,t.cultureName),t._exponentialDigitalFormat._isGeneralNumber=!0),t._exponentialDigitalFormat},formatString:function(){return E._replace(this._fullFormatString,"@NumberFormat","General")},format:function(t){var e=this;if(/^0+\\d*$/.test(t))return t;if(x.isBigNumber(t)&&!e._exponentialDigitalFormat)return t;if(T._isNumber(t,e.cultureName)){var n=!e._partLocaleID||e._partLocaleID.allowScience(),r=T._toDouble(t);if(r!==S&&r!==F)return D(r)>999999999999999&&n||D(r)<1e-11&&0!==r?e._getExponentialDigitalFormat().format(t):e._getDigitalFormat().format(t)}else{if(N(t,"string")){var i=E._replace(e.formatString(),\'"\',"");return i=l(i),i?E._replace(i,"General",t):t}if(N(t,"boolean"))return t.toString().toUpperCase()}return""},parse:function(t){if(B._isNullOrEmpty(t))return F;if("number"==typeof t)return t;var e=!1,n=E._indexOf(t,"-");if(n>0&&(f(t.charAt(n-1),"E",!0)||(e=!0)),E._contains(t,"/")||e||E._contains(t,":")||E._contains(t,"-")){var r=C._parseLocale(t);if(r)return r}var i,o="-"===t.charAt(0),a=o?E._remove(t,0,1):t,u="("===a.charAt(0)&&")"===t.charAt(t.length-1);return i=this._getDigitalFormat().parse(a),i!==F&&i!==S?(u||o)&&N(i,"number")?-1*D(i):i:t}},t}(),ut=function(){function t(t,e){var n=this;0===arguments.length?(n.formatCached="General",n._numberFormat=new at):n._init(t,e)}function e(t){if(!t||t===B._Empty)throw new Error(H().Exp_TokenIllegal)}function n(t){e(t);var n=s(t);return e(n),n}var r=["colorFormatPart","conditionalFormatPart","dbNumberFormatPart","localeIDFormatPart"];return t.prototype={_init:function(t,e){t!==F&&t!==S||W();var r=this;r.formatCached=t;for(var i="",o="",a=!1,u=[],s=0;s<t.length;s++){var c=t[s];if("["===c)a&&W(),o&&(i||(i=""),i+=o,o=""),o=c.toString(),a=!0;else if("]"===c){if(a||W(),o){o+=c;var l=o.toString(),f=m(o.toString());f?"ABSTimeFormatPart"===f.Name?(u.push(new f(n(l),l)),i+=o):r.addPart(f,l):W(),o=""}else W();a=!1}else o+=c}o&&(a?W():i+=o),r.localeIDFormatPart&&(e=r.localeIDFormatPart.cultureInfo().name());var p=g(i),h=p._type,d=p._isDigitalOrText?t:i;h?r._numberFormat=new h(d,r.localeIDFormatPart,r.dbNumberFormatPart,e,u.length>0?u:F):W()},formatString:function(){for(var t=this,e="",n=0,i=r.length;n<i;n++){var o=r[n];t[o]&&(e+=t[o].toString())}return e+=t._numberFormat.formatString()},addPart:function(t,e){for(var i=this,o=n(e),a=0,u=r.length;a<u;a++){var s=r[a];if(f(s,t.Name,!0)){if(i[s])throw new Error(H().Exp_DuplicatedDescriptor);i[s]=new t(o,e)}}},format:function(t){return this._numberFormat.format(t)},parse:function(t){return this._numberFormat.parse(t)}},t}(),st=function(t){function e(t,e){var n=this;n._isSingleFormatterInfo=!0,n.PropertyChanged=[],B._isNullOrEmpty(t)&&(t="General"),n.formatCached=t,n.cultureName=e,n.init()}function n(t){var n=e[t];return n||(n=new e(t),e[t]=n),n}return T._inherit(e,t),e.prototype={toJSON:function(){var t=this,e={formatCached:t.formatCached};return t.cultureName&&(e.customerCultureName=t.cultureName),"general"===z(t.formatCached)&&delete e.formatCached,e},hasFormatedColor:function(){var t=this;for(var e in U)if(U.hasOwnProperty(e)){var n=t.getFormatter(U[e]);if(n&&n.colorFormatPart)return!0}return!1},formatString:function(t){var e=this;if(0===arguments.length){for(var n=B._Empty,r=0,i=e.formatters.length;r<i;r++){n+=e.formatters[r].formatString(),r!==i-1&&(n+=";")}return n}if(!t)throw new Error(H().Exp_ValueIsNull);return e.formatters=F,e.formatCached=t,e.init(),e._raisePropertyChanged("formatString"),e},getFormatter:function(t){var e=this;return e.formatters&&e.formatters[t]},getPreferredEditingFormatter:function(t){var e=R(this.cultureName);return n(N(t,"DateTime")?C._toOADate(t)<1?"HH:mm:ss":0===t.getHours()&&0===t.getMinutes()&&0===t.getSeconds()&&0===t.getMilliseconds()?e.shortDatePattern:e.shortDatePattern+" HH:mm:ss":N(t,"TimeSpan")?e.longTimePattern:"General")},getPreferredDisplayFormatter:function(t,r){var i=this;r||(r={value:F}),r.value=F;var o=/^0+\\d*$/,a=x.isBigNumber(t);if(B._isNullOrEmpty(t)||o.test(t)||a)return a&&(r.value=t),new e;var u=t,s=r.value=i.parse(u);if(N(s,"DateTime")||N(s,"TimeSpan"))for(var c=J(),l=c.pattern,f=c.formatter,p=0;p<l.length;p++)for(var h=l[p],d=0;d<h.length;d++){var y=h[d],m=C._parseLocale(t,y);if(m&&m-s==0)return new e(f[p])}else if(T._isNumber(s,i.cultureName)){var g=$(i.cultureName),v=g.currencySymbol,_=g.numberDecimalSeparator,b=g.percentSymbol,M=g.numberGroupSeparator,w="E",S=E._contains,D=S(u,_),k=D?".00":"";if(u[0]===v)return n(B._format("{0}#,##0{1};[Red]({0}#,##0{1})",v,k));if(S(u,w,1))return n("0.00E+00");if(u[0].toString()===b||u[u.length-1].toString()===b)return n(B._format("0{0}%",k));if(S(u,M))return n(B._format("#,##0{0}",k))}return n("General")},format:function(t,e){if(N(t,"boolean"))return t.toString().toUpperCase();var n=this._getFormatInfo(t);if(n){var r=n.colorFormatPart;e&&r&&(e.value=r.foreColor);var i=0,o=T._isNumber(t,self.cultureName);o&&(i=T._toDouble(t));var a=B._Empty;if(o&&n===this.getFormatter(U._negative))a=n.format(D(i)),n&&n.conditionalFormatPart&&n.conditionalFormatPart.value>0&&i<0&&(a="-"+a);else try{a=n.format(t)}catch(e){N(t,"string")&&(a=t.toString())}return a}return o&&i<0?"-".toString():N(t,"string")?t.toString():t===S||t===F?B._Empty:t.toString()},parse:function(t){var e=this;return e.formatters&&e.formatters.length>0?e.formatters[0].parse(t):F},init:function(){var t=this,e=t.formatCached;B._isNullOrEmpty(e)&&W(),t.formatters=[];var n=e.split(";");t._isSingleFormatterInfo=1===n.length,(!n||n.length<1||n.length>4)&&W();for(var r=0;r<n.length;r++){var i=new ut(n[r],t.cultureName);i&&t.formatters.push(i)}t.getFormatter(U._positive)||W()},_getFormatInfo:function(t){var e=this,n=e.getFormatter(U._positive),r=e.getFormatter(U._text);if("string"==typeof t&&isNaN(t))return r||n;if(T._isNumber(t,e.cultureName)||N(t,"boolean")){var i,o=e.getFormatter(U._negative),a=e.getFormatter(U._zero),u=T._toDouble(t),s=n&&n.conditionalFormatPart,c=s&&n.conditionalFormatPart.isMeetCondition(u),l=o&&o.conditionalFormatPart,f=l&&o.conditionalFormatPart.isMeetCondition(u);return e._isSingleFormatterInfo||(s?c:u>0)||0===u&&!e.getFormatter(U._zero)?i=n:(l?f:u<0)?i=o:a?i=a:o&&(i=o),i}return F},_raisePropertyChanged:function(t){var e=this;if(e.PropertyChanged)for(var n=0;n<e.PropertyChanged.length;n++){var r=e.PropertyChanged[n];"function"==typeof r&&r(e,t)}}},e}(tt);k.GeneralFormatter=st,k.FormatterBase=tt,t.exports=k},function(t,e,n){function r(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}var i=n(3);n(38),r(i,n(9)),r(i,n(39)),i._Types=n(4),i._ArrayHelper=n(17),i._DateTimeHelper=n(13),i._NumberHelper=n(10),i._RegexHelper=n(5),i._StringHelper=n(6),i.SR={},i.SR.en=n(40),t.exports=i},function(t,e,n){var r=n(3),i=n(10)._toHexString,o=Math.min,a=Math.max,u=Math.abs,s=parseInt,c=function(){function t(){}return t._toString=function(t){var e=t.a,n=t.r,r=t.g,o=t.b;return 3===arguments.length&&(e=255,n=arguments[0],r=arguments[1],o=arguments[2]),4===arguments.length&&(e=arguments[0],n=arguments[1],r=arguments[2],o=arguments[3]),255===e?"#"+i(n,!0,2)+i(r,!0,2)+i(o,!0,2):"rgba("+n+","+r+","+o+","+e+")"},t._compare=function(t,e){return t.a===e.a&&t.r===e.r&&t.g===e.g&&t.b===e.b},t._getBrightness=function(e){var n=t._fromString(e);return(299*n.r+587*n.g+114*n.b)/1e3},t._hueToRGB=function(t,e,n){return n<0&&(n+=240),n>240&&(n-=240),n<40?t+((e-t)*n+20)/40:n<120?e:n<160?t+((e-t)*(160-n)+20)/40:t},t._fromHLS=function(e,n,r){function i(e,n,r){return parseInt((255*t._hueToRGB(e,n,r)+120)/240,10)}var o,a,u;if(0===r)o=a=u=s(255*n/240,10);else{var c,l;l=n<=120?(n*(240+r)+120)/240:n+r-(n*r+120)/240,c=2*n-l,o=i(c,l,e+80),a=i(c,l,e),u=i(c,l,e-80)}return{a:255,r:o,g:a,b:u}},t._isTwoColorSimilar=function(t,e){var n=255-u(t.r-e.r),r=255-u(t.g-e.g),i=255-u(t.b-e.b),o=u(t.a-e.a);return n/=255,r/=255,i/=255,!!((n+r+i)/3>=.9&&o<=.05)},t._invertColor=function(e){var n=255^e.r,r=255^e.g,i=255^e.b;return t._toString(e.a,n,r,i)},t._fromString=function(e){function n(e){var n=t._ctx;if(!n){var r=document.createElement("canvas");r&&r.getContext&&(n=t._ctx=r.getContext("2d"))}return n?(n.fillStyle=e,e=n.fillStyle):e}function r(t){var e=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i,r=/^#([0-9a-f])([0-9a-f])([0-9a-f])$/i,i=/^rgb\\(([\\s\\d]*),([\\s\\d]*),([\\s\\d]*)\\)$/i,o=/^rgba\\(([\\s\\d]*),([\\s\\d]*),([\\s\\d]*),([\\s\\d]*)\\)$/i,a=function(t){return s(t,16)},u=function(t){return s(t+t,16)},c=function(t){return t.indexOf("%")>0?2.55*parseFloat(t):0|t},l=n(t),f=RegExp;if(e.test(l))return[f.$1,f.$2,f.$3].map(a);if(o.test(l)){var p=[f.$1,f.$2,f.$3].map(c);return p.splice(0,0,255*parseFloat(f.$4)),p}return i.test(l)?[f.$1,f.$2,f.$3].map(c):r.test(l)?[f.$1,f.$2,f.$3].map(u):null}if(e instanceof t)return e;var i=0,o=0,a=0,u=0;if(e&&""!==e){var c=r(e);c&&(3===c.length?(i=255,o=c[0],a=c[1],u=c[2]):4===c.length&&(i=c[0],o=c[1],a=c[2],u=c[3]))}return{a:i,r:o,g:a,b:u}},t._applyTint=function(e,n){if(0===n)return e;var r=new l(e),i=s(n>0?(240-r._luminosity)*n:r._luminosity*n,10);return t._fromHLS(r._hue,r._luminosity+i,r._saturation)},t._getLighterColor=function(e,n){var r=t._fromString(e),i=new l(r),o=i._getLighterColor(n);return t._toString(o)},t}(),l=function(){function t(t){var e=this,n=t.r,r=t.g,i=t.b,u=a(a(n,r),i),c=o(o(n,r),i),l=u+c;e._luminosity=s((240*l+255)/510,10);var f=u-c;if(0===f)e._saturation=0,e._hue=160;else{e._luminosity<=120?e._saturation=s((240*f+l/2)/l,10):e._saturation=s((240*f+(510-l)/2)/(510-l),10);var p=(40*(u-n)+f/2)/f,h=(40*(u-r)+f/2)/f,d=(40*(u-i)+f/2)/f;e._hue=n===u?s(d-h,10):r===u?s(80+p-d,10):s(160+h-p,10),e._hue<0&&(e._hue+=240),e._hue>240&&(e._hue-=240)}}return t.prototype={constructor:t,_getLighterColor:function(t){var e=this,n=e._luminosity,r=e._newLuma(e._luminosity,500,!0);return c._fromHLS(e._hue,n+(r-n)*t,e._saturation)},_newLuma:function(t,e,n){return 0===e?t:n?e>0?(t*(1e3-e)+241*e)/1e3:t*(e+1e3)/1e3:(t+=240*e/1e3,t<0&&(t=0),t>240&&(t=240),t)}},t}();r._ColorHelper=c,t.exports=r},function(t,e){function n(t){return t}function r(t,e,n,r,i,o,a,u,c,p,h){var d,y,m,g,v,_,b,M,w,x,F,S,D,k,E,C,T=n[l],N=n[f],O=e[l],A=e[f],j=r[l],P=r[f],I=1===N,H=1===A;if(O===T&&A===N){var L=0,R=0,$=0,z=0;for(b=T*N,d=0;d<T;d++)for(y=0;y<N;y++){if(g=o(n[d][y]),v=o(e[d][y]),t&&(s(g)||s(v)))return c;v=p(v),L+=g,R+=g*g,$+=v,z+=g*v}for(_=i?(b*z-L*$)/(b*R-L*L):z/R,M=i?($*R-L*z)/(b*R-L*L):0,w=[],d=0;d<j;d++)for(w[d]=[],y=0;y<P;y++){if(g=o(r[d][y]),t&&s(g))return c;w[d][y]=h(_*g+M)}return a?new a(w):w}if(I&&O===T||1===O&&A===N){for(g=[],v=[],E=N+1,C=N+2,d=0;d<T;d++){if(F=I?e[d][0]:e[0][d],M=o(F),t&&s(M))return c;v[d]=I?p(M):M}for(d=0;d<T;d++)for(g[d]=[],y=0;y<N;y++){if(M=o(n[d][y]),t&&s(M))return c;g[d][y]=M}var W=[];for(_=0;_<E;_++)for(W[_]=[],b=0;b<C;b++)W[_][b]=0;for(m=0;m<T;m++)for(W[0][E]+=v[m],d=0;d<N;d++)for(F=d+1,W[0][F]+=g[m][d],W[F][0]=W[0][F],W[F][E]+=g[m][d]*v[m],y=d;y<N;y++)D=y+1,W[D][F]+=g[m][d]*g[m][y],W[F][D]=W[D][F];W[0][0]=T;var B=i?0:1;for(x=B;x<E;x++){if(t){if(0===W[d][d]){for(k=!1,y=d+1;!k&&y<E;y++)if(0!==W[y][d]){for(m=0;m<C;m++)D=W[d][m],W[d][m]=W[y][m],W[y][m]=D;k=!0}if(!k)return u}}else{for(d=x;d<E&&0===W[d][x];)d++;if(d>=E)return u;for(S=B;S<C;S++)F=W[x][S],W[x][S]=W[d][S],W[d][S]=F}for(F=1/W[x][x],S=B;S<C;S++)W[x][S]*=F;for(d=B;d<E;d++)if(d!==x)for(F=-W[d][x],S=0;S<C;S++)W[d][S]+=F*W[x][S];!i&&(W[0][E]=0)}for(w=[],!H&&(w[0]=[]),d=0;d<j;d++){for(H&&(w[d]=[]),F=W[0][E],y=0;y<N;y++){if(F=H?r[d][y]:r[y][d],M=o(F),t&&s(M))return c;F+=W[y+1][E]*M}H?w[d][0]=h(F):w[0][d]=h(F)}return a?new a(w):w}return u}function i(t,e,n,r,i,o,a,u,s,c,p){function h(t){t=t.toString();var e=t.split(".");return parseInt(e[e.length-1])}function d(t,e){if(parseInt(e)<0)return t;t=t.toString();var n=t.split(".");return n[n.length-1]=e,n.join(".")}var y,m,g,v,_,b,M,w,x=n[l],F=n[f],S=e[l],D=e[f],k=r[l],E=r[f];if(S===x&&D===F){var C=0,T=0,N=0,O=0;for(b=x*F,y=0;y<x;y++)for(m=0;m<F;m++)g=o(n[y][m]),v=e[y][m],v=h(v),C+=g,T+=g*g,N+=v,O+=g*v;for(_=i?(b*O-C*N)/(b*T-C*C):O/T,M=i?(N*T-C*O)/(b*T-C*C):0,w=[],y=0;y<k;y++)for(w[y]=[],m=0;m<E;m++)g=o(r[y][m]),w[y][m]=d(e[y][m],_*g+M);return a?new a(w):w}return u}function o(t,e,i,o,a,u,s,c){return r(!0,t,e,i,o,a,u,c,s,n,n)}function a(t,e,r,o,a,u,s,c){return i(!0,t,e,r,o,a,u,c,s,n,n)}function u(t,e,i,o,a,u,s){var c,p;for(c=0;c<t[l];c++)for(p=0;p<t[f];p++)if(t[c][p]<=0)return u;return r(!1,t,e,i,o,n,a,s,null,Math.log,Math.exp)}var s=isNaN,c={},l="rowCount",f="colCount";c._trend=o,c._growth=u,c._trendSerial=a,t.exports=c},function(t,e){t.exports={Exp_InvalidDateFormat:"Invalid date format pattern",Exp_InvalidExponentFormat:"invalid exponent format",Exp_InvalidSemicolons:"invalid format: too many semicolons",Exp_InvalidNumberGroupSize:"NumberGroupSize must be between 1 and 9.",Exp_BadFormatSpecifier:"Bad Format Specifier",Exp_InvalidNumberFormat:"Invalid number format pattern",Exp_InvalidCast:"InvalidCastException",Exp_Separator:"numberDecimalSeparator, listSeparator and arrayListSeparator should be different in cluture info."}},function(t,e,n){function r(t){return!!t&&s._startsWith(t.toString(),"http")}function i(t){var e=t&&t.toString();return!/^0+\\d*$/.test(e)&&e-parseFloat(e)+1>=0}function o(t){return!!(i(t)&&t.toString().length>15)}function a(t){var e=t.attrs||{};for(var n in e)if(n.match(/lock-/))return!0}function u(t){return!(!t.attrs||!t.attrs.lock)}var s=n(6);t.exports={isUrl:r,isBigNumber:o,isNumeric:i,hasCellLocks:a,hasSheetLock:u}},function(t,e,n){(function(t){function n(t){return i.indexOf(t)>-1}Object.defineProperty(e,"__esModule",{value:!0}),e.isDateFormat=n;var r=(e.SHEET_VIEW_CLASSNAME="sm-sheet-view",e.HISTORY_VIEW_CLASSNAME="history-h-view",e.STYLE_ATTRS=["bold","italic","strike","underline","rowspan","colspan","color","background","font-size","format","vertical","align","wrap","border-top","border-right","border-bottom","border-left"],e.DEFAULT_STYLE={"font-weight":"normal","font-style":"normal","font-size":"9pt",font:"9pt arial",color:15,background:0,align:"general",vertical:"center",wrap:"text-wrap",bold:!1,italic:!1,strike:!1,underline:!1},e.DEFAULT_ALIGN_MAP={string:"left",image:"center",number:"right"},e.DEFAULT_FONT=\'9pt -apple-system, BlinkMacSystemFont, PingFang SC, Helvetica, Tahoma, Arial, "Hiragino Sans GB", "Microsoft YaHei", SimSun, Heiti, sans-serif\',e.TEMP_NEW_FORMAT_MAP={normal:"","0,0":"#,##0","0,0.00":"#,##0.00","(0,0)":"#,##;(#,##0)","(0,0.00)":"#,##0.00;(#,##0.00)","¥0,0":"¥#,##0","¥0,0.00":"¥#,##0.00","$0,0":"$#,##0","$0,0.00":"$#,##0.00"}),i=e.DATE_FORMATS=["YYYY-MM-DD","YYYY/MM/DD","YYYY/MM/DD HH:mm:ss","HH:mm:ss"];e.INVERT_TEMP_NEW_FORMAT_MAP=t.invert(r),e.LOCK_IMG_BASE64="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAAYCAYAAAD3Va0xAAABiklEQVQ4T82UvU7DQAyA7cuQpUWqKjbYuiMGHgA2EGVB9AE6pHcDC2MlGECIkYHhLhnyAEVMFbDBA7D0AbrBhqpK0KVDbHRVU7VpiKKq/GS8s798tuMgpDxhGK4Oh8NjRKwyc8WGIGKXmduu697U6/X3ZBomD4IgOIyiKASAlbSXAMCH4zh1z/Pupu9nQBZCRLfMjIjYRsTrUqn0YhP6/f4WEZ0AwD4ishDiaBo2AY3L6VoTRGxKKa/SjHzfbxLRpTVzXbcSlzkBaa3PAeDUmkgpD74pa3SstW5bMwC4UEqdjXoYJxhjOsy8IYTYaTQaz1kg3/e3iegJETtSys0ZkNb6EwAK5XK5WKvVBlmgVqtV6PV6Nn6glComQWwPlFJzk0yDaq1n4qd79E9AsWJWT/Lc4dJBeZuctItFJkY/CgqCYJeIAmshhPA8z3tcyMgY88rMa+PfyJuUcv1vQba0KIoerIXjOHsLlzbe9MwvPvfUjDH3zExKqWrWzv3O+POsxlxpeZKyYpa2a1/5M/jRz8jbBgAAAABJRU5ErkJggg==",e.LOCK_CELL_BG_BASE64="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAECAYAAACp8Z5+AAAAG0lEQVQYV2NkQAB9EJMRmwBYhoGB4SJMBYoAADBPAmOASl6WAAAAAElFTkSuQmCC",e.FILTER_FUNC_MAP={"new-filter":"newFilter2Cs","clear-filter":"clearFilter2Cs","delete-filter":"deleteFilter2Cs"}}).call(e,n(0))},function(t,e){function n(t,e){var n=t.row,r=t.col,i=t.rowCount,o=t.colCount;return(f[e]||c)(n,r,n+i-1,r+o-1)}function r(t,e,n,r){return{left:[t,e,n,e]}}function i(t,e,n,r){return{bottom:[n,e,n,r]}}function o(t,e,n,r){return{right:[t,r,n,r]}}function a(t,e,n,r){return{top:[t,e,t,r]}}function u(t,e,n,r){var i={};return n-t>=1&&(i.bottom=[t,e,n-1,r]),r-e>=1&&(i.right=[t,e,n,r-1]),i}function s(t,e,n,r){return{top:[t,e,t,r],right:[t,r,n,r],bottom:[n,e,n,r],left:[t,e,n,e]}}function c(t,e,n,r){var i=[t,e,n,r];return{top:i,right:i,bottom:i,left:i}}function l(t,e,n,r){return{top:[t,e,n+1,r],right:[t,e-1,n,r],bottom:[t-1,e,n,r],left:[t,e,n,r+1]}}t.exports={transformBorder:n};var f={all:c,none:l,outter:s,inner:u,top:a,right:o,bottom:i,left:r}},function(t,e,n){(function(e){function r(t){return t&&t.__esModule?t:{default:t}}function i(t){"string"==typeof t&&(t=y.default.unpack(t));var e=t.data,n=s(t),r=o(e.rows.ops),i=o(e.cols.ops);return{tableActions:n,rows:r,cols:i,cellsData:a(e.cells,r,i,t)}}function o(t){function n(t,n){var r=new Array(t);return e.map(r,function(){return n})}for(var r,i,o,a=[],u=0,s=t.length;u<s;u++)r=t[u],i=parseInt(r.data,10),o=r.getAttributes()||{},a=a.concat(n(i,o));return a}function a(t,e,n){var r=[],i=n.length||18,o=e.length||200;return t.forEach(function(e){var n=y.default.parsePosition(e),a=n.row,u=n.col;if(!(a>=o||u>=i)){var s=t.get(e);r.push([a,u,g.default.cells2Value(s),s.getAttributes()])}}),r}function u(t){var e,n,r,i,o,a={rowActions:null,attrsActions:null},u={rowActions:null,attrsActions:null};i=t,o=i.data,n=s(i);for(var f in o)e=o[f],"rows"===f?a=c(e.ops):"cols"===f?u=c(e.ops):"cells"===f&&(r=l(e));return{tableActions:n,rows:a.rowActions,rowsAttr:a.attrsActions,cols:u.rowActions,colsAttr:u.attrsActions,cellsData:r}}function s(t){return t.getAttributes()||{}}function c(t){function n(t,n){var r=new Array(t);return e.map(r,function(){return n})}for(var r=0,i=void 0,o=void 0,a=void 0,u=[],s=["insert","remove"],c=[],l=0,f=t.length;l<f;l++){i=t[l],o=parseInt(i.data),a=i.action,e.includes(s,a)&&c.push({type:a,index:r,amount:o});var p=i.getAttributes()||{};u=u.concat(n(o,p)),r+=o}return{rowActions:c,attrsActions:u}}function l(t){var e=[];return t.forEach(function(n){var r=t.get(n),i=y.default.parsePosition(n),o=i.row,a=i.col;e.push([o,a,g.default.cells2Value(r),r.getAttributes()])}),e}function f(t){for(var e=t.ops,n=[],r=void 0,i=void 0,o=0,a=void 0,u=0,s=e.length;u<s;u++)if(r=e[u],a=r.action,i=r.getAttributes(),"retain"===a)i.name?(n.push(["rename",o,i.name]),o+=1):"object"===h(r.data)?o+=1:o+=r.data;else if("insert"===a){var c=r.data,l=c.rows.length,f=c.cols.length;n.push(["insert",o,[i.name,i.id,l,f]]),o+=1}else"remove"===a&&(n.push(["remove",o,r.data]),o+=r.data);return n}function p(t){function n(t){var n={};return e.forIn(t,function(t,e){e.match(/lock-/)&&(n[e]=t)}),n}var r=0,i=[];return t.ops.forEach(function(t){var o=t.action,a=t.data,u=t.getAttributes(),s=u.hasOwnProperty("lock"),c=n(u);s&&(c.lock=u.lock),!e.isEmpty(c)&&i.push([r,c]),r+="retain"===o?"object"===(void 0===a?"undefined":h(a))?1:a:"remove"===o?a:1}),i}var h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d=n(1),y=r(d),m=n(15),g=r(m);t.exports={changeset2Actions:u,tableOps2Actions:s,changeset2SheetChangeAction:f,changeset2LockActions:p,processTableOps:i,processRow:o,processCell:a}}).call(e,n(0))}]);',n.p+"0455371cf7ecc1313099.worker.js")}},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={error:"",open:!1},n.onInput=n.onInput.bind(n),n.onKeyDown=n.onKeyDown.bind(n),n.confirm=n.confirm.bind(n),n}return a(t,e),s(t,null,[{key:"propTypes",get:function(){return{addRow:l.PropTypes.func,onInputFocus:l.PropTypes.func}}}]),s(t,[{key:"onInput",value:function(){this.setState({error:""})}},{key:"onKeyDown",value:function(e){13===e.keyCode&&this.confirm()}},{key:"onFocus",value:function(){this.props.onInputFocus()}},{key:"show",value:function(){this.setState({open:!0})}},{key:"hide",value:function(){this.setState({open:!1})}},{key:"confirm",value:function(){var e=this.refs.input.value;this._verify(e)&&(this.props.addRow(+e),this.hide())}},{key:"_verify",value:function(e){return!(isNaN(e)||e>1e3||e<1)||(this.setState({error:"请输入 1-1000 的数字"}),!1)}},{key:"render",value:function(){var e=this.state,t=e.error,n=e.open;return u.default.createElement("div",{className:"h-view-footer"},n&&u.default.createElement("div",{className:"h-view-footer-add"},u.default.createElement("span",{className:"sheet-add-text"},"在底部添加"),u.default.createElement("input",{className:"sheet-add-input",ref:"input",defaultValue:"200",onInput:this.onInput,onKeyDown:this.onKeyDown}),u.default.createElement("span",{className:"sheet-add-text"},"行"),u.default.createElement("a",{className:"sheet-add-btn",onClick:this.confirm},"确认添加"),u.default.createElement("span",{className:"sheet-add-error"},t)))}}]),t}(l.Component);t.default=c,e.exports=t.default},function(e,t){function n(e,t){e.preventDefault();var n=e.dataTransfer.files,r=!1;for(var o in n){if(r)return;if(n.hasOwnProperty(o)){var a=n[o],s=a.type;s&&i.test(s)&&(t({file:a,count:n.length}),r=!0)}}}function r(e,t){"function"==typeof e&&void 0===t?(a=document,t=e):a=e,s=function(e){n(e,t)},a.addEventListener("dragenter",function(e){return e.preventDefault()}),a.addEventListener("dragover",function(e){return e.preventDefault()}),a.addEventListener("drop",s)}function o(){a.removeEventListener("drop",s)}var i=/image\/.*/,a=void 0,s=void 0;e.exports={listenDrag:r,unListenDrag:o}},function(e,t){var n=/image.*/,r=function(e,t){var r=e.clipboardData,o=r.items;if(void 0!==o)for(var i in o)if(o.hasOwnProperty(i)){var a=o[i],s=a.type;if("text/html"===s)return;if(s&&s.match(n)){var l=a.getAsFile();if(null===l)return;t({file:l})}}},o=void 0,i=void 0,a=function(e,t){"function"==typeof e&&void 0===t?(o=document,t=e):o=e,i=function(e){r(e,t)},o.addEventListener("paste",i)},s=function(){o.removeEventListener("paste",i)};e.exports={listenPaste:a,unListenPaste:s}},function(e,t,n){(function(r){function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=o(u),f=n(54),d=n(1591),p=o(d),h=n(834),m=n(926),g=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.headTpl=n.headTpl.bind(n),n.bodyTpl=n.bodyTpl.bind(n),n.footTpl=n.footTpl.bind(n),n.show=n.show.bind(n),n.close=n.close.bind(n),n.confirmLock=n._confirmLock.bind(n),n.confirmUnlock=n._confirmUnlock.bind(n),n.permissionChange=n._permissionChange.bind(n),n.updateUsers=n._updateUsers.bind(n),n.currentUserIsOwner=n._currentUserIsOwner.bind(n),n.currentUserIsTeamAdmin=n._currentUserIsTeamAdmin.bind(n),n.currentUserIsOutsider=n._currentUserIsOutsider.bind(n),n.isOwner=!1,n.isTeamAdmin=!1,n.isOutsider=!1,n.spread=null,n.sharedUserPermission,n.state={sheetIndex:0},n}return s(t,e),l(t,[{key:"componentDidMount",value:function(){this.props.getSharedUsers(window.cow.currentFile.guid)}},{key:"_permissionChange",value:function(e,t){this.sharedUserPermission[e].permission=t.value}},{key:"_confirmLock",value:function(){var e=this.props.onLock,t=this.state;e(t.sheet,t.selection,t.cellLock,this.sharedUserPermission)}},{key:"_confirmUnlock",value:function(){var e=this.props.onUnlock,t=this.state;e(t.sheet,t.cellLock)}},{key:"_updateUsers",value:function(e){this.sharedUserPermission=[];var t=[],n=[],r=[];for(var o in e){var i=e[o];if("readonly"!==i.role&&"commentator"!==i.role){var a={};a.id=i.id,a.avatar=i.avatar,a.name=i.name,a.isMe=i.id===cow.currentUser.id,a.email=i.email,a.isOutsider=i.isOutsider,a.isOwner="owner"===i.role,a.isTeamAdmin=i.teamId===window.cow.currentFile.teamId&&("admin"===i.teamRole||"creator"===i.teamRole),a.isMe&&(this.isOwner=a.isOwner,this.isTeamAdmin=a.isTeamAdmin,this.isOutsider=a.isOutsider),window.cow.currentFile.user_id===a.id?(a.isCreator=!0,t.push(a)):a.isMe?n.unshift(a):a.isOwner||a.isTeamAdmin?n.push(a):r.push(a)}}var s=this,l=[];l=l.concat(t,n,r),l.forEach(function(e){s.sharedUserPermission.push({id:e.id,permission:e.isOwner||e.isTeamAdmin||e.isMe?0:1})}),this.setState({operatorData:l})}},{key:"_currentUserIsOwner",value:function(){return this.isOwner}},{key:"_currentUserIsTeamAdmin",value:function(){return this.isTeamAdmin}},{key:"_currentUserIsOutsider",value:function(){return this.isOutsider}},{key:"_stringifySelection",value:function(e){var t=e.row,n=e.col,r=e.rowCount,o=e.colCount,i=(0,h.cellRange2LockRange)({row:t,col:n,rowCount:r,colCount:o});return i[0]+" : "+i[1]}},{key:"headTpl",value:function(e){return c.default.createElement("div",null,e,c.default.createElement("span",{className:"hicon icon-close lock-popup-close",onClick:this.close}))}},{key:"bodyTpl",value:function(){var e=this.state,t=e.selection,n=e.sheet,r=t&&this._stringifySelection(t),o=n.name();return c.default.createElement("div",{className:"lock-popup-body"},c.default.createElement("div",{className:"lock-popup-body-content"},c.default.createElement("span",null,"锁定范围"),c.default.createElement("div",{className:"lock-popup-range"},r||o)),c.default.createElement("div",{className:"lock-popup-body-content lock-popup-dash-line"},c.default.createElement("div",{className:"lock-popup-text-authority"},"设置权限")),c.default.createElement("div",{className:"lock-popup-body-content lock-popup-operator-wrap"},this.renderAuthority()))}},{key:"footTpl",value:function(){var e=this.state,t=e.sheet,n=e.cellLock,r=this.state.selection?!!n:(0,h.isWorksheetLocked)(t);return c.default.createElement("div",{className:"lock-popup-footer"},r&&c.default.createElement("span",{className:"lock-popup-remove-lock",onClick:this.confirmUnlock},"解除锁定"),c.default.createElement("button",{className:"btn btn-ok",onClick:this.confirmLock},"确定"))}},{key:"show",value:function(e,t,n){this.props.getSharedUsers(window.cow.currentFile.guid),this.setState({sheet:e,cellLock:n,selection:n?n[1].ranges[0]:t}),this.refs.dialog.show()}},{key:"close",value:function(){this.refs.dialog.close()}},{key:"renderAuthority",value:function(){var e,t=this,n=this.state,o=n.operatorData,i=n.cellLock,a=n.selection,s=(0,m.getSheetAttrs)(this.state.sheet,"lock");return e=a?i?i[1]:null:s,o?o.map(function(n,o){var i=1;return e&&r.includes(e.editable,n.id)&&(i=0),c.default.createElement("div",{key:o,className:"lock-popup-operator-list"},c.default.createElement("div",{className:"lock-popup-operator-item lock-popup-operator-avatar",style:{backgroundImage:'url("'+n.avatar+'")'}}),c.default.createElement("div",{className:"lock-popup-operator-item lock-popup-operator-name"},n.name+(n.isMe?"(我)":"")),c.default.createElement("div",{className:"lock-popup-operator-item lock-popup-operator-email"},n.email),n.isCreator||n.isOwner||n.isTeamAdmin||n.isMe?c.default.createElement("div",{className:"lock-popup-operator-item lock-popup-operator-owner"},n.isCreator?"所有者":"可以编辑"):c.default.createElement(p.default,{index:o,onChange:t.permissionChange,selectedIndex:i}))}):null}},{key:"render",value:function(){return c.default.createElement(f.Dialog,{ref:"dialog",title:this.state.selection?"锁定单元格":"锁定工作表",customClass:"lock-popup-dialog",hasActions:!1,keepCenter:!0,headTpl:this.headTpl,bodyTpl:this.bodyTpl,footTpl:this.footTpl})}}]),t}(c.default.Component);t.default=g,g.defaultProps={file:cow.currentFile},g.propTypes={file:c.default.PropTypes.object,getSharedUsers:c.default.PropTypes.func,lockpermission:c.default.PropTypes.object,onUnlock:c.default.PropTypes.func,onLock:c.default.PropTypes.func},e.exports=t.default}).call(t,n(1))},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(728),f=r(c),d=n(729),p=["可以编辑","只能查看"],h=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleActionClick=n.handleActionClick.bind(n),n}return a(t,e),s(t,[{key:"handleActionClick",value:function(e){var t=e.key,n=this.props.index,r="edit"===t;this.props.onChange(n,{value:r?0:1}),this.refs.showText.textContent=r?"可以编辑":"只能查看"}},{key:"renderPermissionOverlay",value:function(){return u.default.createElement(f.default,{className:"roles-menu",onClick:this.handleActionClick},u.default.createElement(f.default.Item,{className:"item-editable",key:"edit"},u.default.createElement("span",null,"可以编辑"),u.default.createElement("span",null,"锁定范围仍可编辑")),u.default.createElement(f.default.Item,{className:"item-commentable",key:"readOnly"},u.default.createElement("span",null,"只能查看"),u.default.createElement("span",null,"锁定范围可以查看、不能编辑")))}},{key:"render",value:function(){var e=this.props,t=e.selectedIndex,n=e.getPopupContainer;return u.default.createElement(d.Button,{mask:!0,getPopupContainer:n,overlay:this.renderPermissionOverlay()},u.default.createElement("span",{ref:"showText"},p[t]))}}]),t}(u.default.Component);t.default=h,h.defaultProps={selectedIndex:1,getPopupContainer:function(){return document.body}},h.propTypes={index:u.default.PropTypes.number,selectedIndex:u.default.PropTypes.number,getPopupContainer:u.default.PropTypes.func,onChange:u.default.PropTypes.func},e.exports=t.default},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(53),a=function(){function e(t,n,o,i,a){r(this,e),this.spread=t,this.composeUserChanges=n,this.enableUndoRedo=o,this.setSortCs=i,this.wrapCs=a,this.delayTimeout=null,this.delayActions=[],this.csQueue=[],this.csBlockQueue=[]}return o(e,[{key:"composeChange",value:function(e,t){var n=this;this.delayTimeout&&clearTimeout(this.delayTimeout),this.delayActions.push(e),t?this.delayTimeout=setTimeout(function(){return n.goToDispatch()}):this.goToDispatch()}},{key:"goToDispatch",value:function(){this.dispatchChange(this.delayActions),this.delayActions=[]}},{key:"dispatchChange",value:function(e){var t=this,n=this.spread._tab;e=e.map(function(e){return e.then?e:Promise.resolve(function(){return t.wrapCs(e)})});var r=function(){return Promise.all(e).then(function(e){return e.reduce(function(e,n){var r=n.call(t);return e.compose(r)},new i.Delta)})};if(this.csQueue.length>0)this.csBlockQueue.push(r);else{this.csQueue.push(r);var o=function(e){return e.reduce(function(e,n){return e.then(function(){return n().then(function(e){return t.composeUserChanges(e),null})})},Promise.resolve())};(function e(r){o(r).then(function(){t.csQueue=t.csBlockQueue,t.csBlockQueue=[],0===t.csQueue.length?(t.enableUndoRedo(),n.disableNewTab=!1,t.setSortCs()):(n.disableNewTab=!0,e(t.csQueue))})})(this.csQueue)}}},{key:"isEmptyQueue",value:function(){return 0===this.csQueue.length&&0===this.csBlockQueue.length}}]),e}();t.default=a,e.exports=t.default},function(e,t,n){(function(t){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var i=n(0),a=r(i),s=n(53),l=r(s),u=n(54),c=n(9),f=r(c),d=n(5),p=r(d),h=n(581),m=n(34),g=r(m),_=n(1139),v=n(1594),y=r(v),b=n(1595),w=r(b),C=n(1596),S=r(C),x=n(1154),T=r(x),E=n(552),M=r(E),A=n(746),k=r(A),R=y.default.menuDefault,I=y.default.menuItems,O=window.cow.currentUser.id<0;e.exports=a.default.createClass({displayName:"exports",propTypes:{selection:i.PropTypes.object,offline:i.PropTypes.bool,disableUndoRedo:i.PropTypes.bool,disableByLockCell:i.PropTypes.bool},getInitialState:function(){return{searchShow:!1,newSheetBorder:!0,newSheetLink:!0,newSheetRule:!0,borderIndex:-1,borderColor:R.borderColor,borderStyle:R.borderStyle}},componentDidMount:function(){f.default.attach("search:showed",this._showSearch),f.default.attach("search:closed",this._hideSearch),f.default.attach("spreadsheet:exit",this._hideSidebar)},componentWillReceiveProps:function(e){var n=e.selection;this.props.selection!==n&&this.setState(t.assign.call(null,{},n))},componentWillUnmount:function(){f.default.detach("search:showed",this._showSearch),f.default.detach("search:closed",this._hideSearch),f.default.detach("spreadsheet:exit",this._hideSidebar)},_hideSidebar:function(){this.props.hideSidebar()},_isGuideSheet:function(){return"?from=new-sheet-guide"===location.search&&window.cow.currentUser.id>0},_showSearch:function(){this._updateSearchState(!0)},_hideSearch:function(){this._updateSearchState(!1)},_updateSearchState:function(e){this.setState({searchShow:e})},render:function(){var e=this,t=R.align,n=R.vertical,r=R.wrap,o=R.colorValue,i="",s=0,l="s-menu",c=this.state.conditionalFormatNumber,f=this.props.disableByLockCell;this.props.offline&&(l+=" offline-menu"),(0,_.isHasEditPermission)()||(l+=" s-menu-disabled"),this.state.align&&(t=this._findIndex(I.align,this.state.align)),this.state.vertical&&(n=this._findIndex(I.vertical,this.state.vertical)),this.state.wrap&&(r=this._findIndex(I.wrap,this.state.wrap)),this.state.format&&(s=this._findIndex(I.format,this.state.format));try{this.state.color&&(o=(0,T.default)(this.state.color).hex().toLowerCase()),this.state.background&&(i=(0,T.default)(this.state.background).hex().toLowerCase()),this.state.borderColor&&(0,T.default)(this.state.borderColor).hex().toLowerCase()}catch(e){console.error("无法识别的颜色格式")}return a.default.createElement("div",{className:l,onMouseDown:this._onMouseDown},a.default.createElement(u.IconButton,{tooltip:"撤销",tipClass:"s-tooltip",iconBtnClass:"s-toolbar-icon s-toolbar-icon-go-ahead",onBtnTap:function(){return e.delayUndoRedo("undo")}}),a.default.createElement(u.IconButton,{tooltip:"重做",tipClass:"s-tooltip",iconBtnClass:"s-toolbar-icon s-toolbar-icon-retreat",onBtnTap:function(){return e.delayUndoRedo("redo")}}),a.default.createElement(u.IconButton,{customClass:this.state.paintSelected?"selected":"",tooltip:this.state.paintSelected?"取消格式刷":"格式刷，双击使用连续格式刷",tipClass:"s-tooltip",iconBtnClass:"s-toolbar-icon s-toolbar-icon-paint",onDoubleClick:this.keepPaintFormat,onBtnTap:this.paintFormat}),a.default.createElement(u.IconButton,{tooltip:"清除格式",tipClass:"s-tooltip",iconBtnClass:"s-toolbar-icon s-toolbar-icon-clear-format",customClass:f?"disabled":"",onBtnTap:this.clearFormat}),a.default.createElement("span",{className:"toolbar-separator"}),a.default.createElement(u.DropdownMenu,{menuItems:I.format,tooltip:"格式",tipClass:"s-tooltip",displayKey:"display",valKey:"value",wrapClassName:"dropdown-menu-format"+(f?" disabled":""),forceTap:!0,autoHeight:!0,itemTpl:this._formatItemTpl,selectedTpl:this._formatSelectedTpl,selectedIndex:s,onMenuChange:this._formatChange}),a.default.createElement(u.DropdownMenu,{menuItems:I["font-size"],displayKey:"display",valKey:"value",tooltip:"字号",tipClass:"s-tooltip",wrapClassName:"dropdown-menu-font-size"+(f?" disabled":""),forceTap:!0,itemTpl:this._fontSizeTpl,selectedTpl:this._fontSizeSelectedTpl,onMenuChange:this._fontSizeChange}),a.default.createElement(u.IconButton,{customClass:(this.state.boldSelected?"selected":"")+(f?" disabled":""),tooltip:"粗体",tipClass:"s-tooltip",iconBtnClass:"s-toolbar-icon s-toolbar-icon-bold",onBtnTap:this.bold}),a.default.createElement(u.IconButton,{customClass:(this.state.italicSelected?"selected":"")+(f?" disabled":""),tooltip:"斜体",tipClass:"s-tooltip",iconBtnClass:"s-toolbar-icon s-toolbar-icon-italic",onBtnTap:this.italic}),a.default.createElement(u.IconButton,{customClass:(this.state.underlineSelected?"selected":"")+(f?" disabled":""),tooltip:"下划线",tipClass:"s-tooltip",iconBtnClass:"s-toolbar-icon s-toolbar-icon-underline",onBtnTap:this.underline}),a.default.createElement(u.IconButton,{customClass:(this.state.strikethroughSelected?"selected":"")+(f?" disabled":""),tooltip:"中划线",tipClass:"s-tooltip",iconBtnClass:"s-toolbar-icon s-toolbar-icon-strikethrough",onBtnTap:this.strikethrough}),a.default.createElement(S.default.Color,{type:"font",tooltip:"字体颜色",defaultColor:"#2b2b2b",colorInputPlaceholder:"",onSelect:this.onFontColorSelect,color:o,customClass:f?"disabled":""}),a.default.createElement("span",{className:"toolbar-separator"}),a.default.createElement(S.default.Color,{type:"background",tooltip:"背景颜色",colorInputPlaceholder:"无填充",onSelect:this.onBackgroundColorSelect,color:i,customClass:f?"disabled":""}),a.default.createElement(u.DropdownMenu,{menuItems:I.border,displayKey:"display",valKey:"value",tooltip:"边框线",tipClass:"s-tooltip",wrapClassName:"dropdown-menu-border"+(f?" disabled":""),forceTap:!0,itemTpl:this._borderItemTpl,selectedTpl:this._borderSelectedTpl,selectedIndex:this.state.borderIndex,keepOpen:!0,onClose:this._borderClose,onMenuChange:this._borderChange,onTap:function(){return e._updateGuideStatus("border")}}),a.default.createElement(u.IconButton,{customClass:(this.state.selectionIsMergedCells?"selected":"")+(f?" disabled":""),tooltip:"合并单元格",tipClass:"s-tooltip",iconBtnClass:"s-toolbar-icon s-toolbar-icon-mergecells",onBtnTap:this.mergeOrUnmergeCells}),a.default.createElement("span",{className:"toolbar-separator"}),a.default.createElement(u.DropdownMenu,{menuItems:I.align,displayKey:"display",valKey:"value",tooltip:"水平对齐",tipClass:"s-tooltip",wrapClassName:"dropdown-menu-align"+(f?" disabled":""),forceTap:!0,itemTpl:this._alignItemTpl,selectedTpl:this._alignSelectedTpl,selectedIndex:t,onMenuChange:this._alignChange}),a.default.createElement(u.DropdownMenu,{menuItems:I.vertical,displayKey:"display",valKey:"value",tooltip:"垂直对齐",tipClass:"s-tooltip",wrapClassName:"dropdown-menu-vertical"+(f?" disabled":""),forceTap:!0,itemTpl:this._verticalItemTpl,selectedTpl:this._verticalSelectedTpl,selectedIndex:n,onMenuChange:this._verticalChange}),a.default.createElement(u.DropdownMenu,{menuItems:I.wrap,displayKey:"display",valKey:"value",tooltip:"文本换行",tipClass:"s-tooltip",wrapClassName:"dropdown-menu-text-wrap"+(f?" disabled":""),forceTap:!0,itemTpl:this._wrapItemTpl,selectedTpl:this._wrapSelectedTpl,selectedIndex:r,onMenuChange:this._wrapChange}),a.default.createElement("span",{className:"toolbar-separator"}),a.default.createElement(u.IconButton,{customClass:this.state.freezeSelected?"selected":"",tooltip:"冻结",tipClass:"s-tooltip",iconBtnClass:"s-toolbar-icon s-toolbar-icon-freeze",onBtnTap:this._freezeChange}),a.default.createElement(u.DropdownMenu,{menuItems:I.sort,displayKey:"display",valKey:"value",tooltip:"排序",tipClass:"s-tooltip",wrapClassName:"dropdown-menu-sort"+(f?" disabled":""),forceTap:!0,itemTpl:this._sortItemTpl,selectedTpl:this._sortSelectedTpl,onMenuChange:this._sortChange}),a.default.createElement(u.DropdownMenu,{menuItems:I.filter,displayKey:"display",valKey:"value",tooltip:"筛选",tipClass:"s-tooltip",wrapClassName:"dropdown-menu-filter"+(f?" disabled":""),forceTap:!0,itemTpl:this._commonTpl,selectedTpl:this._filterSelectedTpl,onMenuChange:this._filterChange}),a.default.createElement(u.IconButton,{customClass:(c?"selected":"")+(f?" disabled":""),tooltip:c?c+"条规则":"条件格式",tipClass:"s-tooltip",iconBtnClass:"s-toolbar-icon s-toolbar-icon-conditional-format",onBtnTap:this.showConditionalFormat,iconBtnTpl:this._commonIconBtnTpl.bind(this,"newSheetRule")}),a.default.createElement(u.DropdownMenu,{menuItems:I.formula,displayKey:"display",valKey:"value",tooltip:"公式",tipClass:"s-tooltip",wrapClassName:"formula-menu"+(f?" disabled":""),forceTap:!0,itemTpl:this._formulaItemTpl,selectedTpl:this._formulaSelectedTpl,onMenuChange:this._formulaChange}),a.default.createElement("span",{className:"toolbar-separator"}),a.default.createElement(u.IconButton,{customClass:f?"disabled":"",tooltip:"插入链接",tipClass:"s-tooltip",iconBtnClass:"s-toolbar-icon s-toolbar-icon-link",onBtnTap:this.insertLink,iconBtnTpl:this._commonIconBtnTpl.bind(this,"newSheetLink")}),a.default.createElement("div",{className:"upload-item-wrap"},a.default.createElement(w.default,{tooltip:"",tipClass:"s-tooltip",accept:[".png",".gif",".jpg",".jpeg"].join(),iconBtnClass:"s-toolbar-icon s-toolbar-icon-img",onClick:this.beforeUploadImage,onChange:this.uploadImage}),a.default.createElement("span",{className:"tooltip upload-item-tooltip s-tooltip"},"上传图片")),a.default.createElement(u.IconButton,{customClass:(this.state.searchShow?"selected":"")+(f?" disabled":""),tooltip:"查找替换",tipClass:"s-tooltip",iconBtnClass:"s-toolbar-icon s-toolbar-icon-search",onBtnTap:this.triggerSearch}),a.default.createElement("span",{className:"toolbar-separator"}),!O&&a.default.createElement("div",{className:"s-toolbar-version",onClick:this.saveVersion},a.default.createElement("span",{className:"s-toolbar-version-text"},a.default.createElement("span",{className:"s-toolbar-icon s-toolbar-icon-save"}),"创建版本"),a.default.createElement("span",{className:"tooltip s-tooltip"},"将当前表格生成一个历史版本")))},keepPaintFormat:function(){f.default.notify("menu:paintFormat",{paintSelected:!0,keep:!0}),this._setState({paintSelected:!0})},paintFormat:function(){f.default.notify("menu:paintFormat",{paintSelected:!this.state.paintSelected,keep:!1}),this._setState({paintSelected:!this.state.paintSelected})},clearFormat:function(){f.default.notify("menu:clearFormat")},timeoutId:null,recordType:"",delayUndoRedo:function(e){var t=this;if(this.props.disableUndoRedo)return void p.default.alert({title:"正在计算中，请稍后重试"});this.recordType||(this.recordType=e),this.timeoutId&&clearTimeout(this.timeoutId),this.timeoutId=setTimeout(function(){"undo"===t.recordType?t.undo():t.redo(),t.recordType=""},150)},undo:function(){this.props.undo()},redo:function(){this.props.redo()},bold:function(){f.default.notify("menu:style","bold",!this.state.boldSelected),this._setState({boldSelected:!this.state.boldSelected})},italic:function(){f.default.notify("menu:style","italic",!this.state.italicSelected),this._setState({italicSelected:!this.state.italicSelected})},underline:function(){f.default.notify("menu:style","underline",!this.state.underlineSelected),this._setState({underlineSelected:!this.state.underlineSelected})},strikethrough:function(){f.default.notify("menu:style","strike",!this.state.strikethroughSelected),this._setState({strikethroughSelected:!this.state.strikethroughSelected})},mergeOrUnmergeCells:function(){f.default.notify("menu:mergeOrUnmergeCells")},unMergeCells:function(){f.default.notify("menu:unMergeCells")},insertLink:function(){f.default.notify("menu:link"),this._updateGuideStatus("link")},beforeUploadImage:function(e){this.props.offline&&(p.default.alert({title:"网络连接错误，请在网络恢复后重试",type:"error"}),e.preventDefault())},uploadImage:function(e){e.target.files.length>0&&f.default.notify("menu:uploadImage",e)},triggerSearch:function(){this.state.searchShow?f.default.notify("search:close"):f.default.notify("search:show")},showConditionalFormat:function(){f.default.notify("conditionalFormat:show"),this._updateGuideStatus("rule")},_setState:function(e){this.props.setMenuSelection(e)},_findIndex:function(e,n,r){var o;return r=r||"value",o=t.findIndex(e,function(e){return e[r]===n}),-1===o&&(o=0),o},_fontSizeTpl:function(e,t,n,r,o){var i=t[o];return a.default.createElement("div",{"data-val":i},a.default.createElement("span",{className:"menu-item-icon"}),a.default.createElement("span",{className:"menu-item-text"},i))},_fontSizeSelectedTpl:function(){var e=this.state.fontSize||R.fontSize;return a.default.createElement("div",{"data-val":e},a.default.createElement("span",{className:"menu-item-text"},e),a.default.createElement("span",{className:"menu-item-selected-icon s-toolbar-icon"}))},_fontSizeChange:function(e,t,n){this._setState({fontSize:n.value}),f.default.notify("menu:style","font-size",t===R.fontSizeIndex?null:n.value),e.stopPropagation()},_commonTpl:function(e,t,n,r,o){var i=t[r],s=t[o];return a.default.createElement("div",{"data-val":s},a.default.createElement("span",{className:"menu-item-text"},i))},_formulaItemTpl:function(e,t,n,r,o){var i=t[r],s=t[o];return a.default.createElement("div",{"data-val":s},a.default.createElement("span",{className:"menu-item-text"},i),t.tooltip&&a.default.createElement("span",{className:"tooltip s-tooltip left"},t.tooltip))},_formulaSelectedTpl:function(){return a.default.createElement("div",null,a.default.createElement("span",{className:"menu-item-text menu-item-selected-text"},a.default.createElement("span",{className:"s-toolbar-icon s-toolbar-icon-formula"}),"公式"),a.default.createElement("span",{className:"menu-item-selected-icon s-toolbar-icon"}))},_formulaChange:function(e,t,n){var r=n.value;e.stopPropagation(),"command:moreFormulas"===r?this.props.toogleSidebar("formula"):f.default.notify("menu:formulaChange",r)},_viewSelectedTpl:function(){return a.default.createElement("div",null,a.default.createElement("span",{className:"menu-item-text"},"查看"),a.default.createElement("span",{className:"menu-item-selected-icon s-toolbar-icon"}))},_viewTpl:function(e,t,n,r,o){var i=t[r],s=t[o],l="history"===this.props.spreadsheet.shownSidebar;return a.default.createElement("div",{"data-val":s},a.default.createElement("span",{className:"menu-item-text"},i),l?a.default.createElement("span",{className:"new-icon new-icon-checkone"}):null)},onBackgroundColorSelect:function(e,t){this._setState({background:e}),f.default.notify("menu:style","background",""===e?null:e)},onFontColorSelect:function(e,t){this._setState({color:e}),f.default.notify("menu:style","color",e===R.color?null:e)},onBorderColorSelect:function(e,t){var n=this.state,r=n.borderIndex,o=n.borderStyle;this.setState({borderColor:e}),-1!==r&&(border=I.border[r].value,f.default.notify("menu:border",[border,e,o]))},_borderItemTpl:function(e,t,n,r,o){var i=t[o],s=t[r],l=this.state,c=l.borderColor,f=l.borderStyle,d=this._findIndex(I["border-style"],f);return 4===e?a.default.createElement("div",{id:"color-picker-wrap",className:"dropmenu-wrap"},a.default.createElement(S.default.Color,{getPopupContainer:function(){return document.querySelector("#color-picker-wrap")},type:"border",tooltip:"边框颜色",colorInputPlaceholder:"无填充",onSelect:this.onBorderColorSelect,color:c})):9===e?a.default.createElement("div",{className:"dropmenu-wrap"},a.default.createElement(u.DropdownMenu,{menuItems:I["border-style"],displayKey:"display",valKey:"value",tooltip:"边框样式",tipClass:"s-tooltip",wrapClassName:"dropdown-menu-border-style",forceTap:!0,itemTpl:this._borderStyleItemTpl,selectedTpl:this._borderStyleSelectedTpl,selectedIndex:d,onMenuChange:this._borderStyleChange})):a.default.createElement("div",{"data-val":i,className:"border-menu-item"},a.default.createElement("span",{className:"s-toolbar-icon s-toolbar-icon-border-"+i}),a.default.createElement("span",{className:"tooltip s-tooltip left"},s))},_borderStyleItemTpl:function(e,t,n,r,o){var i=(t[r],t[o]);return a.default.createElement("div",{"data-val":i,className:"border-style-menu-item"},a.default.createElement("span",{className:"s-toolbar-icon s-toolbar-icon-border-style-"+i}," "))},_borderStyleSelectedTpl:function(e,t,n,r){var o=t[r];return a.default.createElement("div",{"data-val":o},a.default.createElement("span",{className:"s-toolbar-icon s-toolbar-icon-border-style"}),a.default.createElement("span",{className:"menu-item-selected-icon s-toolbar-icon"}))},_borderStyleChange:function(e,t,n){e.stopPropagation();var r=this.state,o=r.borderIndex,i=r.borderColor;if(this.setState({borderStyle:n.value}),-1!==o){var a=I.border[o].value;f.default.notify("menu:border",[a,i,n.value])}},_borderSelectedTpl:function(e,t,n,r){return a.default.createElement("div",null,a.default.createElement("span",{className:"s-toolbar-icon s-toolbar-icon-border-all"}),a.default.createElement("span",{className:"menu-item-selected-icon s-toolbar-icon"}),this._isGuideSheet()&&!this.state.newSheetBorder&&a.default.createElement(k.default,null))},_borderChange:function(e,t,n){if(!([4,9].indexOf(t)>-1)){var r=this.state,o=r.borderColor,i=r.borderStyle;f.default.notify("menu:border",[n.value,o,i]),this.setState({borderIndex:t})}},_borderClose:function(){this.setState({borderIndex:-1,borderColor:R.borderColor,borderStyle:R.borderStyle})},_alignItemTpl:function(e,t,n,r,o){var i=t[o];return a.default.createElement("div",{"data-val":i,className:"align-menu-item"},a.default.createElement("span",{className:"s-toolbar-icon s-toolbar-icon-align-"+i}),a.default.createElement("span",{className:"tooltip s-tooltip left"},t.display))},_alignSelectedTpl:function(e,t,n,r){var o=t[r];return a.default.createElement("div",{"data-val":o},a.default.createElement("span",{className:"s-toolbar-icon s-toolbar-icon-align-"+o}),a.default.createElement("span",{className:"menu-item-selected-icon s-toolbar-icon"}))},_alignChange:function(e,t,n){e.stopPropagation(),this._setState({align:n.value}),f.default.notify("menu:style","align",n.value)},_verticalItemTpl:function(e,t,n,r,o){var i=t[r],s=t[o];return a.default.createElement("div",{"data-val":s,className:"vertical-menu-item"},a.default.createElement("span",{className:"s-toolbar-icon s-toolbar-icon-vertical-"+s}),a.default.createElement("span",{className:"tooltip s-tooltip left"},i))},_verticalSelectedTpl:function(e,t,n,r){var o=t[r];return a.default.createElement("div",{"data-val":o},a.default.createElement("span",{className:"menu-item-text color-menu-selected"},a.default.createElement("span",{className:"s-toolbar-icon s-toolbar-icon-vertical-"+o})),a.default.createElement("span",{className:"menu-item-selected-icon s-toolbar-icon"}))},_verticalChange:function(e,t,n){e.stopPropagation(),this._setState({vertical:n.value}),f.default.notify("menu:style","vertical",t===R.vertical?null:n.value)},_wrapItemTpl:function(e,t,n,r,o){var i=t[o],s=t[r];return"text-no-wrap"===i&&(i="text-overflow"),a.default.createElement("div",{"data-val":i,className:"wrap-menu-item"},a.default.createElement("span",{className:"s-toolbar-icon s-toolbar-icon-"+i}),a.default.createElement("span",{className:"tooltip s-tooltip left"},s))},_wrapSelectedTpl:function(e,t,n,r){var o=t[r];return"text-no-wrap"===o&&(o="text-overflow"),a.default.createElement("div",{"data-val":o},a.default.createElement("span",{className:"menu-item-text"},a.default.createElement("span",{className:"s-toolbar-icon s-toolbar-icon-"+o})),a.default.createElement("span",{className:"menu-item-selected-icon s-toolbar-icon"}))},_wrapChange:function(e,t,n){e.stopPropagation(),this._setState({wrap:n.value}),f.default.notify("menu:style","wrap",t===R.wrap?null:n.value)},_sortItemTpl:function(e,t,n,r,o){var i=t[o],s=t[r],u=s,c=this.state.selectedCell,f="";if(c){var d=l.default.stringifyPosition(c[0],c[4]).replace(/\d/g,"");switch(i){case"asc":u="将表格按照"+d+"列排序, A --\x3e Z";break;case"desc":u="将表格按照"+d+"列排序, Z --\x3e A";break;case"asc-area":u="将选中区域按照"+d+"列排序, A --\x3e Z";break;case"desc-area":u="将选中区域按照"+d+"列排序, Z --\x3e A"}}return this._disableAreaSort(c,i)&&(f=" disabled",u="选中多行后才能使用"),a.default.createElement("div",{"data-val":i,className:"sort-menu-item"+f},a.default.createElement("span",{className:"menu-item-text"},s),a.default.createElement("span",{className:"tooltip s-tooltip left"},u))},_sortSelectedTpl:function(e,t,n,r){var o=t[r];return a.default.createElement("div",null,a.default.createElement("span",{className:"menu-item-text"},a.default.createElement("span",{className:"s-toolbar-icon s-toolbar-icon-sort-"+o})),a.default.createElement("span",{className:"menu-item-selected-icon s-toolbar-icon"}))},_disableAreaSort:function(e,t){return t.indexOf("area")>-1&&(!e||e[0]===e[2])},_sortChange:function(e,t,n){this._disableAreaSort(this.state.selectedCell,n.value)||(e.stopPropagation(),f.default.notify("menu:sort",n.value))},_freezeChange:function(e){e.stopPropagation(),f.default.notify("menu:freeze")},_filterSelectedTpl:function(){return a.default.createElement("div",null,a.default.createElement("span",{className:"s-toolbar-icon",style:{width:"27px",backgroundPosition:"-118px -54px"}}),a.default.createElement("span",{className:"menu-item-selected-icon s-toolbar-icon"}))},_filterChange:function(e,t,n){e.stopPropagation(),f.default.notify("menu:filter",n.value)},_commonIconBtnTpl:function(e){return this._isGuideSheet()&&!this.state[e]?a.default.createElement(k.default,null):null},_formatItemTpl:function(e,t,n,r,o){var i=t[r],s=t[o];return a.default.createElement("div",{"data-val":s,style:{position:"relative"}},a.default.createElement("span",{className:"menu-item-text"},i),n&&a.default.createElement("span",{className:"format-menu-item-selected-icon s-toolbar-icon"}),a.default.createElement(u.Tooltip,{tip:t.label,isShow:!0,customClass:"format-menu-tooltip"}))},_formatSelectedTpl:function(){return a.default.createElement("div",null,a.default.createElement("span",{className:"menu-item-text"},"123"),a.default.createElement("span",{className:"menu-item-selected-icon s-toolbar-icon"}))},_formatChange:function(e,t,n){(0,h.track)("old_sheet","font_color",n.display),e.stopPropagation(),this._setState({format:n.value}),f.default.notify("menu:style","format",n.value)},_onMouseDown:function(){f.default.notify("menu:mousedown")},_updateGuideStatus:function(e){if(this._isGuideSheet()){var t={border:"newSheetBorder",rule:"newSheetRule",link:"newSheetLink"},n=this.state[t[e]];this.setState(o({},t[e],!0)),n||M.default.removeTipAjax("new_sheet_"+e)}},saveVersion:function(){if(this.props.offline)return void p.default.alert({title:"网络连接错误，请在网络恢复后重试",type:"error"});var e=window.cow.currentFile.guid;g.default.post("/smapi/files/"+e+"/revisions",{label:this.formatTime()},function(){(0,d.alert)({title:"版本创建成功，可在历史面板中查看"})},function(e){var t=e.code;(0,d.alert)({title:400===t?"不能重复创建版本":"保存版本失败",type:"error"})})},formatTime:function(e){var t=e?new Date(e):new Date,n=["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],r=t.getMinutes(),o=t.getHours();return r<10&&(r="0"+r),o<10&&(o="0"+o),t.getFullYear()+"/"+(t.getMonth()+1)+"/"+t.getDate()+" "+n[t.getDay()]+" "+o+":"+r}})}).call(t,n(1))},function(e,t){var n={menuItems:{format:[{display:"常规",value:"normal",label:"常规",type:"divider"},{display:"1,234",value:"0,0",label:"数字"},{display:"1,234.56",value:"0,0.00",label:"数字"},{display:"12%",value:"0%",label:"百分比"},{display:"12.34%",value:"0.00%",label:"百分比"},{display:"1.01E+03",value:"0.00E+00",label:"科学计数",type:"divider"},{display:"(1,234)",value:"(0,0)",label:"财务数值"},{display:"(1,234.56)",value:"(0,0.00)",label:"财务数值",type:"divider"},{display:"¥1,234",value:"¥0,0",label:"货币"},{display:"¥1,234.56",value:"¥0,0.00",label:"货币"},{display:"$1,234",value:"$0,0",label:"货币"},{display:"$1,234.56",value:"$0,0.00",label:"货币",type:"divider"},{display:"2014/05/06",value:"YYYY/MM/DD",label:"日期"},{display:"2014-05-06",value:"YYYY-MM-DD",label:"日期",type:"divider"},{display:"05:06:00",value:"HH:mm:ss",label:"时间"},{display:"2014/05/06 05:06:00",value:"YYYY/MM/DD HH:mm:ss",label:"日期时间"}],"font-size":[{value:"9"},{value:"10"},{value:"11"},{value:"12"},{value:"14"},{value:"18"},{value:"24"},{value:"30"},{value:"36"}],align:[{display:"左对齐",value:"left"},{display:"居中对齐",value:"center"},{display:"右对齐",value:"right"}],vertical:[{display:"顶部对齐",value:"top"},{display:"居中对齐",value:"middle"},{display:"底部对齐",value:"bottom"}],wrap:[{display:"溢出",value:"text-no-wrap"},{display:"自动换行",value:"text-wrap"}],sort:[{display:"升序",value:"asc"},{display:"降序",value:"desc"},{display:"按范围升序",value:"asc-area"},{display:"按范围降序",value:"desc-area"}],freeze:[{display:"冻结行",value:"freeze-row"},{display:"冻结列",value:"freeze-col"},{display:"冻结行和列",value:"freeze-row-col"},{display:"无冻结",value:"unfreeze-row-col"}],filter:[{display:"新建筛选",value:"new-filter"},{display:"清除筛选",value:"clear-filter"},{display:"删除筛选",value:"delete-filter"}],formula:[{display:"SUM(求和)",value:"SUM"},{display:"AVERAGE(平均值)",value:"AVERAGE"},{display:"COUNT(计数)",value:"COUNT"},{display:"MAX(最大值)",value:"MAX"},{display:"MIN(最小值)",value:"MIN",type:"divider"},{display:"更多函数",value:"command:moreFormulas",tooltip:"支持400多种函数"}],actions:[{display:"导出 Excel",command:"export"},{display:"删除表格",command:"delete",class:"menu-item-delete"},{display:"退出共享",command:"exit"}],views:[{display:"历史",command:"history"}],border:[{display:"所有边框",value:"all"},{display:"外边框",value:"outter"},{display:"内边框",value:"inner"},{display:"无边框",value:"none"},{display:"边框颜色",value:"color"},{display:"左边框",value:"left"},{display:"右边框",value:"right"},{display:"上边框",value:"top"},{display:"下边框",value:"bottom"},{display:"边框样式",value:"style",type:"dropdown"}],"border-style":[{display:"实线",value:1},{display:"粗实线",value:2},{display:"虚线",value:4},{display:"点划线",value:7}]},menuDefault:{fontSize:9,fontSizeIndex:0,colorValue:"#2b2b2b",colorIndex:37,align:0,vertical:1,wrap:0,borderStyle:1,borderColor:"#2b2b2b"},icons:[{tooltip:"全部已读",iconBtnClass:"fa fa-check"},{tooltip:"消息设置",iconBtnClass:"fa fa-cog"},{tooltip:"关机",iconBtnClass:"fa fa-power-off"},{tooltip:"删除",iconBtnClass:"fa fa-remove"},{tooltip:"分享",iconBtnClass:"fa fa-share"},{tooltip:"编辑",iconBtnClass:"fa fa-pencil"},{tooltip:"条形图",iconBtnClass:"fa fa-bar-chart"},{tooltip:"两端对齐",iconBtnClass:"fa fa-align-justify"}]};!function(){for(var e=[[1,23,29,30,31,32,33,34,35],[8,36,3,37,4,5,38,6,7],[39,2,10,40,11,12,41,13,14],[15,9,17,42,18,19,43,20,21],[22,16,24,44,25,26,45,27,28]],t=[["无填充","漆黑","红","橙","黄","葱绿","湖蓝","天色","紫"],["白练","鼠","虹","薄卵","蒸栗","白绿","蓝白","天空","紫水晶"],["白鼠","墨","甚三红","雄黄","金子","薄青","白群","薄花","紫苑"],["灰青","石墨","红绯","红金","枯茶","绿青","浅葱","薄缥","紫霞"],["薄钝","黑","朱绯","褐","黑茶","深绿","苍蓝","琉璃","葡萄"]],r=[["","#0d0015","#fe2c23","#ff9900","#ffd900","#a3e043","#37d9f0","#4da8ee","#aa17d0"],["#f3f3f1","#949494","#fcdbd6","#fde9d0","#fff0cf","#d4e9d6","#def3f3","#cee0ef","#dfdbec"],["#dcdedd","#595856","#ee837d","#f8c387","#e6b322","#9abd9d","#83ccd2","#89b0ce","#9389b1"],["#c1c6ca","#41464b","#d51228","#cf770b","#8d634a","#557b5c","#01a3b0","#3776a6","#765c83"],["#adadad","#2b2b2b","#a91913","#884702","#563725","#00552e","#00767a","#194e77","#530e6f"]],o=[["#e2e2e2","#07000c","#e52820","#e68a00","#e6c400","#93ca3c","#32c4d8","#4598d7","#9915bc"],["#d8d8d6","#858585","#dfc2bd","#e4d2bc","#e2d5b8","#bccebd","#c8dbdb","#b7c7d4","#c6c2d1"],["#c6c8c7","#504f4e","#d3746f","#e0b07a","#cfa11f","#88a88b","#76b8bd","#799cb7","#82799d"],["#abafb3","#393e43","#bc1024","#bb6b0a","#7d5842","#4b6d52","#01939f","#316893","#685274"],["#9c9c9c","#262626","#961711","#7b4002","#4c3121","#004b28","#006a6e","#174569","#490c62"]],i=r[0].length,a=r.length,s=[],l=[],u={},c={},f=0;f<a;f++)for(var d=e[f],p=t[f],h=r[f],m=o[f],g=0;g<i;g++)colorObj={name:p[g],display:h[g],border:m[g],value:d[g]},s.push(colorObj),l.push(colorObj),u[d[g]]=h[g],c[h[g]]=d[g];n.menuItems.color=s,n.menuItems.background=l,n.colorsMap=u,n.colorValKeyMap=c}(),e.exports=n},function(e,t,n){var r=n(0);e.exports=r.createClass({displayName:"exports",getDefaultProps:function(){return{accept:"*"}},getInitialState:function(){return{upload_state:null}},handleSubmit:function(e){e.preventDefault()},render:function(){return r.createElement("form",{className:"upload-item-form",onSubmit:this.handleSubmit,encType:"multipart/form-data"},r.createElement("span",{className:"upload-item-icon "+this.props.iconBtnClass}),r.createElement("input",{type:"file",className:"upload-item-file",title:this.props.tooltip,accept:this.props.accept,onClick:this.props.onClick,onChange:this.props.onChange}))}})},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(1597),i=r(o);t.default={Color:i.default},e.exports=t.default},function(e,t,n){(function(r){function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(0),f=o(c),d=n(1461),p=o(d),h=n(271),m=o(h),g=n(1463),_=o(g),v=n(256),y=o(v),b=n(5),w=o(b);n(1598);var C=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={colors:(0,_.default)(e.type||"background"),popoverVisible:!1},n.componentClick=n.componentClick.bind(n),n.onSelect=n.onSelect.bind(n),n.onMenuItemClick=n.onMenuItemClick.bind(n),n.onMenuItemMouseEnter=n.onMenuItemMouseEnter.bind(n),n.onMenuItemMouseOut=n.onMenuItemMouseOut.bind(n),n.toggleColorPicker=n.toggleColorPicker.bind(n),n}return s(t,e),u(t,null,[{key:"propTypes",get:function(){return{tooltip:c.PropTypes.string,color:c.PropTypes.string,defaultColor:c.PropTypes.string,onInvalidate:c.PropTypes.func,onSelect:c.PropTypes.func,type:c.PropTypes.oneOf(["background","font","border"]),colorInputPlaceholder:c.PropTypes.string}}},{key:"defaultProps",get:function(){return{color:"",onInvalidate:function(){w.default.alert({title:"颜色值不合法",type:"error"})},onSelect:function(){},colorInputPlaceholder:"无填充",defaultColor:""}}}]),u(t,[{key:"componentClick",value:function(e){if(this.state.popoverVisible){if(e.target.closest(".sm-color-picker")&&!e.target.closest(".color-picker-list"))return;this.setState({popoverVisible:!1,tooltipVisible:!1})}}},{key:"onSelect",value:function(e,t){"font"===this.props.type&&""===e?this.props.onInvalidate():this.props.onSelect(e,t)}},{key:"onMenuItemClick",value:function(){var e=this.props,t=e.color,n=e.onSelect;n&&n(t)}},{key:"onMenuItemMouseEnter",value:function(){this.state.popoverVisible||this.setState({tooltipVisible:!0})}},{key:"onMenuItemMouseOut",value:function(){this.setState({tooltipVisible:!1})}},{key:"toggleColorPicker",value:function(){var e=this.state.popoverVisible;this.setState({popoverVisible:!e,tooltipVisible:e})}},{key:"render",value:function(){var e=this.props,t=e.color,n=e.type,o=e.customClass,i={backgroundColor:t},a=r.assign({},this.props,{onSelect:this.onSelect});return f.default.createElement(p.default,l({},a,{trigger:"none",visible:this.state.popoverVisible,colors:this.state.colors}),f.default.createElement(m.default,{title:this.props.tooltip,trigger:"hover",placement:"bottom",visible:this.state.tooltipVisible,align:{offset:[0,0]}},f.default.createElement("div",{className:"sm-toolbar-menu"+(o?" "+o:""),"data-action":n+"-color",onMouseEnter:this.onMenuItemMouseEnter,onMouseOut:this.onMenuItemMouseOut},f.default.createElement("div",{className:"sm-toolbar-menu-left",onClick:this.onMenuItemClick},f.default.createElement("i",{className:"sm-toolbar-menu-icon"}),f.default.createElement("div",{className:"sm-color-rect",style:i})),f.default.createElement("div",{className:"sm-toolbar-menu-right",onClick:this.toggleColorPicker},f.default.createElement("i",{className:"sm-dropdown-trangle-icon"})))))}}]),t}(c.Component);t.default=(0,y.default)(C),e.exports=t.default}).call(t,n(1))},function(e,t){},function(e,t,n){"use strict";(function(t,r){function o(e){return e&&e.__esModule?e:{default:e}}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=n(1102),s=n(1600),l=o(s),u=n(1601),c=o(u),f=n(1044),d=n(834),p=n(0),h=n(34),m=n(5),g=n(48),_=n(53),v=n(9),y=n(194),b=n(646),w=window.cow.alphaFeatures&&window.cow.alphaFeatures.history_chilp,C=new Date("2017-04-12"),S=(0,l.default)(),x=30,T=p.createClass({displayName:"Sidebar",propTypes:{shown:p.PropTypes.bool.isRequired,guid:p.PropTypes.string,highLight:p.PropTypes.bool},getInitialState:function(){return{histories:[],users:{},isLastPage:!1,isLoading:!0,isHistoryLoading:!0,historyType:"history",versionList:[]}},componentWillMount:function(){this.autoShowPreview=t.debounce(this._autoShowPreview,500)},componentDidMount:function(){m.DateTime.autoRefresh("#sheet-view .s-sidebar"),v.attach("spreadsheet:history:show",this.showHistory),v.attach("spreadsheet:history:hide",this.hideHistory),v.attach("spread:inited",this.afterSpreadInited)},componentWillReceiveProps:function(e){var t=this.props.shown,n=e.shown,r=e.guid;t!==n&&(this._resetState(),n?(this.previewShow=!0,this._loadData(r),this._loadVersionData(r),this.autoShowPreview()):this._hidePreview())},componentDidUpdate:function(){},componentWillUnmount:function(){v.detach("spreadsheet:history:show",this.showHistory),v.detach("spreadsheet:history:hide",this.hideHistory),v.detach("spread:inited",this.afterSpreadInited)},afterSpreadInited:function(){this.setState({isLoading:!1})},showHistory:function(){this.props.toogleSidebar("history")},hideHistory:function(){this.props.toogleSidebar(null)},_resetState:function(){this.setState({histories:[],users:{},isLastPage:!1,isLoading:!0,isHistoryLoading:!0,historyType:"history"})},_autoShowPreview:function(){if(this.props.shown)if(this.firstEditHistory){var e="version"===this.firstEditHistory.type?this._handleVersionPreview:this._handlePreview;!this.autoPreviewFinished&&e(this.firstEditHistory,!0)}else this._loadData()},_loadVersionData:function(){var e=this,t=this.props.guid;h.get("/smapi/files/"+t+"/revisions").then(function(t){var n=t.data,r=t.code;e.previewShow&&0===r&&e.setState({versionList:n.reverse()})})},_loadData:function(e,n){var r=this;e=e||this.props.guid,n=n||x;var o=this.state.histories,i=this.state.users,a=o.length;return h.get("/api/docsidebarinfo/"+e,{count:a,page_size:n}).then(function(e){r.previewShow&&r.setState({histories:o.concat(t(e.data.histories).reverse().value()),limit:null!==e.data.limit?e.data.limit:1/0,users:t.assign(i,e.data.users),isLastPage:e.data.isLastPage,isHistoryLoading:!1})})},_renderItem:function(e,t){var n=JSON.parse(e.content),r=this._getUserName(e.user_id),o=void 0,i=void 0;if(1===e.history_type)switch(n.action){case"create":o="创建了表格";break;case"invite":o="邀请了 "+this._getUserName(n.invitee);break;case"join":o="加入了文档";break;case"rename":o="将表格 “"+n.before+"” 重命名为 “"+n.after+"”";break;case"deleteShare":i=this._getUserName(n.deletedUser),o="对 "+i+" 取消了共享";break;case"set_doc_readonly":o="将公开链接设置为只读";break;case"set_doc_editable":o="将公开链接设置为可写";break;case"set_doc_private":o="禁用了公开链接";break;case"createCopy":o="创建了表格副本";break;case"transferOwnership":i=this._getUserName(n.newOwner),o="把表格转让给 "+i;break;case"createRevision":o="保存了历史版本";break;case"renameRevision":o="将历史版本 “"+n.before+"” 重命名为 “"+n.after+"”";break;case"deleteRevision":o="删除了历史版本 “"+n.label+"”";break;case"lock_sheet":o="锁定了表格 “"+n.sheetName+"”";break;case"unlock_sheet":o="解锁了表格 “"+n.sheetName+"”";break;case"update_lock":o="编辑了锁定 “"+n.sheetName+"”";break;case"lock_cell":o="锁定了单元格 “"+n.sheetName+"-"+n.range+"”";break;case"unlock_cell":o="解锁了单元格 “"+n.sheetName+"-"+n.range+"”";break;case"update_lock_cell":o="编辑了锁定 “"+n.sheetName+"-"+n.range+"”"}else if(2===e.history_type)if(this.firstEditHistory||(this.firstEditHistory=e),n.revert){var a=m.DateTime.format(n.time,!0);o=p.createElement("span",null,"将表格还原到",p.createElement("span",{is:!0,class:"history-content-time",full:"1"},a),"的内容")}else o="编辑了表格";var s=m.DateTime.format(e.updated_at),l=this._itemClass(e,t);return p.createElement("div",{key:e.id,className:l,onMouseEnter:this._handleTooltip.bind(null,e,!0),onMouseLeave:this._handleTooltip.bind(null,e,!1),onClick:this._handlePreview.bind(null,e)},p.createElement("div",{className:"s-content-container"},p.createElement("div",null,p.createElement("div",{className:"s-history-content"},p.createElement("span",{className:"s-author"},r)," ",o),p.createElement("span",{is:!0,class:"s-time","data-time":e.updated_at},s),p.createElement("div",{style:{clear:"both"}})),this._revertUI(e,t)))},_handleTooltip:function(e,t,n){if(2===e.history_type){this.setState({hovered:e.id});var o=r(n.currentTarget),i=r(".s-sidebar .s-tooltip");t?(i.css("top",o.position().top+"px"),i.css("margin-top",(o.outerHeight()-i.outerHeight())/2+"px"),i.show()):i.hide()}},_revertUI:function(e){if(2===e.history_type){var t="s-action-bar"+(S?" disabled":"");return p.createElement("div",{className:"s-action-bar-wrap"},p.createElement("div",{className:t,onClick:this._handleRevert.bind(null,e)},p.createElement("span",{className:"hicon icon-recover"}),"还原"),p.createElement("div",{style:{clear:"both"}}))}return null},_receiveSpread:function(e){this.spread=e},_handleRevert:function(e,n){var r=this;if(n.stopPropagation(),!S){var o=m.DateTime.format(e.updated_at,!0),i="version"===e.type;if(v.notify("sidebar:fetchspread",this._receiveSpread),this.spread){var a=this.spread.sheets,s=[];if(i)for(var l=0;l<a.length;)s.push(l),l++;else{_.unpack(JSON.parse(e.content).changeset).ops.forEach(function(e,n){!e.attributes&&t.isNumber(e.data)||s.push(n)})}for(var u=0,c=s.length;u<c;u++){var p=a[s[u]],g=(0,d.getSheetSelection)(p);if((0,f.isUserLocked)(p,[g]))return void this.spread.options.lockCallback(!0)}}y.show({okCallback:function(){h.post("/history/"+r.props.guid+"/revert",{dh_id:e.id},function(){m.alert({title:"已还原到 "+o+" 的内容"}),r.props.hideSidebar()},function(){m.alert({title:"还原失败",type:"error"})})},headText:"还原表格",bodyText:"确认将表格还原到"+(i?"历史版本 "+e.label+" ":" "+o+" 的内容")+"吗？"})}},_itemClass:function(e){var t=this.state,n=t.selected,r=t.previewType;return"s-history-item"+(2===e.history_type?" edit":"")+(n===e.id&&"version"!==r?" selected":"")},_getUserName:function(e){return e.toString().split(",").map(function(e){return g.get(+e).name}).join("、")},_handlePreview:function(e,n){var r=this.state,o=r.selected,i=r.previewType,a=r.histories,s=r.isLastPage,l=e.history_type,u=e.id,c=e.type,f=e.content;if(2===l){var d=t(a).filter({history_type:2}).value(),p=!1,h=void 0,m=!0,g=!1,_=void 0;try{for(var v,y=d[Symbol.iterator]();!(m=(v=y.next()).done);m=!0){var b=v.value,C=b.id;if(!(C>u))if(C!==u){if(p){h=JSON.parse(b.content).range[1];break}}else p=!0}}catch(e){g=!0,_=e}finally{try{!m&&y.return&&y.return()}finally{if(g)throw _}}if(!(p&&void 0!==h||s))return this.autoPreviewFinished=!1,this.firstEditHistory=e,void this._loadData();!0===n&&(this.autoPreviewFinished=!0),o===u&&i===c||(this.setState({selected:u,previewType:c}),w&&this._getHistoryDetail(JSON.parse(f).range),this._showPreview(this._disposeOldHistory(e),h))}},_handleVersionPreview:function(e,n){var r=this.state,o=r.selected,i=r.previewType,a=r.histories,s=r.isLastPage,l=e.history_type,u=e.id,c=e.type;e.content;if(2===l){var f=t(a).filter({history_type:2}).value(),d=this.state.versionList[e.versionIndex+1],p=void 0,h=void 0;d&&(p=d.docHistoryId,h=d.rev);if(!(f[f.length-1].id<=p)&&!s){this.autoPreviewFinished=!1,this.firstEditHistory=e;var m=p?Math.max(u-p,x):1e5;return void this._loadData(this.props.guid,m)}!0===n&&(this.autoPreviewFinished=!0),o===u&&i===c||(this.setState({selected:u,previewType:c}),e.content=JSON.stringify({changeset:JSON.stringify(this._deltaOfHistory(u,p).delta)}),this._showPreview(this._disposeOldHistory(e),h))}},_getHistoryDetail:function(e){var t=this,n=this.props.guid,r=e[0],o=e[1];h.get("/smapi/files/"+n+"/sheet_histories?from="+r+"&to="+o).then(function(e){if(0===e.code){var n=t._disposeHistoryData(e.data);v.notify("history:step",n)}})},_disposeOldHistory:function(e){if(new Date(e.updated_at)>C||!w)return e;var t=e.user_id,n=JSON.parse(e.content),r=n.range,o=n.changeset;return e.content=JSON.stringify({range:r,changeset:this._disposeDataForUserId(o,t)}),e},_disposeHistoryData:function(e){var t=this;return e.map(function(e){var n=e.updateAt;if(new Date(n)>C)return e;var r=e.userId;return e.delta=t._disposeDataForUserId(e.delta,r),e})},_disposeDataForUserId:function(e,n){var r=_.unpack(e),o=r.ops.map(function(e){var r=e.data;if("object"!==(void 0===r?"undefined":i(r)))return e;var o=e.data.cells;return o.forEach(function(e){var r=o.get(e),i=r.getAttributes();o.set(e,r.set({attributes:t.assign(i,{userID:n})}))}),e});return _.pack(new _.Delta(o))},_showPreview:function(e,t){var n=this;this.setState({isLoading:!0}),setTimeout(function(){n._calcDelta(e,t,function(t){r("#sheet-view").addClass("show-preview"),r(".s-menu, .s-body, .s-footer-wrap:first").css("visibility","hidden"),t.history=e,v.notify("history:show",t)})},0)},_hidePreview:function(){this.previewShow=!1,this.setState({selected:void 0}),this.firstEditHistory=null,this.autoPreviewFinished=!1,v.notify("history:hide"),r("#sheet-view").removeClass("show-preview"),r(".s-menu, .s-body, .s-footer-wrap:first").css("visibility","visible")},_getVersionDelta:function(e){var t=e.id,n=e.versionIndex,r=this.state.versionList[n+1],o=r&&r.docHistoryId;return this._deltaOfHistory(t,o).delta},_calcDelta:function(e,t,n){var r=this,o=this.props.guid,i=_.unpack(JSON.parse(e.content).changeset),a=void 0;if(void 0!==t){var s=this.getCachedSnapshot(o,t);s?(a=s,this._composeCalcDelta(a,i,n)):h.get("/smapi/files/"+o+"/snapshot",{rev:t}).then(function(e){a=_.unpack(JSON.stringify(e.data)),r.saveCachedSnapshot(o,t,a),r._composeCalcDelta(a,i,n)})}else this._composeCalcDelta(a,i,n)},_composeCalcDelta:function(e,t,n){var r=e?e.compose(t):t,o=void 0;r.ops.length>1&&(o=this._getTableOperatorId(r)),n({delta:r,sheet:o,baseDelta:e})},_deltaOfHistory:function(e,n){var r=t(this.state.histories).filter({history_type:2}).reverse().value();n=n||-1;var o=void 0,i=void 0,a=void 0,s=!0,l=!1,u=void 0;try{for(var c,f=r[Symbol.iterator]();!(s=(c=f.next()).done);s=!0){var d=c.value,p=d.id;if(p>e)break;if(!(p<=n)){p===e&&(a=o);var h=JSON.parse(d.content).changeset,g=_.unpack(h);o=o?o.compose(g,!0):g,i=g}}}catch(e){l=!0,u=e}finally{try{!s&&f.return&&f.return()}finally{if(l)throw u}}var v=void 0;i.ops.length>1&&(v=this._getTableOperatorId(i));try{o.validate()}catch(e){throw m.alert({type:"error",title:"当前历史片段的数据可能已损坏，无法预览"}),e}return{delta:o,sheet:v,baseDelta:a}},_getTableOperatorId:function(e){for(var t=e.ops,n=t.length,r=t[0],o=0;o<n;o++){var a=t[o];if("object"===i(a.data)||"insert"===a.action){r=a;break}}return r&&r.getAttributes().id},titleClick:function(e){this.setState({historyType:e})},deleteVersion:function(e){var t=this.state.versionList;t.splice(e,1),this.setState({versionList:t})},renderHistroyList:function(){var e=this,n=this.state,r=n.histories,o=n.isHistoryLoading,i=this.props.shown,a=[],s=void 0;if(r.length>0){var l=t.map(r,function(e){return b(e.updated_at).format("YYYY-MM-DD")+" 00:00"}),u=t.uniq(l).slice(0,this.state.limit).pop();a=t.filter(r,function(e){return+new Date(e.updated_at)>=+b(u).toDate()}),a.length<r.length&&(s=p.createElement("div",{className:"s-history-item limit"},p.createElement("div",{className:"history-divide-line"}),p.createElement("div",null,"石墨基础版展示",this.state.limit,"天历史记录"),p.createElement("div",null,p.createElement("a",{href:"/payment",target:"_blank",className:"history-pro-link"},"升级到石墨高级版"),"无限制浏览")))}return p.createElement("div",{className:"s-list",ref:"sList",onScroll:this.onScroll},a.map(function(t,n){return e._renderItem(t,n)}),i&&o&&p.createElement("div",{className:"s-sidebar-loading"},p.createElement("img",{className:"s-sidebar-loading-img",src:"https://assets-cdn.shimo.im/assets/images/loading-b67e5a67dc.gif"})),s)},renderVersionList:function(){var e=this,t=this.state,n=t.previewType,r=t.selected,o=this.state.versionList||[];return p.createElement("div",{className:"s-list"},o.length?o.map(function(t,o){return p.createElement(c.default,{key:o,index:o,version:t,selected:r,previewType:n,deleteVersion:e.deleteVersion,handlePreview:e._handleVersionPreview,handleTooltip:e._handleTooltip,revertUI:e._revertUI})}):p.createElement("div",{className:"s-version-empty"},"暂无历史版本"))},render:function(){var e=this,t=this.state,n=t.historyType,r=t.isLoading,o=t.versionList,i=this.props,s=i.shown,l=i.highLight,u="version"===n,c=u?this.renderVersionList:this.renderHistroyList,f=[{type:"history",name:"编辑历史"},{type:"version",name:"版本记录 ("+o.length+")"}];return p.createElement("div",null,s&&r&&p.createElement("div",{className:"s-history-loading"},p.createElement("img",{className:"s-history-loading-img",src:"https://assets-cdn.shimo.im/assets/images/loading-b67e5a67dc.gif"})),p.createElement("div",{className:(0,a.className)({"s-sidebar":!0,show:s})},p.createElement("div",{className:"doc-history-title spreadsheet"},f.map(function(t){var r=t.type,o=t.name;return p.createElement("span",{key:r,className:"s-title-text s-title-text-"+r+" "+(n===r?"active":""),onClick:e.titleClick.bind(e,r)},o)}),p.createElement("span",{className:"icon-close hicon doc-sidebar-close",onClick:function(){return i.toogleSidebar(null)}})),c(),p.createElement("div",{className:"s-footer",ref:"footer"},p.createElement("span",{className:"s-footer-checkbox s-toolbar-icon s-toolbar-icon-checkbox"+(l?"-checked":""),onClick:function(){return i.toogleHighLight()}}),p.createElement("span",{className:"s-footer-text"},"高亮修改区域")),p.createElement("div",{className:"s-tooltip"},"点击预览",u?"版本":"历史")))},onScroll:function(){var e=this.refs.sList,t=e.scrollTop,n=e.scrollHeight,r=this.refs.footer.offsetTop,o=this.state,i=o.isHistoryLoading,a=o.isLastPage;n-t-r<=50&&!i&&!a&&(this.setState({isHistoryLoading:!0}),this._loadData())},getCachedSnapshot:function(e,n){this.cachedSnapshot=this.cachedSnapshot||[];var r=t.find(this.cachedSnapshot,function(t){return t.key===e+"_"+n});return r?r.snapshot:null},saveCachedSnapshot:function(e,t,n){5===this.cachedSnapshot.length&&this.cachedSnapshot.shift(),this.cachedSnapshot.push({key:e+"_"+t,snapshot:n})}});e.exports=T}).call(t,n(1),n(2))},function(e,t){function n(){return"readonly"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.cow.permission)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n,e.exports=t.default},function(e,t,n){(function(r,o){function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(0),f=i(c),d=n(34),p=i(d),h=n(146),m=i(h),g=n(5),_=function(e){function t(e){a(this,t);var n=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={status:"normal",inputWidth:"100%"},n.startEdit=n.startEdit.bind(n),n.onBlur=n.onBlur.bind(n),n.onKeyDown=n.onKeyDown.bind(n),n.onInput=n.onInput.bind(n),n.deleteVersion=n.deleteVersion.bind(n),n}return l(t,e),u(t,null,[{key:"propTypes",get:function(){return{index:c.PropTypes.number,version:c.PropTypes.object,revertUI:c.PropTypes.func,deleteVersion:c.PropTypes.func,handlePreview:c.PropTypes.func,handleTooltip:c.PropTypes.func,previewType:c.PropTypes.any,selected:c.PropTypes.number}}}]),u(t,[{key:"componentDidMount",value:function(){this.adjustInputWidth()}},{key:"startEdit",value:function(){var e=this;this.setState({status:"edit"}),setTimeout(function(){e.refs.title.focus(),document.execCommand("selectAll",!1,null)})}},{key:"endEdit",value:function(){this.setState({status:"normal"});var e=this.refs.title.value;if(!r.trim(e))return this.resetInput();!(e===this.props.version.label)&&this.updateVersion(e)}},{key:"onBlur",value:function(){this.endEdit()}},{key:"onKeyDown",value:function(e){13===e.keyCode&&e.target.blur()}},{key:"onInput",value:function(e){var t=e.target.value;this.cutOff(t),this.adjustInputWidth()}},{key:"resetInput",value:function(){this.refs.title.value=this.props.version.label,this.adjustInputWidth(),(0,g.alert)({title:"版本名称不能为空",type:"error"})}},{key:"deleteVersion",value:function(){console.log(this);var e=this.props,t=e.deleteVersion,n=e.version,r=e.index,o=n.id,i=n.label;(0,m.default)({title:"删除版本",description:"确认删除历史版本“"+i+"”吗？<br>删除历史版本不会对表格当前内容造成任何变动。",confirmFun:function(){p.default.delete("/smapi/files/"+window.cow.currentFile.guid+"/revisions/"+o,function(e){console.log(e)}),t&&t(r)}})}},{key:"updateVersion",value:function(e){console.log("update",e);var t=this.props.version;t.label=e,p.default.patch("/smapi/files/"+window.cow.currentFile.guid+"/revisions/"+t.id,{label:e},function(e){console.log(e)})}},{key:"hasPermission",value:function(){var e=window.cow.currentFile.permissions,t=e&&e.manageable,n=window.cow.currentUser.id===this.props.version.user_id;return t||n}},{key:"versionClick",value:function(e,t){var n=o(t.target),r=n.parents(),i=["s-version-title-edit","s-version-delete"];"edit"===this.state.status&&i.push("s-version-title"),!i.some(function(e){return n.hasClass(e)||r.hasClass(e)})&&this.props.handlePreview(e)}},{key:"getNameWidth",value:function(){var e=this.refs.title.value,t=document.createElement("span");t.style.fontSize="12px",t.innerText=e,document.body.appendChild(t);var n=t.offsetWidth;return document.body.removeChild(t),n}},{key:"adjustInputWidth",value:function(){var e=this.getNameWidth();this.setState({inputWidth:Math.min(e,194)})}},{key:"cutOff",value:function(e){if(e){for(var t=32,n=/[^\x00-\xff]/,r=e.split(""),o=r.length,i=0,a=0,s=0;s<o;s++){var l=n.test(r[s])?2:1;if(i+l>t)break;a=s+1,i+=l}a!==o&&(this.refs.title.value=e.substr(0,a))}}},{key:"render",value:function(){var e=this.props,t=e.version,n=e.revertUI,r=e.index,o=e.previewType,i=e.selected,a=e.handleTooltip,s=t.label,l=t.User,u=t.docHistoryId,c=t.updated_at,d=t.created_at,p=l.name,h=this.state,m=h.status,g=h.inputWidth,_="edit"===m,v={id:u,history_type:2,type:"version",versionIndex:r,updated_at:c,created_at:d,label:s},y=this.hasPermission(),b=u===i&&"version"===o?"active":"";return f.default.createElement("div",{className:"s-version-item "+b,onClick:this.versionClick.bind(this,v),onMouseEnter:a.bind(null,v,!0),onMouseLeave:a.bind(null,v,!1)},f.default.createElement("div",{className:"s-content-container"},f.default.createElement("div",{className:"s-vertion-title-container"},f.default.createElement("input",{ref:"title",className:"s-version-title",readOnly:!_,style:{width:g},defaultValue:s,maxLength:"32",onBlur:this.onBlur,onKeyDown:this.onKeyDown,onInput:this.onInput}),y&&f.default.createElement("span",{onClick:this.startEdit,className:"s-version-title-edit s-toolbar-icon s-toolbar-icon-edit"})),f.default.createElement("div",{className:"s-version-content"},f.default.createElement("span",{className:"s-author"},p)," 保存了版本"),y&&f.default.createElement("div",{className:"s-version-delete",onClick:this.deleteVersion},f.default.createElement("span",{className:"hicon icon-trash-delete s-version-delete-icon"}),"删除"),n(v)))}}]),t}(c.Component);t.default=_,e.exports=t.default}).call(t,n(1),n(2))},function(e,t,n){(function(r){function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=o(u),f=n(1209),d=o(f),p=n(5),h=o(p),m=n(9),g=o(m),_=n(1603),v=o(_),y=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handlerStep=n._handlerStep.bind(n),n.historyStepChange=n._historyStepChange.bind(n),n.state={open:!1},n}return s(t,e),l(t,null,[{key:"propTypes",get:function(){return{msg:u.PropTypes.object,highLight:u.PropTypes.bool}}}]),l(t,[{key:"componentDidMount",value:function(){var e=this;g.default.attach("history:show",function(t){e.show(t)}),g.default.attach("history:hide",function(){e.hide()}),g.default.attach("history:step",this.handlerStep),h.default.DateTime.autoRefresh("#s-history-wrap .s-history-head")}},{key:"show",value:function(e){var t=e.delta,n=e.sheet,o=e.history,i=e.baseDelta;this.setState({sheetId:n,spreadsheet:t,history:o,baseDelta:i,show:!0}),setTimeout(function(){r(".s-history").css("visibility","visible")},0)}},{key:"hide",value:function(){this.setState({show:!1})}},{key:"_handlerStep",value:function(e){this.setState({historyContent:e})}},{key:"_historyStepChange",value:function(e){this.setState({historyStep:e})}},{key:"render",value:function(){var e=this.state,t=e.sheetId,n=e.spreadsheet,r=e.history,o=e.show,i=e.historyContent,a=e.baseDelta,s=e.historyStep,l=this.props,u=l.guid,f=l.msg,p=l.highLight,m=l.zoom,g=r&&"version"===r.type,_=void 0,y=void 0;return r&&(_=r.created_at,y=h.default.DateTime.format(_,!0)),o?c.default.createElement("div",{id:"s-history-wrap"},c.default.createElement("div",{className:"s-history-head"},c.default.createElement(v.default,{items:i,baseDelta:a,historyStepChange:this.historyStepChange}),c.default.createElement("div",null,g?"表格历史版本":"表格编辑历史",!g&&c.default.createElement("div",{className:"s-tip"},c.default.createElement("span",{className:"team-sprite help-icon"}),c.default.createElement("div",{className:"s-tooltip"},"停止编辑1分钟，会自动保存为一段历史"))),c.default.createElement("div",{is:!0,"data-time":_},y)),c.default.createElement("div",{className:"s-history-body"},c.default.createElement(d.default,{guid:u,readonlyType:"history",history:r,historyStep:s,spreadsheet:n,zoom:m,msg:f,highLight:p,sheetId:t}))):null}}]),t}(u.Component);t.default=y,e.exports=t.default}).call(t,n(2))},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(20),f=r(c),d=n(53),p=r(d),h=n(5),m=r(h),g=n(21),_=(0,g.isEnterprise)(),v=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.init=!0,n.state={current:n.props.current},n}return a(t,e),s(t,null,[{key:"propTypes",get:function(){return{items:l.PropTypes.array,current:l.PropTypes.number,wrapClassName:l.PropTypes.string,changeHistory:l.PropTypes.func,baseDelta:l.PropTypes.object,historyStepChange:l.PropTypes.func}}},{key:"defaultProps",get:function(){return{current:0,items:[],baseDelta:new p.default.Delta}}}]),s(t,[{key:"componentWillReceiveProps",value:function(e){this.props.items!==e.items&&(this.init=!0,this.setState({current:0}))}},{key:"_changeHistory",value:function(e){var t=this.state.current,n=this.props.items,r=n.length;e<0&&t<=1||e>0&&t===r||!_||(t+=e,this._showStep(t))}},{key:"_showStep",value:function(e){var t=this.state.current,n=this.props,r=n.items,o=n.historyStepChange,i=this._getStepCS(t,e),a=r[e-1];this.init=!1,o&&o({cs:i,curStep:a}),this.setState({current:e})}},{key:"_getStepCS",value:function(e,t){var n=this.props,r=n.items,o=n.baseDelta,i=this.init,a=i||e>t,s=[],l=[],u=new p.default.Delta,c=new p.default.Delta;if(e===t)return c;if(i?(l=r.slice(0,t),s=r.slice(t)):e<t?l=r.slice(e,t):(l=r.slice(0,t),s=r.slice(t,e)),l.forEach(function(e){c=c.compose(p.default.unpack(e.delta))}),s.forEach(function(e){u=u.compose(p.default.unpack(e.delta))}),!a)return c;try{return o.compose(c).invert(u)}catch(e){m.default.alert({title:"当前历史片段的数据可能已损坏，无法预览，请查看其它的历史",type:"error"})}}},{key:"render",value:function(){var e=this.state.current,t=this.props,n=t.wrapClassName,r=t.items,o=r.length;if(o<=1)return null;var i="historyWrap "+(n||"")+(_?"":"disabled"),a=this.init,s=(0,f.default)({hisBtn:!0,hisBtnPrev:!0,hisBtnDisable:e<=1||!_}),l=(0,f.default)({hisBtn:!0,hisBtnNext:!0,hisBtnDisable:e===o||!_}),c=_?"":u.default.createElement("span",{className:"tooltip s-tooltip"},"企业版功能");return u.default.createElement("div",{className:i},a?"查看所有编辑记录, 共":"第",u.default.createElement("em",null,a?"":e+" / ",o),"条",a?"":"修改记录","  ",u.default.createElement("span",{className:s,onClick:this._changeHistory.bind(this,-1)}),u.default.createElement("span",{className:l,onClick:this._changeHistory.bind(this,1)}),c)}}]),t}(l.Component);t.default=v,e.exports=t.default},function(e,t){function n(){return{type:"TOGGLE_SIDEBAR",sidebarName:arguments.length>0&&void 0!==arguments[0]?arguments[0]:null}}function r(){return{type:"HIDE_SIDEBAR",sidebarName:arguments.length>0&&void 0!==arguments[0]?arguments[0]:null}}function o(){return{type:"TOGGLE_HIGHLIGHT"}}function i(e){return{type:"CHANGE_SHEET_ZOOM",zoom:e}}function a(e){return{type:"CHANGE_SHEET_ID",sheetId:e}}function s(e){return{type:"TOGGLE_LOCK_SIDEBAR",status:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.toogleSidebar=n,t.hideSidebar=r,t.toogleHighLight=o,t.changeSheetZoom=i,t.changeSheetId=a,t.toggleLockSidebar=s},function(e,t){function n(e){return{type:"SET_MENU_SELECTION",selection:e}}e.exports={setMenuSelection:n}},function(e,t){function n(){return{type:"UNDO"}}function r(){return{type:"REDO"}}function o(){return{type:"DISABLE_UNDO_REDO"}}function i(){return{type:"ENABLE_UNDO_REDO"}}function a(){return{type:"ENABLE_BY_LOCKCELL"}}function s(){return{type:"DISABLE_BY_LOCKCELL"}}Object.defineProperty(t,"__esModule",{value:!0}),t.default={undo:n,redo:r,disableUndoRedo:o,enableUndoRedo:i,enableByLockCell:a,disableByLockCell:s},e.exports=t.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e){return function(t){return t({type:"GET_SHARED_USERS"}),(0,l.ajaxGet)("/smapi/files/"+e+"/collaborators").then(function(n){return t(i(e,n))},function(e){return t(s("GET_SHARED_USERS",e))})}}function i(e,t){return function(e){if(0!=+t.code)return e(s("GET_SHARED_USERS",t));var n=(0,u.map)(t.data,"id"),r=(0,u.zipObject)(n,t.data);return(0,d.setCollaborators)(r),e(a(r))}}function a(e){return{type:"PATCH_USERS",payload:e}}function s(e,t,n){return n||f.default.alert({title:t.message,type:"error"}),{type:e+"_FAILED",error:t}}Object.defineProperty(t,"__esModule",{value:!0}),t.getSharedUsers=o;var l=n(22),u=n(1),c=n(5),f=r(c),d=n(1044)},function(e,t,n){(function(r){function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=o(u),f=n(9),d=o(f),p=n(1102),h=n(926),m=n(834),g=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggleSidebar=n.toggleSidebar.bind(n),n.afterSpreadInited=n.afterSpreadInited.bind(n),n.shouldShowBtn=n.shouldShowBtn.bind(n),n.onSettingClick=n.onSettingClick.bind(n),n.onDeleteClick=n.onDeleteClick.bind(n),n.state={lockSheetList:[],activeIndex:null},n.spread=null,d.default.attach("spread:editable:inited",n.afterSpreadInited),n}return s(t,e),l(t,[{key:"componentDidMount",value:function(){d.default.attach("spreadsheet:lock:toggle",this.toggleSidebar)}},{key:"componentWillReceiveProps",value:function(e){var t=this.props.shown,n=e.shown,o=e.lockpermission,i=window.cow.currentUser;if(t===n||n||d.default.notify("lock:sidebar:hide"),n){var a=!1,s=!1,l=!1,u=o.users;for(var c in u){var f=u[c];parseInt(c,10)===i.id&&(a="owner"===f.role,s=f.teamId===window.cow.currentFile.teamId&&("admin"===f.teamRole||"creator"===f.teamRole),l=f.isOutsider)}var p=a||s,g=[];this.spread&&this.spread.sheets.forEach(function(e,t){var n=(0,h.getSheetAttrs)(e,"lock"),o=(0,m.getSheetCellLocks)(e),a=e.guid(),s=e.name(),u=1,c="只能查看",f=t;if(l&&(u=0),n){var d=e.lockerId===i.id;p||d||(u=0);var _=n,v=_.editable;r.includes(v,i.id)&&(c="可以编辑"),g.push({guid:a,index:t,key:f,sheetName:s,editAuthority:c,operAuthority:u})}else o.length&&r.forEach(o,function(e,n){var o=e[1].lockerId===i.id;p||o||(u=0);var l=e[1].editable;r.includes(l,i.id)&&(c="可以编辑");var d=s+" - "+(0,m.cellRange2LockRange)(e[1].ranges[0]).join(":");f=f+"-"+n,g.push({guid:a,index:t,key:f,sheetName:d,editAuthority:c,operAuthority:u,selection:e[1].ranges[0],cellLock:e})})}),this.setState({lockSheetList:g})}}},{key:"componentWillUnmount",value:function(){d.default.detach("spreadsheet:lock:toggle",this.toggleSidebar),d.default.detach("spread:editable:inited",this.afterSpreadInited)}},{key:"toggleSidebar",value:function(e){this.props.toggleLockSidebar(e),this.resetActiveIndex()}},{key:"afterSpreadInited",value:function(e){this.spread=e}},{key:"resetActiveIndex",value:function(){this.setState({activeIndex:null})}},{key:"onSettingClick",value:function(e,t,n){d.default.notify("lock:sidebar:setting",this.spread.getSheet(e),t,n)}},{key:"onDeleteClick",value:function(e,t){d.default.notify("lock:sidebar:delete",this.spread.getSheet(e),t)}},{key:"shouldShowBtn",value:function(e,t){return 1===e?c.default.createElement("span",null,c.default.createElement("div",{className:"lock-sidebar-item-btn",onClick:this.onDeleteClick.bind(this,t.index,t.cellLock)},c.default.createElement("div",{className:"icon icon-btn-del"}),c.default.createElement("span",null,"删除")),c.default.createElement("div",{className:"lock-sidebar-item-btn",onClick:this.onSettingClick.bind(this,t.index,t.selection,t.cellLock)},c.default.createElement("div",{className:"icon icon-btn-set"}),c.default.createElement("span",null,"设置"))):null}},{key:"showLock",value:function(e){var t=e.guid,n=e.selection,r=e.cellLock,o=e.key,i=this.props,a=this.spread,s=(0,m.getSheetIndexById)(t,a);if(s!==a.getActiveSheetIndex()&&i.changeSheetId(t),r){var l=n.row,u=n.col,c=a.getSheet(s);(0,m.setSelection)(c,n),c.showCell(l,u)}this.setState({activeIndex:o})}},{key:"render",value:function(){var e=this,t=this.props.shown,n=this.state,r=n.activeIndex,o=n.lockSheetList,i=o.map(function(t){var n=t.key,o=t.sheetName,i=t.editAuthority,a=t.operAuthority,s=n===r;return c.default.createElement("div",{className:"lock-sidebar-item "+(s?"active":""),key:"lock-sidebar-item-"+n,onClick:e.showLock.bind(e,t)},c.default.createElement("div",{className:"lock-sidebar-item-range"},c.default.createElement("span",null,o)),c.default.createElement("div",{className:"lock-sidebar-item-status"},c.default.createElement("span",null,i),e.shouldShowBtn(a,t)))});return c.default.createElement("div",{className:(0,p.className)({"lock-sidebar":!0,show:t})},c.default.createElement("div",{className:"lock-sidebar-title"},c.default.createElement("span",{className:"lock-sidebar-title-text"},"锁定工作表"),c.default.createElement("span",{className:"icon-close hicon doc-sidebar-close",onClick:this.toggleSidebar.bind(this,null)})),c.default.createElement("div",{className:"lock-sidebar-list"},i.length?i:c.default.createElement("div",{className:"s-version-empty"},"暂无锁定工作表 / 单元格")))}}]),t}(c.default.Component);t.default=g,g.propTypes={shown:c.default.PropTypes.bool},e.exports=t.default}).call(t,n(1))}]));